(() => { 
var t=function(t){"use strict";var e={},n=Object.getOwnPropertyNames,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty;function a(t,e){return function(n,r,i){return t(n,r,i)&&e(n,r,i)}}function o(t){return function(e,n,r){if(!e||!n||"object"!=typeof e||"object"!=typeof n)return t(e,n,r);var i=r.cache,a=i.get(e),o=i.get(n);if(a&&o)return a===n&&o===e;i.set(e,n),i.set(n,e);var s=t(e,n,r);return i.delete(e),i.delete(n),s}}function s(t){return n(t).concat(r(t))}var u=Object.hasOwn||function(t,e){return i.call(t,e)};function c(t,e){return t||e?t===e:t===e||t!=t&&e!=e}var l="_owner",h=Object.getOwnPropertyDescriptor,p=Object.keys;function f(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function d(t,e){return c(t.getTime(),e.getTime())}function m(t,e,n){if(t.size!==e.size)return!1;for(var r,i,a={},o=t.entries(),s=0;(r=o.next())&&!r.done;){for(var u=e.entries(),c=!1,l=0;(i=u.next())&&!i.done;){var h=r.value,p=h[0],f=h[1],d=i.value,m=d[0],g=d[1];c||a[l]||!(c=n.equals(p,m,s,l,t,e,n)&&n.equals(f,g,p,m,t,e,n))||(a[l]=!0),l++}if(!c)return!1;s++}return!0}function g(t,e,n){var r,i=p(t),a=i.length;if(p(e).length!==a)return!1;for(;a-- >0;){if((r=i[a])===l&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof)return!1;if(!u(e,r)||!n.equals(t[r],e[r],r,r,t,e,n))return!1}return!0}function v(t,e,n){var r,i,a,o=s(t),c=o.length;if(s(e).length!==c)return!1;for(;c-- >0;){if((r=o[c])===l&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof)return!1;if(!u(e,r))return!1;if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;if(i=h(t,r),a=h(e,r),(i||a)&&(!i||!a||i.configurable!==a.configurable||i.enumerable!==a.enumerable||i.writable!==a.writable))return!1}return!0}function y(t,e){return c(t.valueOf(),e.valueOf())}function b(t,e){return t.source===e.source&&t.flags===e.flags}function x(t,e,n){if(t.size!==e.size)return!1;for(var r,i,a={},o=t.values();(r=o.next())&&!r.done;){for(var s=e.values(),u=!1,c=0;(i=s.next())&&!i.done;)u||a[c]||!(u=n.equals(r.value,i.value,r.value,i.value,t,e,n))||(a[c]=!0),c++;if(!u)return!1}return!0}function w(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}var _="[object Arguments]",S="[object Boolean]",T="[object Date]",E="[object Map]",k="[object Number]",I="[object Object]",A="[object RegExp]",N="[object Set]",C="[object String]",R=Array.isArray,O="function"==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,D=Object.assign,M=Object.prototype.toString.call.bind(Object.prototype.toString);var F=V(),P=V({strict:!0}),L=V({circular:!0}),B=V({circular:!0,strict:!0}),z=V({createInternalComparator:function(){return c}}),U=V({strict:!0,createInternalComparator:function(){return c}}),G=V({circular:!0,createInternalComparator:function(){return c}}),W=V({circular:!0,createInternalComparator:function(){return c},strict:!0});function V(t){void 0===t&&(t={});var e,n=t.circular,r=void 0!==n&&n,i=t.createInternalComparator,s=t.createState,u=t.strict,c=void 0!==u&&u,l=function(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,i={areArraysEqual:r?v:f,areDatesEqual:d,areMapsEqual:r?a(m,v):m,areObjectsEqual:r?v:g,arePrimitiveWrappersEqual:y,areRegExpsEqual:b,areSetsEqual:r?a(x,v):x,areTypedArraysEqual:r?v:w};if(n&&(i=D({},i,n(i))),e){var s=o(i.areArraysEqual),u=o(i.areMapsEqual),c=o(i.areObjectsEqual),l=o(i.areSetsEqual);i=D({},i,{areArraysEqual:s,areMapsEqual:u,areObjectsEqual:c,areSetsEqual:l})}return i}(t),h=function(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areMapsEqual,i=t.areObjectsEqual,a=t.arePrimitiveWrappersEqual,o=t.areRegExpsEqual,s=t.areSetsEqual,u=t.areTypedArraysEqual;return function(t,c,l){if(t===c)return!0;if(null==t||null==c||"object"!=typeof t||"object"!=typeof c)return t!=t&&c!=c;var h=t.constructor;if(h!==c.constructor)return!1;if(h===Object)return i(t,c,l);if(R(t))return e(t,c,l);if(null!=O&&O(t))return u(t,c,l);if(h===Date)return n(t,c,l);if(h===RegExp)return o(t,c,l);if(h===Map)return r(t,c,l);if(h===Set)return s(t,c,l);var p=M(t);return p===T?n(t,c,l):p===A?o(t,c,l):p===E?r(t,c,l):p===N?s(t,c,l):p===I?"function"!=typeof t.then&&"function"!=typeof c.then&&i(t,c,l):p===_?i(t,c,l):(p===S||p===k||p===C)&&a(t,c,l)}}(l);return function(t){var e=t.circular,n=t.comparator,r=t.createState,i=t.equals,a=t.strict;if(r)return function(t,o){var s=r(),u=s.cache,c=void 0===u?e?new WeakMap:void 0:u,l=s.meta;return n(t,o,{cache:c,equals:i,meta:l,strict:a})};if(e)return function(t,e){return n(t,e,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var o={cache:void 0,equals:i,meta:void 0,strict:a};return function(t,e){return n(t,e,o)}}({circular:r,comparator:h,createState:s,equals:i?i(h):(e=h,function(t,n,r,i,a,o,s){return e(t,n,s)}),strict:c})}var j=e.circularDeepEqual=L,H=e.circularShallowEqual=G,X=e.createCustomEqual=V,q=e.deepEqual=F,K=e.sameValueZeroEqual=c,Y=e.shallowEqual=z,Z=e.strictCircularDeepEqual=B,$=e.strictCircularShallowEqual=W,J=e.strictDeepEqual=P,Q=e.strictShallowEqual=U;return t.circularDeepEqual=j,t.circularShallowEqual=H,t.createCustomEqual=X,t.deepEqual=q,t.default=e,t.sameValueZeroEqual=K,t.shallowEqual=Y,t.strictCircularDeepEqual=Z,t.strictCircularShallowEqual=$,t.strictDeepEqual=J,t.strictShallowEqual=Q,Object.defineProperty(t,"__esModule",{value:!0}),t}({}),e=function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default.Buffer??t:t.Buffer??t}for(var e={},n={byteLength:function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},toByteArray:function(t){var e,n,r=u(t),o=r[0],s=r[1],c=new a(function(t,e,n){return 3*(e+n)/4-n}(0,o,s)),l=0,h=s>0?o-4:o;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,c[l++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e);return c},fromByteArray:function(t){for(var e,n=t.length,i=n%3,a=[],o=16383,s=0,u=n-i;s<u;s+=o)a.push(c(t,s,s+o>u?u:s+o));1===i?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return a.join("")}},r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var i,a,o=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63;var l={read:function(t,e,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,a=f&(1<<-l)-1,f>>=-l,l+=s;l>0;a=256*a+t[e+h],h+=p,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+t[e+h],h+=p,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=c}return(f?-1:1)*o*Math.pow(2,a-r)},write:function(t,e,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+h>=1?p/u:p*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(s=0,o=l):o+h>=1?(s=(e*u-1)*Math.pow(2,i),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[n+f]=255&s,f+=d,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;t[n+f]=255&o,f+=d,o/=256,c-=8);t[n+f-d]|=128*m}};return function(t){const e=n,r=l,i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;const a=2147483647;function o(t){if(t>a)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,n)}function u(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|m(t,e);let r=o(n);const i=r.write(t,e);i!==n&&(r=r.slice(0,i));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return p(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);const i=function(t){if(s.isBuffer(t)){const e=0|d(t.length),n=o(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||Z(t.length)?o(0):p(t);if("Buffer"===t.type&&Array.isArray(t.data))return p(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return c(t),o(t<0?0:0|d(t))}function p(t){const e=t.length<0?0:0|d(t.length),n=o(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,s.prototype),r}function d(t){if(t>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|t}function m(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return X(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(t).length;default:if(i)return r?-1:X(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,n);case"utf8":case"utf-8":return k(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Z(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){let a,o=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){let r=-1;for(a=n;a<s;a++)if(c(t,a)===c(e,-1===r?0:a-r)){if(-1===r&&(r=a),a-r+1===u)return r*o}else-1!==r&&(a-=a-r),r=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){let n=!0;for(let r=0;r<u;r++)if(c(t,a+r)!==c(e,r)){n=!1;break}if(n)return a}return-1}function x(t,e,n,r){n=Number(n)||0;const i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;const a=e.length;let o;for(r>a/2&&(r=a/2),o=0;o<r;++o){const r=parseInt(e.substr(2*o,2),16);if(Z(r))return o;t[n+o]=r}return o}function w(t,e,n,r){return K(X(e,t.length-n),t,n,r)}function _(t,e,n,r){return K(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function S(t,e,n,r){return K(q(e),t,n,r)}function T(t,e,n,r){return K(function(t,e){let n,r,i;const a=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function E(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function k(t,e,n){n=Math.min(t.length,n);const r=[];let i=e;for(;i<n;){const e=t[i];let a=null,o=e>239?4:e>223?3:e>191?2:1;if(i+o<=n){let n,r,s,u;switch(o){case 1:e<128&&(a=e);break;case 2:n=t[i+1],128==(192&n)&&(u=(31&e)<<6|63&n,u>127&&(a=u));break;case 3:n=t[i+1],r=t[i+2],128==(192&n)&&128==(192&r)&&(u=(15&e)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(a=u));break;case 4:n=t[i+1],r=t[i+2],s=t[i+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(u=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&s,u>65535&&u<1114112&&(a=u))}}null===a?(a=65533,o=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=o}return function(t){const e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=I));return n}(r)}t.kMaxLength=a,s.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,n){return u(t,e,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,n){return function(t,e,n){return c(t),t<=0?o(t):void 0!==e?"string"==typeof n?o(t).fill(e,n):o(t).fill(e):o(t)}(t,e,n)},s.allocUnsafe=function(t){return h(t)},s.allocUnsafeSlow=function(t){return h(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(Y(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=s.allocUnsafe(e);let i=0;for(n=0;n<t.length;++n){let e=t[n];if(Y(e,Uint8Array))i+e.length>r.length?(s.isBuffer(e)||(e=s.from(e)),e.copy(r,i)):Uint8Array.prototype.set.call(r,e,i);else{if(!s.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,i)}i+=e.length}return r},s.byteLength=m,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)v(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},s.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?k(this,0,t):g.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(s.prototype[i]=s.prototype.inspect),s.prototype.compare=function(t,e,n,r,i){if(Y(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;let a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0);const u=Math.min(a,o),c=this.slice(r,i),l=t.slice(e,n);for(let t=0;t<u;++t)if(c[t]!==l[t]){a=c[t],o=l[t];break}return a<o?-1:o<a?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let a=!1;for(;;)switch(r){case"hex":return x(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":case"latin1":case"binary":return _(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function A(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function N(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function C(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=e;r<n;++r)i+=$[t[r]];return i}function R(t,e,n){const r=t.slice(e,n);let i="";for(let t=0;t<r.length-1;t+=2)i+=String.fromCharCode(r[t]+256*r[t+1]);return i}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,n,r,i,a){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r,i){W(e,r,i,t,n,7);let a=Number(e&BigInt(4294967295));t[n++]=a,a>>=8,t[n++]=a,a>>=8,t[n++]=a,a>>=8,t[n++]=a;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o,n}function F(t,e,n,r,i){W(e,r,i,t,n,7);let a=Number(e&BigInt(4294967295));t[n+7]=a,a>>=8,t[n+6]=a,a>>=8,t[n+5]=a,a>>=8,t[n+4]=a;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=o,o>>=8,t[n+2]=o,o>>=8,t[n+1]=o,o>>=8,t[n]=o,n+8}function P(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,i,a){return e=+e,n>>>=0,a||P(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function B(t,e,n,i,a){return e=+e,n>>>=0,a||P(t,0,n,8),r.write(t,e,n,i,52,8),n+8}s.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t],i=1,a=0;for(;++a<e&&(i*=256);)r+=this[t+a]*i;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t+--e],i=1;for(;e>0&&(i*=256);)r+=this[t+--e]*i;return r},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=J((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),s.prototype.readBigUInt64BE=J((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t],i=1,a=0;for(;++a<e&&(i*=256);)r+=this[t+a]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=e,i=1,a=this[t+--r];for(;r>0&&(i*=256);)a+=this[t+--r]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*e)),a},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=J((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),s.prototype.readBigInt64BE=J((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){D(this,t,e,n,Math.pow(2,8*n)-1,0)}let i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){D(this,t,e,n,Math.pow(2,8*n)-1,0)}let i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=J((function(t,e=0){return M(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=J((function(t,e=0){return F(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}let i=0,a=1,o=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===o&&0!==this[e+i-1]&&(o=1),this[e+i]=(t/a|0)-o&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}let i=n-1,a=1,o=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===o&&0!==this[e+i+1]&&(o=1),this[e+i]=(t/a|0)-o&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=J((function(t,e=0){return M(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=J((function(t,e=0){return F(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{const a=s.isBuffer(t)?t:s.from(t,r),o=a.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<n-e;++i)this[i+e]=a[i%o]}return this};const z={};function U(t,e,n){z[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function G(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function W(t,e,n,r,i,a){if(t>n||t<e){const n="bigint"==typeof e?"n":"";let r;throw r=0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(a+1)}${n}`:`>= -(2${n} ** ${8*(a+1)-1}${n}) and < 2 ** ${8*(a+1)-1}${n}`,new z.ERR_OUT_OF_RANGE("value",r,t)}!function(t,e,n){V(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||j(e,t.length-(n+1))}(r,i,a)}function V(t,e){if("number"!=typeof t)throw new z.ERR_INVALID_ARG_TYPE(e,"number",t)}function j(t,e,n){if(Math.floor(t)!==t)throw V(t,n),new z.ERR_OUT_OF_RANGE("offset","an integer",t);if(e<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,t)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=G(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=G(i)),i+="n"),r+=` It must be ${e}. Received ${i}`,r}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function X(t,e){let n;e=e||1/0;const r=t.length;let i=null;const a=[];for(let o=0;o<r;++o){if(n=t.charCodeAt(o),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function q(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function K(t,e,n,r){let i;for(i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const $=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)e[r+i]=t[n]+t[i]}return e}();function J(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}}(e),t(e)}(),n=function(t){"use strict";var n,r,i;try{n=new TextDecoder}catch(t){}var a,o,s,u,c,l=0,h={},p=0,f=0,d=[],m={useRecords:!1,mapsAsObjects:!0};class g{}const v=new g;v.name="MessagePack 0xC1";var y=!1,b=2;try{new Function("")}catch(t){b=1/0}class x{constructor(t){t&&(!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.sequential&&!1!==t.trusted&&(t.trusted=!0,t.structures||0==t.useRecords||(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0),t.int64AsNumber&&(t.int64AsType="number")),Object.assign(this,t)}unpack(t,n){if(r)return Y((()=>(Z(),this?this.unpack(t,n):x.prototype.unpack.call(m,t,n))));t.buffer||t.constructor!==ArrayBuffer||(t=void 0!==e?e.from(t):new Uint8Array(t)),"object"==typeof n?(i=n.end||t.length,l=n.start||0):(l=0,i=n>-1?n:t.length),f=0,o=null,s=null,r=t;try{c=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){if(r=null,t instanceof Uint8Array)throw e;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof x){if(h=this,this.structures)return a=this.structures,w(n);(!a||a.length>0)&&(a=[])}else h=m,(!a||a.length>0)&&(a=[]);return w(n)}unpackMultiple(t,e){let n,r=0;try{y=!0;let i=t.length,a=this?this.unpack(t,i):Q.unpack(t,i);if(!e){for(n=[a];l<i;)r=l,n.push(w());return n}if(!1===e(a,r,l))return;for(;l<i;)if(r=l,!1===e(w(),r,l))return}catch(t){throw t.lastPosition=r,t.values=n,t}finally{y=!1,Z()}}_mergeStructures(t,e){t=t||[],Object.isFrozen(t)&&(t=t.map((t=>t.slice(0))));for(let e=0,n=t.length;e<n;e++){let n=t[e];n&&(n.isShared=!0,e>=32&&(n.highByte=e-32>>5))}t.sharedLength=t.length;for(let n in e||[])if(n>=0){let r=t[n],i=e[n];i&&(r&&((t.restoreStructures||(t.restoreStructures=[]))[n]=r),t[n]=i)}return this.structures=t}decode(t,e){return this.unpack(t,e)}}function w(t){try{if(!h.trusted&&!y){let t=a.sharedLength||0;t<a.length&&(a.length=t)}let t;if(h.randomAccessStructure&&r[l]<64&&r[l],t=S(),s&&(l=s.postBundlePosition,s=null),y&&(a.restoreStructures=null),l==i)a&&a.restoreStructures&&_(),a=null,r=null,u&&(u=null);else{if(l>i)throw new Error("Unexpected end of MessagePack data");if(!y){let e;try{e=JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}n`:e)).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw new Error("Data read, but end of buffer not reached "+e)}}return t}catch(t){throw a&&a.restoreStructures&&_(),Z(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||l>i)&&(t.incomplete=!0),t}}function _(){for(let t in a.restoreStructures)a[t]=a.restoreStructures[t];a.restoreStructures=null}function S(){let t=r[l++];if(t<160){if(t<128){if(t<64)return t;{let e=a[63&t]||h.getStructures&&I()[63&t];return e?(e.read||(e.read=E(e,63&t)),e.read()):t}}if(t<144){if(t-=128,h.mapsAsObjects){let e={};for(let n=0;n<t;n++){let t=W();"__proto__"===t&&(t="__proto_"),e[t]=S()}return e}{let e=new Map;for(let n=0;n<t;n++)e.set(S(),S());return e}}{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=S();return h.freezeData?Object.freeze(e):e}}if(t<192){let e=t-160;if(f>=l)return o.slice(l-p,(l+=e)-p);if(0==f&&i<140){let t=e<16?L(e):P(e);if(null!=t)return t}return A(e)}{let e;switch(t){case 192:return null;case 193:return s?(e=S(),e>0?s[1].slice(s.position1,s.position1+=e):s[0].slice(s.position0,s.position0-=e)):v;case 194:return!1;case 195:return!0;case 196:if(e=r[l++],void 0===e)throw new Error("Unexpected end of buffer");return z(e);case 197:return e=c.getUint16(l),l+=2,z(e);case 198:return e=c.getUint32(l),l+=4,z(e);case 199:return U(r[l++]);case 200:return e=c.getUint16(l),l+=2,U(e);case 201:return e=c.getUint32(l),l+=4,U(e);case 202:if(e=c.getFloat32(l),h.useFloat32>2){let t=$[(127&r[l])<<1|r[l+1]>>7];return l+=4,(t*e+(e>0?.5:-.5)|0)/t}return l+=4,e;case 203:return e=c.getFloat64(l),l+=8,e;case 204:return r[l++];case 205:return e=c.getUint16(l),l+=2,e;case 206:return e=c.getUint32(l),l+=4,e;case 207:return"number"===h.int64AsType?(e=4294967296*c.getUint32(l),e+=c.getUint32(l+4)):"string"===h.int64AsType?e=c.getBigUint64(l).toString():"auto"===h.int64AsType?(e=c.getBigUint64(l),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=c.getBigUint64(l),l+=8,e;case 208:return c.getInt8(l++);case 209:return e=c.getInt16(l),l+=2,e;case 210:return e=c.getInt32(l),l+=4,e;case 211:return"number"===h.int64AsType?(e=4294967296*c.getInt32(l),e+=c.getUint32(l+4)):"string"===h.int64AsType?e=c.getBigInt64(l).toString():"auto"===h.int64AsType?(e=c.getBigInt64(l),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=c.getBigInt64(l),l+=8,e;case 212:if(e=r[l++],114==e)return j(63&r[l++]);{let t=d[e];if(t)return t.read?(l++,t.read(S())):t.noBuffer?(l++,t()):t(r.subarray(l,++l));throw new Error("Unknown extension "+e)}case 213:return e=r[l],114==e?(l++,j(63&r[l++],r[l++])):U(2);case 214:return U(4);case 215:return U(8);case 216:return U(16);case 217:return e=r[l++],f>=l?o.slice(l-p,(l+=e)-p):N(e);case 218:return e=c.getUint16(l),f>=(l+=2)?o.slice(l-p,(l+=e)-p):C(e);case 219:return e=c.getUint32(l),f>=(l+=4)?o.slice(l-p,(l+=e)-p):R(e);case 220:return e=c.getUint16(l),l+=2,D(e);case 221:return e=c.getUint32(l),l+=4,D(e);case 222:return e=c.getUint16(l),l+=2,M(e);case 223:return e=c.getUint32(l),l+=4,M(e);default:if(t>=224)return t-256;if(void 0===t){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+t)}}}const T=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function E(t,e){function n(){if(n.count++>b){let n=t.read=new Function("r","return function(){return "+(h.freezeData?"Object.freeze":"")+"({"+t.map((t=>"__proto__"===t?"__proto_:r()":T.test(t)?t+":r()":"["+JSON.stringify(t)+"]:r()")).join(",")+"})}")(S);return 0===t.highByte&&(t.read=k(e,t.read)),n()}let r={};for(let e=0,n=t.length;e<n;e++){let n=t[e];"__proto__"===n&&(n="__proto_"),r[n]=S()}return h.freezeData?Object.freeze(r):r}return n.count=0,0===t.highByte?k(e,n):n}const k=(t,e)=>function(){let n=r[l++];if(0===n)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),o=a[i]||I()[i];if(!o)throw new Error("Record id is not defined for "+i);return o.read||(o.read=E(o,t)),o.read()};function I(){let t=Y((()=>(r=null,h.getStructures())));return a=h._mergeStructures(t,a)}var A=O,N=O,C=O,R=O;function O(t){let e;if(t<16&&(e=L(t)))return e;if(t>64&&n)return n.decode(r.subarray(l,l+=t));const i=l+t,a=[];for(e="";l<i;){const t=r[l++];if(128&t)if(192==(224&t)){const e=63&r[l++];a.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&r[l++],n=63&r[l++];a.push((31&t)<<12|e<<6|n)}else if(240==(248&t)){let e=(7&t)<<18|(63&r[l++])<<12|(63&r[l++])<<6|63&r[l++];e>65535&&(e-=65536,a.push(e>>>10&1023|55296),e=56320|1023&e),a.push(e)}else a.push(t);else a.push(t);a.length>=4096&&(e+=F.apply(String,a),a.length=0)}return a.length>0&&(e+=F.apply(String,a)),e}function D(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=S();return h.freezeData?Object.freeze(e):e}function M(t){if(h.mapsAsObjects){let e={};for(let n=0;n<t;n++){let t=W();"__proto__"===t&&(t="__proto_"),e[t]=S()}return e}{let e=new Map;for(let n=0;n<t;n++)e.set(S(),S());return e}}var F=String.fromCharCode;function P(t){let e=l,n=new Array(t);for(let i=0;i<t;i++){const t=r[l++];if((128&t)>0)return void(l=e);n[i]=t}return F.apply(String,n)}function L(t){if(t<4){if(t<2){if(0===t)return"";{let t=r[l++];return(128&t)>1?void(l-=1):F(t)}}{let e=r[l++],n=r[l++];if((128&e)>0||(128&n)>0)return void(l-=2);if(t<3)return F(e,n);let i=r[l++];return(128&i)>0?void(l-=3):F(e,n,i)}}{let e=r[l++],n=r[l++],i=r[l++],a=r[l++];if((128&e)>0||(128&n)>0||(128&i)>0||(128&a)>0)return void(l-=4);if(t<6){if(4===t)return F(e,n,i,a);{let t=r[l++];return(128&t)>0?void(l-=5):F(e,n,i,a,t)}}if(t<8){let o=r[l++],s=r[l++];if((128&o)>0||(128&s)>0)return void(l-=6);if(t<7)return F(e,n,i,a,o,s);let u=r[l++];return(128&u)>0?void(l-=7):F(e,n,i,a,o,s,u)}{let o=r[l++],s=r[l++],u=r[l++],c=r[l++];if((128&o)>0||(128&s)>0||(128&u)>0||(128&c)>0)return void(l-=8);if(t<10){if(8===t)return F(e,n,i,a,o,s,u,c);{let t=r[l++];return(128&t)>0?void(l-=9):F(e,n,i,a,o,s,u,c,t)}}if(t<12){let h=r[l++],p=r[l++];if((128&h)>0||(128&p)>0)return void(l-=10);if(t<11)return F(e,n,i,a,o,s,u,c,h,p);let f=r[l++];return(128&f)>0?void(l-=11):F(e,n,i,a,o,s,u,c,h,p,f)}{let h=r[l++],p=r[l++],f=r[l++],d=r[l++];if((128&h)>0||(128&p)>0||(128&f)>0||(128&d)>0)return void(l-=12);if(t<14){if(12===t)return F(e,n,i,a,o,s,u,c,h,p,f,d);{let t=r[l++];return(128&t)>0?void(l-=13):F(e,n,i,a,o,s,u,c,h,p,f,d,t)}}{let m=r[l++],g=r[l++];if((128&m)>0||(128&g)>0)return void(l-=14);if(t<15)return F(e,n,i,a,o,s,u,c,h,p,f,d,m,g);let v=r[l++];return(128&v)>0?void(l-=15):F(e,n,i,a,o,s,u,c,h,p,f,d,m,g,v)}}}}}function B(){let t,e=r[l++];if(e<192)t=e-160;else switch(e){case 217:t=r[l++];break;case 218:t=c.getUint16(l),l+=2;break;case 219:t=c.getUint32(l),l+=4;break;default:throw new Error("Expected string")}return O(t)}function z(t){return h.copyBuffers?Uint8Array.prototype.slice.call(r,l,l+=t):r.subarray(l,l+=t)}function U(t){let e=r[l++];if(d[e]){let n,i=l;return d[e](r.subarray(l,n=l+=t),(t=>{l=t;try{return S()}finally{l=n}}),i)}throw new Error("Unknown extension type "+e)}var G=new Array(4096);function W(){let t=r[l++];if(!(t>=160&&t<192))return l--,V(S());if(t-=160,f>=l)return o.slice(l-p,(l+=t)-p);if(!(0==f&&i<180))return A(t);let e,n=4095&(t<<5^(t>1?c.getUint16(l):t>0?r[l]:0)),a=G[n],s=l,u=l+t-3,h=0;if(a&&a.bytes==t){for(;s<u;){if(e=c.getUint32(s),e!=a[h++]){s=1879048192;break}s+=4}for(u+=3;s<u;)if(e=r[s++],e!=a[h++]){s=1879048192;break}if(s===u)return l=s,a.string;u-=3,s=l}for(a=[],G[n]=a,a.bytes=t;s<u;)e=c.getUint32(s),a.push(e),s+=4;for(u+=3;s<u;)e=r[s++],a.push(e);let d=t<16?L(t):P(t);return a.string=null!=d?d:A(t)}function V(t){if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t.toString();if(null==t)return t+"";throw new Error("Invalid property type for record",typeof t)}const j=(t,e)=>{let n=S().map(V),r=t;void 0!==e&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let i=a[t];return i&&(i.isShared||y)&&((a.restoreStructures||(a.restoreStructures=[]))[t]=i),a[t]=n,n.read=E(n,r),n.read()};d[0]=()=>{},d[0].noBuffer=!0,d[66]=t=>{let e=t.length,n=BigInt(128&t[0]?t[0]-256:t[0]);for(let r=1;r<e;r++)n<<=8n,n+=BigInt(t[r]);return n};let H={Error,TypeError,ReferenceError};d[101]=()=>{let t=S();return(H[t[0]]||Error)(t[1])},d[105]=t=>{if(!1===h.structuredClone)throw new Error("Structured clone extension is disabled");let e=c.getUint32(l-4);u||(u=new Map);let n,i=r[l];n=i>=144&&i<160||220==i||221==i?[]:{};let a={target:n};u.set(e,a);let o=S();return a.used?Object.assign(n,o):(a.target=o,o)},d[112]=t=>{if(!1===h.structuredClone)throw new Error("Structured clone extension is disabled");let e=c.getUint32(l-4),n=u.get(e);return n.used=!0,n.target},d[115]=()=>new Set(S());const X=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((t=>t+"Array"));let q="object"==typeof globalThis?globalThis:window;d[116]=t=>{let e=t[0],n=X[e];if(!n){if(16===e){let e=new ArrayBuffer(t.length-1);return new Uint8Array(e).set(t.subarray(1)),e}throw new Error("Could not find typed array for code "+e)}return new q[n](Uint8Array.prototype.slice.call(t,1).buffer)},d[120]=()=>{let t=S();return new RegExp(t[0],t[1])};const K=[];function Y(t){let e=i,n=l,d=p,m=f,g=o,v=u,b=s,x=new Uint8Array(r.slice(0,i)),w=a,_=a.slice(0,a.length),S=h,T=y,E=t();return i=e,l=n,p=d,f=m,o=g,u=v,s=b,r=x,y=T,(a=w).splice(0,a.length,..._),h=S,c=new DataView(r.buffer,r.byteOffset,r.byteLength),E}function Z(){r=null,u=null,a=null}d[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=l;return l+=e-t.length,s=K,(s=[B(),B()]).position0=0,s.position1=0,s.postBundlePosition=l,l=n,S()},d[255]=t=>4==t.length?new Date(1e3*(16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3])):8==t.length?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+1e3*(4294967296*(3&t[3])+16777216*t[4]+(t[5]<<16)+(t[6]<<8)+t[7])):12==t.length?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+1e3*((128&t[4]?-281474976710656:0)+1099511627776*t[6]+4294967296*t[7]+16777216*t[8]+(t[9]<<16)+(t[10]<<8)+t[11])):new Date("invalid");const $=new Array(147);for(let t=0;t<256;t++)$[t]=+("1e"+Math.floor(45.15-.30103*t));const J=x;var Q=new x({useRecords:!1});const tt=Q.unpack,et=Q.unpackMultiple,nt=Q.unpack,rt={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};let it,at,ot,st=new Float32Array(1),ut=new Uint8Array(st.buffer,0,4);try{it=new TextEncoder}catch(t){}const ct=void 0!==e,lt=ct?function(t){return e.allocUnsafeSlow(t)}:Uint8Array,ht=ct?e:Uint8Array,pt=ct?4294967296:2144337920;let ft,dt,mt,gt,vt=0,yt=null;const bt=/[\u0080-\uFFFF]/,xt=Symbol("record-id");class wt extends x{constructor(t){let e,n,r,i;super(t),this.offset=0;let a=ht.prototype.utf8Write?function(t,e){return ft.utf8Write(t,e,4294967295)}:!(!it||!it.encodeInto)&&function(t,e){return it.encodeInto(t,ft.subarray(e)).written},o=this;t||(t={});let s=t&&t.sequential,u=t.structures||t.saveStructures,c=t.maxSharedStructures;if(null==c&&(c=u?32:0),c>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&null==t.moreTypes&&(this.moreTypes=!0);let l=t.maxOwnStructures;null==l&&(l=u?32:64),this.structures||0==t.useRecords||(this.structures=[]);let h=c>32||l+c>64,p=c+64,f=c+l+64;if(f>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let d=[],m=0,g=0;this.pack=this.encode=function(t,a){if(ft||(ft=new lt(8192),mt=ft.dataView||(ft.dataView=new DataView(ft.buffer,0,8192)),vt=0),gt=ft.length-10,gt-vt<2048?(ft=new lt(ft.length),mt=ft.dataView||(ft.dataView=new DataView(ft.buffer,0,ft.length)),gt=ft.length-10,vt=0):vt=vt+7&2147483640,e=vt,a&Pt&&(vt+=255&a),i=o.structuredClone?new Map:null,o.bundleStrings&&"string"!=typeof t?(yt=[],yt.size=1/0):yt=null,r=o.structures,r){r.uninitialized&&(r=o._mergeStructures(o.getStructures()));let t=r.sharedLength||0;if(t>c)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let e=0;e<t;e++){let t=r[e];if(!t)continue;let n,i=r.transitions;for(let e=0,r=t.length;e<r;e++){let r=t[e];n=i[r],n||(n=i[r]=Object.create(null)),i=n}i[xt]=e+64}this.lastNamedStructuresLength=t}s||(r.nextId=t+64)}let u;n&&(n=!1);try{o.randomAccessStructure&&t&&t.constructor&&t.constructor===Object?I(t):b(t);let n=yt;if(yt&&Et(e,b,0),i&&i.idsToInsert){let t=i.idsToInsert.sort(((t,e)=>t.offset>e.offset?1:-1)),r=t.length,a=-1;for(;n&&r>0;){let i=t[--r].offset+e;i<n.stringsPosition+e&&-1===a&&(a=0),i>n.position+e?a>=0&&(a+=6):(a>=0&&(mt.setUint32(n.position+e,mt.getUint32(n.position+e)+a),a=-1),n=n.previous,r++)}a>=0&&n&&mt.setUint32(n.position+e,mt.getUint32(n.position+e)+a),vt+=6*t.length,vt>gt&&T(vt),o.offset=vt;let s=function(t,e){let n,r=6*e.length,i=t.length-r;for(;n=e.pop();){let e=n.offset,a=n.id;t.copyWithin(e+r,e,i),r-=6;let o=e+r;t[o++]=214,t[o++]=105,t[o++]=a>>24,t[o++]=a>>16&255,t[o++]=a>>8&255,t[o++]=255&a,i=e}return t}(ft.subarray(e,vt),t);return i=null,s}return o.offset=vt,a&Mt?(ft.start=e,ft.end=vt,ft):ft.subarray(e,vt)}catch(t){throw u=t,t}finally{if(r&&(v(),n&&o.saveStructures)){let n=r.sharedLength||0,i=ft.subarray(e,vt),s=function(t,e){return t.isCompatible=t=>{let n=!t||(e.lastNamedStructuresLength||0)===t.length;return n||e._mergeStructures(t),n},t}(r,o);if(!u)return!1===o.saveStructures(s,s.isCompatible)?o.pack(t,a):(o.lastNamedStructuresLength=n,ft.length>1073741824&&(ft=null),i)}ft.length>1073741824&&(ft=null),a&Ft&&(vt=e)}};const v=()=>{g<10&&g++;let t=r.sharedLength||0;if(r.length>t&&!s&&(r.length=t),m>1e4)r.transitions=null,g=0,m=0,d.length>0&&(d=[]);else if(d.length>0&&!s){for(let t=0,e=d.length;t<e;t++)d[t][xt]=0;d=[]}},y=t=>{var e=t.length;e<16?ft[vt++]=144|e:e<65536?(ft[vt++]=220,ft[vt++]=e>>8,ft[vt++]=255&e):(ft[vt++]=221,mt.setUint32(vt,e),vt+=4);for(let n=0;n<e;n++)b(t[n])},b=t=>{vt>gt&&(ft=T(vt));var n,r=typeof t;if("string"===r){let r,i=t.length;if(yt&&i>=4&&i<4096){if((yt.size+=i)>21760){let t,n,r=(yt[0]?3*yt[0].length+yt[1].length:0)+10;vt+r>gt&&(ft=T(vt+r)),yt.position?(n=yt,ft[vt]=200,vt+=3,ft[vt++]=98,t=vt-e,vt+=4,Et(e,b,0),mt.setUint16(t+e-3,vt-e-t)):(ft[vt++]=214,ft[vt++]=98,t=vt-e,vt+=4),yt=["",""],yt.previous=n,yt.size=0,yt.position=t}let n=bt.test(t);return yt[n?0:1]+=t,ft[vt++]=193,void b(n?-i:i)}r=i<32?1:i<256?2:i<65536?3:5;let o=3*i;if(vt+o>gt&&(ft=T(vt+o)),i<64||!a){let e,a,o,s=vt+r;for(e=0;e<i;e++)a=t.charCodeAt(e),a<128?ft[s++]=a:a<2048?(ft[s++]=a>>6|192,ft[s++]=63&a|128):55296==(64512&a)&&56320==(64512&(o=t.charCodeAt(e+1)))?(a=65536+((1023&a)<<10)+(1023&o),e++,ft[s++]=a>>18|240,ft[s++]=a>>12&63|128,ft[s++]=a>>6&63|128,ft[s++]=63&a|128):(ft[s++]=a>>12|224,ft[s++]=a>>6&63|128,ft[s++]=63&a|128);n=s-vt-r}else n=a(t,vt+r);n<32?ft[vt++]=160|n:n<256?(r<2&&ft.copyWithin(vt+2,vt+1,vt+1+n),ft[vt++]=217,ft[vt++]=n):n<65536?(r<3&&ft.copyWithin(vt+3,vt+2,vt+2+n),ft[vt++]=218,ft[vt++]=n>>8,ft[vt++]=255&n):(r<5&&ft.copyWithin(vt+5,vt+3,vt+3+n),ft[vt++]=219,mt.setUint32(vt,n),vt+=4),vt+=n}else if("number"===r)if(t>>>0===t)t<32||t<128&&!1===this.useRecords||t<64&&!this.randomAccessStructure?ft[vt++]=t:t<256?(ft[vt++]=204,ft[vt++]=t):t<65536?(ft[vt++]=205,ft[vt++]=t>>8,ft[vt++]=255&t):(ft[vt++]=206,mt.setUint32(vt,t),vt+=4);else if((t|0)===t)t>=-32?ft[vt++]=256+t:t>=-128?(ft[vt++]=208,ft[vt++]=t+256):t>=-32768?(ft[vt++]=209,mt.setInt16(vt,t),vt+=2):(ft[vt++]=210,mt.setInt32(vt,t),vt+=4);else{let e;if((e=this.useFloat32)>0&&t<4294967296&&t>=-2147483648){let n;if(ft[vt++]=202,mt.setFloat32(vt,t),e<4||((n=t*$[(127&ft[vt])<<1|ft[vt+1]>>7])|0)===n)return void(vt+=4);vt--}ft[vt++]=203,mt.setFloat64(vt,t),vt+=8}else if("object"===r||"function"===r)if(t){if(i){let n=i.get(t);if(n){if(!n.id){let t=i.idsToInsert||(i.idsToInsert=[]);n.id=t.push(n)}return ft[vt++]=214,ft[vt++]=112,mt.setUint32(vt,n.id),void(vt+=4)}i.set(t,{offset:vt-e})}let a=t.constructor;if(a===Object)S(t);else if(a===Array)y(t);else if(a===Map)if(this.mapAsEmptyObject)ft[vt++]=128;else{(n=t.size)<16?ft[vt++]=128|n:n<65536?(ft[vt++]=222,ft[vt++]=n>>8,ft[vt++]=255&n):(ft[vt++]=223,mt.setUint32(vt,n),vt+=4);for(let[e,n]of t)b(e),b(n)}else{for(let n=0,r=at.length;n<r;n++){if(t instanceof ot[n]){let r=at[n];if(r.write){r.type&&(ft[vt++]=212,ft[vt++]=r.type,ft[vt++]=0);let e=r.write.call(this,t);return void(e===t?Array.isArray(t)?y(t):S(t):b(e))}let i,a=ft,o=mt,s=vt,u=e;ft=null;try{i=r.pack.call(this,t,(t=>(ft=a,a=null,vt+=t,vt>gt&&T(vt),{target:ft,targetView:mt,position:vt-t})),b)}finally{a&&(ft=a,mt=o,vt=s,e=u,gt=ft.length-10)}return void(i&&(i.length+vt>gt&&T(i.length+vt),vt=Tt(i,ft,vt,r.type)))}}if(Array.isArray(t))y(t);else{if(t.toJSON){const e=t.toJSON();if(e!==t)return b(e)}if("function"===r)return b(this.writeFunction&&this.writeFunction(t));S(t)}}}else ft[vt++]=192;else if("boolean"===r)ft[vt++]=t?195:194;else if("bigint"===r){if(t<BigInt(1)<<BigInt(63)&&t>=-(BigInt(1)<<BigInt(63)))ft[vt++]=211,mt.setBigInt64(vt,t);else if(t<BigInt(1)<<BigInt(64)&&t>0)ft[vt++]=207,mt.setBigUint64(vt,t);else{if(!this.largeBigIntToFloat){if(this.useBigIntExtension&&t<2n**1023n&&t>-(2n**1023n)){ft[vt++]=199,vt++,ft[vt++]=66;let e,n=[];do{let r=0xffn&t;e=(0x80n&r)===(t<0n?0x80n:0n),n.push(r),t>>=8n}while(0n!==t&&-1n!==t||!e);ft[vt-2]=n.length;for(let t=n.length;t>0;)ft[vt++]=Number(n[--t]);return}throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension or set largeBigIntToFloat to convert to float-64")}ft[vt++]=203,mt.setFloat64(vt,Number(t))}vt+=8}else{if("undefined"!==r)throw new Error("Unknown type: "+r);this.encodeUndefinedAsNil?ft[vt++]=192:(ft[vt++]=212,ft[vt++]=0,ft[vt++]=0)}},x=this.variableMapSize||this.coercibleKeyAsNumber?t=>{let e,n=Object.keys(t),r=n.length;if(r<16?ft[vt++]=128|r:r<65536?(ft[vt++]=222,ft[vt++]=r>>8,ft[vt++]=255&r):(ft[vt++]=223,mt.setUint32(vt,r),vt+=4),this.coercibleKeyAsNumber)for(let i=0;i<r;i++){e=n[i];let r=Number(e);b(isNaN(r)?e:r),b(t[e])}else for(let i=0;i<r;i++)b(e=n[i]),b(t[e])}:t=>{ft[vt++]=222;let n=vt-e;vt+=2;let r=0;for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&(b(e),b(t[e]),r++);ft[n+++e]=r>>8,ft[n+e]=255&r},w=!1===this.useRecords?x:t.progressiveRecords&&!h?t=>{let n,i,a=r.transitions||(r.transitions=Object.create(null)),o=vt++-e;for(let s in t)if("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(s)){if(n=a[s],n)a=n;else{let u=Object.keys(t),c=a;a=r.transitions;let l=0;for(let t=0,e=u.length;t<e;t++){let e=u[t];n=a[e],n||(n=a[e]=Object.create(null),l++),a=n}o+e+1==vt?(vt--,E(a,u,l)):k(a,u,o,l),i=!0,a=c[s]}b(t[s])}if(!i){let n=a[xt];n?ft[o+e]=n:k(a,Object.keys(t),o,0)}}:t=>{let e,n=r.transitions||(r.transitions=Object.create(null)),i=0;for(let r in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(r))&&(e=n[r],e||(e=n[r]=Object.create(null),i++),n=e);let a=n[xt];a?a>=96&&h?(ft[vt++]=96+(31&(a-=96)),ft[vt++]=a>>5):ft[vt++]=a:E(n,n.__keys__||Object.keys(t),i);for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&b(t[e])},_="function"==typeof this.useRecords&&this.useRecords,S=_?t=>{_(t)?w(t):x(t)}:w,T=t=>{let n;if(t>16777216){if(t-e>pt)throw new Error("Packed buffer would be larger than maximum buffer size");n=Math.min(pt,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else n=1+(Math.max(t-e<<2,ft.length-1)>>12)<<12;let r=new lt(n);return mt=r.dataView||(r.dataView=new DataView(r.buffer,0,n)),t=Math.min(t,ft.length),ft.copy?ft.copy(r,0,e,t):r.set(ft.slice(e,t)),vt-=e,e=0,gt=r.length-10,ft=r},E=(t,e,i)=>{let a=r.nextId;a||(a=64),a<p&&this.shouldShareStructure&&!this.shouldShareStructure(e)?(a=r.nextOwnId,a<f||(a=p),r.nextOwnId=a+1):(a>=f&&(a=p),r.nextId=a+1);let o=e.highByte=a>=96&&h?a-96>>5:-1;t[xt]=a,t.__keys__=e,r[a-64]=e,a<p?(e.isShared=!0,r.sharedLength=a-63,n=!0,o>=0?(ft[vt++]=96+(31&a),ft[vt++]=o):ft[vt++]=a):(o>=0?(ft[vt++]=213,ft[vt++]=114,ft[vt++]=96+(31&a),ft[vt++]=o):(ft[vt++]=212,ft[vt++]=114,ft[vt++]=a),i&&(m+=g*i),d.length>=l&&(d.shift()[xt]=0),d.push(t),b(e))},k=(t,n,r,i)=>{let a=ft,o=vt,s=gt,u=e;ft=dt,vt=0,e=0,ft||(dt=ft=new lt(8192)),gt=ft.length-10,E(t,n,i),dt=ft;let c=vt;if(ft=a,vt=o,gt=s,e=u,c>1){let t=vt+c-1;t>gt&&T(t);let n=r+e;ft.copyWithin(n+c,n+1,vt),ft.set(dt.slice(0,c),n),vt=t}else ft[r+e]=dt[0]},I=t=>{let i=undefined(t,ft,e,vt,r,T,((t,e,r)=>{if(r)return n=!0;vt=e;let i=ft;return b(t),v(),i!==ft?{position:vt,targetView:mt,target:ft}:vt}),this);if(0===i)return S(t);vt=i}}useBuffer(t){ft=t,mt=new DataView(ft.buffer,ft.byteOffset,ft.byteLength),vt=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}function _t(t,e,n,r){let i=t.byteLength;if(i+1<256){var{target:a,position:o}=n(4+i);a[o++]=199,a[o++]=i+1}else if(i+1<65536){var{target:a,position:o}=n(5+i);a[o++]=200,a[o++]=i+1>>8,a[o++]=i+1&255}else{var{target:a,position:o,targetView:s}=n(7+i);a[o++]=201,s.setUint32(o,i+1),o+=4}a[o++]=116,a[o++]=e,t.buffer||(t=new Uint8Array(t)),a.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function St(t,e){let n=t.byteLength;var r,i;if(n<256){var{target:r,position:i}=e(n+2);r[i++]=196,r[i++]=n}else if(n<65536){var{target:r,position:i}=e(n+3);r[i++]=197,r[i++]=n>>8,r[i++]=255&n}else{var{target:r,position:i,targetView:a}=e(n+5);r[i++]=198,a.setUint32(i,n),i+=4}r.set(t,i)}function Tt(t,e,n,r){let i=t.length;switch(i){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:i<256?(e[n++]=199,e[n++]=i):i<65536?(e[n++]=200,e[n++]=i>>8,e[n++]=255&i):(e[n++]=201,e[n++]=i>>24,e[n++]=i>>16&255,e[n++]=i>>8&255,e[n++]=255&i)}return e[n++]=r,e.set(t,n),n+=i}function Et(t,e,n){if(yt.length>0){mt.setUint32(yt.position+t,vt+n-yt.position-t),yt.stringsPosition=vt-t;let r=yt;yt=null,e(r[0]),e(r[1])}}ot=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,g],at=[{pack(t,e,n){let r=t.getTime()/1e3;if((this.useTimestamp32||0===t.getMilliseconds())&&r>=0&&r<4294967296){let{target:t,targetView:n,position:i}=e(6);t[i++]=214,t[i++]=255,n.setUint32(i,r)}else if(r>0&&r<4294967296){let{target:n,targetView:i,position:a}=e(10);n[a++]=215,n[a++]=255,i.setUint32(a,4e6*t.getMilliseconds()+(r/1e3/4294967296|0)),i.setUint32(a+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:t,targetView:r,position:i}=e(3);t[i++]=212,t[i++]=255,t[i++]=255}else{let{target:n,targetView:i,position:a}=e(15);n[a++]=199,n[a++]=12,n[a++]=255,i.setUint32(a,1e6*t.getMilliseconds()),i.setBigInt64(a+4,BigInt(Math.floor(r)))}}},{pack(t,e,n){if(this.setAsEmptyObject)return e(0),n({});let r=Array.from(t),{target:i,position:a}=e(this.moreTypes?3:0);this.moreTypes&&(i[a++]=212,i[a++]=115,i[a++]=0),n(r)}},{pack(t,e,n){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=101,r[i++]=0),n([t.name,t.message])}},{pack(t,e,n){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=120,r[i++]=0),n([t.source,t.flags])}},{pack(t,n){this.moreTypes?_t(t,16,n):St(ct?e.from(t):new Uint8Array(t),n)}},{pack(t,e){let n=t.constructor;n!==ht&&this.moreTypes?_t(t,X.indexOf(n.name),e):St(t,e)}},{pack(t,e){let{target:n,position:r}=e(1);n[r]=193}}];let kt=new wt({useRecords:!1});const It=kt.pack,At=kt.pack,Nt=wt,{NEVER:Ct,ALWAYS:Rt,DECIMAL_ROUND:Ot,DECIMAL_FIT:Dt}=rt,Mt=512,Ft=1024,Pt=2048;const Lt=function(t,n={}){if(!t||"object"!=typeof t)throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");const r=new x(n);let i;const a=t=>{let n;i&&(t=e.concat([i,t]),i=void 0);try{n=r.unpackMultiple(t)}catch(e){if(!e.incomplete)throw e;i=t.slice(e.lastPosition),n=e.values}return n};return"function"==typeof t[Symbol.iterator]?function*(){for(const e of t)yield*a(e)}():"function"==typeof t[Symbol.asyncIterator]?async function*(){for await(const e of t)yield*a(e)}():void 0},Bt=function(t,e={}){if(t&&"object"==typeof t){if("function"==typeof t[Symbol.iterator])return function*(t,e){const n=new wt(e);for(const e of t)yield n.pack(e)}(t,e);if("function"==typeof t.then||"function"==typeof t[Symbol.asyncIterator])return async function*(t,e){const n=new wt(e);for await(const e of t)yield n.pack(e)}(t,e);throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}throw new Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable")};return t.ALWAYS=Rt,t.C1=v,t.DECIMAL_FIT=Dt,t.DECIMAL_ROUND=Ot,t.Decoder=J,t.Encoder=Nt,t.FLOAT32_OPTIONS=rt,t.NEVER=Ct,t.Packr=wt,t.REUSE_BUFFER_MODE=Mt,t.Unpackr=x,t.addExtension=function(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");ot.unshift(t.Class),at.unshift(t)}!function(t){t.unpack?d[t.type]=t.unpack:d[t.type]=t}(t)},t.clearSource=Z,t.decode=nt,t.decodeIter=Lt,t.encode=At,t.encodeIter=Bt,t.isNativeAccelerationEnabled=!1,t.mapsAsObjects=!0,t.pack=It,t.roundFloat32=function(t){st[0]=t;let e=$[(127&ut[3])<<1|ut[2]>>7];return(e*t+(t>0?.5:-.5)|0)/e},t.unpack=tt,t.unpackMultiple=et,t.useRecords=!1,t}({}),r=function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default.Bits??t:t.Bits??t}var n={Bits:i};const r=Number.MAX_SAFE_INTEGER.toString(2).length;function i(t){if("number"==typeof t)this.buffer=e.alloc(Math.ceil(t/8));else{if(!(t instanceof e))throw new TypeError("Initialize by specifying a bit-length or referencing a Buffer");this.buffer=t}this._length=8*this.buffer.length,this._offset=0}return i.alloc=function(t,n,r){return new i(e.alloc(t,n,r))},i.from=function(t,n,r){return new i(e.from(t,n,r))},Object.defineProperties(i.prototype,{buffer:{enumerable:!0,writable:!0},_length:{writable:!0},_offset:{writable:!0}}),Object.defineProperty(i.prototype,"eof",{get:function(){return this._offset===this._length},configurable:!0,enumerable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this._length},configurable:!0,enumerable:!0}),Object.defineProperty(i.prototype,"offset",{get:function(){return this._offset},set:function(t){if(t<0)throw new RangeError("Cannot set offset below 0");if(t>this._length)throw new RangeError(`Cannot set offset to ${t}, buffer length is ${this._length}`);return this._offset=Math.floor(t),this},configurable:!0,enumerable:!0}),Object.defineProperty(i.prototype,"remaining",{get:function(){return this._length-this._offset},configurable:!0,enumerable:!0}),i.prototype.clear=function(t=0){return this.buffer.fill(t),this._offset=0,this},i.prototype.clearBit=function(t){return this.insert(0,1,t),this},i.prototype.flipBit=function(t){const e=1^this.peek(1,t);return this.modifyBit(e,t),e},i.prototype.getBit=function(t){return this.peek(1,t)},i.prototype.insert=function(t,e=1,n){if((n="number"==typeof n?0|n:this._offset)+e>this._length)throw new RangeError(`Cannot write ${e} bits, only ${this.remaining} bit(s) left`);if(e>r)throw new RangeError(`Cannot write ${e} bits, max is ${r}`);let i=e;for(;i>0;){const e=n>>3,r=7&n,a=Math.min(8-r,i),o=(1<<a)-1,s=8-a-r,u=(t>>>i-a&o)<<s;this.buffer[e]=this.buffer[e]&~(o<<s)|u,n+=a,i-=a}return n},i.prototype.modifyBit=function(t,e){return this.insert(t,1,e),this},i.prototype.peek=function(t=1,e){if((e="number"==typeof e?0|e:this._offset)+t>this._length)throw new RangeError(`Cannot read ${t} bits, only ${this.remaining} bit(s) left`);if(t>r)throw new RangeError(`Reading ${t} bits would overflow result, max is ${r}`);const n=7&e,i=Math.min(8-n,t),a=(1<<i)-1;let o=this.buffer[e>>3]>>8-i-n&a;e+=i;let s=t-i;for(;s>=8;)o<<=8,o|=this.buffer[e>>3],e+=8,s-=8;if(s>0){const t=8-s;o<<=s,o|=this.buffer[e>>3]>>t&255>>t}return o},i.prototype.read=function(t=1){const e=this.peek(t,this._offset);return this._offset+=t,e},i.prototype.seek=function(t,e=1){switch(e){case 2:this.offset+=t;break;case 3:this.offset=this.length-t;break;default:this.offset=t}return this},i.prototype.setBit=function(t){return this.insert(1,1,t),this},i.prototype.skip=function(t){return this.seek(t,2)},i.prototype.testBit=function(t){return!!this.peek(1,t)},i.prototype.toString=function(t="utf8"){return this.buffer.toString(t)},i.prototype.write=function(t,e=1){return this._offset=this.insert(t,e,this._offset),this},t(n)}(),i=function(t){"use strict";var e=function(){return e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},e.apply(this,arguments)};function n(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function r(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function i(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var a="3.4.2";function o(t,e){return new Promise((function(n){return setTimeout(n,t,e)}))}function s(t){return!!t&&"function"==typeof t.then}function u(t,e){try{var n=t();s(n)?n.then((function(t){return e(!0,t)}),(function(t){return e(!1,t)})):e(!0,n)}catch(t){e(!1,t)}}function c(t,e,i){return void 0===i&&(i=16),n(this,void 0,void 0,(function(){var n,a,s,u;return r(this,(function(r){switch(r.label){case 0:n=Array(t.length),a=Date.now(),s=0,r.label=1;case 1:return s<t.length?(n[s]=e(t[s],s),(u=Date.now())>=a+i?(a=u,[4,o(0)]):[3,3]):[3,4];case 2:r.sent(),r.label=3;case 3:return++s,[3,1];case 4:return[2,n]}}))}))}function l(t){t.then(void 0,(function(){}))}function h(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]+e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]+e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]+e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]+e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function p(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]*e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]*e[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=t[3]*e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]*e[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[2]*e[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[3]*e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]*e[3]+t[1]*e[2]+t[2]*e[1]+t[3]*e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function f(t,e){return 32===(e%=64)?[t[1],t[0]]:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e|t[0]>>>32-e]:(e-=32,[t[1]<<e|t[0]>>>32-e,t[0]<<e|t[1]>>>32-e])}function d(t,e){return 0===(e%=64)?t:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e]:[t[1]<<e-32,0]}function m(t,e){return[t[0]^e[0],t[1]^e[1]]}function g(t){return t=m(t,[0,t[0]>>>1]),t=m(t=p(t,[4283543511,3981806797]),[0,t[0]>>>1]),t=m(t=p(t,[3301882366,444984403]),[0,t[0]>>>1])}function v(t,e){e=e||0;var n,r=(t=t||"").length%16,i=t.length-r,a=[0,e],o=[0,e],s=[0,0],u=[0,0],c=[2277735313,289559509],l=[1291169091,658871167];for(n=0;n<i;n+=16)s=[255&t.charCodeAt(n+4)|(255&t.charCodeAt(n+5))<<8|(255&t.charCodeAt(n+6))<<16|(255&t.charCodeAt(n+7))<<24,255&t.charCodeAt(n)|(255&t.charCodeAt(n+1))<<8|(255&t.charCodeAt(n+2))<<16|(255&t.charCodeAt(n+3))<<24],u=[255&t.charCodeAt(n+12)|(255&t.charCodeAt(n+13))<<8|(255&t.charCodeAt(n+14))<<16|(255&t.charCodeAt(n+15))<<24,255&t.charCodeAt(n+8)|(255&t.charCodeAt(n+9))<<8|(255&t.charCodeAt(n+10))<<16|(255&t.charCodeAt(n+11))<<24],s=f(s=p(s,c),31),a=h(a=f(a=m(a,s=p(s,l)),27),o),a=h(p(a,[0,5]),[0,1390208809]),u=f(u=p(u,l),33),o=h(o=f(o=m(o,u=p(u,c)),31),a),o=h(p(o,[0,5]),[0,944331445]);switch(s=[0,0],u=[0,0],r){case 15:u=m(u,d([0,t.charCodeAt(n+14)],48));case 14:u=m(u,d([0,t.charCodeAt(n+13)],40));case 13:u=m(u,d([0,t.charCodeAt(n+12)],32));case 12:u=m(u,d([0,t.charCodeAt(n+11)],24));case 11:u=m(u,d([0,t.charCodeAt(n+10)],16));case 10:u=m(u,d([0,t.charCodeAt(n+9)],8));case 9:u=p(u=m(u,[0,t.charCodeAt(n+8)]),l),o=m(o,u=p(u=f(u,33),c));case 8:s=m(s,d([0,t.charCodeAt(n+7)],56));case 7:s=m(s,d([0,t.charCodeAt(n+6)],48));case 6:s=m(s,d([0,t.charCodeAt(n+5)],40));case 5:s=m(s,d([0,t.charCodeAt(n+4)],32));case 4:s=m(s,d([0,t.charCodeAt(n+3)],24));case 3:s=m(s,d([0,t.charCodeAt(n+2)],16));case 2:s=m(s,d([0,t.charCodeAt(n+1)],8));case 1:s=p(s=m(s,[0,t.charCodeAt(n)]),c),a=m(a,s=p(s=f(s,31),l))}return a=h(a=m(a,[0,t.length]),o=m(o,[0,t.length])),o=h(o,a),a=h(a=g(a),o=g(o)),o=h(o,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(o[0]>>>0).toString(16)).slice(-8)+("00000000"+(o[1]>>>0).toString(16)).slice(-8)}function y(t){return parseInt(t)}function b(t){return parseFloat(t)}function x(t,e){return"number"==typeof t&&isNaN(t)?e:t}function w(t){return t.reduce((function(t,e){return t+(e?1:0)}),0)}function _(t,e){if(void 0===e&&(e=1),Math.abs(e)>=1)return Math.round(t/e)*e;var n=1/e;return Math.round(t*n)/n}function S(t){return t&&"object"==typeof t&&"message"in t?t:{message:t}}function T(t){return"function"!=typeof t}function E(t,e,i){var a=Object.keys(t).filter((function(t){return!function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return!0;return!1}(i,t)})),o=c(a,(function(n){return function(t,e){var n=new Promise((function(n){var r=Date.now();u(t.bind(null,e),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=Date.now()-r;if(!t[0])return n((function(){return{error:S(t[1]),duration:i}}));var a=t[1];if(T(a))return n((function(){return{value:a,duration:i}}));n((function(){return new Promise((function(t){var e=Date.now();u(a,(function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=i+Date.now()-e;if(!n[0])return t({error:S(n[1]),duration:a});t({value:n[1],duration:a})}))}))}))}))}));return l(n),function(){return n.then((function(t){return t()}))}}(t[n],e)}));return l(o),function(){return n(this,void 0,void 0,(function(){var t,e,n,i;return r(this,(function(r){switch(r.label){case 0:return[4,o];case 1:return[4,c(r.sent(),(function(t){var e=t();return l(e),e}))];case 2:return t=r.sent(),[4,Promise.all(t)];case 3:for(e=r.sent(),n={},i=0;i<a.length;++i)n[a[i]]=e[i];return[2,n]}}))}))}}function k(){var t=window,e=navigator;return w(["MSCSSMatrix"in t,"msSetImmediate"in t,"msIndexedDB"in t,"msMaxTouchPoints"in e,"msPointerEnabled"in e])>=4}function I(){var t=window,e=navigator;return w(["msWriteProfilerMark"in t,"MSStream"in t,"msLaunchUri"in e,"msSaveBlob"in e])>=3&&!k()}function A(){var t=window,e=navigator;return w(["webkitPersistentStorage"in e,"webkitTemporaryStorage"in e,0===e.vendor.indexOf("Google"),"webkitResolveLocalFileSystemURL"in t,"BatteryManager"in t,"webkitMediaStream"in t,"webkitSpeechGrammar"in t])>=5}function N(){var t=window,e=navigator;return w(["ApplePayError"in t,"CSSPrimitiveValue"in t,"Counter"in t,0===e.vendor.indexOf("Apple"),"getStorageUpdates"in e,"WebKitMediaKeys"in t])>=4}function C(){var t=window;return w(["safari"in t,!("DeviceMotionEvent"in t),!("ongestureend"in t),!("standalone"in navigator)])>=3}function R(){var t,e,n=window;return w(["buildID"in navigator,"MozAppearance"in(null!==(e=null===(t=document.documentElement)||void 0===t?void 0:t.style)&&void 0!==e?e:{}),"onmozfullscreenchange"in n,"mozInnerScreenX"in n,"CSSMozDocumentRule"in n,"CanvasCaptureMediaStream"in n])>=4}function O(){var t=document;return t.fullscreenElement||t.msFullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||null}function D(){var t=A(),e=R();if(!t&&!e)return!1;var n=window;return w(["onorientationchange"in n,"orientation"in n,t&&!("SharedWorker"in n),e&&/android/i.test(navigator.appVersion)])>=2}function M(t){var e=new Error(t);return e.name=t,e}function F(t,e,i){var a,s,u;return void 0===i&&(i=50),n(this,void 0,void 0,(function(){var n,c;return r(this,(function(r){switch(r.label){case 0:n=document,r.label=1;case 1:return n.body?[3,3]:[4,o(i)];case 2:return r.sent(),[3,1];case 3:c=n.createElement("iframe"),r.label=4;case 4:return r.trys.push([4,,10,11]),[4,new Promise((function(t,r){var i=!1,a=function(){i=!0,t()};c.onload=a,c.onerror=function(t){i=!0,r(t)};var o=c.style;o.setProperty("display","block","important"),o.position="absolute",o.top="0",o.left="0",o.visibility="hidden",e&&"srcdoc"in c?c.srcdoc=e:c.src="about:blank",n.body.appendChild(c);var s=function(){var t,e;i||("complete"===(null===(e=null===(t=c.contentWindow)||void 0===t?void 0:t.document)||void 0===e?void 0:e.readyState)?a():setTimeout(s,10))};s()}))];case 5:r.sent(),r.label=6;case 6:return(null===(s=null===(a=c.contentWindow)||void 0===a?void 0:a.document)||void 0===s?void 0:s.body)?[3,8]:[4,o(i)];case 7:return r.sent(),[3,6];case 8:return[4,t(c,c.contentWindow)];case 9:return[2,r.sent()];case 10:return null===(u=c.parentNode)||void 0===u||u.removeChild(c),[7];case 11:return[2]}}))}))}function P(t){for(var e=function(t){for(var e,n,r="Unexpected syntax '".concat(t,"'"),i=/^\s*([a-z-]*)(.*)$/i.exec(t),a=i[1]||void 0,o={},s=/([.:#][\w-]+|\[.+?\])/gi,u=function(t,e){o[t]=o[t]||[],o[t].push(e)};;){var c=s.exec(i[2]);if(!c)break;var l=c[0];switch(l[0]){case".":u("class",l.slice(1));break;case"#":u("id",l.slice(1));break;case"[":var h=/^\[([\w-]+)([~|^$*]?=("(.*?)"|([\w-]+)))?(\s+[is])?\]$/.exec(l);if(!h)throw new Error(r);u(h[1],null!==(n=null!==(e=h[4])&&void 0!==e?e:h[5])&&void 0!==n?n:"");break;default:throw new Error(r)}}return[a,o]}(t),n=e[0],r=e[1],i=document.createElement(null!=n?n:"div"),a=0,o=Object.keys(r);a<o.length;a++){var s=o[a],u=r[s].join(" ");"style"===s?L(i.style,u):i.setAttribute(s,u)}return i}function L(t,e){for(var n=0,r=e.split(";");n<r.length;n++){var i=r[n],a=/^\s*([\w-]+)\s*:\s*(.+?)(\s*!([\w-]+))?\s*$/.exec(i);if(a){var o=a[1],s=a[2],u=a[4];t.setProperty(o,s,u||"")}}}var B=["monospace","sans-serif","serif"],z=["sans-serif-thin","ARNO PRO","Agency FB","Arabic Typesetting","Arial Unicode MS","AvantGarde Bk BT","BankGothic Md BT","Batang","Bitstream Vera Sans Mono","Calibri","Century","Century Gothic","Clarendon","EUROSTILE","Franklin Gothic","Futura Bk BT","Futura Md BT","GOTHAM","Gill Sans","HELV","Haettenschweiler","Helvetica Neue","Humanst521 BT","Leelawadee","Letter Gothic","Levenim MT","Lucida Bright","Lucida Sans","Menlo","MS Mincho","MS Outlook","MS Reference Specialty","MS UI Gothic","MT Extra","MYRIAD PRO","Marlett","Meiryo UI","Microsoft Uighur","Minion Pro","Monotype Corsiva","PMingLiU","Pristina","SCRIPTINA","Segoe UI Light","Serifa","SimHei","Small Fonts","Staccato222 BT","TRAJAN PRO","Univers CE 55 Medium","Vrinda","ZWAdobeF"];function U(t){return t.toDataURL()}var G,W,V=2500;function j(){var t=this;return function(){if(void 0===W){var t=function(){var e=H();X(e)?W=setTimeout(t,V):(G=e,W=void 0)};t()}}(),function(){return n(t,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return X(t=H())?G?[2,i([],G,!0)]:O()?[4,(n=document,(n.exitFullscreen||n.msExitFullscreen||n.mozCancelFullScreen||n.webkitExitFullscreen).call(n))]:[3,2]:[3,2];case 1:e.sent(),t=H(),e.label=2;case 2:return X(t)||(G=t),[2,t]}var n}))}))}}function H(){var t=screen;return[x(b(t.availTop),null),x(b(t.width)-b(t.availWidth)-x(b(t.availLeft),0),null),x(b(t.height)-b(t.availHeight)-x(b(t.availTop),0),null),x(b(t.availLeft),null)]}function X(t){for(var e=0;e<4;++e)if(t[e])return!1;return!0}function q(t){var e;return n(this,void 0,void 0,(function(){var n,i,a,s,u,c,l;return r(this,(function(r){switch(r.label){case 0:for(n=document,i=n.createElement("div"),a=new Array(t.length),s={},K(i),l=0;l<t.length;++l)"DIALOG"===(u=P(t[l])).tagName&&u.show(),K(c=n.createElement("div")),c.appendChild(u),i.appendChild(c),a[l]=u;r.label=1;case 1:return n.body?[3,3]:[4,o(50)];case 2:return r.sent(),[3,1];case 3:n.body.appendChild(i);try{for(l=0;l<t.length;++l)a[l].offsetParent||(s[t[l]]=!0)}finally{null===(e=i.parentNode)||void 0===e||e.removeChild(i)}return[2,s]}}))}))}function K(t){t.style.setProperty("display","block","important")}function Y(t){return matchMedia("(inverted-colors: ".concat(t,")")).matches}function Z(t){return matchMedia("(forced-colors: ".concat(t,")")).matches}function $(t){return matchMedia("(prefers-contrast: ".concat(t,")")).matches}function J(t){return matchMedia("(prefers-reduced-motion: ".concat(t,")")).matches}function Q(t){return matchMedia("(dynamic-range: ".concat(t,")")).matches}var tt=Math,et=function(){return 0};var nt={default:[],apple:[{font:"-apple-system-body"}],serif:[{fontFamily:"serif"}],sans:[{fontFamily:"sans-serif"}],mono:[{fontFamily:"monospace"}],min:[{fontSize:"1px"}],system:[{fontFamily:"system-ui"}]};var rt={fonts:function(){return F((function(t,e){var n=e.document,r=n.body;r.style.fontSize="48px";var i=n.createElement("div"),a={},o={},s=function(t){var e=n.createElement("span"),r=e.style;return r.position="absolute",r.top="0",r.left="0",r.fontFamily=t,e.textContent="mmMwWLliI0O&1",i.appendChild(e),e},u=B.map(s),c=function(){for(var t={},e=function(e){t[e]=B.map((function(t){return function(t,e){return s("'".concat(t,"',").concat(e))}(e,t)}))},n=0,r=z;n<r.length;n++){e(r[n])}return t}();r.appendChild(i);for(var l=0;l<B.length;l++)a[B[l]]=u[l].offsetWidth,o[B[l]]=u[l].offsetHeight;return z.filter((function(t){return e=c[t],B.some((function(t,n){return e[n].offsetWidth!==a[t]||e[n].offsetHeight!==o[t]}));var e}))}))},domBlockers:function(t){var e=(void 0===t?{}:t).debug;return n(this,void 0,void 0,(function(){var t,n,i,a,o;return r(this,(function(r){switch(r.label){case 0:return N()||D()?(s=atob,t={abpIndo:["#Iklan-Melayang","#Kolom-Iklan-728","#SidebarIklan-wrapper",'[title="ALIENBOLA" i]',s("I0JveC1CYW5uZXItYWRz")],abpvn:[".quangcao","#mobileCatfish",s("LmNsb3NlLWFkcw=="),'[id^="bn_bottom_fixed_"]',"#pmadv"],adBlockFinland:[".mainostila",s("LnNwb25zb3JpdA=="),".ylamainos",s("YVtocmVmKj0iL2NsaWNrdGhyZ2guYXNwPyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9hcHAucmVhZHBlYWsuY29tL2FkcyJd")],adBlockPersian:["#navbar_notice_50",".kadr",'TABLE[width="140px"]',"#divAgahi",s("YVtocmVmXj0iaHR0cDovL2cxLnYuZndtcm0ubmV0L2FkLyJd")],adBlockWarningRemoval:["#adblock-honeypot",".adblocker-root",".wp_adblock_detect",s("LmhlYWRlci1ibG9ja2VkLWFk"),s("I2FkX2Jsb2NrZXI=")],adGuardAnnoyances:[".hs-sosyal","#cookieconsentdiv",'div[class^="app_gdpr"]',".as-oil",'[data-cypress="soft-push-notification-modal"]'],adGuardBase:[".BetterJsPopOverlay",s("I2FkXzMwMFgyNTA="),s("I2Jhbm5lcmZsb2F0MjI="),s("I2NhbXBhaWduLWJhbm5lcg=="),s("I0FkLUNvbnRlbnQ=")],adGuardChinese:[s("LlppX2FkX2FfSA=="),s("YVtocmVmKj0iLmh0aGJldDM0LmNvbSJd"),"#widget-quan",s("YVtocmVmKj0iLzg0OTkyMDIwLnh5eiJd"),s("YVtocmVmKj0iLjE5NTZobC5jb20vIl0=")],adGuardFrench:["#pavePub",s("LmFkLWRlc2t0b3AtcmVjdGFuZ2xl"),".mobile_adhesion",".widgetadv",s("LmFkc19iYW4=")],adGuardGerman:['aside[data-portal-id="leaderboard"]'],adGuardJapanese:["#kauli_yad_1",s("YVtocmVmXj0iaHR0cDovL2FkMi50cmFmZmljZ2F0ZS5uZXQvIl0="),s("Ll9wb3BJbl9pbmZpbml0ZV9hZA=="),s("LmFkZ29vZ2xl"),s("Ll9faXNib29zdFJldHVybkFk")],adGuardMobile:[s("YW1wLWF1dG8tYWRz"),s("LmFtcF9hZA=="),'amp-embed[type="24smi"]',"#mgid_iframe1",s("I2FkX2ludmlld19hcmVh")],adGuardRussian:[s("YVtocmVmXj0iaHR0cHM6Ly9hZC5sZXRtZWFkcy5jb20vIl0="),s("LnJlY2xhbWE="),'div[id^="smi2adblock"]',s("ZGl2W2lkXj0iQWRGb3hfYmFubmVyXyJd"),"#psyduckpockeball"],adGuardSocial:[s("YVtocmVmXj0iLy93d3cuc3R1bWJsZXVwb24uY29tL3N1Ym1pdD91cmw9Il0="),s("YVtocmVmXj0iLy90ZWxlZ3JhbS5tZS9zaGFyZS91cmw/Il0="),".etsy-tweet","#inlineShare",".popup-social"],adGuardSpanishPortuguese:["#barraPublicidade","#Publicidade","#publiEspecial","#queTooltip",".cnt-publi"],adGuardTrackingProtection:["#qoo-counter",s("YVtocmVmXj0iaHR0cDovL2NsaWNrLmhvdGxvZy5ydS8iXQ=="),s("YVtocmVmXj0iaHR0cDovL2hpdGNvdW50ZXIucnUvdG9wL3N0YXQucGhwIl0="),s("YVtocmVmXj0iaHR0cDovL3RvcC5tYWlsLnJ1L2p1bXAiXQ=="),"#top100counter"],adGuardTurkish:["#backkapat",s("I3Jla2xhbWk="),s("YVtocmVmXj0iaHR0cDovL2Fkc2Vydi5vbnRlay5jb20udHIvIl0="),s("YVtocmVmXj0iaHR0cDovL2l6bGVuemkuY29tL2NhbXBhaWduLyJd"),s("YVtocmVmXj0iaHR0cDovL3d3dy5pbnN0YWxsYWRzLm5ldC8iXQ==")],bulgarian:[s("dGQjZnJlZW5ldF90YWJsZV9hZHM="),"#ea_intext_div",".lapni-pop-over","#xenium_hot_offers"],easyList:[".yb-floorad",s("LndpZGdldF9wb19hZHNfd2lkZ2V0"),s("LnRyYWZmaWNqdW5reS1hZA=="),".textad_headline",s("LnNwb25zb3JlZC10ZXh0LWxpbmtz")],easyListChina:[s("LmFwcGd1aWRlLXdyYXBbb25jbGljayo9ImJjZWJvcy5jb20iXQ=="),s("LmZyb250cGFnZUFkdk0="),"#taotaole","#aafoot.top_box",".cfa_popup"],easyListCookie:[".ezmob-footer",".cc-CookieWarning","[data-cookie-number]",s("LmF3LWNvb2tpZS1iYW5uZXI="),".sygnal24-gdpr-modal-wrap"],easyListCzechSlovak:["#onlajny-stickers",s("I3Jla2xhbW5pLWJveA=="),s("LnJla2xhbWEtbWVnYWJvYXJk"),".sklik",s("W2lkXj0ic2tsaWtSZWtsYW1hIl0=")],easyListDutch:[s("I2FkdmVydGVudGll"),s("I3ZpcEFkbWFya3RCYW5uZXJCbG9jaw=="),".adstekst",s("YVtocmVmXj0iaHR0cHM6Ly94bHR1YmUubmwvY2xpY2svIl0="),"#semilo-lrectangle"],easyListGermany:["#SSpotIMPopSlider",s("LnNwb25zb3JsaW5rZ3J1ZW4="),s("I3dlcmJ1bmdza3k="),s("I3Jla2xhbWUtcmVjaHRzLW1pdHRl"),s("YVtocmVmXj0iaHR0cHM6Ly9iZDc0Mi5jb20vIl0=")],easyListItaly:[s("LmJveF9hZHZfYW5udW5jaQ=="),".sb-box-pubbliredazionale",s("YVtocmVmXj0iaHR0cDovL2FmZmlsaWF6aW9uaWFkcy5zbmFpLml0LyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9hZHNlcnZlci5odG1sLml0LyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9hZmZpbGlhemlvbmlhZHMuc25haS5pdC8iXQ==")],easyListLithuania:[s("LnJla2xhbW9zX3RhcnBhcw=="),s("LnJla2xhbW9zX251b3JvZG9z"),s("aW1nW2FsdD0iUmVrbGFtaW5pcyBza3lkZWxpcyJd"),s("aW1nW2FsdD0iRGVkaWt1b3RpLmx0IHNlcnZlcmlhaSJd"),s("aW1nW2FsdD0iSG9zdGluZ2FzIFNlcnZlcmlhaS5sdCJd")],estonian:[s("QVtocmVmKj0iaHR0cDovL3BheTRyZXN1bHRzMjQuZXUiXQ==")],fanboyAnnoyances:["#ac-lre-player",".navigate-to-top","#subscribe_popup",".newsletter_holder","#back-top"],fanboyAntiFacebook:[".util-bar-module-firefly-visible"],fanboyEnhancedTrackers:[".open.pushModal","#issuem-leaky-paywall-articles-zero-remaining-nag","#sovrn_container",'div[class$="-hide"][zoompage-fontsize][style="display: block;"]',".BlockNag__Card"],fanboySocial:["#FollowUs","#meteored_share","#social_follow",".article-sharer",".community__social-desc"],frellwitSwedish:[s("YVtocmVmKj0iY2FzaW5vcHJvLnNlIl1bdGFyZ2V0PSJfYmxhbmsiXQ=="),s("YVtocmVmKj0iZG9rdG9yLXNlLm9uZWxpbmsubWUiXQ=="),"article.category-samarbete",s("ZGl2LmhvbGlkQWRz"),"ul.adsmodern"],greekAdBlock:[s("QVtocmVmKj0iYWRtYW4ub3RlbmV0LmdyL2NsaWNrPyJd"),s("QVtocmVmKj0iaHR0cDovL2F4aWFiYW5uZXJzLmV4b2R1cy5nci8iXQ=="),s("QVtocmVmKj0iaHR0cDovL2ludGVyYWN0aXZlLmZvcnRobmV0LmdyL2NsaWNrPyJd"),"DIV.agores300","TABLE.advright"],hungarian:["#cemp_doboz",".optimonk-iframe-container",s("LmFkX19tYWlu"),s("W2NsYXNzKj0iR29vZ2xlQWRzIl0="),"#hirdetesek_box"],iDontCareAboutCookies:['.alert-info[data-block-track*="CookieNotice"]',".ModuleTemplateCookieIndicator",".o--cookies--container","#cookies-policy-sticky","#stickyCookieBar"],icelandicAbp:[s("QVtocmVmXj0iL2ZyYW1ld29yay9yZXNvdXJjZXMvZm9ybXMvYWRzLmFzcHgiXQ==")],latvian:[s("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiAxMjBweDsgaGVpZ2h0OiA0MHB4OyBvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjogcmVsYXRpdmU7Il0="),s("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiA4OHB4OyBoZWlnaHQ6IDMxcHg7IG92ZXJmbG93OiBoaWRkZW47IHBvc2l0aW9uOiByZWxhdGl2ZTsiXQ==")],listKr:[s("YVtocmVmKj0iLy9hZC5wbGFuYnBsdXMuY28ua3IvIl0="),s("I2xpdmVyZUFkV3JhcHBlcg=="),s("YVtocmVmKj0iLy9hZHYuaW1hZHJlcC5jby5rci8iXQ=="),s("aW5zLmZhc3R2aWV3LWFk"),".revenue_unit_item.dable"],listeAr:[s("LmdlbWluaUxCMUFk"),".right-and-left-sponsers",s("YVtocmVmKj0iLmFmbGFtLmluZm8iXQ=="),s("YVtocmVmKj0iYm9vcmFxLm9yZyJd"),s("YVtocmVmKj0iZHViaXp6bGUuY29tL2FyLz91dG1fc291cmNlPSJd")],listeFr:[s("YVtocmVmXj0iaHR0cDovL3Byb21vLnZhZG9yLmNvbS8iXQ=="),s("I2FkY29udGFpbmVyX3JlY2hlcmNoZQ=="),s("YVtocmVmKj0id2Vib3JhbWEuZnIvZmNnaS1iaW4vIl0="),".site-pub-interstitiel",'div[id^="crt-"][data-criteo-id]'],officialPolish:["#ceneo-placeholder-ceneo-12",s("W2hyZWZePSJodHRwczovL2FmZi5zZW5kaHViLnBsLyJd"),s("YVtocmVmXj0iaHR0cDovL2Fkdm1hbmFnZXIudGVjaGZ1bi5wbC9yZWRpcmVjdC8iXQ=="),s("YVtocmVmXj0iaHR0cDovL3d3dy50cml6ZXIucGwvP3V0bV9zb3VyY2UiXQ=="),s("ZGl2I3NrYXBpZWNfYWQ=")],ro:[s("YVtocmVmXj0iLy9hZmZ0cmsuYWx0ZXgucm8vQ291bnRlci9DbGljayJd"),s("YVtocmVmXj0iaHR0cHM6Ly9ibGFja2ZyaWRheXNhbGVzLnJvL3Ryay9zaG9wLyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9ldmVudC4ycGVyZm9ybWFudC5jb20vZXZlbnRzL2NsaWNrIl0="),s("YVtocmVmXj0iaHR0cHM6Ly9sLnByb2ZpdHNoYXJlLnJvLyJd"),'a[href^="/url/"]'],ruAd:[s("YVtocmVmKj0iLy9mZWJyYXJlLnJ1LyJd"),s("YVtocmVmKj0iLy91dGltZy5ydS8iXQ=="),s("YVtocmVmKj0iOi8vY2hpa2lkaWtpLnJ1Il0="),"#pgeldiz",".yandex-rtb-block"],thaiAds:["a[href*=macau-uta-popup]",s("I2Fkcy1nb29nbGUtbWlkZGxlX3JlY3RhbmdsZS1ncm91cA=="),s("LmFkczMwMHM="),".bumq",".img-kosana"],webAnnoyancesUltralist:["#mod-social-share-2","#social-tools",s("LmN0cGwtZnVsbGJhbm5lcg=="),".zergnet-recommend",".yt.btn-link.btn-md.btn"]},n=Object.keys(t),[4,q((o=[]).concat.apply(o,n.map((function(e){return t[e]}))))]):[2,void 0];case 1:return i=r.sent(),e&&function(t,e){for(var n="DOM blockers debug:\n```",r=0,i=Object.keys(t);r<i.length;r++){var a=i[r];n+="\n".concat(a,":");for(var o=0,s=t[a];o<s.length;o++){var u=s[o];n+="\n  ".concat(e[u]?"":""," ").concat(u)}}console.log("".concat(n,"\n```"))}(t,i),(a=n.filter((function(e){var n=t[e];return w(n.map((function(t){return i[t]})))>.6*n.length}))).sort(),[2,a]}var s}))}))},fontPreferences:function(){return function(t,e){void 0===e&&(e=4e3);return F((function(n,r){var a=r.document,o=a.body,s=o.style;s.width="".concat(e,"px"),s.webkitTextSizeAdjust=s.textSizeAdjust="none",A()?o.style.zoom="".concat(1/r.devicePixelRatio):N()&&(o.style.zoom="reset");var u=a.createElement("div");return u.textContent=i([],Array(e/20|0),!0).map((function(){return"word"})).join(" "),o.appendChild(u),t(a,o)}),'<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1">')}((function(t,e){for(var n={},r={},i=0,a=Object.keys(nt);i<a.length;i++){var o=a[i],s=nt[o],u=s[0],c=void 0===u?{}:u,l=s[1],h=void 0===l?"mmMwWLliI0fiflO&1":l,p=t.createElement("span");p.textContent=h,p.style.whiteSpace="nowrap";for(var f=0,d=Object.keys(c);f<d.length;f++){var m=d[f],g=c[m];void 0!==g&&(p.style[m]=g)}n[o]=p,e.appendChild(t.createElement("br")),e.appendChild(p)}for(var v=0,y=Object.keys(nt);v<y.length;v++){r[o=y[v]]=n[o].getBoundingClientRect().width}return r}))},audio:function(){var t=window,e=t.OfflineAudioContext||t.webkitOfflineAudioContext;if(!e)return-2;if(N()&&!C()&&!function(){var t=window;return w(["DOMRectList"in t,"RTCPeerConnectionIceEvent"in t,"SVGGeometryElement"in t,"ontransitioncancel"in t])>=3}())return-1;var n=new e(1,5e3,44100),r=n.createOscillator();r.type="triangle",r.frequency.value=1e4;var i=n.createDynamicsCompressor();i.threshold.value=-50,i.knee.value=40,i.ratio.value=12,i.attack.value=0,i.release.value=.25,r.connect(i),i.connect(n.destination),r.start(0);var a=function(t){var e=3,n=500,r=500,i=5e3,a=function(){},o=new Promise((function(o,u){var c=!1,h=0,p=0;t.oncomplete=function(t){return o(t.renderedBuffer)};var f=function(){setTimeout((function(){return u(M("timeout"))}),Math.min(r,p+i-Date.now()))},d=function(){try{var r=t.startRendering();switch(s(r)&&l(r),t.state){case"running":p=Date.now(),c&&f();break;case"suspended":document.hidden||h++,c&&h>=e?u(M("suspended")):setTimeout(d,n)}}catch(t){u(t)}};d(),a=function(){c||(c=!0,p>0&&f())}}));return[o,a]}(n),o=a[0],u=a[1],c=o.then((function(t){return function(t){for(var e=0,n=0;n<t.length;++n)e+=Math.abs(t[n]);return e}(t.getChannelData(0).subarray(4500))}),(function(t){if("timeout"===t.name||"suspended"===t.name)return-3;throw t}));return l(c),function(){return u(),c}},screenFrame:function(){var t=this,e=j();return function(){return n(t,void 0,void 0,(function(){var t,n;return r(this,(function(r){switch(r.label){case 0:return[4,e()];case 1:return t=r.sent(),[2,[(n=function(t){return null===t?null:_(t,10)})(t[0]),n(t[1]),n(t[2]),n(t[3])]]}}))}))}},osCpu:function(){return navigator.oscpu},languages:function(){var t,e=navigator,n=[],r=e.language||e.userLanguage||e.browserLanguage||e.systemLanguage;if(void 0!==r&&n.push([r]),Array.isArray(e.languages))A()&&w([!("MediaSettingsRange"in(t=window)),"RTCEncodedAudioFrame"in t,""+t.Intl=="[object Intl]",""+t.Reflect=="[object Reflect]"])>=3||n.push(e.languages);else if("string"==typeof e.languages){var i=e.languages;i&&n.push(i.split(","))}return n},colorDepth:function(){return window.screen.colorDepth},deviceMemory:function(){return x(b(navigator.deviceMemory),void 0)},screenResolution:function(){var t=screen,e=function(t){return x(y(t),null)},n=[e(t.width),e(t.height)];return n.sort().reverse(),n},hardwareConcurrency:function(){return x(y(navigator.hardwareConcurrency),void 0)},timezone:function(){var t,e=null===(t=window.Intl)||void 0===t?void 0:t.DateTimeFormat;if(e){var n=(new e).resolvedOptions().timeZone;if(n)return n}var r,i=(r=(new Date).getFullYear(),-Math.max(b(new Date(r,0,1).getTimezoneOffset()),b(new Date(r,6,1).getTimezoneOffset())));return"UTC".concat(i>=0?"+":"").concat(Math.abs(i))},sessionStorage:function(){try{return!!window.sessionStorage}catch(t){return!0}},localStorage:function(){try{return!!window.localStorage}catch(t){return!0}},indexedDB:function(){if(!k()&&!I())try{return!!window.indexedDB}catch(t){return!0}},openDatabase:function(){return!!window.openDatabase},cpuClass:function(){return navigator.cpuClass},platform:function(){var t=navigator.platform;return"MacIntel"===t&&N()&&!C()?function(){if("iPad"===navigator.platform)return!0;var t=screen,e=t.width/t.height;return w(["MediaSource"in window,!!Element.prototype.webkitRequestFullscreen,e>.65&&e<1.53])>=2}()?"iPad":"iPhone":t},plugins:function(){var t=navigator.plugins;if(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];if(r){for(var i=[],a=0;a<r.length;++a){var o=r[a];i.push({type:o.type,suffixes:o.suffixes})}e.push({name:r.name,description:r.description,mimeTypes:i})}}return e}},canvas:function(){var t,e,n=!1,r=function(){var t=document.createElement("canvas");return t.width=1,t.height=1,[t,t.getContext("2d")]}(),i=r[0],a=r[1];if(function(t,e){return!(!e||!t.toDataURL)}(i,a)){n=function(t){return t.rect(0,0,10,10),t.rect(2,2,6,6),!t.isPointInPath(5,5,"evenodd")}(a),function(t,e){t.width=240,t.height=60,e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(100,1,62,20),e.fillStyle="#069",e.font='11pt "Times New Roman"';var n="Cwm fjordbank gly ".concat(String.fromCharCode(55357,56835));e.fillText(n,2,15),e.fillStyle="rgba(102, 204, 0, 0.2)",e.font="18pt Arial",e.fillText(n,4,45)}(i,a);var o=U(i);o!==U(i)?t=e="unstable":(e=o,function(t,e){t.width=122,t.height=110,e.globalCompositeOperation="multiply";for(var n=0,r=[["#f2f",40,40],["#2ff",80,40],["#ff2",60,80]];n<r.length;n++){var i=r[n],a=i[0],o=i[1],s=i[2];e.fillStyle=a,e.beginPath(),e.arc(o,s,40,0,2*Math.PI,!0),e.closePath(),e.fill()}e.fillStyle="#f9c",e.arc(60,60,60,0,2*Math.PI,!0),e.arc(60,60,20,0,2*Math.PI,!0),e.fill("evenodd")}(i,a),t=U(i))}else t=e="";return{winding:n,geometry:t,text:e}},touchSupport:function(){var t,e=navigator,n=0;void 0!==e.maxTouchPoints?n=y(e.maxTouchPoints):void 0!==e.msMaxTouchPoints&&(n=e.msMaxTouchPoints);try{document.createEvent("TouchEvent"),t=!0}catch(e){t=!1}return{maxTouchPoints:n,touchEvent:t,touchStart:"ontouchstart"in window}},vendor:function(){return navigator.vendor||""},vendorFlavors:function(){for(var t=[],e=0,n=["chrome","safari","__crWeb","__gCrWeb","yandex","__yb","__ybro","__firefox__","__edgeTrackingPreventionStatistics","webkit","oprt","samsungAr","ucweb","UCShellJava","puffinDevice"];e<n.length;e++){var r=n[e],i=window[r];i&&"object"==typeof i&&t.push(r)}return t.sort()},cookiesEnabled:function(){var t=document;try{t.cookie="cookietest=1; SameSite=Strict;";var e=-1!==t.cookie.indexOf("cookietest=");return t.cookie="cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT",e}catch(t){return!1}},colorGamut:function(){for(var t=0,e=["rec2020","p3","srgb"];t<e.length;t++){var n=e[t];if(matchMedia("(color-gamut: ".concat(n,")")).matches)return n}},invertedColors:function(){return!!Y("inverted")||!Y("none")&&void 0},forcedColors:function(){return!!Z("active")||!Z("none")&&void 0},monochrome:function(){if(matchMedia("(min-monochrome: 0)").matches){for(var t=0;t<=100;++t)if(matchMedia("(max-monochrome: ".concat(t,")")).matches)return t;throw new Error("Too high value")}},contrast:function(){return $("no-preference")?0:$("high")||$("more")?1:$("low")||$("less")?-1:$("forced")?10:void 0},reducedMotion:function(){return!!J("reduce")||!J("no-preference")&&void 0},hdr:function(){return!!Q("high")||!Q("standard")&&void 0},math:function(){var t,e=tt.acos||et,n=tt.acosh||et,r=tt.asin||et,i=tt.asinh||et,a=tt.atanh||et,o=tt.atan||et,s=tt.sin||et,u=tt.sinh||et,c=tt.cos||et,l=tt.cosh||et,h=tt.tan||et,p=tt.tanh||et,f=tt.exp||et,d=tt.expm1||et,m=tt.log1p||et;return{acos:e(.12312423423423424),acosh:n(1e308),acoshPf:(t=1e154,tt.log(t+tt.sqrt(t*t-1))),asin:r(.12312423423423424),asinh:i(1),asinhPf:function(t){return tt.log(t+tt.sqrt(t*t+1))}(1),atanh:a(.5),atanhPf:function(t){return tt.log((1+t)/(1-t))/2}(.5),atan:o(.5),sin:s(-1e300),sinh:u(1),sinhPf:function(t){return tt.exp(t)-1/tt.exp(t)/2}(1),cos:c(10.000000000123),cosh:l(1),coshPf:function(t){return(tt.exp(t)+1/tt.exp(t))/2}(1),tan:h(-1e300),tanh:p(1),tanhPf:function(t){return(tt.exp(2*t)-1)/(tt.exp(2*t)+1)}(1),exp:f(1),expm1:d(1),expm1Pf:function(t){return tt.exp(t)-1}(1),log1p:m(10),log1pPf:function(t){return tt.log(1+t)}(10),powPI:function(t){return tt.pow(tt.PI,t)}(-100)}},videoCard:function(){var t,e=document.createElement("canvas"),n=null!==(t=e.getContext("webgl"))&&void 0!==t?t:e.getContext("experimental-webgl");if(n&&"getExtension"in n){var r=n.getExtension("WEBGL_debug_renderer_info");if(r)return{vendor:(n.getParameter(r.UNMASKED_VENDOR_WEBGL)||"").toString(),renderer:(n.getParameter(r.UNMASKED_RENDERER_WEBGL)||"").toString()}}},pdfViewerEnabled:function(){return navigator.pdfViewerEnabled},architecture:function(){var t=new Float32Array(1),e=new Uint8Array(t.buffer);return t[0]=1/0,t[0]=t[0]-t[0],e[3]}};var it="$ if upgrade to Pro: https://fpjs.dev/pro";function at(t){var e=function(t){if(D())return.4;if(N())return C()?.5:.3;var e=t.platform.value||"";if(/^Win/.test(e))return.6;if(/^Mac/.test(e))return.5;return.7}(t),n=function(t){return _(.99+.01*t,1e-4)}(e);return{score:e,comment:it.replace(/\$/g,"".concat(n))}}function ot(t){return JSON.stringify(t,(function(t,n){return n instanceof Error?e({name:(r=n).name,message:r.message,stack:null===(i=r.stack)||void 0===i?void 0:i.split("\n")},r):n;var r,i}),2)}function st(t){return v(function(t){for(var e="",n=0,r=Object.keys(t).sort();n<r.length;n++){var i=r[n],a=t[i],o=a.error?"error":JSON.stringify(a.value);e+="".concat(e?"|":"").concat(i.replace(/([:|\\])/g,"\\$1"),":").concat(o)}return e}(t))}function ut(t){return void 0===t&&(t=50),function(t,e){void 0===e&&(e=1/0);var n=window.requestIdleCallback;return n?new Promise((function(t){return n.call(window,(function(){return t()}),{timeout:e})})):o(Math.min(t,e))}(t,2*t)}function ct(t,e){var i=Date.now();return{get:function(o){return n(this,void 0,void 0,(function(){var n,s,u;return r(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,t()];case 1:return s=r.sent(),u=function(t){var e,n=at(t);return{get visitorId(){return void 0===e&&(e=st(this.components)),e},set visitorId(t){e=t},confidence:n,components:t,version:a}}(s),(e||(null==o?void 0:o.debug))&&console.log("Copy the text below to get the debug data:\n\n```\nversion: ".concat(u.version,"\nuserAgent: ").concat(navigator.userAgent,"\ntimeBetweenLoadAndGet: ").concat(n-i,"\nvisitorId: ").concat(u.visitorId,"\ncomponents: ").concat(ot(s),"\n```")),[2,u]}}))}))}}}function lt(t){var e=void 0===t?{}:t,i=e.delayFallback,o=e.debug,s=e.monitoring,u=void 0===s||s;return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return u&&function(){if(!(window.__fpjs_d_m||Math.random()>=.001))try{var t=new XMLHttpRequest;t.open("get","https://m1.openfpcdn.io/fingerprintjs/v".concat(a,"/npm-monitoring"),!0),t.send()}catch(t){console.error(t)}}(),[4,ut(i)];case 1:return t.sent(),[2,ct(E(rt,{debug:o},[]),o)]}}))}))}var ht={load:lt,hashComponents:st,componentsToDebugString:ot},pt=v;return t.componentsToDebugString=ot,t.default=ht,t.getFullscreenElement=O,t.getScreenFrame=j,t.hashComponents=st,t.isAndroid=D,t.isChromium=A,t.isDesktopSafari=C,t.isEdgeHTML=I,t.isGecko=R,t.isTrident=k,t.isWebKit=N,t.load=lt,t.loadSources=E,t.murmurX64Hash128=pt,t.prepareForSources=ut,t.sources=rt,t.transformSource=function(t,e){var n=function(t){return T(t)?e(t):function(){var n=t();return s(n)?n.then(e):e(n)}};return function(e){var r=t(e);return s(r)?r.then(n):n(r)}},t.withIframe=F,Object.defineProperty(t,"__esModule",{value:!0}),t}({}),a=function(t){"use strict";var e=setTimeout;function n(t){return Boolean(t&&void 0!==t.length)}function r(){}function i(t){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function a(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}o(e.promise,r)}else(1===t._state?o:s)(e.promise,t._value)}))):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void u(t);if("function"==typeof n)return void l((r=n,a=e,function(){r.apply(a,arguments)}),t)}t._state=1,t._value=e,u(t)}catch(e){s(t,e)}var r,a}function s(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t._deferreds.length&&i._immediateFn((function(){t._handled||i._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function c(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t((function(t){n||(n=!0,o(e,t))}),(function(t){n||(n=!0,s(e,t))}))}catch(t){if(n)return;n=!0,s(e,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(r);return a(this,new c(t,e,n)),n},i.prototype.finally=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},i.all=function(t){return new i((function(e,r){if(!n(t))return r(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var a=i.length;function o(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var s=n.then;if("function"==typeof s)return void s.call(n,(function(e){o(t,e)}),r)}i[t]=n,0==--a&&e(i)}catch(t){r(t)}}for(var s=0;s<i.length;s++)o(s,i[s])}))},i.allSettled=function(t){return new this((function(e,n){if(!t||void 0===t.length)return n(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var i=r.length;function a(t,n){if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if("function"==typeof o)return void o.call(n,(function(e){a(t,e)}),(function(n){r[t]={status:"rejected",reason:n},0==--i&&e(r)}))}r[t]={status:"fulfilled",value:n},0==--i&&e(r)}for(var o=0;o<r.length;o++)a(o,r[o])}))},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i((function(e){e(t)}))},i.reject=function(t){return new i((function(e,n){n(t)}))},i.race=function(t){return new i((function(e,r){if(!n(t))return r(new TypeError("Promise.race accepts an array"));for(var a=0,o=t.length;a<o;a++)i.resolve(t[a]).then(e,r)}))},i._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){e(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var h=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;var d=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,r,i=arguments,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),o=1;o<arguments.length;o++){for(var s in n=Object(i[o]))p.call(n,s)&&(a[s]=n[s]);if(h){r=h(n);for(var u=0;u<r.length;u++)f.call(n,r[u])&&(a[r[u]]=n[r[u]])}}return a};"undefined"==typeof globalThis&&("undefined"!=typeof self?self.globalThis=self:"undefined"!=typeof global&&(global.globalThis=global)),globalThis.Promise||(globalThis.Promise=i),Object.assign||(Object.assign=d);if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!globalThis.performance||!globalThis.performance.now){var m=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-m}}for(var g,v,y,b,x,w,_,S,T,E,k,I,A,N,C,R,O,D,M,F,P=Date.now(),L=["ms","moz","webkit","o"],B=0;B<L.length&&!globalThis.requestAnimationFrame;++B){var z=L[B];globalThis.requestAnimationFrame=globalThis[z+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[z+"CancelAnimationFrame"]||globalThis[z+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+P-e;return n<0&&(n=0),P=e,globalThis.self.setTimeout((function(){P=Date.now(),t(performance.now())}),n)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array),t.ENV=void 0,(g=t.ENV||(t.ENV={}))[g.WEBGL_LEGACY=0]="WEBGL_LEGACY",g[g.WEBGL=1]="WEBGL",g[g.WEBGL2=2]="WEBGL2",t.RENDERER_TYPE=void 0,(v=t.RENDERER_TYPE||(t.RENDERER_TYPE={}))[v.UNKNOWN=0]="UNKNOWN",v[v.WEBGL=1]="WEBGL",v[v.CANVAS=2]="CANVAS",t.BUFFER_BITS=void 0,(y=t.BUFFER_BITS||(t.BUFFER_BITS={}))[y.COLOR=16384]="COLOR",y[y.DEPTH=256]="DEPTH",y[y.STENCIL=1024]="STENCIL",t.BLEND_MODES=void 0,(b=t.BLEND_MODES||(t.BLEND_MODES={}))[b.NORMAL=0]="NORMAL",b[b.ADD=1]="ADD",b[b.MULTIPLY=2]="MULTIPLY",b[b.SCREEN=3]="SCREEN",b[b.OVERLAY=4]="OVERLAY",b[b.DARKEN=5]="DARKEN",b[b.LIGHTEN=6]="LIGHTEN",b[b.COLOR_DODGE=7]="COLOR_DODGE",b[b.COLOR_BURN=8]="COLOR_BURN",b[b.HARD_LIGHT=9]="HARD_LIGHT",b[b.SOFT_LIGHT=10]="SOFT_LIGHT",b[b.DIFFERENCE=11]="DIFFERENCE",b[b.EXCLUSION=12]="EXCLUSION",b[b.HUE=13]="HUE",b[b.SATURATION=14]="SATURATION",b[b.COLOR=15]="COLOR",b[b.LUMINOSITY=16]="LUMINOSITY",b[b.NORMAL_NPM=17]="NORMAL_NPM",b[b.ADD_NPM=18]="ADD_NPM",b[b.SCREEN_NPM=19]="SCREEN_NPM",b[b.NONE=20]="NONE",b[b.SRC_OVER=0]="SRC_OVER",b[b.SRC_IN=21]="SRC_IN",b[b.SRC_OUT=22]="SRC_OUT",b[b.SRC_ATOP=23]="SRC_ATOP",b[b.DST_OVER=24]="DST_OVER",b[b.DST_IN=25]="DST_IN",b[b.DST_OUT=26]="DST_OUT",b[b.DST_ATOP=27]="DST_ATOP",b[b.ERASE=26]="ERASE",b[b.SUBTRACT=28]="SUBTRACT",b[b.XOR=29]="XOR",t.DRAW_MODES=void 0,(x=t.DRAW_MODES||(t.DRAW_MODES={}))[x.POINTS=0]="POINTS",x[x.LINES=1]="LINES",x[x.LINE_LOOP=2]="LINE_LOOP",x[x.LINE_STRIP=3]="LINE_STRIP",x[x.TRIANGLES=4]="TRIANGLES",x[x.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",x[x.TRIANGLE_FAN=6]="TRIANGLE_FAN",t.FORMATS=void 0,(w=t.FORMATS||(t.FORMATS={}))[w.RGBA=6408]="RGBA",w[w.RGB=6407]="RGB",w[w.RG=33319]="RG",w[w.RED=6403]="RED",w[w.RGBA_INTEGER=36249]="RGBA_INTEGER",w[w.RGB_INTEGER=36248]="RGB_INTEGER",w[w.RG_INTEGER=33320]="RG_INTEGER",w[w.RED_INTEGER=36244]="RED_INTEGER",w[w.ALPHA=6406]="ALPHA",w[w.LUMINANCE=6409]="LUMINANCE",w[w.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",w[w.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",w[w.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t.TARGETS=void 0,(_=t.TARGETS||(t.TARGETS={}))[_.TEXTURE_2D=3553]="TEXTURE_2D",_[_.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",_[_.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",_[_.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",_[_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",_[_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",_[_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t.TYPES=void 0,(S=t.TYPES||(t.TYPES={}))[S.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",S[S.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",S[S.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",S[S.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",S[S.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",S[S.UNSIGNED_INT=5125]="UNSIGNED_INT",S[S.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",S[S.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",S[S.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",S[S.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",S[S.BYTE=5120]="BYTE",S[S.SHORT=5122]="SHORT",S[S.INT=5124]="INT",S[S.FLOAT=5126]="FLOAT",S[S.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",S[S.HALF_FLOAT=36193]="HALF_FLOAT",t.SAMPLER_TYPES=void 0,(T=t.SAMPLER_TYPES||(t.SAMPLER_TYPES={}))[T.FLOAT=0]="FLOAT",T[T.INT=1]="INT",T[T.UINT=2]="UINT",t.SCALE_MODES=void 0,(E=t.SCALE_MODES||(t.SCALE_MODES={}))[E.NEAREST=0]="NEAREST",E[E.LINEAR=1]="LINEAR",t.WRAP_MODES=void 0,(k=t.WRAP_MODES||(t.WRAP_MODES={}))[k.CLAMP=33071]="CLAMP",k[k.REPEAT=10497]="REPEAT",k[k.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t.MIPMAP_MODES=void 0,(I=t.MIPMAP_MODES||(t.MIPMAP_MODES={}))[I.OFF=0]="OFF",I[I.POW2=1]="POW2",I[I.ON=2]="ON",I[I.ON_MANUAL=3]="ON_MANUAL",t.ALPHA_MODES=void 0,(A=t.ALPHA_MODES||(t.ALPHA_MODES={}))[A.NPM=0]="NPM",A[A.UNPACK=1]="UNPACK",A[A.PMA=2]="PMA",A[A.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",A[A.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",A[A.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",A[A.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t.CLEAR_MODES=void 0,(N=t.CLEAR_MODES||(t.CLEAR_MODES={}))[N.NO=0]="NO",N[N.YES=1]="YES",N[N.AUTO=2]="AUTO",N[N.BLEND=0]="BLEND",N[N.CLEAR=1]="CLEAR",N[N.BLIT=2]="BLIT",t.GC_MODES=void 0,(C=t.GC_MODES||(t.GC_MODES={}))[C.AUTO=0]="AUTO",C[C.MANUAL=1]="MANUAL",t.PRECISION=void 0,(R=t.PRECISION||(t.PRECISION={})).LOW="lowp",R.MEDIUM="mediump",R.HIGH="highp",t.MASK_TYPES=void 0,(O=t.MASK_TYPES||(t.MASK_TYPES={}))[O.NONE=0]="NONE",O[O.SCISSOR=1]="SCISSOR",O[O.STENCIL=2]="STENCIL",O[O.SPRITE=3]="SPRITE",O[O.COLOR=4]="COLOR",t.COLOR_MASK_BITS=void 0,(D=t.COLOR_MASK_BITS||(t.COLOR_MASK_BITS={}))[D.RED=1]="RED",D[D.GREEN=2]="GREEN",D[D.BLUE=4]="BLUE",D[D.ALPHA=8]="ALPHA",t.MSAA_QUALITY=void 0,(M=t.MSAA_QUALITY||(t.MSAA_QUALITY={}))[M.NONE=0]="NONE",M[M.LOW=2]="LOW",M[M.MEDIUM=4]="MEDIUM",M[M.HIGH=8]="HIGH",t.BUFFER_TYPE=void 0,(F=t.BUFFER_TYPE||(t.BUFFER_TYPE={}))[F.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",F[F.ARRAY_BUFFER=34962]="ARRAY_BUFFER",F[F.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";var U={createCanvas:function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var t;return null!==(t=document.baseURI)&&void 0!==t?t:window.location.href},fetch:function(t,e){return fetch(t,e)}},G=/iPhone/i,W=/iPod/i,V=/iPad/i,j=/\biOS-universal(?:.+)Mac\b/i,H=/\bAndroid(?:.+)Mobile\b/i,X=/Android/i,q=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,K=/Silk/i,Y=/Windows Phone/i,Z=/\bWindows(?:.+)ARM\b/i,$=/BlackBerry/i,J=/BB10/i,Q=/Opera Mini/i,tt=/\b(CriOS|Chrome)(?:.+)Mobile/i,et=/Mobile(?:.+)Firefox\b/i,nt=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};var rt=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,r=n.split("[FBAN");void 0!==r[1]&&(n=r[0]),void 0!==(r=n.split("Twitter"))[1]&&(n=r[0]);var i=function(t){return function(e){return e.test(t)}}(n),a={apple:{phone:i(G)&&!i(Y),ipod:i(W),tablet:!i(G)&&(i(V)||nt(e))&&!i(Y),universal:i(j),device:(i(G)||i(W)||i(V)||i(j)||nt(e))&&!i(Y)},amazon:{phone:i(q),tablet:!i(q)&&i(K),device:i(q)||i(K)},android:{phone:!i(Y)&&i(q)||!i(Y)&&i(H),tablet:!i(Y)&&!i(q)&&!i(H)&&(i(K)||i(X)),device:!i(Y)&&(i(q)||i(K)||i(H)||i(X))||i(/\bokhttp\b/i)},windows:{phone:i(Y),tablet:i(Z),device:i(Y)||i(Z)},other:{blackberry:i($),blackberry10:i(J),opera:i(Q),firefox:i(et),chrome:i(tt),device:i($)||i(J)||i(Q)||i(et)||i(tt)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}(globalThis.navigator);var it={ADAPTER:U,MIPMAP_TEXTURES:t.MIPMAP_MODES.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:t.MSAA_QUALITY.NONE,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(rt.tablet||rt.phone){var n;if(rt.apple.device)if(n=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(n[1],10)<11&&(e=!1);if(rt.android.device)if(n=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(n[1],10)<7&&(e=!1)}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,antialias:!1,preserveDrawingBuffer:!1},GC_MODE:t.GC_MODES.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:t.WRAP_MODES.CLAMP,SCALE_MODE:t.SCALE_MODES.LINEAR,PRECISION_VERTEX:t.PRECISION.HIGH,PRECISION_FRAGMENT:rt.apple.device?t.PRECISION.HIGH:t.PRECISION.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!rt.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},at="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ot(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e??n.path)}},n.exports),n.exports}var st=ot((function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,r,a,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,a||t,o),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,i,a,o){var s=arguments,u=n?n+t:t;if(!this._events[u])return!1;var c,l,h=this._events[u],p=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,r),!0;case 4:return h.fn.call(h.context,e,r,i),!0;case 5:return h.fn.call(h.context,e,r,i,a),!0;case 6:return h.fn.call(h.context,e,r,i,a,o),!0}for(l=1,c=new Array(p-1);l<p;l++)c[l-1]=s[l];h.fn.apply(h.context,c)}else{var f,d=h.length;for(l=0;l<d;l++)switch(h[l].once&&this.removeListener(t,h[l].fn,void 0,!0),p){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,e);break;case 3:h[l].fn.call(h[l].context,e,r);break;case 4:h[l].fn.call(h[l].context,e,r,i);break;default:if(!c)for(f=1,c=new Array(p-1);f<p;f++)c[f-1]=s[f];h[l].fn.apply(h[l].context,c)}}return!0},s.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,i){var a=n?n+t:t;if(!this._events[a])return this;if(!e)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||o(this,a);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==e||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[a]=1===c.length?c[0]:c:o(this,a)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})),ut=lt,ct=lt;function lt(t,e,n){n=n||2;var r,i,a,o,s,u,c,l=e&&e.length,h=l?e[0]*n:t.length,p=ht(t,0,h,n,!0),f=[];if(!p||p.next===p.prev)return f;if(l&&(p=function(t,e,n,r){var i,a,o,s=[];for(i=0,a=e.length;i<a;i++)(o=ht(t,e[i]*r,i<a-1?e[i+1]*r:t.length,r,!1))===o.next&&(o.steiner=!0),s.push(_t(o));for(s.sort(yt),i=0;i<s.length;i++)n=bt(s[i],n);return n}(t,e,p,n)),t.length>80*n){r=a=t[0],i=o=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>a&&(a=s),u>o&&(o=u);c=0!==(c=Math.max(a-r,o-i))?32767/c:0}return ft(p,f,n,r,i,c,0),f}function ht(t,e,n,r,i){var a,o;if(i===Ft(t,e,n,r)>0)for(a=e;a<n;a+=r)o=Ot(a,t[a],t[a+1],o);else for(a=n-r;a>=e;a-=r)o=Ot(a,t[a],t[a+1],o);return o&&kt(o,o.next)&&(Dt(o),o=o.next),o}function pt(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!kt(r,r.next)&&0!==Et(r.prev,r,r.next))r=r.next;else{if(Dt(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function ft(t,e,n,r,i,a,o){if(t){!o&&a&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=wt(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,a,o,s,u,c=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,c*=2}while(o>1)}(i)}(t,r,i,a);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,a?mt(t,r,i,a):dt(t))e.push(s.i/n|0),e.push(t.i/n|0),e.push(u.i/n|0),Dt(t),t=u.next,c=u.next;else if((t=u)===c){o?1===o?ft(t=gt(pt(t),e,n),e,n,r,i,a,2):2===o&&vt(t,e,n,r,i,a):ft(pt(t),e,n,r,i,a,1);break}}}function dt(t){var e=t.prev,n=t,r=t.next;if(Et(e,n,r)>=0)return!1;for(var i=e.x,a=n.x,o=r.x,s=e.y,u=n.y,c=r.y,l=i<a?i<o?i:o:a<o?a:o,h=s<u?s<c?s:c:u<c?u:c,p=i>a?i>o?i:o:a>o?a:o,f=s>u?s>c?s:c:u>c?u:c,d=r.next;d!==e;){if(d.x>=l&&d.x<=p&&d.y>=h&&d.y<=f&&St(i,s,a,u,o,c,d.x,d.y)&&Et(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function mt(t,e,n,r){var i=t.prev,a=t,o=t.next;if(Et(i,a,o)>=0)return!1;for(var s=i.x,u=a.x,c=o.x,l=i.y,h=a.y,p=o.y,f=s<u?s<c?s:c:u<c?u:c,d=l<h?l<p?l:p:h<p?h:p,m=s>u?s>c?s:c:u>c?u:c,g=l>h?l>p?l:p:h>p?h:p,v=wt(f,d,e,n,r),y=wt(m,g,e,n,r),b=t.prevZ,x=t.nextZ;b&&b.z>=v&&x&&x.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=d&&b.y<=g&&b!==i&&b!==o&&St(s,l,u,h,c,p,b.x,b.y)&&Et(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,x.x>=f&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==o&&St(s,l,u,h,c,p,x.x,x.y)&&Et(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;b&&b.z>=v;){if(b.x>=f&&b.x<=m&&b.y>=d&&b.y<=g&&b!==i&&b!==o&&St(s,l,u,h,c,p,b.x,b.y)&&Et(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==o&&St(s,l,u,h,c,p,x.x,x.y)&&Et(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function gt(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!kt(i,a)&&It(i,r,r.next,a)&&Ct(i,a)&&Ct(a,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(a.i/n|0),Dt(r),Dt(r.next),r=t=a),r=r.next}while(r!==t);return pt(r)}function vt(t,e,n,r,i,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Tt(o,s)){var u=Rt(o,s);return o=pt(o,o.next),u=pt(u,u.next),ft(o,e,n,r,i,a,0),void ft(u,e,n,r,i,a,0)}s=s.next}o=o.next}while(o!==t)}function yt(t,e){return t.x-e.x}function bt(t,e){var n=function(t,e){var n,r=e,i=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o&&(o=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==e);if(!n)return null;var u,c=n,l=n.x,h=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&St(a<h?i:o,a,l,h,a<h?o:i,a,r.x,r.y)&&(u=Math.abs(a-r.y)/(i-r.x),Ct(r,t)&&(u<p||u===p&&(r.x>n.x||r.x===n.x&&xt(n,r)))&&(n=r,p=u)),r=r.next}while(r!==c);return n}(t,e);if(!n)return e;var r=Rt(n,t);return pt(r,r.next),pt(n,n.next)}function xt(t,e){return Et(t.prev,t,e.prev)<0&&Et(e.next,t,t.next)<0}function wt(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _t(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function St(t,e,n,r,i,a,o,s){return(i-o)*(e-s)>=(t-o)*(a-s)&&(t-o)*(r-s)>=(n-o)*(e-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function Tt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&It(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Ct(t,e)&&Ct(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(Et(t.prev,t,e.prev)||Et(t,e.prev,e))||kt(t,e)&&Et(t.prev,t,t.next)>0&&Et(e.prev,e,e.next)>0)}function Et(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function kt(t,e){return t.x===e.x&&t.y===e.y}function It(t,e,n,r){var i=Nt(Et(t,e,n)),a=Nt(Et(t,e,r)),o=Nt(Et(n,r,t)),s=Nt(Et(n,r,e));return i!==a&&o!==s||(!(0!==i||!At(t,n,e))||(!(0!==a||!At(t,r,e))||(!(0!==o||!At(n,t,r))||!(0!==s||!At(n,e,r)))))}function At(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Nt(t){return t>0?1:t<0?-1:0}function Ct(t,e){return Et(t.prev,t,t.next)<0?Et(t,e,t.next)>=0&&Et(t,t.prev,e)>=0:Et(t,e,t.prev)<0||Et(t,t.next,e)<0}function Rt(t,e){var n=new Mt(t.i,t.x,t.y),r=new Mt(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Ot(t,e,n,r){var i=new Mt(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Dt(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Mt(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ft(t,e,n,r){for(var i=0,a=e,o=n-r;a<n;a+=r)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}lt.deviation=function(t,e,n,r){var i=e&&e.length,a=i?e[0]*n:t.length,o=Math.abs(Ft(t,0,a,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;o-=Math.abs(Ft(t,c,l,n))}var h=0;for(s=0;s<r.length;s+=3){var p=r[s]*n,f=r[s+1]*n,d=r[s+2]*n;h+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},lt.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var o=0;o<e;o++)n.vertices.push(t[i][a][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n},ut.default=ct;var Pt=ot((function(t,e){!function(n){var r=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,a="object"==typeof at&&at;a.global!==a&&a.window!==a&&a.self!==a||(n=a);var o,s,u=2147483647,c=36,l=1,h=26,p=38,f=700,d=72,m=128,g="-",v=/^xn--/,y=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=c-l,_=Math.floor,S=String.fromCharCode;function T(t){throw RangeError(x[t])}function E(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function k(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+E((t=t.replace(b,".")).split("."),e).join(".")}function I(t){for(var e,n,r=[],i=0,a=t.length;i<a;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<a?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function A(t){return E(t,(function(t){var e="";return t>65535&&(e+=S((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=S(t)})).join("")}function N(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function C(t,e,n){var r=0;for(t=n?_(t/f):t>>1,t+=_(t/e);t>w*h>>1;r+=c)t=_(t/w);return _(r+(w+1)*t/(t+p))}function R(t){var e,n,r,i,a,o,s,p,f,v,y,b=[],x=t.length,w=0,S=m,E=d;for((n=t.lastIndexOf(g))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&T("not-basic"),b.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<x;){for(a=w,o=1,s=c;i>=x&&T("invalid-input"),((p=(y=t.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:c)>=c||p>_((u-w)/o))&&T("overflow"),w+=p*o,!(p<(f=s<=E?l:s>=E+h?h:s-E));s+=c)o>_(u/(v=c-f))&&T("overflow"),o*=v;E=C(w-a,e=b.length+1,0==a),_(w/e)>u-S&&T("overflow"),S+=_(w/e),w%=e,b.splice(w++,0,S)}return A(b)}function O(t){var e,n,r,i,a,o,s,p,f,v,y,b,x,w,E,k=[];for(b=(t=I(t)).length,e=m,n=0,a=d,o=0;o<b;++o)(y=t[o])<128&&k.push(S(y));for(r=i=k.length,i&&k.push(g);r<b;){for(s=u,o=0;o<b;++o)(y=t[o])>=e&&y<s&&(s=y);for(s-e>_((u-n)/(x=r+1))&&T("overflow"),n+=(s-e)*x,e=s,o=0;o<b;++o)if((y=t[o])<e&&++n>u&&T("overflow"),y==e){for(p=n,f=c;!(p<(v=f<=a?l:f>=a+h?h:f-a));f+=c)E=p-v,w=c-v,k.push(S(N(v+E%w,0))),p=_(E/w);k.push(S(N(p,0))),a=C(n,x,r==i),n=0,++r}++n,++e}return k.join("")}if(o={version:"1.3.2",ucs2:{decode:I,encode:A},decode:R,encode:O,toASCII:function(t){return k(t,(function(t){return y.test(t)?"xn--"+O(t):t}))},toUnicode:function(t){return k(t,(function(t){return v.test(t)?R(t.slice(4).toLowerCase()):t}))}},r&&i)if(t.exports==r)i.exports=o;else for(s in o)o.hasOwnProperty(s)&&(r[s]=o[s]);else n.punycode=o}(at)})),Lt={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}};function Bt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var zt=function(t,e,n,r){e=e||"&",n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var a=/\+/g;t=t.split(e);var o=1e3;r&&"number"==typeof r.maxKeys&&(o=r.maxKeys);var s=t.length;o>0&&s>o&&(s=o);for(var u=0;u<s;++u){var c,l,h,p,f=t[u].replace(a,"%20"),d=f.indexOf(n);d>=0?(c=f.substr(0,d),l=f.substr(d+1)):(c=f,l=""),h=decodeURIComponent(c),p=decodeURIComponent(l),Bt(i,h)?Array.isArray(i[h])?i[h].push(p):i[h]=[i[h],p]:i[h]=p}return i},Ut=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},Gt=function(t,e,n,r){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(r){var i=encodeURIComponent(Ut(r))+n;return Array.isArray(t[r])?t[r].map((function(t){return i+encodeURIComponent(Ut(t))})).join(e):i+encodeURIComponent(Ut(t[r]))})).join(e):r?encodeURIComponent(Ut(r))+n+encodeURIComponent(Ut(t)):""},Wt=ot((function(t,e){e.decode=e.parse=zt,e.encode=e.stringify=Gt})),Vt=ae,jt=function(t,e){return ae(t,!1,!0).resolve(e)},Ht=function(t){Lt.isString(t)&&(t=ae(t));if(!(t instanceof Xt))return Xt.prototype.format.call(t);return t.format()};function Xt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var qt=/^([a-z0-9.+-]+:)/i,Kt=/:[0-9]*$/,Yt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Zt=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),$t=["'"].concat(Zt),Jt=["%","/","?",";","#"].concat($t),Qt=["/","?","#"],te=/^[+a-z0-9A-Z_-]{0,63}$/,ee=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ne={javascript:!0,"javascript:":!0},re={javascript:!0,"javascript:":!0},ie={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function ae(t,e,n){if(t&&Lt.isObject(t)&&t instanceof Xt)return t;var r=new Xt;return r.parse(t,e,n),r}Xt.prototype.parse=function(t,e,n){if(!Lt.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),i=-1!==r&&r<t.indexOf("#")?"?":"#",a=t.split(i);a[0]=a[0].replace(/\\/g,"/");var o=t=a.join(i);if(o=o.trim(),!n&&1===t.split("#").length){var s=Yt.exec(o);if(s)return this.path=o,this.href=o,this.pathname=s[1],s[2]?(this.search=s[2],this.query=e?Wt.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=qt.exec(o);if(u){var c=(u=u[0]).toLowerCase();this.protocol=c,o=o.substr(u.length)}if(n||u||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===o.substr(0,2);!l||u&&re[u]||(o=o.substr(2),this.slashes=!0)}if(!re[u]&&(l||u&&!ie[u])){for(var h,p,f=-1,d=0;d<Qt.length;d++){-1!==(m=o.indexOf(Qt[d]))&&(-1===f||m<f)&&(f=m)}-1!==(p=-1===f?o.lastIndexOf("@"):o.lastIndexOf("@",f))&&(h=o.slice(0,p),o=o.slice(p+1),this.auth=decodeURIComponent(h)),f=-1;for(d=0;d<Jt.length;d++){var m;-1!==(m=o.indexOf(Jt[d]))&&(-1===f||m<f)&&(f=m)}-1===f&&(f=o.length),this.host=o.slice(0,f),o=o.slice(f),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var v=this.hostname.split(/\./),y=(d=0,v.length);d<y;d++){var b=v[d];if(b&&!b.match(te)){for(var x="",w=0,_=b.length;w<_;w++)b.charCodeAt(w)>127?x+="x":x+=b[w];if(!x.match(te)){var S=v.slice(0,d),T=v.slice(d+1),E=b.match(ee);E&&(S.push(E[1]),T.unshift(E[2])),T.length&&(o="/"+T.join(".")+o),this.hostname=S.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=Pt.toASCII(this.hostname));var k=this.port?":"+this.port:"",I=this.hostname||"";this.host=I+k,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!ne[c])for(d=0,y=$t.length;d<y;d++){var A=$t[d];if(-1!==o.indexOf(A)){var N=encodeURIComponent(A);N===A&&(N=escape(A)),o=o.split(A).join(N)}}var C=o.indexOf("#");-1!==C&&(this.hash=o.substr(C),o=o.slice(0,C));var R=o.indexOf("?");if(-1!==R?(this.search=o.substr(R),this.query=o.substr(R+1),e&&(this.query=Wt.parse(this.query)),o=o.slice(0,R)):e&&(this.search="",this.query={}),o&&(this.pathname=o),ie[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){k=this.pathname||"";var O=this.search||"";this.path=k+O}return this.href=this.format(),this},Xt.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,a="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&Lt.isObject(this.query)&&Object.keys(this.query).length&&(a=Wt.stringify(this.query));var o=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||ie[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+i+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(o=o.replace("#","%23"))+r},Xt.prototype.resolve=function(t){return this.resolveObject(ae(t,!1,!0)).format()},Xt.prototype.resolveObject=function(t){if(Lt.isString(t)){var e=new Xt;e.parse(t,!1,!0),t=e}for(var n=new Xt,r=Object.keys(this),i=0;i<r.length;i++){var a=r[i];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),s=0;s<o.length;s++){var u=o[s];"protocol"!==u&&(n[u]=t[u])}return ie[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!ie[t.protocol]){for(var c=Object.keys(t),l=0;l<c.length;l++){var h=c[l];n[h]=t[h]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||re[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var f=n.pathname||"",d=n.search||"";n.path=f+d}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=g||m||n.host&&t.pathname,y=v,b=n.pathname&&n.pathname.split("/")||[],x=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!ie[n.protocol]);if(x&&(n.hostname="",n.port=null,n.host&&(""===b[0]?b[0]=n.host:b.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),v=v&&(""===p[0]||""===b[0])),g)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,b=p;else if(p.length)b||(b=[]),b.pop(),b=b.concat(p),n.search=t.search,n.query=t.query;else if(!Lt.isNullOrUndefined(t.search)){if(x)n.hostname=n.host=b.shift(),(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift());return n.search=t.search,n.query=t.query,Lt.isNull(n.pathname)&&Lt.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var w=b.slice(-1)[0],_=(n.host||t.host||b.length>1)&&("."===w||".."===w)||""===w,S=0,T=b.length;T>=0;T--)"."===(w=b[T])?b.splice(T,1):".."===w?(b.splice(T,1),S++):S&&(b.splice(T,1),S--);if(!v&&!y)for(;S--;S)b.unshift("..");!v||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),_&&"/"!==b.join("/").substr(-1)&&b.push("");var E,k=""===b[0]||b[0]&&"/"===b[0].charAt(0);x&&(n.hostname=n.host=k?"":b.length?b.shift():"",(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift()));return(v=v||n.host&&b.length)&&!k&&b.unshift(""),b.length?n.pathname=b.join("/"):(n.pathname=null,n.path=null),Lt.isNull(n.pathname)&&Lt.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},Xt.prototype.parseHost=function(){var t=this.host,e=Kt.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var oe={parse:Vt,format:Ht,resolve:jt};function se(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function ue(t){return t.split("?")[0].split("#")[0]}var ce={toPosix:function(t){return e="\\",n="/",t.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n);var e,n},isUrl:function(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:function(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},hasProtocol:function(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol:function(t){se(t),t=this.toPosix(t);var e="",n=/^file:\/\/\//.exec(t),r=/^[^/:]+:\/\//.exec(t),i=/^[^/:]+:\//.exec(t);if(n||r||i){var a=(null==n?void 0:n[0])||(null==r?void 0:r[0])||(null==i?void 0:i[0]);e=a,t=t.slice(a.length)}return e},toAbsolute:function(t,e,n){if(this.isDataUrl(t))return t;var r=ue(this.toPosix(null!=e?e:it.ADAPTER.getBaseUrl())),i=ue(this.toPosix(null!=n?n:this.rootname(r)));return se(t),(t=this.toPosix(t)).startsWith("/")?ce.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize:function(t){if(se(t=this.toPosix(t)),0===t.length)return".";var e="",n=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));var r=t.endsWith("/");return(t=function(t,e){for(var n,r="",i=0,a=-1,o=0,s=0;s<=t.length;++s){if(s<t.length)n=t.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(a===s-1||1===o);else if(a!==s-1&&2===o){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",i=0):i=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),a=s,o=0;continue}}else if(2===r.length||1===r.length){r="",i=0,a=s,o=0;continue}e&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+t.slice(a+1,s):r=t.slice(a+1,s),i=s-a-1;a=s,o=0}else 46===n&&-1!==o?++o:o=-1}return r}(t,!1)).length>0&&r&&(t+="/"),n?"/"+t:e+t},isAbsolute:function(t){return se(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join:function(){for(var t,e,n=arguments,r=[],i=0;i<arguments.length;i++)r[i]=n[i];if(0===r.length)return".";for(var a=0;a<r.length;++a){var o=r[a];if(se(o),o.length>0)if(void 0===e)e=o;else{var s=null!==(t=r[a-1])&&void 0!==t?t:"";this.extname(s)?e+="/../"+o:e+="/"+o}}return void 0===e?".":this.normalize(e)},dirname:function(t){if(se(t),0===t.length)return".";for(var e=(t=this.toPosix(t)).charCodeAt(0),n=47===e,r=-1,i=!0,a=this.getProtocol(t),o=t,s=(t=t.slice(a.length)).length-1;s>=1;--s)if(47===(e=t.charCodeAt(s))){if(!i){r=s;break}}else i=!1;return-1===r?n?"/":this.isUrl(o)?a+t:a:n&&1===r?"//":a+t.slice(0,r)},rootname:function(t){se(t);var e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){var n=t.indexOf("/",e.length);(e=-1!==n?t.slice(0,n):t).endsWith("/")||(e+="/")}return e},basename:function(t,e){se(t),e&&se(e),t=this.toPosix(t);var n,r=0,i=-1,a=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var o=e.length-1,s=-1;for(n=t.length-1;n>=0;--n){var u=t.charCodeAt(n);if(47===u){if(!a){r=n+1;break}}else-1===s&&(a=!1,s=n+1),o>=0&&(u===e.charCodeAt(o)?-1==--o&&(i=n):(o=-1,i=s))}return r===i?i=s:-1===i&&(i=t.length),t.slice(r,i)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!a){r=n+1;break}}else-1===i&&(a=!1,i=n+1);return-1===i?"":t.slice(r,i)},extname:function(t){se(t);for(var e=-1,n=0,r=-1,i=!0,a=0,o=(t=this.toPosix(t)).length-1;o>=0;--o){var s=t.charCodeAt(o);if(47!==s)-1===r&&(i=!1,r=o+1),46===s?-1===e?e=o:1!==a&&(a=1):-1!==e&&(a=-1);else if(!i){n=o+1;break}}return-1===e||-1===r||0===a||1===a&&e===r-1&&e===n+1?"":t.slice(e,r)},parse:function(t){se(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;var n,r=(t=this.toPosix(t)).charCodeAt(0),i=this.isAbsolute(t);e.root=this.rootname(t),n=i||this.hasProtocol(t)?1:0;for(var a=-1,o=0,s=-1,u=!0,c=t.length-1,l=0;c>=n;--c)if(47!==(r=t.charCodeAt(c)))-1===s&&(u=!1,s=c+1),46===r?-1===a?a=c:1!==l&&(l=1):-1!==a&&(l=-1);else if(!u){o=c+1;break}return-1===a||-1===s||0===l||1===l&&a===s-1&&a===o+1?-1!==s&&(e.base=e.name=0===o&&i?t.slice(1,s):t.slice(o,s)):(0===o&&i?(e.name=t.slice(1,a),e.base=t.slice(1,s)):(e.name=t.slice(o,a),e.base=t.slice(o,s)),e.ext=t.slice(a,s)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"};it.RETINA_PREFIX=/@([0-9\.]+)x/,it.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var le,he=!1,pe="6.5.10";function fe(t){var e;if(!he){if(it.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS "+pe+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,n)}else globalThis.console&&globalThis.console.log("PixiJS "+pe+" - "+t+" - http://www.pixijs.com/");he=!0}}function de(){return void 0===le&&(le=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:it.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!it.ADAPTER.getWebGLRenderingContext())return!1;var e=it.ADAPTER.createCanvas(),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!n||!n.getContextAttributes().stencil);if(n){var i=n.getExtension("WEBGL_lose_context");i&&i.loseContext()}return n=null,r}catch(t){return!1}}()),le}var me={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function ge(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function ve(t){var e=t.toString(16);return"#"+(e="000000".substring(0,6-e.length)+e)}function ye(t){return"string"==typeof t&&"#"===(t=me[t.toLowerCase()]||t)[0]&&(t=t.slice(1)),parseInt(t,16)}var be=function(){for(var e=[],n=[],r=0;r<32;r++)e[r]=r,n[r]=r;e[t.BLEND_MODES.NORMAL_NPM]=t.BLEND_MODES.NORMAL,e[t.BLEND_MODES.ADD_NPM]=t.BLEND_MODES.ADD,e[t.BLEND_MODES.SCREEN_NPM]=t.BLEND_MODES.SCREEN,n[t.BLEND_MODES.NORMAL]=t.BLEND_MODES.NORMAL_NPM,n[t.BLEND_MODES.ADD]=t.BLEND_MODES.ADD_NPM,n[t.BLEND_MODES.SCREEN]=t.BLEND_MODES.SCREEN_NPM;var i=[];return i.push(n),i.push(e),i}();function xe(t,e){return be[e?1:0][t]}function we(t,e,n,r){return n=n||new Float32Array(4),r||void 0===r?(n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e):(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=e,n}function _e(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,r=t>>8&255,i=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(i=i*e+.5|0)}function Se(t,e,n,r){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(r||void 0===r)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function Te(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var r=0,i=0;r<n;r+=6,i+=4)e[r+0]=i+0,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i+0,e[r+4]=i+2,e[r+5]=i+3;return e}function Ee(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var ke={Float32Array,Uint32Array,Int32Array,Uint8Array};function Ie(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Ae(t){return!(t&t-1||!t)}function Ne(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function Ce(t,e,n){var r,i=t.length;if(!(e>=i||0===n)){var a=i-(n=e+n>i?i-e:n);for(r=e;r<a;++r)t[r]=t[r+n];t.length=a}}function Re(t){return 0===t?0:t<0?-1:1}var Oe=0;function De(){return++Oe}var Me={};function Fe(t,e,n){if(void 0===n&&(n=3),!Me[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),Me[e]=!0}}var Pe={},Le=Object.create(null),Be=Object.create(null);var ze=function(){function t(t,e,n){this.canvas=it.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=n||it.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),t}();function Ue(t){var e,n,r,i=t.width,a=t.height,o=t.getContext("2d",{willReadFrequently:!0}),s=o.getImageData(0,0,i,a).data,u=s.length,c={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<u;e+=4)0!==s[e+3]&&(n=e/4%i,r=~~(e/4/i),null===c.top&&(c.top=r),(null===c.left||n<c.left)&&(c.left=n),(null===c.right||c.right<n)&&(c.right=n+1),(null===c.bottom||c.bottom<r)&&(c.bottom=r));return null!==c.top&&(i=c.right-c.left,a=c.bottom-c.top+1,l=o.getImageData(c.left,c.top,i,a)),{height:a,width:i,data:l}}var Ge,We=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Ve(t,e){if(void 0===e&&(e=globalThis.location),0===t.indexOf("data:"))return"";e=e||globalThis.location,Ge||(Ge=document.createElement("a")),Ge.href=t;var n=oe.parse(Ge.href),r=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&r&&n.protocol===e.protocol?"":"anonymous"}function je(t,e){var n=it.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1}var He,Xe={__proto__:null,BaseTextureCache:Be,CanvasRenderTarget:ze,DATA_URI:We,ProgramCache:Pe,TextureCache:Le,clearTextureCache:function(){var t;for(t in Le)delete Le[t];for(t in Be)delete Be[t]},correctBlendMode:xe,createIndicesForQuads:Te,decomposeDataUri:function(t){var e=We.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}},deprecation:Fe,destroyTextureCache:function(){var t;for(t in Le)Le[t].destroy();for(t in Be)Be[t].destroy()},determineCrossOrigin:Ve,getBufferType:Ee,getResolutionOfUrl:je,hex2rgb:ge,hex2string:ve,interleaveTypedArrays:function(t,e){for(var n=0,r=0,i={},a=0;a<t.length;a++)r+=e[a],n+=t[a].length;var o=new ArrayBuffer(4*n),s=null,u=0;for(a=0;a<t.length;a++){var c=e[a],l=t[a],h=Ee(l);i[h]||(i[h]=new ke[h](o)),s=i[h];for(var p=0;p<l.length;p++){s[(p/c|0)*r+u+p%c]=l[p]}u+=c}return new Float32Array(o)},isPow2:Ae,isWebGLSupported:de,log2:Ne,nextPow2:Ie,path:ce,premultiplyBlendMode:be,premultiplyRgba:we,premultiplyTint:_e,premultiplyTintToRgba:Se,removeItems:Ce,rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},sayHello:fe,sign:Re,skipHello:function(){he=!0},string2hex:ye,trimCanvas:Ue,uid:De,url:oe,isMobile:rt,EventEmitter:st,earcut:ut},qe=2*Math.PI,Ke=180/Math.PI,Ye=Math.PI/180;t.SHAPES=void 0,(He=t.SHAPES||(t.SHAPES={}))[He.POLY=0]="POLY",He[He.RECT=1]="RECT",He[He.CIRC=2]="CIRC",He[He.ELIP=3]="ELIP",He[He.RREC=4]="RREC";var Ze=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},t}(),$e=[new Ze,new Ze,new Ze,new Ze],Je=function(){function e(e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(e),this.y=Number(n),this.width=Number(r),this.height=Number(i),this.type=t.SHAPES.RECT}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e,"EMPTY",{get:function(){return new e(0,0,0,0)},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},e.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},e.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},e.prototype.intersects=function(t,e){if(!e){var n=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=n)return!1;var r=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>r}var i=this.left,a=this.right,o=this.top,s=this.bottom;if(a<=i||s<=o)return!1;var u=$e[0].set(t.left,t.top),c=$e[1].set(t.left,t.bottom),l=$e[2].set(t.right,t.top),h=$e[3].set(t.right,t.bottom);if(l.x<=u.x||c.y<=u.y)return!1;var p=Math.sign(e.a*e.d-e.b*e.c);if(0===p)return!1;if(e.apply(u,u),e.apply(c,c),e.apply(l,l),e.apply(h,h),Math.max(u.x,c.x,l.x,h.x)<=i||Math.min(u.x,c.x,l.x,h.x)>=a||Math.max(u.y,c.y,l.y,h.y)<=o||Math.min(u.y,c.y,l.y,h.y)>=s)return!1;var f=p*(c.y-u.y),d=p*(u.x-c.x),m=f*i+d*o,g=f*a+d*o,v=f*i+d*s,y=f*a+d*s;if(Math.max(m,g,v,y)<=f*u.x+d*u.y||Math.min(m,g,v,y)>=f*h.x+d*h.y)return!1;var b=p*(u.y-l.y),x=p*(l.x-u.x),w=b*i+x*o,_=b*a+x*o,S=b*i+x*s,T=b*a+x*s;return!(Math.max(w,_,S,T)<=b*u.x+x*u.y||Math.min(w,_,S,T)>=b*h.x+x*h.y)},e.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},e.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(i-r,0),this},e.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this},e.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=i-r,this},e.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},e}(),Qe=function(){function e(e,n,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=e,this.y=n,this.radius=r,this.type=t.SHAPES.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,r=this.x-t,i=this.y-e;return(r*=r)+(i*=i)<=n},e.prototype.getBounds=function(){return new Je(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},e.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},e}(),tn=function(){function e(e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=e,this.y=n,this.width=r,this.height=i,this.type=t.SHAPES.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,r=(e-this.y)/this.height;return(n*=n)+(r*=r)<=1},e.prototype.getBounds=function(){return new Je(this.x-this.width,this.y-this.height,this.width,this.height)},e.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},e}(),en=function(){function e(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];var i=Array.isArray(n[0])?n[0]:n;if("number"!=typeof i[0]){for(var a=[],o=0,s=i.length;o<s;o++)a.push(i[o].x,i[o].y);i=a}this.points=i,this.type=t.SHAPES.POLY,this.closeStroke=!0}return e.prototype.clone=function(){var t=new e(this.points.slice());return t.closeStroke=this.closeStroke,t},e.prototype.contains=function(t,e){for(var n=!1,r=this.points.length/2,i=0,a=r-1;i<r;a=i++){var o=this.points[2*i],s=this.points[2*i+1],u=this.points[2*a],c=this.points[2*a+1];s>e!=c>e&&t<(e-s)/(c-s)*(u-o)+o&&(n=!n)}return n},e.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(t,e){return t+", "+e}),"")+"]"},e}(),nn=function(){function e(e,n,r,i,a){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=20),this.x=e,this.y=n,this.width=r,this.height=i,this.radius=a,this.type=t.SHAPES.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;var r=t-(this.x+n),i=e-(this.y+n),a=n*n;if(r*r+i*i<=a)return!0;if((r=t-(this.x+this.width-n))*r+i*i<=a)return!0;if(r*r+(i=e-(this.y+this.height-n))*i<=a)return!0;if((r=t-(this.x+n))*r+i*i<=a)return!0}return!1},e.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},e}(),rn=function(){function t(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),this._x=n,this._y=r,this.cb=t,this.scope=e}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),an=function(){function t(t,e,n,r,i,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===a&&(a=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=a}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,n,r,i,a){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=a,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},t.prototype.apply=function(t,e){e=e||new Ze;var n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Ze;var n=1/(this.a*this.d+this.c*-this.b),r=t.x,i=t.y;return e.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,a=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=a*e-this.ty*n,this.ty=a*n+this.ty*e,this},t.prototype.append=function(t){var e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this},t.prototype.setTransform=function(t,e,n,r,i,a,o,s,u){return this.a=Math.cos(o+u)*i,this.b=Math.sin(o+u)*i,this.c=-Math.sin(o-s)*a,this.d=Math.cos(o-s)*a,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,r=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,n=this.b,r=this.c,i=this.d,a=t.pivot,o=-Math.atan2(-r,i),s=Math.atan2(n,e),u=Math.abs(o+s);return u<1e-5||Math.abs(qe-u)<1e-5?(t.rotation=s,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=s),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx+(a.x*e+a.y*r),t.position.y=this.ty+(a.x*n+a.y*i),t},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,a=t*r-e*n;return this.a=r/a,this.b=-e/a,this.c=-n/a,this.d=t/a,this.tx=(n*this.ty-r*i)/a,this.ty=-(t*this.ty-e*i)/a,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),on=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],sn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],un=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],cn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ln=[],hn=[],pn=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];ln.push(e);for(var n=0;n<16;n++)for(var r=pn(on[t]*on[n]+un[t]*sn[n]),i=pn(sn[t]*on[n]+cn[t]*sn[n]),a=pn(on[t]*un[n]+un[t]*cn[n]),o=pn(sn[t]*un[n]+cn[t]*cn[n]),s=0;s<16;s++)if(on[s]===r&&sn[s]===i&&un[s]===a&&cn[s]===o){e.push(s);break}}for(t=0;t<16;t++){var u=new an;u.set(on[t],sn[t],un[t],cn[t],0,0),hn.push(u)}}();var fn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return on[t]},uY:function(t){return sn[t]},vX:function(t){return un[t]},vY:function(t){return cn[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return ln[t][e]},sub:function(t,e){return ln[t][fn.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?fn.S:fn.N:2*Math.abs(e)<=Math.abs(t)?t>0?fn.E:fn.W:e>0?t>0?fn.SE:fn.SW:t>0?fn.NE:fn.NW},matrixAppendRotationInv:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=hn[fn.inv(e)];i.tx=n,i.ty=r,t.append(i)}},dn=function(){function t(){this.worldTransform=new an,this.localTransform=new an,this.position=new rn(this.onChange,this,0,0),this.scale=new rn(this.onChange,this,1,1),this.pivot=new rn(this.onChange,this,0,0),this.skew=new rn(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();it.SORTABLE_CHILDREN=!1;var mn=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Je.EMPTY:((t=t||new Je(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addPointMatrix=function(t,e){var n=t.a,r=t.b,i=t.c,a=t.d,o=t.tx,s=t.ty,u=n*e.x+i*e.y+o,c=r*e.x+a*e.y+s;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,a=t[0],o=t[1];e=a<e?a:e,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,e=(a=t[2])<e?a:e,n=(o=t[3])<n?o:n,r=a>r?a:r,i=o>i?o:i,e=(a=t[4])<e?a:e,n=(o=t[5])<n?o:n,r=a>r?a:r,i=o>i?o:i,e=(a=t[6])<e?a:e,n=(o=t[7])<n?o:n,r=a>r?a:r,i=o>i?o:i,this.minX=e,this.minY=n,this.maxX=r,this.maxY=i},t.prototype.addFrame=function(t,e,n,r,i){this.addFrameMatrix(t.worldTransform,e,n,r,i)},t.prototype.addFrameMatrix=function(t,e,n,r,i){var a=t.a,o=t.b,s=t.c,u=t.d,c=t.tx,l=t.ty,h=this.minX,p=this.minY,f=this.maxX,d=this.maxY,m=a*e+s*n+c,g=o*e+u*n+l;h=m<h?m:h,p=g<p?g:p,f=m>f?m:f,d=g>d?g:d,h=(m=a*r+s*n+c)<h?m:h,p=(g=o*r+u*n+l)<p?g:p,f=m>f?m:f,d=g>d?g:d,h=(m=a*e+s*i+c)<h?m:h,p=(g=o*e+u*i+l)<p?g:p,f=m>f?m:f,d=g>d?g:d,h=(m=a*r+s*i+c)<h?m:h,p=(g=o*r+u*i+l)<p?g:p,f=m>f?m:f,d=g>d?g:d,this.minX=h,this.minY=p,this.maxX=f,this.maxY=d},t.prototype.addVertexData=function(t,e,n){for(var r=this.minX,i=this.minY,a=this.maxX,o=this.maxY,s=e;s<n;s+=2){var u=t[s],c=t[s+1];r=u<r?u:r,i=c<i?c:i,a=u>a?u:a,o=c>o?c:o}this.minX=r,this.minY=i,this.maxX=a,this.maxY=o},t.prototype.addVertices=function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)},t.prototype.addVerticesMatrix=function(t,e,n,r,i,a){void 0===i&&(i=0),void 0===a&&(a=i);for(var o=t.a,s=t.b,u=t.c,c=t.d,l=t.tx,h=t.ty,p=this.minX,f=this.minY,d=this.maxX,m=this.maxY,g=n;g<r;g+=2){var v=e[g],y=e[g+1],b=o*v+u*y+l,x=c*y+s*v+h;p=Math.min(p,b-i),d=Math.max(d,b+i),f=Math.min(f,x-a),m=Math.max(m,x+a)}this.minX=p,this.minY=f,this.maxX=d,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=i&&r<=a){var o=this.minX,s=this.minY,u=this.maxX,c=this.maxY;this.minX=n<o?n:o,this.minY=r<s?r:s,this.maxX=i>u?i:u,this.maxY=a>c?a:c}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=i&&r<=a){var o=this.minX,s=this.minY,u=this.maxX,c=this.maxY;this.minX=n<o?n:o,this.minY=r<s?r:s,this.maxX=i>u?i:u,this.maxY=a>c?a:c}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,n,r,i,a){t-=i,e-=a,n+=i,r+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r},t}(),gn=function(t,e){return gn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},gn(t,e)};function vn(t,e){function n(){this.constructor=t}gn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var yn=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new dn,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new mn,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return vn(e,t),e.mixin=function(t){for(var n=Object.keys(t),r=0;r<n.length;++r){var i=n[r];Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t,i))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Je),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Je),t=this._localBoundsRect),this._localBounds||(this._localBounds=new mn);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var r=this._bounds,i=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-i,a},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,n,r,i,a,o,s,u){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=a,this.skew.y=o,this.pivot.x=s,this.pivot.y=u,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new bn),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*Ke},set:function(t){this.transform.rotation=t*Ye},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){var e;if(this._mask)(e=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1));if(this._mask=t,this._mask)(e=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(0===e._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}},enumerable:!1,configurable:!0}),e}(st),bn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return vn(e,t),e}(yn);function xn(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}yn.prototype.displayObjectUpdateTransform=yn.prototype.updateTransform;var wn=function(e){function n(){var t=e.call(this)||this;return t.children=[],t.sortableChildren=it.SORTABLE_CHILDREN,t.sortDirty=!1,t}return vn(n,e),n.prototype.onChildrenChange=function(t){},n.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var r=0;r<e.length;r++)this.addChild(e[r]);else{var i=e[0];i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.push(i),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this)}return e[0]},n.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},n.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r)}},n.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},n.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);Ce(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},n.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},n.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var r=0;r<e.length;r++)this.removeChild(e[r]);else{var i=e[0],a=this.children.indexOf(i);if(-1===a)return null;i.parent=null,i.transform._parentID=-1,Ce(this.children,a,1),this._boundsID++,this.onChildrenChange(a),i.emit("removed",this),this.emit("childRemoved",i,this,a)}return e[0]},n.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Ce(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},n.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,r=t,i=e-r;if(i>0&&i<=e){n=this.children.splice(r,i);for(var a=0;a<n.length;++a)n[a].parent=null,n[a].transform&&(n[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(a=0;a<n.length;++a)n[a].emit("removed",this),this.emit("childRemoved",n[a],this,a);return n}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},n.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(xn),this.sortDirty=!1},n.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},n.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.isMaskData?e._mask.maskObject:e._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},n.prototype.getLocalBounds=function(t,n){void 0===n&&(n=!1);var r=e.prototype.getLocalBounds.call(this,t);if(!n)for(var i=0,a=this.children.length;i<a;++i){var o=this.children[i];o.visible&&o.updateTransform()}return r},n.prototype._calculateBounds=function(){},n.prototype._renderWithCulling=function(t){var e=t.renderTexture.sourceFrame;if(e.width>0&&e.height>0){var r,i;if(this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==n.prototype._render&&(r=this.getBounds(!0)),r&&e.intersects(r,i))this._render(t);else if(this.cullArea)return;for(var a=0,o=this.children.length;a<o;++a){var s=this.children[a],u=s.cullable;s.cullable=u||!this.cullArea,s.render(t),s.cullable=u}}},n.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},n.prototype.renderAdvanced=function(e){var n=this.filters,r=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<n.length;i++)n[i].enabled&&this._enabledFilters.push(n[i])}var a=n&&this._enabledFilters&&this._enabledFilters.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==t.MASK_TYPES.NONE));if(a&&e.batch.flush(),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);i=0;for(var o=this.children.length;i<o;++i)this.children[i].render(e)}a&&e.batch.flush(),r&&e.mask.pop(this),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},n.prototype._render=function(t){},n.prototype.destroy=function(t){e.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof t?t:t&&t.children,r=this.removeChildren(0,this.children.length);if(n)for(var i=0;i<r.length;++i)r[i].destroy(t)},Object.defineProperty(n.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),n}(yn);wn.prototype.containerUpdateTransform=wn.prototype.updateTransform;var _n,Sn=function(){return Sn=Object.assign||function(t){for(var e,n=arguments,r=1,i=arguments.length;r<i;r++)for(var a in e=n[r])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},Sn.apply(this,arguments)};t.ExtensionType=void 0,(_n=t.ExtensionType||(t.ExtensionType={})).Application="application",_n.RendererPlugin="renderer-webgl-plugin",_n.CanvasRendererPlugin="renderer-canvas-plugin",_n.Loader="loader",_n.LoadParser="load-parser",_n.ResolveParser="resolve-parser",_n.CacheParser="cache-parser",_n.DetectionParser="detection-parser";var Tn,En=function(t){if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");var e="object"!=typeof t.extension?{type:t.extension}:t.extension;t=Sn(Sn({},e),{ref:t})}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t=Sn({},t)).type&&(t.type=[t.type]),t},kn={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var t=arguments,e=this,n=[],r=0;r<arguments.length;r++)n[r]=t[r];return n.map(En).forEach((function(t){t.type.forEach((function(n){var r,i;return null===(i=(r=e._removeHandlers)[n])||void 0===i?void 0:i.call(r,t)}))})),this},add:function(){for(var t=arguments,e=this,n=[],r=0;r<arguments.length;r++)n[r]=t[r];return n.map(En).forEach((function(t){t.type.forEach((function(n){var r=e._addHandlers,i=e._queue;r[n]?r[n](t):(i[n]=i[n]||[],i[n].push(t))}))})),this},handle:function(t,e,n){var r=this._addHandlers=this._addHandlers||{},i=this._removeHandlers=this._removeHandlers||{};if(r[t]||i[t])throw new Error("Extension type "+t+" already has a handler");r[t]=e,i[t]=n;var a=this._queue;return a[t]&&(a[t].forEach((function(t){return e(t)})),delete a[t]),this},handleByMap:function(t,e){return this.handle(t,(function(t){e[t.name]=t.ref}),(function(t){delete e[t.name]}))},handleByList:function(e,n){return this.handle(e,(function(r){var i,a;n.includes(r.ref)||(n.push(r.ref),e===t.ExtensionType.Loader&&(null===(a=(i=r.ref).add)||void 0===a||a.call(i)))}),(function(t){var e=n.indexOf(t.ref);-1!==e&&n.splice(e,1)}))}},In=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,r,i,a,o,s){if(arguments.length>8)throw new Error("max arguments reached");var u=this.name,c=this.items;this._aliasCount++;for(var l=0,h=c.length;l<h;l++)c[l][u](t,e,n,r,i,a,o,s);return c===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(In.prototype,{dispatch:{value:In.prototype.emit},run:{value:In.prototype.emit}}),it.TARGET_FPMS=.06,t.UPDATE_PRIORITY=void 0,(Tn=t.UPDATE_PRIORITY||(t.UPDATE_PRIORITY={}))[Tn.INTERACTION=50]="INTERACTION",Tn[Tn.HIGH=25]="HIGH",Tn[Tn.NORMAL=0]="NORMAL",Tn[Tn.LOW=-25]="LOW",Tn[Tn.UTILITY=-50]="UTILITY";var An=function(){function t(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=0),void 0===r&&(r=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=r}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Nn=function(){function e(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new An(null,null,1/0),this.deltaMS=1/it.TARGET_FPMS,this.elapsedMS=1/it.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return e.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,n,r){return void 0===r&&(r=t.UPDATE_PRIORITY.NORMAL),this._addListener(new An(e,n,r))},e.prototype.addOnce=function(e,n,r){return void 0===r&&(r=t.UPDATE_PRIORITY.NORMAL),this._addListener(new An(e,n,r,!0))},e.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},e.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(e.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},e.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*it.TARGET_FPMS;for(var r=this._head,i=r.next;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(e.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,it.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"shared",{get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared},enumerable:!1,configurable:!0}),Object.defineProperty(e,"system",{get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system},enumerable:!1,configurable:!0}),e}(),Cn=function(){function e(){}return e.init=function(e){var n=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,t.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}}),this.stop=function(){n._ticker.stop()},this.start=function(){n._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Nn.shared:new Nn,e.autoStart&&this.start()},e.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},e.extension=t.ExtensionType.Application,e}();it.PREFER_ENV=rt.any?t.ENV.WEBGL:t.ENV.WEBGL2,it.STRICT_TEXTURE_CACHE=!1;var Rn=[];function On(t,e){if(!t)return null;var n="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(n=r[1].toLowerCase())}for(var i=Rn.length-1;i>=0;--i){var a=Rn[i];if(a.test&&a.test(t,n))return new a(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var Dn=function(t,e){return Dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Dn(t,e)};function Mn(t,e){function n(){this.constructor=t}Dn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Fn=function(){return Fn=Object.assign||function(t){for(var e,n=arguments,r=1,i=arguments.length;r<i;r++)for(var a in e=n[r])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},Fn.apply(this,arguments)};var Pn=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new In("setRealSize"),this.onUpdate=new In("update"),this.onError=new In("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,n){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),Ln=function(e){function n(t,n){var r=this,i=n||{},a=i.width,o=i.height;if(!a||!o)throw new Error("BufferResource width or height invalid");return(r=e.call(this,a,o)||this).data=t,r}return Mn(n,e),n.prototype.upload=function(e,n,r){var i=e.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===t.ALPHA_MODES.UNPACK);var a=n.realWidth,o=n.realHeight;return r.width===a&&r.height===o?i.texSubImage2D(n.target,0,0,0,a,o,n.format,r.type,this.data):(r.width=a,r.height=o,i.texImage2D(n.target,0,r.internalFormat,a,o,0,n.format,r.type,this.data)),!0},n.prototype.dispose=function(){this.data=null},n.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},n}(Pn),Bn={scaleMode:t.SCALE_MODES.NEAREST,format:t.FORMATS.RGBA,alphaMode:t.ALPHA_MODES.NPM},zn=function(e){function n(n,r){void 0===n&&(n=null),void 0===r&&(r=null);var i=e.call(this)||this,a=(r=r||{}).alphaMode,o=r.mipmap,s=r.anisotropicLevel,u=r.scaleMode,c=r.width,l=r.height,h=r.wrapMode,p=r.format,f=r.type,d=r.target,m=r.resolution,g=r.resourceOptions;return!n||n instanceof Pn||((n=On(n,g)).internal=!0),i.resolution=m||it.RESOLUTION,i.width=Math.round((c||0)*i.resolution)/i.resolution,i.height=Math.round((l||0)*i.resolution)/i.resolution,i._mipmap=void 0!==o?o:it.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==s?s:it.ANISOTROPIC_LEVEL,i._wrapMode=h||it.WRAP_MODE,i._scaleMode=void 0!==u?u:it.SCALE_MODE,i.format=p||t.FORMATS.RGBA,i.type=f||t.TYPES.UNSIGNED_BYTE,i.target=d||t.TARGETS.TEXTURE_2D,i.alphaMode=void 0!==a?a:t.ALPHA_MODES.UNPACK,i.uid=De(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=c>0&&l>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(n),i}return Mn(n,e),Object.defineProperty(n.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),n.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},n.prototype.setSize=function(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)},n.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},n.prototype._refreshPOT=function(){this.isPowerOfTwo=Ae(this.realWidth)&&Ae(this.realHeight)},n.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},n.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},n.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},n.prototype.onError=function(t){this.emit("error",this,t)},n.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Be[this.cacheId],delete Le[this.cacheId],this.cacheId=null),this.dispose(),n.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},n.prototype.dispose=function(){this.emit("dispose",this)},n.prototype.castToBaseTexture=function(){return this},n.from=function(t,e,r){void 0===r&&(r=it.STRICT_TEXTURE_CACHE);var i="string"==typeof t,a=null;if(i)a=t;else{if(!t._pixiId){var o=e&&e.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+De()}a=t._pixiId}var s=Be[a];if(i&&r&&!s)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return s||((s=new n(t,e)).cacheId=a,n.addToCache(s,a)),s},n.fromBuffer=function(e,r,i,a){e=e||new Float32Array(r*i*4);var o=new Ln(e,{width:r,height:i}),s=e instanceof Float32Array?t.TYPES.FLOAT:t.TYPES.UNSIGNED_BYTE;return new n(o,Object.assign({},Bn,a||{width:r,height:i,type:s}))},n.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Be[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Be[e]=t)},n.removeFromCache=function(t){if("string"==typeof t){var e=Be[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Be[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete Be[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},n._globalBatch=0,n}(st),Un=function(t){function e(e,n){var r=this,i=n||{},a=i.width,o=i.height;(r=t.call(this,a,o)||this).items=[],r.itemDirtyIds=[];for(var s=0;s<e;s++){var u=new zn;r.items.push(u),r.itemDirtyIds.push(-2)}return r.length=e,r._load=null,r.baseTexture=null,r}return Mn(e,t),e.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof Pn?this.addResourceAt(t[n],n):this.addResourceAt(On(t[n],e),n))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],n=e.realWidth,r=e.realHeight;return t.resize(n,r),Promise.resolve(t)})),this._load},e}(Pn),Gn=function(e){function n(t,n){var r,i,a=this,o=n||{},s=o.width,u=o.height;return Array.isArray(t)?(r=t,i=t.length):i=t,a=e.call(this,i,{width:s,height:u})||this,r&&a.initFromArray(r,n),a}return Mn(n,e),n.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},n.prototype.bind=function(n){e.prototype.bind.call(this,n),n.target=t.TARGETS.TEXTURE_2D_ARRAY},n.prototype.upload=function(t,e,n){var r=this,i=r.length,a=r.itemDirtyIds,o=r.items,s=t.gl;n.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,e.format,n.type,null);for(var u=0;u<i;u++){var c=o[u];a[u]<c.dirtyId&&(a[u]=c.dirtyId,c.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,u,c.resource.width,c.resource.height,1,e.format,n.type,c.resource.source))}return!0},n}(Un),Wn=function(e){function n(t){var n=this,r=t,i=r.naturalWidth||r.videoWidth||r.width,a=r.naturalHeight||r.videoHeight||r.height;return(n=e.call(this,i,a)||this).source=t,n.noSubImage=!1,n}return Mn(n,e),n.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=Ve(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous")},n.prototype.upload=function(e,n,r,i){var a=e.gl,o=n.realWidth,s=n.realHeight;if((i=i||this.source)instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if(i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===t.ALPHA_MODES.UNPACK),this.noSubImage||n.target!==a.TEXTURE_2D||r.width!==o||r.height!==s?(r.width=o,r.height=s,a.texImage2D(n.target,0,r.internalFormat,n.format,r.type,i)):a.texSubImage2D(a.TEXTURE_2D,0,0,0,n.format,r.type,i),!0},n.prototype.update=function(){if(!this.destroyed){var t=this.source,n=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(n,r),e.prototype.update.call(this)}},n.prototype.dispose=function(){this.source=null},n}(Pn),Vn=function(t){function e(e){return t.call(this,e)||this}return Mn(e,t),e.test=function(t){var e=globalThis.OffscreenCanvas;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(Wn),jn=function(e){function n(r,i){var a=this,o=i||{},s=o.width,u=o.height,c=o.autoLoad,l=o.linkBaseTexture;if(r&&r.length!==n.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");a=e.call(this,6,{width:s,height:u})||this;for(var h=0;h<n.SIDES;h++)a.items[h].target=t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+h;return a.linkBaseTexture=!1!==l,r&&a.initFromArray(r,i),!1!==c&&a.load(),a}return Mn(n,e),n.prototype.bind=function(n){e.prototype.bind.call(this,n),n.target=t.TARGETS.TEXTURE_CUBE_MAP},n.prototype.addBaseTextureAt=function(e,n,r){if(!this.items[n])throw new Error("Index "+n+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,n)}else e.target=t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+n,e.parentTextureArray=this.baseTexture,this.items[n]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[n]=e,this},n.prototype.upload=function(t,e,r){for(var i=this.itemDirtyIds,a=0;a<n.SIDES;a++){var o=this.items[a];(i[a]<o.dirtyId||r.dirtyId<e.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,r),i[a]=o.dirtyId):i[a]<-1&&(t.gl.texImage2D(o.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),i[a]=-1))}return!0},n.test=function(t){return Array.isArray(t)&&t.length===n.SIDES},n.SIDES=6,n}(Un),Hn=function(e){function n(t,n){var r=this;if(n=n||{},!(t instanceof HTMLImageElement)){var i=new Image;Wn.crossOrigin(i,t,n.crossorigin),i.src=t,t=i}return r=e.call(this,t)||this,!t.complete&&r._width&&r._height&&(r._width=0,r._height=0),r.url=t.src,r._process=null,r.preserveBitmap=!1,r.createBitmap=(void 0!==n.createBitmap?n.createBitmap:it.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,r.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,r.bitmap=null,r._load=null,!1!==n.autoLoad&&r.load(),r}return Mn(n,e),n.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){var r=e.source;e.url=r.src;var i=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?i():(r.onload=i,r.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load},n.prototype.process=function(){var e=this,n=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var r=globalThis.createImageBitmap,i=!n.crossOrigin||"anonymous"===n.crossOrigin;return this._process=fetch(n.src,{mode:i?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(i){return r(i,0,0,n.width,n.height,{premultiplyAlpha:null===e.alphaMode||e.alphaMode===t.ALPHA_MODES.UNPACK?"premultiply":"none"})})).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process},n.prototype.upload=function(t,n,r){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,n,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,n,r,this.bitmap),!this.preserveBitmap){var i=!0,a=n._glTextures;for(var o in a){var s=a[o];if(s!==r&&s.dirtyId!==n.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},n.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},n.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},n}(Wn),Xn=function(t){function e(e,n){var r=this;return n=n||{},(r=t.call(this,it.ADAPTER.createCanvas())||this)._width=0,r._height=0,r.svg=e,r.scale=n.scale||1,r._overrideWidth=n.width,r._overrideHeight=n.height,r._resolve=null,r._crossorigin=n.crossorigin,r._load=null,!1!==n.autoLoad&&r.load(),r}return Mn(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(n){if(t._resolve=function(){t.resize(t.source.width,t.source.height),n(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;Wn.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){t._resolve&&(e.onerror=null,t.onError.emit(n))},e.onload=function(){if(t._resolve){var n=e.width,r=e.height;if(!n||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=n*t.scale,a=r*t.scale;(t._overrideWidth||t._overrideHeight)&&(i=t._overrideWidth||t._overrideHeight/r*n,a=t._overrideHeight||t._overrideWidth/n*r),i=Math.round(i),a=Math.round(a);var o=t.source;o.width=i,o.height=a,o._pixiId="canvas_"+De(),o.getContext("2d").drawImage(e,0,0,n,r,0,0,i,a),t._resolve(),t._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,n){return"svg"===n||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(Wn),qn=function(t){function e(n,r){var i=this;if(r=r||{},!(n instanceof HTMLVideoElement)){var a=document.createElement("video");a.setAttribute("preload","auto"),a.setAttribute("webkit-playsinline",""),a.setAttribute("playsinline",""),"string"==typeof n&&(n=[n]);var o=n[0].src||n[0];Wn.crossOrigin(a,o,r.crossorigin);for(var s=0;s<n.length;++s){var u=document.createElement("source"),c=n[s],l=c.src,h=c.mime,p=(l=l||n[s]).split("?").shift().toLowerCase(),f=p.slice(p.lastIndexOf(".")+1);h=h||e.MIME_TYPES[f]||"video/"+f,u.src=l,u.type=h,a.appendChild(u)}n=a}return(i=t.call(this,n)||this).noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=r.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=!1!==r.autoPlay,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),!1!==r.autoLoad&&i.load(),i}return Mn(e,t),e.prototype.update=function(e){if(!this.destroyed){var n=Nn.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()},e.prototype._isSourceReady=function(){return this.source.readyState>2},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Nn.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Nn.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(Nn.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Nn.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Nn.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,n){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(Wn),Kn=function(t){function e(e){return t.call(this,e)||this}return Mn(e,t),e.test=function(t){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap},e}(Wn);Rn.push(Hn,Kn,Vn,qn,Xn,Ln,jn,Gn);var Yn={__proto__:null,Resource:Pn,BaseImageResource:Wn,INSTALLED:Rn,autoDetectResource:On,AbstractMultiResource:Un,ArrayResource:Gn,BufferResource:Ln,CanvasResource:Vn,CubeResource:jn,ImageResource:Hn,SVGResource:Xn,VideoResource:qn,ImageBitmapResource:Kn},Zn=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Mn(n,e),n.prototype.upload=function(e,n,r){var i=e.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===t.ALPHA_MODES.UNPACK);var a=n.realWidth,o=n.realHeight;return r.width===a&&r.height===o?i.texSubImage2D(n.target,0,0,0,a,o,n.format,r.type,this.data):(r.width=a,r.height=o,i.texImage2D(n.target,0,r.internalFormat,a,o,0,n.format,r.type,this.data)),!0},n}(Ln),$n=function(){function e(e,n){this.width=Math.round(e||100),this.height=Math.round(n||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new In("disposeFramebuffer"),this.multisample=t.MSAA_QUALITY.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,n){return void 0===e&&(e=0),this.colorTextures[e]=n||new zn(null,{scaleMode:t.SCALE_MODES.NEAREST,resolution:1,mipmap:t.MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new zn(new Zn(null,{width:this.width,height:this.height}),{scaleMode:t.SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:t.MIPMAP_MODES.OFF,format:t.FORMATS.DEPTH_COMPONENT,type:t.TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var r=this.colorTextures[n],i=r.resolution;r.setSize(t/i,e/i)}if(this.depthTexture){i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),Jn=function(e){function n(n){void 0===n&&(n={});var r=this;"number"==typeof n&&(n={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});return n.width=n.width||100,n.height=n.height||100,n.multisample=void 0!==n.multisample?n.multisample:t.MSAA_QUALITY.NONE,(r=e.call(this,null,n)||this).mipmap=t.MIPMAP_MODES.OFF,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new $n(r.realWidth,r.realHeight).addColorTexture(0,r),r.framebuffer.multisample=n.multisample,r.maskStack=[],r.filterStack=[{}],r}return Mn(n,e),n.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},n.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},n.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},n}(zn),Qn=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,n){var r=e.width,i=e.height;if(n){var a=t.width/2/r,o=t.height/2/i,s=t.x/r+a,u=t.y/i+o;n=fn.add(n,fn.NW),this.x0=s+a*fn.uX(n),this.y0=u+o*fn.uY(n),n=fn.add(n,2),this.x1=s+a*fn.uX(n),this.y1=u+o*fn.uY(n),n=fn.add(n,2),this.x2=s+a*fn.uX(n),this.y2=u+o*fn.uY(n),n=fn.add(n,2),this.x3=s+a*fn.uX(n),this.y3=u+o*fn.uY(n)}else this.x0=t.x/r,this.y0=t.y/i,this.x1=(t.x+t.width)/r,this.y1=t.y/i,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/i,this.x3=t.x/r,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},t}(),tr=new Qn;function er(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}var nr=function(t){function e(n,r,i,a,o,s){var u=t.call(this)||this;if(u.noFrame=!1,r||(u.noFrame=!0,r=new Je(0,0,1,1)),n instanceof e&&(n=n.baseTexture),u.baseTexture=n,u._frame=r,u.trim=a,u.valid=!1,u._uvs=tr,u.uvMatrix=null,u.orig=i||r,u._rotate=Number(o||0),!0===o)u._rotate=2;else if(u._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return u.defaultAnchor=s?new Ze(s.x,s.y):new Ze(0,0),u._updateID=0,u.textureCacheIds=[],n.valid?u.noFrame?n.valid&&u.onBaseTextureUpdated(n):u.frame=r:n.once("loaded",u.onBaseTextureUpdated,u),u.noFrame&&n.on("update",u.onBaseTextureUpdated,u),u}return Mn(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture.resource;n&&n.url&&Le[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),n=this._frame===this.orig?t:this.orig.clone(),r=new e(this.baseTexture,!this.noFrame&&t,n,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(r._frame=t),r},e.prototype.updateUvs=function(){this._uvs===tr&&(this._uvs=new Qn),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,r){void 0===n&&(n={}),void 0===r&&(r=it.STRICT_TEXTURE_CACHE);var i="string"==typeof t,a=null;if(i)a=t;else if(t instanceof zn){if(!t.cacheId){var o=n&&n.pixiIdPrefix||"pixiid";t.cacheId=o+"-"+De(),zn.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){o=n&&n.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+De()}a=t._pixiId}var s=Le[a];if(i&&r&&!s)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return s||t instanceof zn?!s&&t instanceof zn&&(s=new e(t),e.addToCache(s,a)):(n.resolution||(n.resolution=je(t)),(s=new e(new zn(t,n))).baseTexture.cacheId=a,zn.addToCache(s.baseTexture,a),e.addToCache(s,a)),s},e.fromURL=function(t,n){var r=Object.assign({autoLoad:!1},null==n?void 0:n.resourceOptions),i=e.from(t,Object.assign({resourceOptions:r},n),!1),a=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):a.load().then((function(){return Promise.resolve(i)}))},e.fromBuffer=function(t,n,r,i){return new e(zn.fromBuffer(t,n,r,i))},e.fromLoader=function(t,n,r,i){var a=new zn(t,Object.assign({scaleMode:it.SCALE_MODE,resolution:je(n)},i)),o=a.resource;o instanceof Hn&&(o.url=n);var s=new e(a);return r||(r=n),zn.addToCache(s.baseTexture,r),e.addToCache(s,r),r!==n&&(zn.addToCache(s.baseTexture,n),e.addToCache(s,n)),s.baseTexture.valid?Promise.resolve(s):new Promise((function(t){s.baseTexture.once("loaded",(function(){return t(s)}))}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Le[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Le[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Le[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Le[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Le[t.textureCacheIds[r]]===t&&delete Le[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,r=t.width,i=t.height,a=e+r>this.baseTexture.width,o=n+i>this.baseTexture.height;if(a||o){var s=a&&o?"and":"or",u="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,c="Y: "+n+" + "+i+" = "+(n+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+s+" "+c)}this.valid=r&&i&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(e,"EMPTY",{get:function(){return e._EMPTY||(e._EMPTY=new e(new zn),er(e._EMPTY),er(e._EMPTY.baseTexture)),e._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WHITE",{get:function(){if(!e._WHITE){var t=it.ADAPTER.createCanvas(16,16),n=t.getContext("2d");t.width=16,t.height=16,n.fillStyle="white",n.fillRect(0,0,16,16),e._WHITE=new e(zn.from(t)),er(e._WHITE),er(e._WHITE.baseTexture)}return e._WHITE},enumerable:!1,configurable:!0}),e}(st),rr=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.valid=!0,r.filterFrame=null,r.filterPoolKey=null,r.updateUvs(),r}return Mn(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,n){void 0===n&&(n=!0);var r=this.baseTexture.resolution,i=Math.round(t*r)/r,a=Math.round(e*r)/r;this.valid=i>0&&a>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=a,n&&this.baseTexture.resize(i,a),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){for(var n=arguments,r=[],i=1;i<arguments.length;i++)r[i-1]=n[i];return"number"==typeof t&&(Fe("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:r[0],scaleMode:r[1],resolution:r[2]}),new e(new Jn(t))},e}(nr),ir=function(){function e(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,n,r){void 0===r&&(r=t.MSAA_QUALITY.NONE);var i=new Jn(Object.assign({width:e,height:n,resolution:1,multisample:r},this.textureOptions));return new rr(i)},e.prototype.getOptimalTexture=function(e,n,r,i){var a;void 0===r&&(r=1),void 0===i&&(i=t.MSAA_QUALITY.NONE),e=Math.ceil(e*r-1e-6),n=Math.ceil(n*r-1e-6),this.enableFullScreen&&e===this._pixelsWidth&&n===this._pixelsHeight?a=i>1?-i:-1:(a=((65535&(e=Ie(e)))<<16|65535&(n=Ie(n)))>>>0,i>1&&(a+=4294967296*i)),this.texturePool[a]||(this.texturePool[a]=[]);var o=this.texturePool[a].pop();return o||(o=this.createTexture(e,n,i)),o.filterPoolKey=a,o.setResolution(r),o},e.prototype.getFilterTexture=function(e,n,r){var i=this.getOptimalTexture(e.width,e.height,n||e.resolution,r||t.MSAA_QUALITY.NONE);return i.filterFrame=e.filterFrame,i},e.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},e.prototype.returnFilterTexture=function(t){this.returnTexture(t)},e.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY=-1,e}(),ar=function(){function e(e,n,r,i,a,o,s){void 0===n&&(n=0),void 0===r&&(r=!1),void 0===i&&(i=t.TYPES.FLOAT),this.buffer=e,this.size=n,this.normalized=r,this.type=i,this.stride=a,this.start=o,this.instance=s}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,n,r,i,a){return new e(t,n,r,i,a)},e}(),or=0,sr=function(){function e(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=or++,this.disposeRunner=new In("disposeBuffer")}return e.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(e.prototype,"index",{get:function(){return this.type===t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER},set:function(e){this.type=e?t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:t.BUFFER_TYPE.ARRAY_BUFFER},enumerable:!1,configurable:!0}),e.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)},e}(),ur={Float32Array,Uint32Array,Int32Array,Uint8Array};var cr={5126:4,5123:2,5121:1},lr=0,hr={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},pr=function(){function e(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=lr++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new In("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(t,e,n,r,i,a,o,s){if(void 0===n&&(n=0),void 0===r&&(r=!1),void 0===s&&(s=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof sr||(e instanceof Array&&(e=new Float32Array(e)),e=new sr(e));var u=t.split("|");if(u.length>1){for(var c=0;c<u.length;c++)this.addAttribute(u[c],e,n,r,i);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new ar(l,n,r,i,a,o,s),this.instanced=this.instanced||s,this},e.prototype.getAttribute=function(t){return this.attributes[t]},e.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},e.prototype.addIndex=function(e){return e instanceof sr||(e instanceof Array&&(e=new Uint16Array(e)),e=new sr(e)),e.type=t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],r=new sr;for(t in this.attributes){var i=this.attributes[t],a=this.buffers[i.buffer];e.push(a.data),n.push(i.size*cr[i.type]/4),i.buffer=0}for(r.data=function(t,e){for(var n=0,r=0,i={},a=0;a<t.length;a++)r+=e[a],n+=t[a].length;var o=new ArrayBuffer(4*n),s=null,u=0;for(a=0;a<t.length;a++){var c=e[a],l=t[a],h=Ee(l);i[h]||(i[h]=new ur[h](o)),s=i[h];for(var p=0;p<l.length;p++)s[(p/c|0)*r+u+p%c]=l[p];u+=c}return new Float32Array(o)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var n=new e,r=0;r<this.buffers.length;r++)n.buffers[r]=new sr(this.buffers[r].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];n.attributes[r]=new ar(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(n.indexBuffer=n.buffers[this.buffers.indexOf(this.indexBuffer)],n.indexBuffer.type=t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),n},e.merge=function(n){for(var r,i=new e,a=[],o=[],s=[],u=0;u<n.length;u++){r=n[u];for(var c=0;c<r.buffers.length;c++)o[c]=o[c]||0,o[c]+=r.buffers[c].data.length,s[c]=0}for(u=0;u<r.buffers.length;u++)a[u]=new(hr[Ee(r.buffers[u].data)])(o[u]),i.buffers[u]=new sr(a[u]);for(u=0;u<n.length;u++){r=n[u];for(c=0;c<r.buffers.length;c++)a[c].set(r.buffers[c].data,s[c]),s[c]+=r.buffers[c].data.length}if(i.attributes=r.attributes,r.indexBuffer){i.indexBuffer=i.buffers[r.buffers.indexOf(r.indexBuffer)],i.indexBuffer.type=t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;var l=0,h=0,p=0,f=0;for(u=0;u<r.buffers.length;u++)if(r.buffers[u]!==r.indexBuffer){f=u;break}for(var u in r.attributes){var d=r.attributes[u];(0|d.buffer)===f&&(h+=d.size*cr[d.type]/4)}for(u=0;u<n.length;u++){var m=n[u].indexBuffer.data;for(c=0;c<m.length;c++)i.indexBuffer.data[c+p]+=l;l+=n[u].buffers[f].data.length/h,p+=m.length}}return i},e}(),fr=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return Mn(e,t),e}(pr),dr=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new sr(e.vertices),e.uvBuffer=new sr(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return Mn(e,t),e.prototype.map=function(t,e){var n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+e.width/t.width,this.uvs[3]=r,this.uvs[4]=n+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=n,this.uvs[7]=r+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(pr),mr=0,gr=function(){function e(e,n,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=mr++,this.static=!!n,this.ubo=!!r,e instanceof sr?(this.buffer=e,this.buffer.type=t.BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new sr(new Float32Array(1)),this.buffer.type=t.BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}return e.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},e.prototype.add=function(t,n,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new e(n,r)},e.from=function(t,n,r){return new e(t,n,r)},e.uboFrom=function(t,n){return new e(t,null==n||n,!0)},e}(),vr=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=t.MSAA_QUALITY.NONE,this.sourceFrame=new Je,this.destinationFrame=new Je,this.bindingSourceFrame=new Je,this.bindingDestinationFrame=new Je,this.filters=[],this.transform=null}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}(),yr=[new Ze,new Ze,new Ze,new Ze],br=new an,xr=function(){function e(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new ir,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new fr,this.quadUv=new dr,this.tempRect=new Je,this.activeState={},this.globalUniforms=new gr({outputFrame:new Je,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return e.prototype.push=function(t,e){for(var n,r,i=this.renderer,a=this.defaultFilterStack,o=this.statePool.pop()||new vr,s=this.renderer.renderTexture,u=e[0].resolution,c=e[0].multisample,l=e[0].padding,h=e[0].autoFit,p=null===(n=e[0].legacy)||void 0===n||n,f=1;f<e.length;f++){var d=e[f];u=Math.min(u,d.resolution),c=Math.min(c,d.multisample),l=this.useMaxPadding?Math.max(l,d.padding):l+d.padding,h=h&&d.autoFit,p=p||null===(r=d.legacy)||void 0===r||r}1===a.length&&(this.defaultFilterStack[0].renderTexture=s.current),a.push(o),o.resolution=u,o.multisample=c,o.legacy=p,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(l);var m=this.tempRect.copyFrom(s.sourceFrame);i.projection.transform&&this.transformAABB(br.copyFrom(i.projection.transform).invert(),m),h?(o.sourceFrame.fit(m),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(m)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,u,c),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var g=this.tempRect;g.x=0,g.y=0,g.width=o.sourceFrame.width,g.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(s.sourceFrame),o.bindingDestinationFrame.copyFrom(s.destinationFrame),o.transform=i.projection.transform,i.projection.transform=null,s.bind(o.renderTexture,o.sourceFrame,g),i.framebuffer.clear(0,0,0,0)},e.prototype.pop=function(){var e=this.defaultFilterStack,n=e.pop(),r=n.filters;this.activeState=n;var i=this.globalUniforms.uniforms;i.outputFrame=n.sourceFrame,i.resolution=n.resolution;var a=i.inputSize,o=i.inputPixel,s=i.inputClamp;if(a[0]=n.destinationFrame.width,a[1]=n.destinationFrame.height,a[2]=1/a[0],a[3]=1/a[1],o[0]=Math.round(a[0]*n.resolution),o[1]=Math.round(a[1]*n.resolution),o[2]=1/o[0],o[3]=1/o[1],s[0]=.5*o[2],s[1]=.5*o[3],s[2]=n.sourceFrame.width*a[2]-.5*o[2],s[3]=n.sourceFrame.height*a[3]-.5*o[3],n.legacy){var u=i.filterArea;u[0]=n.destinationFrame.width,u[1]=n.destinationFrame.height,u[2]=n.sourceFrame.x,u[3]=n.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var c=e[e.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,n.renderTexture,c.renderTexture,t.CLEAR_MODES.BLEND,n),this.returnFilterTexture(n.renderTexture);else{var l=n.renderTexture,h=this.getOptimalFilterTexture(l.width,l.height,n.resolution);h.filterFrame=l.filterFrame;var p=0;for(p=0;p<r.length-1;++p){1===p&&n.multisample>1&&((h=this.getOptimalFilterTexture(l.width,l.height,n.resolution)).filterFrame=l.filterFrame),r[p].apply(this,l,h,t.CLEAR_MODES.CLEAR,n);var f=l;l=h,h=f}r[p].apply(this,l,c.renderTexture,t.CLEAR_MODES.BLEND,n),p>1&&n.multisample>1&&this.returnFilterTexture(n.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(h)}n.clear(),this.statePool.push(n)},e.prototype.bindAndClear=function(e,n){void 0===n&&(n=t.CLEAR_MODES.CLEAR);var r=this.renderer,i=r.renderTexture,a=r.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,i.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var s=1&a.stateId||this.forceClear;(n===t.CLEAR_MODES.CLEAR||n===t.CLEAR_MODES.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)},e.prototype.applyFilter=function(e,n,r,i){var a=this.renderer;a.state.set(e.state),this.bindAndClear(r,i),e.uniforms.uSampler=n,e.uniforms.filterGlobals=this.globalUniforms,a.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(n._frame,n.filterFrame),a.geometry.bind(this.quadUv),a.geometry.draw(t.DRAW_MODES.TRIANGLES)):(a.geometry.bind(this.quad),a.geometry.draw(t.DRAW_MODES.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,r=n.sourceFrame,i=n.destinationFrame,a=e._texture.orig,o=t.set(i.width,0,0,i.height,r.x,r.y),s=e.worldTransform.copyTo(an.TEMP_MATRIX);return s.invert(),o.prepend(s),o.scale(1/a.width,1/a.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(e,n,r,i){return void 0===r&&(r=1),void 0===i&&(i=t.MSAA_QUALITY.NONE),this.texturePool.getOptimalTexture(e,n,r,i)},e.prototype.getFilterTexture=function(e,n,r){if("number"==typeof e){var i=e;e=n,n=i}e=e||this.activeState.renderTexture;var a=this.texturePool.getOptimalTexture(e.width,e.height,n||e.resolution,r||t.MSAA_QUALITY.NONE);return a.filterFrame=e.filterFrame,a},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e.prototype.transformAABB=function(t,e){var n=yr[0],r=yr[1],i=yr[2],a=yr[3];n.set(e.left,e.top),r.set(e.left,e.bottom),i.set(e.right,e.top),a.set(e.right,e.bottom),t.apply(n,n),t.apply(r,r),t.apply(i,i),t.apply(a,a);var o=Math.min(n.x,r.x,i.x,a.x),s=Math.min(n.y,r.y,i.y,a.y),u=Math.max(n.x,r.x,i.x,a.x),c=Math.max(n.y,r.y,i.y,a.y);e.x=o,e.y=s,e.width=u-o,e.height=c-s},e.prototype.roundFrame=function(t,e,n,r,i){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(i){var a=i.a,o=i.b,s=i.c,u=i.d;if((Math.abs(o)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(u)>1e-4))return}(i=i?br.copyFrom(i):br.identity()).translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)}},e}(),wr=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),_r=function(){function t(t){this.renderer=t,this.emptyRenderer=new wr(t),this.currentRenderer=this.emptyRenderer}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,r=e-1;r>=0;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,n,r){for(var i=t.elements,a=t.ids,o=t.count,s=0,u=0;u<o;u++){var c=i[u],l=c._batchLocation;if(l>=0&&l<r&&e[l]===c)a[u]=l;else for(;s<r;){var h=e[s];if(!h||h._batchEnabled!==n||h._batchLocation!==s){a[u]=s,c._batchLocation=s,e[s]=c;break}s++}}},t.prototype.destroy=function(){this.renderer=null},t}(),Sr=0,Tr=function(){function e(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(e.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Sr++},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Sr++,this.renderer.runners.contextChange.emit(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(e,n){var r;if(it.PREFER_ENV>=t.ENV.WEBGL2&&(r=e.getContext("webgl2",n)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},e.prototype.getExtensions=function(){var t=this.gl,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},e.prototype.handleContextLost=function(t){var e=this;t.preventDefault(),setTimeout((function(){e.gl.isContextLost()&&e.extensions.loseContext&&e.extensions.loseContext.restoreContext()}),0)},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){var e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var r=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},e}(),Er=function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=t.MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},kr=new Je,Ir=function(){function e(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new $n(10,10),this.msaaSamples=null}return e.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Je,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){var n=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;it.PREFER_ENV===t.ENV.WEBGL_LEGACY&&(n=null,r=null),n?e.drawBuffers=function(t){return n.drawBuffersWEBGL(t)}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},e.prototype.bind=function(t,e,n){void 0===n&&(n=0);var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=n),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var a=0;a<t.colorTextures.length;a++){var o=t.colorTextures[a];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var s=e.width>>n,u=e.height>>n,c=s/e.width;this.setViewport(e.x*c,e.y*c,s,u)}else{s=t.width>>n,u=t.height>>n;this.setViewport(0,0,s,u)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,n,r){var i=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),i.width===n&&i.height===r&&i.x===t&&i.y===e||(i.x=t,i.y=e,i.width=n,i.height=r,this.gl.viewport(t,e,n,r))},Object.defineProperty(e.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),e.prototype.clear=function(e,n,r,i,a){void 0===a&&(a=t.BUFFER_BITS.COLOR|t.BUFFER_BITS.DEPTH);var o=this.gl;o.clearColor(e,n,r,i),o.clear(a)},e.prototype.initFramebuffer=function(t){var e=this.gl,n=new Er(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n},e.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height)),n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var r=t.colorTextures,i=r.length;e.drawBuffers||(i=Math.min(i,1));for(var a=0;a<i;a++){var o=r[a],s=o.parentTextureArray||o;this.renderer.texture.bind(s,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t,e){var n=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures,a=i.length;n.drawBuffers||(a=Math.min(a,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?(r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.RGBA8,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));for(var o=[],s=0;s<a;s++){var u=i[s],c=u.parentTextureArray||u;this.renderer.texture.bind(c,0),0===s&&r.msaaBuffer||(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+s,u.target,c._glTextures[this.CONTEXT_UID].texture,e),o.push(n.COLOR_ATTACHMENT0+s))}if((o.length>1&&n.drawBuffers(o),t.depthTexture)&&this.writeDepthTexture){var l=t.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null):(r.stencil=r.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,r.stencil))},e.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},e.prototype.detectSamples=function(e){var n=this.msaaSamples,r=t.MSAA_QUALITY.NONE;if(e<=1||null===n)return r;for(var i=0;i<n.length;i++)if(n[i]<=e){r=n[i];break}return 1===r&&(r=t.MSAA_QUALITY.NONE),r},e.prototype.blit=function(t,e,n){var r=this,i=r.current,a=r.renderer,o=r.gl,s=r.CONTEXT_UID;if(2===a.context.webGLVersion&&i){var u=i.glFramebuffers[s];if(u){if(!t){if(!u.msaaBuffer)return;var c=i.colorTextures[0];if(!c)return;u.blitFramebuffer||(u.blitFramebuffer=new $n(i.width,i.height),u.blitFramebuffer.addColorTexture(0,c)),(t=u.blitFramebuffer).colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),t.width===i.width&&t.height===i.height||(t.width=i.width,t.height=i.height,t.dirtyId++,t.dirtySize++)}e||((e=kr).width=i.width,e.height=i.height),n||(n=e);var l=e.width===n.width&&e.height===n.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,u.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR)}}},e.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var n=t.width,r=t.height,i=this.gl,a=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,a),e.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,e.multisample,i.DEPTH24_STENCIL8,n,r):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,n,r),e.stencil=a,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,a)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Je},e.prototype.destroy=function(){this.renderer=null},e}(),Ar={5126:4,5123:2,5121:1},Nr=function(){function e(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return e.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,n=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==n.webGLVersion){var r=this.renderer.context.extensions.vertexArrayObject;it.PREFER_ENV===t.ENV.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=function(){return r.createVertexArrayOES()},e.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},e.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==n.webGLVersion){var i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},e.drawElementsInstanced=function(t,e,n,r,a){return i.drawElementsInstancedANGLE(t,e,n,r,a)},e.drawArraysInstanced=function(t,e,n,r){return i.drawArraysInstancedANGLE(t,e,n,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===n.webGLVersion||!!n.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);var a=r[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?n.bindVertexArray(a):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,n=0;n<t.buffers.length;n++){var r=t.buffers[n];e.update(r)}},e.prototype.checkCompatibility=function(t,e){var n=t.attributes,r=e.attributeData;for(var i in r)if(!n[i])throw new Error('shader and geometry incompatible, geometry missing the "'+i+'" attribute')},e.prototype.getSignature=function(t,e){var n=t.attributes,r=e.attributeData,i=["g",t.id];for(var a in n)r[a]&&i.push(a,r[a].location);return i.join("-")},e.prototype.initGeometryVao=function(t,e,n){void 0===n&&(n=!0);var r=this.gl,i=this.CONTEXT_UID,a=this.renderer.buffer,o=e.program;o.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var s=this.getSignature(t,o),u=t.glVertexArrayObjects[this.CONTEXT_UID],c=u[s];if(c)return u[o.id]=c,c;var l=t.buffers,h=t.attributes,p={},f={};for(var d in l)p[d]=0,f[d]=0;for(var d in h)!h[d].size&&o.attributeData[d]?h[d].size=o.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),p[h[d].buffer]+=h[d].size*Ar[h[d].type];for(var d in h){var m=h[d],g=m.size;void 0===m.stride&&(p[m.buffer]===g*Ar[m.type]?m.stride=0:m.stride=p[m.buffer]),void 0===m.start&&(m.start=f[m.buffer],f[m.buffer]+=g*Ar[m.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(var v=0;v<l.length;v++){var y=l[v];a.bind(y),n&&y._glBuffers[i].refCount++}return this.activateVao(t,o),this._activeVao=c,u[o.id]=c,u[s]=c,c},e.prototype.disposeGeometry=function(t,e){var n;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,a=t.buffers,o=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(t.disposeRunner.remove(this),r){if(o)for(var s=0;s<a.length;s++){var u=a[s]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,0!==u.refCount||e||o.dispose(a[s],e))}if(!e)for(var c in r)if("g"===c[0]){var l=r[c];this._activeVao===l&&this.unbind(),i.deleteVertexArray(l)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)},e.prototype.activateVao=function(t,e){var n=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,a=t.buffers,o=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);var s=null;for(var u in o){var c=o[u],l=a[c.buffer],h=l._glBuffers[r];if(e.attributeData[u]){s!==h&&(i.bind(l),s=h);var p=e.attributeData[u].location;if(n.enableVertexAttribArray(p),n.vertexAttribPointer(p,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(p,1)}}}},e.prototype.draw=function(t,e,n,r){var i=this.gl,a=this._activeGeometry;if(a.indexBuffer){var o=a.indexBuffer.data.BYTES_PER_ELEMENT,s=2===o?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?a.instanced?i.drawElementsInstanced(t,e||a.indexBuffer.data.length,s,(n||0)*o,r||1):i.drawElements(t,e||a.indexBuffer.data.length,s,(n||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?i.drawArraysInstanced(t,n,e||a.getSize(),r||1):i.drawArrays(t,n,e||a.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e.prototype.destroy=function(){this.renderer=null},e}(),Cr=function(){function e(e){void 0===e&&(e=null),this.type=t.MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=it.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(e.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=t.MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},e.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function Rr(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function Or(t,e){var n=t.getShaderSource(e).split("\n").map((function(t,e){return e+": "+t})),r=t.getShaderInfoLog(e),i=r.split("\n"),a={},o=i.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||a[t])&&(a[t]=!0,!0)})),s=[""];o.forEach((function(t){n[t-1]="%c"+n[t-1]+"%c",s.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var u=n.join("\n");s[0]=u,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,s),console.groupEnd()}function Dr(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function Mr(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Dr(2*e);case"bvec3":return Dr(3*e);case"bvec4":return Dr(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Fr,Pr={},Lr=Pr;function Br(){if(Lr===Pr||Lr&&Lr.isContextLost()){var e=it.ADAPTER.createCanvas(),n=void 0;it.PREFER_ENV>=t.ENV.WEBGL2&&(n=e.getContext("webgl2",{})),n||((n=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?n.getExtension("WEBGL_draw_buffers"):n=null),Lr=n}return Lr}function zr(e,n,r){if("precision"!==e.substring(0,9)){var i=n;return n===t.PRECISION.HIGH&&r!==t.PRECISION.HIGH&&(i=t.PRECISION.MEDIUM),"precision "+i+" float;\n"+e}return r!==t.PRECISION.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var Ur={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Gr(t){return Ur[t]}var Wr=null,Vr={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function jr(t,e){if(!Wr){var n=Object.keys(Vr);Wr={};for(var r=0;r<n.length;++r){var i=n[r];Wr[t[i]]=Vr[i]}}return Wr[e]}var Hr=[{test:function(t){return"float"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t,e){return!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture)},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(t){return"vec2"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(t){return"vec4"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],Xr={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},qr={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Kr,Yr=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Zr(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}function $r(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var r=Yr.replace(/%forloop%/gi,Zr(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}var Jr=0,Qr={},ti=function(){function e(n,r,i){void 0===i&&(i="pixi-shader"),this.id=Jr++,this.vertexSrc=n||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Qr[i]?(Qr[i]++,i+="-"+Qr[i]):Qr[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=zr(this.vertexSrc,it.PRECISION_VERTEX,t.PRECISION.HIGH),this.fragmentSrc=zr(this.fragmentSrc,it.PRECISION_FRAGMENT,function(){if(!Fr){Fr=t.PRECISION.MEDIUM;var e=Br();if(e&&e.getShaderPrecisionFormat){var n=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);Fr=n.precision?t.PRECISION.HIGH:t.PRECISION.MEDIUM}}return Fr}())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),e.from=function(t,n,r){var i=t+n,a=Pe[i];return a||(Pe[i]=a=new e(t,n,r)),a},e}(),ei=function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof gr?e:new gr(e):new gr({}),this.disposeRunner=new In("disposeShader")}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var r=e.uniforms[n];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,n,r){return new t(ti.from(e,n),r)},t}(),ni=function(){function e(){this.data=0,this.blendMode=t.BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==t.BLEND_MODES.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),ri=function(t){function e(n,r,i){var a=this,o=ti.from(n||e.defaultVertexSrc,r||e.defaultFragmentSrc);return(a=t.call(this,o,i)||this).padding=0,a.resolution=it.FILTER_RESOLUTION,a.multisample=it.FILTER_MULTISAMPLE,a.enabled=!0,a.autoFit=!0,a.state=new ni,a}return Mn(e,t),e.prototype.apply=function(t,e,n,r,i){t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(ei),ii=new an,ai=function(){function t(t,e){this._texture=t,this.mapCoord=new an,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,r=0;r<t.length;r+=2){var i=t[r],a=t[r+1];e[r]=i*n.a+a*n.c+n.tx,e[r+1]=i*n.b+a*n.d+n.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var r=e.orig,i=e.trim;i&&(ii.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(ii));var a=e.baseTexture,o=this.uClampFrame,s=this.clampMargin/a.resolution,u=this.clampOffset;return o[0]=(e._frame.x+s+u)/a.width,o[1]=(e._frame.y+s+u)/a.height,o[2]=(e._frame.x+e._frame.width-s+u)/a.width,o[3]=(e._frame.y+e._frame.height-s+u)/a.height,this.uClampOffset[0]=u/a.realWidth,this.uClampOffset[1]=u/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&0===e.rotate,!0},t}(),oi=function(t){function e(e,n,r){var i=this,a=null;return"string"!=typeof e&&void 0===n&&void 0===r&&(a=e,e=void 0,n=void 0,r=void 0),(i=t.call(this,e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",n||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",r)||this).maskSprite=a,i.maskMatrix=new an,i}return Mn(e,t),Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,e,n,r){var i=this._maskSprite,a=i._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new ai(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,e,n,r))},e}(ri),si=function(){function e(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(e,n){var r=n;if(!r.isMaskData){var i=this.maskDataPool.pop()||new Cr;i.pooled=!0,i.maskObject=n,r=i}var a=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(a),r._colorMask=a?a._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==t.MASK_TYPES.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case t.MASK_TYPES.SCISSOR:this.renderer.scissor.push(r);break;case t.MASK_TYPES.STENCIL:this.renderer.stencil.push(r);break;case t.MASK_TYPES.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case t.MASK_TYPES.COLOR:this.pushColorMask(r)}r.type===t.MASK_TYPES.SPRITE&&this.maskStack.push(r)},e.prototype.pop=function(e){var n=this.maskStack.pop();if(n&&n._target===e){if(n.enabled)switch(n.type){case t.MASK_TYPES.SCISSOR:this.renderer.scissor.pop(n);break;case t.MASK_TYPES.STENCIL:this.renderer.stencil.pop(n.maskObject);break;case t.MASK_TYPES.SPRITE:this.popSpriteMask(n);break;case t.MASK_TYPES.COLOR:this.popColorMask(n)}if(n.reset(),n.pooled&&this.maskDataPool.push(n),0!==this.maskStack.length){var r=this.maskStack[this.maskStack.length-1];r.type===t.MASK_TYPES.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}},e.prototype.detect=function(e){var n=e.maskObject;n?n.isSprite?e.type=t.MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=t.MASK_TYPES.SCISSOR:e.type=t.MASK_TYPES.STENCIL:e.type=t.MASK_TYPES.COLOR},e.prototype.pushSpriteMask=function(t){var e,n,r=t.maskObject,i=t._target,a=t._filters;a||(a=this.alphaMaskPool[this.alphaMaskIndex])||(a=this.alphaMaskPool[this.alphaMaskIndex]=[new oi]);var o,s,u=this.renderer,c=u.renderTexture;if(c.current){var l=c.current;o=t.resolution||l.resolution,s=null!==(e=t.multisample)&&void 0!==e?e:l.multisample}else o=t.resolution||u.resolution,s=null!==(n=t.multisample)&&void 0!==n?n:u.multisample;a[0].resolution=o,a[0].multisample=s,a[0].maskSprite=r;var h=i.filterArea;i.filterArea=r.getBounds(!0),u.filter.push(i,a),i.filterArea=h,t._filters||this.alphaMaskIndex++},e.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},e.prototype.pushColorMask=function(t){var e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))},e.prototype.popColorMask=function(t){var e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))},e.prototype.destroy=function(){this.renderer=null},e}(),ui=function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0}return t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==n&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null},t}(),ci=new an,li=[],hi=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=it.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,n}return Mn(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){var e;if(!t._scissorRectLocal){var n=t._scissorRect,r=t.maskObject,i=this.renderer,a=i.renderTexture,o=r.getBounds(!0,null!==(e=li.pop())&&void 0!==e?e:new Je);this.roundFrameToPixels(o,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),n&&o.fit(n),t._scissorRectLocal=o}},e.isMatrixRotated=function(t){if(!t)return!1;var e=t.a,n=t.b,r=t.c,i=t.d;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)},e.prototype.testScissor=function(t){var n=t.maskObject;if(!n.isFastRect||!n.isFastRect())return!1;if(e.isMatrixRotated(n.worldTransform))return!1;if(e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var r=t._scissorRectLocal;return r.width>0&&r.height>0},e.prototype.roundFrameToPixels=function(t,n,r,i,a){e.isMatrixRotated(a)||((a=a?ci.copyFrom(a):ci.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(a,t),t.fit(i),t.x=Math.round(t.x*n),t.y=Math.round(t.y*n),t.width=Math.round(t.width*n),t.height=Math.round(t.height*n))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var e=this.renderer.gl;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;t&&li.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t,e=this.maskStack[this.maskStack.length-1]._scissorRect;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)},e}(ui),pi=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=it.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,n}return Mn(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;var i=t._colorMask;0!==i&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==i&&(t._colorMask=i,n.colorMask(!!(1&i),!!(2&i),!!(4&i),!!(8&i))),this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{var n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,r=n?n._colorMask:15;0!==r&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==r&&(n._colorMask=r,e.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))),this._useCurrent()}},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(ui),fi=function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new an,this.transform=null}return t.prototype.update=function(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,n,r){var i=this.projectionMatrix,a=r?-1:1;i.identity(),i.a=1/e.width*2,i.d=a*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-a-e.y*i.d},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null},t}(),di=new Je,mi=new Je,gi=function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Je,this.destinationFrame=new Je,this.viewportFrame=new Je}return t.prototype.bind=function(t,e,n){void 0===t&&(t=null);var r,i,a,o=this.renderer;this.current=t,t?(a=(r=t.baseTexture).resolution,e||(di.width=t.frame.width,di.height=t.frame.height,e=di),n||(mi.x=t.frame.x,mi.y=t.frame.y,mi.width=e.width,mi.height=e.height,n=mi),i=r.framebuffer):(a=o.resolution,e||(di.width=o.screen.width,di.height=o.screen.height,e=di),n||((n=di).width=e.width,n.height=e.height));var s=this.viewportFrame;s.x=n.x*a,s.y=n.y*a,s.width=n.width*a,s.height=n.height*a,t||(s.y=o.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(i,s),this.renderer.projection.update(n,e,a,!i),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var n=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer.screen,i=n.width!==r.width||n.height!==r.height;if(i){var a=this.viewportFrame,o=a.x,s=a.y,u=a.width,c=a.height;o=Math.round(o),s=Math.round(s),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,s,u,c)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),i&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t.prototype.destroy=function(){this.renderer=null},t}();function vi(t,e,n,r,i){n.buffer.update(i)}var yi={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},bi={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function xi(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),n=0,r=0,i=0,a=0;a<e.length;a++){var o=e[a];if(n=bi[o.data.type],o.data.size>1&&(n=Math.max(n,16)*o.data.size),o.dataLen=n,r%n!=0&&r<16){var s=r%n%16;r+=s,i+=s}r+n>16?(i=16*Math.ceil(i/16),o.offset=i,i+=n,r=n):(o.offset=i,r+=n,i+=n)}return{uboElements:e,size:i=16*Math.ceil(i/16)}}function wi(t,e){var n=[];for(var r in t)e[r]&&n.push(e[r]);return n.sort((function(t,e){return t.index-e.index})),n}function _i(t,e){if(!t.autoManage)return{size:0,syncFunc:vi};for(var n=xi(wi(t.uniforms,e)),r=n.uboElements,i=n.size,a=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],o=0;o<r.length;o++){for(var s=r[o],u=t.uniforms[s.data.name],c=s.data.name,l=!1,h=0;h<Hr.length;h++){var p=Hr[h];if(p.codeUbo&&p.test(s.data,u)){a.push("offset = "+s.offset/4+";",Hr[h].codeUbo(s.data.name,u)),l=!0;break}}if(!l)if(s.data.size>1){var f=Gr(s.data.type),d=Math.max(bi[s.data.type]/16,1),m=f/d,g=(4-m%4)%4;a.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+s.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+s.data.size*d+"; i++)\n                {\n                    for(var j = 0; j < "+m+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+g+";\n                }\n\n                ")}else{var v=yi[s.data.type];a.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+s.offset/4+";\n                "+v+";\n                ")}}return a.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join("\n"))}}var Si=function(){},Ti=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},t}();function Ei(t,e){var n=Rr(t,t.VERTEX_SHADER,e.vertexSrc),r=Rr(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();if(t.attachShader(i,n),t.attachShader(i,r),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||function(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||Or(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||Or(t,r),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,i,n,r),e.attributeData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=e.getActiveAttrib(t,i);if(0!==a.name.indexOf("gl_")){var o=jr(e,a.type),s={type:o,name:a.name,size:Gr(o),location:e.getAttribLocation(t,a.name)};n[a.name]=s}}return n}(i,t),e.uniformData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;i++){var a=e.getActiveUniform(t,i),o=a.name.replace(/\[.*?\]$/,""),s=!!a.name.match(/\[.*?\]$/),u=jr(e,a.type);n[o]={name:o,index:i,type:u,size:a.size,isArray:s,value:Mr(u,a.size)}}return n}(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var a=Object.keys(e.attributeData);a.sort((function(t,e){return t>e?1:-1}));for(var o=0;o<a.length;o++)e.attributeData[a[o]].location=o,t.bindAttribLocation(i,o,a[o]);t.linkProgram(i)}t.deleteShader(n),t.deleteShader(r);var s={};for(var o in e.uniformData){var u=e.uniformData[o];s[o]={location:t.getUniformLocation(i,o),value:Mr(u.type,u.size)}}return new Ti(i,s)}var ki=0,Ii={textureCount:0,uboCount:0},Ai=function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=ki++}return t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Kr)return Kr;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Kr=!0===t({a:"b"},"a","b")}catch(t){Kr=!1}return Kr}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},t.prototype.bind=function(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(Ii.textureCount=0,Ii.uboCount=0,this.syncUniformGroup(t.uniformGroup,Ii)),r},t.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t,e){var n=this.getGlProgram();t.static&&t.dirtyId===n.uniformDirtyGroups[t.id]||(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},t.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n,r=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var i in t.uniforms){var a=e[i];if(a){for(var o=t.uniforms[i],s=!1,u=0;u<Hr.length;u++)if(Hr[u].test(a,o)){r.push(Hr[u].code(i,o)),s=!0;break}if(!s){var c=(1!==a.size||a.isArray?qr:Xr)[a.type].replace("location",'ud["'+i+'"].location');r.push('\n            cu = ud["'+i+'"];\n            cv = cu.value;\n            v = uv["'+i+'"];\n            '+c+";")}}else(null===(n=t.uniforms[i])||void 0===n?void 0:n.group)&&(t.uniforms[i].ubo?r.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+i+", '"+i+"');\n                    "):r.push("\n                        renderer.shader.syncUniformGroup(uv."+i+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},t.prototype.syncUniformBufferGroup=function(t,e){var n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;var r=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),r(n.uniformData,t.uniforms,this.renderer,Ii,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])},t.prototype.createSyncBufferGroup=function(t,e,n){var r=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var i=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;var a=this.getSignature(t,this.shader.program.uniformData,"ubo"),o=this._uboCache[a];if(o||(o=this._uboCache[a]=_i(t,this.shader.program.uniformData)),t.autoManage){var s=new Float32Array(o.size/4);t.buffer.update(s)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]},t.prototype.getSignature=function(t,e,n){var r=t.uniforms,i=[n+"-"];for(var a in r)i.push(a),e[a]&&i.push(e[a].type);return i.join("-")},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateProgram=function(t){var e=this.gl,n=t.program,r=Ei(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.disposeShader=function(t){this.shader===t&&(this.shader=null)},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},t}();var Ni=function(){function e(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=t.BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new ni,this.defaultState.blend=!0}return e.prototype.contextChange=function(e){this.gl=e,this.blendModes=function(e,n){return void 0===n&&(n=[]),n[t.BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.ADD]=[e.ONE,e.ONE],n[t.BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.NONE]=[0,0],n[t.BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],n[t.BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.SRC_IN]=[e.DST_ALPHA,e.ZERO],n[t.BLEND_MODES.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],n[t.BLEND_MODES.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],n[t.BLEND_MODES.DST_IN]=[e.ZERO,e.SRC_ALPHA],n[t.BLEND_MODES.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],n[t.BLEND_MODES.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],n[t.BLEND_MODES.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],n}(e),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(n=0;n<this.checks.length;n++)this.checks[n](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setDepthMask=function(t){this.gl.depthMask(t)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},e.prototype.destroy=function(){this.gl=null},e}(),Ci=function(){function e(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=it.GC_MAX_IDLE,this.checkCountMax=it.GC_MAX_CHECK_COUNT,this.mode=it.GC_MODE}return e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==t.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,r=0;r<e.length;r++){var i=e[r];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,n=!0)}if(n){var a=0;for(r=0;r<e.length;r++)null!==e[r]&&(e[a++]=e[r]);e.length=a}},e.prototype.unload=function(t){var e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e.prototype.destroy=function(){this.renderer=null},e}();var Ri=function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=t.TYPES.UNSIGNED_BYTE,this.internalFormat=t.FORMATS.RGBA,this.samplerType=0},Oi=function(){function e(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new zn,this.hasIntegerTextures=!1}return e.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(e){var n,r,i,a,o,s,u,c,l,h,p,f,d,m,g,v,y,b,x,w,_,S,T;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?((n={})[t.TYPES.UNSIGNED_BYTE]=((r={})[t.FORMATS.RGBA]=e.RGBA8,r[t.FORMATS.RGB]=e.RGB8,r[t.FORMATS.RG]=e.RG8,r[t.FORMATS.RED]=e.R8,r[t.FORMATS.RGBA_INTEGER]=e.RGBA8UI,r[t.FORMATS.RGB_INTEGER]=e.RGB8UI,r[t.FORMATS.RG_INTEGER]=e.RG8UI,r[t.FORMATS.RED_INTEGER]=e.R8UI,r[t.FORMATS.ALPHA]=e.ALPHA,r[t.FORMATS.LUMINANCE]=e.LUMINANCE,r[t.FORMATS.LUMINANCE_ALPHA]=e.LUMINANCE_ALPHA,r),n[t.TYPES.BYTE]=((i={})[t.FORMATS.RGBA]=e.RGBA8_SNORM,i[t.FORMATS.RGB]=e.RGB8_SNORM,i[t.FORMATS.RG]=e.RG8_SNORM,i[t.FORMATS.RED]=e.R8_SNORM,i[t.FORMATS.RGBA_INTEGER]=e.RGBA8I,i[t.FORMATS.RGB_INTEGER]=e.RGB8I,i[t.FORMATS.RG_INTEGER]=e.RG8I,i[t.FORMATS.RED_INTEGER]=e.R8I,i),n[t.TYPES.UNSIGNED_SHORT]=((a={})[t.FORMATS.RGBA_INTEGER]=e.RGBA16UI,a[t.FORMATS.RGB_INTEGER]=e.RGB16UI,a[t.FORMATS.RG_INTEGER]=e.RG16UI,a[t.FORMATS.RED_INTEGER]=e.R16UI,a[t.FORMATS.DEPTH_COMPONENT]=e.DEPTH_COMPONENT16,a),n[t.TYPES.SHORT]=((o={})[t.FORMATS.RGBA_INTEGER]=e.RGBA16I,o[t.FORMATS.RGB_INTEGER]=e.RGB16I,o[t.FORMATS.RG_INTEGER]=e.RG16I,o[t.FORMATS.RED_INTEGER]=e.R16I,o),n[t.TYPES.UNSIGNED_INT]=((s={})[t.FORMATS.RGBA_INTEGER]=e.RGBA32UI,s[t.FORMATS.RGB_INTEGER]=e.RGB32UI,s[t.FORMATS.RG_INTEGER]=e.RG32UI,s[t.FORMATS.RED_INTEGER]=e.R32UI,s[t.FORMATS.DEPTH_COMPONENT]=e.DEPTH_COMPONENT24,s),n[t.TYPES.INT]=((u={})[t.FORMATS.RGBA_INTEGER]=e.RGBA32I,u[t.FORMATS.RGB_INTEGER]=e.RGB32I,u[t.FORMATS.RG_INTEGER]=e.RG32I,u[t.FORMATS.RED_INTEGER]=e.R32I,u),n[t.TYPES.FLOAT]=((c={})[t.FORMATS.RGBA]=e.RGBA32F,c[t.FORMATS.RGB]=e.RGB32F,c[t.FORMATS.RG]=e.RG32F,c[t.FORMATS.RED]=e.R32F,c[t.FORMATS.DEPTH_COMPONENT]=e.DEPTH_COMPONENT32F,c),n[t.TYPES.HALF_FLOAT]=((l={})[t.FORMATS.RGBA]=e.RGBA16F,l[t.FORMATS.RGB]=e.RGB16F,l[t.FORMATS.RG]=e.RG16F,l[t.FORMATS.RED]=e.R16F,l),n[t.TYPES.UNSIGNED_SHORT_5_6_5]=((h={})[t.FORMATS.RGB]=e.RGB565,h),n[t.TYPES.UNSIGNED_SHORT_4_4_4_4]=((p={})[t.FORMATS.RGBA]=e.RGBA4,p),n[t.TYPES.UNSIGNED_SHORT_5_5_5_1]=((f={})[t.FORMATS.RGBA]=e.RGB5_A1,f),n[t.TYPES.UNSIGNED_INT_2_10_10_10_REV]=((d={})[t.FORMATS.RGBA]=e.RGB10_A2,d[t.FORMATS.RGBA_INTEGER]=e.RGB10_A2UI,d),n[t.TYPES.UNSIGNED_INT_10F_11F_11F_REV]=((m={})[t.FORMATS.RGB]=e.R11F_G11F_B10F,m),n[t.TYPES.UNSIGNED_INT_5_9_9_9_REV]=((g={})[t.FORMATS.RGB]=e.RGB9_E5,g),n[t.TYPES.UNSIGNED_INT_24_8]=((v={})[t.FORMATS.DEPTH_STENCIL]=e.DEPTH24_STENCIL8,v),n[t.TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]=((y={})[t.FORMATS.DEPTH_STENCIL]=e.DEPTH32F_STENCIL8,y),T=n):((b={})[t.TYPES.UNSIGNED_BYTE]=((x={})[t.FORMATS.RGBA]=e.RGBA,x[t.FORMATS.RGB]=e.RGB,x[t.FORMATS.ALPHA]=e.ALPHA,x[t.FORMATS.LUMINANCE]=e.LUMINANCE,x[t.FORMATS.LUMINANCE_ALPHA]=e.LUMINANCE_ALPHA,x),b[t.TYPES.UNSIGNED_SHORT_5_6_5]=((w={})[t.FORMATS.RGB]=e.RGB,w),b[t.TYPES.UNSIGNED_SHORT_4_4_4_4]=((_={})[t.FORMATS.RGBA]=e.RGBA,_),b[t.TYPES.UNSIGNED_SHORT_5_5_5_1]=((S={})[t.FORMATS.RGBA]=e.RGBA,S),T=b),T}(e);var n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=n;for(var r=0;r<n;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new Ri(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Ri(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if((t=null==t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(r=0;r<n.length;r++)n[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[r]=null)},e.prototype.ensureSamplerType=function(e){var n=this,r=n.boundTextures,i=n.hasIntegerTextures,a=n.CONTEXT_UID;if(i)for(var o=e-1;o>=0;--o){var s=r[o];if(s)s._glTextures[a].samplerType!==t.SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(s)}},e.prototype.initTexture=function(t){var e=new Ri(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(e,n){var r,i;n.internalFormat=null!==(i=null===(r=this.internalFormats[e.type])||void 0===r?void 0:r[e.format])&&void 0!==i?i:e.format,2===this.webGLVersion&&e.type===t.TYPES.HALF_FLOAT?n.type=this.gl.HALF_FLOAT:n.type=e.type},e.prototype.updateTexture=function(e){var n=e._glTextures[this.CONTEXT_UID];if(n){var r=this.renderer;if(this.initTextureType(e,n),e.resource&&e.resource.upload(r,e,n))n.samplerType!==t.SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{var i=e.realWidth,a=e.realHeight,o=r.gl;(n.width!==i||n.height!==a||n.dirtyId<0)&&(n.width=i,n.height=a,o.texImage2D(e.target,0,n.internalFormat,i,a,0,e.format,n.type,null))}e.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(e),n.dirtyId=e.dirtyId}},e.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&Ce(this.managedTextures,r,1)}},e.prototype.updateTextureStyle=function(e){var n=e._glTextures[this.CONTEXT_UID];n&&(e.mipmap!==t.MIPMAP_MODES.POW2&&2===this.webGLVersion||e.isPowerOfTwo?n.mipmap=e.mipmap>=1:n.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?n.wrapMode=e.wrapMode:n.wrapMode=t.WRAP_MODES.CLAMP,e.resource&&e.resource.style(this.renderer,e,n)||this.setStyle(e,n),n.dirtyStyleId=e.dirtyStyleId)},e.prototype.setStyle=function(e,n){var r=this.gl;if(n.mipmap&&e.mipmap!==t.MIPMAP_MODES.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,n.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,n.wrapMode),n.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===t.SCALE_MODES.LINEAR){var a=Math.min(e.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,a)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?r.LINEAR:r.NEAREST)},e.prototype.destroy=function(){this.renderer=null},e}(),Di={__proto__:null,FilterSystem:xr,BatchSystem:_r,ContextSystem:Tr,FramebufferSystem:Ir,GeometrySystem:Nr,MaskSystem:si,ScissorSystem:hi,StencilSystem:pi,ProjectionSystem:fi,RenderTextureSystem:gi,ShaderSystem:Ai,StateSystem:Ni,TextureGCSystem:Ci,TextureSystem:Oi},Mi=new an,Fi=function(e){function n(n,r){void 0===n&&(n=t.RENDERER_TYPE.UNKNOWN);var i=e.call(this)||this;return r=Object.assign({},it.RENDER_OPTIONS,r),i.options=r,i.type=n,i.screen=new Je(0,0,r.width,r.height),i.view=r.view||it.ADAPTER.createCanvas(),i.resolution=r.resolution||it.RESOLUTION,i.useContextAlpha=r.useContextAlpha,i.autoDensity=!!r.autoDensity,i.preserveDrawingBuffer=r.preserveDrawingBuffer,i.clearBeforeRender=r.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=r.backgroundColor||i._backgroundColor,i.backgroundAlpha=r.backgroundAlpha,void 0!==r.transparent&&(Fe("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=r.transparent,i.backgroundAlpha=r.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return Mn(n,e),n.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(n.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),n.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var n=this.view.width/this.resolution,r=this.view.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.view.style.width=n+"px",this.view.style.height=r+"px"),this.emit("resize",n,r)},n.prototype.generateTexture=function(t,e,n,r){void 0===e&&(e={}),"number"==typeof e&&(Fe("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:n,region:r});var i=e.region,a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["region"]);0===(r=i||t.getLocalBounds(null,!0)).width&&(r.width=1),0===r.height&&(r.height=1);var o=rr.create(Fn({width:r.width,height:r.height},a));return Mi.tx=-r.x,Mi.ty=-r.y,this.render(t,{renderTexture:o,clear:!1,transform:Mi,skipUpdateTransform:!!t.parent}),o},n.prototype.destroy=function(e){for(var n in this.plugins)this.plugins[n].destroy(),this.plugins[n]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=t.RENDERER_TYPE.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=ve(t),ge(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),n}(st),Pi=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},Li=function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return t.prototype.destroy=function(){this.renderer=null},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},t.prototype.bind=function(t){var e=this.gl,n=this.CONTEXT_UID,r=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)},t.prototype.bindBufferBase=function(t,e){var n=this.gl,r=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var i=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,i.buffer)}},t.prototype.bindBufferRange=function(t,e,n){var r=this.gl,i=this.CONTEXT_UID;n=n||0;var a=t._glBuffers[i]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,a.buffer,256*n,256)},t.prototype.update=function(t){var e=this.gl,n=this.CONTEXT_UID,r=t._glBuffers[n];if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var i=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,i)}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,n=this.gl;return t._glBuffers[e]=new Pi(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]},t}(),Bi=function(e){function n(r){var i=e.call(this,t.RENDERER_TYPE.WEBGL,r)||this;return r=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new In("destroy"),contextChange:new In("contextChange"),reset:new In("reset"),update:new In("update"),postrender:new In("postrender"),prerender:new In("prerender"),resize:new In("resize")},i.runners.contextChange.add(i),i.globalUniforms=new gr({projectionMatrix:new an},!0),i.addSystem(si,"mask").addSystem(Tr,"context").addSystem(Ni,"state").addSystem(Ai,"shader").addSystem(Oi,"texture").addSystem(Li,"buffer").addSystem(Nr,"geometry").addSystem(Ir,"framebuffer").addSystem(hi,"scissor").addSystem(pi,"stencil").addSystem(fi,"projection").addSystem(Ci,"textureGC").addSystem(xr,"filter").addSystem(gi,"renderTexture").addSystem(_r,"batch"),i.initPlugins(n.__plugins),i.multisample=void 0,r.context?i.context.initFromContext(r.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:r.antialias,premultipliedAlpha:i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,fe(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return Mn(n,e),n.create=function(t){if(de())return new n(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},n.prototype.contextChange=function(){var e,n=this.gl;if(1===this.context.webGLVersion){var r=n.getParameter(n.FRAMEBUFFER_BINDING);n.bindFramebuffer(n.FRAMEBUFFER,null),e=n.getParameter(n.SAMPLES),n.bindFramebuffer(n.FRAMEBUFFER,r)}else{r=n.getParameter(n.DRAW_FRAMEBUFFER_BINDING);n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),e=n.getParameter(n.SAMPLES),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,r)}e>=t.MSAA_QUALITY.HIGH?this.multisample=t.MSAA_QUALITY.HIGH:e>=t.MSAA_QUALITY.MEDIUM?this.multisample=t.MSAA_QUALITY.MEDIUM:e>=t.MSAA_QUALITY.LOW?this.multisample=t.MSAA_QUALITY.LOW:this.multisample=t.MSAA_QUALITY.NONE},n.prototype.addSystem=function(t,e){var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=n,this.runners)this.runners[r].add(n);return this},n.prototype.render=function(t,e){var n,r,i,a;if(e&&(e instanceof rr?(Fe("6.0.0","Renderer#render arguments changed, use options instead."),n=e,r=arguments[2],i=arguments[3],a=arguments[4]):(n=e.renderTexture,r=e.clear,i=e.transform,a=e.skipUpdateTransform)),this.renderingToScreen=!n,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(n||(this._lastObjectRendered=t),!a){var o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}this.renderTexture.bind(n),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),n&&n.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},n.prototype.generateTexture=function(t,n,r,i){void 0===n&&(n={});var a=e.prototype.generateTexture.call(this,t,n,r,i);return this.framebuffer.blit(),a},n.prototype.resize=function(t,n){e.prototype.resize.call(this,t,n),this.runners.resize.emit(this.screen.height,this.screen.width)},n.prototype.reset=function(){return this.runners.reset.emit(),this},n.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},n.prototype.destroy=function(t){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();e.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(n.prototype,"extract",{get:function(){return Fe("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),n.registerPlugin=function(e,n){Fe("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),kn.add({name:e,type:t.ExtensionType.RendererPlugin,ref:n})},n.__plugins={},n}(Fi);function zi(t){return Bi.create(t)}kn.handleByMap(t.ExtensionType.RendererPlugin,Bi.__plugins);var Ui="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",Gi="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Wi=function(){function t(t){Fe("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=t}return t.prototype.destroy=function(){this.renderer=null},t}(),Vi=function(){this.texArray=null,this.blend=0,this.type=t.DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null},ji=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),Hi=function(){function t(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),Xi=function(e){function n(t){var n=e.call(this,t)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=ni.for2d(),n.size=4*it.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),t.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return Mn(n,e),n.prototype.contextChange=function(){var e=this.renderer.gl;it.PREFER_ENV===t.ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),it.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=$r(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var n=0;n<this._packedGeometryPoolSize;n++)this._packedGeometries[n]=new this.geometryClass;this.initFlushBuffers()},n.prototype.initFlushBuffers=function(){for(var t=n._drawCallPool,e=n._textureArrayPool,r=this.size/4,i=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new Vi);for(;e.length<i;)e.push(new ji);for(var a=0;a<this.MAX_TEXTURES;a++)this._tempBoundTextures[a]=null},n.prototype.onPrerender=function(){this._flushId=0},n.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},n.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,r=n._textureArrayPool,i=this.renderer.batch,a=this._tempBoundTextures,o=this.renderer.textureGC.count,s=++zn._globalBatch,u=0,c=r[0],l=0;i.copyBoundTextures(a,e);for(var h=0;h<this._bufferSize;++h){var p=t[h];t[h]=null,p._batchEnabled!==s&&(c.count>=e&&(i.boundArray(c,a,s,e),this.buildDrawCalls(c,l,h),l=h,c=r[++u],++s),p._batchEnabled=s,p.touched=o,c.elements[c.count++]=p)}c.count>0&&(i.boundArray(c,a,s,e),this.buildDrawCalls(c,l,this._bufferSize),++u,++s);for(h=0;h<a.length;h++)a[h]=null;zn._globalBatch=s},n.prototype.buildDrawCalls=function(t,e,r){var i=this,a=i._bufferedElements,o=i._attributeBuffer,s=i._indexBuffer,u=i.vertexSize,c=n._drawCallPool,l=this._dcIndex,h=this._aIndex,p=this._iIndex,f=c[l];f.start=this._iIndex,f.texArray=t;for(var d=e;d<r;++d){var m=a[d],g=m._texture.baseTexture,v=be[g.alphaMode?1:0][m.blendMode];a[d]=null,e<d&&f.blend!==v&&(f.size=p-f.start,e=d,(f=c[++l]).texArray=t,f.start=p),this.packInterleavedGeometry(m,o,s,h,p),h+=m.vertexData.length/2*u,p+=m.indices.length,f.blend=v}e<r&&(f.size=p-f.start,++l),this._dcIndex=l,this._aIndex=h,this._iIndex=p},n.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},n.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,n=t._attributeBuffer,r=t._indexBuffer;it.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},n.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,r=e.gl,i=e.state,a=n._drawCallPool,o=null,s=0;s<t;s++){var u=a[s],c=u.texArray,l=u.type,h=u.size,p=u.start,f=u.blend;o!==c&&(o=c,this.bindAndClearTexArray(c)),this.state.blendMode=f,i.set(this.state),r.drawElements(l,h,r.UNSIGNED_SHORT,2*p)}},n.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},n.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),it.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},n.prototype.stop=function(){this.flush()},n.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},n.prototype.getAttributeBuffer=function(t){var e=Ie(Math.ceil(t/8)),n=Ne(e),r=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new Hi(r*this.vertexSize*4)),i},n.prototype.getIndexBuffer=function(t){var e=Ie(Math.ceil(t/12)),n=Ne(e),r=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i},n.prototype.packInterleavedGeometry=function(t,e,n,r,i){for(var a=e.uint32View,o=e.float32View,s=r/this.vertexSize,u=t.uvs,c=t.indices,l=t.vertexData,h=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),f=p<1&&t._texture.baseTexture.alphaMode?_e(t._tintRGB,p):t._tintRGB+(255*p<<24),d=0;d<l.length;d+=2)o[r++]=l[d],o[r++]=l[d+1],o[r++]=u[d],o[r++]=u[d+1],a[r++]=f,o[r++]=h;for(d=0;d<c.length;d++)n[i++]=s+c[d]},n._drawCallPool=[],n._textureArrayPool=[],n}(wr),qi=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=gr.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ti(this.vertexSrc,r)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new an,default:this.defaultGroupCache[t]};return new ei(this.programCache[t],i)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),Ki=function(e){function n(n){void 0===n&&(n=!1);var r=e.call(this)||this;return r._buffer=new sr(null,n,!1),r._indexBuffer=new sr(null,n,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,t.TYPES.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,t.TYPES.FLOAT).addAttribute("aColor",r._buffer,4,!0,t.TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,t.TYPES.FLOAT).addIndex(r._indexBuffer),r}return Mn(n,e),n}(pr),Yi="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Zi="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",$i=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:Yi,fragment:Zi,geometryClass:Ki,vertexSize:6},t),n=e.vertex,r=e.fragment,i=e.vertexSize,a=e.geometryClass;return function(t){function e(e){var o=t.call(this,e)||this;return o.shaderGenerator=new qi(n,r),o.geometryClass=a,o.vertexSize=i,o}return Mn(e,t),e}(Xi)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return Yi},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return Zi},enumerable:!1,configurable:!0}),t}(),Ji=$i.create();Object.assign(Ji,{extension:{name:"batch",type:t.ExtensionType.RendererPlugin}});var Qi={},ta=function(t){Object.defineProperty(Qi,t,{get:function(){return Fe("6.0.0","PIXI.systems."+t+" has moved to PIXI."+t),Yn[t]}})};for(var ea in Yn)ta(ea);var na={},ra=function(t){Object.defineProperty(na,t,{get:function(){return Fe("6.0.0","PIXI.resources."+t+" has moved to PIXI."+t),Di[t]}})};for(var ea in Di)ra(ea);var ia={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};yn.mixin(ia);var aa=100,oa=function(){function e(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(rt.tablet||rt.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width=aa+"px",e.style.height=aa+"px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),e.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},e.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},e.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div))},e.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div))},e.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},e.prototype.update=function(){var t=performance.now();if(!(rt.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,r=e.top,i=e.width,a=e.height,o=this.renderer,s=o.width,u=o.height,c=o.resolution,l=i/s*c,h=a/u*c,p=this.div;p.style.left=n+"px",p.style.top=r+"px",p.style.width=s+"px",p.style.height=u+"px";for(var f=0;f<this.children.length;f++){var d=this.children[f];if(d.renderId!==this.renderId)d._accessibleActive=!1,Ce(this.children,f,1),this.div.removeChild(d._accessibleDiv),this.pool.push(d._accessibleDiv),d._accessibleDiv=null,f--;else{p=d._accessibleDiv;var m=d.hitArea,g=d.worldTransform;d.hitArea?(p.style.left=(g.tx+m.x*g.a)*l+"px",p.style.top=(g.ty+m.y*g.d)*h+"px",p.style.width=m.width*g.a*l+"px",p.style.height=m.height*g.d*h+"px"):(m=d.getBounds(),this.capHitArea(m),p.style.left=m.x*l+"px",p.style.top=m.y*h+"px",p.style.width=m.width*l+"px",p.style.height=m.height*h+"px",p.title!==d.accessibleTitle&&null!==d.accessibleTitle&&(p.title=d.accessibleTitle),p.getAttribute("aria-label")!==d.accessibleHint&&null!==d.accessibleHint&&p.setAttribute("aria-label",d.accessibleHint)),d.accessibleTitle===p.title&&d.tabIndex===p.tabIndex||(p.title=d.accessibleTitle,p.tabIndex=d.tabIndex,this.debug&&this.updateDebugHTML(p))}}this.renderId++}},e.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},e.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,r=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>r&&(t.height=r-t.y)},e.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width=aa+"px",e.style.height=aa+"px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},e.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"click",r),e.dispatchEvent(n,"pointertap",r),e.dispatchEvent(n,"tap",r)},e.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseover",r)},e.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseout",r)},e.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},e.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},e.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e.extension={name:"accessibility",type:[t.ExtensionType.RendererPlugin,t.ExtensionType.CanvasRendererPlugin]},e}(),sa=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ze,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),ua=function(t,e){return ua=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ua(t,e)};var ca=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),la=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return!!(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return!!(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return!!(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),ha=function(){function t(){this._tempPoint=new Ze}return t.prototype.recursiveFindHit=function(t,e,n,r,i){var a;if(!e||!e.visible)return!1;var o=t.data.global,s=!1,u=i=e.interactive||i,c=!0;if(e.hitArea)r&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(r=!1,c=!1)),u=!1;else if(e._mask&&r){var l=e._mask.isMaskData?e._mask.maskObject:e._mask;l&&!(null===(a=l.containsPoint)||void 0===a?void 0:a.call(l,o))&&(r=!1)}if(c&&e.interactiveChildren&&e.children)for(var h=e.children,p=h.length-1;p>=0;p--){var f=h[p],d=this.recursiveFindHit(t,f,n,r,u);if(d){if(!f.parent)continue;u=!1,d&&(t.target&&(r=!1),s=!0)}}return i&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),n&&n(t,e,!!s))),s},t.prototype.findHit=function(t,e,n,r){this.recursiveFindHit(t,e,n,r,!1)},t}(),pa={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};yn.mixin(pa);var fa={target:null,data:{global:null}},da=function(e){function n(t,n){var r=e.call(this)||this;return n=n||{},r.renderer=t,r.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,r.interactionFrequency=n.interactionFrequency||10,r.mouse=new sa,r.mouse.identifier=1,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[1]=r.mouse,r.interactionDataPool=[],r.eventData=new ca,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!("PointerEvent"in globalThis),r.supportsTouchEvents="ontouchstart"in globalThis,r.supportsPointerEvents=!!globalThis.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new ha,r._tempDisplayObject=new bn,r._eventListenerOptions={capture:!0,passive:!1},r._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return function(t,e){function n(){this.constructor=t}ua(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,e),Object.defineProperty(n.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),n.prototype.hitTest=function(t,e){return fa.target=null,fa.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(fa,e,null,!0),fa.target},n.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},n.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Nn.system.add(this.tickerUpdate,this,t.UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)},n.prototype.removeTickerListener=function(){this.tickerAdded&&(Nn.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},n.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},n.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},n.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},n.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},n.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.interactionDOMElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},n.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},n.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},n.prototype.mapPositionToPoint=function(t,e,n){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var i=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*i,t.y=(n-r.top)*(this.interactionDOMElement.height/r.height)*i},n.prototype.processInteractive=function(t,e,n,r){var i=this.search.findHit(t,e,n,r),a=this.delayedEvents;if(!a.length)return i;t.stopPropagationHint=!1;var o=a.length;this.delayedEvents=[];for(var s=0;s<o;s++){var u=a[s],c=u.displayObject,l=u.eventString,h=u.eventData;h.stopsPropagatingAt===c&&(h.stopPropagationHint=!0),this.dispatchEvent(c,l,h)}return i},n.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,r=0;r<n;r++){var i=e[r],a=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,a);if(o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===i.pointerType)this.emit("touchstart",o);else if("mouse"===i.pointerType||"pen"===i.pointerType){var s=2===i.button;this.emit(s?"rightdown":"mousedown",this.eventData)}}}},n.prototype.processPointerDown=function(t,e,n){var r=t.data,i=t.data.identifier;if(n)if(e.trackedPointers[i]||(e.trackedPointers[i]=new la(i)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var a=2===r.button;a?e.trackedPointers[i].rightDown=!0:e.trackedPointers[i].leftDown=!0,this.dispatchEvent(e,a?"rightdown":"mousedown",t)}},n.prototype.onPointerComplete=function(t,e,n){var r=this.normalizeToPointerData(t),i=r.length,a=t.target;t.composedPath&&t.composedPath().length>0&&(a=t.composedPath()[0]);for(var o=a!==this.interactionDOMElement?"outside":"",s=0;s<i;s++){var u=r[s],c=this.getInteractionDataForPointerId(u),l=this.configureInteractionEventForDOMEvent(this.eventData,u,c);if(l.data.originalEvent=t,this.processInteractive(l,this.lastObjectRendered,n,e||!o),this.emit(e?"pointercancel":"pointerup"+o,l),"mouse"===u.pointerType||"pen"===u.pointerType){var h=2===u.button;this.emit(h?"rightup"+o:"mouseup"+o,l)}else"touch"===u.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,l),this.releaseInteractionDataForPointerId(u.pointerId))}},n.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},n.prototype.processPointerCancel=function(t,e){var n=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},n.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},n.prototype.processPointerUp=function(t,e,n){var r=t.data,i=t.data.identifier,a=e.trackedPointers[i],o="touch"===r.pointerType,s="mouse"===r.pointerType||"pen"===r.pointerType,u=!1;if(s){var c=2===r.button,l=la.FLAGS,h=c?l.RIGHT_DOWN:l.LEFT_DOWN,p=void 0!==a&&a.flags&h;n?(this.dispatchEvent(e,c?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,c?"rightclick":"click",t),u=!0)):p&&this.dispatchEvent(e,c?"rightupoutside":"mouseupoutside",t),a&&(c?a.rightDown=!1:a.leftDown=!1)}n?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),a&&(s&&!u||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),a.over=!1))):a&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),a&&a.none&&delete e.trackedPointers[i]},n.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var n=e.length,r=0;r<n;r++){var i=e[r],a=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,a);o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===i.pointerType&&this.emit("touchmove",o),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},n.prototype.processPointerMove=function(t,e,n){var r=t.data,i="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType;a&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),i&&this.dispatchEvent(e,"touchmove",t),a&&this.dispatchEvent(e,"mousemove",t))},n.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,n);r.data.originalEvent=e,this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(n.identifier)}},n.prototype.processPointerOverOut=function(t,e,n){var r=t.data,i=t.data.identifier,a="mouse"===r.pointerType||"pen"===r.pointerType,o=e.trackedPointers[i];n&&!o&&(o=e.trackedPointers[i]=new la(i)),void 0!==o&&(n&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),a&&this.delayDispatchEvent(e,"mouseover",t)),a&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),a&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[i]))},n.prototype.onPointerOver=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,n);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)}},n.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new sa).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},n.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},n.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},n.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,r=t.changedTouches.length;n<r;n++){var i=t.changedTouches[n];void 0===i.button&&(i.button=t.touches.length?1:0),void 0===i.buttons&&(i.buttons=t.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,e.push(i)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{var a=t;void 0===a.isPrimary&&(a.isPrimary=!0),void 0===a.width&&(a.width=1),void 0===a.height&&(a.height=1),void 0===a.tiltX&&(a.tiltX=0),void 0===a.tiltY&&(a.tiltY=0),void 0===a.pointerType&&(a.pointerType="mouse"),void 0===a.pointerId&&(a.pointerId=1),void 0===a.pressure&&(a.pressure=.5),void 0===a.twist&&(a.twist=0),void 0===a.tangentialPressure&&(a.tangentialPressure=0),a.isNormalized=!0,e.push(a)}return e},n.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},n.extension={name:"interaction",type:[t.ExtensionType.RendererPlugin,t.ExtensionType.CanvasRendererPlugin]},n}(st),ma=new Je,ga=function(){function e(t){this.renderer=t}return e.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},e.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},e.prototype.canvas=function(t,n){var r=this._rawPixels(t,n),i=r.pixels,a=r.width,o=r.height,s=r.flipY,u=new ze(a,o,1),c=u.context.getImageData(0,0,a,o);if(e.arrayPostDivide(i,c.data),u.context.putImageData(c,0,0),s){var l=new ze(u.width,u.height,1);l.context.scale(1,-1),l.context.drawImage(u.canvas,0,-o),u.destroy(),u=l}return u.canvas},e.prototype.pixels=function(t,n){var r=this._rawPixels(t,n).pixels;return e.arrayPostDivide(r,r),r},e.prototype._rawPixels=function(e,n){var r,i,a=this.renderer,o=!1,s=!1;if(e)if(e instanceof rr)i=e;else{var u=a.context.webGLVersion>=2?a.multisample:t.MSAA_QUALITY.NONE;if(i=this.renderer.generateTexture(e,{multisample:u}),u!==t.MSAA_QUALITY.NONE){var c=rr.create({width:i.width,height:i.height});a.framebuffer.bind(i.framebuffer),a.framebuffer.blit(c.framebuffer),a.framebuffer.bind(null),i.destroy(!0),i=c}s=!0}i?(r=i.baseTexture.resolution,n=null!=n?n:i.frame,o=!1,a.renderTexture.bind(i)):(r=a.resolution,n||((n=ma).width=a.width,n.height=a.height),o=!0,a.renderTexture.bind(null));var l=Math.round(n.width*r),h=Math.round(n.height*r),p=new Uint8Array(4*l*h),f=a.gl;return f.readPixels(Math.round(n.x*r),Math.round(n.y*r),l,h,f.RGBA,f.UNSIGNED_BYTE,p),s&&i.destroy(!0),{pixels:p,width:l,height:h,flipY:o}},e.prototype.destroy=function(){this.renderer=null},e.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];0!==r?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},e.extension={name:"extract",type:t.ExtensionType.RendererPlugin},e}(),va=function(){function t(t,e,n){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null}return t.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},t}();function ya(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var ba,xa=function(){function t(){this._head=this._tail=void 0}return t.prototype.handlers=function(t){void 0===t&&(t=!1);var e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n},t.prototype.has=function(t){if(!(t instanceof va))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},t.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,e),r=r._next;return!0},t.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return ya(this,new va(t,!1,e))},t.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return ya(this,new va(t,!0,e))},t.prototype.detach=function(t){if(!(t instanceof va))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},t.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},t}();function wa(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=n.parser[e.strictMode?"strict":"loose"].exec(t),i={},a=14;a--;)i[n.key[a]]=r[a]||"";return i[n.q.name]={},i[n.key[12]].replace(n.q.parser,(function(t,e,r){e&&(i[n.q.name][e]=r)})),i}var _a,Sa,Ta,Ea,ka,Ia=null;function Aa(){}function Na(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function Ca(t){return t.toString().replace("object ","")}function Ra(){}function Oa(t){return function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];if(null===t)throw new Error("Callback was already called.");var i=t;t=null,i.apply(this,n)}}t.LoaderResource=function(){function t(e,n,r){if(this._dequeue=Aa,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Aa,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new xa,this.onProgress=new xa,this.onComplete=new xa,this.onAfterMiddleware=new xa}return t.setExtensionLoadType=function(e,n){Na(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){Na(t._xhrTypeMap,e,n)},Object.defineProperty(t.prototype,"isDataUrl",{get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isComplete",{get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(n)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:void 0===ba&&(ba=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest)),ba&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==globalThis.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==globalThis.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;"use-credentials"===this.crossOrigin&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},t.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=n,r},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Ca(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Ca(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Ca(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,n="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===r&&(n.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?r=200:1223===r&&(r=204),2===(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var i=new DOMParser;this.data=i.parseFromString(n,"text/xml")}else{var a=document.createElement("div");a.innerHTML=n,this.data=a}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||n;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,Ia||(Ia=document.createElement("a")),Ia.href=t;var n=wa(Ia.href,{strictMode:!0}),r=!n.port&&""===e.port||n.port===e.port,i=n.protocol?n.protocol+":":"";return n.host===e.hostname&&r&&i===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var r=t.indexOf("?"),i=t.indexOf("#"),a=Math.min(r>-1?r:t.length,i>-1?i:t.length);e=(t=t.substring(0,a)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},t}(),_a=t.LoaderResource||(t.LoaderResource={}),(Sa=_a.STATUS_FLAGS||(_a.STATUS_FLAGS={}))[Sa.NONE=0]="NONE",Sa[Sa.DATA_URL=1]="DATA_URL",Sa[Sa.COMPLETE=2]="COMPLETE",Sa[Sa.LOADING=4]="LOADING",(Ta=_a.TYPE||(_a.TYPE={}))[Ta.UNKNOWN=0]="UNKNOWN",Ta[Ta.JSON=1]="JSON",Ta[Ta.XML=2]="XML",Ta[Ta.IMAGE=3]="IMAGE",Ta[Ta.AUDIO=4]="AUDIO",Ta[Ta.VIDEO=5]="VIDEO",Ta[Ta.TEXT=6]="TEXT",(Ea=_a.LOAD_TYPE||(_a.LOAD_TYPE={}))[Ea.XHR=1]="XHR",Ea[Ea.IMAGE=2]="IMAGE",Ea[Ea.AUDIO=3]="AUDIO",Ea[Ea.VIDEO=4]="VIDEO",(ka=_a.XHR_RESPONSE_TYPE||(_a.XHR_RESPONSE_TYPE={})).DEFAULT="text",ka.BUFFER="arraybuffer",ka.BLOB="blob",ka.DOCUMENT="document",ka.JSON="json",ka.TEXT="text",_a._loadTypeMap={gif:_a.LOAD_TYPE.IMAGE,png:_a.LOAD_TYPE.IMAGE,bmp:_a.LOAD_TYPE.IMAGE,jpg:_a.LOAD_TYPE.IMAGE,jpeg:_a.LOAD_TYPE.IMAGE,tif:_a.LOAD_TYPE.IMAGE,tiff:_a.LOAD_TYPE.IMAGE,webp:_a.LOAD_TYPE.IMAGE,tga:_a.LOAD_TYPE.IMAGE,avif:_a.LOAD_TYPE.IMAGE,svg:_a.LOAD_TYPE.IMAGE,"svg+xml":_a.LOAD_TYPE.IMAGE,mp3:_a.LOAD_TYPE.AUDIO,ogg:_a.LOAD_TYPE.AUDIO,wav:_a.LOAD_TYPE.AUDIO,mp4:_a.LOAD_TYPE.VIDEO,webm:_a.LOAD_TYPE.VIDEO},_a._xhrTypeMap={xhtml:_a.XHR_RESPONSE_TYPE.DOCUMENT,html:_a.XHR_RESPONSE_TYPE.DOCUMENT,htm:_a.XHR_RESPONSE_TYPE.DOCUMENT,xml:_a.XHR_RESPONSE_TYPE.DOCUMENT,tmx:_a.XHR_RESPONSE_TYPE.DOCUMENT,svg:_a.XHR_RESPONSE_TYPE.DOCUMENT,tsx:_a.XHR_RESPONSE_TYPE.DOCUMENT,gif:_a.XHR_RESPONSE_TYPE.BLOB,png:_a.XHR_RESPONSE_TYPE.BLOB,bmp:_a.XHR_RESPONSE_TYPE.BLOB,jpg:_a.XHR_RESPONSE_TYPE.BLOB,jpeg:_a.XHR_RESPONSE_TYPE.BLOB,tif:_a.XHR_RESPONSE_TYPE.BLOB,tiff:_a.XHR_RESPONSE_TYPE.BLOB,webp:_a.XHR_RESPONSE_TYPE.BLOB,tga:_a.XHR_RESPONSE_TYPE.BLOB,avif:_a.XHR_RESPONSE_TYPE.BLOB,json:_a.XHR_RESPONSE_TYPE.JSON,text:_a.XHR_RESPONSE_TYPE.TEXT,txt:_a.XHR_RESPONSE_TYPE.TEXT,ttf:_a.XHR_RESPONSE_TYPE.BUFFER,otf:_a.XHR_RESPONSE_TYPE.BUFFER},_a.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var Da=function(t,e){this.data=t,this.callback=e},Ma=function(){function t(t,e){var n=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=Ra,this.unsaturated=Ra,this.empty=Ra,this.drain=Ra,this.error=Ra,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,r){if(r&&"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,null==t&&n.idle())setTimeout((function(){return n.drain()}),1);else{var i=new Da(t,"function"==typeof r?r:Ra);e?n._tasks.unshift(i):n._tasks.push(i),setTimeout(n.process,1)}},this.process=function(){for(;!n.paused&&n.workers<n.concurrency&&n._tasks.length;){var t=n._tasks.shift();0===n._tasks.length&&n.empty(),n.workers+=1,n.workers===n.concurrency&&n.saturated(),n._worker(t.data,Oa(n._next(t)))}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return t.prototype._next=function(t){var e=this;return function(){for(var n=arguments,r=[],i=0;i<arguments.length;i++)r[i]=n[i];e.workers-=1,t.callback.apply(t,r),null!=r[0]&&e.error(r[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},t.prototype.push=function(t,e){this._insert(t,!1,e)},t.prototype.kill=function(){this.workers=0,this.drain=Ra,this.started=!1,this._tasks=[]},t.prototype.unshift=function(t,e){this._insert(t,!0,e)},t.prototype.length=function(){return this._tasks.length},t.prototype.running=function(){return this.workers},t.prototype.idle=function(){return this._tasks.length+this.workers===0},t.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},t.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},t.eachSeries=function(t,e,n,r){var i=0,a=t.length;!function o(s){s||i===a?n&&n(s):r?setTimeout((function(){e(t[i++],o)}),1):e(t[i++],o)}()},t.queue=function(e,n){return new t(e,n)},t}(),Fa=/(#[\w-]+)?$/,Pa=function(){function e(t,n){var r=this;void 0===t&&(t=""),void 0===n&&(n=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return r._loadResource(t,e)},this.resources={},this.baseUrl=t,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return r._loadResource(t,e)},this._queue=Ma.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new xa,this.onError=new xa,this.onLoad=new xa,this.onStart=new xa,this.onComplete=new xa;for(var i=0;i<e._plugins.length;++i){var a=e._plugins[i],o=a.pre,s=a.use;o&&this.pre(o),s&&this.use(s)}this._protected=!1}return e.prototype._add=function(e,n,r,i){if(this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(n=this._prepareUrl(n),this.resources[e]=new t.LoaderResource(e,n,r),"function"==typeof i&&this.resources[e].onAfterMiddleware.once(i),this.loading){for(var a=r.parentResource,o=[],s=0;s<a.children.length;++s)a.children[s].isComplete||o.push(a.children[s]);var u=a.progressChunk*(o.length+1)/(o.length+2);a.children.push(this.resources[e]),a.progressChunk=u;for(s=0;s<o.length;++s)o[s].progressChunk=u;this.resources[e].progressChunk=u}return this._queue.push(this.resources[e]),this},e.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},e.prototype.use=function(t){return this._afterMiddleware.push(t),this},e.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},e.prototype.load=function(t){if(Fe("6.5.0","@pixi/loaders is being replaced with @pixi/assets in the next major release."),"function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(e.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),e.prototype._prepareUrl=function(t){var e,n=wa(t,{strictMode:!0});if(e=n.protocol||!n.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=Fa.exec(e)[0];-1!==(e=e.slice(0,e.length-r.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},e.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,Ma.eachSeries(this._beforeMiddleware,(function(e,r){e.call(n,t,(function(){r(t.isComplete?{}:null)}))}),(function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())}),!0)},e.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Ma.eachSeries(this._afterMiddleware,(function(n,r){n.call(e,t,r)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},e.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(e,"shared",{get:function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},enumerable:!1,configurable:!0}),e.registerPlugin=function(n){return Fe("6.5.0","Loader.registerPlugin() is deprecated, use extensions.add() instead."),kn.add({type:t.ExtensionType.Loader,ref:n}),e},e._plugins=[],e}();kn.handleByList(t.ExtensionType.Loader,Pa._plugins),Pa.prototype.add=function(t,e,n,r){if(Array.isArray(t)){for(var i=0;i<t.length;++i)this.add(t[i]);return this}if("object"==typeof t&&(n=t,r=e||n.callback||n.onComplete,e=n.url,t=n.name||n.key||n.url),"string"!=typeof e&&(r=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");return"function"==typeof n&&(r=n,n=null),this._add(t,e,n,r)};var La=function(){function e(){}return e.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Pa.shared:new Pa},e.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},e.extension=t.ExtensionType.Application,e}(),Ba=function(){function e(){}return e.add=function(){t.LoaderResource.setExtensionLoadType("svg",t.LoaderResource.LOAD_TYPE.XHR),t.LoaderResource.setExtensionXhrType("svg",t.LoaderResource.XHR_RESPONSE_TYPE.TEXT)},e.use=function(e,n){if(!e.data||e.type!==t.LoaderResource.TYPE.IMAGE&&"svg"!==e.extension)n();else{var r=e.data,i=e.url,a=e.name,o=e.metadata;nr.fromLoader(r,i,a,o).then((function(t){e.texture=t,n()})).catch(n)}},e.extension=t.ExtensionType.Loader,e}(),za="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ua(e,n){if(e.data){if(e.xhr&&e.xhrType===t.LoaderResource.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof e.data){if(0===e.data.type.indexOf("image")){var r=globalThis.URL||globalThis.webkitURL,i=r.createObjectURL(e.data);return e.blob=e.data,e.data=new Image,e.data.src=i,e.type=t.LoaderResource.TYPE.IMAGE,void(e.data.onload=function(){r.revokeObjectURL(i),e.data.onload=null,n()})}}else{var a=e.xhr.getResponseHeader("content-type");if(a&&0===a.indexOf("image"))return e.data=new Image,e.data.src="data:"+a+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var r=[0,0,0],i=[0,0,0,0],a=0;a<r.length;++a)n<t.length?r[a]=255&t.charCodeAt(n++):r[a]=0;switch(i[0]=r[0]>>2,i[1]=(3&r[0])<<4|r[1]>>4,i[2]=(15&r[1])<<2|r[2]>>6,i[3]=63&r[2],n-(t.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(a=0;a<i.length;++a)e+=za.charAt(i[a])}return e}(e.xhr.responseText),e.type=t.LoaderResource.TYPE.IMAGE,void(e.data.onload=function(){e.data.onload=null,n()})}n()}else n()}var Ga,Wa,Va=function(){function e(){}return e.extension=t.ExtensionType.Loader,e.use=Ua,e}();kn.add(Ba,Va),t.INTERNAL_FORMATS=void 0,(Wa=t.INTERNAL_FORMATS||(t.INTERNAL_FORMATS={}))[Wa.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",Wa[Wa.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",Wa[Wa.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",Wa[Wa.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",Wa[Wa.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",Wa[Wa.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",Wa[Wa.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",Wa[Wa.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",Wa[Wa.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",Wa[Wa.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",Wa[Wa.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",Wa[Wa.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",Wa[Wa.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",Wa[Wa.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",Wa[Wa.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",Wa[Wa.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",Wa[Wa.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",Wa[Wa.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",Wa[Wa.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",Wa[Wa.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",Wa[Wa.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",Wa[Wa.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",Wa[Wa.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",Wa[Wa.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",Wa[Wa.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",Wa[Wa.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",Wa[Wa.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR";var ja=((Ga={})[t.INTERNAL_FORMATS.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_R11_EAC]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_SIGNED_R11_EAC]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RG11_EAC]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_SIGNED_RG11_EAC]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGB8_ETC2]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA8_ETC2_EAC]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_SRGB8_ETC2]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGB_ETC1_WEBGL]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGB_ATC_WEBGL]=.5,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,Ga[t.INTERNAL_FORMATS.COMPRESSED_RGBA_ASTC_4x4_KHR]=1,Ga),Ha=function(t,e){return Ha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Ha(t,e)};function Xa(t,e){function n(){this.constructor=t}Ha(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function qa(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function Ka(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var Ya,Za,$a=function(t){function e(e,n){void 0===n&&(n={width:1,height:1,autoLoad:!0});var r,i,a=this;return"string"==typeof e?(r=e,i=new Uint8Array):(r=null,i=e),(a=t.call(this,i,n)||this).origin=r,a.buffer=i?new Hi(i):null,a.origin&&!1!==n.autoLoad&&a.load(),i&&i.length&&(a.loaded=!0,a.onBlobLoaded(a.buffer.rawBinaryData)),a}return Xa(e,t),e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return qa(this,void 0,Promise,(function(){var t;return Ka(this,(function(e){switch(e.label){case 0:return[4,fetch(this.origin)];case 1:return[4,e.sent().blob()];case 2:return[4,e.sent().arrayBuffer()];case 3:return t=e.sent(),this.data=new Uint32Array(t),this.buffer=new Hi(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),[2,this]}}))}))},e}(Ln),Ja=function(t){function e(n,r){var i=t.call(this,n,r)||this;return i.format=r.format,i.levels=r.levels||1,i._width=r.width,i._height=r.height,i._extension=e._formatToExtension(i.format),(r.levelBuffers||i.buffer)&&(i._levelBuffers=r.levelBuffers||e._createLevelBuffers(n instanceof Uint8Array?n:i.buffer.uint8View,i.format,i.levels,4,4,i.width,i.height)),i}return Xa(e,t),e.prototype.upload=function(t,e,n){var r=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var i=0,a=this.levels;i<a;i++){var o=this._levelBuffers[i],s=o.levelID,u=o.levelWidth,c=o.levelHeight,l=o.levelBuffer;r.compressedTexImage2D(r.TEXTURE_2D,s,this.format,u,c,0,l)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,e,n,r,i,a,o){for(var s=new Array(n),u=t.byteOffset,c=a,l=o,h=c+r-1&~(r-1),p=l+i-1&~(i-1),f=h*p*ja[e],d=0;d<n;d++)s[d]={levelID:d,levelWidth:n>1?c:h,levelHeight:n>1?l:p,levelBuffer:new Uint8Array(t.buffer,u,f)},u+=f,f=(h=(c=c>>1||1)+r-1&~(r-1))*(p=(l=l>>1||1)+i-1&~(i-1))*ja[e];return s},e}($a),Qa=function(){function e(){}return e.use=function(n,r){var i=n.data;if(n.type===t.LoaderResource.TYPE.JSON&&i&&i.cacheID&&i.textures){for(var a=i.textures,o=void 0,s=void 0,u=0,c=a.length;u<c;u++){var l=a[u],h=l.src,p=l.format;if(p||(s=h),e.textureFormats[p]){o=h;break}}if(!(o=o||s))return void r(new Error("Cannot load compressed-textures in "+n.url+", make sure you provide a fallback"));if(o===n.url)return void r(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var f={crossOrigin:n.crossOrigin,metadata:n.metadata.imageMetadata,parentResource:n},d=oe.resolve(n.url.replace(this.baseUrl,""),o),m=i.cacheID;this.add(m,d,f,(function(t){if(t.error)r(t.error);else{var e=t.texture,i=void 0===e?null:e,a=t.textures,o=void 0===a?{}:a;Object.assign(n,{texture:i,textures:o}),r()}}))}else r()},Object.defineProperty(e,"textureExtensions",{get:function(){if(!e._textureExtensions){var t=it.ADAPTER.createCanvas().getContext("webgl");if(!t)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var n={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};e._textureExtensions=n}return e._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(e,"textureFormats",{get:function(){if(!e._textureFormats){var t=e.textureExtensions;for(var n in e._textureFormats={},t){var r=t[n];r&&Object.assign(e._textureFormats,Object.getPrototypeOf(r))}}return e._textureFormats},enumerable:!1,configurable:!0}),e.extension=t.ExtensionType.Loader,e}();function to(e,n,r){var i={textures:{},texture:null};return n?(n.map((function(e){return new nr(new zn(e,Object.assign({mipmap:t.MIPMAP_MODES.OFF,alphaMode:t.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA},r)))})).forEach((function(t,n){var r=t.baseTexture,a=e+"-"+(n+1);zn.addToCache(r,a),nr.addToCache(t,a),0===n&&(zn.addToCache(r,e),nr.addToCache(t,e),i.texture=t),i.textures[a]=t})),i):i}var eo,no,ro=124,io=3,ao=4,oo=7,so=19,uo=2,co=0,lo=1,ho=2,po=3;!function(t){t[t.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",t[t.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",t[t.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",t[t.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",t[t.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",t[t.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",t[t.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",t[t.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",t[t.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",t[t.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",t[t.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",t[t.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",t[t.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",t[t.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",t[t.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",t[t.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",t[t.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",t[t.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",t[t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",t[t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",t[t.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",t[t.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",t[t.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",t[t.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",t[t.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",t[t.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",t[t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",t[t.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",t[t.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",t[t.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",t[t.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",t[t.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",t[t.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",t[t.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",t[t.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",t[t.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",t[t.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",t[t.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",t[t.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",t[t.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",t[t.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",t[t.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",t[t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",t[t.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",t[t.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",t[t.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",t[t.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",t[t.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",t[t.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",t[t.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",t[t.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",t[t.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",t[t.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",t[t.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",t[t.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",t[t.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",t[t.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",t[t.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",t[t.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",t[t.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",t[t.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",t[t.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",t[t.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",t[t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",t[t.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",t[t.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",t[t.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",t[t.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",t[t.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",t[t.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",t[t.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",t[t.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",t[t.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",t[t.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",t[t.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",t[t.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",t[t.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",t[t.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",t[t.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",t[t.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",t[t.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",t[t.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",t[t.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",t[t.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",t[t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",t[t.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",t[t.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",t[t.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",t[t.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",t[t.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",t[t.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",t[t.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",t[t.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",t[t.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",t[t.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",t[t.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",t[t.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",t[t.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",t[t.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",t[t.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",t[t.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",t[t.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",t[t.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",t[t.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",t[t.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",t[t.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",t[t.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",t[t.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",t[t.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",t[t.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",t[t.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",t[t.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"}(eo||(eo={})),function(t){t[t.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",t[t.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",t[t.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(no||(no={}));var fo,mo,go,vo=((Ya={})[827611204]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,Ya[861165636]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,Ya[894720068]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,Ya),yo=((Za={})[eo.DXGI_FORMAT_BC1_TYPELESS]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,Za[eo.DXGI_FORMAT_BC1_UNORM]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,Za[eo.DXGI_FORMAT_BC2_TYPELESS]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,Za[eo.DXGI_FORMAT_BC2_UNORM]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,Za[eo.DXGI_FORMAT_BC3_TYPELESS]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,Za[eo.DXGI_FORMAT_BC3_UNORM]=t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,Za[eo.DXGI_FORMAT_BC1_UNORM_SRGB]=t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Za[eo.DXGI_FORMAT_BC2_UNORM_SRGB]=t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Za[eo.DXGI_FORMAT_BC3_UNORM_SRGB]=t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Za);function bo(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,ro/Uint32Array.BYTES_PER_ELEMENT),r=n[io],i=n[ao],a=n[oo],o=new Uint32Array(t,so*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),s=o[1];if(4&s){var u=o[uo];if(808540228!==u){var c=vo[u],l=new Uint8Array(t,128);return[new Ja(l,{format:c,width:i,height:r,levels:a})]}var h=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),p=h[co],f=h[lo],d=h[ho],m=h[po],g=yo[p];if(void 0===g)throw new Error("DDSParser cannot parse texture data with DXGI format "+p);if(4===d)throw new Error("DDSParser does not support cubemap textures");if(f===no.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");var v=new Array;if(1===m)v.push(new Uint8Array(t,148));else{for(var y=ja[g],b=0,x=i,w=r,_=0;_<a;_++){b+=Math.max(1,x+3&-4)*Math.max(1,w+3&-4)*y,x>>>=1,w>>>=1}var S=148;for(_=0;_<m;_++)v.push(new Uint8Array(t,S,b)),S+=b}return v.map((function(t){return new Ja(t,{format:g,width:i,height:r,levels:a})}))}if(64&s)throw new Error("DDSParser does not support uncompressed texture data.");if(512&s)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(131072&s)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(2&s)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}var xo=[171,75,84,88,32,49,49,187,13,10,26,10],wo=12,_o=16,So=24,To=28,Eo=36,ko=40,Io=44,Ao=48,No=52,Co=56,Ro=60,Oo=64,Do=((fo={})[t.TYPES.UNSIGNED_BYTE]=1,fo[t.TYPES.UNSIGNED_SHORT]=2,fo[t.TYPES.INT]=4,fo[t.TYPES.UNSIGNED_INT]=4,fo[t.TYPES.FLOAT]=4,fo[t.TYPES.HALF_FLOAT]=8,fo),Mo=((mo={})[t.FORMATS.RGBA]=4,mo[t.FORMATS.RGB]=3,mo[t.FORMATS.RG]=2,mo[t.FORMATS.RED]=1,mo[t.FORMATS.LUMINANCE]=1,mo[t.FORMATS.LUMINANCE_ALPHA]=2,mo[t.FORMATS.ALPHA]=1,mo),Fo=((go={})[t.TYPES.UNSIGNED_SHORT_4_4_4_4]=2,go[t.TYPES.UNSIGNED_SHORT_5_5_5_1]=2,go[t.TYPES.UNSIGNED_SHORT_5_6_5]=2,go);function Po(e,n,r){void 0===r&&(r=!1);var i=new DataView(n);if(!function(t,e){for(var n=0;n<xo.length;n++)if(e.getUint8(n)!==xo[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0}(e,i))return null;var a=67305985===i.getUint32(wo,!0),o=i.getUint32(_o,a),s=i.getUint32(So,a),u=i.getUint32(To,a),c=i.getUint32(Eo,a),l=i.getUint32(ko,a)||1,h=i.getUint32(Io,a)||1,p=i.getUint32(Ao,a)||1,f=i.getUint32(No,a),d=i.getUint32(Co,a),m=i.getUint32(Ro,a);if(0===l||1!==h)throw new Error("Only 2D textures are supported");if(1!==f)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==p)throw new Error("WebGL does not support array textures");var g,v=c+3&-4,y=l+3&-4,b=new Array(p),x=c*l;if(0===o&&(x=v*y),void 0===(g=0!==o?Do[o]?Do[o]*Mo[s]:Fo[o]:ja[u]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var w=r?function(t,e,n){var r=new Map,i=0;for(;i<e;){var a=t.getUint32(Oo+i,n),o=Oo+i+4,s=3-(a+3)%4;if(0===a||a>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var u=0;u<a&&0!==t.getUint8(o+u);u++);if(-1===u){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var c=(new TextDecoder).decode(new Uint8Array(t.buffer,o,u)),l=new DataView(t.buffer,o+u+1,a-u-1);r.set(c,l),i+=4+a+s}return r}(i,m,a):null,_=x*g,S=c,T=l,E=v,k=y,I=Oo+m,A=0;A<d;A++){for(var N=i.getUint32(I,a),C=I+4,R=0;R<p;R++){var O=b[R];O||(O=b[R]=new Array(d)),O[A]={levelID:A,levelWidth:d>1||0!==o?S:E,levelHeight:d>1||0!==o?T:k,levelBuffer:new Uint8Array(n,C,_)},C+=_}I=(I+=N+4)%4!=0?I+4-I%4:I,_=(E=(S=S>>1||1)+4-1&-4)*(k=(T=T>>1||1)+4-1&-4)*g}return 0!==o?{uncompressed:b.map((function(e){var n=e[0].levelBuffer,r=!1;return o===t.TYPES.FLOAT?n=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):o===t.TYPES.UNSIGNED_INT?(r=!0,n=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):o===t.TYPES.INT&&(r=!0,n=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new Ln(n,{width:e[0].levelWidth,height:e[0].levelHeight}),type:o,format:r?Lo(s):s}})),kvData:w}:{compressed:b.map((function(t){return new Ja(null,{format:u,width:c,height:l,levels:d,levelBuffers:t})})),kvData:w}}function Lo(e){switch(e){case t.FORMATS.RGBA:return t.FORMATS.RGBA_INTEGER;case t.FORMATS.RGB:return t.FORMATS.RGB_INTEGER;case t.FORMATS.RG:return t.FORMATS.RG_INTEGER;case t.FORMATS.RED:return t.FORMATS.RED_INTEGER;default:return e}}t.LoaderResource.setExtensionXhrType("dds",t.LoaderResource.XHR_RESPONSE_TYPE.BUFFER);var Bo=function(){function e(){}return e.use=function(t,e){if("dds"===t.extension&&t.data)try{Object.assign(t,to(t.name||t.url,bo(t.data),t.metadata))}catch(t){return void e(t)}e()},e.extension=t.ExtensionType.Loader,e}();t.LoaderResource.setExtensionXhrType("ktx",t.LoaderResource.XHR_RESPONSE_TYPE.BUFFER);var zo=function(){function e(){}return e.use=function(e,n){if("ktx"===e.extension&&e.data)try{var r=e.name||e.url,i=Po(r,e.data,this.loadKeyValueData),a=i.compressed,o=i.uncompressed,s=i.kvData;if(a){var u=to(r,a,e.metadata);if(s&&u.textures)for(var c in u.textures)u.textures[c].baseTexture.ktxKeyValueData=s;Object.assign(e,u)}else if(o){var l={};o.forEach((function(e,n){var i=new nr(new zn(e.resource,{mipmap:t.MIPMAP_MODES.OFF,alphaMode:t.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,type:e.type,format:e.format})),a=r+"-"+(n+1);s&&(i.baseTexture.ktxKeyValueData=s),zn.addToCache(i.baseTexture,a),nr.addToCache(i,a),0===n&&(l[r]=i,zn.addToCache(i.baseTexture,r),nr.addToCache(i,r)),l[a]=i})),Object.assign(e,{textures:l})}}catch(t){return void n(t)}n()},e.extension=t.ExtensionType.Loader,e.loadKeyValueData=!1,e}(),Uo=function(t,e){return Uo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Uo(t,e)};function Go(t,e){function n(){this.constructor=t}Uo(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Wo,Vo,jo=function(e){function n(n,r,i,a){void 0===n&&(n=1500),void 0===i&&(i=16384),void 0===a&&(a=!1);var o=e.call(this)||this;return i>16384&&(i=16384),o._properties=[!1,!0,!1,!1,!1],o._maxSize=n,o._batchSize=i,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=t.BLEND_MODES.NORMAL,o.autoResize=a,o.roundPixels=!0,o.baseTexture=null,o.setProperties(r),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return Go(n,e),n.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},n.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,ge(t,this.tintRgb)},enumerable:!1,configurable:!0}),n.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},n.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},n.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},n.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},n}(wn),Ho=function(){function e(e,n,r){this.geometry=new pr,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<e.length;++i){var a=e[i];a={attributeName:a.attributeName,size:a.size,uploadFunction:a.uploadFunction,type:a.type||t.TYPES.FLOAT,offset:a.offset},n[i]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return e.prototype.initBuffers=function(){var e=this.geometry,n=0;this.indexBuffer=new sr(Te(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){(s=this.dynamicProperties[r]).offset=n,n+=s.size,this.dynamicStride+=s.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new sr(this.dynamicData,!1,!1);var a=0;this.staticStride=0;for(r=0;r<this.staticProperties.length;++r){(s=this.staticProperties[r]).offset=a,a+=s.size,this.staticStride+=s.size}var o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new sr(this.staticData,!0,!1);for(r=0;r<this.dynamicProperties.length;++r){var s=this.dynamicProperties[r];e.addAttribute(s.attributeName,this.dynamicBuffer,0,s.type===t.TYPES.UNSIGNED_BYTE,s.type,4*this.dynamicStride,4*s.offset)}for(r=0;r<this.staticProperties.length;++r){s=this.staticProperties[r];e.addAttribute(s.attributeName,this.staticBuffer,0,s.type===t.TYPES.UNSIGNED_BYTE,s.type,4*this.staticStride,4*s.offset)}},e.prototype.uploadDynamic=function(e,n,r){for(var i=0;i<this.dynamicProperties.length;i++){var a=this.dynamicProperties[i];a.uploadFunction(e,n,r,a.type===t.TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,a.offset)}this.dynamicBuffer._updateID++},e.prototype.uploadStatic=function(e,n,r){for(var i=0;i<this.staticProperties.length;i++){var a=this.staticProperties[i];a.uploadFunction(e,n,r,a.type===t.TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,a.offset)}this.staticBuffer._updateID++},e.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},e}(),Xo=function(e){function n(n){var r=e.call(this,n)||this;return r.shader=null,r.properties=null,r.tempMatrix=new an,r.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:t.TYPES.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=ei.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),r.state=ni.for2d(),r}return Go(n,e),n.prototype.render=function(t){var e=t.children,n=t._maxSize,r=t._batchSize,i=this.renderer,a=e.length;if(0!==a){a>n&&!t.autoResize&&(a=n);var o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));var s=e[0]._texture.baseTexture,u=s.alphaMode>0;this.state.blendMode=xe(t.blendMode,u),i.state.set(this.state);var c=i.gl,l=t.worldTransform.copyTo(this.tempMatrix);l.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=we(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var h=!1,p=0,f=0;p<a;p+=r,f+=1){var d=a-p;d>r&&(d=r),f>=o.length&&o.push(this._generateOneMoreBuffer(t));var m=o[f];m.uploadDynamic(e,p,d);var g=t._bufferUpdateIDs[f]||0;(h=h||m._updateID<g)&&(m._updateID=t._updateID,m.uploadStatic(e,p,d)),i.geometry.bind(m.geometry),c.drawElements(c.TRIANGLES,6*d,c.UNSIGNED_SHORT,0)}}},n.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,r=t._batchSize,i=t._properties,a=0;a<n;a+=r)e.push(new Ho(this.properties,i,r));return e},n.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,n=t._properties;return new Ho(this.properties,n,e)},n.prototype.uploadVertices=function(t,e,n,r,i,a){for(var o=0,s=0,u=0,c=0,l=0;l<n;++l){var h=t[e+l],p=h._texture,f=h.scale.x,d=h.scale.y,m=p.trim,g=p.orig;m?(o=(s=m.x-h.anchor.x*g.width)+m.width,u=(c=m.y-h.anchor.y*g.height)+m.height):(o=g.width*(1-h.anchor.x),s=g.width*-h.anchor.x,u=g.height*(1-h.anchor.y),c=g.height*-h.anchor.y),r[a]=s*f,r[a+1]=c*d,r[a+i]=o*f,r[a+i+1]=c*d,r[a+2*i]=o*f,r[a+2*i+1]=u*d,r[a+3*i]=s*f,r[a+3*i+1]=u*d,a+=4*i}},n.prototype.uploadPosition=function(t,e,n,r,i,a){for(var o=0;o<n;o++){var s=t[e+o].position;r[a]=s.x,r[a+1]=s.y,r[a+i]=s.x,r[a+i+1]=s.y,r[a+2*i]=s.x,r[a+2*i+1]=s.y,r[a+3*i]=s.x,r[a+3*i+1]=s.y,a+=4*i}},n.prototype.uploadRotation=function(t,e,n,r,i,a){for(var o=0;o<n;o++){var s=t[e+o].rotation;r[a]=s,r[a+i]=s,r[a+2*i]=s,r[a+3*i]=s,a+=4*i}},n.prototype.uploadUvs=function(t,e,n,r,i,a){for(var o=0;o<n;++o){var s=t[e+o]._texture._uvs;s?(r[a]=s.x0,r[a+1]=s.y0,r[a+i]=s.x1,r[a+i+1]=s.y1,r[a+2*i]=s.x2,r[a+2*i+1]=s.y2,r[a+3*i]=s.x3,r[a+3*i+1]=s.y3,a+=4*i):(r[a]=0,r[a+1]=0,r[a+i]=0,r[a+i+1]=0,r[a+2*i]=0,r[a+2*i+1]=0,r[a+3*i]=0,r[a+3*i+1]=0,a+=4*i)}},n.prototype.uploadTint=function(t,e,n,r,i,a){for(var o=0;o<n;++o){var s=t[e+o],u=s._texture.baseTexture.alphaMode>0,c=s.alpha,l=c<1&&u?_e(s._tintRGB,c):s._tintRGB+(255*c<<24);r[a]=l,r[a+i]=l,r[a+2*i]=l,r[a+3*i]=l,a+=4*i}},n.prototype.destroy=function(){e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},n.extension={name:"particle",type:t.ExtensionType.RendererPlugin},n}(wr);t.LINE_JOIN=void 0,(Wo=t.LINE_JOIN||(t.LINE_JOIN={})).MITER="miter",Wo.BEVEL="bevel",Wo.ROUND="round",t.LINE_CAP=void 0,(Vo=t.LINE_CAP||(t.LINE_CAP={})).BUTT="butt",Vo.ROUND="round",Vo.SQUARE="square";var qo={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},Ko=function(){function t(){this.color=16777215,this.alpha=1,this.texture=nr.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=nr.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),Yo=function(t,e){return Yo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Yo(t,e)};function Zo(t,e){function n(){this.constructor=t}Yo(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function $o(t,e){var n,r;void 0===e&&(e=!1);var i=t.length;if(!(i<6)){for(var a=0,o=0,s=t[i-2],u=t[i-1];o<i;o+=2){var c=t[o],l=t[o+1];a+=(c-s)*(l+u),s=c,u=l}if(!e&&a>0||e&&a<=0){var h=i/2;for(o=h+h%2;o<i;o+=2){var p=i-o-2,f=i-o-1,d=o,m=o+1;n=[t[d],t[p]],t[p]=n[0],t[d]=n[1],r=[t[m],t[f]],t[f]=r[0],t[m]=r[1]}}}}var Jo={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,r=t.holes,i=e.points,a=e.indices;if(n.length>=6){$o(n,!1);for(var o=[],s=0;s<r.length;s++){var u=r[s];$o(u.points,!0),o.push(n.length/2),n=n.concat(u.points)}var c=ut(n,o,2);if(!c)return;var l=i.length/2;for(s=0;s<c.length;s+=3)a.push(c[s]+l),a.push(c[s+1]+l),a.push(c[s+2]+l);for(s=0;s<n.length;s++)i.push(n[s])}}},Qo={build:function(e){var n,r,i,a,o,s,u=e.points;if(e.type===t.SHAPES.CIRC){var c=e.shape;n=c.x,r=c.y,o=s=c.radius,i=a=0}else if(e.type===t.SHAPES.ELIP){var l=e.shape;n=l.x,r=l.y,o=l.width,s=l.height,i=a=0}else{var h=e.shape,p=h.width/2,f=h.height/2;n=h.x+p,r=h.y+f,i=p-(o=s=Math.max(0,Math.min(h.radius,Math.min(p,f)))),a=f-s}if(o>=0&&s>=0&&i>=0&&a>=0){var d=Math.ceil(2.3*Math.sqrt(o+s)),m=8*d+(i?4:0)+(a?4:0);if(u.length=m,0!==m){if(0===d)return u.length=8,u[0]=u[6]=n+i,u[1]=u[3]=r+a,u[2]=u[4]=n-i,void(u[5]=u[7]=r-a);var g=0,v=4*d+(i?2:0)+2,y=v,b=m,x=n+(k=i+o),w=n-k,_=r+(I=a);if(u[g++]=x,u[g++]=_,u[--v]=_,u[--v]=w,a){var S=r-I;u[y++]=w,u[y++]=S,u[--b]=S,u[--b]=x}for(var T=1;T<d;T++){var E=Math.PI/2*(T/d);x=n+(k=i+Math.cos(E)*o),w=n-k,_=r+(I=a+Math.sin(E)*s),S=r-I;u[g++]=x,u[g++]=_,u[--v]=_,u[--v]=w,u[y++]=w,u[y++]=S,u[--b]=S,u[--b]=x}var k,I;x=n+(k=i),w=n-k,_=r+(I=a+s),S=r-I;u[g++]=x,u[g++]=_,u[--b]=S,u[--b]=x,i&&(u[g++]=w,u[g++]=_,u[--b]=S,u[--b]=w)}}else u.length=0},triangulate:function(e,n){var r=e.points,i=n.points,a=n.indices;if(0!==r.length){var o,s,u=i.length/2,c=u;if(e.type!==t.SHAPES.RREC){var l=e.shape;o=l.x,s=l.y}else{var h=e.shape;o=h.x+h.width/2,s=h.y+h.height/2}var p=e.matrix;i.push(e.matrix?p.a*o+p.c*s+p.tx:o,e.matrix?p.b*o+p.d*s+p.ty:s),u++,i.push(r[0],r[1]);for(var f=2;f<r.length;f+=2)i.push(r[f],r[f+1]),a.push(u++,c,u);a.push(c+1,c,u)}}},ts={build:function(t){var e=t.shape,n=e.x,r=e.y,i=e.width,a=e.height,o=t.points;o.length=0,o.push(n,r,n+i,r,n+i,r+a,n,r+a)},triangulate:function(t,e){var n=t.points,r=e.points,i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function es(t,e,n){return t+(e-t)*n}function ns(t,e,n,r,i,a,o){void 0===o&&(o=[]);for(var s=o,u=0,c=0,l=0,h=0,p=0,f=0,d=0,m=0;d<=20;++d)u=es(t,n,m=d/20),c=es(e,r,m),l=es(n,i,m),h=es(r,a,m),p=es(u,l,m),f=es(c,h,m),0===d&&s[s.length-2]===p&&s[s.length-1]===f||s.push(p,f);return s}var rs={build:function(t){if(ws.nextRoundedRectBehavior)Qo.build(t);else{var e=t.shape,n=t.points,r=e.x,i=e.y,a=e.width,o=e.height,s=Math.max(0,Math.min(e.radius,Math.min(a,o)/2));n.length=0,s?(ns(r,i+s,r,i,r+s,i,n),ns(r+a-s,i,r+a,i,r+a,i+s,n),ns(r+a,i+o-s,r+a,i+o,r+a-s,i+o,n),ns(r+s,i+o,r,i+o,r,i+o-s,n)):n.push(r,i,r+a,i,r+a,i+o,r,i+o)}},triangulate:function(t,e){if(ws.nextRoundedRectBehavior)Qo.triangulate(t,e);else{for(var n=t.points,r=e.points,i=e.indices,a=r.length/2,o=ut(n,null,2),s=0,u=o.length;s<u;s+=3)i.push(o[s]+a),i.push(o[s+1]+a),i.push(o[s+2]+a);for(s=0,u=n.length;s<u;s++)r.push(n[s],n[++s])}}};function is(t,e,n,r,i,a,o,s){var u,c;o?(u=r,c=-n):(u=-r,c=n);var l=t-n*i+u,h=e-r*i+c,p=t+n*a+u,f=e+r*a+c;return s.push(l,h),s.push(p,f),2}function as(t,e,n,r,i,a,o,s){var u=n-t,c=r-e,l=Math.atan2(u,c),h=Math.atan2(i-t,a-e);s&&l<h?l+=2*Math.PI:!s&&l>h&&(h+=2*Math.PI);var p=l,f=h-l,d=Math.abs(f),m=Math.sqrt(u*u+c*c),g=1+(15*d*Math.sqrt(m)/Math.PI|0),v=f/g;if(p+=v,s){o.push(t,e),o.push(n,r);for(var y=1,b=p;y<g;y++,b+=v)o.push(t,e),o.push(t+Math.sin(b)*m,e+Math.cos(b)*m);o.push(t,e),o.push(i,a)}else{o.push(n,r),o.push(t,e);for(y=1,b=p;y<g;y++,b+=v)o.push(t+Math.sin(b)*m,e+Math.cos(b)*m),o.push(t,e);o.push(i,a),o.push(t,e)}return 2*g}function os(e,n){e.lineStyle.native?function(e,n){var r=0,i=e.shape,a=e.points||i.points,o=i.type!==t.SHAPES.POLY||i.closeStroke;if(0!==a.length){var s=n.points,u=n.indices,c=a.length/2,l=s.length/2,h=l;for(s.push(a[0],a[1]),r=1;r<c;r++)s.push(a[2*r],a[2*r+1]),u.push(h,h+1),h++;o&&u.push(h,l)}}(e,n):function(e,n){var r=e.shape,i=e.points||r.points.slice(),a=n.closePointEps;if(0!==i.length){var o=e.lineStyle,s=new Ze(i[0],i[1]),u=new Ze(i[i.length-2],i[i.length-1]),c=r.type!==t.SHAPES.POLY||r.closeStroke,l=Math.abs(s.x-u.x)<a&&Math.abs(s.y-u.y)<a;if(c){i=i.slice(),l&&(i.pop(),i.pop(),u.set(i[i.length-2],i[i.length-1]));var h=.5*(s.x+u.x),p=.5*(u.y+s.y);i.unshift(h,p),i.push(h,p)}var f=n.points,d=i.length/2,m=i.length,g=f.length/2,v=o.width/2,y=v*v,b=o.miterLimit*o.miterLimit,x=i[0],w=i[1],_=i[2],S=i[3],T=0,E=0,k=-(w-S),I=x-_,A=0,N=0,C=Math.sqrt(k*k+I*I);k/=C,I/=C,k*=v,I*=v;var R=o.alignment,O=2*(1-R),D=2*R;c||(o.cap===t.LINE_CAP.ROUND?m+=as(x-k*(O-D)*.5,w-I*(O-D)*.5,x-k*O,w-I*O,x+k*D,w+I*D,f,!0)+2:o.cap===t.LINE_CAP.SQUARE&&(m+=is(x,w,k,I,O,D,!0,f))),f.push(x-k*O,w-I*O),f.push(x+k*D,w+I*D);for(var M=1;M<d-1;++M){x=i[2*(M-1)],w=i[2*(M-1)+1],_=i[2*M],S=i[2*M+1],T=i[2*(M+1)],E=i[2*(M+1)+1],k=-(w-S),I=x-_,k/=C=Math.sqrt(k*k+I*I),I/=C,k*=v,I*=v,A=-(S-E),N=_-T,A/=C=Math.sqrt(A*A+N*N),N/=C,A*=v,N*=v;var F=_-x,P=w-S,L=_-T,B=E-S,z=F*L+P*B,U=P*L-B*F,G=U<0;if(Math.abs(U)<.001*Math.abs(z))f.push(_-k*O,S-I*O),f.push(_+k*D,S+I*D),z>=0&&(o.join===t.LINE_JOIN.ROUND?m+=as(_,S,_-k*O,S-I*O,_-A*O,S-N*O,f,!1)+4:m+=2,f.push(_-A*D,S-N*D),f.push(_+A*O,S+N*O));else{var W=(-k+x)*(-I+S)-(-k+_)*(-I+w),V=(-A+T)*(-N+S)-(-A+_)*(-N+E),j=(F*V-L*W)/U,H=(B*W-P*V)/U,X=(j-_)*(j-_)+(H-S)*(H-S),q=_+(j-_)*O,K=S+(H-S)*O,Y=_-(j-_)*D,Z=S-(H-S)*D,$=G?O:D;X<=Math.min(F*F+P*P,L*L+B*B)+$*$*y?o.join===t.LINE_JOIN.BEVEL||X/y>b?(G?(f.push(q,K),f.push(_+k*D,S+I*D),f.push(q,K),f.push(_+A*D,S+N*D)):(f.push(_-k*O,S-I*O),f.push(Y,Z),f.push(_-A*O,S-N*O),f.push(Y,Z)),m+=2):o.join===t.LINE_JOIN.ROUND?G?(f.push(q,K),f.push(_+k*D,S+I*D),m+=as(_,S,_+k*D,S+I*D,_+A*D,S+N*D,f,!0)+4,f.push(q,K),f.push(_+A*D,S+N*D)):(f.push(_-k*O,S-I*O),f.push(Y,Z),m+=as(_,S,_-k*O,S-I*O,_-A*O,S-N*O,f,!1)+4,f.push(_-A*O,S-N*O),f.push(Y,Z)):(f.push(q,K),f.push(Y,Z)):(f.push(_-k*O,S-I*O),f.push(_+k*D,S+I*D),o.join===t.LINE_JOIN.ROUND?m+=G?as(_,S,_+k*D,S+I*D,_+A*D,S+N*D,f,!0)+2:as(_,S,_-k*O,S-I*O,_-A*O,S-N*O,f,!1)+2:o.join===t.LINE_JOIN.MITER&&X/y<=b&&(G?(f.push(Y,Z),f.push(Y,Z)):(f.push(q,K),f.push(q,K)),m+=2),f.push(_-A*O,S-N*O),f.push(_+A*D,S+N*D),m+=2)}}x=i[2*(d-2)],w=i[2*(d-2)+1],_=i[2*(d-1)],k=-(w-(S=i[2*(d-1)+1])),I=x-_,k/=C=Math.sqrt(k*k+I*I),I/=C,k*=v,I*=v,f.push(_-k*O,S-I*O),f.push(_+k*D,S+I*D),c||(o.cap===t.LINE_CAP.ROUND?m+=as(_-k*(O-D)*.5,S-I*(O-D)*.5,_-k*O,S-I*O,_+k*D,S+I*D,f,!1)+2:o.cap===t.LINE_CAP.SQUARE&&(m+=is(_,S,k,I,O,D,!1,f)));var J=n.indices,Q=qo.epsilon*qo.epsilon;for(M=g;M<m+g-2;++M)x=f[2*M],w=f[2*M+1],_=f[2*(M+1)],S=f[2*(M+1)+1],T=f[2*(M+2)],E=f[2*(M+2)+1],Math.abs(x*(S-E)+_*(E-w)+T*(w-S))<Q||J.push(M,M+1,M+2)}}(e,n)}var ss,us=function(){function t(){}return t.curveTo=function(t,e,n,r,i,a){var o=a[a.length-2],s=a[a.length-1]-e,u=o-t,c=r-e,l=n-t,h=Math.abs(s*l-u*c);if(h<1e-8||0===i)return a[a.length-2]===t&&a[a.length-1]===e||a.push(t,e),null;var p=s*s+u*u,f=c*c+l*l,d=s*c+u*l,m=i*Math.sqrt(p)/h,g=i*Math.sqrt(f)/h,v=m*d/p,y=g*d/f,b=m*l+g*u,x=m*c+g*s,w=u*(g+v),_=s*(g+v),S=l*(m+y),T=c*(m+y);return{cx:b+t,cy:x+e,radius:i,startAngle:Math.atan2(_-x,w-b),endAngle:Math.atan2(T-x,S-b),anticlockwise:u*c>l*s}},t.arc=function(t,e,n,r,i,a,o,s,u){for(var c=o-a,l=qo._segmentsCount(Math.abs(c)*i,40*Math.ceil(Math.abs(c)/qe)),h=c/(2*l),p=2*h,f=Math.cos(h),d=Math.sin(h),m=l-1,g=m%1/m,v=0;v<=m;++v){var y=h+a+p*(v+g*v),b=Math.cos(y),x=-Math.sin(y);u.push((f*b+d*x)*i+n,(f*-x+d*b)*i+r)}},t}(),cs=function(){function t(){}return t.curveLength=function(t,e,n,r,i,a,o,s){for(var u=0,c=0,l=0,h=0,p=0,f=0,d=0,m=0,g=0,v=0,y=0,b=t,x=e,w=1;w<=10;++w)v=b-(m=(d=(f=(p=1-(c=w/10))*p)*p)*t+3*f*c*n+3*p*(l=c*c)*i+(h=l*c)*o),y=x-(g=d*e+3*f*c*r+3*p*l*a+h*s),b=m,x=g,u+=Math.sqrt(v*v+y*y);return u},t.curveTo=function(e,n,r,i,a,o,s){var u=s[s.length-2],c=s[s.length-1];s.length-=2;var l=qo._segmentsCount(t.curveLength(u,c,e,n,r,i,a,o)),h=0,p=0,f=0,d=0,m=0;s.push(u,c);for(var g=1,v=0;g<=l;++g)f=(p=(h=1-(v=g/l))*h)*h,m=(d=v*v)*v,s.push(f*u+3*p*v*e+3*h*d*r+m*a,f*c+3*p*v*n+3*h*d*i+m*o)},t}(),ls=function(){function t(){}return t.curveLength=function(t,e,n,r,i,a){var o=t-2*n+i,s=e-2*r+a,u=2*n-2*t,c=2*r-2*e,l=4*(o*o+s*s),h=4*(o*u+s*c),p=u*u+c*c,f=2*Math.sqrt(l+h+p),d=Math.sqrt(l),m=2*l*d,g=2*Math.sqrt(p),v=h/d;return(m*f+d*h*(f-g)+(4*p*l-h*h)*Math.log((2*d+v+f)/(v+g)))/(4*m)},t.curveTo=function(e,n,r,i,a){for(var o=a[a.length-2],s=a[a.length-1],u=qo._segmentsCount(t.curveLength(o,s,e,n,r,i)),c=0,l=0,h=1;h<=u;++h){var p=h/u;c=o+(e-o)*p,l=s+(n-s)*p,a.push(c+(e+(r-e)*p-c)*p,l+(n+(i-n)*p-l)*p)}},t}(),hs=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),ps=((ss={})[t.SHAPES.POLY]=Jo,ss[t.SHAPES.CIRC]=Qo,ss[t.SHAPES.ELIP]=Qo,ss[t.SHAPES.RECT]=ts,ss[t.SHAPES.RREC]=rs,ss),fs=[],ds=[],ms=function(){function t(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),gs=new Ze,vs=function(e){function n(){var t=e.call(this)||this;return t.closePointEps=1e-4,t.boundsPadding=0,t.uvsFloat32=null,t.indicesUint16=null,t.batchable=!1,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.drawCalls=[],t.batchDirty=-1,t.batches=[],t.dirty=0,t.cacheDirty=-1,t.clearDirty=0,t.shapeIndex=0,t._bounds=new mn,t.boundsDirty=-1,t}return Zo(n,e),Object.defineProperty(n.prototype,"bounds",{get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),n.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),ds.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),fs.push(e)}this.batches.length=0},n.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},n.prototype.drawShape=function(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null);var i=new ms(t,e,n,r);return this.graphicsData.push(i),this.dirty++,this},n.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var n=new ms(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this},n.prototype.destroy=function(){e.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},n.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var r=e[n];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,gs):gs.copyFrom(t),r.shape.contains(gs.x,gs.y)))){var i=!1;if(r.holes)for(var a=0;a<r.holes.length;a++){if(r.holes[a].shape.contains(gs.x,gs.y)){i=!0;break}}if(!i)return!0}}return!1},n.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,n=this.graphicsData,r=null,i=null;this.batches.length>0&&(i=(r=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<n.length;a++){this.shapeIndex++;var o=n[a],s=o.fillStyle,u=o.lineStyle;ps[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(s.visible||u.visible)&&this.processHoles(o.holes);for(var c=0;c<2;c++){var l=0===c?s:u;if(l.visible){var h=l.texture.baseTexture,p=this.indices.length,f=this.points.length/2;h.wrapMode=t.WRAP_MODES.REPEAT,0===c?this.processFill(o):this.processLine(o);var d=this.points.length/2-f;0!==d&&(r&&!this._compareStyles(i,l)&&(r.end(p,f),r=null),r||((r=fs.pop()||new hs).begin(l,p,f),this.batches.push(r),i=l),this.addUvs(this.points,e,l.texture,f,d,l.matrix))}}}var m=this.indices.length,g=this.points.length/2;if(r&&r.end(m,g),0!==this.batches.length){var v=g>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&v===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=v?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},n.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},n.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],r=n.fillStyle,i=n.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(i&&!i.texture.baseTexture.valid)return!1}return!0},n.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var r=t[e],i=0;i<r.size;i++){var a=r.start+i;this.indicesUint16[a]=this.indicesUint16[a]-r.attribStart}},n.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*n.BATCHABLE_SIZE},n.prototype.buildDrawCalls=function(){for(var e=++zn._globalBatch,n=0;n<this.drawCalls.length;n++)this.drawCalls[n].texArray.clear(),ds.push(this.drawCalls[n]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,a=ds.pop();a||((a=new Vi).texArray=new ji),a.texArray.count=0,a.start=0,a.size=0,a.type=t.DRAW_MODES.TRIANGLES;var o=0,s=null,u=0,c=!1,l=t.DRAW_MODES.TRIANGLES,h=0;this.drawCalls.push(a);for(n=0;n<this.batches.length;n++){var p=this.batches[n],f=p.style,d=f.texture.baseTexture;c!==!!f.native&&(l=(c=!!f.native)?t.DRAW_MODES.LINES:t.DRAW_MODES.TRIANGLES,s=null,o=8,e++),s!==d&&(s=d,d._batchEnabled!==e&&(8===o&&(e++,o=0,a.size>0&&((a=ds.pop())||((a=new Vi).texArray=new ji),this.drawCalls.push(a)),a.start=h,a.size=0,a.texArray.count=0,a.type=l),d.touched=1,d._batchEnabled=e,d._batchLocation=o,d.wrapMode=t.WRAP_MODES.REPEAT,a.texArray.elements[a.texArray.count++]=d,o++)),a.size+=p.size,h+=p.size,u=d._batchLocation,this.addColors(r,f.color,f.alpha,p.attribSize,p.attribStart),this.addTextureIds(i,u,p.attribSize,p.attribStart)}zn._globalBatch=e,this.packAttributes()},n.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),a=new Float32Array(i),o=new Uint32Array(i),s=0,u=0;u<t.length/2;u++)a[s++]=t[2*u],a[s++]=t[2*u+1],a[s++]=e[2*u],a[s++]=e[2*u+1],o[s++]=n[u],a[s++]=r[u];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)},n.prototype.processFill=function(t){t.holes.length?Jo.triangulate(t,this):ps[t.type].triangulate(t,this)},n.prototype.processLine=function(t){os(t,this);for(var e=0;e<t.holes.length;e++)os(t.holes[e],this)},n.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];ps[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},n.prototype.calculateBounds=function(){var t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)},n.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}},n.prototype.addColors=function(t,e,n,r,i){void 0===i&&(i=0);var a=_e((e>>16)+(65280&e)+((255&e)<<16),n);t.length=Math.max(t.length,i+r);for(var o=0;o<r;o++)t[i+o]=a},n.prototype.addTextureIds=function(t,e,n,r){void 0===r&&(r=0),t.length=Math.max(t.length,r+n);for(var i=0;i<n;i++)t[r+i]=e},n.prototype.addUvs=function(t,e,n,r,i,a){void 0===a&&(a=null);for(var o=0,s=e.length,u=n.frame;o<i;){var c=t[2*(r+o)],l=t[2*(r+o)+1];if(a){var h=a.a*c+a.c*l+a.tx;l=a.b*c+a.d*l+a.ty,c=h}o++,e.push(c/u.width,l/u.height)}var p=n.baseTexture;(u.width<p.width||u.height<p.height)&&this.adjustUvs(e,n,s,i)},n.prototype.adjustUvs=function(t,e,n,r){for(var i=e.baseTexture,a=1e-6,o=n+2*r,s=e.frame,u=s.width/i.width,c=s.height/i.height,l=s.x/s.width,h=s.y/s.height,p=Math.floor(t[n]+a),f=Math.floor(t[n+1]+a),d=n+2;d<o;d+=2)p=Math.min(p,Math.floor(t[d]+a)),f=Math.min(f,Math.floor(t[d+1]+a));l-=p,h-=f;for(d=n;d<o;d+=2)t[d]=(t[d]+l)*u,t[d+1]=(t[d+1]+h)*c},n.BATCHABLE_SIZE=100,n}(Ki),ys=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.width=0,n.alignment=.5,n.native=!1,n.cap=t.LINE_CAP.BUTT,n.join=t.LINE_JOIN.MITER,n.miterLimit=10,n}return Zo(n,e),n.prototype.clone=function(){var t=new n;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},n.prototype.reset=function(){e.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},n}(Ko),bs=new Float32Array(3),xs={},ws=function(e){function n(n){void 0===n&&(n=null);var r=e.call(this)||this;return r.shader=null,r.pluginName="batch",r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r._fillStyle=new Ko,r._lineStyle=new ys,r._matrix=null,r._holeMode=!1,r.state=ni.for2d(),r._geometry=n||new vs,r._geometry.refCount++,r._transformID=-1,r.tint=16777215,r.blendMode=t.BLEND_MODES.NORMAL,r}return Zo(n,e),Object.defineProperty(n.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return this.finishPoly(),new n(this._geometry)},Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),n.prototype.lineStyle=function(t,e,n,r,i){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r=.5),void 0===i&&(i=!1),"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:r,native:i}),this.lineTextureStyle(t)},n.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:nr.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:t.LINE_CAP.BUTT,join:t.LINE_JOIN.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this},n.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new en,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new en,this.currentPath.closeStroke=!1},n.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},n.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},n.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return r===t&&i===e||n.push(t,e),this},n.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},n.prototype.quadraticCurveTo=function(t,e,n,r){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),ls.curveTo(t,e,n,r,i),this},n.prototype.bezierCurveTo=function(t,e,n,r,i,a){return this._initCurve(),cs.curveTo(t,e,n,r,i,a,this.currentPath.points),this},n.prototype.arcTo=function(t,e,n,r,i){this._initCurve(t,e);var a=this.currentPath.points,o=us.curveTo(t,e,n,r,i,a);if(o){var s=o.cx,u=o.cy,c=o.radius,l=o.startAngle,h=o.endAngle,p=o.anticlockwise;this.arc(s,u,c,l,h,p)}return this},n.prototype.arc=function(t,e,n,r,i,a){if(void 0===a&&(a=!1),r===i)return this;if(!a&&i<=r?i+=qe:a&&r<=i&&(r+=qe),0===i-r)return this;var o=t+Math.cos(r)*n,s=e+Math.sin(r)*n,u=this._geometry.closePointEps,c=this.currentPath?this.currentPath.points:null;if(c){var l=Math.abs(c[c.length-2]-o),h=Math.abs(c[c.length-1]-s);l<u&&h<u||c.push(o,s)}else this.moveTo(o,s),c=this.currentPath.points;return us.arc(o,s,t,e,n,r,i,a,c),this},n.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:nr.WHITE,color:t,alpha:e})},n.prototype.beginTextureFill=function(t){t=Object.assign({texture:nr.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},n.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},n.prototype.drawRect=function(t,e,n,r){return this.drawShape(new Je(t,e,n,r))},n.prototype.drawRoundedRect=function(t,e,n,r,i){return this.drawShape(new nn(t,e,n,r,i))},n.prototype.drawCircle=function(t,e,n){return this.drawShape(new Qe(t,e,n))},n.prototype.drawEllipse=function(t,e,n,r){return this.drawShape(new tn(t,e,n,r))},n.prototype.drawPolygon=function(){for(var t,e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];var i=!0,a=n[0];a.points?(i=a.closeStroke,t=a.points):t=Array.isArray(n[0])?n[0]:n;var o=new en(t);return o.closeStroke=i,this.drawShape(o),this},n.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},n.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},n.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return!(1!==e.length||e[0].shape.type!==t.SHAPES.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)},n.prototype._render=function(t){this.finishPoly();var e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},n.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var r=0;r<n;r++){var i=t.batches[r],a=i.style.color,o=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),s=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),u={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:s,_batchRGB:ge(a),_tintRGB:a,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=u}},n.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},n.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,r=this.tint,i=this.worldAlpha,a=e.uniforms,o=n.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(r>>16&255)/255*i,a.tint[1]=(r>>8&255)/255*i,a.tint[2]=(255&r)/255*i,a.tint[3]=i,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var s=0,u=o.length;s<u;s++)this._renderDrawCallDirect(t,n.drawCalls[s])},n.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,r=e.type,i=e.size,a=e.start,o=n.count,s=0;s<o;s++)t.texture.bind(n.elements[s],s);t.geometry.draw(r,i,a)},n.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!xs[n]){for(var r=t.plugins[n].MAX_TEXTURES,i=new Int32Array(r),a=0;a<r;a++)i[a]=a;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new an,default:gr.from({uSamplers:i},!0)},s=t.plugins[n]._shader.program;xs[n]=new ei(s,o)}e=xs[n]}return e},n.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,r=e.minY,i=e.maxX,a=e.maxY;this._bounds.addFrame(this.transform,n,r,i,a)}},n.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,n._TEMP_POINT),this._geometry.containsPoint(n._TEMP_POINT)},n.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=ge(this.tint,bs),e=0;e<this.batches.length;e++){var n=this.batches[e],r=n._batchRGB,i=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);n._tintRGB=(i>>16)+(65280&i)+((255&i)<<16)}}},n.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,a=e.d,o=e.tx,s=e.ty,u=this._geometry.points,c=this.vertexData,l=0,h=0;h<u.length;h+=2){var p=u[h],f=u[h+1];c[l++]=n*p+i*f+o,c[l++]=a*f+r*p+s}}},n.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},n.prototype.setMatrix=function(t){return this._matrix=t,this},n.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},n.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},n.prototype.destroy=function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,e.prototype.destroy.call(this,t)},n.nextRoundedRectBehavior=!1,n._TEMP_POINT=new Ze,n}(wn),_s={buildPoly:Jo,buildCircle:Qo,buildRectangle:ts,buildRoundedRectangle:rs,buildLine:os,ArcUtils:us,BezierUtils:cs,QuadraticUtils:ls,BatchPart:hs,FILL_COMMANDS:ps,BATCH_POOL:fs,DRAW_CALL_POOL:ds},Ss=function(t,e){return Ss=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Ss(t,e)};var Ts,Es=new Ze,ks=new Uint16Array([0,1,2,0,2,3]),Is=function(e){function n(n){var r=e.call(this)||this;return r._anchor=new rn(r._onAnchorUpdate,r,n?n.defaultAnchor.x:0,n?n.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=t.BLEND_MODES.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=n||nr.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=ks,r.pluginName="batch",r.isSprite=!0,r._roundPixels=it.ROUND_PIXELS,r}return function(t,e){function n(){this.constructor=t}Ss(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,e),n.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Re(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Re(this.scale.y)*this._height/this._texture.orig.height)},n.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},n.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,a=e.d,o=e.tx,s=e.ty,u=this.vertexData,c=t.trim,l=t.orig,h=this._anchor,p=0,f=0,d=0,m=0;if(c?(p=(f=c.x-h._x*l.width)+c.width,d=(m=c.y-h._y*l.height)+c.height):(p=(f=-h._x*l.width)+l.width,d=(m=-h._y*l.height)+l.height),u[0]=n*f+i*m+o,u[1]=a*m+r*f+s,u[2]=n*p+i*m+o,u[3]=a*m+r*p+s,u[4]=n*p+i*d+o,u[5]=a*d+r*p+s,u[6]=n*f+i*d+o,u[7]=a*d+r*f+s,this._roundPixels)for(var g=it.RESOLUTION,v=0;v<u.length;++v)u[v]=Math.round((u[v]*g|0)/g)}},n.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,i=this.transform.worldTransform,a=i.a,o=i.b,s=i.c,u=i.d,c=i.tx,l=i.ty,h=-r._x*n.width,p=h+n.width,f=-r._y*n.height,d=f+n.height;e[0]=a*h+s*f+c,e[1]=u*f+o*h+l,e[2]=a*p+s*f+c,e[3]=u*f+o*p+l,e[4]=a*p+s*d+c,e[5]=u*d+o*p+l,e[6]=a*h+s*d+c,e[7]=u*d+o*h+l},n.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},n.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},n.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new mn),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Je),t=this._localBoundsRect),this._localBounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Es);var e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x,i=0;return Es.x>=r&&Es.x<r+e&&(i=-n*this.anchor.y,Es.y>=i&&Es.y<i+n)},n.prototype.destroy=function(t){if(e.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t&&t.texture){var n="boolean"==typeof t?t:t&&t.baseTexture;this._texture.destroy(!!n)}this._texture=null},n.from=function(t,e){return new n(t instanceof nr?t:nr.from(t,e))},Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=Re(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=Re(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||nr.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),n}(wn),As=function(t,e){return As=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},As(t,e)};t.TEXT_GRADIENT=void 0,(Ts=t.TEXT_GRADIENT||(t.TEXT_GRADIENT={}))[Ts.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",Ts[Ts.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL";var Ns={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:t.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Cs=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Rs=function(){function t(t){this.styleID=0,this.reset(),Ms(this,t,t)}return t.prototype.clone=function(){var e={};return Ms(e,this,Ns),new t(e)},t.prototype.reset=function(){Ms(this,Ns,Ns)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Ds(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Ds(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Ds(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Cs.indexOf(r)<0&&(r='"'+r+'"'),e[n]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function Os(t){return"number"==typeof t?ve(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Ds(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=Os(t[e]);return t}return Os(t)}function Ms(t,e,n){for(var r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}var Fs={willReadFrequently:!0},Ps=function(){function t(t,e,n,r,i,a,o,s,u){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=s,this.fontProperties=u}return t.measureText=function(e,n,r,i){void 0===i&&(i=t._canvas),r=r??n.wordWrap;var a=n.toFontString(),o=t.measureFont(a);0===o.fontSize&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);var s=i.getContext("2d",Fs);s.font=a;for(var u=(r?t.wordWrap(e,n,i):e).split(/(?:\r\n|\r|\n)/),c=new Array(u.length),l=0,h=0;h<u.length;h++){var p=s.measureText(u[h]).width+(u[h].length-1)*n.letterSpacing;c[h]=p,l=Math.max(l,p)}var f=l+n.strokeThickness;n.dropShadow&&(f+=n.dropShadowDistance);var d=n.lineHeight||o.fontSize+n.strokeThickness,m=Math.max(d,o.fontSize+n.strokeThickness)+(u.length-1)*(d+n.leading);return n.dropShadow&&(m+=n.dropShadowDistance),new t(e,n,f,m,u,c,d+n.leading,l,o)},t.wordWrap=function(e,n,r){void 0===r&&(r=t._canvas);for(var i=r.getContext("2d",Fs),a=0,o="",s="",u=Object.create(null),c=n.letterSpacing,l=n.whiteSpace,h=t.collapseSpaces(l),p=t.collapseNewlines(l),f=!h,d=n.wordWrapWidth+c,m=t.tokenize(e),g=0;g<m.length;g++){var v=m[g];if(t.isNewline(v)){if(!p){s+=t.addLine(o),f=!h,o="",a=0;continue}v=" "}if(h){var y=t.isBreakingSpace(v),b=t.isBreakingSpace(o[o.length-1]);if(y&&b)continue}var x=t.getFromCache(v,c,u,i);if(x>d)if(""!==o&&(s+=t.addLine(o),o="",a=0),t.canBreakWords(v,n.breakWords))for(var w=t.wordWrapSplit(v),_=0;_<w.length;_++){for(var S=w[_],T=1;w[_+T];){var E=w[_+T],k=S[S.length-1];if(t.canBreakChars(k,E,v,_,n.breakWords))break;S+=E,T++}_+=S.length-1;var I=t.getFromCache(S,c,u,i);I+a>d&&(s+=t.addLine(o),f=!1,o="",a=0),o+=S,a+=I}else{o.length>0&&(s+=t.addLine(o),o="",a=0);var A=g===m.length-1;s+=t.addLine(v,!A),f=!1,o="",a=0}else x+a>d&&(f=!1,s+=t.addLine(o),o="",a=0),(o.length>0||!t.isBreakingSpace(v)||f)&&(o+=v,a+=x)}return s+=t.addLine(o,!1)},t.addLine=function(e,n){return void 0===n&&(n=!0),e=t.trimRight(e),e=n?e+"\n":e},t.getFromCache=function(t,e,n,r){var i=n[t];if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n[t]=i}return i},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var n=e.length-1;n>=0;n--){var r=e[n];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e,n){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var n=[],r="";if("string"!=typeof e)return n;for(var i=0;i<e.length;i++){var a=e[i],o=e[i+1];t.isBreakingSpace(a,o)||t.isNewline(a)?(""!==r&&(n.push(r),r=""),n.push(a)):r+=a}return""!==r&&n.push(r),n},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,n,r,i){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},r=t._canvas,i=t._context;i.font=e;var a=t.METRICS_STRING+t.BASELINE_SYMBOL,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width),u=Math.ceil(t.HEIGHT_MULTIPLIER*s);s=s*t.BASELINE_MULTIPLIER|0,r.width=o,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,o,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var c=i.getImageData(0,0,o,u).data,l=c.length,h=4*o,p=0,f=0,d=!1;for(p=0;p<s;++p){for(var m=0;m<h;m+=4)if(255!==c[f+m]){d=!0;break}if(d)break;f+=h}for(n.ascent=s-p,f=l-h,d=!1,p=u;p>s;--p){for(m=0;m<h;m+=4)if(255!==c[f+m]){d=!0;break}if(d)break;f-=h}return n.descent=p-s,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},Object.defineProperty(t,"_canvas",{get:function(){if(!t.__canvas){var e=void 0;try{var n=new OffscreenCanvas(0,0),r=n.getContext("2d",Fs);if(r&&r.measureText)return t.__canvas=n,n;e=it.ADAPTER.createCanvas()}catch(t){e=it.ADAPTER.createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_context",{get:function(){return t.__context||(t.__context=t._canvas.getContext("2d",Fs)),t.__context},enumerable:!1,configurable:!0}),t}();Ps._fonts={},Ps.METRICS_STRING="|q",Ps.BASELINE_SYMBOL="M",Ps.BASELINE_MULTIPLIER=1.4,Ps.HEIGHT_MULTIPLIER=2,Ps._newlines=[10,13],Ps._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Ls={texture:!0,children:!1,baseTexture:!0},Bs=function(e){function n(t,n,r){var i=this,a=!1;r||(r=it.ADAPTER.createCanvas(),a=!0),r.width=3,r.height=3;var o=nr.from(r);return o.orig=new Je,o.trim=new Je,(i=e.call(this,o)||this)._ownCanvas=a,i.canvas=r,i.context=r.getContext("2d",{willReadFrequently:!0}),i._resolution=it.RESOLUTION,i._autoResolution=!0,i._text=null,i._style=null,i._styleListener=null,i._font="",i.text=t,i.style=n,i.localStyleID=-1,i}return function(t,e){function n(){this.constructor=t}As(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,e),n.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var r,i,a=this.context,o=Ps.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=o.width,u=o.height,c=o.lines,l=o.lineHeight,h=o.lineWidths,p=o.maxLineWidth,f=o.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,u)+2*e.padding)*this._resolution),a.scale(this._resolution,this._resolution),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.font=this._font,a.lineWidth=e.strokeThickness,a.textBaseline=e.textBaseline,a.lineJoin=e.lineJoin,a.miterLimit=e.miterLimit;for(var d=e.dropShadow?2:1,m=0;m<d;++m){var g=e.dropShadow&&0===m,v=g?Math.ceil(Math.max(1,u)+2*e.padding):0,y=v*this._resolution;if(g){a.fillStyle="black",a.strokeStyle="black";var b=e.dropShadowColor,x=ge("number"==typeof b?b:ye(b)),w=e.dropShadowBlur*this._resolution,_=e.dropShadowDistance*this._resolution;a.shadowColor="rgba("+255*x[0]+","+255*x[1]+","+255*x[2]+","+e.dropShadowAlpha+")",a.shadowBlur=w,a.shadowOffsetX=Math.cos(e.dropShadowAngle)*_,a.shadowOffsetY=Math.sin(e.dropShadowAngle)*_+y}else a.fillStyle=this._generateFillStyle(e,c,o),a.strokeStyle=e.stroke,a.shadowColor="black",a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0;var S=(l-f.fontSize)/2;(!n.nextLineHeightBehavior||l-f.fontSize<0)&&(S=0);for(var T=0;T<c.length;T++)r=e.strokeThickness/2,i=e.strokeThickness/2+T*l+f.ascent+S,"right"===e.align?r+=p-h[T]:"center"===e.align&&(r+=(p-h[T])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(c[T],r+e.padding,i+e.padding-v,!0),e.fill&&this.drawLetterSpacing(c[T],r+e.padding,i+e.padding-v)}this.updateTexture()}},n.prototype.drawLetterSpacing=function(t,e,r,i){void 0===i&&(i=!1);var a=this._style.letterSpacing,o=n.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===a||o)return o&&(this.context.letterSpacing=a,this.context.textLetterSpacing=a),void(i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r));for(var s=e,u=Array.from?Array.from(t):t.split(""),c=this.context.measureText(t).width,l=0,h=0;h<u.length;++h){var p=u[h];i?this.context.strokeText(p,s,r):this.context.fillText(p,s,r);for(var f="",d=h+1;d<u.length;++d)f+=u[d];s+=c-(l=this.context.measureText(f).width)+a,c=l}},n.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=Ue(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,r=this._style,i=r.trim?0:r.padding,a=n.baseTexture;n.trim.width=n._frame.width=t.width/this._resolution,n.trim.height=n._frame.height=t.height/this._resolution,n.trim.x=-i,n.trim.y=-i,n.orig.width=n._frame.width-2*i,n.orig.height=n._frame.height-2*i,this._onTextureUpdate(),a.setRealSize(t.width,t.height,this._resolution),n.updateUvs(),this.dirty=!1},n.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype._render.call(this,t)},n.prototype.updateTransform=function(){this.updateText(!0),e.prototype.updateTransform.call(this)},n.prototype.getBounds=function(t,n){return this.updateText(!0),-1===this._textureID&&(t=!1),e.prototype.getBounds.call(this,t,n)},n.prototype.getLocalBounds=function(t){return this.updateText(!0),e.prototype.getLocalBounds.call(this,t)},n.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},n.prototype._generateFillStyle=function(e,n,r){var i,a=e.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var o=e.dropShadow?e.dropShadowDistance:0,s=e.padding||0,u=this.canvas.width/this._resolution-o-2*s,c=this.canvas.height/this._resolution-o-2*s,l=a.slice(),h=e.fillGradientStops.slice();if(!h.length)for(var p=l.length+1,f=1;f<p;++f)h.push(f/p);if(l.unshift(a[0]),h.unshift(0),l.push(a[a.length-1]),h.push(1),e.fillGradientType===t.TEXT_GRADIENT.LINEAR_VERTICAL){i=this.context.createLinearGradient(u/2,s,u/2,c+s);var d=r.fontProperties.fontSize+e.strokeThickness;for(f=0;f<n.length;f++){var m=r.lineHeight*(f-1)+d,g=r.lineHeight*f,v=g;f>0&&m>g&&(v=(g+m)/2);var y=g+d,b=r.lineHeight*(f+1),x=y;f+1<n.length&&b<y&&(x=(y+b)/2);for(var w=(x-v)/c,_=0;_<l.length;_++){var S=0;S="number"==typeof h[_]?h[_]:_/l.length;var T=Math.min(1,Math.max(0,v/c+S*w));T=Number(T.toFixed(5)),i.addColorStop(T,l[_])}}}else{i=this.context.createLinearGradient(s,c/2,u+s,c/2);var E=l.length+1,k=1;for(f=0;f<l.length;f++){var I=void 0;I="number"==typeof h[f]?h[f]:k/E,i.addColorStop(I,l[f]),k++}}return i},n.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Ls,t),e.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=Re(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=Re(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof Rs?t:new Rs(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),n.nextLineHeightBehavior=!1,n.experimentalLetterSpacing=!1,n}(Is);it.UPLOADS_PER_FRAME=4;var zs=function(t,e){return zs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},zs(t,e)};var Us=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function Gs(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof nr){var i=t._textures[r].baseTexture;-1===e.indexOf(i)&&(e.push(i),n=!0)}return n}function Ws(t,e){if(t.baseTexture instanceof zn){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Vs(t,e){if(t._texture&&t._texture instanceof nr){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function js(t,e){return e instanceof Bs&&(e.updateText(!0),!0)}function Hs(t,e){if(e instanceof Rs){var n=e.toFontString();return Ps.measureFont(n),!0}return!1}function Xs(t,e){if(t instanceof Bs){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function qs(t,e){return t instanceof Rs&&(-1===e.indexOf(t)&&e.push(t),!0)}var Ks=function(){function e(t){var e=this;this.limiter=new Us(it.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(Xs),this.registerFindHook(qs),this.registerFindHook(Gs),this.registerFindHook(Ws),this.registerFindHook(Vs),this.registerUploadHook(js),this.registerUploadHook(Hs)}return e.prototype.upload=function(e,n){var r=this;return"function"==typeof e&&(n=e,e=null),n&&Fe("6.5.0","BasePrepare.upload callback is deprecated, use the return Promise instead."),new Promise((function(i){e&&r.add(e);var a=function(){null==n||n(),i()};r.queue.length?(r.completes.push(a),r.ticking||(r.ticking=!0,Nn.system.addOnce(r.tick,r,t.UPDATE_PRIORITY.UTILITY))):a()}))},e.prototype.tick=function(){setTimeout(this.delayedTick,0)},e.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],n=!1;if(e&&!e._destroyed)for(var r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),n=!0;break}n||this.queue.shift()}if(this.queue.length)Nn.system.addOnce(this.tick,this,t.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var a=this.completes.slice(0);this.completes.length=0;for(r=0,i=a.length;r<i;r++)a[r]()}},e.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},e.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},e.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof wn)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},e.prototype.destroy=function(){this.ticking&&Nn.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},e}();function Ys(t,e){return e instanceof zn&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function Zs(t,e){if(!(e instanceof ws))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var r=n.batches,i=0;i<r.length;i++){var a=r[i].style.texture;a&&Ys(t,a.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function $s(t,e){return t instanceof ws&&(e.push(t),!0)}var Js=function(e){function n(t){var n=e.call(this,t)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook($s),n.registerUploadHook(Ys),n.registerUploadHook(Zs),n}return function(t,e){function n(){this.constructor=t}zs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,e),n.extension={name:"prepare",type:t.ExtensionType.RendererPlugin},n}(Ks),Qs=function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}(),tu=function(){function t(t,e,n){void 0===n&&(n=null),this.linkedSheets=[],this._texture=t instanceof nr?t:null,this.baseTexture=t instanceof zn?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var r=this.baseTexture.resource;this.resolution=this._updateResolution(n||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,n=je(t,null);return null===n&&(n=void 0!==e?parseFloat(e):1),1!==n&&this.baseTexture.setResolution(n),n},t.prototype.parse=function(e){var n=this;return e&&Fe("6.5.0","Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise((function(r){n._callback=function(t){null==e||e(t),r(t)},n._batchIndex=0,n._frameKeys.length<=t.BATCH_SIZE?(n._processFrames(0),n._processAnimations(),n._parseComplete()):n._nextBatch()}))},t.prototype._processFrames=function(e){for(var n=e,r=t.BATCH_SIZE;n-e<r&&n<this._frameKeys.length;){var i=this._frameKeys[n],a=this._frames[i],o=a.frame;if(o){var s=null,u=null,c=!1!==a.trimmed&&a.sourceSize?a.sourceSize:a.frame,l=new Je(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s=a.rotated?new Je(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new Je(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==a.trimmed&&a.spriteSourceSize&&(u=new Je(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new nr(this.baseTexture,s,l,u,a.rotated?2:0,a.anchor),nr.addToCache(this.textures[i],i)}n++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var r=t[e][n];this.animations[e].push(this.textures[r])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var n in void 0===t&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},t.BATCH_SIZE=1e3,t}(),eu=function(){function e(){}return e.use=function(n,r){var i,a,o=this,s=n.name+"_image";if(n.data&&n.type===t.LoaderResource.TYPE.JSON&&n.data.frames&&!o.resources[s]){var u=null===(a=null===(i=n.data)||void 0===i?void 0:i.meta)||void 0===a?void 0:a.related_multi_packs;if(Array.isArray(u))for(var c=function(e){if("string"!=typeof e)return"continue";var r=e.replace(".json",""),i=oe.resolve(n.url.replace(o.baseUrl,""),e);if(o.resources[r]||Object.values(o.resources).some((function(t){return oe.format(oe.parse(t.url))===i})))return"continue";var a={crossOrigin:n.crossOrigin,loadType:t.LoaderResource.LOAD_TYPE.XHR,xhrType:t.LoaderResource.XHR_RESPONSE_TYPE.JSON,parentResource:n,metadata:n.metadata};o.add(r,i,a)},l=0,h=u;l<h.length;l++){c(h[l])}var p={crossOrigin:n.crossOrigin,metadata:n.metadata.imageMetadata,parentResource:n},f=e.getResourcePath(n,o.baseUrl);o.add(s,f,p,(function(t){if(t.error)r(t.error);else{var e=new tu(t.texture,n.data,n.url);e.parse().then((function(){n.spritesheet=e,n.textures=e.textures,r()}))}}))}else r()},e.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:oe.resolve(t.url.replace(e,""),t.data.meta.image)},e.extension=t.ExtensionType.Loader,e}(),nu=function(t,e){return nu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},nu(t,e)};function ru(t,e){function n(){this.constructor=t}nu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var iu=new Ze,au=function(t){function e(e,n,r){void 0===n&&(n=100),void 0===r&&(r=100);var i=t.call(this,e)||this;return i.tileTransform=new dn,i._width=n,i._height=r,i.uvMatrix=i.texture.uvMatrix||new ai(e),i.pluginName="tilingSprite",i.uvRespectAnchor=!1,i}return ru(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,r)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Je),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,iu);var e=this._width,n=this._height,r=-e*this.anchor._x;if(iu.x>=r&&iu.x<r+e){var i=-n*this.anchor._y;if(iu.y>=i&&iu.y<i+n)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,n){return new e(t instanceof nr?t:nr.from(t,n),n.width,n.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(Is),ou="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",su=new an,uu=function(e){function n(t){var n=e.call(this,t)||this;return t.runners.contextChange.add(n),n.quad=new dr,n.state=ni.for2d(),n}return ru(n,e),n.prototype.contextChange=function(){var t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=ei.from(ou,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?ei.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):ei.from(ou,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)},n.prototype.render=function(e){var n=this.renderer,r=this.quad,i=r.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);var a=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;(i=r.uvs)[0]=i[6]=-a,i[1]=i[3]=-o,i[2]=i[4]=1-a,i[5]=i[7]=1-o,r.invalidate();var s=e._texture,u=s.baseTexture,c=u.alphaMode>0,l=e.tileTransform.localTransform,h=e.uvMatrix,p=u.isPowerOfTwo&&s.frame.width===u.width&&s.frame.height===u.height;p&&(u._glTextures[n.CONTEXT_UID]?p=u.wrapMode!==t.WRAP_MODES.CLAMP:u.wrapMode===t.WRAP_MODES.CLAMP&&(u.wrapMode=t.WRAP_MODES.REPEAT));var f=p?this.simpleShader:this.shader,d=s.width,m=s.height,g=e._width,v=e._height;su.set(l.a*d/g,l.b*d/v,l.c*m/g,l.d*m/v,l.tx/g,l.ty/v),su.invert(),p?su.prepend(h.mapCoord):(f.uniforms.uMapCoord=h.mapCoord.toArray(!0),f.uniforms.uClampFrame=h.uClampFrame,f.uniforms.uClampOffset=h.uClampOffset),f.uniforms.uTransform=su.toArray(!0),f.uniforms.uColor=Se(e.tint,e.worldAlpha,f.uniforms.uColor,c),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=s,n.shader.bind(f),n.geometry.bind(r),this.state.blendMode=xe(e.blendMode,c),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},n.extension={name:"tilingSprite",type:t.ExtensionType.RendererPlugin},n}(wr),cu=function(t,e){return cu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},cu(t,e)};function lu(t,e){function n(){this.constructor=t}cu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var hu=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),pu=new Ze,fu=new en,du=function(e){function n(n,r,i,a){void 0===a&&(a=t.DRAW_MODES.TRIANGLES);var o=e.call(this)||this;return o.geometry=n,o.shader=r,o.state=i||ni.for2d(),o.drawMode=a,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=-1,o._transformID=-1,o._roundPixels=it.ROUND_PIXELS,o.batchUvs=null,o}return lu(n,e),Object.defineProperty(n.prototype,"geometry",{get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),n.prototype._render=function(e){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===t.DRAW_MODES.TRIANGLES&&r.length<2*n.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)},n.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},n.prototype._renderToBatch=function(t){var e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},n.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,i=r.a,a=r.b,o=r.c,s=r.d,u=r.tx,c=r.ty,l=this.vertexData,h=0;h<l.length/2;h++){var p=e[2*h],f=e[2*h+1];l[2*h]=i*p+o*f+u,l[2*h+1]=a*p+s*f+c}if(this._roundPixels){var d=it.RESOLUTION;for(h=0;h<l.length;++h)l[h]=Math.round((l[h]*d|0)/d)}this.vertexDirty=n}},n.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new hu(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},n.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},n.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,pu);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=fu.points,r=this.geometry.getIndex().data,i=r.length,a=4===this.drawMode?3:1,o=0;o+2<i;o+=a){var s=2*r[o],u=2*r[o+1],c=2*r[o+2];if(n[0]=e[s],n[1]=e[s+1],n[2]=e[u],n[3]=e[u+1],n[4]=e[c],n[5]=e[c+1],fu.contains(pu.x,pu.y))return!0}return!1},n.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},n.BATCHABLE_SIZE=100,n}(wn),mu=function(t){function e(e,n){var r=this,i={uSampler:e,alpha:1,uTextureMatrix:an.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(i,n.uniforms),(r=t.call(this,n.program||ti.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i)||this)._colorDirty=!1,r.uvMatrix=new ai(e),r.batchable=void 0===n.program,r.pluginName=n.pluginName,r.tint=n.tint,r.alpha=n.alpha,r}return lu(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;Se(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(ei),gu=function(e){function n(n,r,i){var a=e.call(this)||this,o=new sr(n),s=new sr(r,!0),u=new sr(i,!0,!0);return a.addAttribute("aVertexPosition",o,2,!1,t.TYPES.FLOAT).addAttribute("aTextureCoord",s,2,!1,t.TYPES.FLOAT).addIndex(u),a._updateId=-1,a}return lu(n,e),Object.defineProperty(n.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),n}(pr),vu=function(t,e){return vu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},vu(t,e)};var yu=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]},bu=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in e){var i=e[r].match(/^[a-z]+/gm)[0],a=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var s in a){var u=a[s].split("="),c=u[0],l=u[1].replace(/"/gm,""),h=parseFloat(l),p=isNaN(h)?l:h;o[c]=p}n[i].push(o)}var f=new yu;return n.info.forEach((function(t){return f.info.push({face:t.face,size:parseInt(t.size,10)})})),n.common.forEach((function(t){return f.common.push({lineHeight:parseInt(t.lineHeight,10)})})),n.page.forEach((function(t){return f.page.push({id:parseInt(t.id,10),file:t.file})})),n.char.forEach((function(t){return f.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),n.kerning.forEach((function(t){return f.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),n.distanceField.forEach((function(t){return f.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType})})),f},t}(),xu=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new yu,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),s=t.getElementsByTagName("distanceField"),u=0;u<n.length;u++)e.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(u=0;u<r.length;u++)e.common.push({lineHeight:parseInt(r[u].getAttribute("lineHeight"),10)});for(u=0;u<i.length;u++)e.page.push({id:parseInt(i[u].getAttribute("id"),10)||0,file:i[u].getAttribute("file")});for(u=0;u<a.length;u++){var c=a[u];e.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(u=0;u<o.length;u++)e.kerning.push({first:parseInt(o[u].getAttribute("first"),10),second:parseInt(o[u].getAttribute("second"),10),amount:parseInt(o[u].getAttribute("amount"),10)});for(u=0;u<s.length;u++)e.distanceField.push({fieldType:s[u].getAttribute("fieldType"),distanceRange:parseInt(s[u].getAttribute("distanceRange"),10)});return e},t}(),wu=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return xu.test(e)}return!1},t.parse=function(t){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return xu.parse(e)},t}(),_u=[bu,xu,wu];function Su(t){for(var e=0;e<_u.length;e++)if(_u[e].test(t))return _u[e];return null}function Tu(e,n,r,i,a,o,s){var u=r.text,c=r.fontProperties;n.translate(i,a),n.scale(o,o);var l=s.strokeThickness/2,h=-s.strokeThickness/2;if(n.font=s.toFontString(),n.lineWidth=s.strokeThickness,n.textBaseline=s.textBaseline,n.lineJoin=s.lineJoin,n.miterLimit=s.miterLimit,n.fillStyle=function(e,n,r,i,a,o){var s,u=r.fill;if(!Array.isArray(u))return u;if(1===u.length)return u[0];var c=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,h=e.width/i-c-2*l,p=e.height/i-c-2*l,f=u.slice(),d=r.fillGradientStops.slice();if(!d.length)for(var m=f.length+1,g=1;g<m;++g)d.push(g/m);if(f.unshift(u[0]),d.unshift(0),f.push(u[u.length-1]),d.push(1),r.fillGradientType===t.TEXT_GRADIENT.LINEAR_VERTICAL){s=n.createLinearGradient(h/2,l,h/2,p+l);var v=0,y=(o.fontProperties.fontSize+r.strokeThickness)/p;for(g=0;g<a.length;g++)for(var b=o.lineHeight*g,x=0;x<f.length;x++){var w=b/p+("number"==typeof d[x]?d[x]:x/f.length)*y,_=Math.max(v,w);_=Math.min(_,1),s.addColorStop(_,f[x]),v=_}}else{s=n.createLinearGradient(l,p/2,h+l,p/2);var S=f.length+1,T=1;for(g=0;g<f.length;g++){var E=void 0;E="number"==typeof d[g]?d[g]:T/S,s.addColorStop(E,f[g]),T++}}return s}(e,n,s,o,[u],r),n.strokeStyle=s.stroke,s.dropShadow){var p=s.dropShadowColor,f=ge("number"==typeof p?p:ye(p)),d=s.dropShadowBlur*o,m=s.dropShadowDistance*o;n.shadowColor="rgba("+255*f[0]+","+255*f[1]+","+255*f[2]+","+s.dropShadowAlpha+")",n.shadowBlur=d,n.shadowOffsetX=Math.cos(s.dropShadowAngle)*m,n.shadowOffsetY=Math.sin(s.dropShadowAngle)*m}else n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;s.stroke&&s.strokeThickness&&n.strokeText(u,l,h+r.lineHeight-c.descent),s.fill&&n.fillText(u,l,h+r.lineHeight-c.descent),n.setTransform(1,0,0,1,0,0),n.fillStyle="rgba(0, 0, 0, 0)"}function Eu(t){return Array.from?Array.from(t):t.split("")}function ku(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}var Iu=function(){function e(e,n,r){var i,a,o=e.info[0],s=e.common[0],u=e.page[0],c=e.distanceField[0],l=je(u.file),h={};this._ownsTextures=r,this.font=o.face,this.size=o.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=h;for(var p=0;p<e.page.length;p++){var f=e.page[p],d=f.id,m=f.file;h[d]=n instanceof Array?n[p]:n[m],(null==c?void 0:c.fieldType)&&"none"!==c.fieldType&&(h[d].baseTexture.alphaMode=t.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,h[d].baseTexture.mipmap=t.MIPMAP_MODES.OFF)}for(p=0;p<e.char.length;p++){var g=e.char[p],v=(d=g.id,g.page),y=e.char[p],b=y.x,x=y.y,w=y.width,_=y.height,S=y.xoffset,T=y.yoffset,E=y.xadvance;x/=l,w/=l,_/=l,S/=l,T/=l,E/=l;var k=new Je((b/=l)+h[v].frame.x/l,x+h[v].frame.y/l,w,_);this.chars[d]={xOffset:S,yOffset:T,xAdvance:E,kerning:{},texture:new nr(h[v].baseTexture,k),page:v}}for(p=0;p<e.kerning.length;p++){var I=e.kerning[p],A=I.first,N=I.second,C=I.amount;A/=l,N/=l,C/=l,this.chars[N]&&(this.chars[N].kerning[A]=C)}this.distanceFieldRange=null==c?void 0:c.distanceRange,this.distanceFieldType=null!==(a=null===(i=null==c?void 0:c.fieldType)||void 0===i?void 0:i.toLowerCase())&&void 0!==a?a:"none"}return e.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},e.install=function(t,n,r){var i;if(t instanceof yu)i=t;else{var a=Su(t);if(!a)throw new Error("Unrecognized data format for font.");i=a.parse(t)}n instanceof nr&&(n=[n]);var o=new e(i,n,r);return e.available[o.font]=o,o},e.uninstall=function(t){var n=e.available[t];if(!n)throw new Error("No font found named '"+t+"'");n.destroy(),delete e.available[t]},e.from=function(t,n,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},e.defaultOptions,r),a=i.chars,o=i.padding,s=i.resolution,u=i.textureWidth,c=i.textureHeight,l=function(t){"string"==typeof t&&(t=[t]);for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+i.length+".");var a=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<a)throw new Error("[BitmapFont]: Invalid character range.");for(var s=a,u=o;s<=u;s++)e.push(String.fromCharCode(s))}else e.push.apply(e,Eu(i))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(a),h=n instanceof Rs?n:new Rs(n),p=u,f=new yu;f.info[0]={face:h.fontFamily,size:h.fontSize},f.common[0]={lineHeight:h.fontSize};for(var d,m,g,v=0,y=0,b=0,x=[],w=0;w<l.length;w++){d||((d=it.ADAPTER.createCanvas()).width=u,d.height=c,m=d.getContext("2d"),g=new zn(d,{resolution:s}),x.push(new nr(g)),f.page.push({id:x.length-1,file:""}));var _=l[w],S=Ps.measureText(_,h,!1,d),T=S.width,E=Math.ceil(S.height),k=Math.ceil(("italic"===h.fontStyle?2:1)*T);if(y>=c-E*s){if(0===y)throw new Error("[BitmapFont] textureHeight "+c+"px is too small (fontFamily: '"+h.fontFamily+"', fontSize: "+h.fontSize+"px, char: '"+_+"')");--w,d=null,m=null,g=null,y=0,v=0,b=0}else if(b=Math.max(E+S.fontProperties.descent,b),k*s+v>=p){if(0===v)throw new Error("[BitmapFont] textureWidth "+u+"px is too small (fontFamily: '"+h.fontFamily+"', fontSize: "+h.fontSize+"px, char: '"+_+"')");--w,y+=b*s,y=Math.ceil(y),v=0,b=0}else{Tu(d,m,S,v,y,s,h);var I=ku(S.text);f.char.push({id:I,page:x.length-1,x:v/s,y:y/s,width:k,height:E,xoffset:0,yoffset:0,xadvance:Math.ceil(T-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0))}),v+=(k+2*o)*s,v=Math.ceil(v)}}if(!(null==r?void 0:r.skipKerning)){w=0;for(var A=l.length;w<A;w++)for(var N=l[w],C=0;C<A;C++){var R=l[C],O=m.measureText(N).width,D=m.measureText(R).width,M=m.measureText(N+R).width-(O+D);M&&f.kerning.push({first:ku(N),second:ku(R),amount:M})}}var F=new e(f,x,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=F,F},e.ALPHA=[["a","z"],["A","Z"]," "],e.NUMERIC=[["0","9"]],e.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],e.ASCII=[[" ","~"]],e.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:e.ALPHANUMERIC},e.available={},e}(),Au=[],Nu=[],Cu=[],Ru=function(e){function n(t,r){void 0===r&&(r={});var i=e.call(this)||this;i._tint=16777215;var a=Object.assign({},n.styleDefaults,r),o=a.align,s=a.tint,u=a.maxWidth,c=a.letterSpacing,l=a.fontName,h=a.fontSize;if(!Iu.available[l])throw new Error('Missing BitmapFont "'+l+'"');return i._activePagesMeshData=[],i._textWidth=0,i._textHeight=0,i._align=o,i._tint=s,i._font=void 0,i._fontName=l,i._fontSize=h,i.text=t,i._maxWidth=u,i._maxLineHeight=0,i._letterSpacing=c,i._anchor=new rn((function(){i.dirty=!0}),i,0,0),i._roundPixels=it.ROUND_PIXELS,i.dirty=!0,i._resolution=it.RESOLUTION,i._autoResolution=!0,i._textureCache={},i}return function(t,e){function n(){this.constructor=t}vu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,e),n.prototype.updateText=function(){for(var e,n=Iu.available[this._fontName],r=this.fontSize,i=r/n.size,a=new Ze,o=[],s=[],u=[],c=Eu(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),l=this._maxWidth*n.size/r,h="none"===n.distanceFieldType?Au:Nu,p=null,f=0,d=0,m=0,g=-1,v=0,y=0,b=0,x=0,w=0;w<c.length;w++){var _=ku(W=c[w]);if(/(?:\s)/.test(W)&&(g=w,v=f,x++),"\r"!==W&&"\n"!==W){var S=n.chars[_];if(S){p&&S.kerning[p]&&(a.x+=S.kerning[p]);var T=Cu.pop()||{texture:nr.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ze};T.texture=S.texture,T.line=m,T.charCode=_,T.position.x=a.x+S.xOffset+this._letterSpacing/2,T.position.y=a.y+S.yOffset,T.prevSpaces=x,o.push(T),f=T.position.x+Math.max(S.xAdvance-S.xOffset,S.texture.orig.width),a.x+=S.xAdvance+this._letterSpacing,b=Math.max(b,S.yOffset+S.texture.height),p=_,-1!==g&&l>0&&a.x>l&&(Ce(o,1+g-++y,1+w-g),w=g,g=-1,s.push(v),u.push(o.length>0?o[o.length-1].prevSpaces:0),d=Math.max(d,v),m++,a.x=0,a.y+=n.lineHeight,p=null,x=0)}}else s.push(f),u.push(-1),d=Math.max(d,f),++m,++y,a.x=0,a.y+=n.lineHeight,p=null,x=0}var E=c[c.length-1];"\r"!==E&&"\n"!==E&&(/(?:\s)/.test(E)&&(f=v),s.push(f),d=Math.max(d,f),u.push(-1));var k=[];for(w=0;w<=m;w++){var I=0;"right"===this._align?I=d-s[w]:"center"===this._align?I=(d-s[w])/2:"justify"===this._align&&(I=u[w]<0?0:(d-s[w])/u[w]),k.push(I)}var A=o.length,N={},C=[],R=this._activePagesMeshData;h.push.apply(h,R);for(w=0;w<A;w++){var O=(j=o[w].texture).baseTexture.uid;if(!N[O]){if(!($=h.pop())){var D=new gu,M=void 0,F=void 0;"none"===n.distanceFieldType?(M=new mu(nr.EMPTY),F=t.BLEND_MODES.NORMAL):(M=new mu(nr.EMPTY,{program:ti.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"),uniforms:{uFWidth:0}}),F=t.BLEND_MODES.NORMAL_NPM);var P=new du(D,M);P.blendMode=F,$={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:P,vertices:null,uvs:null,indices:null}}$.index=0,$.indexCount=0,$.vertexCount=0,$.uvsCount=0,$.total=0;var L=this._textureCache;L[O]=L[O]||new nr(j.baseTexture),$.mesh.texture=L[O],$.mesh.tint=this._tint,C.push($),N[O]=$}N[O].total++}for(w=0;w<R.length;w++)-1===C.indexOf(R[w])&&this.removeChild(R[w].mesh);for(w=0;w<C.length;w++)C[w].mesh.parent!==this&&this.addChild(C[w].mesh);for(var w in this._activePagesMeshData=C,N){var B=($=N[w]).total;if(!((null===(e=$.indices)||void 0===e?void 0:e.length)>6*B)||$.vertices.length<2*du.BATCHABLE_SIZE)$.vertices=new Float32Array(8*B),$.uvs=new Float32Array(8*B),$.indices=new Uint16Array(6*B);else for(var z=$.total,U=$.vertices,G=4*z*2;G<U.length;G++)U[G]=0;$.mesh.size=6*B}for(w=0;w<A;w++){var W,V=(W=o[w]).position.x+k[W.line]*("justify"===this._align?W.prevSpaces:1);this._roundPixels&&(V=Math.round(V));var j,H=V*i,X=W.position.y*i,q=N[(j=W.texture).baseTexture.uid],K=j.frame,Y=j._uvs,Z=q.index++;q.indices[6*Z+0]=0+4*Z,q.indices[6*Z+1]=1+4*Z,q.indices[6*Z+2]=2+4*Z,q.indices[6*Z+3]=0+4*Z,q.indices[6*Z+4]=2+4*Z,q.indices[6*Z+5]=3+4*Z,q.vertices[8*Z+0]=H,q.vertices[8*Z+1]=X,q.vertices[8*Z+2]=H+K.width*i,q.vertices[8*Z+3]=X,q.vertices[8*Z+4]=H+K.width*i,q.vertices[8*Z+5]=X+K.height*i,q.vertices[8*Z+6]=H,q.vertices[8*Z+7]=X+K.height*i,q.uvs[8*Z+0]=Y.x0,q.uvs[8*Z+1]=Y.y0,q.uvs[8*Z+2]=Y.x1,q.uvs[8*Z+3]=Y.y1,q.uvs[8*Z+4]=Y.x2,q.uvs[8*Z+5]=Y.y2,q.uvs[8*Z+6]=Y.x3,q.uvs[8*Z+7]=Y.y3}for(var w in this._textWidth=d*i,this._textHeight=(a.y+n.lineHeight)*i,N){var $=N[w];if(0!==this.anchor.x||0!==this.anchor.y)for(var J=0,Q=this._textWidth*this.anchor.x,tt=this._textHeight*this.anchor.y,et=0;et<$.total;et++)$.vertices[J++]-=Q,$.vertices[J++]-=tt,$.vertices[J++]-=Q,$.vertices[J++]-=tt,$.vertices[J++]-=Q,$.vertices[J++]-=tt,$.vertices[J++]-=Q,$.vertices[J++]-=tt;this._maxLineHeight=b*i;var nt=$.mesh.geometry.getBuffer("aVertexPosition"),rt=$.mesh.geometry.getBuffer("aTextureCoord"),it=$.mesh.geometry.getIndex();nt.data=$.vertices,rt.data=$.uvs,it.data=$.indices,nt.update(),rt.update(),it.update()}for(w=0;w<o.length;w++)Cu.push(o[w]);this._font=n,this.dirty=!1},n.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},n.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);var n=Iu.available[this._fontName],r=n.distanceFieldRange,i=n.distanceFieldType,a=n.size;if("none"!==i)for(var o=this.worldTransform,s=o.a,u=o.b,c=o.c,l=o.d,h=Math.sqrt(s*s+u*u),p=Math.sqrt(c*c+l*l),f=(Math.abs(h)+Math.abs(p))/2,d=this.fontSize/a,m=0,g=this._activePagesMeshData;m<g.length;m++){g[m].mesh.shader.uniforms.uFWidth=f*r*d*this._resolution}e.prototype._render.call(this,t)},n.prototype.getLocalBounds=function(){return this.validate(),e.prototype.getLocalBounds.call(this)},n.prototype.validate=function(){var t=Iu.available[this._fontName];if(!t)throw new Error('Missing BitmapFont "'+this._fontName+'"');this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()},Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Iu.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){var t;return null!==(t=this._fontSize)&&void 0!==t?t:Iu.available[this._fontName].size},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),n.prototype.destroy=function(t){var n=this._textureCache,r="none"===Iu.available[this._fontName].distanceFieldType?Au:Nu;r.push.apply(r,this._activePagesMeshData);for(var i=0,a=this._activePagesMeshData;i<a.length;i++){var o=a[i];this.removeChild(o.mesh)}for(var s in this._activePagesMeshData=[],r.filter((function(t){return n[t.mesh.texture.baseTexture.uid]})).forEach((function(t){t.mesh.texture=nr.EMPTY})),n){n[s].destroy(),delete n[s]}this._font=null,this._textureCache=null,e.prototype.destroy.call(this,t)},n.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},n}(wn),Ou=function(){function e(){}return e.add=function(){t.LoaderResource.setExtensionXhrType("fnt",t.LoaderResource.XHR_RESPONSE_TYPE.TEXT)},e.use=function(n,r){var i=Su(n.data);if(i)for(var a=e.getBaseUrl(this,n),o=i.parse(n.data),s={},u=function(t){s[t.metadata.pageFile]=t.texture,Object.keys(s).length===o.page.length&&(n.bitmapFont=Iu.install(o,s,!0),r())},c=0;c<o.page.length;++c){var l=o.page[c].file,h=a+l,p=!1;for(var f in this.resources){var d=this.resources[f];if(d.url===h){d.metadata.pageFile=l,d.texture?u(d):d.onAfterMiddleware.add(u),p=!0;break}}if(!p){var m={crossOrigin:n.crossOrigin,loadType:t.LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},n.metadata.imageMetadata),parentResource:n};this.add(h,m,u)}}else r()},e.getBaseUrl=function(t,n){var r=n.isDataUrl?"":e.dirname(n.url);return n.isDataUrl&&("."===r&&(r=""),t.baseUrl&&r&&"/"===t.baseUrl.charAt(t.baseUrl.length-1)&&(r+="/")),(r=r.replace(t.baseUrl,""))&&"/"!==r.charAt(r.length-1)&&(r+="/"),r},e.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},e.extension=t.ExtensionType.Loader,e}(),Du=function(t,e){return Du=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Du(t,e)};var Mu=function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,Ui,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return n.alpha=e,n}return function(t,e){function n(){this.constructor=t}Du(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(ri),Fu=function(t,e){return Fu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Fu(t,e)};function Pu(t,e){function n(){this.constructor=t}Fu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Lu={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Bu=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var zu=function(e){function n(t,n,r,i,a){void 0===n&&(n=8),void 0===r&&(r=4),void 0===i&&(i=it.FILTER_RESOLUTION),void 0===a&&(a=5);var o=this,s=function(t,e){var n,r=Math.ceil(t/2),i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",a="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var s=n.replace("%index%",o.toString());a+=s=s.replace("%sampleIndex%",o-(r-1)+".0"),a+="\n"}return(i=i.replace("%blur%",a)).replace("%size%",t.toString())}(a,t),u=function(t){for(var e,n=Lu[t],r=n.length,i=Bu,a="",o=0;o<t;o++){var s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());e=o,o>=r&&(e=t-o-1),a+=s=s.replace("%value%",n[e].toString()),a+="\n"}return(i=i.replace("%blur%",a)).replace("%size%",t.toString())}(a);return(o=e.call(this,s,u)||this).horizontal=t,o.resolution=i,o._quality=0,o.quality=r,o.blur=n,o}return Pu(n,e),n.prototype.apply=function(e,n,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/n.width):this.uniforms.strength=1/r.height*(r.height/n.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/n.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,n,r,i);else{var a=e.getFilterTexture(),o=e.renderer,s=n,u=a;this.state.blend=!1,e.applyFilter(this,s,u,t.CLEAR_MODES.CLEAR);for(var c=1;c<this.passes-1;c++){e.bindAndClear(s,t.CLEAR_MODES.BLIT),this.uniforms.uSampler=u;var l=u;u=s,s=l,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,u,r,i),e.returnFilterTexture(a)}},Object.defineProperty(n.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),n}(ri),Uu=function(e){function n(t,n,r,i){void 0===t&&(t=8),void 0===n&&(n=4),void 0===r&&(r=it.FILTER_RESOLUTION),void 0===i&&(i=5);var a=e.call(this)||this;return a.blurXFilter=new zu(!0,t,n,r,i),a.blurYFilter=new zu(!1,t,n,r,i),a.resolution=r,a.quality=n,a.blur=t,a.repeatEdgePixels=!1,a}return Pu(n,e),n.prototype.apply=function(e,n,r,i){var a=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(a&&o){var s=e.getFilterTexture();this.blurXFilter.apply(e,n,s,t.CLEAR_MODES.CLEAR),this.blurYFilter.apply(e,s,r,i),e.returnFilterTexture(s)}else o?this.blurYFilter.apply(e,n,r,i):this.blurXFilter.apply(e,n,r,i)},n.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(n.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),n}(ri),Gu=function(t,e){return Gu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Gu(t,e)};var Wu=function(t){function e(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,Gi,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n)||this).alpha=1,e}return function(t,e){function n(){this.constructor=t}Gu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.tint=function(t,e){var n=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),r=Math.sin(t),i=1/3,a=(0,Math.sqrt)(i),o=[n+(1-n)*i,i*(1-n)-a*r,i*(1-n)+a*r,0,0,i*(1-n)+a*r,n+i*(1-n),i*(1-n)-a*r,0,0,i*(1-n)-a*r,i*(1-n)+a*r,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.contrast=function(t,e){var n=(t||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,r=-.5*(n-1),i=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,n,r,i){var a=((n=n||16770432)>>16&255)/255,o=(n>>8&255)/255,s=(255&n)/255,u=((r=r||3375104)>>16&255)/255,c=(r>>8&255)/255,l=(255&r)/255,h=[.3,.59,.11,0,0,a,o,s,t=t||.2,0,u,c,l,e=e||.15,0,a-u,o-c,s-l,0,0];this._loadMatrix(h,i)},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(ri);Wu.prototype.grayscale=Wu.prototype.greyscale;var Vu=function(t,e){return Vu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Vu(t,e)};var ju=function(t){function e(e,n){var r=this,i=new an;return e.renderable=!1,(r=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,r.maskMatrix=i,null==n&&(n=20),r.scale=new Ze(n,n),r}return function(t,e){function n(){this.constructor=t}Vu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.apply=function(t,e,n,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.worldTransform,a=Math.sqrt(i.a*i.a+i.b*i.b),o=Math.sqrt(i.c*i.c+i.d*i.d);0!==a&&0!==o&&(this.uniforms.rotation[0]=i.a/a,this.uniforms.rotation[1]=i.b/a,this.uniforms.rotation[2]=i.c/o,this.uniforms.rotation[3]=i.d/o),t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(ri),Hu=function(t,e){return Hu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Hu(t,e)};var Xu=function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}return function(t,e){function n(){this.constructor=t}Hu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(ri),qu=function(t,e){return qu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},qu(t,e)};var Ku=function(t){function e(e,n){void 0===e&&(e=.5),void 0===n&&(n=Math.random());var r=t.call(this,Gi,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return r.noise=e,r.seed=n,r}return function(t,e){function n(){this.constructor=t}qu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e}(ri),Yu=new an;yn.prototype._cacheAsBitmap=!1,yn.prototype._cacheData=null,yn.prototype._cacheAsBitmapResolution=null,yn.prototype._cacheAsBitmapMultisample=t.MSAA_QUALITY.NONE;var Zu=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(yn.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Zu),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),yn.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},yn.prototype._initCachedDisplayObject=function(t){var e;if(!this._cacheData||!this._cacheData.sprite){var n=this.alpha;this.alpha=1,t.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var i=this.filters[0].padding;r.pad(i)}r.ceil(it.RESOLUTION);var a=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),s=t.renderTexture.destinationFrame.clone(),u=t.projection.transform,c=rr.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(e=this.cacheAsBitmapMultisample)&&void 0!==e?e:t.multisample}),l="cacheAsBitmap_"+De();this._cacheData.textureCacheId=l,zn.addToCache(c.baseTexture,l),nr.addToCache(c,l);var h=this.transform.localTransform.copyTo(Yu).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:h,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=u,t.renderTexture.bind(a,o,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var p=new Is(c);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-r.x/r.width,p.anchor.y=-r.y/r.height,p.alpha=n,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=p.containsPoint.bind(p)}},yn.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},yn.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;var r=t.context,i=t._projTransform;e.ceil(it.RESOLUTION);var a=rr.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+De();this._cacheData.textureCacheId=o,zn.addToCache(a.baseTexture,o),nr.addToCache(a,o);var s=Yu;this.transform.localTransform.copyTo(s),s.invert(),s.tx-=e.x,s.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:s,skipUpdateTransform:!1}),t.context=r,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var u=new Is(a);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-e.x/e.width,u.anchor.y=-e.y/e.height,u.alpha=n,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}},yn.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},yn.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},yn.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,zn.removeFromCache(this._cacheData.textureCacheId),nr.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},yn.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},yn.prototype.name=null,wn.prototype.getChildByName=function(t,e){for(var n=0,r=this.children.length;n<r;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,r=this.children.length;n<r;n++){var i=this.children[n];if(i.getChildByName){var a=i.getChildByName(t,!0);if(a)return a}}return null},yn.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new Ze),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var $u=function(){function e(){}return e.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,n;if(e.cancelResize(),e._resizeTo===globalThis.window)t=globalThis.innerWidth,n=globalThis.innerHeight;else{var r=e._resizeTo;t=r.clientWidth,n=r.clientHeight}e.renderer.resize(t,n)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},e.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},e.extension=t.ExtensionType.Application,e}(),Ju=function(){function e(t){var n=this;this.stage=new wn,t=Object.assign({forceCanvas:!1},t),this.renderer=zi(t),e._plugins.forEach((function(e){e.init.call(n,t)}))}return e.registerPlugin=function(e){Fe("6.5.0","Application.registerPlugin() is deprecated, use extensions.add()"),kn.add({type:t.ExtensionType.Application,ref:e})},e.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(e.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,n){var r=this,i=e._plugins.slice(0);i.reverse(),i.forEach((function(t){t.destroy.call(r)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(t),this.renderer=null},e._plugins=[],e}();kn.handleByList(t.ExtensionType.Application,Ju._plugins),kn.add($u);var Qu=function(t,e){return Qu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Qu(t,e)};function tc(t,e){function n(){this.constructor=t}Qu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ec=function(t){function e(e,n,r,i){void 0===e&&(e=100),void 0===n&&(n=100),void 0===r&&(r=10),void 0===i&&(i=10);var a=t.call(this)||this;return a.segWidth=r,a.segHeight=i,a.width=e,a.height=n,a.build(),a}return tc(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],r=[],i=this.segWidth-1,a=this.segHeight-1,o=this.width/i,s=this.height/a,u=0;u<t;u++){var c=u%this.segWidth,l=u/this.segWidth|0;e.push(c*o,l*s),n.push(c/i,l/a)}var h=i*a;for(u=0;u<h;u++){var p=u%i,f=u/i|0,d=f*this.segWidth+p,m=f*this.segWidth+p+1,g=(f+1)*this.segWidth+p,v=(f+1)*this.segWidth+p+1;r.push(d,m,g,m,v,g)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(gu),nc=function(t){function e(e,n,r){void 0===e&&(e=200),void 0===r&&(r=0);var i=t.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1)))||this;return i.points=n,i._width=e,i.textureScale=r,i.build(),i}return tc(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var i=n.data,a=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var o=0,s=t[0],u=this._width*this.textureScale,c=t.length,l=0;l<c;l++){var h=4*l;if(this.textureScale>0){var p=s.x-t[l].x,f=s.y-t[l].y,d=Math.sqrt(p*p+f*f);s=t[l],o+=d/u}else o=l/(c-1);i[h]=o,i[h+1]=0,i[h+2]=o,i[h+3]=1}var m=0;for(l=0;l<c-1;l++){h=2*l;a[m++]=h,a[m++]=h+1,a[m++]=h+2,a[m++]=h+2,a[m++]=h+1,a[m++]=h+3}n.update(),r.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,n=t[0],r=0,i=0,a=this.buffers[0].data,o=t.length,s=0;s<o;s++){var u=t[s],c=4*s;i=-((e=s<t.length-1?t[s+1]:u).x-n.x),r=e.y-n.y;var l=Math.sqrt(r*r+i*i),h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;r/=l,i/=l,r*=h,i*=h,a[c]=u.x+r,a[c+1]=u.y+i,a[c+2]=u.x-r,a[c+3]=u.y-i,n=u}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(gu),rc=function(e){function n(n,r,i){void 0===i&&(i=0);var a=this,o=new nc(n.height,r,i),s=new mu(n);return i>0&&(n.baseTexture.wrapMode=t.WRAP_MODES.REPEAT),(a=e.call(this,o,s)||this).autoUpdate=!0,a}return tc(n,e),n.prototype._render=function(t){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),e.prototype._render.call(this,t)},n}(du),ic=function(t){function e(e,n,r){var i=this,a=new ec(e.width,e.height,n,r),o=new mu(nr.WHITE);return(i=t.call(this,a,o)||this).texture=e,i.autoResize=!0,i}return tc(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,n=e.width,r=e.height;!this.autoResize||t.width===n&&t.height===r||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e)},e}(du),ac=function(t){function e(e,n,r,i,a){void 0===e&&(e=nr.EMPTY);var o=this,s=new gu(n,r,i);s.getBuffer("aVertexPosition").static=!1;var u=new mu(e);return(o=t.call(this,s,u,null,a)||this).autoUpdate=!0,o}return tc(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},e}(du),oc=function(t){function e(e,n,r,i,a){void 0===n&&(n=10),void 0===r&&(r=10),void 0===i&&(i=10),void 0===a&&(a=10);var o=t.call(this,nr.WHITE,4,4)||this;return o._origWidth=e.orig.width,o._origHeight=e.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=n,o._rightWidth=i,o._topHeight=r,o._bottomHeight=a,o.texture=e,o}return tc(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,r=this._height>n?1:this._height/n;return Math.min(e,r)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(ic),sc=function(t,e){return sc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},sc(t,e)};var uc=function(e){function n(t,n){void 0===n&&(n=!0);var r=e.call(this,t[0]instanceof nr?t[0]:t[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=n,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=t,r}return function(t,e){function n(){this.constructor=t}sc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,e),n.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Nn.shared.remove(this.update,this),this._isConnectedToTicker=!1))},n.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Nn.shared.add(this.update,this,t.UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))},n.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},n.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},n.prototype.update=function(t){if(this._playing){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}},n.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},n.prototype.destroy=function(t){this.stop(),e.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},n.fromFrames=function(t){for(var e=[],r=0;r<t.length;++r)e.push(nr.from(t[r]));return new n(e)},n.fromImages=function(t){for(var e=[],r=0;r<t.length;++r)e.push(nr.from(t[r]));return new n(e)},Object.defineProperty(n.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof nr)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Nn.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Nn.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),n}(Is);kn.add(oa,ga,da,Xo,Js,Ji,uu,Ou,Qa,Bo,zo,eu,Cn,La);var cc={AlphaFilter:Mu,BlurFilter:Uu,BlurFilterPass:zu,ColorMatrixFilter:Wu,DisplacementFilter:ju,FXAAFilter:Xu,NoiseFilter:Ku};return t.AbstractBatchRenderer=Xi,t.AbstractMultiResource=Un,t.AbstractRenderer=Fi,t.AccessibilityManager=oa,t.AnimatedSprite=uc,t.AppLoaderPlugin=La,t.Application=Ju,t.ArrayResource=Gn,t.Attribute=ar,t.BaseImageResource=Wn,t.BasePrepare=Ks,t.BaseRenderTexture=Jn,t.BaseTexture=zn,t.BatchDrawCall=Vi,t.BatchGeometry=Ki,t.BatchPluginFactory=$i,t.BatchRenderer=Ji,t.BatchShaderGenerator=qi,t.BatchSystem=_r,t.BatchTextureArray=ji,t.BitmapFont=Iu,t.BitmapFontData=yu,t.BitmapFontLoader=Ou,t.BitmapText=Ru,t.BlobResource=$a,t.Bounds=mn,t.BrowserAdapter=U,t.Buffer=sr,t.BufferResource=Ln,t.CanvasResource=Vn,t.Circle=Qe,t.CompressedTextureLoader=Qa,t.CompressedTextureResource=Ja,t.Container=wn,t.ContextSystem=Tr,t.CountLimiter=Us,t.CubeResource=jn,t.DDSLoader=Bo,t.DEG_TO_RAD=Ye,t.DisplayObject=yn,t.Ellipse=tn,t.Extract=ga,t.FORMATS_TO_COMPONENTS=Mo,t.FillStyle=Ko,t.Filter=ri,t.FilterState=vr,t.FilterSystem=xr,t.Framebuffer=$n,t.FramebufferSystem=Ir,t.GLFramebuffer=Er,t.GLProgram=Ti,t.GLTexture=Ri,t.GRAPHICS_CURVES=qo,t.Geometry=pr,t.GeometrySystem=Nr,t.Graphics=ws,t.GraphicsData=ms,t.GraphicsGeometry=vs,t.IGLUniformData=Si,t.INSTALLED=Rn,t.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL=ja,t.ImageBitmapResource=Kn,t.ImageResource=Hn,t.InteractionData=sa,t.InteractionEvent=ca,t.InteractionManager=da,t.InteractionTrackingData=la,t.KTXLoader=zo,t.LineStyle=ys,t.Loader=Pa,t.MaskData=Cr,t.MaskSystem=si,t.Matrix=an,t.Mesh=du,t.MeshBatchUvs=hu,t.MeshGeometry=gu,t.MeshMaterial=mu,t.NineSlicePlane=oc,t.ObjectRenderer=wr,t.ObservablePoint=rn,t.PI_2=qe,t.ParticleContainer=jo,t.ParticleRenderer=Xo,t.PlaneGeometry=ec,t.Point=Ze,t.Polygon=en,t.Prepare=Js,t.Program=ti,t.ProjectionSystem=fi,t.Quad=fr,t.QuadUv=dr,t.RAD_TO_DEG=Ke,t.Rectangle=Je,t.RenderTexture=rr,t.RenderTexturePool=ir,t.RenderTextureSystem=gi,t.Renderer=Bi,t.ResizePlugin=$u,t.Resource=Pn,t.RopeGeometry=nc,t.RoundedRectangle=nn,t.Runner=In,t.SVGResource=Xn,t.ScissorSystem=hi,t.Shader=ei,t.ShaderSystem=Ai,t.SimpleMesh=ac,t.SimplePlane=ic,t.SimpleRope=rc,t.Sprite=Is,t.SpriteMaskFilter=oi,t.Spritesheet=tu,t.SpritesheetLoader=eu,t.State=ni,t.StateSystem=Ni,t.StencilSystem=pi,t.System=Wi,t.TYPES_TO_BYTES_PER_COMPONENT=Do,t.TYPES_TO_BYTES_PER_PIXEL=Fo,t.TemporaryDisplayObject=bn,t.Text=Bs,t.TextFormat=bu,t.TextMetrics=Ps,t.TextStyle=Rs,t.Texture=nr,t.TextureGCSystem=Ci,t.TextureLoader=Ba,t.TextureMatrix=ai,t.TextureSystem=Oi,t.TextureUvs=Qn,t.Ticker=Nn,t.TickerPlugin=Cn,t.TilingSprite=au,t.TilingSpriteRenderer=uu,t.TimeLimiter=Qs,t.Transform=dn,t.UniformGroup=gr,t.VERSION="6.5.10",t.VideoResource=qn,t.ViewableBuffer=Hi,t.XMLFormat=xu,t.XMLStringFormat=wu,t.accessibleTarget=ia,t.autoDetectFormat=Su,t.autoDetectRenderer=zi,t.autoDetectResource=On,t.checkMaxIfStatementsInShader=$r,t.createUBOElements=xi,t.defaultFilterVertex=Gi,t.defaultVertex=Ui,t.extensions=kn,t.filters=cc,t.generateProgram=Ei,t.generateUniformBufferSync=_i,t.getTestContext=Br,t.getUBOData=wi,t.graphicsUtils=_s,t.groupD8=fn,t.interactiveTarget=pa,t.isMobile=rt,t.parseDDS=bo,t.parseKTX=Po,t.resources=Qi,t.settings=it,t.systems=na,t.uniformParsers=Hr,t.utils=Xe,Object.defineProperty(t,"__esModule",{value:!0}),t}({}),o=function(t,e,n,r,i,a,o,s){"use strict";var u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function c(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var l=function(){return(l=Object.assign||function(t){for(var e,n=arguments,r=1,i=arguments.length;r<i;r++)for(var a in e=n[r])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};Object.create,Object.create;var h="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",p=function(t){function e(e){var n=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float gamma;\nuniform float contrast;\nuniform float saturation;\nuniform float brightness;\nuniform float red;\nuniform float green;\nuniform float blue;\nuniform float alpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (c.a > 0.0) {\n        c.rgb /= c.a;\n\n        vec3 rgb = pow(c.rgb, vec3(1. / gamma));\n        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);\n        rgb.r *= red;\n        rgb.g *= green;\n        rgb.b *= blue;\n        c.rgb = rgb * brightness;\n\n        c.rgb *= c.a;\n    }\n\n    gl_FragColor = c * alpha;\n}\n")||this;return n.gamma=1,n.saturation=1,n.contrast=1,n.brightness=1,n.red=1,n.green=1,n.blue=1,n.alpha=1,Object.assign(n,e),n}return c(e,t),e.prototype.apply=function(t,e,n,r){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,r)},e}(e.Filter),f=function(t){function e(e){void 0===e&&(e=.5);var n=t.call(this,h,"\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float threshold;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > threshold) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n")||this;return n.threshold=e,n}return c(e,t),Object.defineProperty(e.prototype,"threshold",{get:function(){return this.uniforms.threshold},set:function(t){this.uniforms.threshold=t},enumerable:!1,configurable:!0}),e}(e.Filter),d=function(t){function e(e,r,i){void 0===e&&(e=4),void 0===r&&(r=3),void 0===i&&(i=!1);var a=t.call(this,h,i?"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n":"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}")||this;return a._kernels=[],a._blur=4,a._quality=3,a.uniforms.uOffset=new Float32Array(2),a._pixelSize=new n.Point,a.pixelSize=1,a._clamp=i,Array.isArray(e)?a.kernels=e:(a._blur=e,a.quality=r),a}return c(e,t),e.prototype.apply=function(t,e,n,r){var i,a=this._pixelSize.x/e._frame.width,o=this._pixelSize.y/e._frame.height;if(1===this._quality||0===this._blur)i=this._kernels[0]+.5,this.uniforms.uOffset[0]=i*a,this.uniforms.uOffset[1]=i*o,t.applyFilter(this,e,n,r);else{for(var s=t.getFilterTexture(),u=e,c=s,l=void 0,h=this._quality-1,p=0;p<h;p++)i=this._kernels[p]+.5,this.uniforms.uOffset[0]=i*a,this.uniforms.uOffset[1]=i*o,t.applyFilter(this,u,c,1),l=u,u=c,c=l;i=this._kernels[h]+.5,this.uniforms.uOffset[0]=i*a,this.uniforms.uOffset[1]=i*o,t.applyFilter(this,u,n,r),t.returnFilterTexture(s)}},e.prototype._updatePadding=function(){this.padding=Math.ceil(this._kernels.reduce((function(t,e){return t+e+.5}),0))},e.prototype._generateKernels=function(){var t=this._blur,e=this._quality,n=[t];if(t>0)for(var r=t,i=t/e,a=1;a<e;a++)r-=i,n.push(r);this._kernels=n,this._updatePadding()},Object.defineProperty(e.prototype,"kernels",{get:function(){return this._kernels},set:function(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max.apply(Math,t)):(this._kernels=[0],this._quality=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clamp",{get:function(){return this._clamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pixelSize",{get:function(){return this._pixelSize},set:function(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof n.Point?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blur",{get:function(){return this._blur},set:function(t){this._blur=t,this._generateKernels()},enumerable:!1,configurable:!0}),e}(e.Filter),m=function(t){function e(n){var i=t.call(this,h,"uniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D bloomTexture;\nuniform float bloomScale;\nuniform float brightness;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    color.rgb *= brightness;\n    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= bloomScale;\n    gl_FragColor = color + bloomColor;\n}\n")||this;i.bloomScale=1,i.brightness=1,i._resolution=r.settings.FILTER_RESOLUTION,"number"==typeof n&&(n={threshold:n});var a=Object.assign(e.defaults,n);i.bloomScale=a.bloomScale,i.brightness=a.brightness;var o=a.kernels,s=a.blur,u=a.quality,c=a.pixelSize,l=a.resolution;return i._extractFilter=new f(a.threshold),i._extractFilter.resolution=l,i._blurFilter=o?new d(o):new d(s,u),i.pixelSize=c,i.resolution=l,i}return c(e,t),e.prototype.apply=function(t,e,n,r,i){var a=t.getFilterTexture();this._extractFilter.apply(t,e,a,1,i);var o=t.getFilterTexture();this._blurFilter.apply(t,a,o,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=o,t.applyFilter(this,e,n,r),t.returnFilterTexture(o),t.returnFilterTexture(a)},Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"threshold",{get:function(){return this._extractFilter.threshold},set:function(t){this._extractFilter.threshold=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"kernels",{get:function(){return this._blurFilter.kernels},set:function(t){this._blurFilter.kernels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blur",{get:function(){return this._blurFilter.blur},set:function(t){this._blurFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._blurFilter.quality},set:function(t){this._blurFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pixelSize",{get:function(){return this._blurFilter.pixelSize},set:function(t){this._blurFilter.pixelSize=t},enumerable:!1,configurable:!0}),e.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:r.settings.FILTER_RESOLUTION},e}(e.Filter),g=function(t){function e(e){void 0===e&&(e=8);var n=t.call(this,h,"varying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 pixelate(vec2 coord, vec2 size)\n{\n    return floor( coord / size ) * size;\n}\n\nvec2 getMod(vec2 coord, vec2 size)\n{\n    return mod( coord , size) / size;\n}\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n\n    if (clamp(p.x, 0.0, 4.0) == p.x)\n    {\n        if (clamp(p.y, 0.0, 4.0) == p.y)\n        {\n            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n        }\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 coord = mapCoord(vTextureCoord);\n\n    // get the rounded color..\n    vec2 pixCoord = pixelate(coord, vec2(pixelSize));\n    pixCoord = unmapCoord(pixCoord);\n\n    vec4 color = texture2D(uSampler, pixCoord);\n\n    // determine the character to use\n    float gray = (color.r + color.g + color.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    // get the mod..\n    vec2 modd = getMod(coord, vec2(pixelSize));\n\n    gl_FragColor = color * character( n, vec2(-1.0) + modd * 2.0);\n\n}\n")||this;return n.size=e,n}return c(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return this.uniforms.pixelSize},set:function(t){this.uniforms.pixelSize=t},enumerable:!1,configurable:!0}),e}(e.Filter),v=function(t){function e(e){var n=t.call(this,h,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform float transformX;\nuniform float transformY;\nuniform vec3 lightColor;\nuniform float lightAlpha;\nuniform vec3 shadowColor;\nuniform float shadowAlpha;\n\nvoid main(void) {\n    vec2 transform = vec2(1.0 / filterArea) * vec2(transformX, transformY);\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float light = texture2D(uSampler, vTextureCoord - transform).a;\n    float shadow = texture2D(uSampler, vTextureCoord + transform).a;\n\n    color.rgb = mix(color.rgb, lightColor, clamp((color.a - light) * lightAlpha, 0.0, 1.0));\n    color.rgb = mix(color.rgb, shadowColor, clamp((color.a - shadow) * shadowAlpha, 0.0, 1.0));\n    gl_FragColor = vec4(color.rgb * color.a, color.a);\n}\n")||this;return n._thickness=2,n._angle=0,n.uniforms.lightColor=new Float32Array(3),n.uniforms.shadowColor=new Float32Array(3),Object.assign(n,{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7},e),n.padding=1,n}return c(e,t),e.prototype._updateTransform=function(){this.uniforms.transformX=this._thickness*Math.cos(this._angle),this.uniforms.transformY=this._thickness*Math.sin(this._angle)},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._angle/n.DEG_TO_RAD},set:function(t){this._angle=t*n.DEG_TO_RAD,this._updateTransform()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t,this._updateTransform()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightColor",{get:function(){return i.rgb2hex(this.uniforms.lightColor)},set:function(t){i.hex2rgb(t,this.uniforms.lightColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightAlpha",{get:function(){return this.uniforms.lightAlpha},set:function(t){this.uniforms.lightAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return i.rgb2hex(this.uniforms.shadowColor)},set:function(t){i.hex2rgb(t,this.uniforms.shadowColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowAlpha",{get:function(){return this.uniforms.shadowAlpha},set:function(t){this.uniforms.shadowAlpha=t},enumerable:!1,configurable:!0}),e}(e.Filter),y=function(t){function e(e,i,u,c){void 0===e&&(e=2),void 0===i&&(i=4),void 0===u&&(u=r.settings.FILTER_RESOLUTION),void 0===c&&(c=5);var l,h,p=t.call(this)||this;return"number"==typeof e?(l=e,h=e):e instanceof n.Point?(l=e.x,h=e.y):Array.isArray(e)&&(l=e[0],h=e[1]),p.blurXFilter=new s.BlurFilterPass(!0,l,i,u,c),p.blurYFilter=new s.BlurFilterPass(!1,h,i,u,c),p.blurYFilter.blendMode=a.BLEND_MODES.SCREEN,p.defaultFilter=new o.AlphaFilter,p}return c(e,t),e.prototype.apply=function(t,e,n,r){var i=t.getFilterTexture();this.defaultFilter.apply(t,e,n,r),this.blurXFilter.apply(t,e,i,1),this.blurYFilter.apply(t,i,n,0),t.returnFilterTexture(i)},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t},enumerable:!1,configurable:!0}),e}(e.Filter),b=function(t){function e(n){var r=t.call(this,h,"uniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * filterArea.xy;\n    coord -= center * dimensions.xy;\n    float distance = length(coord);\n    if (distance < radius) {\n        float percent = distance / radius;\n        if (strength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n        }\n    }\n    coord += center * dimensions.xy;\n    coord /= filterArea.xy;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    gl_FragColor = color;\n}\n")||this;return r.uniforms.dimensions=new Float32Array(2),Object.assign(r,e.defaults,n),r}return c(e,t),e.prototype.apply=function(t,e,n,r){var i=e.filterFrame,a=i.width,o=i.height;this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=o,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.uniforms.strength},set:function(t){this.uniforms.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.center},set:function(t){this.uniforms.center=t},enumerable:!1,configurable:!0}),e.defaults={center:[.5,.5],radius:100,strength:1},e}(e.Filter),x=function(t){function n(e,n,r){void 0===n&&(n=!1),void 0===r&&(r=1);var i=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D colorMap;\nuniform float _mix;\nuniform float _size;\nuniform float _sliceSize;\nuniform float _slicePixelSize;\nuniform float _sliceInnerSize;\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord.xy);\n\n    vec4 adjusted;\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n        float innerWidth = _size - 1.0;\n        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);\n        float zSlice1 = min(zSlice0 + 1.0, innerWidth);\n        float xOffset = _slicePixelSize * 0.5 + color.r * _sliceInnerSize;\n        float s0 = xOffset + (zSlice0 * _sliceSize);\n        float s1 = xOffset + (zSlice1 * _sliceSize);\n        float yOffset = _sliceSize * 0.5 + color.g * (1.0 - _sliceSize);\n        vec4 slice0Color = texture2D(colorMap, vec2(s0,yOffset));\n        vec4 slice1Color = texture2D(colorMap, vec2(s1,yOffset));\n        float zOffset = fract(color.b * innerWidth);\n        adjusted = mix(slice0Color, slice1Color, zOffset);\n\n        color.rgb *= color.a;\n    }\n    gl_FragColor = vec4(mix(color, adjusted, _mix).rgb, color.a);\n\n}")||this;return i.mix=1,i._size=0,i._sliceSize=0,i._slicePixelSize=0,i._sliceInnerSize=0,i._nearest=!1,i._scaleMode=null,i._colorMap=null,i._scaleMode=null,i.nearest=n,i.mix=r,i.colorMap=e,i}return c(n,t),n.prototype.apply=function(t,e,n,r){this.uniforms._mix=this.mix,t.applyFilter(this,e,n,r)},Object.defineProperty(n.prototype,"colorSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"colorMap",{get:function(){return this._colorMap},set:function(t){var n;t&&(t instanceof e.Texture||(t=e.Texture.from(t)),(null===(n=t)||void 0===n?void 0:n.baseTexture)&&(t.baseTexture.scaleMode=this._scaleMode,t.baseTexture.mipmap=a.MIPMAP_MODES.OFF,this._size=t.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms._size=this._size,this.uniforms._sliceSize=this._sliceSize,this.uniforms._slicePixelSize=this._slicePixelSize,this.uniforms._sliceInnerSize=this._sliceInnerSize,this.uniforms.colorMap=t),this._colorMap=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"nearest",{get:function(){return this._nearest},set:function(t){this._nearest=t,this._scaleMode=t?a.SCALE_MODES.NEAREST:a.SCALE_MODES.LINEAR;var e=this._colorMap;e&&e.baseTexture&&(e.baseTexture._glTextures={},e.baseTexture.scaleMode=this._scaleMode,e.baseTexture.mipmap=a.MIPMAP_MODES.OFF,e._updateID++,e.baseTexture.emit("update",e.baseTexture))},enumerable:!1,configurable:!0}),n.prototype.updateColorMap=function(){var t=this._colorMap;t&&t.baseTexture&&(t._updateID++,t.baseTexture.emit("update",t.baseTexture),this.colorMap=t)},n.prototype.destroy=function(e){void 0===e&&(e=!1),this._colorMap&&this._colorMap.destroy(e),t.prototype.destroy.call(this)},n}(e.Filter),w=function(t){function e(e,n){void 0===e&&(e=0),void 0===n&&(n=1);var r=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 color;\nuniform float alpha;\n\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);\n}\n")||this;return r._color=0,r._alpha=1,r.uniforms.color=new Float32Array(3),r.color=e,r.alpha=n,r}return c(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){var e=this.uniforms.color;"number"==typeof t?(i.hex2rgb(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._color=i.rgb2hex(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this.uniforms.alpha=t,this._alpha=t},enumerable:!1,configurable:!0}),e}(e.Filter),_=function(t){function e(e,n,r){void 0===e&&(e=16711680),void 0===n&&(n=0),void 0===r&&(r=.4);var i=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 originalColor;\nuniform vec3 newColor;\nuniform float epsilon;\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    vec3 colorDiff = originalColor - (currentColor.rgb / max(currentColor.a, 0.0000000001));\n    float colorDistance = length(colorDiff);\n    float doReplace = step(colorDistance, epsilon);\n    gl_FragColor = vec4(mix(currentColor.rgb, (newColor + colorDiff) * currentColor.a, doReplace), currentColor.a);\n}\n")||this;return i._originalColor=16711680,i._newColor=0,i.uniforms.originalColor=new Float32Array(3),i.uniforms.newColor=new Float32Array(3),i.originalColor=e,i.newColor=n,i.epsilon=r,i}return c(e,t),Object.defineProperty(e.prototype,"originalColor",{get:function(){return this._originalColor},set:function(t){var e=this.uniforms.originalColor;"number"==typeof t?(i.hex2rgb(t,e),this._originalColor=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._originalColor=i.rgb2hex(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newColor",{get:function(){return this._newColor},set:function(t){var e=this.uniforms.newColor;"number"==typeof t?(i.hex2rgb(t,e),this._newColor=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._newColor=i.rgb2hex(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"epsilon",{get:function(){return this.uniforms.epsilon},set:function(t){this.uniforms.epsilon=t},enumerable:!1,configurable:!0}),e}(e.Filter),S=function(t){function e(e,n,r){void 0===n&&(n=200),void 0===r&&(r=200);var i=t.call(this,h,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n")||this;return i.uniforms.texelSize=new Float32Array(2),i.uniforms.matrix=new Float32Array(9),void 0!==e&&(i.matrix=e),i.width=n,i.height=r,i}return c(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.matrix},set:function(t){var e=this;t.forEach((function(t,n){e.uniforms.matrix[n]=t}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 1/this.uniforms.texelSize[0]},set:function(t){this.uniforms.texelSize[0]=1/t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1/this.uniforms.texelSize[1]},set:function(t){this.uniforms.texelSize[1]=1/t},enumerable:!1,configurable:!0}),e}(e.Filter),T=function(t){function e(){return t.call(this,h,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")||this}return c(e,t),e}(e.Filter),E=function(t){function e(n){var r=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nconst float SQRT_2 = 1.414213;\n\nconst float light = 1.0;\n\nuniform float curvature;\nuniform float lineWidth;\nuniform float lineContrast;\nuniform bool verticalLine;\nuniform float noise;\nuniform float noiseSize;\n\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\n\nuniform float seed;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));\n    \n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 rgb = gl_FragColor.rgb;\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        rgb += _noise * noise;\n    }\n\n    if (lineWidth > 0.0)\n    {\n        float _c = curvature > 0. ? curvature : 1.;\n        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n        vec2 uv = dir * k;\n\n        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;\n        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;\n        rgb *= j;\n        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);\n        rgb *= 0.99 + ceil(segment) * 0.015;\n    }\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    gl_FragColor.rgb = rgb;\n}\n")||this;return r.time=0,r.seed=0,r.uniforms.dimensions=new Float32Array(2),Object.assign(r,e.defaults,n),r}return c(e,t),e.prototype.apply=function(t,e,n,r){var i=e.filterFrame,a=i.width,o=i.height;this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=o,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"curvature",{get:function(){return this.uniforms.curvature},set:function(t){this.uniforms.curvature=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.uniforms.lineWidth},set:function(t){this.uniforms.lineWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineContrast",{get:function(){return this.uniforms.lineContrast},set:function(t){this.uniforms.lineContrast=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalLine",{get:function(){return this.uniforms.verticalLine},set:function(t){this.uniforms.verticalLine=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.noise},set:function(t){this.uniforms.noise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noiseSize",{get:function(){return this.uniforms.noiseSize},set:function(t){this.uniforms.noiseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignetting",{get:function(){return this.uniforms.vignetting},set:function(t){this.uniforms.vignetting=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingAlpha",{get:function(){return this.uniforms.vignettingAlpha},set:function(t){this.uniforms.vignettingAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingBlur",{get:function(){return this.uniforms.vignettingBlur},set:function(t){this.uniforms.vignettingBlur=t},enumerable:!1,configurable:!0}),e.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0},e}(e.Filter),k=function(t){function e(e,n){void 0===e&&(e=1),void 0===n&&(n=5);var r=t.call(this,h,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 filterArea;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * filterArea.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n")||this;return r.scale=e,r.angle=n,r}return c(e,t),Object.defineProperty(e.prototype,"scale",{get:function(){return this.uniforms.scale},set:function(t){this.uniforms.scale=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t},enumerable:!1,configurable:!0}),e}(e.Filter),I=function(t){function a(i){var o=t.call(this)||this;o.angle=45,o._distance=5,o._resolution=r.settings.FILTER_RESOLUTION;var s=i?l(l({},a.defaults),i):a.defaults,u=s.kernels,c=s.blur,p=s.quality,f=s.pixelSize,m=s.resolution;o._tintFilter=new e.Filter(h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}"),o._tintFilter.uniforms.color=new Float32Array(4),o._tintFilter.uniforms.shift=new n.Point,o._tintFilter.resolution=m,o._blurFilter=u?new d(u):new d(c,p),o.pixelSize=f,o.resolution=m;var g=s.shadowOnly,v=s.rotation,y=s.distance,b=s.alpha,x=s.color;return o.shadowOnly=g,o.rotation=v,o.distance=y,o.alpha=b,o.color=x,o._updatePadding(),o}return c(a,t),a.prototype.apply=function(t,e,n,r){var i=t.getFilterTexture();this._tintFilter.apply(t,e,i,1),this._blurFilter.apply(t,i,n,r),!0!==this.shadowOnly&&t.applyFilter(this,e,n,0),t.returnFilterTexture(i)},a.prototype._updatePadding=function(){this.padding=this.distance+2*this.blur},a.prototype._updateShift=function(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))},Object.defineProperty(a.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=t,this._updatePadding(),this._updateShift()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rotation",{get:function(){return this.angle/n.DEG_TO_RAD},set:function(t){this.angle=t*n.DEG_TO_RAD,this._updateShift()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"alpha",{get:function(){return this._tintFilter.uniforms.alpha},set:function(t){this._tintFilter.uniforms.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"color",{get:function(){return i.rgb2hex(this._tintFilter.uniforms.color)},set:function(t){i.hex2rgb(t,this._tintFilter.uniforms.color)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"kernels",{get:function(){return this._blurFilter.kernels},set:function(t){this._blurFilter.kernels=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"blur",{get:function(){return this._blurFilter.blur},set:function(t){this._blurFilter.blur=t,this._updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"quality",{get:function(){return this._blurFilter.quality},set:function(t){this._blurFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pixelSize",{get:function(){return this._blurFilter.pixelSize},set:function(t){this._blurFilter.pixelSize=t},enumerable:!1,configurable:!0}),a.defaults={rotation:45,distance:5,color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:r.settings.FILTER_RESOLUTION},a}(e.Filter),A=function(t){function e(e){void 0===e&&(e=5);var n=t.call(this,h,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float strength;\nuniform vec4 filterArea;\n\n\nvoid main(void)\n{\n\tvec2 onePixel = vec2(1.0 / filterArea);\n\n\tvec4 color;\n\n\tcolor.rgb = vec3(0.5);\n\n\tcolor -= texture2D(uSampler, vTextureCoord - onePixel) * strength;\n\tcolor += texture2D(uSampler, vTextureCoord + onePixel) * strength;\n\n\tcolor.rgb = vec3((color.r + color.g + color.b) / 3.0);\n\n\tfloat alpha = texture2D(uSampler, vTextureCoord).a;\n\n\tgl_FragColor = vec4(color.rgb * alpha, alpha);\n}\n")||this;return n.strength=e,n}return c(e,t),Object.defineProperty(e.prototype,"strength",{get:function(){return this.uniforms.strength},set:function(t){this.uniforms.strength=t},enumerable:!1,configurable:!0}),e}(e.Filter),N=function(t){function r(n){var i=t.call(this,h,"// precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\nuniform float aspect;\n\nuniform sampler2D displacementMap;\nuniform float offset;\nuniform float sinDir;\nuniform float cosDir;\nuniform int fillMode;\n\nuniform float seed;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * aspect;\n    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (offset / filterArea.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    } else {\n        if( coord.x > filterClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = filterClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < filterClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -filterClamp.z;\n            }\n        }\n\n        if( coord.y > filterClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = filterClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < filterClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -filterClamp.w;\n            }\n        }\n    }\n\n    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;\n    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;\n    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;\n    gl_FragColor.a = texture2D(uSampler, coord).a;\n}\n")||this;return i.offset=100,i.fillMode=r.TRANSPARENT,i.average=!1,i.seed=0,i.minSize=8,i.sampleSize=512,i._slices=0,i._offsets=new Float32Array(1),i._sizes=new Float32Array(1),i._direction=-1,i.uniforms.dimensions=new Float32Array(2),i._canvas=document.createElement("canvas"),i._canvas.width=4,i._canvas.height=i.sampleSize,i.texture=e.Texture.from(i._canvas,{scaleMode:a.SCALE_MODES.NEAREST}),Object.assign(i,r.defaults,n),i}return c(r,t),r.prototype.apply=function(t,e,n,r){var i=e.filterFrame,a=i.width,o=i.height;this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/a,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,n,r)},r.prototype._randomizeSizes=function(){var t=this._sizes,e=this._slices-1,n=this.sampleSize,r=Math.min(this.minSize/n,.9/this._slices);if(this.average){for(var i=this._slices,a=1,o=0;o<e;o++){var s=a/(i-o),u=Math.max(s*(1-.6*Math.random()),r);t[o]=u,a-=u}t[e]=a}else{a=1;var c=Math.sqrt(1/this._slices);for(o=0;o<e;o++)u=Math.max(c*a*Math.random(),r),t[o]=u,a-=u;t[e]=a}this.shuffle()},r.prototype.shuffle=function(){for(var t=this._sizes,e=this._slices-1;e>0;e--){var n=Math.random()*e|0,r=t[e];t[e]=t[n],t[n]=r}},r.prototype._randomizeOffsets=function(){for(var t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)},r.prototype.refresh=function(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()},r.prototype.redraw=function(){var t,e=this.sampleSize,n=this.texture,r=this._canvas.getContext("2d");r.clearRect(0,0,8,e);for(var i=0,a=0;a<this._slices;a++){t=Math.floor(256*this._offsets[a]);var o=this._sizes[a]*e,s=t>0?t:0,u=t<0?-t:0;r.fillStyle="rgba("+s+", "+u+", 0, 1)",r.fillRect(0,i|0,e,o+1|0),i+=o}n.baseTexture.update(),this.uniforms.displacementMap=n},Object.defineProperty(r.prototype,"sizes",{get:function(){return this._sizes},set:function(t){for(var e=Math.min(this._slices,t.length),n=0;n<e;n++)this._sizes[n]=t[n]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsets",{get:function(){return this._offsets},set:function(t){for(var e=Math.min(this._slices,t.length),n=0;n<e;n++)this._offsets[n]=t[n]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"slices",{get:function(){return this._slices},set:function(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"direction",{get:function(){return this._direction},set:function(t){if(this._direction!==t){this._direction=t;var e=t*n.DEG_TO_RAD;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"red",{get:function(){return this.uniforms.red},set:function(t){this.uniforms.red=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"green",{get:function(){return this.uniforms.green},set:function(t){this.uniforms.green=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blue",{get:function(){return this.uniforms.blue},set:function(t){this.uniforms.blue=t},enumerable:!1,configurable:!0}),r.prototype.destroy=function(){var t;null===(t=this.texture)||void 0===t||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null},r.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},r.TRANSPARENT=0,r.ORIGINAL=1,r.LOOP=2,r.CLAMP=3,r.MIRROR=4,r}(e.Filter),C=function(t){function e(n){var r=this,i=Object.assign({},e.defaults,n),a=i.outerStrength,o=i.innerStrength,s=i.color,u=i.knockout,c=i.quality,l=Math.round(i.distance);return(r=t.call(this,h,"varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nuniform float outerStrength;\nuniform float innerStrength;\n\nuniform vec4 glowColor;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform bool knockout;\n\nconst float PI = 3.14159265358979323846264;\n\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);\nconst float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);\n\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;\n\nvoid main(void) {\n    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);\n\n    float totalAlpha = 0.0;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {\n       direction = vec2(cos(angle), sin(angle)) * px;\n\n       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {\n           displaced = clamp(vTextureCoord + direction * \n                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);\n\n           curColor = texture2D(uSampler, displaced);\n\n           totalAlpha += (DIST - curDistance) * curColor.a;\n       }\n    }\n    \n    curColor = texture2D(uSampler, vTextureCoord);\n\n    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);\n\n    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;\n    float innerGlowStrength = min(1.0, innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);\n    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);\n\n    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;\n    \n    if (knockout) {\n      float resultAlpha = outerGlowAlpha + innerGlowAlpha;\n      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      gl_FragColor = innerColor + outerGlowColor;\n    }\n}\n".replace(/__ANGLE_STEP_SIZE__/gi,""+(1/c/l).toFixed(7)).replace(/__DIST__/gi,l.toFixed(0)+".0"))||this).uniforms.glowColor=new Float32Array([0,0,0,1]),Object.assign(r,{color:s,outerStrength:a,innerStrength:o,padding:l,knockout:u}),r}return c(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return i.rgb2hex(this.uniforms.glowColor)},set:function(t){i.hex2rgb(t,this.uniforms.glowColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outerStrength",{get:function(){return this.uniforms.outerStrength},set:function(t){this.uniforms.outerStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerStrength",{get:function(){return this.uniforms.innerStrength},set:function(t){this.uniforms.innerStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.uniforms.knockout},set:function(t){this.uniforms.knockout=t},enumerable:!1,configurable:!0}),e.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1},e}(e.Filter),R=function(t){function e(r){var i=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform vec2 light;\nuniform bool parallel;\nuniform float aspect;\n\nuniform float gain;\nuniform float lacunarity;\nuniform float time;\nuniform float alpha;\n\n${perlin}\n\nvoid main(void) {\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    float d;\n\n    if (parallel) {\n        float _cos = light.x;\n        float _sin = light.y;\n        d = (_cos * coord.x) + (_sin * coord.y * aspect);\n    } else {\n        float dx = coord.x - light.x / dimensions.x;\n        float dy = (coord.y - light.y / dimensions.y) * aspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    vec3 dir = vec3(d, d, 0.0);\n\n    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;\n\n}\n".replace("${perlin}","vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n"))||this;i.parallel=!0,i.time=0,i._angle=0,i.uniforms.dimensions=new Float32Array(2);var a=Object.assign(e.defaults,r);return i._angleLight=new n.Point,i.angle=a.angle,i.gain=a.gain,i.lacunarity=a.lacunarity,i.alpha=a.alpha,i.parallel=a.parallel,i.center=a.center,i.time=a.time,i}return c(e,t),e.prototype.apply=function(t,e,n,r){var i=e.filterFrame,a=i.width,o=i.height;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/a,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t;var e=t*n.DEG_TO_RAD;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gain",{get:function(){return this.uniforms.gain},set:function(t){this.uniforms.gain=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lacunarity",{get:function(){return this.uniforms.lacunarity},set:function(t){this.uniforms.lacunarity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.alpha},set:function(t){this.uniforms.alpha=t},enumerable:!1,configurable:!0}),e.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1},e}(e.Filter),O=function(t){function e(e,r,i){void 0===e&&(e=[0,0]),void 0===r&&(r=5),void 0===i&&(i=0);var a=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uVelocity;\nuniform int uKernelSize;\nuniform float uOffset;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\n// Notice:\n// the perfect way:\n//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);\n// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.\n// So use uKernelSize directly.\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        gl_FragColor = color;\n        return;\n    }\n\n    vec2 velocity = uVelocity / filterArea.xy;\n    float offset = -uOffset / length(uVelocity) - 0.5;\n    int k = uKernelSize - 1;\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n        vec2 bias = velocity * (float(i) / float(k) + offset);\n        color += texture2D(uSampler, vTextureCoord + bias);\n    }\n    gl_FragColor = color / float(uKernelSize);\n}\n")||this;return a.kernelSize=5,a.uniforms.uVelocity=new Float32Array(2),a._velocity=new n.ObservablePoint(a.velocityChanged,a),a.setVelocity(e),a.kernelSize=r,a.offset=i,a}return c(e,t),e.prototype.apply=function(t,e,n,r){var i=this.velocity,a=i.x,o=i.y;this.uniforms.uKernelSize=0!==a||0!==o?this.kernelSize:0,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this.setVelocity(t)},enumerable:!1,configurable:!0}),e.prototype.setVelocity=function(t){if(Array.isArray(t)){var e=t[0],n=t[1];this._velocity.set(e,n)}else this._velocity.copyFrom(t)},e.prototype.velocityChanged=function(){this.uniforms.uVelocity[0]=this._velocity.x,this.uniforms.uVelocity[1]=this._velocity.y,this.padding=1+(Math.max(Math.abs(this._velocity.x),Math.abs(this._velocity.y))|0)},Object.defineProperty(e.prototype,"offset",{get:function(){return this.uniforms.uOffset},set:function(t){this.uniforms.uOffset=t},enumerable:!1,configurable:!0}),e}(e.Filter),D=function(t){function e(e,n,r){void 0===n&&(n=.05),void 0===r&&(r=e.length);var i=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float epsilon;\n\nconst int MAX_COLORS = %maxColors%;\n\nuniform vec3 originalColors[MAX_COLORS];\nuniform vec3 targetColors[MAX_COLORS];\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    float alpha = gl_FragColor.a;\n    if (alpha < 0.0001)\n    {\n      return;\n    }\n\n    vec3 color = gl_FragColor.rgb / alpha;\n\n    for(int i = 0; i < MAX_COLORS; i++)\n    {\n      vec3 origColor = originalColors[i];\n      if (origColor.r < 0.0)\n      {\n        break;\n      }\n      vec3 colorDiff = origColor - color;\n      if (length(colorDiff) < epsilon)\n      {\n        vec3 targetColor = targetColors[i];\n        gl_FragColor = vec4((targetColor + colorDiff) * alpha, alpha);\n        return;\n      }\n    }\n}\n".replace(/%maxColors%/g,r.toFixed(0)))||this;return i._replacements=[],i._maxColors=0,i.epsilon=n,i._maxColors=r,i.uniforms.originalColors=new Float32Array(3*r),i.uniforms.targetColors=new Float32Array(3*r),i.replacements=e,i}return c(e,t),Object.defineProperty(e.prototype,"replacements",{get:function(){return this._replacements},set:function(t){var e=this.uniforms.originalColors,n=this.uniforms.targetColors,r=t.length;if(r>this._maxColors)throw new Error("Length of replacements ("+r+") exceeds the maximum colors length ("+this._maxColors+")");e[3*r]=-1;for(var a=0;a<r;a++){var o=t[a],s=o[0];"number"==typeof s?s=i.hex2rgb(s):o[0]=i.rgb2hex(s),e[3*a]=s[0],e[3*a+1]=s[1],e[3*a+2]=s[2];var u=o[1];"number"==typeof u?u=i.hex2rgb(u):o[1]=i.rgb2hex(u),n[3*a]=u[0],n[3*a+1]=u[1],n[3*a+2]=u[2]}this._replacements=t},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){this.replacements=this._replacements},Object.defineProperty(e.prototype,"maxColors",{get:function(){return this._maxColors},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"epsilon",{get:function(){return this.uniforms.epsilon},set:function(t){this.uniforms.epsilon=t},enumerable:!1,configurable:!0}),e}(e.Filter),M=function(t){function e(n,r){void 0===r&&(r=0);var i=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform float sepia;\nuniform float noise;\nuniform float noiseSize;\nuniform float scratch;\nuniform float scratchDensity;\nuniform float scratchWidth;\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\nuniform float seed;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 color = gl_FragColor.rgb;\n\n    if (sepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + sepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= dimensions.y / dimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    if (scratchDensity > seed && scratch != 0.0)\n    {\n        float phase = seed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));\n        if (d < seed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / dimensions.x * (0.75 + seed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        color += _noise * noise;\n    }\n\n    gl_FragColor.rgb = color;\n}\n")||this;return i.seed=0,i.uniforms.dimensions=new Float32Array(2),"number"==typeof n?(i.seed=n,n=void 0):i.seed=r,Object.assign(i,e.defaults,n),i}return c(e,t),e.prototype.apply=function(t,e,n,r){var i,a;this.uniforms.dimensions[0]=null===(i=e.filterFrame)||void 0===i?void 0:i.width,this.uniforms.dimensions[1]=null===(a=e.filterFrame)||void 0===a?void 0:a.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"sepia",{get:function(){return this.uniforms.sepia},set:function(t){this.uniforms.sepia=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.noise},set:function(t){this.uniforms.noise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noiseSize",{get:function(){return this.uniforms.noiseSize},set:function(t){this.uniforms.noiseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scratch",{get:function(){return this.uniforms.scratch},set:function(t){this.uniforms.scratch=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scratchDensity",{get:function(){return this.uniforms.scratchDensity},set:function(t){this.uniforms.scratchDensity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scratchWidth",{get:function(){return this.uniforms.scratchWidth},set:function(t){this.uniforms.scratchWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignetting",{get:function(){return this.uniforms.vignetting},set:function(t){this.uniforms.vignetting=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingAlpha",{get:function(){return this.uniforms.vignettingAlpha},set:function(t){this.uniforms.vignettingAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingBlur",{get:function(){return this.uniforms.vignettingBlur},set:function(t){this.uniforms.vignettingBlur=t},enumerable:!1,configurable:!0}),e.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3},e}(e.Filter),F=function(t){function e(n,r,i){void 0===n&&(n=1),void 0===r&&(r=0),void 0===i&&(i=.1);var a=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 thickness;\nuniform vec4 outlineColor;\nuniform vec4 filterClamp;\n\nconst float DOUBLE_PI = 3.14159265358979323846264 * 2.;\n\nvoid main(void) {\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float maxAlpha = 0.;\n    vec2 displaced;\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ${angleStep}) {\n        displaced.x = vTextureCoord.x + thickness.x * cos(angle);\n        displaced.y = vTextureCoord.y + thickness.y * sin(angle);\n        curColor = texture2D(uSampler, clamp(displaced, filterClamp.xy, filterClamp.zw));\n        maxAlpha = max(maxAlpha, curColor.a);\n    }\n    float resultAlpha = max(maxAlpha, ownColor.a);\n    gl_FragColor = vec4((ownColor.rgb + outlineColor.rgb * (1. - ownColor.a)) * resultAlpha, resultAlpha);\n}\n".replace(/\$\{angleStep\}/,e.getAngleStep(i)))||this;return a._thickness=1,a.uniforms.thickness=new Float32Array([0,0]),a.uniforms.outlineColor=new Float32Array([0,0,0,1]),Object.assign(a,{thickness:n,color:r,quality:i}),a}return c(e,t),e.getAngleStep=function(t){var n=Math.max(t*e.MAX_SAMPLES,e.MIN_SAMPLES);return(2*Math.PI/n).toFixed(7)},e.prototype.apply=function(t,e,n,r){this.uniforms.thickness[0]=this._thickness/e._frame.width,this.uniforms.thickness[1]=this._thickness/e._frame.height,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"color",{get:function(){return i.rgb2hex(this.uniforms.outlineColor)},set:function(t){i.hex2rgb(t,this.uniforms.outlineColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t,this.padding=t},enumerable:!1,configurable:!0}),e.MIN_SAMPLES=1,e.MAX_SAMPLES=100,e}(e.Filter),P=function(t){function e(e){void 0===e&&(e=10);var n=t.call(this,h,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec2 size;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 pixelate(vec2 coord, vec2 size)\n{\n\treturn floor( coord / size ) * size;\n}\n\nvoid main(void)\n{\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = pixelate(coord, size);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord);\n}\n")||this;return n.size=e,n}return c(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return this.uniforms.size},set:function(t){"number"==typeof t&&(t=[t,t]),this.uniforms.size=t},enumerable:!1,configurable:!0}),e}(e.Filter),L=function(t){function e(e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=[0,0]),void 0===r&&(r=5),void 0===i&&(i=-1);var a=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform float uRadian;\nuniform vec2 uCenter;\nuniform float uRadius;\nuniform int uKernelSize;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        gl_FragColor = color;\n        return;\n    }\n\n    float aspect = filterArea.y / filterArea.x;\n    vec2 center = uCenter.xy / filterArea.xy;\n    float gradient = uRadius / filterArea.x * 0.3;\n    float radius = uRadius / filterArea.x - gradient * 0.5;\n    int k = uKernelSize - 1;\n\n    vec2 coord = vTextureCoord;\n    vec2 dir = vec2(center - coord);\n    float dist = length(vec2(dir.x, dir.y * aspect));\n\n    float radianStep = uRadian;\n    if (radius >= 0.0 && dist > radius) {\n        float delta = dist - radius;\n        float gap = gradient;\n        float scale = 1.0 - abs(delta / gap);\n        if (scale <= 0.0) {\n            gl_FragColor = color;\n            return;\n        }\n        radianStep *= scale;\n    }\n    radianStep /= float(k);\n\n    float s = sin(radianStep);\n    float c = cos(radianStep);\n    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n\n        coord -= center;\n        coord.y *= aspect;\n        coord = rotationMatrix * coord;\n        coord.y /= aspect;\n        coord += center;\n\n        vec4 sample = texture2D(uSampler, coord);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample;\n    }\n\n    gl_FragColor = color / float(uKernelSize);\n}\n")||this;return a._angle=0,a.angle=e,a.center=n,a.kernelSize=r,a.radius=i,a}return c(e,t),e.prototype.apply=function(t,e,n,r){this.uniforms.uKernelSize=0!==this._angle?this.kernelSize:0,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this.uniforms.uRadian=t*Math.PI/180},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.uCenter},set:function(t){this.uniforms.uCenter=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.uRadius},set:function(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t},enumerable:!1,configurable:!0}),e}(e.Filter),B=function(t){function e(n){var r=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nuniform bool mirror;\nuniform float boundary;\nuniform vec2 amplitude;\nuniform vec2 waveLength;\nuniform vec2 alpha;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 coord = pixelCoord / dimensions;\n\n    if (coord.y < boundary) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - boundary) / (1. - boundary + 0.0001);\n    float areaY = boundary * dimensions.y / filterArea.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = mirror ? v : vTextureCoord.y;\n\n    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;\n    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;\n    float _alpha = (alpha.y - alpha.x) * k + alpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;\n    x = clamp(x, filterClamp.x, filterClamp.z);\n\n    vec4 color = texture2D(uSampler, vec2(x, y));\n\n    gl_FragColor = color * _alpha;\n}\n")||this;return r.time=0,r.uniforms.amplitude=new Float32Array(2),r.uniforms.waveLength=new Float32Array(2),r.uniforms.alpha=new Float32Array(2),r.uniforms.dimensions=new Float32Array(2),Object.assign(r,e.defaults,n),r}return c(e,t),e.prototype.apply=function(t,e,n,r){var i,a;this.uniforms.dimensions[0]=null===(i=e.filterFrame)||void 0===i?void 0:i.width,this.uniforms.dimensions[1]=null===(a=e.filterFrame)||void 0===a?void 0:a.height,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"mirror",{get:function(){return this.uniforms.mirror},set:function(t){this.uniforms.mirror=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundary",{get:function(){return this.uniforms.boundary},set:function(t){this.uniforms.boundary=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"amplitude",{get:function(){return this.uniforms.amplitude},set:function(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waveLength",{get:function(){return this.uniforms.waveLength},set:function(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.alpha},set:function(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]},enumerable:!1,configurable:!0}),e.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0},e}(e.Filter),z=function(t){function e(e,n,r){void 0===e&&(e=[-10,0]),void 0===n&&(n=[0,10]),void 0===r&&(r=[0,0]);var i=t.call(this,h,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/filterArea.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/filterArea.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/filterArea.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n")||this;return i.red=e,i.green=n,i.blue=r,i}return c(e,t),Object.defineProperty(e.prototype,"red",{get:function(){return this.uniforms.red},set:function(t){this.uniforms.red=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"green",{get:function(){return this.uniforms.green},set:function(t){this.uniforms.green=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blue",{get:function(){return this.uniforms.blue},set:function(t){this.uniforms.blue=t},enumerable:!1,configurable:!0}),e}(e.Filter),U=function(t){function e(n,r,i){void 0===n&&(n=[0,0]),void 0===i&&(i=0);var a=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nuniform vec2 center;\n\nuniform float amplitude;\nuniform float wavelength;\n// uniform float power;\nuniform float brightness;\nuniform float speed;\nuniform float radius;\n\nuniform float time;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float halfWavelength = wavelength * 0.5 / filterArea.x;\n    float maxRadius = radius / filterArea.x;\n    float currentRadius = time * speed / filterArea.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);\n    dir.y *= filterArea.y / filterArea.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );\n\n    vec2 offset = diffUV * powDiff / filterArea.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;\n\n    gl_FragColor = color;\n}\n")||this;return a.center=n,Object.assign(a,e.defaults,r),a.time=i,a}return c(e,t),e.prototype.apply=function(t,e,n,r){this.uniforms.time=this.time,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.center},set:function(t){this.uniforms.center=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"amplitude",{get:function(){return this.uniforms.amplitude},set:function(t){this.uniforms.amplitude=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wavelength",{get:function(){return this.uniforms.wavelength},set:function(t){this.uniforms.wavelength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"brightness",{get:function(){return this.uniforms.brightness},set:function(t){this.uniforms.brightness=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this.uniforms.speed},set:function(t){this.uniforms.speed=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),e.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1},e}(e.Filter),G=function(t){function e(e,n,r){void 0===n&&(n=0),void 0===r&&(r=1);var i=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLightmap;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\nuniform vec4 ambientColor;\nvoid main() {\n    vec4 diffuseColor = texture2D(uSampler, vTextureCoord);\n    vec2 lightCoord = (vTextureCoord * filterArea.xy) / dimensions;\n    vec4 light = texture2D(uLightmap, lightCoord);\n    vec3 ambient = ambientColor.rgb * ambientColor.a;\n    vec3 intensity = ambient + light.rgb;\n    vec3 finalColor = diffuseColor.rgb * intensity;\n    gl_FragColor = vec4(finalColor, diffuseColor.a);\n}\n")||this;return i._color=0,i.uniforms.dimensions=new Float32Array(2),i.uniforms.ambientColor=new Float32Array([0,0,0,r]),i.texture=e,i.color=n,i}return c(e,t),e.prototype.apply=function(t,e,n,r){var i,a;this.uniforms.dimensions[0]=null===(i=e.filterFrame)||void 0===i?void 0:i.width,this.uniforms.dimensions[1]=null===(a=e.filterFrame)||void 0===a?void 0:a.height,t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uLightmap},set:function(t){this.uniforms.uLightmap=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){var e=this.uniforms.ambientColor;"number"==typeof t?(i.hex2rgb(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],this._color=i.rgb2hex(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.ambientColor[3]},set:function(t){this.uniforms.ambientColor[3]=t},enumerable:!1,configurable:!0}),e}(e.Filter),W=function(t){function e(e,r,i,a){void 0===e&&(e=100),void 0===r&&(r=600);var o=t.call(this,h,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n")||this;return o.uniforms.blur=e,o.uniforms.gradientBlur=r,o.uniforms.start=i||new n.Point(0,window.innerHeight/2),o.uniforms.end=a||new n.Point(600,window.innerHeight/2),o.uniforms.delta=new n.Point(30,30),o.uniforms.texSize=new n.Point(window.innerWidth,window.innerHeight),o.updateDelta(),o}return c(e,t),e.prototype.updateDelta=function(){this.uniforms.delta.x=0,this.uniforms.delta.y=0},Object.defineProperty(e.prototype,"blur",{get:function(){return this.uniforms.blur},set:function(t){this.uniforms.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gradientBlur",{get:function(){return this.uniforms.gradientBlur},set:function(t){this.uniforms.gradientBlur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.uniforms.start},set:function(t){this.uniforms.start=t,this.updateDelta()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.uniforms.end},set:function(t){this.uniforms.end=t,this.updateDelta()},enumerable:!1,configurable:!0}),e}(e.Filter),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.updateDelta=function(){var t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/n,this.uniforms.delta.y=e/n},e}(W),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.updateDelta=function(){var t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/n,this.uniforms.delta.y=t/n},e}(W),H=function(t){function e(e,n,r,i){void 0===e&&(e=100),void 0===n&&(n=600);var a=t.call(this)||this;return a.tiltShiftXFilter=new V(e,n,r,i),a.tiltShiftYFilter=new j(e,n,r,i),a}return c(e,t),e.prototype.apply=function(t,e,n,r){var i=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,i,1),this.tiltShiftYFilter.apply(t,i,n,r),t.returnFilterTexture(i)},Object.defineProperty(e.prototype,"blur",{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gradientBlur",{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t},enumerable:!1,configurable:!0}),e}(e.Filter),X=function(t){function e(n){var r=t.call(this,h,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n")||this;return Object.assign(r,e.defaults,n),r}return c(e,t),Object.defineProperty(e.prototype,"offset",{get:function(){return this.uniforms.offset},set:function(t){this.uniforms.offset=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t},enumerable:!1,configurable:!0}),e.defaults={radius:200,angle:4,padding:20,offset:new n.Point},e}(e.Filter),q=function(t){function e(n){var r,i=Object.assign(e.defaults,n),a=i.maxKernelSize,o=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(i,["maxKernelSize"]);return r=t.call(this,h,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uCenter;\nuniform float uStrength;\nuniform float uInnerRadius;\nuniform float uRadius;\n\nconst float MAX_KERNEL_SIZE = ${maxKernelSize};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n\n    float minGradient = uInnerRadius * 0.3;\n    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;\n\n    float gradient = uRadius * 0.3;\n    float radius = (uRadius - gradient * 0.5) / filterArea.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / filterArea.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture2D(uSampler, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n".replace("${maxKernelSize}",a.toFixed(1)))||this,Object.assign(r,o),r}return c(e,t),Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.uCenter},set:function(t){this.uniforms.uCenter=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.uniforms.uStrength},set:function(t){this.uniforms.uStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerRadius",{get:function(){return this.uniforms.uInnerRadius},set:function(t){this.uniforms.uInnerRadius=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.uRadius},set:function(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t},enumerable:!1,configurable:!0}),e.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32},e}(e.Filter);return t.AdjustmentFilter=p,t.AdvancedBloomFilter=m,t.AsciiFilter=g,t.BevelFilter=v,t.BloomFilter=y,t.BulgePinchFilter=b,t.CRTFilter=E,t.ColorMapFilter=x,t.ColorOverlayFilter=w,t.ColorReplaceFilter=_,t.ConvolutionFilter=S,t.CrossHatchFilter=T,t.DotFilter=k,t.DropShadowFilter=I,t.EmbossFilter=A,t.GlitchFilter=N,t.GlowFilter=C,t.GodrayFilter=R,t.KawaseBlurFilter=d,t.MotionBlurFilter=O,t.MultiColorReplaceFilter=D,t.OldFilmFilter=M,t.OutlineFilter=F,t.PixelateFilter=P,t.RGBSplitFilter=z,t.RadialBlurFilter=L,t.ReflectionFilter=B,t.ShockwaveFilter=U,t.SimpleLightmapFilter=G,t.TiltShiftAxisFilter=W,t.TiltShiftFilter=H,t.TiltShiftXFilter=V,t.TiltShiftYFilter=j,t.TwistFilter=X,t.ZoomBlurFilter=q,Object.defineProperty(t,"__esModule",{value:!0}),t}({},a,a,a,a.utils,a,a.filters,a.filters);Object.assign(a.filters,o);var s=function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default.BezierEasing??t:t.BezierEasing??t}var e=.1,n="function"==typeof Float32Array;function r(t,e){return 1-3*e+3*t}function i(t,e){return 3*e-6*t}function a(t){return 3*t}function o(t,e,n){return((r(e,n)*t+i(e,n))*t+a(e))*t}function s(t,e,n){return 3*r(e,n)*t*t+2*i(e,n)*t+a(e)}function u(t){return t}return t((function(t,r,i,a){if(!(0<=t&&t<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===r&&i===a)return u;for(var c=n?new Float32Array(11):new Array(11),l=0;l<11;++l)c[l]=o(l*e,t,i);function h(n){for(var r=0,a=1;10!==a&&c[a]<=n;++a)r+=e;--a;var u=r+(n-c[a])/(c[a+1]-c[a])*e,l=s(u,t,i);return l>=.001?function(t,e,n,r){for(var i=0;i<4;++i){var a=s(e,n,r);if(0===a)return e;e-=(o(e,n,r)-t)/a}return e}(n,u,t,i):0===l?u:function(t,e,n,r,i){var a,s,u=0;do{(a=o(s=e+(n-e)/2,r,i)-t)>0?n=s:e=s}while(Math.abs(a)>1e-7&&++u<10);return s}(n,r,r+e,t,i)}return function(t){return 0===t?0:1===t?1:o(h(t),r,a)}}))}(),u=function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default.Identicon??t:t.Identicon??t}var n,r={exports:{}},i={exports:{}};function a(){return n||(n=1,function(t){!function(){function e(t,e){for(var n=2;n<arguments.length;n++)for(var r=0;r<arguments[n].length;r++)t[e++]=arguments[n].charAt(r)}function n(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function r(t){return String.fromCharCode(255&t,t>>8&255)}t.exports=function(t,i,a){this.width=t,this.height=i,this.depth=a,this.pix_size=i*(t+1),this.data_size=2+this.pix_size+5*Math.floor((65534+this.pix_size)/65535)+4,this.ihdr_offs=0,this.ihdr_size=25,this.plte_offs=this.ihdr_offs+this.ihdr_size,this.plte_size=8+3*a+4,this.trns_offs=this.plte_offs+this.plte_size,this.trns_size=8+a+4,this.idat_offs=this.trns_offs+this.trns_size,this.idat_size=8+this.data_size+4,this.iend_offs=this.idat_offs+this.idat_size,this.iend_size=12,this.buffer_size=this.iend_offs+this.iend_size,this.buffer=new Array,this.palette=new Object,this.pindex=0;for(var o=new Array,s=0;s<this.buffer_size;s++)this.buffer[s]="\0";e(this.buffer,this.ihdr_offs,n(this.ihdr_size-12),"IHDR",n(t),n(i),"\b"),e(this.buffer,this.plte_offs,n(this.plte_size-12),"PLTE"),e(this.buffer,this.trns_offs,n(this.trns_size-12),"tRNS"),e(this.buffer,this.idat_offs,n(this.idat_size-12),"IDAT"),e(this.buffer,this.iend_offs,n(this.iend_size-12),"IEND");var u,c=30912;for(c+=31-c%31,e(this.buffer,this.idat_offs+8,(u=c,String.fromCharCode(u>>8&255,255&u))),s=0;(s<<16)-1<this.pix_size;s++){var l,h;s+65535<this.pix_size?(l=65535,h="\0"):(l=this.pix_size-(s<<16)-s,h=""),e(this.buffer,this.idat_offs+8+2+(s<<16)+(s<<2),h,r(l),r(~l))}for(s=0;s<256;s++){for(var p=s,f=0;f<8;f++)p=1&p?-306674912^p>>1&2147483647:p>>1&2147483647;o[s]=p}this.index=function(t,e){var n=e*(this.width+1)+t+1;return this.idat_offs+8+2+5*Math.floor(n/65535+1)+n},this.color=function(t,e,n,r){var i=(((r=r>=0?r:255)<<8|t)<<8|e)<<8|n;if(void 0===this.palette[i]){if(this.pindex==this.depth)return"\0";var a=this.plte_offs+8+3*this.pindex;this.buffer[a+0]=String.fromCharCode(t),this.buffer[a+1]=String.fromCharCode(e),this.buffer[a+2]=String.fromCharCode(n),this.buffer[this.trns_offs+8+this.pindex]=String.fromCharCode(r),this.palette[i]=String.fromCharCode(this.pindex++)}return this.palette[i]},this.getBase64=function(){var t,e,n,r,i,a,o,s=this.getDump(),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=s.length,l=0,h="";do{r=(t=s.charCodeAt(l))>>2,i=(3&t)<<4|(e=s.charCodeAt(l+1))>>4,n=s.charCodeAt(l+2),a=c<l+2?64:(15&e)<<2|n>>6,o=c<l+3?64:63&n,h+=u.charAt(r)+u.charAt(i)+u.charAt(a)+u.charAt(o)}while((l+=3)<c);return h},this.getDump=function(){for(var t=65521,r=1,i=0,a=5552,s=0;s<this.height;s++)for(var u=-1;u<this.width;u++)i+=r+=this.buffer[this.index(u,s)].charCodeAt(0),0==(a-=1)&&(r%=t,i%=t,a=5552);function c(t,r,i){for(var a=-1,s=4;s<i-4;s+=1)a=o[255&(a^t[r+s].charCodeAt(0))]^a>>8&16777215;e(t,r+i-4,n(~a))}return r%=t,i%=t,e(this.buffer,this.idat_offs+this.idat_size-8,n(i<<16|r)),c(this.buffer,this.ihdr_offs,this.ihdr_size),c(this.buffer,this.plte_offs,this.plte_size),c(this.buffer,this.trns_offs,this.trns_size),c(this.buffer,this.idat_offs,this.idat_size),c(this.buffer,this.iend_offs,this.iend_size),"PNG\r\n\n"+this.buffer.join("")}}}()}(i)),i.exports}return function(t){!function(){var n;n=a();var r=function(t,e){if("string"!=typeof t||t.length<15)throw"A hash of at least 15 characters is required.";this.defaults={background:[240,240,240,255],margin:.08,size:64,saturation:.7,brightness:.5,format:"png"},this.options="object"==typeof e?e:this.defaults,"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t,this.background=this.options.background||this.defaults.background,this.size=this.options.size||this.defaults.size,this.format=this.options.format||this.defaults.format,this.margin=void 0!==this.options.margin?this.options.margin:this.defaults.margin;var n=parseInt(this.hash.substr(-7),16)/268435455,r=this.options.saturation||this.defaults.saturation,i=this.options.brightness||this.defaults.brightness;this.foreground=this.options.foreground||this.hsl2rgb(n,r,i)};r.prototype={background:null,foreground:null,hash:null,margin:null,size:null,format:null,image:function(){return this.isSvg()?new i(this.size,this.foreground,this.background):new n(this.size,this.size,256)},render:function(){var t,e,n=this.image(),r=this.size,i=Math.floor(r*this.margin),a=Math.floor((r-2*i)/5),o=Math.floor((r-5*a)/2),s=n.color.apply(n,this.background),u=n.color.apply(n,this.foreground);for(t=0;t<15;t++)e=parseInt(this.hash.charAt(t),16)%2?s:u,t<5?this.rectangle(2*a+o,t*a+o,a,a,e,n):t<10?(this.rectangle(1*a+o,(t-5)*a+o,a,a,e,n),this.rectangle(3*a+o,(t-5)*a+o,a,a,e,n)):t<15&&(this.rectangle(0*a+o,(t-10)*a+o,a,a,e,n),this.rectangle(4*a+o,(t-10)*a+o,a,a,e,n));return n},rectangle:function(t,e,n,r,i,a){var o,s;if(this.isSvg())a.rectangles.push({x:t,y:e,w:n,h:r,color:i});else for(o=t;o<t+n;o++)for(s=e;s<e+r;s++)a.buffer[a.index(o,s)]=i},hsl2rgb:function(t,e,n){return[255*(e=[n+=e*=n<.5?n:1-n,n-(t*=6)%1*e*2,n-=e*=2,n,n+t%1*e,n+e])[~~t%6],255*e[(16|t)%6],255*e[(8|t)%6]]},toString:function(t){return t?this.render().getDump():this.render().getBase64()},isSvg:function(){return this.format.match(/svg/i)}};var i=function(t,e,n){this.size=t,this.foreground=this.color.apply(this,e),this.background=this.color.apply(this,n),this.rectangles=[]};i.prototype={size:null,foreground:null,background:null,rectangles:null,color:function(t,e,n,r){var i=[t,e,n].map(Math.round);return i.push(r>=0&&r<=255?r/255:1),"rgba("+i.join(",")+")"},getDump:function(){var t,e,n,r=this.foreground,i=this.background,a=.005*this.size;for(e="<svg xmlns='http://www.w3.org/2000/svg' width='"+this.size+"' height='"+this.size+"' style='background-color:"+i+";'><g style='fill:"+r+"; stroke:"+r+"; stroke-width:"+a+";'>",t=0;t<this.rectangles.length;t++)(n=this.rectangles[t]).color!=i&&(e+="<rect  x='"+n.x+"' y='"+n.y+"' width='"+n.w+"' height='"+n.h+"'/>");return e+="</g></svg>"},getBase64:function(){if("function"==typeof btoa)return btoa(this.getDump());if(e)return new e(this.getDump(),"binary").toString("base64");throw"Cannot generate base64 output"}},t.exports=r}()}(r),t(r.exports)}();!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).nsfwjs=t()}((function(){return function t(e,n,r){function i(o,s){if(!n[o]){if(!e[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};e[o][0].call(l.exports,(function(t){return i(e[o][1][t]||t)}),l,l.exports,t,e,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){(function(e,r){(function(){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},u=this&&this.__generator||function(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},c=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(n,"__esModule",{value:!0}),n.NSFWJS=n.load=void 0;var l=o(t("@tensorflow/tfjs")),h=t("./nsfw_classes"),p={MobileNetV2:{path:"mobilenet_v2",numOfWeightBundles:1},MobileNetV2Mid:{path:"mobilenet_v2_mid",numOfWeightBundles:2,options:{type:"graph"}},InceptionV3:{path:"inception_v3",numOfWeightBundles:6,options:{size:299}}};function f(t){return!!t&&t in p}function d(n,r){return s(this,void 0,void 0,(function(){var i,a,l=this;return u(this,(function(h){switch(h.label){case 0:return i=c([],Array(r),!0).map((function(i,a){return s(l,void 0,void 0,(function(){var i,s,c,l,h;return u(this,(function(u){switch(u.label){case 0:i="group1-shard".concat(a+1,"of").concat(r),s=i.replace(/-/g,"_"),u.label=1;case 1:return u.trys.push([1,4,,5]),(l=e[s])?[3,3]:[4,Promise.resolve("".concat("../models/".concat(n,"/").concat(i,".min.js"))).then((function(e){return o(t(e))}))];case 2:l=u.sent().default,u.label=3;case 3:return c=l,[2,(h={},h[i]=c,h)];case 4:throw u.sent(),new Error("Could not load the weight data. Make sure you are importing the ".concat(i,".min.js bundle."));case 5:return[2]}}))}))})),[4,Promise.all(i)];case 1:return a=h.sent(),[2,Object.assign.apply(Object,c([{}],a,!1))]}}))}))}function m(n){return s(this,void 0,void 0,(function(){var r,i,a,s,c,l;return u(this,(function(u){switch(u.label){case 0:if(!f(n))return[2,n];r=p[n],i=r.path,a=r.numOfWeightBundles,u.label=1;case 1:return u.trys.push([1,4,,5]),(c=e.model)?[3,3]:[4,Promise.resolve("".concat("../models/".concat(i,"/model.min.js"))).then((function(e){return o(t(e))}))];case 2:c=u.sent().default,u.label=3;case 3:return s=c,[3,5];case 4:throw u.sent(),new Error("Could not load the model. Make sure you are importing the model.min.js bundle.");case 5:return[4,d(i,a)];case 6:return l=u.sent(),[2,new g(s,l)]}}))}))}n.load=function(t,e){var n;return void 0===e&&(e={size:224}),s(this,void 0,void 0,(function(){var r,i;return u(this,(function(a){switch(a.label){case 0:if(null==l)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");return void 0===t?(t="MobileNetV2",console.info("%cBy not specifying 'modelOrUrl' parameter, you're using the default model: '".concat(t,"'. See NSFWJS docs for instructions on hosting your own model (https://github.com/infinitered/nsfwjs?tab=readme-ov-file#host-your-own-model)."),"color: lightblue")):f(t)&&(console.info("%cYou're using the model: '".concat(t,"'. See NSFWJS docs for instructions on hosting your own model (https://github.com/infinitered/nsfwjs?tab=readme-ov-file#host-your-own-model)."),"color: lightblue"),e=null!==(n=p[t].options)&&void 0!==n?n:e),e.size=(null==e?void 0:e.size)||224,[4,m(t)];case 1:return r=a.sent(),[4,(i=new v(r,e)).load()];case 2:return a.sent(),[2,i]}}))}))};var g=function(){function t(t,e){this.modelJson=t,this.weightDataBase64=e}return t.prototype.arrayBufferFromBase64=function(t){for(var e=r.from(t,"base64").toString("binary"),n=e.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=e.charCodeAt(a);return i.buffer},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,a,o,s,c,l,h,p,f,d;return u(this,(function(u){if(t={modelTopology:this.modelJson.modelTopology,format:this.modelJson.format,generatedBy:this.modelJson.generatedBy,convertedBy:this.modelJson.convertedBy},null!=this.modelJson.weightsManifest){for(e=[],n=[],r=0,i=this.modelJson.weightsManifest;r<i.length;r++){for(a=i[r],o=0,s=a.paths;o<s.length;o++){if(c=s[o],!(l=this.weightDataBase64[c]))throw new Error("Could not find the weight data. Make sure you are importing the correct weight bundle for the model: ".concat(c,".min.js."));h=this.arrayBufferFromBase64(l),n.push(new Uint8Array(h))}e.push.apply(e,a.weights)}for(t.weightSpecs=e,p=new Uint8Array(n.reduce((function(t,e){return t+e.length}),0)),f=0,d=0;d<n.length;d++)p.set(n[d],f),f+=n[d].byteLength;t.weightData=p.buffer}return null!=this.modelJson.trainingConfig&&(t.trainingConfig=this.modelJson.trainingConfig),null!=this.modelJson.userDefinedMetadata&&(t.userDefinedMetadata=this.modelJson.userDefinedMetadata),[2,t]}))}))},t}(),v=function(){function t(t,e){this.intermediateModels={},this.options=e,this.normalizationOffset=l.scalar(255),this.urlOrIOHandler=t,"string"!=typeof t||t.startsWith("indexeddb://")||t.startsWith("localstorage://")||t.endsWith("model.json")?this.urlOrIOHandler=t:this.urlOrIOHandler="".concat(t,"model.json")}return t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,a=this;return u(this,(function(o){switch(o.label){case 0:return t=this.options,e=t.size,"graph"!==t.type?[3,2]:(n=this,[4,l.loadGraphModel(this.urlOrIOHandler)]);case 1:return n.model=o.sent(),[3,4];case 2:return r=this,[4,l.loadLayersModel(this.urlOrIOHandler)];case 3:r.model=o.sent(),this.endpoints=this.model.layers.map((function(t){return t.name})),o.label=4;case 4:return[4,(i=l.tidy((function(){return a.model.predict(l.zeros([1,e,e,3]))}))).data()];case 5:return o.sent(),i.dispose(),[2]}}))}))},t.prototype.infer=function(t,e){var n=this;if(null!=e&&-1===this.endpoints.indexOf(e))throw new Error("Unknown endpoint ".concat(e,". Available endpoints: ").concat(this.endpoints,"."));return l.tidy((function(){t instanceof l.Tensor||(t=l.browser.fromPixels(t));var r=t.toFloat().div(n.normalizationOffset),i=r,a=n.options.size;t.shape[0]===a&&t.shape[1]===a||(i=l.image.resizeBilinear(r,[a,a],!0));var o,s=i.reshape([1,a,a,3]);if(null==e)o=n.model;else{if(n.model.hasOwnProperty("layers")&&null==n.intermediateModels[e]){var u=n.model.layers.find((function(t){return t.name===e}));n.intermediateModels[e]=l.model({inputs:n.model.inputs,outputs:u.output})}o=n.intermediateModels[e]}return o.predict(s)}))},t.prototype.classify=function(t,e){return void 0===e&&(e=5),s(this,void 0,void 0,(function(){var n,r;return u(this,(function(i){switch(i.label){case 0:return[4,y(n=this.infer(t),e)];case 1:return r=i.sent(),n.dispose(),[2,r]}}))}))},t}();function y(t,e){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s;return u(this,(function(u){switch(u.label){case 0:return[4,t.data()];case 1:for(n=u.sent(),r=[],s=0;s<n.length;s++)r.push({value:n[s],index:s});for(r.sort((function(t,e){return e.value-t.value})),i=new Float32Array(e),a=new Int32Array(e),s=0;s<e;s++)i[s]=r[s].value,a[s]=r[s].index;for(o=[],s=0;s<a.length;s++)o.push({className:h.NSFW_CLASSES[a[s]],probability:i[s]});return[2,o]}}))}))}n.NSFWJS=v}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"./nsfw_classes":2,"@tensorflow/tfjs":10,buffer:13}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NSFW_CLASSES=void 0,n.NSFW_CLASSES={0:"Drawing",1:"Hentai",2:"Neutral",3:"Porn",4:"Sexy"}},{}],3:[function(t,e,n){"use strict";e.exports=t("./index")},{"./index":1}],4:[function(t,e,n){"use strict";var r=t("@tensorflow/tfjs-core");var i=function(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,e}(t("seedrandom")),a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},a(t,e)};function o(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function l(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function h(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&r.util.assert("complex64"!==t.dtype,(function(){return"".concat(e," does not support complex64 tensors in the CPU backend.")}))}))}var p=r.kernel_impls.whereImpl,f=function(t){function e(){var e=t.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new r.DataStorage(e,r.engine()),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.nextDataId=function(){return e.nextDataId++},e.prototype.write=function(t,e,n){this.firstUse&&(this.firstUse=!1,r.env().get("IS_NODE")&&r.backend_util.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));var i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:n,refCount:1}),i},e.prototype.makeTensorInfo=function(t,e,n){var i;if("string"===e&&null!=n&&n.length>0&&r.util.isString(n[0])){var a=n.map((function(t){return r.util.encodeString(t)}));i=this.write(a,t,e)}else i=this.write(n,t,e);return{dataId:i,shape:t,dtype:e}},e.prototype.refCount=function(t){return this.data.has(t)?this.data.get(t).refCount:0},e.prototype.incRef=function(t){this.data.get(t).refCount++},e.prototype.decRef=function(t){this.data.has(t)&&this.data.get(t).refCount--},e.prototype.move=function(t,e,n,r,i){this.data.set(t,{values:e,dtype:r,refCount:i})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var e=this.data.get(t),n=e.dtype,i=e.complexTensorInfos;if("complex64"===n){var a=this.readSync(i.real.dataId),o=this.readSync(i.imag.dataId);return r.backend_util.mergeRealAndImagArrays(a,o)}return r.util.convertBackendValuesAndArrayBuffer(this.data.get(t).values,n)},e.prototype.bufferSync=function(t){var e=this.readSync(t.dataId);if("string"===t.dtype)try{var n=e.map((function(t){return r.util.decodeString(t)}));return r.buffer(t.shape,t.dtype,n)}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return r.buffer(t.shape,t.dtype,e)},e.prototype.makeOutput=function(t,e,n){return r.engine().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,t),this)},e.prototype.disposeData=function(t,e){if(void 0===e&&(e=!1),this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;var n=this.data.get(t).complexTensorInfos;null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0},e.prototype.disposeIntermediateTensorInfo=function(t){this.disposeData(t.dataId)},e.prototype.time=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return e=r.util.now(),t(),[2,{kernelMs:r.util.now()-e}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.where=function(t){h([t],"where");var e=this.readSync(t.dataId);return p(t.shape,e)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return t.prototype.epsilon.call(this)},e}(r.KernelBackend);function d(t){for(var e=new Float32Array(t.length),n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}f.nextDataId=0;var m={kernelName:r.Abs,backendName:"cpu",kernelFunc:function(t){var e=t.inputs.x,n=t.backend;h(e,"abs");var i=new Float32Array(r.util.sizeFromShape(e.shape));return i=d(n.data.get(e.dataId).values),n.makeOutput(i,e.shape,e.dtype)}};function g(t){return function(e,n,i,a,o){var s=r.backend_util.assertAndGetBroadcastShape(e,n),u=s.length,c=r.util.computeStrides(s),l=r.util.sizeFromShape(s),h=r.util.getTypedArrayFromDType(o,l),p=e.length,f=n.length,d=r.util.computeStrides(e),m=r.util.computeStrides(n),g=r.backend_util.getBroadcastDims(e,s),v=r.backend_util.getBroadcastDims(n,s);if(g.length+v.length===0)for(var y=0;y<h.length;++y)h[y]=t(i[y%i.length],a[y%a.length]);else{var b=function(e){var n=r.util.indexToLoc(e,u,c),o=n.slice(-p);g.forEach((function(t){return o[t]=0}));var s=r.util.locToIndex(o,p,d),l=n.slice(-f);v.forEach((function(t){return l[t]=0}));var y=r.util.locToIndex(l,f,m);h[e]=t(i[s],a[y])};for(y=0;y<h.length;++y)b(y)}return[h,s]}}function v(t){var e=t.inputs,n=t.backend,r=e.real,i=e.imag,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",o)},s}var y={kernelName:r.Complex,backendName:"cpu",kernelFunc:v};function b(t,e,n){if(void 0===n&&(n="float32"),"complex64"===n)return v({inputs:{real:b(t,e,"float32"),imag:b(t,e,"float32")},backend:t});var i=r.util.makeZerosTypedArray(r.util.sizeFromShape(e),n);return t.makeTensorInfo(e,n,i)}function x(t){var e=t.inputs,n=t.backend,r=e.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var w={kernelName:r.Identity,backendName:"cpu",kernelFunc:x};function _(t){var e=t.inputs,n=t.backend,r=e.input,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}var S={kernelName:r.Real,backendName:"cpu",kernelFunc:_};function T(t,e,n,i){if("int32"===i)return[e,"int32",Int32Array.from(t)];if("bool"===i){var a=r.util.toTypedArray([0],n),o=c(g((function(t,e){return t!==e?1:0}))(e,[],t,a,"bool"),2),s=o[0];return[o[1],"bool",s]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(i))}function E(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.dtype;if("complex64"===o){if("complex64"===a.dtype)return x({inputs:{x:a},backend:n});var s=b(n,a.shape,a.dtype),u=E({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=v({inputs:{real:u,imag:s},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),l}if("complex64"===a.dtype){var h=_({inputs:{input:a},backend:n});l=E({inputs:{x:h},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(h),l}if(!r.util.hasEncodingLoss(a.dtype,o))return{dataId:(l=x({inputs:{x:a},backend:n})).dataId,shape:l.shape,dtype:o};var p=c(T(n.data.get(a.dataId).values,a.shape,a.dtype,o),3),f=p[0],d=p[1],m=p[2];return n.makeTensorInfo(f,d,m)}var k={kernelName:r.Cast,backendName:"cpu",kernelFunc:E};function I(t,e,n,i){return null==n?function(n){var a=n.inputs,o=n.backend,s=a.a,u=a.b,l=o;h([s,u],t);var p=l.data.get(s.dataId).values,f=l.data.get(u.dataId).values,d="string"===s.dtype?r.backend_util.fromUint8ToStringArray(p):p,m="string"===s.dtype?r.backend_util.fromUint8ToStringArray(f):f,g=i||s.dtype,v=c(e(s.shape,u.shape,d,m,g),2),y=v[0],b=v[1];return l.makeTensorInfo(b,g,y)}:function(t){var r=t.inputs,a=t.backend,o=r.a,s=r.b,u=a;if("complex64"===o.dtype||"complex64"===s.dtype){var l=E({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),h=u.data.get(l.dataId),p=h.complexTensorInfos.real,f=h.complexTensorInfos.imag,d=u.data.get(p.dataId).values,m=u.data.get(f.dataId).values,g=E({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),y=u.data.get(g.dataId),b=y.complexTensorInfos.real,x=y.complexTensorInfos.imag,w=u.data.get(b.dataId).values,_=u.data.get(x.dataId).values,S=c(n(o.shape,s.shape,d,m,w,_),3),T=S[0],k=S[1],I=S[2],A=u.makeTensorInfo(I,"float32",T),N=u.makeTensorInfo(I,"float32",k),C=v({inputs:{real:A,imag:N},backend:u});return u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(A),u.disposeIntermediateTensorInfo(N),C}var R=u.data.get(o.dataId).values,O=u.data.get(s.dataId).values,D=i||o.dtype,M=c(e(o.shape,s.shape,R,O,D),2),F=M[0];return I=M[1],u.makeTensorInfo(I,D,F)}}function A(t){return function(e,n,i,a,o,s){var u=r.backend_util.assertAndGetBroadcastShape(e,n),c=r.util.sizeFromShape(u),l=u.length,h=r.util.computeStrides(u),p=r.util.getTypedArrayFromDType("float32",c),f=r.util.getTypedArrayFromDType("float32",c),d=r.backend_util.getBroadcastDims(e,u),m=r.backend_util.getBroadcastDims(n,u),g=r.backend_util.mergeRealAndImagArrays(i,a),v=r.backend_util.mergeRealAndImagArrays(o,s),y=e.length,b=r.util.computeStrides(e),x=n.length,w=r.util.computeStrides(n);if(d.length+m.length===0)for(var _=0;_<p.length;_++){var S=_%g.length,T=_%v.length,E=t(g[2*S],g[2*S+1],v[2*T],v[2*T+1]);p[_]=E.real,f[_]=E.imag}else{var k=function(e){var n=r.util.indexToLoc(e,l,h),i=n.slice(-y);d.forEach((function(t){return i[t]=0}));var a=r.util.locToIndex(i,y,b),o=n.slice(-x);m.forEach((function(t){return o[t]=0}));var s=r.util.locToIndex(o,x,w),u=t(g[2*a],g[2*a+1],v[2*s],v[2*s+1]);p[e]=u.real,f[e]=u.imag};for(_=0;_<p.length;_++)k(_)}return[p,f,u]}}var N=g((function(t,e){return t+e})),C=A((function(t,e,n,r){return{real:t+n,imag:e+r}})),R=I(r.Add,N,C),O={kernelName:r.Add,backendName:"cpu",kernelFunc:R};function D(t,e,n,i,a){for(var o=r.util.sizeFromShape(i),s=r.util.makeZerosTypedArray(a,n),u=0;u<t.length;u++){var c=t[u];if(c<0)throw new Error("Input x must be non-negative!");c>=a||(s[c]+=o>0?e[u]:1)}return s}function M(t,e,n,i){void 0===i&&(i=!1);for(var a=t.shape[0],o=t.shape[1],s=r.buffer([a,n],e.dtype),u=0;u<a;u++)for(var c=0;c<o;c++){var l=t.get(u,c);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(i?s.set(1,u,l):e.size>0?s.set(s.get(u,l)+e.get(u,c),u,l):s.set(s.get(u,l)+1,u,l))}return s}var F=g((function(t,e){return t&e})),P=I(r.BitwiseAnd,F),L={kernelName:r.BitwiseAnd,backendName:"cpu",kernelFunc:P};function B(t){return function(e,n,i){for(var a=r.util.getArrayFromDType(n,e.length),o=0;o<e.length;++o)a[o]=t(e[o],i);return a}}function z(t,e,n){return U(t,B(e),n)}function U(t,e,n){return function(i){var a=i.inputs,o=i.attrs,s=i.backend,u=a.x;h(u,t);var c,l=s,p=l.data.get(u.dataId).values;if("string"===u.dtype){if(!Array.isArray(p))throw new Error("String tensor's value was not an instance of Array");c=r.backend_util.fromUint8ToStringArray(p)}else c=p;var f=n||u.dtype,d=e(c,f,o);return l.makeTensorInfo(u.shape,f,d)}}var G=B((function(t){return Math.ceil(t)})),W=U(r.Ceil,G),V={kernelName:r.Ceil,backendName:"cpu",kernelFunc:W};function j(t,e,n,i){var a=r.util.getArrayFromDType(n,r.util.sizeFromShape(e));if(i&&"string"!==n){var o=0;t.forEach((function(t){var e=r.util.sizeFromShape(t.shape);a.set(t.vals,o),o+=e}))}else{var s=0;t.forEach((function(t){for(var i="string"===n?r.backend_util.fromUint8ToStringArray(t.vals):t.vals,o=0,u=0;u<t.shape[0];++u)for(var c=u*e[1]+s,l=0;l<t.shape[1];++l)a[c+l]=i[o++];s+=t.shape[1]}))}return a}var H=g((function(t,e){return t===e?1:0})),X=I(r.Equal,H,null,"bool"),q={kernelName:r.Equal,backendName:"cpu",kernelFunc:X},K=B((function(t){return Math.exp(t)})),Y=U(r.Exp,K,"float32"),Z={kernelName:r.Exp,backendName:"cpu",kernelFunc:Y},$=B((function(t){return Math.expm1(t)})),J=U(r.Expm1,$),Q={kernelName:r.Expm1,backendName:"cpu",kernelFunc:J},tt=B((function(t){return Math.floor(t)})),et=U(r.Floor,tt),nt={kernelName:r.Floor,backendName:"cpu",kernelFunc:et},rt=g((function(t,e){return Math.floor(t/e)})),it=I(r.FloorDiv,rt,null,"int32"),at={kernelName:r.FloorDiv,backendName:"cpu",kernelFunc:it};function ot(t,e,n,i,a,o,s,u,h){for(var p=r.buffer([i,o],n),f=0;f<i;f++){for(var d=[],m=0,g=0;g<a;g++){var v=t[f*a+g];m+=v*s[g],d.push(v)}if(m<0||m>=h/o)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(u));for(var y=0;y<o;y++)p.values[f*o+y]=e.get.apply(e,l([],c(e.indexToLoc(m*o+y)),!1))}return p}function st(t,e,n){for(var i=r.buffer(n,t.dtype),a=0;a<i.size;++a){var o=i.indexToLoc(a).slice(),s=o[0],u=o[2],c=e.locToIndex([s,u]);o[2]=e.values[c];var l=t.locToIndex(o);0<=l&&l<t.values.length&&(i.values[a]=t.values[l])}return i}var ut=g((function(t,e){return t>e?1:0})),ct=I(r.Greater,ut,null,"bool"),lt={kernelName:r.Greater,backendName:"cpu",kernelFunc:ct},ht=g((function(t,e){return t>=e?1:0})),pt=I(r.GreaterEqual,ht,null,"bool"),ft={kernelName:r.GreaterEqual,backendName:"cpu",kernelFunc:pt},dt=g((function(t,e){return t<e?1:0})),mt=I(r.Less,dt,null,"bool"),gt={kernelName:r.Less,backendName:"cpu",kernelFunc:mt},vt=g((function(t,e){return t<=e?1:0})),yt=I(r.LessEqual,vt,null,"bool"),bt={kernelName:r.LessEqual,backendName:"cpu",kernelFunc:yt};function xt(t,e,n){var i=(e-t)/(n-1),a=r.util.makeZerosTypedArray(n,"float32");a[0]=t;for(var o=1;o<a.length;o++)a[o]=a[o-1]+i;return a}var wt=B((function(t){return Math.log(t)})),_t=U(r.Log,wt),St={kernelName:r.Log,backendName:"cpu",kernelFunc:_t};function Tt(t,e,n,i){for(var a=r.util.getTypedArrayFromDType(i,r.util.sizeFromShape(n)),o=0;o<a.length;++o){for(var s=o*e,u=t[s],c=0;c<e;++c){var l=t[s+c];(Number.isNaN(l)||l>u)&&(u=l)}a[o]=u}return a}var Et=g((function(t,e){return Math.max(t,e)})),kt=I(r.Maximum,Et),It={kernelName:r.Maximum,backendName:"cpu",kernelFunc:kt},At=g((function(t,e){return Math.min(t,e)})),Nt=I(r.Minimum,At),Ct={kernelName:r.Minimum,backendName:"cpu",kernelFunc:Nt},Rt=g((function(t,e){return t*e})),Ot=A((function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})),Dt=I(r.Multiply,Rt,Ot),Mt={kernelName:r.Multiply,backendName:"cpu",kernelFunc:Dt};function Ft(t,e,n){var i=r.util.createScalarValue(-1,n);return Rt([],e,i,t,n)}var Pt={kernelName:r.Neg,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x;h(r,"neg");var i=c(Ft(n.data.get(r.dataId).values,r.shape,r.dtype),2),a=i[0],o=i[1];return n.makeTensorInfo(o,r.dtype,a)}},Lt=g((function(t,e){return t!==e?1:0})),Bt=I(r.NotEqual,Lt,null,"bool"),zt={kernelName:r.NotEqual,backendName:"cpu",kernelFunc:Bt};function Ut(t,e,n,i,a){for(var o=e.length,s=r.util.sizeFromShape(e),u=r.util.computeStrides(e),c=r.util.computeStrides(a),l=r.util.getTypedArrayFromDType(n,r.util.sizeFromShape(a)),h=0;h<s;++h){for(var p=r.util.indexToLoc(h,o,u),f=new Array(p.length),d=0;d<f.length;d++)f[d]=p[i[d]];l[r.util.locToIndex(f,o,c)]=t[h]}return l}function Gt(t){var e=t.inputs,n=t.attrs,r=t.backend,i=e.x,a=n.perm;h(i,"transpose");for(var o=i.shape.length,s=new Array(o),u=0;u<s.length;u++)s[u]=i.shape[a[u]];var c=Ut(r.data.get(i.dataId).values,i.shape,i.dtype,a,s);return{dataId:r.write(c,s,i.dtype),shape:s,dtype:i.dtype}}var Wt={kernelName:r.Transpose,backendName:"cpu",kernelFunc:Gt};function Vt(t,e,n,i){for(var a=c(r.backend_util.computeOutAndReduceShapes(t,i),2),o=a[0],s=a[1],u=r.upcastType(e,"int32"),l=r.util.makeZerosTypedArray(r.util.sizeFromShape(o),u),h=r.util.sizeFromShape(s),p=0;p<l.length;++p){for(var f=p*h,d=1,m=0;m<h;++m)d*=n[f+m];l[p]=d}return{outVals:l,outShape:o,outDtype:u}}var jt={kernelName:r.Prod,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims;h(a,"prod");var u=a.shape.length,c=r.util.parseAxisParam(o,a.shape),l=r.backend_util.getAxesPermutation(c,u),p=c,f=a,d=[];null!=l&&(f=Gt({inputs:{x:a},backend:n,attrs:{perm:l}}),d.push(f),p=r.backend_util.getInnerMostAxes(p.length,u));var m=n.data.get(f.dataId).values,g=Vt(f.shape,f.dtype,m,p),v=g.outVals,y=g.outShape,b=g.outDtype,x=y;return s&&(x=r.backend_util.expandShapeToKeepDim(y,c)),d.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.makeTensorInfo(x,b,v)}};function Ht(t,e){for(var n=t.slice(0,e);n.length<e;)n.push(1);for(var r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Xt(t,e,n,i,a){var o=e.slice();o[0]=a;var s=r.util.getArrayFromDType(n,r.util.sizeFromShape(o)),c=t.length;return function(t,e,n,r,i,a){var o,s,c=Ht(e,2)[1],l=Ht(a,2)[1],h=0;try{for(var p=u(n),f=p.next();!f.done;f=p.next())for(var d=f.value,m=d[0];m<d[1];++m){for(var g=0;g<r;++g)i[h*l+g]=t[m*c+g];++h}}catch(t){o={error:t}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}}(t,e,i,0===c?0:c/e[0],s,o),[s,o]}function qt(t,e,n,i,a,o,s,u){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");if(function(t,e,n){t.forEach((function(t,i){if(t<0||t>=n){var a=r.util.indexToLoc(i,e.length,r.util.computeStrides(e)).join(",");throw new Error("indices[".concat(a,"] = ").concat(t," is not in [0, ").concat(n,")"))}}))}(o,s,e[0][0]-1),0===i.length)throw new Error("params.rank must be nonzero");var c=function(t,e,n,r){var i=[],a=0,o=e.length-1+n.length,s=new Array(o).fill(null).map((function(){return[0]}));!function(t,e){for(var n=0;n<t.length;++n){var r=t[n],i=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(var a=1;a<r.length;++a)if(r[a-1]>r[a])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var u=1,c=0;c<e.length-1;++c){u*=e[c];for(var l=e[c+1],h=1;h<u+1;++h)s[c].push(h*l)}for(h=0;h<t.length;++h){var p=t[h],f=t[h]+1;for(c=0;c<n.length;++c){var d=n[c],m=c+e.length-1;if(m>=0)for(var g=s[m],v=g[g.length-1]-d[p],y=p;y<f;++y)s[m].push(d[y+1]+v);p=d[p],f=d[f]}f!==p&&(i.push([p,f]),a+=f-p)}return{outSplits:s,valueSlices:i,numValues:a}}(o,s,t,i[0]),l=c.outSplits,h=c.valueSlices,p=c.numValues,f=function(t){for(var e=[],n=function(n){var i=t[n].length,a=r.util.getArrayFromDType("int32",i);e.push(a),t[n].forEach((function(t,e){return a[e]=t}))},i=0;i<t.length;++i)n(i);return e}(l),d=Xt(n,i,a,h,p);return[f,d[0],d[1]]}var Kt=2147483647;function Yt(t,e,n,i,a,o,s){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");var u=0===e.length,c=0===a.length,l=0===s.length,h=[];u||h.push(e[0]),c||h.push(a[0]),l||h.push(s[0]);for(var p=1;p<h.length;++p)if(h[p]!==h[p-1])throw new Error("starts, limits, and deltas must have the same shape");var f=0===h.length?1:h[0],d=r.util.getArrayFromDType("int32",f+1);d[0]=0;for(var m=0;m<f;++m){var g=u?t[0]:t[m],v=c?i[0]:i[m];if(0===(T=l?o[0]:o[m]))throw new Error("Requires delta != 0");var y=void 0;if(T>0&&v<g||T<0&&v>g)y=0;else if((y=Math.ceil(Math.abs((v-g)/T)))>Kt)throw new Error("Requires ((limit - start) / delta) <= ".concat(Kt));d[m+1]=d[m]+y}var b=d[f],x=r.util.getArrayFromDType(n,b),w=0;for(m=0;m<f;++m){var _=d[m+1]-d[m],S=u?t[0]:t[m],T=l?o[0]:o[m];for(p=0;p<_;++p)x[w++]=S,S+=T}return[d,x]}var Zt=r.backend_util.RowPartitionType,$t=function(){function t(t,e,n,i,a,o,s,u,c,l){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=i,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=r.backend_util.getRowPartitionTypesHelper(l),this.raggedRank=r.backend_util.getRaggedRank(this.rowPartitionTypes)}return t.prototype.getRowPartitionTypeByDimension=function(t){return this.rowPartitionTypes[0]===Zt.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]},t.prototype.getRowPartitionTensor=function(t){return this.rowPartitionTypes[0]===Zt.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]},t.prototype.getMaxWidth=function(e){var n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Zt.VALUE_ROWIDS:return t.getMaxWidthValueRowID(n);case Zt.ROW_SPLITS:return t.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(Zt[this.getRowPartitionTypeByDimension(e-1)]))}},t.getMaxWidthRowSplit=function(t){var e=t.length;if(0===e||1===e)return 0;for(var n=0,r=0;r<e-1;++r){var i=t[r+1]-t[r];i>n&&(n=i)}return n},t.getMaxWidthValueRowID=function(t){var e=t.length;if(0===e)return 0;for(var n=0,r=t[0],i=0,a=1;a<e;++a){var o=t[a];o!==r&&(r=o,i=Math.max(a-n,i),n=a)}return Math.max(e-n,i)},t.prototype.tensorShapeFromTensor=function(t,e,n){if(void 0===n&&(n=!0),0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Qt(t,n)},t.prototype.calculateOutputSize=function(t){var e=this.valuesShape,n=this.defaultValueShape;r.backend_util.validateDefaultValueShape(n,e);var i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=r.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,i,e);a[0]<0&&(a[0]=t);for(var o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a},t.prototype.calculateFirstParentOutputIndex=function(t,e,n){for(var i=Math.min(t,n),a=[],o=0,s=0;s<i;++s,o+=e)a.push(o);for(s=i;s<t;++s)a.push(-1);return r.util.assert(a.length===t,(function(){return"Final length of result must be equal to firstDimension."})),a},t.prototype.calculateOutputIndexRowSplit=function(t,e,n,r){for(var i=t.length,a=[],o=0;o<i-1;++o){var s=t[o+1]-t[o],u=Math.min(r,s),c=e[o];-1===c&&(u=0);for(var l=0;l<u;++l)a.push(c),c+=n;for(l=0;l<s-u;++l)a.push(-1)}if(i>0&&a.length!==t[i-1])throw new Error("Invalid row split size.");return a},t.prototype.calculateOutputIndexValueRowID=function(t,e,n,r){var i=t.length,a=[];if(0===i)return[];var o=0,s=t[0];if(s>=e.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(e.length));var u=e[s];a.push(u);for(var c=1;c<i;++c){var l=t[c];if(l===s)u>=0&&(++o<r?u+=n:u=-1);else{if(o=0,s=l,l>=e.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(e.length));u=e[l]}a.push(u)}if(a.length!==t.length)throw new Error("Invalid row ids.");return a},t.prototype.calculateOutputIndex=function(t,e,n,r){var i=this.getRowPartitionTensor(t),a=this.getRowPartitionTypeByDimension(t);switch(a){case Zt.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,e,n,r);case Zt.ROW_SPLITS:if(i.length-1>e.length)throw new Error("Row partition size is greater than output size: ".concat(i.length-1," > ").concat(e.length));return this.calculateOutputIndexRowSplit(i,e,n,r);default:throw new Error("Unsupported partition type: ".concat(Zt[a]))}},t.prototype.getFirstDimensionSize=function(){var t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var e=this.rowPartitionTypes[0];switch(e){case Zt.FIRST_DIM_SIZE:return t[0];case Zt.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Zt.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(Zt[e]))}},t.prototype.compute=function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var t=this.getFirstDimensionSize(),e=this.calculateOutputSize(t),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var i=n.length-2;i>=0;--i)n[i]=n[i+1]*e[i+1];var a=Qt(e,!1),o=r.util.getArrayFromDType(this.valuesDType,r.util.sizeFromShape(a));if(n[0]*e[0]>0){var s=this.calculateFirstParentOutputIndex(t,n[0],e[0]);for(i=1;i<=this.raggedRank;++i)s=this.calculateOutputIndex(i-1,s,n[i],e[i]);this.setOutput(this.raggedRank,s,o,a)}return[a,o]},t.prototype.setOutput=function(t,e,n,i){if(0!==n.length){var a=this.values,o=n,s=i.slice();s=s.slice(t+1);var u=r.util.sizeFromShape(s),c=e.length,l=this.defaultValue;if(l.length!==u&&1!==l.length){var h=this.defaultValueShape;r.tidy((function(){var t=r.reshape(l,h),e=r.broadcastTo(t,s);l=e.dataSync()}))}for(var p=0,f=0,d=0,m=0;m<=c;++m){var g=m<c?e[m]:-1;if(g!==d){if(f<d){var v=a.subarray(p*u);Jt(o.subarray(f*u),v,(d-f)*u)}if(m>=c){var y=n.length;g=Math.floor(y/u)}if(g>d)if(1===this.defaultValue.length)o.subarray(d*u,g*u).fill(this.defaultValue[0]),d=g;else for(;g>d;)Jt(o.slice(d*u),l,u),++d;g<0?(p=m+1,f=d):(p=m,d=(f=d)+1)}else++d}}},t}();function Jt(t,e,n){for(var r=0;r<n;r++)t[r]=e[r]}function Qt(t,e){var n,r,i=[];try{for(var a=u(t),o=a.next();!o.done;o=a.next()){var s=o.value;if(s<0){if(!e)throw new Error("Dimension ".concat(s," must be >= 0"));if(s<-1)throw new Error("Dimension ".concat(s," must be >= -1"));s=-1}i.push(s)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function te(t,e,n,r,i,a,o,s,u,c){return new $t(t,e,n,r,i,a,o,s,u,c).compute()}function ee(t,e,n,i){if(t===e||t<e&&n<0||e<t&&n>1)return r.util.makeZerosTypedArray(0,i);var a=Math.abs(Math.ceil((e-t)/n)),o=r.util.makeZerosTypedArray(a,i);e<t&&1===n&&(n=-1),o[0]=t;for(var s=1;s<o.length;s++)o[s]=o[s-1]+n;return o}var ne=B((function(t){return 1/Math.sqrt(t)})),re=U(r.Rsqrt,ne),ie={kernelName:r.Rsqrt,backendName:"cpu",kernelFunc:re};function ae(t,e,n,i,a,o,s,u,c,l){var h=[i/a,a],p=t.values,f=e.values;if(0===i)return r.buffer(n,e.dtype);var d=c instanceof r.TensorBuffer?c:r.buffer(h,e.dtype);"string"==typeof c||"number"==typeof c?d.values.fill(c):"boolean"==typeof c&&d.values.fill(+c);for(var m=0;m<o;m++){for(var g=[],v=0,y=0;y<s;y++){var b=p[m*s+y];g.push(b),v+=b*u[y]}if(v<0||v>=i/a)throw new Error("Invalid indices: ".concat(g," does not index into ").concat(n));for(var x=0;x<a;x++)l?d.values[v*a+x]+=f[m*a+x]:d.values[v*a+x]=0===e.rank?f[0]:f[m*a+x]}return d}var oe=B((function(t){return 1/(1+Math.exp(-t))})),se=z(r.Sigmoid,(function(t){return 1/(1+Math.exp(-t))})),ue={kernelName:r.Sigmoid,backendName:"cpu",kernelFunc:se};function ce(t,e,n,i,a){var o=r.slice_util.isSliceContinous(i,e,n),s=r.util.sizeFromShape(n),u=r.util.computeStrides(i);if(o){var h=r.slice_util.computeFlatOffset(e,u);return"string"===a?t.slice(h,h+s):t.subarray(h,h+s)}for(var p="string"===a?r.backend_util.fromUint8ToStringArray(t):t,f=r.buffer(i,a,p),d=r.buffer(n,a),m=0;m<d.size;++m){var g=d.indexToLoc(m),v=g.map((function(t,n){return t+e[n]}));d.set.apply(d,l([f.get.apply(f,l([],c(v),!1))],c(g),!1))}return"string"===a?r.backend_util.fromStringArrayToUint8(d.values):d.values}function le(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.begin,s=i.size;h(a,"slice");var u=c(r.slice_util.parseSliceParams(a,o,s),2),l=u[0],p=u[1];r.slice_util.assertParamsValid(a,l,p);var f=ce(n.data.get(a.dataId).values,l,p,a.shape,a.dtype);return n.makeTensorInfo(p,a.dtype,f)}var he={kernelName:r.Slice,backendName:"cpu",kernelFunc:le};function pe(t,e,n,i,a,o,s){var u=e[0],c=o[0],l=new Array(c),h=new Array(u),p=e[1];if(0===c){if(0!==u)throw new Error(r.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(u));return[x=r.util.getArrayFromDType(n,0),[0,p],w=r.util.getArrayFromDType(a,0),l,h]}for(var f=!0,d=0,m=new Array(c).fill(0),g=0;g<u;++g){if((y=t[g*p])<0)throw new Error(r.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,y));if(y>=c)throw new Error(r.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,y,c));++m[y],f=f&&y>=d,d=y}for(var v=!0,y=0;y<c;++y){var b=0===m[y];l[y]=b,v=v&&!b,m[y]=Math.max(m[y],1),y>0&&(m[y]+=m[y-1])}if(v&&f){var x=t,w=i;for(g=0;g<u;++g)h[g]=g;return[x,[u,p],w,l,h]}var _=m[c-1],S=(x=r.util.getArrayFromDType(n,_*p),w=r.util.getArrayFromDType(a,_),new Array(c).fill(0));for(g=0;g<u;++g){var T=S[y=t[g*p]],E=(0===y?0:m[y-1])+T;S[y]++;for(var k=0;k<p;++k)x[E*p+k]=t[g*p+k];w[E]=i[g],h[g]=E}for(y=0;y<c;++y)if(0===S[y]){var I=0===y?0:m[y-1];x[I*p+0]=y;for(var A=1;A<p;++A)x[I*p+A]=0;w[I]=s}return[x,[_,p],w,l,h]}function fe(t,e,n,i,a){for(var o=r.util.sizeFromShape(i),s=e[0],u=a.length,c=[],l=1,h=-1,p=0;p<u;++p){var f=a[p];if(-1===f){if(-1!==h)throw new Error(r.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(h,p));h=p,c.push(1)}else{if(f<0)throw new Error(r.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(p,f));l*=f,c.push(f)}}if(-1!==h){if(l<=0)throw new Error(r.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());var d=Math.trunc(o/l);if(l*d!==o)throw new Error(r.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(i,c));c[h]=d}if(r.util.sizeFromShape(c)!==o)throw new Error(r.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(i,c));var m=i.length,g=[];if(m>0)for(g[m-1]=1,p=m-2;p>=0;--p)g[p]=g[p+1]*i[p+1];var v=[];if(u>0)for(v[u-1]=1,p=u-2;p>=0;--p)v[p]=v[p+1]*c[p+1];for(var y=r.util.getArrayFromDType(n,s*u),b=0;b<s;++b){for(var x=0,w=0;w<m;++w)x+=t[b*m+w]*g[w];for(w=0;w<u;++w)y[b*u+w]=Math.trunc(x/v[w]),x%=v[w]}return[y,[s,u],c]}function de(t,e,n,i,a,o,s){void 0===o&&(o=!1),void 0===s&&(s=0);var u=i.length,c=[e[0],t.length/e[0]],l=c[1],h=u>0?a[u-1]+1:0;if(h<0)throw new Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());var p=e.slice();p[0]=h;var f=p.reduce((function(t,e){return t*e}),1),d=r.util.getArrayFromDType(n,f);if(0===u)return h>0&&d.fill(s),[d,p];if(h<=0)throw new Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());for(var m=0,g=1,v=0,y=a[m];;){var b=0;if(g<u){if(y===(b=a[g])){++g;continue}if(y>=b)throw new Error(r.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=h)throw new Error(r.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,h));y>v&&d.fill(s,v*l,y*l);for(var x=m;x<g;++x){var w=i[x];if(w<0||w>=c[0])throw new Error(r.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(x,i[x],c[0]));for(var _=0;_<l;_++)d[y*l+_]+=t[w*l+_]}if(o)for(_=0;_<l;_++)d[y*l+_]/=g-m;if(m=g,v=y+1,y=b,++g>u)break}return v<h&&d.fill(s,v*l,h*l),[d,p]}var me=B((function(t){return Math.sqrt(t)})),ge=z(r.Sqrt,(function(t){return Math.sqrt(t)})),ve={kernelName:r.Sqrt,backendName:"cpu",kernelFunc:ge},ye=g((function(t,e){var n=t-e;return n*n})),be=I(r.SquaredDifference,ye),xe={kernelName:r.SquaredDifference,backendName:"cpu",kernelFunc:be},we=B((function(t,e){var n=e.pattern,r=e.replaceGlobal,i=e.rewrite;return t.replace(new RegExp(n,r?"g":""),i)})),_e=U(r.StaticRegexReplace,we),Se={kernelName:r.StaticRegexReplace,backendName:"cpu",kernelFunc:_e};function Te(t,e,n,i){for(var a=r.buffer(t,e.dtype),o=0;o<a.size;o++){for(var s=a.indexToLoc(o),u=new Array(s.length),h=0;h<u.length;h++)u[h]=s[h]*n[h]+i[h];a.set.apply(a,l([e.get.apply(e,l([],c(u),!1))],c(s),!1))}return a}var Ee=function(){function t(t,e,n,i,a,o){this.separator=r.util.encodeString(t),this.nGramWidths=e,this.leftPad=r.util.encodeString(n),this.rightPad=r.util.encodeString(i),this.padWidth=a,this.preserveShort=o}return t.prototype.getPadWidth=function(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)},t.prototype.getNumNGrams=function(t,e){var n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)},t.prototype.createNGrams=function(t,e,n,r,i,a){for(var o=function(o){var u=s.getPadWidth(a),c=Math.max(0,u-o),l=Math.max(0,u-(i-(o+1))),h=a-(c+l),p=e+(c>0?0:o-u),f=0;f+=c*s.leftPad.length;for(var d=0;d<h;++d)f+=t[p+d].length;f+=l*s.rightPad.length,f+=(c+l+h-1)*s.separator.length,n[r+o]=new Uint8Array(f);var m=n[r+o],g=0,v=function(t){return t.forEach((function(t){return m[g++]=t}))};for(d=0;d<c;++d)v(s.leftPad),v(s.separator);for(d=0;d<h-1;++d)v(t[p+d]),v(s.separator);if(h>0)for(v(t[p+h-1]),d=0;d<l;++d)v(s.separator),v(s.rightPad);else{for(d=0;d<l-1;++d)v(s.rightPad),v(s.separator);v(s.rightPad)}},s=this,u=0;u<i;++u)o(u)},t.prototype.compute=function(t,e){var n=this,i=t.length,a=e.length;if(a>0){var o=e[0];if(0!==o)throw new Error("First split value must be 0, got ".concat(o));for(var s=1;s<a;++s){var u=e[s]>=o;if(!(u=u&&e[s]<=i))throw new Error("Invalid split value ".concat(e[s],", must be in [").concat(o,", ").concat(i,"]"));o=e[s]}if(o!==i)throw new Error("Last split value must be data size. Expected ".concat(i,", got ").concat(o))}var c=a-1,l=r.util.getArrayFromDType("int32",a);if(0===i||0===a){var h=new Array(i);for(s=0;s<=c;++s)l[s]=0;return[h,l]}l[0]=0;var p=function(t){var r=e[t]-e[t-1],i=0;f.nGramWidths.forEach((function(t){i+=n.getNumNGrams(r,t)})),f.preserveShort&&r>0&&0===i&&(i=1),l[t]=l[t-1]+i},f=this;for(s=1;s<=c;++s)p(s);var d=new Array(l[c]),m=function(r){var i=e[r],a=l[r];if(g.nGramWidths.forEach((function(o){var s=e[r+1]-e[r],u=n.getNumNGrams(s,o);n.createNGrams(t,i,d,a,u,o),a+=u})),g.preserveShort&&a===l[r]){var o=e[r+1]-e[r];if(0===o)return"continue";var s=o+2*g.padWidth;g.createNGrams(t,i,d,a,1,s)}},g=this;for(s=0;s<c;++s)m(s);return[d,l]},t}();function ke(t,e,n,r,i,a,o,s){return new Ee(n,r,i,a,o,s).compute(t,e)}function Ie(t,e,n,r){if(t.length)if(0!==e.length)if(1!==e.length){var i=0;for(u=0;u<t.length+1;u++)u!==t.length&&-1===e.indexOf(t[u])||(s=t.subarray(i,u),n&&0===s.length||r.push(s),i=u+1)}else{for(var a=e[0],o=t.indexOf(a);-1!==o;){var s=t.subarray(0,o);n&&0===s.length||r.push(s),o=(t=t.subarray(o+1)).indexOf(a)}n&&0===t.length||r.push(t)}else for(var u=0;u<t.length;++u)r.push(t.subarray(u,u+1))}function Ae(t,e,n){for(var i=t.length,a=[],o=0,s=0,u=new Array(i),c=0;c<i;++c){var l=a.length;Ie(t[c],e,n,a);var h=a.length-l;u[c]=h,o+=h,s=Math.max(s,h)}var p=r.util.getArrayFromDType("int32",2*o),f=new Array(o),d=[i,s],m=0;for(c=0;c<i;++c)for(var g=0;g<u[c];++g)p[2*m]=c,p[2*m+1]=g,f[m]=a[m],++m;return[p,f,d]}function Ne(t,e){for(var n=r.util.getArrayFromDType("int32",t.length),i=0;i<t.length;++i)n[i]=r.util.fingerPrint64(t[i]).modulo(e).getLowBitsUnsigned();return n}var Ce=g((function(t,e){return t-e})),Re=A((function(t,e,n,r){return{real:t-n,imag:e-r}})),Oe=I(r.Sub,Ce,Re),De={kernelName:r.Sub,backendName:"cpu",kernelFunc:Oe};function Me(t,e){for(var n=new Array(t.rank),i=0;i<n.length;i++)n[i]=t.shape[i]*e[i];var a=r.buffer(n,t.dtype);for(i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(t.rank),u=0;u<s.length;u++)s[u]=o[u]%t.shape[u];var c=t.locToIndex(s);a.values[i]=t.values[c]}return a}var Fe=function(t,e){var n=e.value-t.value;return 0===n?t.index-e.index:n};function Pe(t,e,n,i){for(void 0===n&&(n=0),void 0===i&&(i=t.length-1);i>n;){if(i-n>600){var a=i-n+1,o=e-n+1,s=Math.log(a),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(a-u)/a)*Math.sign(o-a/2);Pe(t,e,Math.max(n,Math.floor(e-o*u/a+c)),Math.min(i,Math.floor(e+(a-o)*u/a+c)))}var l=t[e],h=n,p=i;for(r.util.swap(t,n,e),Fe(t[i],l)>0&&r.util.swap(t,n,i);h<p;){for(r.util.swap(t,h,p),h++,p--;Fe(t[h],l)<0;)h+=1;for(;Fe(t[p],l)>0;)p-=1}0===Fe(t[n],l)?r.util.swap(t,n,p):(p+=1,r.util.swap(t,p,i)),p<=e&&(n=p+1),e<=p&&(i=p-1)}}function Le(t,e,n,i,a){for(var o=e[e.length-1],s=c([t.length/o,o],2),u=s[0],l=s[1],h=r.util.getTypedArrayFromDType(n,u*i),p=r.util.getTypedArrayFromDType("int32",u*i),f=function(e){var n=e*l,r=t.subarray(n,n+l),o=new Array(r.length);r.forEach((function(t,e){return o[e]={value:t,index:e}})),i<o.length&&(Pe(o,i),o=o.slice(0,i)),a&&o.sort(Fe);for(var s=e*i,u=h.subarray(s,s+i),c=p.subarray(s,s+i),f=0;f<i;f++)u[f]=o[f].value,c[f]=o[f].index},d=0;d<u;d++)f(d);var m=e.slice();return m[m.length-1]=i,[r.buffer(m,n,h),r.buffer(m,"int32",p)]}function Be(t,e,n,i){for(var a=r.util.parseAxisParam(e,n)[0],o=[1,n[0],1],s=0;s<a;s++)o[0]*=n[s];for(o[1]=n[a],s=a+1;s<n.length;s++)o[2]*=n[s];var u=new Map,c=new Int32Array(n[a]),l=new r.TensorBuffer(o,i,t),h=[],p=1===o[0]&&1===o[2];for(s=0;s<n[a];s++){var f=void 0;if(p)f=t[s].toString();else{for(var d=[],m=0;m<o[0];m++)for(var g=0;g<o[2];g++)d.push(l.get(m,s,g));f=d.join(",")}var v=u.get(f);if(null!=v)c[s]=v;else{var y=u.size;u.set(f,y),c[s]=y,h.push(s)}}var b=o.slice();b[1]=u.size;var x=new r.TensorBuffer(b,i);h.forEach((function(t,e){for(var n=0;n<o[0];n++)for(var r=0;r<o[2];r++)x.set(l.get(n,t,r),n,e,r)}));var w=n.slice();return w[a]=b[1],{outputValues:x.values,outputShape:w,indices:c}}var ze={__proto__:null,addImpl:N,bincountImpl:D,bincountReduceImpl:M,bitwiseAndImpl:F,castImpl:T,ceilImpl:G,concatImpl:j,equalImpl:H,expImpl:K,expm1Impl:$,floorDivImpl:rt,floorImpl:tt,gatherNdImpl:ot,gatherV2Impl:st,greaterEqualImpl:ht,greaterImpl:ut,lessEqualImpl:vt,lessImpl:dt,linSpaceImpl:xt,logImpl:wt,maxImpl:Tt,maximumImpl:Et,minimumImpl:At,multiplyImpl:Rt,negImpl:Ft,notEqualImpl:Lt,prodImpl:Vt,raggedGatherImpl:qt,raggedRangeImpl:Yt,raggedTensorToTensorImpl:te,rangeImpl:ee,rsqrtImpl:ne,scatterImpl:ae,sigmoidImpl:oe,simpleAbsImpl:d,sliceImpl:ce,sparseFillEmptyRowsImpl:pe,sparseReshapeImpl:fe,sparseSegmentReductionImpl:de,sqrtImpl:me,squaredDifferenceImpl:ye,staticRegexReplaceImpl:we,stridedSliceImpl:Te,stringNGramsImpl:ke,stringSplitImpl:Ae,stringToHashBucketFastImpl:Ne,subImpl:Ce,tileImpl:Me,topKImpl:Le,transposeImpl:Ut,uniqueImpl:Be};r.registerBackend("cpu",(function(){return new f}),1);var Ue=z(r.Elu,(function(t){return t>=0?t:Math.exp(t)-1})),Ge={kernelName:r.Elu,backendName:"cpu",kernelFunc:Ue};function We(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.alpha;h([a],"leakyRelu");for(var s=r.util.sizeFromShape(a.shape),u=n.data.get(a.dataId).values,c=r.util.getTypedArrayFromDType("float32",s),l=0;l<u.length;l++)c[l]=u[l]<0?o*u[l]:u[l];return n.makeTensorInfo(a.shape,"float32",c)}var Ve={kernelName:r.LeakyRelu,backendName:"cpu",kernelFunc:We},je=g((function(t,e){return t<0?e*t:t}));function He(t){var e=t.inputs,n=t.backend,r=e.x,i=e.alpha;h([r,i],"prelu");var a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=c(je(r.shape,i.shape,a,o,"float32"),2),u=s[0],l=s[1];return n.makeTensorInfo(l,"float32",u)}var Xe={kernelName:r.Prelu,backendName:"cpu",kernelFunc:He},qe=z(r.Relu,(function(t){return Math.max(0,t)})),Ke={kernelName:r.Relu,backendName:"cpu",kernelFunc:qe},Ye=z(r.Relu6,(function(t){return Math.min(Math.max(0,t),6)})),Ze={kernelName:r.Relu6,backendName:"cpu",kernelFunc:Ye};function $e(t,e,n,r,i){if("linear"===n)return x({inputs:{x:e},backend:t});if("relu"===n)return qe({inputs:{x:e},backend:t});if("elu"===n)return Ue({inputs:{x:e},backend:t});if("relu6"===n)return Ye({inputs:{x:e},backend:t});if("prelu"===n)return He({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return We({inputs:{x:e},backend:t,attrs:{alpha:i}});if("sigmoid"===n)return se({inputs:{x:e},backend:t});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function Je(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.shape,s=r.util.sizeFromShape(a.shape),u=r.util.inferFromImplicitShape(o,s),c=r.util.sizeFromShape(u);r.util.assert(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var l=n.data.get(a.dataId);if(null!=l.complexTensorInfos){var h=l.complexTensorInfos.real,p=l.complexTensorInfos.imag;h.shape=u,p.shape=u}return{dataId:a.dataId,shape:u,dtype:a.dtype}}var Qe={kernelName:r.Reshape,backendName:"cpu",kernelFunc:Je};function tn(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.a,o=e.b,s=i.transposeA,u=i.transposeB;h([a,o],"matMul");var l=a.shape.length,p=o.shape.length,f=s?a.shape[l-2]:a.shape[l-1],d=u?o.shape[p-1]:o.shape[p-2],m=s?a.shape[l-1]:a.shape[l-2],g=u?o.shape[p-2]:o.shape[p-1],v=a.shape.slice(0,-2),y=o.shape.slice(0,-2),b=r.util.sizeFromShape(v),x=r.util.sizeFromShape(y),w=r.broadcast_util.assertAndGetBroadcastShape(a.shape.slice(0,-2),o.shape.slice(0,-2)).concat([m,g]);r.util.assert(f===d,(function(){return"Error in matMul: inner shapes (".concat(f,") and (")+"".concat(d,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," and transposeA=").concat(s)+" and transposeB=".concat(u," must match.")}));for(var _=u?[x,g,d]:[x,d,g],S=Je({inputs:{x:a},backend:n,attrs:{shape:s?[b,f,m]:[b,m,f]}}),T=Je({inputs:{x:o},backend:n,attrs:{shape:_}}),E=s?S.shape[1]:S.shape[2],k=s?S.shape[2]:S.shape[1],I=u?T.shape[1]:T.shape[2],A=Math.max(b,x),N=n.data.get(S.dataId).values,C=n.data.get(T.dataId).values,R=r.util.computeStrides(S.shape),O=r.util.computeStrides(T.shape),D=c(s?[R[0],1,R[1]]:[R[0],R[1],1],3),M=D[0],F=D[1],P=D[2],L=c(u?[1,O[1],O[0]]:[O[1],1,O[0]],3),B=L[0],z=L[1],U=L[2],G=k*I,W=r.buffer([A,k,I],S.dtype),V=W.values,j=n.blockSize,H=0;H<A;H++)for(var X=H%b,q=H%x,K=0;K<k;K+=j)for(var Y=Math.min(K+j,k),Z=0;Z<I;Z+=j)for(var $=Math.min(Z+j,I),J=0;J<E;J+=j)for(var Q=Math.min(J+j,E),tt=K;tt<Y;tt++)for(var et=Z;et<$;et++){for(var nt=0,rt=J;rt<Q;rt++)nt+=N[X*M+tt*F+rt*P]*C[rt*B+et*z+q*U];V[H*G+(tt*I+et)]+=nt}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(T),n.makeTensorInfo(w,W.dtype,W.values)}var en={kernelName:r.BatchMatMul,backendName:"cpu",kernelFunc:tn},nn={kernelName:r._FusedMatMul,backendName:"cpu",kernelFunc:function(t){var e,n,r,i,a,o=t.inputs,s=t.backend,c=t.attrs,l=o.a,h=o.b,p=o.bias,f=o.preluActivationWeights,d=c.transposeA,m=c.transposeB,g=c.activation,v=c.leakyreluAlpha,y=[];r=tn({inputs:{a:l,b:h},attrs:{transposeA:d,transposeB:m},backend:s}),p&&(i=R({inputs:{a:r,b:p},backend:s}),y.push(r),r=i),g&&(a=$e(s,r,g,f,v),y.push(r),r=a);try{for(var b=u(y),x=b.next();!x.done;x=b.next()){var w=x.value;s.disposeIntermediateTensorInfo(w)}}catch(t){e={error:t}}finally{try{x&&!x.done&&(n=b.return)&&n.call(b)}finally{if(e)throw e.error}}return r}},rn=z(r.Acos,(function(t){return Math.acos(t)})),an={kernelName:r.Acos,backendName:"cpu",kernelFunc:rn},on=z(r.Acosh,(function(t){return Math.acosh(t)})),sn={kernelName:r.Acosh,backendName:"cpu",kernelFunc:on},un={kernelName:r.AddN,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e;h(e,"addN");for(var a=i.map((function(t){return n.data.get(t.dataId).values})),o=r.buffer(i[0].shape,i[0].dtype),s=o.values,u=0;u<i.length;u++)for(var c=a[u],l=0;l<s.length;l++)s[l]+=c[l];return n.makeTensorInfo(o.shape,o.dtype,o.values)}},cn={kernelName:r.All,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims;h(a,"all");var u=r.util.parseAxisParam(o,a.shape),l=u,p=r.backend_util.getAxesPermutation(l,a.shape.length),f=a;null!=p&&(f=Gt({inputs:{x:a},backend:n,attrs:{perm:p}}),l=r.backend_util.getInnerMostAxes(l.length,a.shape.length)),r.backend_util.assertAxesAreInnerMostDims("all",l,f.shape.length);for(var d=c(r.backend_util.computeOutAndReduceShapes(f.shape,l),2),m=d[0],g=d[1],v=r.util.sizeFromShape(g),y=r.util.makeZerosTypedArray(r.util.sizeFromShape(m),f.dtype),b=n.data.get(f.dataId).values,x=0;x<y.length;++x){for(var w=x*v,_=b[w],S=0;S<v;++S){var T=b[w+S];_=_&&T}y[x]=_}null!=p&&n.disposeIntermediateTensorInfo(f);var E=n.makeTensorInfo(m,f.dtype,y);if(s){var k=Je({inputs:{x:E},backend:n,attrs:{shape:r.backend_util.expandShapeToKeepDim(m,u)}});return n.disposeIntermediateTensorInfo(E),k}return E}},ln={kernelName:r.Any,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims;h(a,"any");var u=r.util.parseAxisParam(o,a.shape),l=u,p=r.backend_util.getAxesPermutation(l,a.shape.length),f=a;null!=p&&(f=Gt({inputs:{x:a},backend:n,attrs:{perm:p}}),l=r.backend_util.getInnerMostAxes(l.length,a.shape.length)),r.backend_util.assertAxesAreInnerMostDims("any",l,f.shape.length);for(var d=c(r.backend_util.computeOutAndReduceShapes(f.shape,l),2),m=d[0],g=d[1],v=r.util.sizeFromShape(g),y=r.util.makeZerosTypedArray(r.util.sizeFromShape(m),f.dtype),b=n.data.get(f.dataId).values,x=0;x<y.length;++x){for(var w=x*v,_=b[w],S=0;S<v;++S){var T=b[w+S];_=_||T}y[x]=_}null!=p&&n.disposeIntermediateTensorInfo(f);var E=n.makeTensorInfo(m,f.dtype,y);if(s){var k=Je({inputs:{x:E},backend:n,attrs:{shape:r.backend_util.expandShapeToKeepDim(m,u)}});return n.disposeIntermediateTensorInfo(E),k}return E}},hn={kernelName:r.ArgMax,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis;h(a,"argMax");var s=r.util.parseAxisParam(o,a.shape),u=r.backend_util.getAxesPermutation(s,a.shape.length),l=a,p=[];null!=u&&(l=Gt({inputs:{x:a},backend:n,attrs:{perm:u}}),p.push(l),s=r.backend_util.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],r.backend_util.assertAxesAreInnerMostDims("argMax",s,l.shape.length);for(var f=c(r.backend_util.computeOutAndReduceShapes(l.shape,s),2),d=f[0],m=f[1],g=r.util.sizeFromShape(d),v=r.util.makeZerosTypedArray(g,"int32"),y=r.util.sizeFromShape(m),b=n.data.get(l.dataId).values,x=0;x<v.length;++x){for(var w=x*y,_=b[w],S=0,T=0;T<y;++T){var E=b[w+T];E>_&&(_=E,S=T)}v[x]=S}return p.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.makeTensorInfo(d,"int32",v)}},pn={kernelName:r.ArgMin,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis;h(a,"argMin");var s=r.util.parseAxisParam(o,a.shape),u=r.backend_util.getAxesPermutation(s,a.shape.length),l=a,p=[];null!=u&&(l=Gt({inputs:{x:a},backend:n,attrs:{perm:u}}),p.push(l),s=r.backend_util.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],r.backend_util.assertAxesAreInnerMostDims("argMin",s,l.shape.length);for(var f=c(r.backend_util.computeOutAndReduceShapes(l.shape,s),2),d=f[0],m=f[1],g=r.util.sizeFromShape(d),v=r.util.makeZerosTypedArray(g,"int32"),y=r.util.sizeFromShape(m),b=n.data.get(l.dataId).values,x=0;x<v.length;++x){for(var w=x*y,_=b[w],S=0,T=0;T<y;++T){var E=b[w+T];E<_&&(_=E,S=T)}v[x]=S}return p.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.makeTensorInfo(d,"int32",v)}},fn=z(r.Asin,(function(t){return Math.asin(t)})),dn={kernelName:r.Asin,backendName:"cpu",kernelFunc:fn},mn=z(r.Asinh,(function(t){return Math.asinh(t)})),gn={kernelName:r.Asinh,backendName:"cpu",kernelFunc:mn},vn=z(r.Atan,(function(t){return Math.atan(t)})),yn={kernelName:r.Atan,backendName:"cpu",kernelFunc:vn},bn=g((function(t,e){return Math.atan2(t,e)})),xn=I(r.Atan2,bn),wn={kernelName:r.Atan2,backendName:"cpu",kernelFunc:xn},_n=z(r.Atanh,(function(t){return Math.atanh(t)})),Sn={kernelName:r.Atanh,backendName:"cpu",kernelFunc:_n};function Tn(t,e,n,i,a,o){for(var s=a.strideHeight,u=a.strideWidth,c=a.dilationHeight,l=a.dilationWidth,h=a.effectiveFilterHeight,p=a.effectiveFilterWidth,f=a.padInfo.top,d=a.padInfo.left,m="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=r.buffer(a.outShape,n),v=g.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],x=a.outShape[3],w=0;w<a.batchSize;++w)for(var _=w*y,S=w*i[0],T=0;T<a.inChannels;++T)for(var E=0;E<a.outHeight;++E)for(var k=E*s-f,I=Math.max(0,k),A=Math.min(a.inHeight,h+k),N=_+E*b,C=0;C<a.outWidth;++C){for(var R=C*u-d,O=Math.max(0,R),D=Math.min(a.inWidth,p+R),M=m,F=0,P=0,L=I;L<A;L+=c){for(var B=S+L*i[1],z=O;z<D;z+=l){var U=t[B+z*i[2]+T];"max"===o&&U>M?M=U:"avg"===o&&(F+=U,P++)}if(isNaN(M))break}v[N+C*x+T]="avg"===o?F/P:M}return g}function En(t,e,n,i,a,o){void 0===a&&(a=!1),void 0===o&&(o=!1);for(var s=r.buffer(i.outShape,"int32"),u=i.strideHeight,c=i.strideWidth,l=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,m=i.padInfo.left,g=r.buffer(e,n,t),v=0;v<i.batchSize;++v)for(var y=0;y<i.inChannels;++y)for(var b=0;b<i.outHeight;++b){for(var x=b*u-d,w=x;w<0;)w+=l;for(var _=Math.min(i.inHeight,p+x),S=0;S<i.outWidth;++S){for(var T=S*c-m,E=T;E<0;)E+=h;for(var k=Math.min(i.inWidth,f+T),I=Number.NEGATIVE_INFINITY,A=-1,N=w;N<_;N+=l)for(var C=N-x,R=E;R<k;R+=h){var O=R-T,D=g.get(v,N,R,y);D>I&&(I=D,A=a?o?((v*i.inHeight+N)*i.inWidth+R)*i.inChannels+y:(N*i.inWidth+R)*i.inChannels+y:C*f+O)}s.set(A,v,b,S,y)}}return s}function kn(t,e,n,i,a,o){for(var s=a.strideDepth,u=a.strideHeight,c=a.strideWidth,l=a.dilationDepth,h=a.dilationHeight,p=a.dilationWidth,f=a.effectiveFilterDepth,d=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=a.padInfo.front,v=a.padInfo.top,y=a.padInfo.left,b="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=r.buffer(a.outShape,n),w=x.values,_=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[2]*a.outShape[3]*a.outShape[4],T=a.outShape[3]*a.outShape[4],E=a.outShape[4],k=0;k<a.batchSize;++k)for(var I=k*_,A=k*i[0],N=0;N<a.inChannels;++N)for(var C=0;C<a.outDepth;++C){for(var R=C*s-g,O=R;O<0;)O+=l;for(var D=Math.min(a.inDepth,f+R),M=I+C*S,F=0;F<a.outHeight;++F){for(var P=F*u-v,L=P;L<0;)L+=h;for(var B=Math.min(a.inHeight,d+P),z=M+F*T,U=0;U<a.outWidth;++U){for(var G=U*c-y,W=G;W<0;)W+=p;for(var V=Math.min(a.inWidth,m+G),j=z+U*E,H=b,X=0,q=0,K=O;K<D;K+=l){for(var Y=A+K*i[1],Z=L;Z<B;Z+=h){for(var $=Y+Z*i[2],J=W;J<V;J+=p){var Q=t[$+J*i[3]+N];if("max"===o&&Q>H?H=Q:"avg"===o&&(X+=Q,q++),isNaN(H))break}if(isNaN(H))break}if(isNaN(H))break}w[j+N]="avg"===o?X/Math.max(q,1):H}}}return x}var In={kernelName:r.AvgPool,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x;h(a,"avgPool");var o=i.filterSize,s=i.strides,u=i.pad,c=i.dimRoundingMode;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l,p=r.backend_util.computePool2DInfo(a.shape,o,s,1,u,c);if(1===p.filterWidth&&1===p.filterHeight&&r.util.arraysEqual(p.inShape,p.outShape))l=x({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,d=r.util.computeStrides(a.shape),m=Tn(f,a.shape,a.dtype,d,p,"avg");l=n.makeTensorInfo(p.outShape,a.dtype,m.values)}return l}},An={kernelName:r.AvgPool3D,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.filterSize,s=i.strides,u=i.pad,c=i.dimRoundingMode,l=i.dataFormat;h(a,"avgPool3d");var p=r.backend_util.computePool3DInfo(a.shape,o,s,1,u,c,l),f=kn(n.data.get(a.dataId).values,a.shape,a.dtype,r.util.computeStrides(a.shape),p,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}},Nn={kernelName:r.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=i.filterSize,u=i.strides,c=i.pad,l=i.dimRoundingMode;h([a,o],"avgPool3DGrad");for(var p=r.backend_util.computePool3DInfo(o.shape,s,u,1,c,l),f=p.strideDepth,d=p.strideHeight,m=p.strideWidth,g=p.filterDepth,v=p.filterHeight,y=p.filterWidth,b=p.dilationDepth,x=p.dilationHeight,w=p.dilationWidth,_=p.effectiveFilterDepth,S=p.effectiveFilterHeight,T=p.effectiveFilterWidth,E=_-1-p.padInfo.front,k=T-1-p.padInfo.left,I=S-1-p.padInfo.top,A=r.buffer(o.shape,"float32"),N=1/(g*v*y),C=n.bufferSync(a),R=0;R<p.batchSize;++R)for(var O=0;O<p.inChannels;++O)for(var D=0;D<p.inDepth;++D)for(var M=0;M<p.inHeight;++M)for(var F=0;F<p.inWidth;++F){for(var P=D-E,L=M-I,B=F-k,z=0,U=0;U<_;U+=b){var G=(P+U)/f;if(!(G<0||G>=p.outDepth||Math.floor(G)!==G))for(var W=0;W<S;W+=x){var V=(L+W)/d;if(!(V<0||V>=p.outHeight||Math.floor(V)!==V))for(var j=0;j<T;j+=w){var H=(B+j)/m;H<0||H>=p.outWidth||Math.floor(H)!==H||(z+=C.get(R,G,V,H,O))}}}A.set(z*N,R,D,M,F,O)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}},Cn={kernelName:r.AvgPoolGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=o;h([a,o],"avgPoolGrad");for(var u=i.filterSize,c=i.strides,l=i.pad,p=r.backend_util.computePool2DInfo(s.shape,u,c,1,l),f=p.strideHeight,d=p.strideWidth,m=p.filterHeight,g=p.filterWidth,v=p.dilationHeight,y=p.dilationWidth,b=p.effectiveFilterHeight,x=p.effectiveFilterWidth,w=x-1-p.padInfo.left,_=b-1-p.padInfo.top,S=r.buffer(s.shape,"float32"),T=1/(m*g),E=n.data.get(a.dataId).values,k=r.buffer(a.shape,"float32",E),I=0;I<p.batchSize;++I)for(var A=0;A<p.inChannels;++A)for(var N=0;N<p.inHeight;++N)for(var C=0;C<p.inWidth;++C){for(var R=N-_,O=C-w,D=0,M=0;M<b;M+=v){var F=(R+M)/f;if(!(F<0||F>=p.outHeight||Math.floor(F)!==F))for(var P=0;P<x;P+=y){var L=(O+P)/d;L<0||L>=p.outWidth||Math.floor(L)!==L||(D+=k.get(I,F,L,A))}}S.set(D*T,I,N,C,A)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}},Rn={kernelName:r.FusedBatchNorm,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.scale,s=e.offset,u=e.mean,c=e.variance;r.util.assert(u.shape.length===c.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),r.util.assert(null==s||u.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),r.util.assert(null==o||u.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),h([a,u,c,o,s],"batchNorm");var l=i.varianceEpsilon;null==l&&(l=.001);for(var p=n.data.get(a.dataId).values,f=n.data.get(u.dataId).values,d=n.data.get(c.dataId).values,m=o?n.data.get(o.dataId).values:new Float32Array([1]),g=s?n.data.get(s.dataId).values:new Float32Array([0]),v=new Float32Array(p.length),y=g.length,b=m.length,x=d.length,w=f.length,_=0,S=0,T=0,E=0,k=0;k<p.length;++k)v[k]=g[_++]+(p[k]-f[S++])*m[T++]/Math.sqrt(d[E++]+l),_>=y&&(_=0),S>=w&&(S=0),T>=b&&(T=0),E>=x&&(E=0);return n.makeTensorInfo(a.shape,a.dtype,v)}},On={kernelName:r.BatchToSpaceND,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.blockShape,s=i.crops;h([a],"batchToSpaceND");var u=o.reduce((function(t,e){return t*e})),c=r.backend_util.getReshaped(a.shape,o,u),l=r.backend_util.getPermuted(c.length,o.length),p=r.backend_util.getReshapedPermuted(a.shape,o,u),f=r.backend_util.getSliceBeginCoords(s,o.length),d=r.backend_util.getSliceSize(p,s,o.length),m=Je({inputs:{x:a},backend:n,attrs:{shape:c}}),g=Gt({inputs:{x:m},backend:n,attrs:{perm:l}}),v=Je({inputs:{x:g},backend:n,attrs:{shape:p}}),y=le({inputs:{x:v},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),y}},Dn={kernelName:r.Bincount,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=e.weights,o=r.size,s=D(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,s)}},Mn={kernelName:r.BroadcastArgs,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.s0,a=e.s1,o=n.data.get(i.dataId).values,s=n.data.get(a.dataId).values,u=r.backend_util.assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}},Fn=z(r.ClipByValue,(function(t,e){var n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t})),Pn={kernelName:r.ClipByValue,backendName:"cpu",kernelFunc:Fn},Ln={kernelName:r.ComplexAbs,backendName:"cpu",kernelFunc:function(t){for(var e=t.inputs.x,n=t.backend,i=new Float32Array(r.util.sizeFromShape(e.shape)),a=n.data.get(e.dataId),o=a.complexTensorInfos.real,s=a.complexTensorInfos.imag,u=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values,l=0;l<u.length;l++){var h=u[l],p=c[l];i[l]=Math.hypot(h,p)}return n.makeOutput(i,e.shape,"float32")}};function Bn(t){var e=t.inputs,n=t.backend,r=e.input,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}var zn={kernelName:r.Imag,backendName:"cpu",kernelFunc:Bn};function Un(t){var e=t.inputs,n=t.backend,i=t.attrs.axis,a=r.util.parseAxisParam(i,e[0].shape)[0],o=e.map((function(t){return t.shape}));r.backend_util.assertParamsConsistent(o,a);var s=r.backend_util.computeOutShape(e.map((function(t){return t.shape})),a);if(0===r.util.sizeFromShape(s))return n.makeTensorInfo(s,e[0].dtype,[]);var u=e.filter((function(t){return r.util.sizeFromShape(t.shape)>0}));if(1===u.length)return x({inputs:{x:u[0]},backend:n});if("complex64"===u[0].dtype){var c=u.map((function(t){return _({inputs:{input:t},backend:n})})),l=u.map((function(t){return Bn({inputs:{input:t},backend:n})})),h=Un({inputs:c,backend:n,attrs:{axis:a}}),p=Un({inputs:l,backend:n,attrs:{axis:a}}),f=v({inputs:{real:h,imag:p},backend:n});return c.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),l.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}var d=u.map((function(t){var e=r.util.sizeFromShape(t.shape.slice(a));return Je({inputs:{x:t},backend:n,attrs:{shape:[-1,e]}})})),m=d.map((function(t){return{vals:n.data.get(t.dataId).values,shape:t.shape}}));s=r.backend_util.computeOutShape(d.map((function(t){return t.shape})),1);var g=1===d[0].shape[0],y=j(m,s,e[0].dtype,g),b=r.backend_util.computeOutShape(u.map((function(t){return t.shape})),a),w=n.makeTensorInfo(b,e[0].dtype,y);return d.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),w}var Gn={kernelName:r.Concat,backendName:"cpu",kernelFunc:Un};function Wn(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=i.strides,u=i.pad,c=i.dataFormat,l=i.dilations,p=i.dimRoundingMode;h([a,o],"conv2d");for(var f=r.backend_util.convertConv2DDataFormat(c),d=r.backend_util.computeConv2DInfo(a.shape,o.shape,s,l,u,p,!1,f),m=d.filterHeight,g=d.filterWidth,v=d.dilationHeight,y=d.dilationWidth,b=d.padInfo.left,x=d.padInfo.top,w="channelsLast"===d.dataFormat,_=new r.TensorBuffer(d.outShape,a.dtype),S=r.util.computeStrides(a.shape),T=r.util.computeStrides(o.shape),E=S[0],k=w?S[1]:S[2],I=w?S[2]:1,A=w?1:S[1],N=_.strides[0],C=w?_.strides[1]:_.strides[2],R=w?_.strides[2]:1,O=w?1:_.strides[1],D=n.data.get(a.dataId).values,M=n.data.get(o.dataId).values,F=_.values,P=0;P<d.batchSize;++P)for(var L=P*E,B=P*N,z=0;z<d.outHeight;++z)for(var U=B+z*C,G=z*d.strideHeight-x,W=0;W<m;++W){var V=G+W*v;if(!(V<0||V>=d.inHeight))for(var j=W*T[0],H=L+V*k,X=0;X<d.outWidth;++X)for(var q=U+X*R,K=X*d.strideWidth-b,Y=0;Y<g;++Y){var Z=K+Y*y;if(!(Z<0||Z>=d.inWidth))for(var $=H+Z*I,J=j+Y*T[1],Q=0;Q<d.inChannels;++Q){for(var tt=D[$+Q*A],et=0;et<d.outChannels;++et)F[q+et*O]+=tt*M[J+et];J+=d.outChannels}}}return n.makeTensorInfo(_.shape,_.dtype,F)}var Vn={kernelName:r.Conv2D,backendName:"cpu",kernelFunc:Wn},jn={kernelName:r.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.dy,s=i.strides,u=i.pad,c=i.dataFormat,l=i.dimRoundingMode,p=i.filterShape;h([a,o],"conv2dBackpropFilter");for(var f=r.backend_util.convertConv2DDataFormat(c),d=r.backend_util.computeConv2DInfo(a.shape,p,s,1,u,l,!1,f),m=d.strideHeight,g=d.strideWidth,v=d.filterHeight,y=d.filterWidth,b="channelsLast"===d.dataFormat,x=new r.TensorBuffer(d.filterShape,"float32"),w=d.padInfo.left,_=d.padInfo.top,S=n.data.get(a.dataId).values,T=n.data.get(o.dataId).values,E=new r.TensorBuffer(a.shape,a.dtype,S),k=new r.TensorBuffer(o.shape,o.dtype,T),I=0;I<v;++I)for(var A=Math.max(0,Math.ceil((_-I)/m)),N=Math.min(d.outHeight,(d.inHeight+_-I)/m),C=0;C<y;++C)for(var R=Math.max(0,Math.ceil((w-C)/g)),O=Math.min(d.outWidth,(d.inWidth+w-C)/g),D=0;D<d.inChannels;++D)for(var M=0;M<d.outChannels;++M){for(var F=0,P=0;P<d.batchSize;++P)for(var L=A;L<N;++L)for(var B=I+L*m-_,z=R;z<O;++z){var U=C+z*g-w;F+=b?E.get(P,B,U,D)*k.get(P,L,z,M):E.get(P,D,B,U)*k.get(P,M,L,z)}x.set(F,I,C,D,M)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}},Hn={kernelName:r.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.filter,s=i.inputShape,u=i.strides,l=i.pad,p=i.dataFormat,f=i.dimRoundingMode;h([a,o],"conv2dBackpropInput");var d=r.util.computeStrides(o.shape),m=r.util.computeStrides(a.shape),g=r.backend_util.convertConv2DDataFormat(p),v=r.backend_util.computeConv2DInfo(s,o.shape,u,1,l,f,!1,g),y=new r.TensorBuffer(v.inShape,"float32"),b=y.values,x=n.data.get(a.dataId).values,w=n.data.get(o.dataId).values,_=c(d,3),S=_[0],T=_[1],E=_[2],k=v.batchSize,I=v.filterHeight,A=v.filterWidth,N=v.inChannels,C=v.inHeight,R=v.inWidth,O=v.outChannels,D=v.outHeight,M=v.outWidth,F=v.strideHeight,P=v.strideWidth;g=v.dataFormat;for(var L=I-1-v.padInfo.top,B=A-1-v.padInfo.left,z="channelsLast"===g,U=y.strides[0],G=z?y.strides[1]:y.strides[2],W=z?y.strides[2]:1,V=z?1:y.strides[1],j=m[0],H=z?m[1]:m[2],X=z?m[2]:1,q=z?1:m[1],K=0;K<k;++K)for(var Y=0;Y<N;++Y)for(var Z=0;Z<C;++Z)for(var $=Z-L,J=Math.max(0,Math.ceil($/F)),Q=Math.min(D,(I+$)/F),tt=0;tt<R;++tt){for(var et=tt-B,nt=Math.max(0,Math.ceil(et/P)),rt=Math.min(M,(A+et)/P),it=0,at=J;at<Q;++at)for(var ot=at*F-$,st=nt;st<rt;++st)for(var ut=j*K+H*at+X*st,ct=S*(I-1-ot)+T*(A-1-(st*P-et))+E*Y,lt=0;lt<O;++lt)it+=x[ut+q*lt]*w[ct+lt];b[U*K+G*Z+W*tt+V*Y]=it}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},Xn={kernelName:r.Conv3D,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=i.strides,u=i.pad,c=i.dilations;h([a,o],"conv3d");for(var l=r.backend_util.computeConv3DInfo(a.shape,o.shape,s,c,u),p=l.filterDepth,f=l.filterHeight,d=l.filterWidth,m=l.dilationDepth,g=l.dilationHeight,v=l.dilationWidth,y=l.padInfo,b=y.front,x=y.left,w=y.top,_=new r.TensorBuffer(l.outShape,a.dtype),S=n.data.get(a.dataId).values,T=n.data.get(o.dataId).values,E=_.values,k=r.util.computeStrides(a.shape),I=r.util.computeStrides(o.shape),A=0;A<l.batchSize;++A)for(var N=A*k[0],C=A*_.strides[0],R=0;R<l.outDepth;++R)for(var O=C+R*_.strides[1],D=R*l.strideDepth-b,M=0;M<p;++M){var F=D+M*m;if(!(F<0||F>=l.inDepth))for(var P=M*I[0],L=N+F*k[1],B=0;B<l.outHeight;++B)for(var z=O+B*_.strides[2],U=B*l.strideHeight-w,G=0;G<f;++G){var W=U+G*g;if(!(W<0||W>=l.inHeight))for(var V=P+G*I[1],j=L+W*k[2],H=0;H<l.outWidth;++H)for(var X=z+H*l.outChannels,q=H*l.strideWidth-x,K=0;K<d;++K){var Y=q+K*v;if(!(Y<0||Y>=l.inWidth))for(var Z=V+K*I[2],$=j+Y*l.inChannels,J=Z,Q=0;Q<l.inChannels;++Q){for(var tt=S[$+Q],et=0;et<l.outChannels;++et)E[X+et]+=tt*T[J+et];J+=l.outChannels}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}},qn={kernelName:r.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.dy,s=i.strides,u=i.pad,l=i.filterShape;h([a,o],"conv3dBackpropFilterV2");for(var p=r.util.computeStrides(a.shape),f=r.util.computeStrides(o.shape),d=r.backend_util.computeConv3DInfo(a.shape,l,s,1,u),m=d.strideDepth,g=d.strideHeight,v=d.strideWidth,y=d.filterDepth,b=d.filterHeight,x=d.filterWidth,w=new r.TensorBuffer(d.filterShape,"float32"),_=w.values,S=c(w.strides,4),T=S[0],E=S[1],k=S[2],I=S[3],A=n.data.get(o.dataId).values,N=c(f,4),C=N[0],R=N[1],O=N[2],D=N[3],M=n.data.get(a.dataId).values,F=c(p,4),P=F[0],L=F[1],B=F[2],z=F[3],U=d.padInfo.front,G=d.padInfo.left,W=d.padInfo.top,V=0;V<y;++V)for(var j=Math.max(0,Math.ceil((U-V)/m)),H=Math.min(d.outDepth,(d.inDepth+U-V)/m),X=V*T,q=0;q<b;++q)for(var K=Math.max(0,Math.ceil((W-q)/g)),Y=Math.min(d.outHeight,(d.inHeight+W-q)/g),Z=q*E+X,$=0;$<x;++$)for(var J=Math.max(0,Math.ceil((G-$)/v)),Q=Math.min(d.outWidth,(d.inWidth+G-$)/v),tt=$*k+Z,et=0;et<d.inChannels;++et)for(var nt=et*I+tt,rt=0;rt<d.outChannels;++rt){for(var it=0,at=0;at<d.batchSize;++at)for(var ot=at*P,st=at*C,ut=j;ut<H;++ut)for(var ct=(V+ut*m-U)*L+ot,lt=ut*R+st,ht=K;ht<Y;++ht)for(var pt=(q+ht*g-W)*B+ct,ft=ht*O+lt,dt=J;dt<Q;++dt){var mt=dt*D+ft;it+=M[($+dt*v-G)*z+pt+et]*A[mt+rt]}_[nt+rt]=it}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},Kn={kernelName:r.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.filter,s=i.pad,u=i.strides,l=i.inputShape;h([a],"conv3dBackpropInputV2");for(var p=r.util.computeStrides(a.shape),f=r.util.computeStrides(o.shape),d=r.backend_util.computeConv3DInfo(l,o.shape,u,1,s),m=new r.TensorBuffer(d.inShape,"float32"),g=m.values,v=c(m.strides,4),y=v[0],b=v[1],x=v[2],w=v[3],_=n.data.get(a.dataId).values,S=c(p,4),T=S[0],E=S[1],k=S[2],I=S[3],A=n.data.get(o.dataId).values,N=c(f,4),C=N[0],R=N[1],O=N[2],D=N[3],M=d.batchSize,F=d.filterDepth,P=d.filterHeight,L=d.filterWidth,B=d.inChannels,z=d.inDepth,U=d.inHeight,G=d.inWidth,W=d.outChannels,V=d.outDepth,j=d.outHeight,H=d.outWidth,X=d.strideDepth,q=d.strideHeight,K=d.strideWidth,Y=F-1-d.padInfo.front,Z=P-1-d.padInfo.top,$=L-1-d.padInfo.left,J=0;J<M;++J)for(var Q=0;Q<B;++Q)for(var tt=0;tt<z;++tt)for(var et=tt-Y,nt=Math.max(0,Math.ceil(et/X)),rt=Math.min(V,(F+et)/X),it=0;it<U;++it)for(var at=it-Z,ot=Math.max(0,Math.ceil(at/q)),st=Math.min(j,(P+at)/q),ut=0;ut<G;++ut){for(var ct=ut-$,lt=Math.max(0,Math.ceil(ct/K)),ht=Math.min(H,(L+ct)/K),pt=0,ft=nt;ft<rt;++ft)for(var dt=ft*X-et,mt=ot;mt<st;++mt)for(var gt=mt*q-at,vt=lt;vt<ht;++vt)for(var yt=T*J+E*ft+k*mt+I*vt,bt=C*(F-1-dt)+R*(P-1-gt)+O*(L-1-(vt*K-ct))+D*Q,xt=0;xt<W;++xt)pt+=_[yt+xt]*A[bt+xt];g[y*J+b*tt+x*it+w*ut+Q]=pt}return n.makeTensorInfo(m.shape,m.dtype,m.values)}},Yn=z(r.Cos,(function(t){return Math.cos(t)})),Zn={kernelName:r.Cos,backendName:"cpu",kernelFunc:Yn},$n=z(r.Cosh,(function(t){return Math.cosh(t)})),Jn={kernelName:r.Cosh,backendName:"cpu",kernelFunc:$n},Qn={kernelName:r.CropAndResize,backendName:"cpu",kernelFunc:function(t){for(var e=t.inputs,n=t.backend,i=t.attrs,a=e.image,o=e.boxes,s=e.boxInd,u=i.cropSize,l=i.method,h=i.extrapolationValue,p=c(a.shape,4),f=p[0],d=p[1],m=p[2],g=p[3],v=o.shape[0],y=c(u,2),b=y[0],x=y[1],w=r.buffer([v,b,x,g],"float32"),_=n.data.get(o.dataId).values,S=n.data.get(s.dataId).values,T=n.data.get(a.dataId).values,E=r.util.computeStrides(a.shape),k=r.util.computeStrides(w.shape),I=0;I<v;I++){var A=4*I,N=_[A],C=_[A+1],R=_[A+2],O=_[A+3],D=S[I];if(!(D>=f))for(var M=b>1?(R-N)*(d-1)/(b-1):0,F=x>1?(O-C)*(m-1)/(x-1):0,P=0;P<b;P++){var L=b>1?N*(d-1)+P*M:.5*(N+R)*(d-1);if(L<0||L>d-1)for(var B=0;B<x;B++)for(var z=0;z<g;z++){var U=z+B*k[2]+P*k[1]+I*k[0];w.values[U]=h}else if("bilinear"===l){var G=Math.floor(L),W=Math.ceil(L),V=L-G;for(B=0;B<x;B++)if((J=x>1?C*(m-1)+B*F:.5*(C+O)*(m-1))<0||J>m-1)for(z=0;z<g;z++)U=z+B*k[2]+P*k[1]+I*k[0],w.values[U]=h;else{var j=Math.floor(J),H=Math.ceil(J),X=J-j;for(z=0;z<g;z++){var q=T[U=z+j*E[2]+G*E[1]+D*E[0]],K=T[U=z+H*E[2]+G*E[1]+D*E[0]],Y=T[U=z+j*E[2]+W*E[1]+D*E[0]],Z=q+(K-q)*X,$=Y+(T[U=z+H*E[2]+W*E[1]+D*E[0]]-Y)*X;U=z+B*k[2]+P*k[1]+I*k[0],w.values[U]=Z+($-Z)*V}}}else for(B=0;B<x;++B){var J;if((J=x>1?C*(m-1)+B*F:.5*(C+O)*(m-1))<0||J>m-1)for(z=0;z<g;z++)U=z+B*k[2]+P*k[1]+I*k[0],w.values[U]=h;else{var Q=Math.round(J),tt=Math.round(L);for(z=0;z<g;z++){var et=z+Q*E[2]+tt*E[1]+D*E[0],nt=z+B*k[2]+P*k[1]+I*k[0];w.values[nt]=T[et]}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},tr={kernelName:r.Cumprod,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.exclusive,u=i.reverse;h(a,"cumprod");var c=r.backend_util.getAxesPermutation([o],a.shape.length),l=a;null!=c&&(l=Gt({inputs:{x:a},backend:n,attrs:{perm:c}}));var p=r.backend_util.getInnerMostAxes(1,a.shape.length)[0];if(p!==l.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(p));for(var f=r.upcastType(l.dtype,"int32"),d=r.util.makeOnesTypedArray(r.util.sizeFromShape(l.shape),f),m=n.data.get(l.dataId).values,g=l.shape[l.shape.length-1],v=u?function(t,e){return t+g-e-1}:function(t,e){return t+e},y=0;y<m.length;y+=g)for(var b=0;b<g;b++){var x=v(y,b);if(0===b)d[x]=s?1:m[x];else{var w=v(y,b-1);d[x]=s?m[w]*d[w]:m[x]*d[w]}}var _=n.makeTensorInfo(l.shape,f,d);if(null!=c){var S=Gt({inputs:{x:_},backend:n,attrs:{perm:r.backend_util.getUndoAxesPermutation(c)}});return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(l),S}return _}},er={kernelName:r.Cumsum,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.exclusive,u=i.reverse;h(a,"cumsum");var c=r.backend_util.getAxesPermutation([o],a.shape.length),l=a;null!=c&&(l=Gt({inputs:{x:a},backend:n,attrs:{perm:c}}));var p=r.backend_util.getInnerMostAxes(1,a.shape.length)[0];if(p!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(p));for(var f=r.upcastType(l.dtype,"int32"),d=r.util.makeZerosTypedArray(r.util.sizeFromShape(l.shape),f),m=n.data.get(l.dataId).values,g=l.shape[l.shape.length-1],v=u?function(t,e){return t+g-e-1}:function(t,e){return t+e},y=0;y<m.length;y+=g)for(var b=0;b<g;b++){var x=v(y,b);if(0===b)d[x]=s?0:m[x];else{var w=v(y,b-1);d[x]=s?m[w]+d[w]:m[x]+d[w]}}var _=n.makeTensorInfo(l.shape,f,d);if(null!=c){var S=Gt({inputs:{x:_},backend:n,attrs:{perm:r.backend_util.getUndoAxesPermutation(c)}});return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(l),S}return _}},nr={kernelName:r.DenseBincount,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=e.weights,o=r.size,s=r.binaryOutput;if(1===i.shape.length){var u=D(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,u)}if(2===i.shape.length){var c=M(n.bufferSync(i),n.bufferSync(a),o,s);return n.makeTensorInfo(c.shape,a.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(i.shape.length,"."))}},rr={kernelName:r.DepthToSpace,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.blockSize,s=i.dataFormat;r.util.assert("NHWC"===s,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(s)}));for(var u=a.shape[0],c=a.shape[1],l=a.shape[2],h=a.shape[3],p=c*o,f=l*o,d=h/(o*o),m=n.data.get(a.dataId).values,g=new Float32Array(u*p*f*d),v=0,y=0;y<u;++y)for(var b=0;b<p;++b)for(var x=Math.floor(b/o),w=b%o,_=0;_<f;++_)for(var S=Math.floor(_/o),T=(w*o+_%o)*d,E=0;E<d;++E){var k=E+T+h*(S+l*(x+c*y));g[v++]=m[k]}return n.makeTensorInfo([u,p,f,d],a.dtype,g)}};function ir(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=i.strides,u=i.pad,c=i.dilations,l=i.dimRoundingMode;h([a,o],"depthwiseConv2DNative");var p=r.util.computeStrides(a.shape),f=r.util.computeStrides(o.shape),d=c;null==d&&(d=[1,1]),r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(s,d),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(d,"'")}));for(var m=r.backend_util.computeConv2DInfo(a.shape,o.shape,s,d,u,l,!0),g=m.filterHeight,v=m.filterWidth,y=m.dilationHeight,b=m.dilationWidth,x=m.padInfo,w=x.left,_=x.top,S=m.outChannels/m.inChannels,T=new r.TensorBuffer(m.outShape,a.dtype),E=n.data.get(a.dataId).values,k=n.data.get(o.dataId).values,I=T.values,A=0;A<m.batchSize;++A)for(var N=A*p[0],C=A*T.strides[0],R=0;R<m.outHeight;++R)for(var O=C+R*T.strides[1],D=R*m.strideHeight-_,M=0;M<g;++M){var F=D+M*y;if(!(F<0||F>=m.inHeight))for(var P=M*f[0],L=N+F*p[1],B=0;B<m.outWidth;++B)for(var z=O+B*T.strides[2],U=B*m.strideWidth-w,G=0;G<v;++G){var W=U+G*b;if(!(W<0||W>=m.inWidth))for(var V=P+G*f[1],j=L+W*m.inChannels,H=z,X=V,q=0;q<m.inChannels;++q){for(var K=E[j+q],Y=0;Y<S;++Y)I[H+Y]+=K*k[X+Y];H+=S,X+=S}}}return n.makeTensorInfo(T.shape,T.dtype,T.values)}var ar={kernelName:r.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:ir},or={kernelName:r.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.dy,s=i.strides,u=i.dilations,c=i.pad,l=i.dimRoundingMode,p=i.filterShape;h([a,o],"depthwiseConv2dNativeBackpropFilter");for(var f=r.backend_util.computeConv2DInfo(a.shape,p,s,u,c,l,!0),d=f.strideHeight,m=f.strideWidth,g=f.filterHeight,v=f.filterWidth,y=new r.TensorBuffer(f.filterShape,"float32"),b=f.padInfo.left,x=f.padInfo.top,w=f.outChannels/f.inChannels,_=n.data.get(a.dataId).values,S=new r.TensorBuffer(a.shape,a.dtype,_),T=n.data.get(o.dataId).values,E=new r.TensorBuffer(o.shape,o.dtype,T),k=0;k<g;++k)for(var I=Math.max(0,Math.ceil((x-k)/d)),A=Math.min(f.outHeight,(f.inHeight+x-k)/d),N=0;N<v;++N)for(var C=Math.max(0,Math.ceil((b-N)/m)),R=Math.min(f.outWidth,(f.inWidth+b-N)/m),O=0;O<f.outChannels;++O){for(var D=Math.trunc(O/w),M=O%w,F=0,P=0;P<f.batchSize;++P)for(var L=I;L<A;++L)for(var B=k+L*d-x,z=C;z<R;++z){var U=N+z*m-b;F+=S.get(P,B,U,D)*E.get(P,L,z,O)}y.set(F,k,N,D,M)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},sr={kernelName:r.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.filter,s=i.strides,u=i.dilations,l=i.pad,p=i.dimRoundingMode,f=i.inputShape;h([a,o],"depthwiseConv2DNativeBackpropInput");for(var d=r.util.computeStrides(a.shape),m=r.util.computeStrides(o.shape),g=r.backend_util.computeConv2DInfo(f,o.shape,s,u,l,p,!0),v=new r.TensorBuffer(g.inShape,"float32"),y=v.values,b=c(v.strides,3),x=b[0],w=b[1],_=b[2],S=n.data.get(a.dataId).values,T=c(d,3),E=T[0],k=T[1],I=T[2],A=n.data.get(o.dataId).values,N=c(m,3),C=N[0],R=N[1],O=N[2],D=g.batchSize,M=g.filterHeight,F=g.filterWidth,P=g.inChannels,L=g.inHeight,B=g.inWidth,z=g.outChannels,U=g.outHeight,G=g.outWidth,W=g.strideHeight,V=g.strideWidth,j=M-1-g.padInfo.top,H=F-1-g.padInfo.left,X=z/P,q=0;q<D;++q)for(var K=0;K<P;++K)for(var Y=0;Y<L;++Y)for(var Z=Y-j,$=Math.max(0,Math.ceil(Z/W)),J=Math.min(U,(M+Z)/W),Q=0;Q<B;++Q){for(var tt=Q-H,et=Math.max(0,Math.ceil(tt/V)),nt=Math.min(G,(F+tt)/V),rt=0,it=$;it<J;++it)for(var at=it*W-Z,ot=et;ot<nt;++ot)for(var st=E*q+k*it+I*ot,ut=C*(M-1-at)+R*(F-1-(ot*V-tt))+O*K,ct=0;ct<X;++ct)rt+=S[st+(K*X+ct)]*A[ut+ct];y[x*q+w*Y+_*Q+K]=rt}return n.makeTensorInfo(v.shape,v.dtype,v.values)}},ur={kernelName:r.Diag,backendName:"cpu",kernelFunc:function(t){for(var e=t.inputs,n=t.backend,i=e.x,a=r.util.sizeFromShape(i.shape),o=n.data.get(i.dataId).values,s=r.buffer([a,a],i.dtype),u=s.values,h=0;h<o.length;h++)u[h*a+h]=o[h];var p=l(l([],c(i.shape),!1),c(i.shape),!1);return n.makeTensorInfo(p,s.dtype,s.values)}},cr={kernelName:r.Dilation2D,backendName:"cpu",kernelFunc:function(t){for(var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=i.strides,u=i.pad,c=i.dilations,l=n,h=l.data.get(a.dataId).values,p=a.shape.length,f=l.data.get(o.dataId).values,d=o.shape.length,m=r.backend_util.computeDilation2DInfo(a.shape,o.shape,s,u,"NHWC",c),g=m.batchSize,v=m.inHeight,y=m.inWidth,b=m.inChannels,x=m.outHeight,w=m.outWidth,_=m.padInfo,S=m.strideHeight,T=m.strideWidth,E=m.filterHeight,k=m.filterWidth,I=m.dilationHeight,A=m.dilationWidth,N=m.outShape,C=r.util.sizeFromShape(N),R=N.length,O=r.util.getArrayFromDType(a.dtype,C),D=0;D<g;++D)for(var M=0;M<x;++M)for(var F=M*S-_.top,P=0;P<w;++P)for(var L=P*T-_.left,B=0;B<b;++B){for(var z=Number.MIN_SAFE_INTEGER,U=0;U<E;++U){var G=F+U*I;if(G>=0&&G<v)for(var W=0;W<k;++W){var V=L+W*A;if(V>=0&&V<y){var j=r.util.locToIndex([D,G,V,B],p,r.util.computeStrides(a.shape)),H=r.util.locToIndex([U,W,B],d,r.util.computeStrides(o.shape)),X=h[j]+f[H];X>z&&(z=X)}}}O[r.util.locToIndex([D,M,P,B],R,r.util.computeStrides(N))]=z}return{dataId:l.write(r.util.toTypedArray(O,a.dtype),N,a.dtype),shape:N,dtype:a.dtype}}},lr={kernelName:r.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=e.dy,u=i.strides,c=i.pad,l=i.dilations,h=n,p=r.util.toNestedArray(a.shape,h.data.get(a.dataId).values),f=r.util.toNestedArray(o.shape,h.data.get(o.dataId).values),d=r.backend_util.computeDilation2DInfo(a.shape,o.shape,u,c,"NHWC",l),m=d.batchSize,g=d.inHeight,v=d.inWidth,y=d.inChannels,b=d.outHeight,x=d.outWidth,w=d.padInfo,_=d.strideHeight,S=d.strideWidth,T=d.filterHeight,E=d.filterWidth,k=d.dilationHeight,I=d.dilationWidth,A=d.outShape;r.util.assert(s.rank===A.length,(function(){return"Error in ".concat(r.Dilation2DBackpropFilter,", dy ")+"must have the same rank as output ".concat(A.length,", but got ")+"".concat(s.rank)}));for(var N=r.util.toNestedArray(A,h.data.get(s.dataId).values),C=r.util.makeZerosNestedTypedArray(o.shape,o.dtype),R=0;R<m;++R)for(var O=0;O<b;++O)for(var D=O*_-w.top,M=0;M<x;++M)for(var F=M*S-w.left,P=0;P<y;++P){for(var L=Number.MIN_SAFE_INTEGER,B=0,z=0,U=0;U<T;++U){var G=D+U*k;if(G>=0&&G<g)for(var W=0;W<E;++W){var V=F+W*I;if(V>=0&&V<v){var j=p[R][G][V][P]+f[U][W][P];j>L&&(L=j,B=U,z=W)}}}C[B][z][P]+=N[R][O][M][P]}return{dataId:h.write(r.util.toTypedArray(C,a.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}},hr={kernelName:r.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=e.dy,u=i.strides,c=i.pad,l=i.dilations,h=n,p=r.util.toNestedArray(a.shape,h.data.get(a.dataId).values),f=r.util.toNestedArray(o.shape,h.data.get(o.dataId).values),d=r.backend_util.computeDilation2DInfo(a.shape,o.shape,u,c,"NHWC",l),m=d.batchSize,g=d.inHeight,v=d.inWidth,y=d.inChannels,b=d.outHeight,x=d.outWidth,w=d.padInfo,_=d.strideHeight,S=d.strideWidth,T=d.filterHeight,E=d.filterWidth,k=d.dilationHeight,I=d.dilationWidth,A=d.outShape;r.util.assert(s.rank===A.length,(function(){return"Error in ".concat(r.Dilation2DBackpropInput,", dy ")+"must have the same rank as output ".concat(A.length,", but got ")+"".concat(s.rank)}));for(var N=r.util.toNestedArray(A,h.data.get(s.dataId).values),C=r.util.makeZerosNestedTypedArray(a.shape,a.dtype),R=0;R<m;++R)for(var O=0;O<b;++O)for(var D=O*_-w.top,M=0;M<x;++M)for(var F=M*S-w.left,P=0;P<y;++P){for(var L=Number.MIN_SAFE_INTEGER,B=D<0?0:D,z=F<0?0:F,U=0;U<T;++U){var G=D+U*k;if(G>=0&&G<g)for(var W=0;W<E;++W){var V=F+W*I;if(V>=0&&V<v){var j=p[R][G][V][P]+f[U][W][P];j>L&&(L=j,B=G,z=V)}}}C[R][B][z][P]+=N[R][O][M][P]}return{dataId:h.write(r.util.toTypedArray(C,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},pr={kernelName:r.Draw,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.image,a=r.canvas,o=r.options||{},s=o.contextOptions,u=o.imageOptions,l=(null==u?void 0:u.alpha)||1,h=(null==s?void 0:s.contextType)||"2d";if("2d"!==h)throw new Error("Context type ".concat(s.contextType," is not supported by the CPU backend."));var p=a.getContext(h,(null==s?void 0:s.contextAttributes)||{});if(null==p)throw new Error("Could not get the context with ".concat(h," type."));for(var f=c(i.shape.slice(0,2),2),d=f[0],m=f[1],g=2===i.shape.length?1:i.shape[2],v=n.data.get(i.dataId).values,y="float32"===i.dtype?255:1,b=new Uint8ClampedArray(m*d*4),x=0;x<d*m;++x){for(var w=[0,0,0,255*l],_=0;_<g;_++){var S=v[x*g+_];if("float32"===i.dtype){if(S<0||S>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(S,"."))}else if("int32"===i.dtype&&(S<0||S>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(S,"."));1===g?(w[0]=S*y,w[1]=S*y,w[2]=S*y):w[_]=S*y}var T=4*x;b[T+0]=Math.round(w[0]),b[T+1]=Math.round(w[1]),b[T+2]=Math.round(w[2]),b[T+3]=Math.round(w[3])}a.width=m,a.height=d;var E=new ImageData(b,m,d);return p.putImageData(E,0,0),i}};function fr(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.x,s=a.axis,u=a.keepDims;h(o,"sum");var l=(e="bool"===o.dtype?E({inputs:{x:o},backend:i,attrs:{dtype:"int32"}}):x({inputs:{x:o},backend:i})).shape.length,p=r.util.parseAxisParam(s,e.shape),f=r.backend_util.getAxesPermutation(p,l),d=p,m=e;null!=f&&(m=Gt({inputs:{x:e},backend:i,attrs:{perm:f}}),d=r.backend_util.getInnerMostAxes(d.length,l)),r.backend_util.assertAxesAreInnerMostDims("sum",d,m.shape.length);for(var g=c(r.backend_util.computeOutAndReduceShapes(m.shape,d),2),v=g[0],y=g[1],w=b(i,v,r.backend_util.upcastType(m.dtype,"int32")),_=r.util.sizeFromShape(y),S=i.data.get(w.dataId).values,T=i.data.get(m.dataId).values,k=0;k<S.length;++k){for(var I=k*_,A=0,N=0;N<_;++N)A+=T[I+N];S[k]=A}if(u){var C=w;w=Je({inputs:{x:w},backend:i,attrs:{shape:r.backend_util.expandShapeToKeepDim(w.shape,p)}}),i.disposeIntermediateTensorInfo(C)}return i.disposeIntermediateTensorInfo(e),null!=f&&i.disposeIntermediateTensorInfo(m),w}var dr={kernelName:r.Sum,backendName:"cpu",kernelFunc:fr},mr={kernelName:r.Einsum,backendName:"cpu",kernelFunc:function(t){var e,n,i,a,o=t.inputs,s=t.backend,c=t.attrs.equation,l=o,h=r.backend_util.decodeEinsumEquation(c,l.length),p=h.allDims,f=h.summedDims,d=h.idDims;r.backend_util.checkEinsumDimSizes(p.length,d,l);for(var m=r.backend_util.getEinsumComputePath(f,d),g=m.path,v=m.steps,y=v.length,b=null,x=p.length,w=[],_=0;_<y;++_){try{for(var S=(e=void 0,u(v[_])),T=S.next();!T.done;T=S.next()){var E=T.value,k=r.backend_util.getEinsumPermutation(x,d[E]),I=k.permutationIndices,A=k.expandDims,N=void 0;r.backend_util.isIdentityPermutation(I)?N=l[E]:(N=Gt({inputs:{x:l[E]},backend:s,attrs:{perm:I}}),w.push(N));for(var C=N.shape.slice(),R=0;R<A.length;++R)C.splice(A[R],0,1);r.util.arraysEqual(N.shape,C)||(N=Je({inputs:{x:N},backend:s,attrs:{shape:C}}),w.push(N)),null===b?b=N:(b=Dt({inputs:{a:N,b},backend:s}),w.push(b))}}catch(t){e={error:t}}finally{try{T&&!T.done&&(n=S.return)&&n.call(S)}finally{if(e)throw e.error}}_<y-1&&(g[_]>=0&&(b=fr({inputs:{x:b},backend:s,attrs:{axis:g[_]-(p.length-x),keepDims:!1}}),w.push(b)),x--)}try{for(var O=u(w),D=O.next();!D.done;D=O.next()){var M=D.value;M!==b&&s.disposeIntermediateTensorInfo(M)}}catch(t){i={error:t}}finally{try{D&&!D.done&&(a=O.return)&&a.call(O)}finally{if(i)throw i.error}}return b}},gr={kernelName:r.EluGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.dy,a=e.y;h([i,a],"eluGrad");for(var o=new Float32Array(r.util.sizeFromShape(a.shape)),s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=0;c<s.length;++c){var l=s[c];o[c]=l>=0?u[c]:u[c]*(l+1)}return n.makeTensorInfo(a.shape,"float32",o)}},vr=r.backend_util.ERF_P,yr=r.backend_util.ERF_A1,br=r.backend_util.ERF_A2,xr=r.backend_util.ERF_A3,wr=r.backend_util.ERF_A4,_r=r.backend_util.ERF_A5,Sr=z(r.Erf,(function(t){var e=Math.sign(t),n=Math.abs(t),r=1/(1+vr*n);return e*(1-((((_r*r+wr)*r+xr)*r+br)*r+yr)*r*Math.exp(-n*n))})),Tr={kernelName:r.Erf,backendName:"cpu",kernelFunc:Sr};function Er(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.input,o=i.dim,s=a.shape.length,u=a.shape.slice(),c=o;return o<0&&(r.util.assert(-(s+1)<=o,(function(){return"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")})),c=s+o+1),u.splice(c,0,1),Je({inputs:{x:a},backend:n,attrs:{shape:u}})}var kr={kernelName:r.ExpandDims,backendName:"cpu",kernelFunc:Er},Ir=g((function(t,e){return t/e})),Ar=I(r.RealDiv,Ir),Nr={kernelName:r.RealDiv,backendName:"cpu",kernelFunc:Ar};function Cr(t,e,n){for(var i=t.shape,a=i[0],o=i[1],s=n.data.get(t.dataId),u=s.complexTensorInfos.real,c=s.complexTensorInfos.imag,l=[a,o],h=r.util.sizeFromShape(l),p=r.util.getTypedArrayFromDType("float32",h),f=r.util.getTypedArrayFromDType("float32",h),d=0;d<a;d++){for(var m=le({inputs:{x:u},backend:n,attrs:{begin:[d,0],size:[1,o]}}),g=le({inputs:{x:c},backend:n,attrs:{begin:[d,0],size:[1,o]}}),y=v({inputs:{real:m,imag:g},backend:n}),b=Rr(y,e,n),x=b.real,w=b.imag,_=r.backend_util.mergeRealAndImagArrays(x,w),S=0;S<o;S++){var T=r.backend_util.getComplexWithIndex(_,S);p[d*o+S]=T.real,f[d*o+S]=T.imag}n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y)}var E=n.makeTensorInfo(l,"float32",p),k=n.makeTensorInfo(l,"float32",f),I=v({inputs:{real:E,imag:k},backend:n});return n.disposeIntermediateTensorInfo(E),n.disposeIntermediateTensorInfo(k),I}function Rr(t,e,n){var i=r.util.sizeFromShape(t.shape),a=n.data.get(t.dataId),o=n.data.get(a.complexTensorInfos.real.dataId).values,s=n.data.get(a.complexTensorInfos.imag.dataId).values;if((c=i)&c-1){var u=function(t,e,n){for(var i=new Float32Array(2*e),a=0;a<e;a++){for(var o=0,s=0,u=0;u<e;u++){var c=r.backend_util.exponent(a*u,e,n),l=r.backend_util.getComplexWithIndex(t,u);o+=l.real*c.real-l.imag*c.imag,s+=l.real*c.imag+l.imag*c.real}n&&(o/=e,s/=e),r.backend_util.assignToTypedArray(i,o,s,a)}return i}(r.backend_util.mergeRealAndImagArrays(o,s),i,e);return r.backend_util.splitRealAndImagArrays(u)}var c,l=Or(o,s,i,e,n),h=[t.shape[0],t.shape[1]];if(e){var p=n.makeTensorInfo(h,"float32",l.real),f=n.makeTensorInfo(h,"float32",l.imag),d=n.makeTensorInfo([],"float32",r.util.createScalarValue(i,"float32")),m=x({inputs:{x:d},backend:n}),g=Nr.kernelFunc({inputs:{a:p,b:d},backend:n}),v=Nr.kernelFunc({inputs:{a:f,b:m},backend:n}),y=n.data.get(g.dataId).values,b=n.data.get(v.dataId).values;return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),{real:y,imag:b}}return l}function Or(t,e,n,i,a){if(1===n)return{real:t,imag:e};var o=r.backend_util.mergeRealAndImagArrays(t,e),s=n/2,u=r.backend_util.complexWithEvenIndex(o),c=u.real,l=u.imag,h=[c.length],p=a.makeTensorInfo(h,"float32",c),f=a.makeTensorInfo(h,"float32",l),d=v({inputs:{real:p,imag:f},backend:a}),m=r.backend_util.complexWithOddIndex(o),g=m.real,y=m.imag,b=[g.length],x=a.makeTensorInfo(b,"float32",g),w=a.makeTensorInfo(b,"float32",y),S=v({inputs:{real:x,imag:w},backend:a}),T=Or(c,l,s,i,a),E=T.real,k=T.imag,I=[E.length],A=a.makeTensorInfo(I,"float32",E),N=a.makeTensorInfo(I,"float32",k),C=v({inputs:{real:A,imag:N},backend:a}),O=Or(g,y,s,i,a),D=O.real,M=O.imag,F=[D.length],P=a.makeTensorInfo(F,"float32",D),L=a.makeTensorInfo(F,"float32",M),B=v({inputs:{real:P,imag:L},backend:a}),z=r.backend_util.exponents(n,i),U=[z.real.length],G=a.makeTensorInfo(U,"float32",z.real),W=a.makeTensorInfo(U,"float32",z.imag),V=v({inputs:{real:G,imag:W},backend:a}),j=Dt({inputs:{a:V,b:B},backend:a}),H=R({inputs:{a:C,b:j},backend:a}),X=Oe({inputs:{a:C,b:j},backend:a}),q=_({inputs:{input:H},backend:a}),K=_({inputs:{input:X},backend:a}),Y=Bn({inputs:{input:H},backend:a}),Z=Bn({inputs:{input:X},backend:a}),$=Un({inputs:[q,K],backend:a,attrs:{axis:0}}),J=Un({inputs:[Y,Z],backend:a,attrs:{axis:0}}),Q=a.data.get($.dataId).values,tt=a.data.get(J.dataId).values;return a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(S),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(N),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(Z),a.disposeIntermediateTensorInfo($),a.disposeIntermediateTensorInfo(J),{real:Q,imag:tt}}var Dr={kernelName:r.FFT,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.input,a=r.util.sizeFromShape(i.shape),o=i.shape[i.shape.length-1],s=Je({inputs:{x:i},backend:n,attrs:{shape:[a/o,o]}}),u=Cr(s,!1,n),c=Je({inputs:{x:u},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),c}};function Mr(t){var e=t.backend,n=t.attrs,i=n.shape,a=n.value,o=n.dtype||r.util.inferDtype(a),s=r.util.getArrayFromDType(o,r.util.sizeFromShape(i));return function(t,e){t.fill(e)}(s,a),e.makeTensorInfo(i,o,s)}var Fr={kernelName:r.Fill,backendName:"cpu",kernelFunc:Mr},Pr={kernelName:r.FlipLeftRight,backendName:"cpu",kernelFunc:function(t){var e=t.inputs;t.attrs;for(var n=t.backend,i=e.image,a=n,o=r.util.getTypedArrayFromDType(i.dtype,r.util.sizeFromShape(i.shape)),s=c(i.shape,4),u=s[0],l=s[1],h=s[2],p=s[3],f=a.data.get(i.dataId).values,d=0;d<u;d++)for(var m=d*h*l*p,g=0;g<l;g++)for(var v=g*(h*p),y=0;y<h;y++)for(var b=y*p,x=0;x<p;x++){var w=Math.round(h-y-1),_=m+v+b+x,S=f[_];w>=0&&w<h&&(S=f[m+v+w*p+x]),o[_]=S}return{dataId:a.write(o,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Lr={kernelName:r.FusedConv2D,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=e.filter,o=e.bias,s=e.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,p=r.dimRoundingMode,f=r.activation,d=r.leakyreluAlpha,m=Wn({inputs:{x:i,filter:a},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:p}});if(o){var g=m;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){var v=Je({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=R({inputs:{a:m,b:v},backend:n}),n.disposeIntermediateTensorInfo(v)}else m=R({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(f){if(g=m,"NCHW"===l&&"prelu"===f&&1===s.shape.length&&1!==s.shape[0]){var y=Je({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=$e(n,m,f,y,d),n.disposeIntermediateTensorInfo(y)}else m=$e(n,m,f,s,d);n.disposeIntermediateTensorInfo(g)}return m}},Br={kernelName:r.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=e.filter,o=e.bias,s=e.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,p=r.dimRoundingMode,f=r.activation,d=r.leakyreluAlpha,m=ir({inputs:{x:i,filter:a},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:p}});if(o){var g=m;m=R({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}return f&&(g=m,m=$e(n,m,f,s,d),n.disposeIntermediateTensorInfo(g)),m}},zr={kernelName:r.GatherNd,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.params,a=e.indices,o=r.util.sizeFromShape(i.shape),s=a.shape,u=s[s.length-1],l=c(r.backend_util.prepareAndValidate(i,a),4),h=l[0],p=l[1],f=l[2],d=l[3];if(0===p)return n.makeTensorInfo(h,i.dtype,[]);var m=ot(n.data.get(a.dataId).values,n.bufferSync(i),i.dtype,p,u,f,d,i.shape,o);return n.makeTensorInfo(h,i.dtype,m.values)}},Ur={kernelName:r.GatherV2,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.indices,s=i.axis,u=i.batchDims;h([a,o],"gatherV2");for(var c=r.util.parseAxisParam(s,a.shape)[0],l=n.data.get(o.dataId).values,p=a.shape[c],f=function(t){var e=l[t];r.util.assert(e<=p-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(p-1,"]")}))},d=0;d<l.length;++d)f(d);var m=u;null==u&&(m=0);var g=r.util.sizeFromShape(o.shape),v=r.backend_util.segment_util.collectGatherOpShapeInfo(a,o,c,m),y=Je({inputs:{x:a},backend:n,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),b=Je({inputs:{x:o},backend:n,attrs:{shape:[v.batchSize,g/v.batchSize]}}),x=[v.batchSize,v.outerSize,g/v.batchSize,v.sliceSize],w=n.bufferSync(b),_=st(n.bufferSync(y),w,x);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.makeTensorInfo(v.outputShape,_.dtype,_.values)}},Gr={kernelName:r.IFFT,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.input,a=r.util.sizeFromShape(i.shape),o=i.shape[i.shape.length-1],s=Je({inputs:{x:i},backend:n,attrs:{shape:[a/o,o]}}),u=Cr(s,!0,n),c=Je({inputs:{x:u},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),c}},Wr=z(r.IsFinite,(function(t){return Number.isFinite(t)?1:0}),"bool"),Vr={kernelName:r.IsFinite,backendName:"cpu",kernelFunc:Wr},jr=z(r.IsInf,(function(t){return Math.abs(t)===1/0?1:0}),"bool"),Hr={kernelName:r.IsInf,backendName:"cpu",kernelFunc:jr},Xr=z(r.IsNan,(function(t){return Number.isNaN(t)?1:0}),"bool"),qr={kernelName:r.IsNan,backendName:"cpu",kernelFunc:Xr},Kr={kernelName:r.LinSpace,backendName:"cpu",kernelFunc:function(t){var e=t.backend,n=t.attrs,r=xt(n.start,n.stop,n.num);return e.makeTensorInfo([r.length],"float32",r)}},Yr=z(r.Log1p,(function(t){return Math.log1p(t)})),Zr={kernelName:r.Log1p,backendName:"cpu",kernelFunc:Yr},$r=g((function(t,e){return t&&e})),Jr=I(r.LogicalAnd,$r,null,"bool"),Qr={kernelName:r.LogicalAnd,backendName:"cpu",kernelFunc:Jr},ti=z(r.LogicalNot,(function(t){return t?0:1}),"bool"),ei={kernelName:r.LogicalNot,backendName:"cpu",kernelFunc:ti},ni=g((function(t,e){return t||e})),ri=I(r.LogicalOr,ni,null,"bool"),ii={kernelName:r.LogicalOr,backendName:"cpu",kernelFunc:ri},ai={kernelName:r.LRN,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.depthRadius,s=i.bias,u=i.alpha,c=i.beta;h(a,"LRN");var l=a.shape[3],p=l-1,f=n.data.get(a.dataId).values,d=r.util.sizeFromShape(a.shape),m=new Float32Array(d);function g(t){for(var e=t%l,n=t-e+Math.max(0,e-o),r=t-e+Math.min(e+o,p),i=0;n<=r;n++){var a=f[n];i+=a*a}return i}for(var v=0;v<d;v++){var y=g(v),b=f[v]*Math.pow(s+u*y,-c);m[v]=b}return n.makeTensorInfo(a.shape,a.dtype,m)}},oi={kernelName:r.LRNGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.y,s=e.dy,u=i.depthRadius,c=i.bias,l=i.alpha,p=i.beta;h(s,"LRNGrad");for(var f=r.util.sizeFromShape(s.shape),d=s.shape[3],m=n.data.get(s.dataId).values,g=n.data.get(a.dataId).values,v=n.data.get(o.dataId).values,y=new Float32Array(f),b=f,x=0;x<b;x++){for(var w=x%d,_=x-w+Math.max(0,w-u),S=x-w+Math.min(d,w+u+1),T=0,E=_;E<S;E++)T+=Math.pow(g[E],2);for(T=l*T+c,E=_;E<S;E++){var k=-2*l*p*g[E]*v[x]/T;x===E&&(k+=Math.pow(T,-p)),k*=m[x],y[E]+=k}}return n.makeTensorInfo(s.shape,a.dtype,y)}};function si(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.reductionIndices,s=i.keepDims,u=n,l=a.shape,p=l.length,f=r.util.parseAxisParam(o,l),d=f,m=r.backend_util.getAxesPermutation(d,p),g=u.data.get(a.dataId).values;if(null!=m){for(var v=new Array(p),y=0;y<v.length;y++)v[y]=l[m[y]];g=Ut(g,l,a.dtype,m,v),d=r.backend_util.getInnerMostAxes(d.length,p),l=v}h(a,"max"),r.backend_util.assertAxesAreInnerMostDims("max",d,p);var b=c(r.backend_util.computeOutAndReduceShapes(l,d),2),x=b[0],w=b[1],_=Tt(g,r.util.sizeFromShape(w),x,a.dtype),S=u.write(_,x,a.dtype),T=x;return s&&(T=v=r.backend_util.expandShapeToKeepDim(x,f)),{dataId:S,shape:T,dtype:a.dtype}}var ui={kernelName:r.Max,backendName:"cpu",kernelFunc:si},ci={kernelName:r.MaxPool,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x;h(a,"maxPool");var o=i.filterSize,s=i.strides,u=i.pad,c=i.dimRoundingMode;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l,p=r.backend_util.computePool2DInfo(a.shape,o,s,1,u,c);if(1===p.filterWidth&&1===p.filterHeight&&r.util.arraysEqual(p.inShape,p.outShape))l=x({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,d=r.util.computeStrides(a.shape),m=Tn(f,a.shape,a.dtype,d,p,"max");l=n.makeTensorInfo(p.outShape,a.dtype,m.values)}return l}},li={kernelName:r.MaxPool3D,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.filterSize,s=i.strides,u=i.pad,c=i.dimRoundingMode,l=i.dataFormat;h(a,"maxPool3d");var p=r.backend_util.computePool3DInfo(a.shape,o,s,1,u,c,l),f=kn(n.data.get(a.dataId).values,a.shape,a.dtype,r.util.computeStrides(a.shape),p,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}},hi={kernelName:r.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=i.filterSize,u=i.strides,c=i.pad,l=i.dimRoundingMode;h([a,o],"maxPool3DGrad");for(var p=r.backend_util.computePool3DInfo(o.shape,s,u,1,c,l),f=function(t,e){for(var n=r.buffer(e.outShape,"int32"),i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,m=e.padInfo.left,g=0;g<e.batchSize;++g)for(var v=0;v<e.inChannels;++v)for(var y=0;y<e.outDepth;++y){for(var b=y*i-f,x=b;x<0;)x+=s;for(var w=Math.min(e.inDepth,l+b),_=0;_<e.outHeight;++_){for(var S=_*a-d,T=S;T<0;)T+=u;for(var E=Math.min(e.inHeight,h+S),k=0;k<e.outWidth;++k){for(var I=k*o-m,A=I;A<0;)A+=c;for(var N=Math.min(e.inWidth,p+I),C=Number.NEGATIVE_INFINITY,R=-1,O=x;O<w;O+=s)for(var D=O-b,M=T;M<E;M+=u)for(var F=M-S,P=A;P<N;P+=c){var L=P-I,B=t.get(g,O,M,P,v);B>=C&&(C=B,R=D*h*p+F*h+L)}n.set(R,g,y,_,k,v)}}}return n}(n.bufferSync(o),p),d=p.strideDepth,m=p.strideHeight,g=p.strideWidth,v=p.dilationDepth,y=p.dilationHeight,b=p.dilationWidth,x=p.effectiveFilterDepth,w=p.effectiveFilterHeight,_=p.effectiveFilterWidth,S=x-1-p.padInfo.front,T=_-1-p.padInfo.left,E=w-1-p.padInfo.top,k=r.buffer(o.shape,"float32"),I=n.bufferSync(a),A=0;A<p.batchSize;++A)for(var N=0;N<p.inChannels;++N)for(var C=0;C<p.inDepth;++C)for(var R=0;R<p.inHeight;++R)for(var O=0;O<p.inWidth;++O){for(var D=C-S,M=R-E,F=O-T,P=0,L=0;L<x;L+=v){var B=(D+L)/d;if(!(B<0||B>=p.outDepth||Math.floor(B)!==B))for(var z=0;z<w;z+=y){var U=(M+z)/m;if(!(U<0||U>=p.outHeight||Math.floor(U)!==U))for(var G=0;G<_;G+=b){var W=(F+G)/g;if(!(W<0||W>=p.outWidth||Math.floor(W)!==W)){var V=x*w*_-1-f.get(A,B,U,W,N)===L*w*_+z*_+G?1:0;0!==V&&(P+=I.get(A,B,U,W,N)*V)}}}}k.set(P,A,C,R,O,N)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}},pi={kernelName:r.MaxPoolGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=o;h([o,e.output],"maxPoolGrad");for(var u=i.filterSize,c=i.strides,l=i.pad,p=i.dimRoundingMode,f=r.backend_util.computePool2DInfo(s.shape,u,c,1,l,p),d=n.data.get(s.dataId).values,m=r.buffer(f.outShape,s.dtype,En(d,s.shape,s.dtype,f).values),g=f.strideHeight,v=f.strideWidth,y=f.dilationHeight,b=f.dilationWidth,x=f.effectiveFilterHeight,w=f.effectiveFilterWidth,_=w-1-f.padInfo.left,S=x-1-f.padInfo.top,T=r.buffer(s.shape,"float32"),E=n.data.get(a.dataId).values,k=r.buffer(a.shape,"float32",E),I=0;I<f.batchSize;++I)for(var A=0;A<f.inChannels;++A)for(var N=0;N<f.inHeight;++N)for(var C=0;C<f.inWidth;++C){for(var R=N-S,O=C-_,D=0,M=0;M<x;M+=y){var F=(R+M)/g;if(!(F<0||F>=f.outHeight||Math.floor(F)!==F))for(var P=0;P<w;P+=b){var L=(O+P)/v;if(!(L<0||L>=f.outWidth||Math.floor(L)!==L)){var B=x*w-1-m.get(I,F,L,A)===M*w+P?1:0;0!==B&&(D+=k.get(I,F,L,A)*B)}}}T.set(D,I,N,C,A)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}},fi={kernelName:r.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.x,o=n.filterSize,s=n.strides,u=n.pad,l=n.includeBatchInIndex,p=i;h(a,"MaxPoolWithArgmax");var f=p.data.get(a.dataId).values,d=r.backend_util.computePool2DInfo(a.shape,o,s,[1,1],u),m=c(function(t,e,n,i,a){var o=Tn(t,0,n,r.util.computeStrides(e),a,"max"),s=En(t,e,n,a,!0,i);return[o.values,s.values]}(f,a.shape,a.dtype,l,d),2),g=m[0],v=m[1],y=p.write(g,d.outShape,a.dtype),b=p.write(v,d.outShape,a.dtype);return[{dataId:y,shape:d.outShape,dtype:a.dtype},{dataId:b,shape:d.outShape,dtype:"int32"}]}},di={kernelName:r.Mean,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims,u=r.util.parseAxisParam(o,a.shape),c=r.backend_util.computeOutAndReduceShapes(a.shape,u)[1],l=r.util.sizeFromShape(c),h=[],p=n.makeTensorInfo([],"float32",new Float32Array([l]));h.push(p);var f=E({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});h.push(f);var d=Ar({inputs:{a:f,b:p},backend:n});h.push(d);var m=fr({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:s}});return h.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),m}},mi={kernelName:r.Min,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims;h(a,"min");var u=r.util.parseAxisParam(o,a.shape),l=u,p=r.backend_util.getAxesPermutation(l,a.shape.length),f=a;null!=p&&(f=Gt({inputs:{x:a},backend:n,attrs:{perm:p}}),l=r.backend_util.getInnerMostAxes(l.length,a.shape.length)),r.backend_util.assertAxesAreInnerMostDims("min",l,f.shape.length);for(var d=c(r.backend_util.computeOutAndReduceShapes(f.shape,l),2),m=d[0],g=d[1],v=r.util.sizeFromShape(g),y=r.util.makeZerosTypedArray(r.util.sizeFromShape(m),f.dtype),b=n.data.get(f.dataId).values,x=0;x<y.length;++x){for(var w=x*v,_=b[w],S=0;S<v;++S){var T=b[w+S];(Number.isNaN(T)||T<_)&&(_=T)}y[x]=_}null!=p&&n.disposeIntermediateTensorInfo(f);var E=n.makeTensorInfo(m,f.dtype,y);if(s){var k=Je({inputs:{x:E},backend:n,attrs:{shape:r.backend_util.expandShapeToKeepDim(m,u)}});return n.disposeIntermediateTensorInfo(E),k}return E}},gi={kernelName:r.MirrorPad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.paddings,s=i.mode;h(a,"mirrorPad");for(var u=o.map((function(t,e){return t[0]+a.shape[e]+t[1]})),c=o.map((function(t){return t[0]})),l=o.map((function(t,e){return t[0]+a.shape[e]})),p="reflect"===s?0:1,f=n.data.get(a.dataId).values,d=a.shape.length,m=r.util.computeStrides(a.shape),g=r.util.sizeFromShape(u),v=u.length,y=r.util.computeStrides(u),b=r.util.getTypedArrayFromDType(a.dtype,g),x=0;x<g;x++){for(var w=r.util.indexToLoc(x,v,y),_=0;_<v;_++)w[_]<c[_]?w[_]=2*c[_]-w[_]-p:w[_]>=l[_]&&(w[_]=2*(l[_]-1)-w[_]+p);w=w.map((function(t,e){return t-c[e]}));var S=r.util.locToIndex(w,d,m);b[x]=f[S]}return{dataId:n.write(b,u,a.dtype),shape:u,dtype:a.dtype}}},vi=g((function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),yi=I(r.Mod,vi),bi={kernelName:r.Mod,backendName:"cpu",kernelFunc:yi};function xi(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.logits,o=i.dim,s=a.shape.length,u=o;if(-1===u&&(u=s-1),u!==s-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(s," and dim was ").concat(u));var c=r.util.parseAxisParam([u],a.shape),l=si({inputs:{x:a},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),h=r.backend_util.expandShapeToKeepDim(l.shape,c),p=Je({inputs:{x:l},backend:n,attrs:{shape:h}}),f=Oe({inputs:{a,b:p},backend:n}),d=Y({inputs:{x:f},backend:n}),m=fr({inputs:{x:d},backend:n,attrs:{axis:c,keepDims:!1}}),g=Je({inputs:{x:m},backend:n,attrs:{shape:h}}),v=Ar({inputs:{a:d,b:g},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),v}var wi={kernelName:r.Softmax,backendName:"cpu",kernelFunc:xi},_i={kernelName:r.Multinomial,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,a=t.attrs,o=e.logits,s=a.numSamples,u=a.seed,c=a.normalized;h(o,"multinomial");for(var l=c?o:xi({inputs:{logits:o},backend:n,attrs:{dim:-1}}),p=l.shape[0],f=l.shape[1],d=n.data.get(l.dataId).values,m=[p,s],g=r.util.makeZerosTypedArray(r.util.sizeFromShape(m),"int32"),v=0;v<p;++v){var y=v*f,b=new Float32Array(f-1);b[0]=d[y];for(var x=1;x<b.length;++x)b[x]=b[x-1]+d[y+x];for(var w=i.alea(u.toString()),_=v*s,S=0;S<s;++S){var T=w();for(g[_+S]=b.length,x=0;x<b.length;x++)if(T<b[x]){g[_+S]=x;break}}}return c||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(m,"int32",g)}},Si=r.kernel_impls.nonMaxSuppressionV3Impl,Ti={kernelName:r.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.boxes,a=e.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;h(i,"NonMaxSuppression");var c=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,p=Si(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([p.length],"int32",new Int32Array(p))}},Ei=r.kernel_impls.nonMaxSuppressionV4Impl,ki={kernelName:r.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.boxes,a=e.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize;h(i,"NonMaxSuppressionPadded");var l=n.data.get(i.dataId).values,p=n.data.get(a.dataId).values,f=Ei(l,p,o,s,u,c),d=f.selectedIndices,m=f.validOutputs;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([m]))]}},Ii=r.kernel_impls.nonMaxSuppressionV5Impl,Ai={kernelName:r.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.boxes,a=e.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma;h(i,"NonMaxSuppressionWithScore");var l=n.data.get(i.dataId).values,p=n.data.get(a.dataId).values,f=Ii(l,p,o,s,u,c),d=f.selectedIndices,m=f.selectedScores;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}},Ni={kernelName:r.OneHot,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.indices,o=i.dtype,s=i.depth,u=i.onValue,p=i.offValue;h(a,"oneHot");var f=r.util.sizeFromShape(a.shape),d=new Float32Array(f*s);d.fill(p);for(var m=n.data.get(a.dataId).values,g=0;g<f;++g)m[g]>=0&&m[g]<s&&(d[g*s+m[g]]=u);return n.makeTensorInfo(l(l([],c(a.shape),!1),[s],!1),o,d)}};function Ci(t){var e=t.inputs,n=t.backend,r=e.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var i=_({inputs:{input:r},backend:n}),a=Ci({inputs:{x:i},backend:n}),o=Bn({inputs:{input:r},backend:n}),s=Ci({inputs:{x:o},backend:n}),u=v({inputs:{real:a,imag:s},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return Mr({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var Ri={kernelName:r.ZerosLike,backendName:"cpu",kernelFunc:Ci},Oi={kernelName:r.OnesLike,backendName:"cpu",kernelFunc:function t(e){var n=e.inputs,r=e.backend,i=n.x;if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===i.dtype){var a=_({inputs:{input:i},backend:r}),o=t({inputs:{x:a},backend:r}),s=Bn({inputs:{input:i},backend:r}),u=Ci({inputs:{x:s},backend:r}),c=v({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return Mr({backend:r,attrs:{shape:i.shape,value:1,dtype:i.dtype}})}};function Di(t){var e=t.inputs,n=t.backend,i=t.attrs.axis;if(1===e.length)return Er({inputs:{input:e[0]},backend:n,attrs:{dim:i}});var a=e[0].shape,o=e[0].dtype;e.forEach((function(t){r.util.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),r.util.assert(o===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=[],u=Un({inputs:e.map((function(t){var e=Er({inputs:{input:t},backend:n,attrs:{dim:i}});return s.push(e),e})),backend:n,attrs:{axis:i}});return s.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),u}var Mi={kernelName:r.Pack,backendName:"cpu",kernelFunc:Di},Fi={kernelName:r.PadV2,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.paddings,s=i.constantValue;h(a,"pad");var u=o.map((function(t,e){return t[0]+a.shape[e]+t[1]})),c=o.map((function(t){return t[0]})),l=n.data.get(a.dataId).values,p=r.util.sizeFromShape(a.shape),f=a.shape.length,d=r.util.computeStrides(a.shape),m=r.util.sizeFromShape(u),g=u.length,v=r.util.computeStrides(u),y=r.util.getTypedArrayFromDType(a.dtype,m);0!==s&&y.fill(s);for(var b=0;b<p;b++){var x=r.util.indexToLoc(b,f,d).map((function(t,e){return t+c[e]}));y[r.util.locToIndex(x,g,v)]=l[b]}return{dataId:n.write(y,u,a.dtype),shape:u,dtype:a.dtype}}},Pi=g((function(t,e){return Math.pow(t,e)})),Li=I(r.Pow,Pi),Bi={kernelName:r.Pow,backendName:"cpu",kernelFunc:Li},zi={kernelName:r.RaggedGather,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.paramsNestedSplits,a=e.paramsDenseValues,o=e.indices;r.outputRaggedRank;var s=i.map((function(t){return n.data.get(t.dataId).values})),u=i.map((function(t){return t.shape})),l=n.data.get(a.dataId).values,h=n.data.get(o.dataId).values,p=c(qt(s,u,l,a.shape,a.dtype,h,o.shape),3),f=p[0],d=p[1],m=p[2],g=f.map((function(t){return n.makeTensorInfo([t.length],"int32",t)})),v=n.makeTensorInfo(m,a.dtype,d);return g.concat([v])}},Ui={kernelName:r.RaggedRange,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.starts,i=e.limits,a=e.deltas,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,l=c(Yt(o,r.shape,r.dtype,s,i.shape,u,a.shape),2),h=l[0],p=l[1];return[n.makeTensorInfo([h.length],"int32",h),n.makeTensorInfo([p.length],r.dtype,p)]}},Gi={kernelName:r.RaggedTensorToTensor,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.shape,a=e.values,o=e.defaultValue,s=e.rowPartitionTensors,u=r.rowPartitionTypes,l=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,p=n.data.get(o.dataId).values,f=s.map((function(t){return n.data.get(t.dataId).values})),d=s.map((function(t){return t.shape})),m=c(te(l,i.shape,h,a.shape,a.dtype,p,o.shape,f,d,u),2),g=m[0],v=m[1];return n.makeTensorInfo(g,a.dtype,v)}},Wi={kernelName:r.Range,backendName:"cpu",kernelFunc:function(t){var e=t.backend,n=t.attrs,r=n.start,i=n.stop,a=n.dtype,o=ee(r,i,n.step,a);return e.makeTensorInfo([o.length],a,o)}},Vi=z(r.Reciprocal,(function(t){return 1/t})),ji={kernelName:r.Reciprocal,backendName:"cpu",kernelFunc:Vi},Hi={kernelName:r.ResizeBilinear,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.images,o=i.alignCorners,s=i.halfPixelCenters,u=i.size;h(a,"resizeBilinear");for(var l=r.util.computeStrides(a.shape),p=c(u,2),f=p[0],d=p[1],m=c(a.shape,4),g=m[0],v=m[1],y=m[2],b=m[3],x=n.data.get(a.dataId).values,w=new Float32Array(r.util.sizeFromShape([g,f,d,b])),_=[o&&f>1?v-1:v,o&&d>1?y-1:y],S=[o&&f>1?f-1:f,o&&d>1?d-1:d],T=0,E=_[0]/S[0],k=_[1]/S[1],I=0;I<g;I++)for(var A=0;A<f;A++){var N;N=s?E*(A+.5)-.5:E*A;for(var C=Math.max(0,Math.floor(N)),R=N-C,O=Math.min(v-1,Math.ceil(N)),D=I*l[0]+C*l[1],M=I*l[0]+O*l[1],F=0;F<d;F++){var P;P=s?k*(F+.5)-.5:k*F;for(var L=Math.max(0,Math.floor(P)),B=P-L,z=Math.min(y-1,Math.ceil(P)),U=D+L*l[2],G=M+L*l[2],W=D+z*l[2],V=M+z*l[2],j=0;j<b;j++){var H=x[U+j],X=x[G+j],q=H+(x[W+j]-H)*B,K=q+(X+(x[V+j]-X)*B-q)*R;w[T++]=K}}}return n.makeTensorInfo([g,f,d,b],"float32",w)}},Xi={kernelName:r.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.images,o=e.dy,s=i.alignCorners;h([o,a],"resizeBilinearGrad");for(var u=r.util.computeStrides(a.shape),l=c(a.shape,4),p=l[0],f=l[1],d=l[2],m=l[3],g=c(o.shape,3),v=g[1],y=g[2],b=new Float32Array(p*f*d*m),x=[s&&v>1?f-1:f,s&&y>1?d-1:d],w=[s&&v>1?v-1:v,s&&y>1?y-1:y],_=x[0]/w[0],S=x[1]/w[1],T=n.data.get(o.dataId).values,E=0,k=0;k<p;k++)for(var I=k*u[0],A=0;A<v;A++)for(var N=A*_,C=Math.floor(N),R=Math.min(Math.ceil(N),f-1),O=I+C*u[1],D=I+R*u[1],M=N-C,F=1-M,P=0;P<y;P++)for(var L=P*S,B=Math.floor(L),z=Math.min(Math.ceil(L),d-1),U=L-B,G=1-U,W=O+B*u[2],V=O+z*u[2],j=D+B*u[2],H=D+z*u[2],X=F*G,q=F*U,K=M*G,Y=M*U,Z=0;Z<m;Z++){var $=T[E++];b[W+Z]+=$*X,b[V+Z]+=$*q,b[j+Z]+=$*K,b[H+Z]+=$*Y}return n.makeTensorInfo([p,d,f,m],"float32",b)}},qi={kernelName:r.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.images,o=i.alignCorners,s=i.halfPixelCenters,u=i.size;h(a,"resizeNearestNeighbor");for(var l=r.util.computeStrides(a.shape),p=c(u,2),f=p[0],d=p[1],m=c(a.shape,4),g=m[0],v=m[1],y=m[2],b=m[3],x=n.data.get(a.dataId).values,w=new Float32Array(g*f*d*b),_=[o&&f>1?v-1:v,o&&d>1?y-1:y],S=[o&&f>1?f-1:f,o&&d>1?d-1:d],T=_[0]/S[0],E=_[1]/S[1],k=0,I=0;I<g;I++)for(var A=I*l[0],N=0;N<f;N++){var C=s?T*(N+.5):T*N,R=Math.min(v-1,o?Math.round(C):Math.floor(C));s&&(R=Math.max(0,R));for(var O=A+R*l[1],D=0;D<d;D++){var M=s?E*(D+.5):E*D,F=Math.min(y-1,o?Math.round(M):Math.floor(M));s&&(F=Math.max(0,F));for(var P=O+F*l[2],L=0;L<b;L++){var B=x[P+L];w[k++]=B}}}return n.makeTensorInfo([g,f,d,b],a.dtype,w)}},Ki={kernelName:r.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.images,o=e.dy,s=i.alignCorners;h([o,a],"resizeNearestNeighborGrad");for(var u=r.util.computeStrides(a.shape),l=r.util.computeStrides(o.shape),p=c(a.shape,4),f=p[0],d=p[1],m=p[2],g=p[3],v=c(o.shape,3),y=v[1],b=v[2],x=new Float32Array(f*d*m*g),w=n.data.get(o.dataId).values,_=[s&&y>1?d-1:d,s&&b>1?m-1:m],S=[s&&y>1?y-1:y,s&&b>1?b-1:b],T=_[0]/S[0],E=_[1]/S[1],k=1/T,I=1/E,A=2*Math.ceil(k)+2,N=2*Math.ceil(I)+2,C=0;C<f;C++)for(var R=C*u[0],O=0;O<d;O++)for(var D=R+O*u[1],M=Math.floor(O*k),F=Math.floor(M-A/2),P=0;P<m;P++)for(var L=D+P*u[2],B=Math.floor(P*I),z=Math.floor(B-N/2),U=0;U<g;U++){for(var G=0,W=0;W<A;W++){var V=W+F;if(!(V<0||V>=y)){var j=R+V*l[1],H=V*T;if(O===Math.min(d-1,s?Math.round(H):Math.floor(H)))for(var X=0;X<N;X++){var q=X+z;if(!(q<0||q>=b)){var K=j+q*l[2],Y=q*E;P===Math.min(m-1,s?Math.round(Y):Math.floor(Y))&&(G+=w[K+U])}}}}x[L+U]=G}return n.makeTensorInfo(a.shape,a.dtype,x)}},Yi={kernelName:r.Reverse,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.dims;h(a,"reverse");var s=a.shape.length,u=r.util.parseAxisParam(o,a.shape);if(0===s)return x({inputs:{x:a},backend:n});for(var p=new r.TensorBuffer(a.shape,a.dtype),f=n.bufferSync(a),d=function(t){var e=p.indexToLoc(t),n=e.slice();u.forEach((function(t){return n[t]=a.shape[t]-1-n[t]})),p.set.apply(p,l([f.get.apply(f,l([],c(n),!1))],c(e),!1))},m=0;m<p.size;m++)d(m);return n.makeTensorInfo(p.shape,p.dtype,p.values)}},Zi={kernelName:r.RotateWithOffset,backendName:"cpu",kernelFunc:function(t){for(var e=t.inputs,n=t.attrs,i=t.backend,a=e.image,o=n.radians,s=n.fillValue,u=n.center,l=i,h=r.util.getTypedArrayFromDType(a.dtype,r.util.sizeFromShape(a.shape)),p=c(a.shape,4),f=p[0],d=p[1],m=p[2],g=p[3],v=c(r.backend_util.getImageCenter(u,d,m),2),y=v[0],b=v[1],x=Math.sin(o),w=Math.cos(o),_=l.data.get(a.dataId).values,S=0;S<f;S++)for(var T=S*m*d*g,E=0;E<d;E++)for(var k=E*(m*g),I=0;I<m;I++)for(var A=I*g,N=0;N<g;N++){var C=[f,E,I,N],R=C[2],O=C[1],D=(R-y)*w-(O-b)*x,M=(R-y)*x+(O-b)*w;D=Math.round(D+y),M=Math.round(M+b);var F=s;"number"!=typeof s&&(F=3===N?255:s[N]),D>=0&&D<m&&M>=0&&M<d&&(F=_[T+M*(m*g)+D*g+N]),h[T+k+A+N]=F}return{dataId:l.write(h,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},$i=z(r.Round,(function(t){var e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2==0?e:e+1})),Ji={kernelName:r.Round,backendName:"cpu",kernelFunc:$i},Qi={kernelName:r.ScatterNd,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.indices,o=e.updates,s=i.shape,u=r.backend_util.calculateShapes(o,a,s),c=u.sliceRank,l=u.numUpdates,h=u.sliceSize,p=u.strides,f=u.outputSize,d=ae(n.bufferSync(a),n.bufferSync(o),s,f,h,l,c,p,0,!0);return n.makeTensorInfo(s,d.dtype,d.values)}};function ta(t,e){for(var n=0,r=t.length,i=0;n<r;)t[i=Math.floor((n+r)/2)]<e?n=i+1:r=i;return r}function ea(t,e){for(var n=0,r=t.length,i=0;n<r;)t[i=Math.floor((n+r)/2)]<=e?n=i+1:r=i;return r}var na={kernelName:r.SearchSorted,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.sortedSequence,o=e.values,s=i.side,u=function(t,e,n,i,a,o){for(var s=r.util.getArrayFromDType("int32",n*a),u=0;u<n;++u)for(var c=t.slice(u*i,(u+1)*i),l=u*a,h=0;h<a;++h)s[l+h]="left"===o?ta(c,e[h+l]):ea(c,e[h+l]);return s}(n.data.get(a.dataId).values,n.data.get(o.dataId).values,a.shape[0],a.shape[1],o.shape[1],s);return n.makeTensorInfo(o.shape,"int32",u)}},ra={kernelName:r.Select,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.condition,a=e.t,o=e.e;h([i,a,o],"select");for(var s=i.shape.length,u=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values,p=r.upcastType(a.dtype,o.dtype),f=r.util.makeZerosTypedArray(r.util.sizeFromShape(a.shape),p),d=0,m=0===s||s>1||1===a.shape.length?1:r.util.sizeFromShape(a.shape.slice(1)),g=0;g<u.length;g++)for(var v=0;v<m;v++)1===u[g]?f[d++]=c[g]:f[d++]=l[g];return n.makeTensorInfo(a.shape,p,f)}},ia=r.backend_util.SELU_SCALEALPHA,aa=r.backend_util.SELU_SCALE,oa=z(r.Selu,(function(t){return t>=0?aa*t:ia*(Math.exp(t)-1)})),sa={kernelName:r.Selu,backendName:"cpu",kernelFunc:oa},ua=z(r.Sign,(function(t){return t<0?-1:t>0?1:0})),ca={kernelName:r.Sign,backendName:"cpu",kernelFunc:ua},la=z(r.Sin,(function(t){return Math.sin(t)})),ha={kernelName:r.Sin,backendName:"cpu",kernelFunc:la},pa=z(r.Sinh,(function(t){return Math.sinh(t)})),fa={kernelName:r.Sinh,backendName:"cpu",kernelFunc:pa},da=Math.log(1.1920928955078125e-7)+2,ma=z(r.Softplus,(function(t){var e=t>-da,n=t<da,r=Math.exp(t);return n?r:e?t:Math.log(1+r)})),ga={kernelName:r.Softplus,backendName:"cpu",kernelFunc:ma},va={kernelName:r.SpaceToBatchND,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.blockShape,s=i.paddings;h([a],"spaceToBatchND");var u=r.util.sizeFromShape(o),p=[[0,0]];p.push.apply(p,l([],c(s),!1));for(var f=1+o.length;f<a.shape.length;++f)p.push([0,0]);var d=Fi.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:p,constantValue:0}}),m=r.backend_util.getReshaped(d.shape,o,u,!1),g=r.backend_util.getPermuted(m.length,o.length,!1),v=r.backend_util.getReshapedPermuted(d.shape,o,u,!1),y=Je({inputs:{x:d},backend:n,attrs:{shape:m}}),b=Gt({inputs:{x:y},backend:n,attrs:{perm:g}}),x=Je({inputs:{x:b},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),x}},ya={kernelName:r.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.indices,i=e.values,a=e.denseShape,o=e.defaultValue;if(1!==a.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(a.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==i.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(i.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,h=n.data.get(o.dataId).values[0],p=c(pe(s,r.shape,r.dtype,u,i.dtype,l,h),5),f=p[0],d=p[1],m=p[2],g=p[3],v=p[4];return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,m),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map((function(t){return Number(t)})))),n.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}},ba={kernelName:r.SparseReshape,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.inputIndices,i=e.inputShape,a=e.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==i.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(i.shape));if(1!==a.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(a.shape));var o=Array.from(n.data.get(i.dataId).values),s=n.data.get(r.dataId).values,u=Array.from(n.data.get(a.dataId).values),l=c(fe(s,r.shape,r.dtype,o,u),3),h=l[0],p=l[1],f=l[2];return[n.makeTensorInfo(p,r.dtype,h),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}},xa={kernelName:r.SparseSegmentMean,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.data,i=e.indices,a=e.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(a.shape));if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,l=c(de(o,r.shape,r.dtype,s,u,!0),2),h=l[0],p=l[1];return n.makeTensorInfo(p,r.dtype,h)}},wa={kernelName:r.SparseSegmentSum,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.data,i=e.indices,a=e.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(a.shape));if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,l=c(de(o,r.shape,r.dtype,s,u),2),h=l[0],p=l[1];return n.makeTensorInfo(p,r.dtype,h)}},_a={kernelName:r.SparseToDense,backendName:"cpu",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.sparseIndices,s=n.sparseValues,u=n.defaultValue,c=a.outputShape,l=r.backend_util.calculateShapes(s,o,c),h=l.sliceRank,p=l.numUpdates,f=l.sliceSize,d=l.strides,m=l.outputSize,g=!1,v=i.bufferSync(o);switch(s.dtype){case"bool":e=ae(v,i.bufferSync(s),c,m,f,p,h,d,Boolean(i.data.get(u.dataId).values[0]),g);break;case"float32":case"int32":e=ae(v,i.bufferSync(s),c,m,f,p,h,d,i.data.get(u.dataId).values[0],g);break;case"string":e=ae(v,i.bufferSync(s),c,m,f,p,h,d,r.util.decodeString(i.data.get(u.dataId).values[0]),g);break;default:throw new Error("Unsupported type ".concat(s.dtype))}return i.makeTensorInfo(c,e.dtype,e.values)}},Sa={kernelName:r.SplitV,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.numOrSizeSplits,s=i.axis,u=r.util.parseAxisParam(s,a.shape)[0],h=r.backend_util.prepareSplitSize(a,o,u),p=new Array(a.shape.length).fill(0),f=a.shape.slice();return h.map((function(t){var e=l([],c(f),!1);e[u]=t;var r=le({inputs:{x:a},backend:n,attrs:{begin:p,size:e}});return p[u]+=t,r}))}},Ta={kernelName:r.Square,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n;h(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Ea=z(r.Step,(function(t,e){var n=e;return isNaN(t)?NaN:t>0?1:n.alpha})),ka={kernelName:r.Step,backendName:"cpu",kernelFunc:Ea},Ia={kernelName:r.StridedSlice,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.begin,s=i.end,u=i.strides,c=i.beginMask,l=i.endMask,p=i.ellipsisMask,f=i.newAxisMask,d=i.shrinkAxisMask;h(a,"stridedSlice");var m,g=r.slice_util.sliceInfo(a.shape,o,s,u,c,l,p,f,d),v=g.finalShapeSparse,y=g.finalShape,b=g.isIdentity,x=g.sliceDim0,w=g.isSimpleSlice,_=g.begin,S=g.end,T=g.strides;if(b)m=Je({inputs:{x:a},backend:n,attrs:{shape:y}});else if(x||w){r.util.assert(a.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(a.shape.length)}));var E=r.slice_util.computeOutShape(_,S,T),k=le({inputs:{x:a},backend:n,attrs:{begin:_,size:E}});m=Je({inputs:{x:k},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(k)}else{var I=Te(v,n.bufferSync(a),T,_);m=n.makeTensorInfo(y,I.dtype,I.values)}return m}},Aa={kernelName:r.StringNGrams,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=r.separator,a=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,l=r.preserveShortSequences,h=e.data,p=e.dataSplits,f=c(ke(n.data.get(h.dataId).values,n.data.get(p.dataId).values,i,a,o,s,u,l),2),d=f[0],m=f[1];return[n.makeTensorInfo([d.length],"string",d),n.makeTensorInfo(p.shape,"int32",m)]}},Na={kernelName:r.StringSplit,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.skipEmpty,i=e.input,a=e.delimiter;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==a.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(a.shape));var o=c(Ae(n.data.get(i.dataId).values,n.data.get(a.dataId).values[0],r),3),s=o[0],u=o[1],l=o[2],h=u.length;return[n.makeTensorInfo([h,2],"int32",s),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(l))]}},Ca={kernelName:r.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.numBuckets,i=e.input;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var a=Ne(n.data.get(i.dataId).values,r);return n.makeTensorInfo(i.shape,"int32",a)}},Ra=z(r.Tan,(function(t){return Math.tan(t)})),Oa={kernelName:r.Tan,backendName:"cpu",kernelFunc:Ra},Da=z(r.Tanh,(function(t){return Math.tanh(t)})),Ma={kernelName:r.Tanh,backendName:"cpu",kernelFunc:Da},Fa={kernelName:r.TensorScatterUpdate,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.tensor,a=e.indices,o=e.updates,s=r.backend_util.calculateShapes(o,a,i.shape),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,p=s.outputSize,f=n.bufferSync(a),d=n.bufferSync(o),m=n.bufferSync(i),g=ae(f,d,i.shape,p,l,c,u,h,m,!1);return n.makeTensorInfo(i.shape,g.dtype,g.values)}},Pa={kernelName:r.Tile,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=r.reps;h(i,"tile");var o=Me(n.bufferSync(i),a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},La={kernelName:r.TopK,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=r.k,o=r.sorted;h(i,"topk");var s=c(Le(n.data.get(i.dataId).values,i.shape,i.dtype,a,o),2),u=s[0],l=s[1];return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}},Ba={kernelName:r.Transform,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.image,o=e.transforms,s=n.interpolation,u=n.fillMode,l=n.fillValue,h=n.outputShape,p=c(a.shape,4),f=p[0],d=p[1],m=p[2],g=p[3],v=c(null!=h?h:[d,m],2),y=v[0],b=v[1],x=[f,y,b,g],w=r.util.computeStrides(a.shape),_=w[0],S=w[1],T=w[2],E=r.util.computeStrides(x),k=E[0],I=E[1],A=E[2],N=r.util.getTypedArrayFromDType(a.dtype,r.util.sizeFromShape(x));N.fill(l);for(var C=i.data.get(a.dataId).values,R=i.data.get(o.dataId).values,O=0;O<f;++O){for(var D=1===o.shape[0]?R:R.subarray(8*O,8*O+8),M=0;M<y;++M)for(var F=0;F<b;++F)for(var P=0;P<g;++P){var L=void 0,B=D[6]*F+D[7]*M+1;if(0!==B){var z=(D[0]*F+D[1]*M+D[2])/B,U=(D[3]*F+D[4]*M+D[5])/B,G=za(z,m,u),W=za(U,d,u);switch(s){case"nearest":L=Ga(C,d,m,_,S,T,O,W,G,P,l);break;case"bilinear":L=Wa(C,d,m,_,S,T,O,W,G,P,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(s))}N[O*k+M*I+F*A+P]=L}}return i.makeTensorInfo(x,a.dtype,N)}return{dataId:i.write(N,x,a.dtype),shape:a.shape,dtype:a.dtype}}};function za(t,e,n){switch(n){case"reflect":return function(t,e){var n=t;if(n<0)e<=1?n=0:(n<(i=2*e)&&(n=i*Math.trunc(-n/i)+n),n=n<-e?n+i:-n-1);else if(n>e-1){var i;e<=1?n=0:(n-=(i=2*e)*Math.trunc(n/i))>=e&&(n=i-n-1)}return r.util.clamp(0,n,e-1)}(t,e);case"wrap":return function(t,e){var n=t;if(n<0)if(e<=1)n=0;else{var i=e-1;n+=e*(Math.trunc(-n/i)+1)}else n>e-1&&(e<=1?n=0:(i=e-1,n-=e*Math.trunc(n/i)));return r.util.clamp(0,n,e-1)}(t,e);case"nearest":return function(t,e){return r.util.clamp(0,t,e-1)}(t,e);default:return function(t){return t}(t)}}function Ua(t,e,n,r,i,a,o,s,u,c,l){return 0<=s&&s<e&&0<=u&&u<n?t[o*r+s*i+u*a+c]:l}function Ga(t,e,n,r,i,a,o,s,u,c,l){return Ua(t,e,n,r,i,a,o,Math.round(s),Math.round(u),c,l)}function Wa(t,e,n,r,i,a,o,s,u,c,l){var h=Math.floor(s),p=Math.floor(u),f=h+1,d=p+1;return(f-s)*((d-u)*Ua(t,e,n,r,i,a,o,h,p,c,l)+(u-p)*Ua(t,e,n,r,i,a,o,h,d,c,l))+(s-h)*((d-u)*Ua(t,e,n,r,i,a,o,f,p,c,l)+(u-p)*Ua(t,e,n,r,i,a,o,f,d,c,l))}var Va,ja,Ha={kernelName:r.Unique,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n.axis,a=e.x;h(a,"unique");var o=Be(r.data.get(a.dataId).values,i,a.shape,a.dtype),s=o.outputValues,u=o.outputShape,c=o.indices;return[r.makeTensorInfo(u,a.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}},Xa={kernelName:r.Unpack,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.value,a=r.axis;a<0&&(a+=i.shape.length);for(var o=i.shape.length,s=i.shape[a],u=new Array(o-1),c=0,l=0;l<o;l++)l!==a&&(u[c++]=i.shape[l]);var h=new Array(o).fill(0),p=i.shape.slice();p[a]=1;var f=new Array(s);for(l=0;l<f.length;l++){h[a]=l;var d=le({inputs:{x:i},backend:n,attrs:{begin:h,size:p}});f[l]=Je({inputs:{x:d},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(d)}return f}},qa={kernelName:r.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.segmentIds,s=i.numSegments;h(a,"unsortedSegmentSum");for(var u=[],c=[],l=a.shape.length-o.shape.length,p=o,f=0;f<l;++f){var d=Er({inputs:{input:p},backend:n,attrs:{dim:f+1}});p=d,c.push(d)}for(f=0;f<s;++f){var m=r.util.createScalarValue(f,"int32"),g=n.makeTensorInfo([],"int32",m),v=X({inputs:{a:g,b:p},backend:n}),y=E({inputs:{x:v},backend:n,attrs:{dtype:"float32"}}),b=Dt({inputs:{a:y,b:a},backend:n}),x=fr({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});u.push(x),c.push(g),c.push(v),c.push(y),c.push(b),c.push(x)}var w=Di({inputs:u,backend:n,attrs:{axis:0}});return c.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),w}},Ka=[nn,m,an,sn,O,un,cn,ln,hn,pn,dn,gn,yn,wn,Sn,In,An,Nn,Cn,en,Rn,On,Dn,L,Mn,k,V,Pn,y,Ln,Gn,Vn,jn,Hn,Xn,qn,Kn,Zn,Jn,Qn,tr,er,nr,rr,ar,or,sr,ur,cr,lr,hr,pr,mr,Ge,gr,q,Tr,Z,kr,Q,Dr,Fr,Pr,nt,at,Lr,Br,zr,Ur,lt,ft,w,Gr,zn,Vr,Hr,qr,Ve,gt,bt,Kr,St,Zr,Qr,ei,ii,ai,oi,ui,It,ci,li,hi,pi,fi,di,mi,Ct,gi,bi,_i,Mt,Pt,Ti,ki,Ai,zt,Ni,Oi,Mi,Fi,Bi,Xe,jt,zi,Ui,Gi,Wi,S,Nr,ji,Ke,Ze,Qe,Hi,Xi,qi,Ki,Yi,Zi,Ji,ie,Qi,na,ra,sa,ue,ca,ha,fa,he,wi,ga,va,ya,ba,xa,wa,_a,Sa,ve,Ta,xe,Se,ka,Ia,Aa,Na,Ca,De,dr,Oa,Ma,Fa,Pa,La,Ba,Wt,Ha,Xa,qa,Ri];try{for(var Ya=u(Ka),Za=Ya.next();!Za.done;Za=Ya.next()){var $a=Za.value;r.registerKernel($a)}}catch(t){Va={error:t}}finally{try{Za&&!Za.done&&(ja=Ya.return)&&ja.call(Ya)}finally{if(Va)throw Va.error}}n.MathBackendCPU=f,n.shared=ze,n.version_cpu="4.17.0"},{"@tensorflow/tfjs-core":7,seedrandom:17}],5:[function(t,e,n){"use strict";var r=t("@tensorflow/tfjs-core");var i=function(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,e}(r),a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},a(t,e)};function o(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function l(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var h,p,f,d={},m={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function g(t,e){d[t]=e}function v(t,e){if(!(t in d)||null!=e){var n=function(t,e){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=e??function(t){if(r.env().getBool("IS_SAFARI")||"undefined"==typeof OffscreenCanvas||2!==t){if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(t);return n.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete d[t]}),!1),r.env().getBool("SOFTWARE_WEBGL_ENABLED")&&(m.failIfMajorPerformanceCaveat=!1),1===t?n.getContext("webgl",m)||n.getContext("experimental-webgl",m):n.getContext("webgl2",m)}(t,e);if(null===n)return console.log("Could not get context for WebGL version",t),null;d[t]=n}var i=d[t];return null==i||i.isContextLost()?(delete d[t],v(t)):(i.disable(i.DEPTH_TEST),i.disable(i.STENCIL_TEST),i.disable(i.BLEND),i.disable(i.DITHER),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SAMPLE_COVERAGE),i.enable(i.SCISSOR_TEST),i.enable(i.CULL_FACE),i.cullFace(i.BACK),d[t])}function y(t,e){return[e,t]}function b(t){var e=r.util.sizeFromShape(t),n=Math.ceil(e/4);return r.util.sizeToSquarishShape(n)}function x(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function w(t,e){var n,i,a,o,s,u,c,l,h,p,f=t;return 2===r.env().getNumber("WEBGL_VERSION")?(n=f.R32F,i=f.R16F,a=f.RGBA16F,o=f.RGBA32F,s=f.RED,c=4,l=1,h=f.HALF_FLOAT,p=f.FLOAT,u=f.RGBA8):(n=t.RGBA,i=t.RGBA,a=t.RGBA,o=f.RGBA,s=t.RGBA,c=4,l=4,h=null!=e?e.HALF_FLOAT_OES:null,p=t.FLOAT,u=t.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:u,downloadUnpackNumChannels:c,defaultNumChannels:l,textureTypeHalfFloat:h,textureTypeFloat:p}}function _(t,e){var n=e();return r.env().getBool("DEBUG")&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+T(t,e))}(t),n}function S(t){return!!(r.env().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function T(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}function E(t,e){return Y(t,(function(){return t.getExtension(e)}),'Extension "'+e+'" not supported on this browser.')}function k(t,e){var n=Y(t,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(_(t,(function(){return t.shaderSource(n,e)})),_(t,(function(){return t.compileShader(n)})),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function I(t,e){var n=Y(t,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(_(t,(function(){return t.shaderSource(n,e)})),_(t,(function(){return t.compileShader(n)})),r.env().get("ENGINE_COMPILE_ONLY"))return n;if(!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw R(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(h||(h={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(p||(p={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(f||(f={}));var A,N,C=/ERROR: [0-9]+:([0-9]+):/g;function R(t,e){var n=C.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);for(var i=+n[1],a=t.split("\n"),o=a.length.toString().length+2,s=a.map((function(t,e){return r.util.rightPad((e+1).toString(),o)+t})),u=0,c=0;c<s.length;c++)u=Math.max(s[c].length,u);var l=s.slice(0,i-1),h=s.slice(i-1,i),p=s.slice(i);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(r.util.rightPad(h[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join("\n"))}function O(t){return Y(t,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function D(t,e){if(_(t,(function(){return t.linkProgram(e)})),!r.env().get("ENGINE_COMPILE_ONLY")&&!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function M(t,e){if(_(t,(function(){return t.validateProgram(e)})),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function F(t,e){var n=Y(t,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return _(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),_(t,(function(){return t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)})),n}function P(t,e){var n=Y(t,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return _(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)})),_(t,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)})),n}function L(t){return Y(t,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function B(t,e){var n=r.env().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var i="[".concat(t,"x").concat(e,"]");throw new Error("Requested texture size "+i+" is invalid.")}if(t>n||e>n){i="[".concat(t,"x").concat(e,"]");var a="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+i+" greater than WebGL maximum on this browser / GPU "+a+".")}}function z(t){return Y(t,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function U(t,e,n,r,i,a,o){var s=t.getAttribLocation(e,n);return-1!==s&&(_(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),_(t,(function(){return t.vertexAttribPointer(s,i,t.FLOAT,!1,a,o)})),_(t,(function(){return t.enableVertexAttribArray(s)})),!0)}function G(t,e,n){Z(t,n),_(t,(function(){return t.activeTexture(t.TEXTURE0+n)})),_(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)}))}function W(t,e,n){return Y(t,(function(){return t.getUniformLocation(e,n)}),'uniform "'+n+'" not present in program.')}function V(t,e,n){return t.getUniformLocation(e,n)}function j(t,e,n,r){_(t,(function(){return G(t,e,r)})),_(t,(function(){return t.uniform1i(n,r)}))}function H(t,e,n){_(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),_(t,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}))}function X(t,e){_(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,e)})),_(t,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function q(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+K(t,e))}function K(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}function Y(t,e,n){var r=_(t,(function(){return e()}));if(null==r)throw new Error(n);return r}function Z(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){var i="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(i,"."))}}function $(t,e){return void 0===e&&(e=2),r.util.sizeFromShape(t.slice(0,t.length-e))}function J(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Q(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=l([$(t)],c(J(t)),!1)),e}function tt(t,e){var n;void 0===e&&(e=!1);var i=r.env().getNumber("WEBGL_MAX_TEXTURE_SIZE"),a=r.env().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(a===1/0&&r.env().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(a=i/2),e&&(i*=2,a*=2,1===(t=t.map((function(e,n){return n>=t.length-2?r.util.nearestLargerEven(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var o=r.util.squeezeShape(t);t=o.newShape}var s=r.util.sizeFromShape(t),u=null;t.length<=1&&s<=i?u=[1,s]:2===t.length&&t[0]<=i&&t[1]<=i?u=t:3===t.length&&t[0]*t[1]<=i&&t[2]<=i?u=[t[0]*t[1],t[2]]:3===t.length&&t[0]<=i&&t[1]*t[2]<=i?u=[t[0],t[1]*t[2]]:4===t.length&&t[0]*t[1]*t[2]<=i&&t[3]<=i?u=[t[0]*t[1]*t[2],t[3]]:4===t.length&&t[0]<=i&&t[1]*t[2]*t[3]<=i&&(u=[t[0],t[1]*t[2]*t[3]]);var h=null!=u&&Math.max.apply(Math,l([],c(u),!1))>a&&Math.min.apply(Math,l([],c(u),!1))<=(e?2:1)&&Math.min.apply(Math,l([],c(u),!1))>0;if(null==u||h)if(e){var p=$(t),f=2,d=2;t.length&&(f=(n=c(J(t),2))[0],d=n[1]),s=p*(f/2)*(d/2),u=r.util.sizeToSquarishShape(s).map((function(t){return 2*t}))}else u=r.util.sizeToSquarishShape(s);return u}function et(t){return t%2==0}function nt(t,e){if(t=t.slice(-2),e=e.slice(-2),r.util.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t[t.length-1],i=e[e.length-1];if(n===i)return!0;if(et(n)&&et(i)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&et(t[0])&&et(e[0])}function rt(t){if(null==A){var e=v(t);A=e.getParameter(e.MAX_TEXTURE_SIZE)}return A}function it(t){if(null==N){var e=v(t);N=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,N)}function at(t){if(0===t)return 0;var e=v(t);return ot(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:ot(e,"EXT_disjoint_timer_query")?1:0}function ot(t,e){return null!=t.getExtension(e)}function st(t){try{if(null!=v(t))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function ut(t){if(0===t)return!1;var e=v(t);if(1===t){if(!ot(e,"OES_texture_float"))return!1}else if(!ot(e,"EXT_color_buffer_float"))return!1;return lt(e)}function ct(t){if(0===t)return!1;var e=v(t);if(1!==t){if(ot(e,"EXT_color_buffer_float"))return lt(e);var n="EXT_color_buffer_half_float";if(ot(e,n)){var r=e.getExtension(n);return function(t,e){var n=w(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}(e,r)}return!1}return!!ot(e,"OES_texture_float")&&!!ot(e,"WEBGL_color_buffer_float")&&lt(e)}function lt(t){var e=w(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function ht(t){return 2===t&&null!=v(t).fenceSync}function pt(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&r.util.assert("complex64"!==t.dtype,(function(){return"".concat(e," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var ft={__proto__:null,assertNotComplex:pt,bindCanvasToFramebuffer:function(t){_(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),_(t,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),_(t,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:H,bindTextureToProgramUniformSampler:j,bindTextureUnit:G,bindVertexBufferToProgramAttribute:U,callAndCheck:_,canBeRepresented:S,createFragmentShader:I,createFramebuffer:z,createProgram:O,createStaticIndexBuffer:P,createStaticVertexBuffer:F,createTexture:L,createVertexShader:k,getBatchDim:$,getExtensionOrThrow:E,getFramebufferErrorMessage:K,getMaxTexturesInShader:it,getNumChannels:function(){return 2===r.env().getNumber("WEBGL_VERSION")?1:4},getProgramUniformLocation:V,getProgramUniformLocationOrThrow:W,getRowsCols:J,getShapeAs3D:Q,getTextureShapeFromLogicalShape:tt,getWebGLDisjointQueryTimerVersion:at,getWebGLErrorMessage:T,getWebGLMaxTextureSize:rt,hasExtension:ot,isCapableOfRenderingToFloatTexture:ut,isDownloadFloatTextureEnabled:ct,isReshapeFree:nt,isWebGLFenceEnabled:ht,isWebGLVersionEnabled:st,linkProgram:D,logShaderSourceAndInfoLog:R,resetMaxTextureSize:function(){A=null},resetMaxTexturesInShader:function(){N=null},unbindColorTextureFromFramebuffer:X,unbindTextureUnit:function(t,e){Z(t,e),_(t,(function(){return t.activeTexture(t.TEXTURE0+e)})),_(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},validateFramebuffer:q,validateProgram:M,validateTextureSize:B},dt=r.env();function mt(){var t,e,n,i,a,o,s,u,c,l;return 2===r.env().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",i="in",a="texture",o="outputColor",s="out vec4 outputColor;",u=r.env().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",c="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",i="varying",a="texture2D",o="gl_FragColor",s="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:i,texture2D:a,output:o,defineOutput:s,defineSpecialNaN:u,defineSpecialInf:c,defineRound:l}}function gt(t,e,n){void 0===n&&(n="index");var i=r.util.computeStrides(e);return i.map((function(e,r){var a="int ".concat(t[r]," = ").concat(n," / ").concat(e),o=r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * ").concat(e):"index -= ".concat(t[r]," * ").concat(e);return"".concat(a,"; ").concat(o,";")})).join("")}function vt(t,e,n){void 0===n&&(n="index");var i=r.util.computeStrides(e);return i.map((function(e,r){var a="int ".concat(t[r]," = ").concat(n," / outShapeStrides[").concat(r,"]"),o=r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * outShapeStrides[").concat(r,"]"):"index -= ".concat(t[r]," * outShapeStrides[").concat(r,"]");return"".concat(a,"; ").concat(o,";")})).join("")}function yt(t){var e=r.util.computeStrides(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}dt.registerFlag("HAS_WEBGL",(function(){return dt.getNumber("WEBGL_VERSION")>0})),dt.registerFlag("WEBGL_VERSION",(function(){return st(2)?2:st(1)?1:0})),dt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),dt.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===dt.get("WEBGL_VERSION")})),dt.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),dt.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),dt.registerFlag("WEBGL_PACK",(function(){return dt.getBool("HAS_WEBGL")})),dt.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_CLIP",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_REDUCE",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_CONV_IM2COL",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(function(){return dt.getBool("WEBGL_PACK")})),dt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return rt(dt.getNumber("WEBGL_VERSION"))})),dt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return it(dt.getNumber("WEBGL_VERSION"))})),dt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=dt.getNumber("WEBGL_VERSION");return 0===t?0:at(t)})),dt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return dt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!r.device_util.isMobile()})),dt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return ut(dt.getNumber("WEBGL_VERSION"))})),dt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!dt.getBool("WEBGL_FORCE_F16_TEXTURES")&&dt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),dt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return ct(dt.getNumber("WEBGL_VERSION"))})),dt.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return ht(dt.getNumber("WEBGL_VERSION"))})),dt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return dt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),dt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(t){if("number"!=typeof t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(t,"."))})),dt.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return r.device_util.isMobile()?1:-1}),(function(t){if("number"!=typeof t)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(t,"."))})),dt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),dt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),dt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),dt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128})),dt.registerFlag("WEBGL_EXP_CONV",(function(){return!1})),dt.registerFlag("SOFTWARE_WEBGL_ENABLED",(function(){return dt.getBool("IS_TEST")})),dt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(function(){return 1/0})),dt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(function(){return!1})),dt.registerFlag("WEBGL2_ISNAN_CUSTOM",(function(){return!1})),dt.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1}));var bt="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",xt=r.backend_util.getBroadcastDims;function wt(t,e,n){var i=[];if(t.forEach((function(t){var e=r.util.sizeFromShape(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?i.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(i.push("uniform sampler2D ".concat(t.name,";")),i.push("uniform int offset".concat(t.name,";"))),n.enableShapeUniforms){switch(Rt(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape).uniformShape.length){case 1:i.push("uniform int ".concat(t.name,"Shape;"));break;case 2:i.push("uniform ivec2 ".concat(t.name,"Shape;"));break;case 3:i.push("uniform ivec3 ".concat(t.name,"Shape;"));break;case 4:i.push("uniform ivec4 ".concat(t.name,"Shape;"))}i.push("uniform ivec2 ".concat(t.name,"TexShape;"))}})),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:i.push("uniform int outShape;");break;case 2:i.push("uniform ivec2 outShape;"),i.push("uniform int outShapeStrides;");break;case 3:i.push("uniform ivec3 outShape;"),i.push("uniform ivec2 outShapeStrides;");break;case 4:i.push("uniform ivec4 outShape;"),i.push("uniform ivec3 outShapeStrides;")}i.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(t){i.push("uniform ".concat(t.type," ").concat(t.name).concat(t.arrayIndex?"[".concat(t.arrayIndex,"]"):"",";"))}));var a,o,s=i.join("\n"),u=t.map((function(t){return function(t,e,n,i){void 0===n&&(n=!1);var a="";a+=n?St(t,i):_t(t,i);var o=t.shapeInfo.logicalShape,s=e.logicalShape;return o.length<=s.length&&(a+=n?function(t,e){var n,i=t.name,a=i.charAt(0).toUpperCase()+i.slice(1),o="get"+a+"AtOutCoords",s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,c=xt(t.shapeInfo.logicalShape,e.logicalShape),l=Ct(u),h=u-s,p=["x","y","z","w","u","v"];n=0===s?"":u<2&&c.length>=1?"coords = 0;":c.map((function(t){return"coords.".concat(p[t+h]," = 0;")})).join("\n");var f;f=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords.".concat(p[e+h])})).join(", ");var d="return outputValue;",m=1===r.util.sizeFromShape(t.shapeInfo.logicalShape),g=1===r.util.sizeFromShape(e.logicalShape);if(1!==s||m||g){if(m&&!g)d=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){var v=s-2,y=s-1;c.indexOf(v)>-1&&c.indexOf(y)>-1?d="return vec4(outputValue.x);":c.indexOf(v)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(y)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(f,");\n      ").concat(d,"\n    }\n  ")}(t,e):function(t,e){var n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),a="get"+i+"AtOutCoords",o=e.texShape,s=t.shapeInfo.texShape,u=t.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!t.shapeInfo.isUniform&&u===c&&null==t.shapeInfo.flatOffset&&r.util.arraysEqual(s,o))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var l,h=Ct(c),p=xt(t.shapeInfo.logicalShape,e.logicalShape),f=c-u,d=["x","y","z","w","u","v"];l=0===u?"":c<2&&p.length>=1?"coords = 0;":p.map((function(t){return"coords.".concat(d[t+f]," = 0;")})).join("\n");var m;return m=c<2&&u>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords.".concat(d[e+f])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(h," coords = getOutputCoords();\n      ").concat(l,"\n      return get").concat(i,"(").concat(m,");\n    }\n  ")}(t,e)),a}(t,e,n.packedInputs,n.enableShapeUniforms)})).join("\n"),c=e.texShape,l=mt(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(l),p=function(t){return"".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(Tt,"\n    ").concat(Et,"\n    ").concat(kt,"\n  ")}(l);return e.isPacked?(a=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){var r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===r[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    "):1===r[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){var i=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(r.util.arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(i[0],", ").concat(i[1],"));\n      }\n    ");var a=Math.ceil(t[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(i[0],", ").concat(i[1],"));\n\n      int index = resTexRC.x * ").concat(i[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),a=i*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e,n);default:return function(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),a=i*Math.ceil(t[t.length-2]/2),o=a,s="",u="b, r, c",c=2;c<t.length-1;c++)o*=t[t.length-c-1],s="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+s,u="b".concat(c,", ")+u;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec").concat(t.length,"(").concat(u,");\n    }\n  ")}(t,e,n)}}(e.logicalShape,c,n.enableShapeUniforms),o=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(l)):(a=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){return 1===e[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    "):1===e[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){return r.util.arraysEqual(t,e)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    "):1===t[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===t[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n){var r=vt(["r","c","d"],t);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var i=gt(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(i,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e,n);case 4:return function(t,e,n){if(n){var r=vt(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var i=gt(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(i,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e,n);case 5:return i=e,a=gt(["r","c","d","d2","d3"],t),"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(i[0],",\n                             ").concat(i[1],"));\n\n      int index = resTexRC.x * ").concat(i[1]," + resTexRC.y;\n\n      ").concat(a,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ");case 6:return function(t,e){var n=gt(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}var i,a}(e.logicalShape,c,n.enableShapeUniforms),o=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(l)),n.packedInputs&&(p+=It),[p,h,o,s,a,u,n.userCode].join("\n")}function _t(t,e){void 0===e&&(e=!1);var n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var i=c(t.shapeInfo.texShape,2),a=i[0],o=i[1];if(1===a&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=At(n);if(e)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var u=c(t.shapeInfo.texShape,2),l=u[0],h=u[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(l,", ").concat(h,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 1:return function(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(Nt(t),"\n      }\n    ");var i=t.shapeInfo.texShape,a=i[0],o=i[1];if(1===o&&1===a)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=At(n);return 1===o?e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):1===a?e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):e?"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){var n=t.shapeInfo.logicalShape,i=t.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=t.shapeInfo.texShape;if(null!=o&&r.util.arraysEqual(n,o)){if(e)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    ");var s=o[0],u=o[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(s,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ")}var c=r.util.squeezeShape(n),l=c.newShape,h=c.keptDims,p=l;if(p.length<n.length){var f=Ot(t,p);return"\n      ".concat(_t(f,e),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(Dt(["row","col"],h),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(Nt(t),"\n      }\n    ");var d=o[0],m=o[1],g=At(i);return 1===m?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(i,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(i,"TexShape[0]));\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(d,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  "):1===d?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(i,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(i,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(m,".0, 0.5);\n      return sampleTexture(").concat(i,", uv);\n    }\n  "):e?"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i,"Shape[1] + col + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(i,"TexShape[0], ").concat(i,"TexShape[1], index);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(g,";\n    vec2 uv = uvFromFlat(").concat(d,", ").concat(m,", index);\n    return sampleTexture(").concat(i,", uv);\n  }\n")}(t,e);case 3:return function(t,e){var n=t.shapeInfo.logicalShape,i=t.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n[1]*n[2],s=n[2],u=r.util.squeezeShape(n),c=u.newShape,l=u.keptDims,h=c;if(h.length<n.length){var p=Ot(t,h);return"\n        ".concat(_t(p,e),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(Dt(["row","col","depth"],l),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(s,", 1)));\n        ").concat(Nt(t),"\n      }\n    ");var f=t.shapeInfo.texShape,d=f[0],m=f[1],g=t.shapeInfo.flatOffset;if(m===o&&null==g)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(i,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(m,".0, ").concat(d,".0);\n          return sampleTexture(").concat(i,", uv);\n        }\n      ");if(m===s&&null==g)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(i,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(m,".0, ").concat(d,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ");var v=At(i);return e?"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(i,"Shape[1] * ").concat(i,"Shape[2];\n      int stride1 = ").concat(i,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(v,";\n      vec2 uv = uvFromFlat(").concat(i,"TexShape[0], ").concat(i,"TexShape[1], index);\n      return sampleTexture(").concat(i,", uv);\n    }\n    "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(s," + depth + ").concat(v,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(m,", index);\n        return sampleTexture(").concat(i,", uv);\n      }\n  ")}(t,e);case 4:return function(t,e){var n=t.shapeInfo.logicalShape,i=t.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n[3],s=n[2]*o,u=n[1]*s,c=r.util.squeezeShape(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var p=Ot(t,l);return"\n      ".concat(_t(p,e),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(Dt(["row","col","depth","depth2"],h),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(u,", ").concat(s,", ").concat(o,", 1)));\n        ").concat(Nt(t),"\n      }\n    ");var f=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,m=d[0],g=d[1],v="int stride2 = ".concat(i,"Shape[3];"),y="int stride1 = ".concat(i,"Shape[2] * stride2;"),b="int stride0 = ".concat(i,"Shape[1] * stride1;");if(g===u&&null==f)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(v,"\n        ").concat(y,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    ");if(g===o&&null==f)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(i,"Shape[1] * ").concat(i,"Shape[2], ").concat(i,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    ");var x=At(i);return e?"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(v,"\n      ").concat(y,"\n      ").concat(b,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(i,"TexShape[0], ").concat(i,"TexShape[1], index + ").concat(x,");\n      return sampleTexture(").concat(i,", uv);\n    }\n  "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(g,", index + ").concat(x,");\n      return sampleTexture(").concat(i,", uv);\n    }\n  ")}(t,e);case 5:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],o=e[3]*a,s=e[2]*o,u=e[1]*s,c=r.util.squeezeShape(e),l=c.newShape,h=c.keptDims;if(l.length<e.length){var p=Ot(t,l);return"\n      ".concat(_t(p),"\n      float ").concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(i,"(").concat(Dt(["row","col","depth","depth2","depth3"],h),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(s,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(Nt(t),"\n      }\n    ");var f=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,m=d[0],g=d[1];if(g===u&&null==f)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===a&&null==f)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var v=At(n);return"\n    float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(v,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 6:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),a=r.util.squeezeShape(e),o=a.newShape,s=a.keptDims;if(o.length<e.length){var u=Ot(t,o);return"\n      ".concat(_t(u),"\n      float ").concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(i,"(").concat(Dt(["row","col","depth","depth2","depth3","depth4"],s),");\n      }\n    ")}var c=e[5],l=e[4]*c,h=e[3]*l,p=e[2]*h,f=e[1]*p;if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(f,", ").concat(p,", ").concat(h,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(Nt(t),"\n      }\n    ");var d=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,g=m[0],v=m[1];if(v===f&&null==d)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(p,", ").concat(h,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===c&&null==d)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=At(n);return"\n    float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(f," + col * ").concat(p," + depth * ").concat(h," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function St(t,e){var n,i,a;switch(t.shapeInfo.logicalShape.length){case 0:return i="get"+(n=t.name).charAt(0).toUpperCase()+n.slice(1),a=mt(),"\n    vec4 ".concat(i,"() {\n      return ").concat(a.texture2D,"(").concat(n,", halfCR);\n    }\n  ");case 1:return function(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,a=mt();if(e)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");var o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){var n=t.shapeInfo.logicalShape,i=t.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=t.shapeInfo.texShape,s=o[0],u=o[1],c=mt();if(null!=o&&r.util.arraysEqual(n,o))return e?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n\n        return ").concat(c.texture2D,"(").concat(i,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(s,".0);\n\n        return ").concat(c.texture2D,"(").concat(i,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(i,"TexShape[0]) / 2.0), ceil(float(").concat(i,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(i,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(c.texture2D,"(").concat(i,", uv);\n    }\n  ");var l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],h=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(h,", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(c.texture2D,"(").concat(i,", uv);\n    }\n  ")}(t,e);case 3:return function(t,e){var n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){var s=Ot(t,n.slice(1));return"\n        ".concat(St(s,e),"\n        vec4 ").concat(i,"(int b, int row, int col) {\n          return ").concat(i,"(").concat(Dt(["b","row","col"],[1,2]),");\n        }\n      ")}var u=mt();if(e)return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ");var c=o[0],l=o[1],h=Math.ceil(n[2]/2),p=h*Math.ceil(n[1]/2);return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(p,", ").concat(h,", b, row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);default:return function(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=mt();if(e)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var a=t.shapeInfo.logicalShape,o=a.length,s=t.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=u[0],l=u[1],h=Math.ceil(a[o-1]/2),p=h*Math.ceil(a[o-2]/2),f="int b, int row, int col",d="b * ".concat(p," + (row / 2) * ").concat(h," + (col / 2)"),m=2;m<o-1;m++)f="int b".concat(m,", ")+f,p*=a[o-m-1],d="b".concat(m," * ").concat(p," + ")+d;return"\n    vec4 ".concat(r,"(").concat(f,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e)}}var Tt="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Et="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",kt="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",It="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function At(t){return"offset".concat(t)}function Nt(t){var e=t.name,n=r.util.sizeFromShape(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function Ct(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function Rt(t,e,n){var i=r.util.squeezeShape(e),a=i.newShape,o=i.keptDims,s=e.length,u=t&&3===s&&1===e[0],c=u?e.slice(1):a,l=!t&&s>1&&!r.util.arraysEqual(e,n)&&a.length<s||u;return{useSqueezeShape:l,uniformShape:l?c:e,keptDims:o}}function Ot(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Dt(t,e){return e.map((function(e){return t[e]})).join(", ")}function Mt(t,e,n){var i,a,o,s,c,l,h,p,f=[],d=[],m=null;p=t.getUniformLocation(n,"NAN",!1),1===r.env().getNumber("WEBGL_VERSION")&&(m=t.getUniformLocation(n,"INFINITY",!1));var g=!1;try{for(var v=u(e.variableNames),y=v.next();!y.done;y=v.next()){var b=y.value,x={name:b,uniform:t.getUniformLocation(n,b,g),offset:t.getUniformLocation(n,"offset".concat(b),g)};e.enableShapeUniforms&&(x.shape=t.getUniformLocation(n,"".concat(b,"Shape"),g),x.texShape=t.getUniformLocation(n,"".concat(b,"TexShape"),g)),f.push(x)}}catch(t){i={error:t}}finally{try{y&&!y.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}if(e.enableShapeUniforms&&(c=t.getUniformLocation(n,"outShape",g),h=t.getUniformLocation(n,"outShapeStrides",g),l=t.getUniformLocation(n,"outTexShape",g)),e.customUniforms)try{for(var w=u(e.customUniforms),_=w.next();!_.done;_=w.next()){var S=_.value;d.push(t.getUniformLocation(n,S.name,g))}}catch(t){o={error:t}}finally{try{_&&!_.done&&(s=w.return)&&s.call(w)}finally{if(o)throw o.error}}return{variablesLocations:f,customUniformLocations:d,infLoc:m,nanLoc:p,outShapeLocation:c,outShapeStridesLocation:h,outTexShapeLocation:l}}function Ft(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach((function(t,n){var i=t.logicalShape,a=e[n],o=a.shape;if(!r.util.arraysEqual(i,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(i," and ").concat(o," must match"));if(!t.isUniform||!a.isUniform){var s=t.texShape,u=a.isUniform?null:a.texData.texShape;if(!r.util.arraysEqual(s,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(u," must match"))}}))}function Pt(t){return r.env().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}var Lt=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=h.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var e=mt();this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?vt(["r","c","d"],t):gt(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")},Bt=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=h.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var e=mt();this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?vt(["r","c","d"],t):gt(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")},zt=function(t){this.variableNames=["A"],this.outTexUsage=p.DOWNLOAD;var e=mt();this.outputShape=t,this.userCode="\n      ".concat(bt,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(e.output," = encode_float(x);\n      }\n    ")},Ut=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=p.DOWNLOAD;var e=mt();this.outputShape=t,this.userCode="\n      ".concat(bt,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(e.output," = encode_float(x);\n      }\n    ")},Gt={R:0,G:1,B:2,A:3},Wt=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n="RGBA"),this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];var r=mt();this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length);var i="result";e&&(i="floor(result * 255. + 0.5)");for(var a="",o=0;o<n.length;o++){var s=n[o];a+="\n          if(offset == ".concat(o,") {\n            result = values[").concat(Gt[s],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":yt(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(a,"\n        }\n        ").concat(r.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")},Vt=function(t,e){void 0===e&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=mt();this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length);var r="",i="result";e&&(i="floor(result * 255. + 0.5)");for(var a=0;a<=1;a++)for(var o=0;o<=1;o++){var s=2*a+o;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(o," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(o,";\n          if (localCoords[1] + ").concat(a," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(a,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(s,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(s,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(s,"] = values[2];\n            } else {\n              result[").concat(s,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":yt(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(i,";\n        }\n    ")};function jt(t){var e=mt();return k(t,"".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function Ht(t){return F(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Xt(t){return P(t,new Uint16Array([0,1,2,2,1,3]))}function qt(t,e,n,i,a,o){B(e,n);var s=L(t),u=t.TEXTURE_2D;return _(t,(function(){return t.bindTexture(u,s)})),_(t,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),_(t,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),_(t,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),_(t,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),1===r.env().getNumber("WEBGL_VERSION")?_(t,(function(){return t.texImage2D(u,0,i,e,n,0,a,o,null)})):_(t,(function(){return t.texStorage2D(u,1,i,e,n)})),_(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),{texture:s,texShape:[n,e]}}function Kt(t){return t.internalFormatFloat}function Yt(t,e,n,r){var i=c(y(e,n),2);return qt(t,i[0],i[1],Kt(r),r.textureFormatFloat,t.FLOAT)}function Zt(t){return t.internalFormatHalfFloat}function $t(t,e,n,r){var i=c(y(e,n),2);return qt(t,i[0],i[1],Zt(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Jt(t){return t.downloadTextureFormat}function Qt(t,e,n,r){var i=c(y(e,n),2);return qt(t,i[0],i[1],Jt(r),t.RGBA,t.UNSIGNED_BYTE)}function te(t){return t.internalFormatPackedFloat}function ee(t,e,n,r){var i=c(x(e,n),2);return qt(t,i[0],i[1],te(r),t.RGBA,t.FLOAT)}function ne(t){return t.internalFormatPackedHalfFloat}function re(t,e,n,r){var i=c(x(e,n),2);return qt(t,i[0],i[1],ne(r),t.RGBA,r.textureTypeHalfFloat)}function ie(t,e,n){return _(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),U(t,e,"clipSpacePos",n,3,20,0)&&U(t,e,"uv",n,2,20,12)}function ae(t,e,n,i,a,o){var s,u,c;_(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)})),a instanceof Uint8Array?(s=new Uint8Array(n*i*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(n*i*4),u=t.FLOAT,c=o.internalFormatPackedFloat),s.set(a),2===r.env().getNumber("WEBGL_VERSION")?_(t,(function(){return t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,i,t.RGBA,u,s)})):_(t,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,n,i,0,t.RGBA,u,s)})),_(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function oe(t,e,n){_(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)})),n.data instanceof Uint8Array?2===r.env().getNumber("WEBGL_VERSION")?_(t,(function(){return t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)})):_(t,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)})):2===r.env().getNumber("WEBGL_VERSION")?_(t,(function(){return t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)})):_(t,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)})),_(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function se(t,e,n,r){var i=t.createBuffer();_(t,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)}));var a=16*e*n;return _(t,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)})),_(t,(function(){return t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)})),_(t,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),i}function ue(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function ce(t,e,n,r){var i=c(y(e,n),2),a=i[0],o=i[1],s=new Uint8Array(e*n*4);return _(t,(function(){return t.readPixels(0,0,a,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}function le(t,e,n,r,i,a,o,s){var u=t,l=new Float32Array(function(t,e){var n=c(x(t,e),2);return n[0]*n[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function he(t,e,n){var r=new Float32Array(e*n*4);return _(t,(function(){return t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)})),r}var pe={__proto__:null,bindVertexProgramAttributeStreams:ie,createBufferFromOutputTexture:se,createFloat16MatrixTexture:$t,createFloat16PackedMatrixTexture:re,createFloat32MatrixTexture:Yt,createIndexBuffer:Xt,createPackedMatrixTexture:ee,createUnsignedBytesMatrixTexture:Qt,createVertexBuffer:Ht,createVertexShader:jt,downloadByteEncodedFloatMatrixFromOutputTexture:ce,downloadFloat32MatrixFromBuffer:ue,downloadMatrixFromPackedOutputTexture:he,downloadPackedMatrixFromBuffer:le,getInternalFormatForFloat16MatrixTexture:Zt,getInternalFormatForFloat16PackedMatrixTexture:ne,getInternalFormatForFloat32MatrixTexture:Kt,getInternalFormatForPackedMatrixTexture:te,getInternalFormatForUnsignedBytesMatrixTexture:Jt,uploadDenseMatrixToTexture:ae,uploadPixelDataToTexture:oe},fe=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];var e=r.env().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,g(e,t)):this.gl=v(e),t=this.gl,2===r.env().getNumber("WEBGL_VERSION")){var n=t;this.createVertexArray=function(){return _(n,(function(){return n.createVertexArray()}))},this.bindVertexArray=function(t){return _(n,(function(){return n.bindVertexArray(t)}))},this.deleteVertexArray=function(t){return _(n,(function(){return n.deleteVertexArray(t)}))},this.getVertexArray=function(){return _(n,(function(){return n.getParameter(n.VERTEX_ARRAY_BINDING)}))}}else if(null!=t){var i=t.getExtension("OES_vertex_array_object");if(null==i)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=function(){return _(t,(function(){return i.createVertexArrayOES()}))},this.bindVertexArray=function(e){return _(t,(function(){return i.bindVertexArrayOES(e)}))},this.deleteVertexArray=function(e){return _(t,(function(){return i.deleteVertexArrayOES(e)}))},this.getVertexArray=function(){return _(t,(function(){return t.getParameter(i.VERTEX_ARRAY_BINDING_OES)}))}}var a="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===r.env().getNumber("WEBGL_VERSION")){var s="OES_texture_half_float";if(this.textureFloatExtension=E(this.gl,"OES_texture_float"),ot(this.gl,s))this.textureHalfFloatExtension=E(this.gl,s);else if(r.env().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(a),ot(this.gl,o))this.colorBufferHalfFloatExtension=E(this.gl,o);else if(r.env().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(a="EXT_color_buffer_float",ot(this.gl,a))this.colorBufferFloatExtension=this.gl.getExtension(a);else{if(!ot(this.gl,o))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(o)}this.vertexBuffer=Ht(this.gl),this.indexBuffer=Xt(this.gl),this.framebuffer=z(this.gl),this.textureConfig=w(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return r.env().getBool("DEBUG")},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;_(e,(function(){return e.finish()})),_(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),_(e,(function(){return e.deleteFramebuffer(t.framebuffer)})),_(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),_(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),_(e,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),Yt(this.gl,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),$t(this.gl,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),Qt(this.gl,t,e,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),oe(this.gl,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),ae(this.gl,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),re(this.gl,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),ee(this.gl,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(X(this.gl,this.framebuffer),this.outputTexture=null),_(this.gl,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return ce(r.gl,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,a){return le(this.gl,t,0,0,0,i,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return ue(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=se(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,i=this;if(r.env().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=a.clientWaitSync(o,0,0);return t===a.ALREADY_SIGNALED||t===a.CONDITION_SATISFIED},e=o}else r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return i.isQueryAvailable(e,r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return he(r.gl,e,n)}))},t.prototype.createProgram=function(t){var e=this;this.throwIfDisposed();var n=this.gl;null==this.vertexShader&&(this.vertexShader=jt(n));var r=O(n);_(n,(function(){return n.attachShader(r,e.vertexShader)})),_(n,(function(){return n.attachShader(r,t)})),D(n,r);var i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&M(n,i),i},t.prototype.buildVao=function(t){var e=this;this.setProgram(t),this.bindVertexArray(t.vao);var n=this.gl;_(n,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer)})),ie(n,t,this.vertexBuffer)},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(_(this.gl,(function(){return e.gl.deleteProgram(t)})),this.deleteVertexArray(t.vao))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&M(this.gl,this.program),_(this.gl,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?W(this.gl,t,e):V(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),_(this.gl,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),j(this.gl,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=c(x(e,n),2),i=r[0],a=r[1];this.setOutputMatrixTextureDriver(t,i,a)},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&M(this.gl,this.program),q(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;if(this.debug){var e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}_(t,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),_(this.gl,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=E(this.gl,2===r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var i=this.getQueryTimerExtensionWebGL1(),a=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,a),a},t.prototype.endQuery=function(){if(2!==r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){switch(n.label){case 0:return[4,r.util.repeatedTry((function(){return e.disposed||e.isQueryAvailable(t,r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),!(this.itemsToPoll.length>1)){var i=void 0;"setTimeoutCustom"in r.env().platform&&(i=r.env().platform.setTimeoutCustom.bind(r.env().platform)),r.util.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}),(function(){return 0}),null,i)}},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),H(this.gl,t,this.framebuffer),this.debug&&q(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(H(this.gl,this.outputTexture,this.framebuffer),this.debug&&q(this.gl)):X(this.gl,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;H(r,t,this.framebuffer),this.debug&&q(r),this.outputTexture=t,_(r,(function(){return r.viewport(0,0,e,n)})),_(r,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),_(this.gl,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function de(t){return function(e,n,i,a,o){var s=r.backend_util.assertAndGetBroadcastShape(e,n),u=s.length,c=r.util.computeStrides(s),l=r.util.sizeFromShape(s),h=r.util.getTypedArrayFromDType(o,l),p=e.length,f=n.length,d=r.util.computeStrides(e),m=r.util.computeStrides(n),g=r.backend_util.getBroadcastDims(e,s),v=r.backend_util.getBroadcastDims(n,s);if(g.length+v.length===0)for(var y=0;y<h.length;++y)h[y]=t(i[y%i.length],a[y%a.length]);else{var b=function(e){var n=r.util.indexToLoc(e,u,c),o=n.slice(-p);g.forEach((function(t){return o[t]=0}));var s=r.util.locToIndex(o,p,d),l=n.slice(-f);v.forEach((function(t){return l[t]=0}));var y=r.util.locToIndex(l,f,m);h[e]=t(i[s],a[y])};for(y=0;y<h.length;++y)b(y)}return[h,s]}}var me=de((function(t,e){return t+e})),ge=de((function(t,e){return t&e}));function ve(t){return function(e,n,i){for(var a=r.util.getArrayFromDType(n,e.length),o=0;o<e.length;++o)a[o]=t(e[o],i);return a}}var ye=ve((function(t){return Math.ceil(t)})),be=de((function(t,e){return t===e?1:0})),xe=ve((function(t){return Math.exp(t)})),we=ve((function(t){return Math.expm1(t)})),_e=ve((function(t){return Math.floor(t)})),Se=de((function(t,e){return t>e?1:0})),Te=de((function(t,e){return t>=e?1:0})),Ee=de((function(t,e){return t<e?1:0})),ke=de((function(t,e){return t<=e?1:0})),Ie=ve((function(t){return Math.log(t)})),Ae=de((function(t,e){return Math.max(t,e)})),Ne=de((function(t,e){return Math.min(t,e)})),Ce=de((function(t,e){return t*e})),Re=de((function(t,e){return t!==e?1:0}));function Oe(t,e){for(var n=t.slice(0,e);n.length<e;)n.push(1);for(var r=e;r<t.length;r++)n[e-1]*=t[r];return n}function De(t,e,n,i,a){var o=e.slice();o[0]=a;var s=r.util.getArrayFromDType(n,r.util.sizeFromShape(o)),c=t.length;return function(t,e,n,r,i,a){var o,s,c=Oe(e,2)[1],l=Oe(a,2)[1],h=0;try{for(var p=u(n),f=p.next();!f.done;f=p.next())for(var d=f.value,m=d[0];m<d[1];++m){for(var g=0;g<r;++g)i[h*l+g]=t[m*c+g];++h}}catch(t){o={error:t}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}}(t,e,i,0===c?0:c/e[0],s,o),[s,o]}var Me=2147483647,Fe=r.backend_util.RowPartitionType,Pe=function(){function t(t,e,n,i,a,o,s,u,c,l){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=i,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=r.backend_util.getRowPartitionTypesHelper(l),this.raggedRank=r.backend_util.getRaggedRank(this.rowPartitionTypes)}return t.prototype.getRowPartitionTypeByDimension=function(t){return this.rowPartitionTypes[0]===Fe.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]},t.prototype.getRowPartitionTensor=function(t){return this.rowPartitionTypes[0]===Fe.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]},t.prototype.getMaxWidth=function(e){var n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Fe.VALUE_ROWIDS:return t.getMaxWidthValueRowID(n);case Fe.ROW_SPLITS:return t.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(Fe[this.getRowPartitionTypeByDimension(e-1)]))}},t.getMaxWidthRowSplit=function(t){var e=t.length;if(0===e||1===e)return 0;for(var n=0,r=0;r<e-1;++r){var i=t[r+1]-t[r];i>n&&(n=i)}return n},t.getMaxWidthValueRowID=function(t){var e=t.length;if(0===e)return 0;for(var n=0,r=t[0],i=0,a=1;a<e;++a){var o=t[a];o!==r&&(r=o,i=Math.max(a-n,i),n=a)}return Math.max(e-n,i)},t.prototype.tensorShapeFromTensor=function(t,e,n){if(void 0===n&&(n=!0),0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Be(t,n)},t.prototype.calculateOutputSize=function(t){var e=this.valuesShape,n=this.defaultValueShape;r.backend_util.validateDefaultValueShape(n,e);var i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=r.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,i,e);a[0]<0&&(a[0]=t);for(var o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a},t.prototype.calculateFirstParentOutputIndex=function(t,e,n){for(var i=Math.min(t,n),a=[],o=0,s=0;s<i;++s,o+=e)a.push(o);for(s=i;s<t;++s)a.push(-1);return r.util.assert(a.length===t,(function(){return"Final length of result must be equal to firstDimension."})),a},t.prototype.calculateOutputIndexRowSplit=function(t,e,n,r){for(var i=t.length,a=[],o=0;o<i-1;++o){var s=t[o+1]-t[o],u=Math.min(r,s),c=e[o];-1===c&&(u=0);for(var l=0;l<u;++l)a.push(c),c+=n;for(l=0;l<s-u;++l)a.push(-1)}if(i>0&&a.length!==t[i-1])throw new Error("Invalid row split size.");return a},t.prototype.calculateOutputIndexValueRowID=function(t,e,n,r){var i=t.length,a=[];if(0===i)return[];var o=0,s=t[0];if(s>=e.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(e.length));var u=e[s];a.push(u);for(var c=1;c<i;++c){var l=t[c];if(l===s)u>=0&&(++o<r?u+=n:u=-1);else{if(o=0,s=l,l>=e.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(e.length));u=e[l]}a.push(u)}if(a.length!==t.length)throw new Error("Invalid row ids.");return a},t.prototype.calculateOutputIndex=function(t,e,n,r){var i=this.getRowPartitionTensor(t),a=this.getRowPartitionTypeByDimension(t);switch(a){case Fe.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,e,n,r);case Fe.ROW_SPLITS:if(i.length-1>e.length)throw new Error("Row partition size is greater than output size: ".concat(i.length-1," > ").concat(e.length));return this.calculateOutputIndexRowSplit(i,e,n,r);default:throw new Error("Unsupported partition type: ".concat(Fe[a]))}},t.prototype.getFirstDimensionSize=function(){var t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var e=this.rowPartitionTypes[0];switch(e){case Fe.FIRST_DIM_SIZE:return t[0];case Fe.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Fe.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(Fe[e]))}},t.prototype.compute=function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var t=this.getFirstDimensionSize(),e=this.calculateOutputSize(t),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var i=n.length-2;i>=0;--i)n[i]=n[i+1]*e[i+1];var a=Be(e,!1),o=r.util.getArrayFromDType(this.valuesDType,r.util.sizeFromShape(a));if(n[0]*e[0]>0){var s=this.calculateFirstParentOutputIndex(t,n[0],e[0]);for(i=1;i<=this.raggedRank;++i)s=this.calculateOutputIndex(i-1,s,n[i],e[i]);this.setOutput(this.raggedRank,s,o,a)}return[a,o]},t.prototype.setOutput=function(t,e,n,i){if(0!==n.length){var a=this.values,o=n,s=i.slice();s=s.slice(t+1);var u=r.util.sizeFromShape(s),c=e.length,l=this.defaultValue;if(l.length!==u&&1!==l.length){var h=this.defaultValueShape;r.tidy((function(){var t=r.reshape(l,h),e=r.broadcastTo(t,s);l=e.dataSync()}))}for(var p=0,f=0,d=0,m=0;m<=c;++m){var g=m<c?e[m]:-1;if(g!==d){if(f<d){var v=a.subarray(p*u);Le(o.subarray(f*u),v,(d-f)*u)}if(m>=c){var y=n.length;g=Math.floor(y/u)}if(g>d)if(1===this.defaultValue.length)o.subarray(d*u,g*u).fill(this.defaultValue[0]),d=g;else for(;g>d;)Le(o.slice(d*u),l,u),++d;g<0?(p=m+1,f=d):(p=m,d=(f=d)+1)}else++d}}},t}();function Le(t,e,n){for(var r=0;r<n;r++)t[r]=e[r]}function Be(t,e){var n,r,i=[];try{for(var a=u(t),o=a.next();!o.done;o=a.next()){var s=o.value;if(s<0){if(!e)throw new Error("Dimension ".concat(s," must be >= 0"));if(s<-1)throw new Error("Dimension ".concat(s," must be >= -1"));s=-1}i.push(s)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}var ze=ve((function(t){return 1/Math.sqrt(t)})),Ue=ve((function(t){return 1/(1+Math.exp(-t))})),Ge=ve((function(t){return Math.sqrt(t)})),We=ve((function(t,e){var n=e.pattern,r=e.replaceGlobal,i=e.rewrite;return t.replace(new RegExp(n,r?"g":""),i)})),Ve=function(){function t(t,e,n,i,a,o){this.separator=r.util.encodeString(t),this.nGramWidths=e,this.leftPad=r.util.encodeString(n),this.rightPad=r.util.encodeString(i),this.padWidth=a,this.preserveShort=o}return t.prototype.getPadWidth=function(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)},t.prototype.getNumNGrams=function(t,e){var n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)},t.prototype.createNGrams=function(t,e,n,r,i,a){for(var o=function(o){var u=s.getPadWidth(a),c=Math.max(0,u-o),l=Math.max(0,u-(i-(o+1))),h=a-(c+l),p=e+(c>0?0:o-u),f=0;f+=c*s.leftPad.length;for(var d=0;d<h;++d)f+=t[p+d].length;f+=l*s.rightPad.length,f+=(c+l+h-1)*s.separator.length,n[r+o]=new Uint8Array(f);var m=n[r+o],g=0,v=function(t){return t.forEach((function(t){return m[g++]=t}))};for(d=0;d<c;++d)v(s.leftPad),v(s.separator);for(d=0;d<h-1;++d)v(t[p+d]),v(s.separator);if(h>0)for(v(t[p+h-1]),d=0;d<l;++d)v(s.separator),v(s.rightPad);else{for(d=0;d<l-1;++d)v(s.rightPad),v(s.separator);v(s.rightPad)}},s=this,u=0;u<i;++u)o(u)},t.prototype.compute=function(t,e){var n=this,i=t.length,a=e.length;if(a>0){var o=e[0];if(0!==o)throw new Error("First split value must be 0, got ".concat(o));for(var s=1;s<a;++s){var u=e[s]>=o;if(!(u=u&&e[s]<=i))throw new Error("Invalid split value ".concat(e[s],", must be in [").concat(o,", ").concat(i,"]"));o=e[s]}if(o!==i)throw new Error("Last split value must be data size. Expected ".concat(i,", got ").concat(o))}var c=a-1,l=r.util.getArrayFromDType("int32",a);if(0===i||0===a){var h=new Array(i);for(s=0;s<=c;++s)l[s]=0;return[h,l]}l[0]=0;var p=function(t){var r=e[t]-e[t-1],i=0;f.nGramWidths.forEach((function(t){i+=n.getNumNGrams(r,t)})),f.preserveShort&&r>0&&0===i&&(i=1),l[t]=l[t-1]+i},f=this;for(s=1;s<=c;++s)p(s);var d=new Array(l[c]),m=function(r){var i=e[r],a=l[r];if(g.nGramWidths.forEach((function(o){var s=e[r+1]-e[r],u=n.getNumNGrams(s,o);n.createNGrams(t,i,d,a,u,o),a+=u})),g.preserveShort&&a===l[r]){var o=e[r+1]-e[r];if(0===o)return"continue";var s=o+2*g.padWidth;g.createNGrams(t,i,d,a,1,s)}},g=this;for(s=0;s<c;++s)m(s);return[d,l]},t}();function je(t,e,n,r){if(t.length)if(0!==e.length)if(1!==e.length){var i=0;for(u=0;u<t.length+1;u++)u!==t.length&&-1===e.indexOf(t[u])||(s=t.subarray(i,u),n&&0===s.length||r.push(s),i=u+1)}else{for(var a=e[0],o=t.indexOf(a);-1!==o;){var s=t.subarray(0,o);n&&0===s.length||r.push(s),o=(t=t.subarray(o+1)).indexOf(a)}n&&0===t.length||r.push(t)}else for(var u=0;u<t.length;++u)r.push(t.subarray(u,u+1))}var He=de((function(t,e){return t-e})),Xe=function(t,e){var n=e.value-t.value;return 0===n?t.index-e.index:n};function qe(t,e,n,i){for(void 0===n&&(n=0),void 0===i&&(i=t.length-1);i>n;){if(i-n>600){var a=i-n+1,o=e-n+1,s=Math.log(a),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(a-u)/a)*Math.sign(o-a/2);qe(t,e,Math.max(n,Math.floor(e-o*u/a+c)),Math.min(i,Math.floor(e+(a-o)*u/a+c)))}var l=t[e],h=n,p=i;for(r.util.swap(t,n,e),Xe(t[i],l)>0&&r.util.swap(t,n,i);h<p;){for(r.util.swap(t,h,p),h++,p--;Xe(t[h],l)<0;)h+=1;for(;Xe(t[p],l)>0;)p-=1}0===Xe(t[n],l)?r.util.swap(t,n,p):(p+=1,r.util.swap(t,p,i)),p<=e&&(n=p+1),e<=p&&(i=p-1)}}var Ke=me,Ye=function(t,e,n,i,a){for(var o=r.util.sizeFromShape(i),s=r.util.makeZerosTypedArray(a,n),u=0;u<t.length;u++){var c=t[u];if(c<0)throw new Error("Input x must be non-negative!");c>=a||(s[c]+=o>0?e[u]:1)}return s},Ze=function(t,e,n,i){void 0===i&&(i=!1);for(var a=t.shape[0],o=t.shape[1],s=r.buffer([a,n],e.dtype),u=0;u<a;u++)for(var c=0;c<o;c++){var l=t.get(u,c);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(i?s.set(1,u,l):e.size>0?s.set(s.get(u,l)+e.get(u,c),u,l):s.set(s.get(u,l)+1,u,l))}return s},$e=ge,Je=ye,Qe=function(t,e,n,i){var a=r.util.getArrayFromDType(n,r.util.sizeFromShape(e));if(i&&"string"!==n){var o=0;t.forEach((function(t){var e=r.util.sizeFromShape(t.shape);a.set(t.vals,o),o+=e}))}else{var s=0;t.forEach((function(t){for(var i="string"===n?r.backend_util.fromUint8ToStringArray(t.vals):t.vals,o=0,u=0;u<t.shape[0];++u)for(var c=u*e[1]+s,l=0;l<t.shape[1];++l)a[c+l]=i[o++];s+=t.shape[1]}))}return a},tn=be,en=xe,nn=we,rn=_e,an=function(t,e,n,i,a,o,s,u,h){for(var p=r.buffer([i,o],n),f=0;f<i;f++){for(var d=[],m=0,g=0;g<a;g++){var v=t[f*a+g];m+=v*s[g],d.push(v)}if(m<0||m>=h/o)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(u));for(var y=0;y<o;y++)p.values[f*o+y]=e.get.apply(e,l([],c(e.indexToLoc(m*o+y)),!1))}return p},on=Se,sn=Te,un=Ee,cn=ke,ln=function(t,e,n){var i=(e-t)/(n-1),a=r.util.makeZerosTypedArray(n,"float32");a[0]=t;for(var o=1;o<a.length;o++)a[o]=a[o-1]+i;return a},hn=Ie,pn=function(t,e,n,i){for(var a=r.util.getTypedArrayFromDType(i,r.util.sizeFromShape(n)),o=0;o<a.length;++o){for(var s=o*e,u=t[s],c=0;c<e;++c){var l=t[s+c];(Number.isNaN(l)||l>u)&&(u=l)}a[o]=u}return a},fn=Ae,dn=Ne,mn=Ce,gn=Re,vn=function(t,e,n,i,a,o,s,u){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");if(function(t,e,n){t.forEach((function(t,i){if(t<0||t>=n){var a=r.util.indexToLoc(i,e.length,r.util.computeStrides(e)).join(",");throw new Error("indices[".concat(a,"] = ").concat(t," is not in [0, ").concat(n,")"))}}))}(o,s,e[0][0]-1),0===i.length)throw new Error("params.rank must be nonzero");var c=function(t,e,n,r){var i=[],a=0,o=e.length-1+n.length,s=new Array(o).fill(null).map((function(){return[0]}));!function(t,e){for(var n=0;n<t.length;++n){var r=t[n],i=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(var a=1;a<r.length;++a)if(r[a-1]>r[a])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var u=1,c=0;c<e.length-1;++c){u*=e[c];for(var l=e[c+1],h=1;h<u+1;++h)s[c].push(h*l)}for(h=0;h<t.length;++h){var p=t[h],f=t[h]+1;for(c=0;c<n.length;++c){var d=n[c],m=c+e.length-1;if(m>=0)for(var g=s[m],v=g[g.length-1]-d[p],y=p;y<f;++y)s[m].push(d[y+1]+v);p=d[p],f=d[f]}f!==p&&(i.push([p,f]),a+=f-p)}return{outSplits:s,valueSlices:i,numValues:a}}(o,s,t,i[0]),l=c.outSplits,h=c.valueSlices,p=c.numValues,f=function(t){for(var e=[],n=function(n){var i=t[n].length,a=r.util.getArrayFromDType("int32",i);e.push(a),t[n].forEach((function(t,e){return a[e]=t}))},i=0;i<t.length;++i)n(i);return e}(l),d=De(n,i,a,h,p);return[f,d[0],d[1]]},yn=function(t,e,n,i,a,o,s){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");var u=0===e.length,c=0===a.length,l=0===s.length,h=[];u||h.push(e[0]),c||h.push(a[0]),l||h.push(s[0]);for(var p=1;p<h.length;++p)if(h[p]!==h[p-1])throw new Error("starts, limits, and deltas must have the same shape");var f=0===h.length?1:h[0],d=r.util.getArrayFromDType("int32",f+1);d[0]=0;for(var m=0;m<f;++m){var g=u?t[0]:t[m],v=c?i[0]:i[m];if(0===(T=l?o[0]:o[m]))throw new Error("Requires delta != 0");var y=void 0;if(T>0&&v<g||T<0&&v>g)y=0;else if((y=Math.ceil(Math.abs((v-g)/T)))>Me)throw new Error("Requires ((limit - start) / delta) <= ".concat(Me));d[m+1]=d[m]+y}var b=d[f],x=r.util.getArrayFromDType(n,b),w=0;for(m=0;m<f;++m){var _=d[m+1]-d[m],S=u?t[0]:t[m],T=l?o[0]:o[m];for(p=0;p<_;++p)x[w++]=S,S+=T}return[d,x]},bn=function(t,e,n,i){if(t===e||t<e&&n<0||e<t&&n>1)return r.util.makeZerosTypedArray(0,i);var a=Math.abs(Math.ceil((e-t)/n)),o=r.util.makeZerosTypedArray(a,i);e<t&&1===n&&(n=-1),o[0]=t;for(var s=1;s<o.length;s++)o[s]=o[s-1]+n;return o},xn=ze,wn=Ue,_n=function(t){for(var e=new Float32Array(t.length),n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e},Sn=function(t,e,n,i,a){var o=r.slice_util.isSliceContinous(i,e,n),s=r.util.sizeFromShape(n),u=r.util.computeStrides(i);if(o){var h=r.slice_util.computeFlatOffset(e,u);return"string"===a?t.slice(h,h+s):t.subarray(h,h+s)}for(var p="string"===a?r.backend_util.fromUint8ToStringArray(t):t,f=r.buffer(i,a,p),d=r.buffer(n,a),m=0;m<d.size;++m){var g=d.indexToLoc(m),v=g.map((function(t,n){return t+e[n]}));d.set.apply(d,l([f.get.apply(f,l([],c(v),!1))],c(g),!1))}return"string"===a?r.backend_util.fromStringArrayToUint8(d.values):d.values},Tn=function(t,e,n,i,a,o,s){var u=e[0],c=o[0],l=new Array(c),h=new Array(u),p=e[1];if(0===c){if(0!==u)throw new Error(r.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(u));return[x=r.util.getArrayFromDType(n,0),[0,p],w=r.util.getArrayFromDType(a,0),l,h]}for(var f=!0,d=0,m=new Array(c).fill(0),g=0;g<u;++g){if((y=t[g*p])<0)throw new Error(r.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,y));if(y>=c)throw new Error(r.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,y,c));++m[y],f=f&&y>=d,d=y}for(var v=!0,y=0;y<c;++y){var b=0===m[y];l[y]=b,v=v&&!b,m[y]=Math.max(m[y],1),y>0&&(m[y]+=m[y-1])}if(v&&f){var x=t,w=i;for(g=0;g<u;++g)h[g]=g;return[x,[u,p],w,l,h]}var _=m[c-1],S=(x=r.util.getArrayFromDType(n,_*p),w=r.util.getArrayFromDType(a,_),new Array(c).fill(0));for(g=0;g<u;++g){var T=S[y=t[g*p]],E=(0===y?0:m[y-1])+T;S[y]++;for(var k=0;k<p;++k)x[E*p+k]=t[g*p+k];w[E]=i[g],h[g]=E}for(y=0;y<c;++y)if(0===S[y]){var I=0===y?0:m[y-1];x[I*p+0]=y;for(var A=1;A<p;++A)x[I*p+A]=0;w[I]=s}return[x,[_,p],w,l,h]},En=function(t,e,n,i,a){for(var o=r.util.sizeFromShape(i),s=e[0],u=a.length,c=[],l=1,h=-1,p=0;p<u;++p){var f=a[p];if(-1===f){if(-1!==h)throw new Error(r.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(h,p));h=p,c.push(1)}else{if(f<0)throw new Error(r.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(p,f));l*=f,c.push(f)}}if(-1!==h){if(l<=0)throw new Error(r.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());var d=Math.trunc(o/l);if(l*d!==o)throw new Error(r.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(i,c));c[h]=d}if(r.util.sizeFromShape(c)!==o)throw new Error(r.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(i,c));var m=i.length,g=[];if(m>0)for(g[m-1]=1,p=m-2;p>=0;--p)g[p]=g[p+1]*i[p+1];var v=[];if(u>0)for(v[u-1]=1,p=u-2;p>=0;--p)v[p]=v[p+1]*c[p+1];for(var y=r.util.getArrayFromDType(n,s*u),b=0;b<s;++b){for(var x=0,w=0;w<m;++w)x+=t[b*m+w]*g[w];for(w=0;w<u;++w)y[b*u+w]=Math.trunc(x/v[w]),x%=v[w]}return[y,[s,u],c]},kn=function(t,e,n,i,a,o,s){void 0===o&&(o=!1),void 0===s&&(s=0);var u=i.length,c=[e[0],t.length/e[0]],l=c[1],h=u>0?a[u-1]+1:0;if(h<0)throw new Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());var p=e.slice();p[0]=h;var f=p.reduce((function(t,e){return t*e}),1),d=r.util.getArrayFromDType(n,f);if(0===u)return h>0&&d.fill(s),[d,p];if(h<=0)throw new Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());for(var m=0,g=1,v=0,y=a[m];;){var b=0;if(g<u){if(y===(b=a[g])){++g;continue}if(y>=b)throw new Error(r.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=h)throw new Error(r.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,h));y>v&&d.fill(s,v*l,y*l);for(var x=m;x<g;++x){var w=i[x];if(w<0||w>=c[0])throw new Error(r.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(x,i[x],c[0]));for(var _=0;_<l;_++)d[y*l+_]+=t[w*l+_]}if(o)for(_=0;_<l;_++)d[y*l+_]/=g-m;if(m=g,v=y+1,y=b,++g>u)break}return v<h&&d.fill(s,v*l,h*l),[d,p]},In=Ge,An=We,Nn=function(t,e,n,i){for(var a=r.buffer(t,e.dtype),o=0;o<a.size;o++){for(var s=a.indexToLoc(o),u=new Array(s.length),h=0;h<u.length;h++)u[h]=s[h]*n[h]+i[h];a.set.apply(a,l([e.get.apply(e,l([],c(u),!1))],c(s),!1))}return a},Cn=function(t,e,n){for(var i=t.length,a=[],o=0,s=0,u=new Array(i),c=0;c<i;++c){var l=a.length;je(t[c],e,n,a);var h=a.length-l;u[c]=h,o+=h,s=Math.max(s,h)}var p=r.util.getArrayFromDType("int32",2*o),f=new Array(o),d=[i,s],m=0;for(c=0;c<i;++c)for(var g=0;g<u[c];++g)p[2*m]=c,p[2*m+1]=g,f[m]=a[m],++m;return[p,f,d]},Rn=function(t,e){for(var n=r.util.getArrayFromDType("int32",t.length),i=0;i<t.length;++i)n[i]=r.util.fingerPrint64(t[i]).modulo(e).getLowBitsUnsigned();return n},On=He,Dn=function(t,e,n,i,a){for(var o=e.length,s=r.util.sizeFromShape(e),u=r.util.computeStrides(e),c=r.util.computeStrides(a),l=r.util.getTypedArrayFromDType(n,r.util.sizeFromShape(a)),h=0;h<s;++h){for(var p=r.util.indexToLoc(h,o,u),f=new Array(p.length),d=0;d<f.length;d++)f[d]=p[i[d]];l[r.util.locToIndex(f,o,c)]=t[h]}return l},Mn=function(t,e,n,i){for(var a=r.util.parseAxisParam(e,n)[0],o=[1,n[0],1],s=0;s<a;s++)o[0]*=n[s];for(o[1]=n[a],s=a+1;s<n.length;s++)o[2]*=n[s];var u=new Map,c=new Int32Array(n[a]),l=new r.TensorBuffer(o,i,t),h=[],p=1===o[0]&&1===o[2];for(s=0;s<n[a];s++){var f=void 0;if(p)f=t[s].toString();else{for(var d=[],m=0;m<o[0];m++)for(var g=0;g<o[2];g++)d.push(l.get(m,s,g));f=d.join(",")}var v=u.get(f);if(null!=v)c[s]=v;else{var y=u.size;u.set(f,y),c[s]=y,h.push(s)}}var b=o.slice();b[1]=u.size;var x=new r.TensorBuffer(b,i);h.forEach((function(t,e){for(var n=0;n<o[0];n++)for(var r=0;r<o[2];r++)x.set(l.get(n,t,r),n,e,r)}));var w=n.slice();return w[a]=b[1],{outputValues:x.values,outputShape:w,indices:c}};function Fn(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return"".concat(t,".").concat(e)}))}function Pn(t,e){return 1===e?[t]:Fn(t,e)}var Ln=function(){function t(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Pt(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var e=Pn("rc",this.rank),n=Ct(this.rank),r=this.getOutOfBoundsCondition(e),i=this.getSetup(e),a=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(n," rc = getOutputCoords();\n\n          if(").concat(r,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(a,"));\n          }\n        }\n      ")}}return t.prototype.getSourceCoordsArr=function(t){for(var e=[],n=0;n<=1;n++)for(var r=0;r<=1;r++){for(var i="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1"),a=2;a<this.rank;a++)i="".concat(t[t.length-1-a],",")+i;e.push(i)}return e},t.prototype.getOutOfBoundsCondition=function(t){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);for(var e="",n=this.rank-2;n<this.rank;n++)e+="".concat(t[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(e+="||");return e},t.prototype.getSetup=function(t){if(1===this.rank)return"";var e=t.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(e[0],";\n      int c = ").concat(e[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")},t.prototype.getOutput=function(t){var e=this.getSourceCoordsArr(t);if(1===this.rank){var n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(e[0],"),\n            cEdge ? 0. : getA(").concat(e[1],"),\n            rEdge ? 0. : getA(").concat(e[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(e[3],")")},t}(),Bn=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length);for(var n,r,i,a="",o=0;o<4;o++){var s="thisRC = rc;";o%2==1&&(s+="thisRC.z += 1;"),o>1&&(s+="thisRC.y += 1;"),a+="\n        ".concat(s,"\n        ").concat(o>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(o,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(o>0?"}":"","\n      ")}this.userCode="\n      ".concat((n=e,r=this.enableShapeUniforms,i=r?function(t,e,n){void 0===n&&(n="index");var r=function(t,e){var n=t.length,r=t.map((function(t){return"".concat(e,"[").concat(t,"]")})),i=new Array(n-1);i[n-2]=r[n-1];for(var a=n-3;a>=0;--a)i[a]="(".concat(i[a+1]," * ").concat(r[a+1],")");return i}(t.map((function(t,e){return e})),e);return r.map((function(e,i){var a="int ".concat(t[i]," = ").concat(n," / ").concat(r[i]),o=i===r.length-1?"int ".concat(t[i+1]," = ").concat(n," - ").concat(t[i]," * ").concat(r[i]):"index -= ".concat(t[i]," * ").concat(r[i]);return"".concat(a,"; ").concat(o,";")})).join("")}(["r","c","d"],"inputShape"):gt(["r","c","d"],n),"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(i,"\n      return ivec3(r, c, d);\n    }\n  ")),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":yt(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(a,"\n\n        setOutput(result);\n      }\n    ")},zn=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}return t.prototype.acquireTexture=function(t,e,n){var r=Gn(e,n),i=Wn(t,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);var a,o=Un(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[i].pop();return this.usedTextures[i].push(s),s}return r===f.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===f.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===f.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===f.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===f.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a},t.prototype.releaseTexture=function(t,e,n,i){if(null!=this.freeTextures){var a=Gn(n,i),o=Wn(e,a,i);o in this.freeTextures||(this.freeTextures[o]=[]);var s=Un(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,i),u=r.env().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=s):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;var c=this.usedTextures[o],l=c&&c.indexOf(t);if(null==l||l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[l]=c[c.length-1],c.pop(),this.log()}},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));var e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}},Object.defineProperty(t.prototype,"numBytesAllocated",{get:function(){return this._numBytesAllocated},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numBytesFree",{get:function(){return this._numBytesFree},enumerable:!1,configurable:!0}),t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e.texture)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}},t}();function Un(t,e,n,r,i){var a,o=function(t,e){switch(t){case f.PACKED_2X2_FLOAT32:return te(e);case f.PACKED_2X2_FLOAT16:return ne(e);case f.UNPACKED_FLOAT32:return Kt(e);case f.UNPACKED_FLOAT16:return Zt(e);case f.PACKED_4X1_UNSIGNED_BYTE:return Jt(e);default:throw new Error("Unknown physical texture type ".concat(t))}}(e,r);if(i){var s=c(x(t[0],t[1]),2);a=s[0]*s[1]}else{var u=c(y(t[0],t[1]),2);a=u[0]*u[1]}var l=function(t,e){var n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(e))}(n,o);return a*l}function Gn(t,e){if(t===p.UPLOAD)return f.PACKED_2X2_FLOAT32;if(t===p.RENDER||null==t)return function(t){return r.env().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?f.PACKED_2X2_FLOAT32:f.UNPACKED_FLOAT32:t?f.PACKED_2X2_FLOAT16:f.UNPACKED_FLOAT16}(e);if(t===p.DOWNLOAD||t===p.PIXELS)return f.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function Wn(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}var Vn=function(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},jn="if (isnan(x)) return x;",Hn="return x;",Xn="return abs(x);",qn="return (x >= 0.0) ? x : (exp(x) - 1.0);",Kn=jn+"\n  return (x < 0.0) ? 0.0 : x;\n",Yn=jn+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Zn="return x;",$n="return 1.0 / (1.0 + exp(-1.0 * x));",Jn="return x;",Qn="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",tr="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",er="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",nr="return 1.0 / (1.0 + exp(-1.0 * x));",rr=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},ir=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length);var e=t.length,n=Pn("rc",e),r=Ct(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),a=n.slice(-2),o=e<=1?"rc":"vec2(".concat(a.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(o,"));\n      }\n    ")},ar=r.kernel_impls.whereImpl,or={},sr=r.env().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),ur=function(t){function e(e){var n,i,a=t.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.lastGlFlushTime=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!r.env().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null!=e){if(e instanceof fe)n=e;else{var o=v(r.env().getNumber("WEBGL_VERSION"),e);n=new fe(o)}a.binaryCache={},a.gpgpuCreatedLocally=!1}else o=v(r.env().getNumber("WEBGL_VERSION")),n=new fe(o),a.binaryCache=((i=r.env().getNumber("WEBGL_VERSION"))in or||(or[i]={}),or[i]),a.gpgpuCreatedLocally=!0;return a.gpgpu=n,a.canvas=a.gpgpu.gl.canvas,a.textureManager=new zn(a.gpgpu),a.numMBBeforeWarning=null==r.env().global.screen?1024:r.env().global.screen.height*r.env().global.screen.width*window.devicePixelRatio*600/1024/1024,a.texData=new r.DataStorage(a,r.engine()),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.nextDataId=function(){return e.nextDataId++},e.prototype.numDataIds=function(){return this.texData.numDataIds()-this.pendingDeletes},e.prototype.writeTexture=function(t,e,n,r,i,a){var o=this.makeTensorInfo(e,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:t,texShape:[r,i]},s.texShape=[r,i];var u=Q(e),c=new Wt(u,!1,a),l=this.runWebGLProgram(c,[o],n,[[r,i]]);return l.shape=e,s.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId},e.prototype.write=function(t,e,n){if((r.env().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||r.env().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={id:this.nextDataId()};return this.texData.set(i,{shape:e,dtype:n,values:t,usage:p.UPLOAD,refCount:1}),i},e.prototype.refCount=function(t){return this.texData.has(t)?this.texData.get(t).refCount:0},e.prototype.incRef=function(t){this.texData.get(t).refCount++},e.prototype.decRef=function(t){this.texData.has(t)&&this.texData.get(t).refCount--},e.prototype.move=function(t,e,n,i,a){if(r.env().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:i,values:e,usage:p.UPLOAD,refCount:a})},e.prototype.disposeIntermediateTensorInfo=function(t){this.disposeData(t.dataId)},e.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,i=e.dtype,a=e.complexTensorInfos,o=e.slice,s=e.shape,u=e.isPacked;if(null!=o){var c;c=u?new rr(s,Zn):new Vn(s,Zn);var l=this.runWebGLProgram(c,[{dataId:t,shape:s,dtype:i}],i),h=this.readSync(l.dataId);return this.disposeIntermediateTensorInfo(l),h}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===i)return n;var p,f,d=null!=this.activeTimers;if(d&&(p=r.util.now()),"complex64"===i){var m=this.readSync(a.real.dataId),g=this.readSync(a.imag.dataId);f=r.backend_util.mergeRealAndImagArrays(m,g)}else f=this.getValuesFromTexture(t);return d&&(this.downloadWaitMs+=r.util.now()-p),this.convertAndCacheOnCPU(t,f)},e.prototype.read=function(t){return o(this,void 0,void 0,(function(){var e,n,i,a,o,u,h,p,f,d,m,g,v,y,x,w,S,T,E,k,I,A,N;return s(this,(function(s){switch(s.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),i=n.values,a=n.shape,o=n.slice,u=n.dtype,h=n.complexTensorInfos,p=n.isPacked,null!=o)return void 0,f=p?new rr(a,Zn):new Vn(a,Zn),d=this.runWebGLProgram(f,[{dataId:t,shape:a,dtype:u}],u),m=this.read(d.dataId),this.disposeIntermediateTensorInfo(d),[2,m];if(null!=i)return[2,this.convertAndCacheOnCPU(t)];if(r.env().getBool("DEBUG")&&!r.env().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===r.env().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return g=null,"complex64"!==u&&r.env().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(t),y=this.texData.get(v.dataId),g=(N=this.gpgpu).createBufferFromTexture.apply(N,l([y.texture.texture],c(b(a)),!1))),this.pendingRead.set(t,[]),"complex64"===u?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:s.sent(),s.label=2;case 2:return"complex64"!==u?[3,4]:[4,Promise.all([this.read(h.real.dataId),this.read(h.imag.dataId)])];case 3:return w=s.sent(),S=w[0],T=w[1],x=r.backend_util.mergeRealAndImagArrays(S,T),[3,5];case 4:null==g?x=this.getValuesFromTexture(t):(E=r.util.sizeFromShape(a),x=this.gpgpu.downloadFloat32MatrixFromBuffer(g,E)),s.label=5;case 5:return null!=v&&this.disposeIntermediateTensorInfo(v),null!=g&&_(k=this.gpgpu.gl,(function(){return k.deleteBuffer(g)})),I=this.convertAndCacheOnCPU(t,x),A=this.pendingRead.get(t),this.pendingRead.delete(t),A.forEach((function(t){return t(I)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&r.engine().removeDataId(t,this),this.pendingDeletes--),[2,I]}}))}))},e.prototype.readToGPU=function(t,e){void 0===e&&(e={});var n=this.texData.get(t),i=n.values,a=n.shape,o=n.slice,s=n.dtype,u=n.isPacked,c=n.texture;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){var l;l=u?new rr(a,Zn):new Vn(a,Zn);var h=this.runWebGLProgram(l,[{dataId:t,shape:a,dtype:s}],s),p=this.readToGPU(h,e);return this.disposeIntermediateTensorInfo(h),p}if(null==c)throw null!=i?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var f=this.decode(t,e.customTexShape),d=r.engine().makeTensorFromTensorInfo(f),m=this.texData.get(f.dataId);return Object.assign({tensorRef:d},m.texture)},e.prototype.bufferSync=function(t){var e=this.readSync(t.dataId);if("string"===t.dtype)try{var n=e.map((function(t){return r.util.decodeString(t)}));return r.buffer(t.shape,t.dtype,n)}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return r.buffer(t.shape,t.dtype,e)},e.prototype.checkNumericalProblems=function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!S(n)){if(r.env().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}},e.prototype.getValuesFromTexture=function(t){var e,n=this.texData.get(t),i=n.shape,a=n.dtype,o=n.isPacked,s=r.util.sizeFromShape(i);if(r.env().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(t),h=this.texData.get(u.dataId),p=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,l([h.texture.texture],c(b(i)),!1)).subarray(0,s);return this.disposeIntermediateTensorInfo(u),p}var f=r.env().getBool("WEBGL_PACK")&&!0===o,d=f?Q(i):i,m=f?new Ut(d):new zt(d),g=this.runWebGLProgram(m,[{shape:d,dtype:a,dataId:t}],"float32"),v=this.texData.get(g.dataId),y=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture.texture,v.texShape[0],v.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(g),y},e.prototype.timerAvailable=function(){return r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0},e.prototype.time=function(t){var e=this.activeTimers,n=[],i=!1;null==this.programTimersStack?(this.programTimersStack=n,i=!0):this.activeTimers.push(n),this.activeTimers=n,t();var a=r.util.flatten(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),u=r.util.flatten(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t}));this.activeTimers=e,i&&(this.programTimersStack=null);var c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return t=e.sent(),c.kernelMs=r.util.sum(t),c.getExtraProfileInfo=function(){return t.map((function(t,e){return{name:u[e],ms:t}})).map((function(t){return"".concat(t.name,": ").concat(t.ms)})).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},e.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}},e.prototype.startTimer=function(){return r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:r.util.now(),endMs:null}},e.prototype.endTimer=function(t){return r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=r.util.now(),t)},e.prototype.getQueryTime=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return r.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},e.prototype.disposeData=function(t,e){if(void 0===e&&(e=!1),this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);var n=this.texData.get(t).complexTensorInfos;return null!=n&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0},e.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,a=e.usage,o=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,a,o)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=sr),r.env().getBool("WEBGL_CPU_FORWARD")&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&r.util.sizeFromShape(t.shape)<e}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.where=function(t){r.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return ar(t.shape,e)},e.prototype.packedUnaryOp=function(t,e,n){var i=new rr(t.shape,e),a=this.compileAndRun(i,[t],n);return r.engine().makeTensorFromTensorInfo(a)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){var e=_n(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(r.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Xn,t.dtype);var n=new Vn(t.shape,Xn),i=this.compileAndRun(n,[t]);return r.engine().makeTensorFromTensorInfo(i)},e.prototype.makeTensorInfo=function(t,e,n){var i;if("string"===e&&null!=n&&n.length>0&&r.util.isString(n[0])){var a=n.map((function(t){return r.util.encodeString(t)}));i=this.write(a,t,e)}else i=this.write(n,t,e);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:e}},e.prototype.makeOutput=function(t,e,n){return r.engine().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,n),this)},e.prototype.unpackTensor=function(t){var e=new ir(t.shape);return this.runWebGLProgram(e,[t],t.dtype)},e.prototype.packTensor=function(t){var e=new Ln(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,e){var n=l([$(t.shape)],c(J(t.shape)),!1),r={dtype:t.dtype,shape:n,dataId:t.dataId},i=l([$(e)],c(J(e)),!1),a=new Bn(i,n),o=[n],s=this.runWebGLProgram(a,[r],t.dtype,o,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}},e.prototype.decode=function(t,e){var n=this.texData.get(t),i=n.isPacked,a=n.shape,o=n.dtype;if(null!=e){var s=r.util.sizeFromShape(a),u=e[0]*e[1]*4;r.util.assert(s<=u,(function(){return"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."}))}var c,l=Q(a);c=i?new Bt(l):new Lt(l);var h=[null!=e?e:b(l)];return{dtype:o,shape:a,dataId:this.runWebGLProgram(c,[{shape:l,dtype:o,dataId:t}],o,h,!0,e).dataId}},e.prototype.runWebGLProgram=function(t,e,n,i,a,o){var s=this;void 0===a&&(a=!1);var u=this.makeTensorInfo(t.outputShape,n),c=this.texData.get(u.dataId);if(t.packedOutput&&(c.isPacked=!0),t.outPackingScheme===h.DENSE){var l=null!=o?o:b(t.outputShape);c.texShape=l.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(c.usage=t.outTexUsage),0===r.util.sizeFromShape(u.shape))return c.values=r.util.getTypedArrayFromDType(u.dtype,0),u;var p=[],f=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=s.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&r.util.sizeFromShape(e.shape)<=r.env().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}if(s.uploadToGPU(e.dataId),!!n.isPacked!=!!t.packedInputs)e=n.isPacked?s.unpackTensor(e):s.packTensor(e),p.push(e),n=s.texData.get(e.dataId);else if(n.isPacked&&!nt(n.shape,e.shape)){var i=e,a=e.shape;e.shape=n.shape,e=s.packedReshape(e,a),p.push(e),n=s.texData.get(e.dataId),i.shape=a}return{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(u.dataId);var d,m={shape:u.shape,texData:c,isUniform:!1},g=function(t,e,n){var i="";e.concat(n).forEach((function(e){var a=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){var o=e.texData.texShape,s=Rt(t.packedInputs,e.shape,o),u=s.useSqueezeShape,c=s.uniformShape,l=s.keptDims,h="",p="",f="";if(1===c.length&&t.packedInputs){var d=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];h="".concat(d[0]>1,"_").concat(d[1]>1)}else if(2!==c.length||t.packedInputs){if(c.length>2&&!t.packedInputs){var m=r.util.computeStrides(c);f="".concat(m[0]===o[1],"_").concat(m[m.length-1]===o[1])}}else p="".concat(c[0]>1,"_").concat(c[1]>1);var g=e.shape.length,v=2===c.length&&r.util.arraysEqual(e.shape,o),y=1===r.util.sizeFromShape(e.shape),b=r.backend_util.getBroadcastDims(e.shape,n.shape),x=!t.packedInputs&&g===n.shape.length&&r.util.arraysEqual(o,n.texData.texShape),w=t.packedInputs||c.length>2?"":"".concat(o[0]>1,"_").concat(o[1]>1);i+="".concat(g,"_").concat(x,"_").concat(u?l:"","_").concat(c.length,"_").concat(y,"_").concat(b,"_").concat(v,"_").concat(h,"_").concat(p,"_").concat(f,"_").concat(w,"_").concat(a)}else{var _=e.isUniform?"uniform":e.texData.texShape;i+="".concat(e.shape,"_").concat(_,"_").concat(a)}}));var a=t.userCode;return t.constructor.name+"_"+i+"_"+a+"".concat(r.env().getNumber("WEBGL_VERSION"))}(t,f,m),v=this.getAndSaveBinary(g,(function(){return function(t,e,n,i){var a=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=a.map((function(t){return t.shapeInfo})),s={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},u=wt(a,s,e),c=I(t.gl,u),l=t.createProgram(c);return r.env().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:u,webGLProgram:l,inShapeInfos:o,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(l),Object.assign({program:e,fragmentShader:c,source:u,webGLProgram:l,inShapeInfos:o,outShapeInfo:s},Mt(t,e,l)))}(s.gpgpu,t,f,m)})),y=null!=this.activeTimers;y&&(d=this.startTimer()),r.env().get("ENGINE_COMPILE_ONLY")||function(t,e,n,i,a){e.program.enableShapeUniforms||(Ft(e.inShapeInfos,n),Ft([e.outShapeInfo],[i]));var o=i.texData.texture,s=i.texData.texShape;i.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,s[0],s[1]):t.setOutputMatrixTexture(o.texture,s[0],s[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),1===r.env().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN);for(var u=0;u<n.length;++u){var c=n[u],l=e.variablesLocations[u],h=l.uniform,p=l.offset,f=l.shape,d=l.texShape;if(f){var m=Rt(e.program.packedInputs,c.shape,c.texData.texShape).uniformShape;switch(m.length){case 1:t.gl.uniform1iv(f,new Int32Array(m));break;case 2:t.gl.uniform2iv(f,new Int32Array(m));break;case 3:t.gl.uniform3iv(f,new Int32Array(m));break;case 4:t.gl.uniform4iv(f,new Int32Array(m))}}if(d&&t.gl.uniform2i(d,c.texData.texShape[0],c.texData.texShape[1]),null!=h)if(c.isUniform)if(r.util.sizeFromShape(c.shape)<2)t.gl.uniform1f(h,c.uniformValues[0]);else{var g=c.uniformValues;g instanceof Float32Array||(g=new Float32Array(g)),t.gl.uniform1fv(h,g)}else null!=c.texData.slice&&null!=p&&t.gl.uniform1i(p,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,h,u)}var v=e.outShapeLocation;if(v)switch(i.shape.length){case 1:t.gl.uniform1iv(v,new Int32Array(i.shape));break;case 2:t.gl.uniform2iv(v,new Int32Array(i.shape));break;case 3:t.gl.uniform3iv(v,new Int32Array(i.shape));break;case 4:t.gl.uniform4iv(v,new Int32Array(i.shape))}if(e.outShapeStridesLocation){var y=r.util.computeStrides(i.shape);switch(i.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(y));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(y));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(y))}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,i.texData.texShape[0],i.texData.texShape[1]),e.program.customUniforms&&a)for(u=0;u<e.program.customUniforms.length;++u){var b=e.program.customUniforms[u],x=e.customUniformLocations[u],w=a[u];if("float"===b.type)t.gl.uniform1fv(x,w);else if("vec2"===b.type)t.gl.uniform2fv(x,w);else if("vec3"===b.type)t.gl.uniform3fv(x,w);else if("vec4"===b.type)t.gl.uniform4fv(x,w);else if("int"===b.type)t.gl.uniform1iv(x,w);else if("ivec2"===b.type)t.gl.uniform2iv(x,w);else if("ivec3"===b.type)t.gl.uniform3iv(x,w);else{if("ivec4"!==b.type)throw Error("uniform type ".concat(b.type," is not supported yet."));t.gl.uniform4iv(x,w)}}t.executeProgram()}(this.gpgpu,v,f,m,i),p.forEach((function(t){return s.disposeIntermediateTensorInfo(t)})),y&&(d=this.endTimer(d),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(d)}));var x=r.env().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){var w=r.util.now();w-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!r.env().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&!1===a){var _=this.unpackTensor(u);return this.disposeIntermediateTensorInfo(u),_}return u},e.prototype.compileAndRun=function(t,e,n,r,i){return void 0===i&&(i=!1),n=n||e[0].dtype,this.runWebGLProgram(t,e,n,r,i)},e.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(r.env().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=r.tidy((function(){if(!r.env().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=r.env().getBool("DEBUG");r.env().set("DEBUG",!1);var n=t.abs(r.scalar(1e-8)).dataSync()[0];if(r.env().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),i=n.shape,a=n.dtype,o=n.values,s=n.texture,u=n.usage,l=n.isPacked;if(null==s){var h,f=null!=this.activeTimers;f&&(h=r.util.now());var d=n.texShape;if(null==d&&(d=tt(i,l),n.texShape=d),null!=o){var m,g=Q(i),v=d[1],y=d[0],b=o instanceof Uint8Array||o instanceof Uint8ClampedArray;!l&&b||(v=(e=c(x(d[0],d[1]),2))[0],y=e[1]),m=l?new Vt(g,b):new Wt(g,b);var w=b?[y,v]:d,_=this.makeTensorInfo(w,a),S=this.texData.get(_.dataId);S.usage=b?p.PIXELS:p.UPLOAD,S.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(_.dataId),v,y,o);var T=[[y,v]],E=this.runWebGLProgram(m,[_],a,T,!0),k=this.texData.get(E.dataId);n.texShape=k.texShape,n.isPacked=k.isPacked,n.usage=k.usage,r.env().get("ENGINE_COMPILE_ONLY")?this.disposeData(E.dataId):(n.texture=k.texture,n.values=null,this.texData.delete(E.dataId)),this.disposeIntermediateTensorInfo(_),f&&(this.uploadWaitMs+=r.util.now()-h)}else{var I=this.acquireTexture(d,u,a,l);n.texture=I}}},e.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype ".concat(e))}(e,r)),n.values},e.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(i," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},e.prototype.computeBytes=function(t,e){return t[0]*t[1]*r.util.bytesPerElement(e)},e.prototype.checkCompileCompletion=function(){var t,e;try{for(var n=u(Object.entries(this.binaryCache)),r=n.next();!r.done;r=n.next()){var i=c(r.value,2)[1];this.checkCompletion_(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.checkCompileCompletionAsync=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,i,a,o,l,h,p,f,d,m,g=this;return s(this,(function(s){if(t=[],this.gpgpu.parallelCompilationExtension){try{for(e=u(Object.entries(this.binaryCache)),n=e.next();!n.done;n=e.next())r=c(n.value,2),h=r[1],t.push(this.checkCompletionAsync_(h))}catch(t){p={error:t}}finally{try{n&&!n.done&&(f=e.return)&&f.call(e)}finally{if(p)throw p.error}}return[2,Promise.all(t)]}i=function(e){var n=new Promise((function(t){try{g.checkCompletion_(e),t(!0)}catch(t){throw t}}));t.push(n)};try{for(a=u(Object.entries(this.binaryCache)),o=a.next();!o.done;o=a.next())l=c(o.value,2),h=l[1],i(h)}catch(t){d={error:t}}finally{try{o&&!o.done&&(m=a.return)&&m.call(a)}finally{if(d)throw d.error}}return[2,Promise.all(t)]}))}))},e.prototype.checkCompletionAsync_=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?[2,this.checkCompletion_(t)]:[3,1];case 1:return[4,r.nextFrame()];case 2:return e.sent(),[2,this.checkCompletionAsync_(t)]}}))}))},e.prototype.checkCompletion_=function(t){if(!1===this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw R(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0},e.prototype.getUniformLocations=function(){var t,e;try{for(var n=u(Object.values(this.binaryCache)),r=n.next();!r.done;r=n.next()){var i=r.value;this.gpgpu.buildVao(i.webGLProgram);var a=Mt(this.gpgpu,i.program,i.webGLProgram),o=a.variablesLocations,s=a.customUniformLocations,c=a.infLoc,l=a.nanLoc,h=a.outShapeLocation,p=a.outShapeStridesLocation,f=a.outTexShapeLocation;i.variablesLocations=o,i.customUniformLocations=s,i.infLoc=c,i.nanLoc=l,i.outShapeLocation=h,i.outShapeStridesLocation=p,i.outTexShapeLocation=f}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.createTensorFromGPUData=function(t,e,n){t.channels=t.channels||"RGBA";var i=t.texture,a=t.height,o=t.width,s=t.channels,u=r.engine().backend;if(!u.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");var c=u.writeTexture(i,e,n,a,o,s);return r.engine().makeTensorFromDataId(c,e,n,u)},e}(r.KernelBackend);function cr(){r.env().set("WEBGL_FORCE_F16_TEXTURES",!0)}ur.nextDataId=0,r.device_util.isBrowser()&&r.registerBackend("webgl",(function(){return new ur}),2);var lr={forceHalfFloat:cr},hr="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",pr=function(t,e,n){this.variableNames=["A","B"],this.outputShape=r.backend_util.assertAndGetBroadcastShape(e,n),this.enableShapeUniforms=Pt(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},fr="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",dr=function(t,e,n,i){void 0===i&&(i=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.backend_util.assertAndGetBroadcastShape(e,n);var a=this.outputShape.length;this.enableShapeUniforms=Pt(a);var o="";if(i)if(0===a||1===r.util.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var s=Ct(a);if(o="\n          ".concat(s," coords = getOutputCoords();\n        "),1===a)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=Pn("coords",a);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[a-2]," + 1) >= outShape[").concat(a," - 2];\n            bool nextColOutOfBounds =\n              (").concat(u[a-1]," + 1) >= outShape[").concat(a," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[a-2]," + 1) >= ").concat(this.outputShape[a-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[a-1]," + 1) >= ").concat(this.outputShape[a-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")};function mr(t){var e=t.inputs,n=t.backend,r=e.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var gr={kernelName:r.Identity,backendName:"webgl",kernelFunc:mr};function vr(t){var e=t.inputs,n=t.backend,r=e.real,i=e.imag,a=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(a.dataId),s=mr({inputs:{x:r},backend:n}),u=mr({inputs:{x:i},backend:n});return o.complexTensorInfos={real:s,imag:u},a}var yr={kernelName:r.Complex,backendName:"webgl",kernelFunc:vr},br="return (a < 0.) ? b * a : a;",xr="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",wr={kernelName:r.LeakyRelu,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.alpha,s=n.makeTensorInfo([],"float32",r.util.createScalarValue(o,"float32")),u=r.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new dr(xr,a.shape,s.shape):new pr(br,a.shape,s.shape),c=n.runWebGLProgram(u,[a,s],"float32");return n.disposeIntermediateTensorInfo(s),c}},_r="return (a < 0.) ? b * a : a;",Sr="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Tr={kernelName:r.Prelu,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.x,a=e.alpha,o=r.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new dr(Sr,i.shape,a.shape):new pr(_r,i.shape,a.shape);return n.runWebGLProgram(o,[i,a],"float32")}},Er="if (isnan(x)) return x;";function kr(t){var e=t.opSnippet,n=t.packedOpSnippet,i=t.cpuKernelImpl,a=t.dtype;return function(t){var o,s=t.inputs,u=t.backend,c=s.x,l=u,h=a||c.dtype;if(l.shouldExecuteOnCPU([c])&&null!=i){var p=l.texData.get(c.dataId),f=i(p.values,h);return l.makeTensorInfo(c.shape,h,f)}return o=r.env().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new rr(c.shape,n):new Vn(c.shape,e),l.runWebGLProgram(o,[c],h)}}function Ir(t){var e=t.opSnippet,n=t.packedOpSnippet,i=t.checkOutOfBounds,a=void 0!==i&&i,o=t.supportsComplex,s=void 0!==o&&o,u=t.cpuKernelImpl,l=t.dtype;return function(t){var i=t.inputs,o=t.backend,h=i.a,p=i.b,f=o;if(s&&"complex64"===h.dtype){var d=f.texData.get(h.dataId),m=f.texData.get(p.dataId),g=c([[d.complexTensorInfos.real,m.complexTensorInfos.real],[d.complexTensorInfos.imag,m.complexTensorInfos.imag]].map((function(t){var n=c(t,2),i=n[0],a=n[1],o={dataId:i.dataId,dtype:i.dtype,shape:h.shape},s={dataId:a.dataId,dtype:a.dtype,shape:p.shape},u=new pr(e,h.shape,p.shape);return f.runWebGLProgram(u,[o,s],r.upcastType(i.dtype,a.dtype))})),2),v=g[0],y=g[1],b=vr({inputs:{real:v,imag:y},backend:f});return f.disposeIntermediateTensorInfo(v),f.disposeIntermediateTensorInfo(y),b}var x,w=l||r.upcastType(h.dtype,p.dtype);if(("string"===h.dtype||"string"===p.dtype||f.shouldExecuteOnCPU([h,p]))&&null!=u){var _=f.texData.get(h.dataId).values,S=f.texData.get(p.dataId).values,T="string"===h.dtype?r.backend_util.fromUint8ToStringArray(_):_,E="string"===h.dtype?r.backend_util.fromUint8ToStringArray(S):S,k=c(u(h.shape,p.shape,T,E,w),2),I=k[0],A=k[1],N=f.makeTensorInfo(A,w);return f.texData.get(N.dataId).values=I,N}return x=r.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new dr(n,h.shape,p.shape,a):new pr(e,h.shape,p.shape),f.runWebGLProgram(x,[h,p],w)}}function Ar(t,e){if(void 0===e&&(e=!1),"linear"===t)return e?Jn:Hn;if("relu"===t)return e?tr:Kn;if("elu"===t)return e?Qn:qn;if("relu6"===t)return e?er:Yn;if("prelu"===t)return e?Sr:_r;if("leakyrelu"===t)return e?xr:br;if("sigmoid"===t)return e?nr:$n;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}var Nr=function(t,e,n,r,i,a,o,s,u){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===s&&(s=!1),void 0===u&&(u=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=Pt(this.outputShape.length);var c=r?t[1]:t[2],l=Math.ceil(c/2),h=r?"i * 2, rc.y":"rc.y, i * 2",p=i?"rc.z, i * 2":"i * 2, rc.z",f=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";o&&(m=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):u?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),g="result = activation(result);");var v=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");var y="rc.x",b="rc.x";t[0]<e[0]?y="imod(rc.x, ".concat(t[0],")"):e[0]<t[0]&&(b="imod(rc.x, ".concat(e[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(l,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(y,";\n        int batchB = ").concat(b,";\n        for (int i = 0; i < ").concat(l,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(p,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(f[0]," * ").concat(d[0],");\n          result += (").concat(f[1]," * ").concat(d[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(v,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")},Cr={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},Rr=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=r.backend_util.assertAndGetBroadcastShape(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},Or="return a * b;";function Dr(t){var e,n=t.inputs,i=t.backend,a=n.a,o=n.b,s=r.backend_util.upcastType(a.dtype,o.dtype);if("complex64"===a.dtype){var u=i.texData.get(a.dataId),l=i.texData.get(o.dataId),h=new Rr(Cr.REAL,a.shape,o.shape),p=new Rr(Cr.IMAG,a.shape,o.shape),f=[{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:a.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:o.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:o.shape}],d=i.runWebGLProgram(h,f,"float32"),m=i.runWebGLProgram(p,f,"float32"),g=vr({inputs:{real:d,imag:m},backend:i});return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(m),g}if(i.shouldExecuteOnCPU([a,o])){u=i.texData.get(a.dataId),l=i.texData.get(o.dataId);var v=c(mn(a.shape,o.shape,u.values,l.values,s),2),y=v[0],b=v[1],x=i.makeTensorInfo(b,s);return i.texData.get(x.dataId).values=y,x}return e=r.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new dr(Or,a.shape,o.shape):new pr(Or,a.shape,o.shape),i.runWebGLProgram(e,[a,o],s)}var Mr={kernelName:r.Multiply,backendName:"webgl",kernelFunc:Dr};function Fr(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.shape,s=n,u=r.util.sizeFromShape(a.shape),h=r.util.inferFromImplicitShape(o,u),p=r.util.sizeFromShape(h);r.util.assert(u===p,(function(){return"The new shape (".concat(h,") has ").concat(p," elements and the old ")+"shape (".concat(a.shape,") has ").concat(u," elements. The new shape and old ")+"shape must have the same number of elements."}));var f=s.texData.get(a.dataId);return!f.isPacked||nt(a.shape,h)||null!==f.texture&&nt(f.shape,h)?(s.incRef(a.dataId),{dataId:a.dataId,shape:h,dtype:a.dtype}):function(t,e,n){var r=l([$(t.shape)],c(J(t.shape)),!1),i={dtype:t.dtype,shape:r,dataId:t.dataId},a=l([$(e)],c(J(e)),!1),o=new Bn(a,r),s=[r],u=n.runWebGLProgram(o,[i],t.dtype,s,!0);return{dataId:u.dataId,shape:e,dtype:u.dtype}}(a,h,s)}var Pr={kernelName:r.Reshape,backendName:"webgl",kernelFunc:Fr},Lr=function(t,e){this.variableNames=["x"];var n=t.windowSize,i=t.batchSize,a=t.inSize,o=t.outSize;this.outputShape=[i,o];var s=4*Math.floor(n/4),u=n%4,c="sumValue += dot(values, ones);";if(null!=e){var l=1/e;c="sumValue += dot(values * ".concat(r.util.isInt(l)?l.toPrecision(2):l,", ones);")}var h="";a%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")},Br=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.outSize;this.outputShape=[r,a];var o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");var u="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,h="\n      if (".concat("sum"===e,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===e,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===e," || ").concat("max"===e,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),p="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===l,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===l,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===l,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(u,");\n      }\n    ")};function zr(t,e,n,i){for(var a=function(t){for(var e=[];0===e.length||1!==e[e.length-1].outSize;){var n=e.length?e[e.length-1].outSize:t[1],i=r.backend_util.computeOptimalWindowSize(n);e.push({inSize:n,windowSize:i,outSize:Math.ceil(n/i)})}return e}(t.shape),o=t,s=0;s<a.length;s++){var u,c,l=a[s],h=l.inSize,p=l.windowSize,f=l.outSize;c="mean"===n?0===s?new Lr({windowSize:p,inSize:h,batchSize:t.shape[0],outSize:f},h):new Lr({windowSize:p,inSize:h,batchSize:t.shape[0],outSize:f}):new Br({windowSize:p,inSize:h,batchSize:t.shape[0],outSize:f},n),u=o,o=i.runWebGLProgram(c,[o],e),u.dataId!==t.dataId&&i.disposeIntermediateTensorInfo(u)}return o}var Ur=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=Ct(this.rank),a=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(a,"));\n    }\n    ")},Gr=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));var i=Ct(this.rank),a=Fn("rc",this.rank),o=new Array(this.rank);for(r=0;r<e.length;r++)o[e[r]]=a[r];var s="vec2(".concat(o.slice(-2).join(),")"),u="++".concat(a[this.rank-1]," < ").concat(n[this.rank-1]),c="getChannel(getA(".concat(o.join(),"), ").concat(s,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(c,";\n      if(").concat(u,") {\n        result[1] = ").concat(c,";\n      }\n      --").concat(a[this.rank-1],";\n      if(++").concat(a[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(c,";\n        if(").concat(u,") {\n          result[3] = ").concat(c,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function Wr(t,e,n){var i=r.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Gr(t.shape,e):new Ur(t.shape,e);return n.runWebGLProgram(i,[t],t.dtype)}function Vr(t){var e=t.inputs,n=t.backend,i=t.attrs;return function(t,e,n,i){var a=e,o=t.shape.length,s=r.util.parseAxisParam(a,t.shape),u=s,l=r.backend_util.getAxesPermutation(u,o),h=null!=l,p=t;h&&(p=Wr(t,l,i),u=r.backend_util.getInnerMostAxes(u.length,o)),r.backend_util.assertAxesAreInnerMostDims("sum",u,o);var f=c(r.backend_util.computeOutAndReduceShapes(p.shape,u),2),d=f[0],m=f[1],g=d;n&&(g=r.backend_util.expandShapeToKeepDim(d,s));var v=r.util.sizeFromShape(m),y=Fr({inputs:{x:p},attrs:{shape:[r.util.sizeFromShape(t.shape)/v,v]},backend:i}),b=zr(y,r.sumOutType(t.dtype),"sum",i),x=Fr({inputs:{x:b},attrs:{shape:g},backend:i});return i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(b),h&&i.disposeIntermediateTensorInfo(p),x}(e.x,i.axis,i.keepDims,n)}var jr={kernelName:r.Sum,backendName:"webgl",kernelFunc:Vr};function Hr(t){for(var e,n=t.inputs,r=t.backend,i=t.attrs,a=n.x,o=i.perm,s=r,u=a.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=a.shape[o[l]];if(s.shouldExecuteOnCPU([a])){var h=s.texData.get(a.dataId).values,p=Dn(h,a.shape,a.dtype,o,c);e=s.makeTensorInfo(c,a.dtype),s.texData.get(e.dataId).values=p}else e=Wr(a,o,s);return e}var Xr={kernelName:r.Transpose,backendName:"webgl",kernelFunc:Hr},qr=1e3;function Kr(t){var e,n,i=t.a,a=t.b,o=t.transposeA,s=t.transposeB,c=t.backend,l=t.bias,h=void 0===l?null:l,p=t.preluActivationWeights,f=void 0===p?null:p,d=t.leakyreluAlpha,m=void 0===d?0:d,g=t.activation,v=void 0===g?null:g,y=i.shape.length,b=a.shape.length,x=o?i.shape[y-2]:i.shape[y-1],w=s?a.shape[b-1]:a.shape[b-2],_=o?i.shape[y-1]:i.shape[y-2],S=s?a.shape[b-2]:a.shape[b-1],T=i.shape.slice(0,-2),E=a.shape.slice(0,-2),k=r.util.sizeFromShape(T),I=r.util.sizeFromShape(E),A=r.broadcast_util.assertAndGetBroadcastShape(i.shape.slice(0,-2),a.shape.slice(0,-2)).concat([_,S]);r.util.assert(x===w,(function(){return"Error in matMul: inner shapes (".concat(x,") and (")+"".concat(w,") of Tensors with shapes ").concat(i.shape," and ")+"".concat(a.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match.")}));var N,C=o?[k,x,_]:[k,_,x],R=s?[I,S,w]:[I,w,S],O=Fr({inputs:{x:i},backend:c,attrs:{shape:C}}),D=Fr({inputs:{x:a},backend:c,attrs:{shape:R}}),M=[O,D],F=Math.max(k,I),P=o?O.shape[1]:O.shape[2],L=null!=h,B=null!=f,z="leakyrelu"===v,U=null!=v?Ar(v,!0):null;if((1===_||1===S)&&P>qr&&!1===(L||B||z||null!=U)){var G=O,W=D;o&&(G=Hr({inputs:{x:O},backend:c,attrs:{perm:[0,2,1]}}),M.push(G)),s&&(W=Hr({inputs:{x:D},backend:c,attrs:{perm:[0,2,1]}}),M.push(W));var V=1===S,j=G;1!==S&&(j=Fr({inputs:{x:G},backend:c,attrs:{shape:[F,P,1]}}),M.push(j));var H=1===S?2:1,X=W;V&&(X=Fr({inputs:{x:W},backend:c,attrs:{shape:[F,1,P]}}),M.push(X));var q=Dr({inputs:{a:j,b:X},backend:c});N=Vr({inputs:{x:q},backend:c,attrs:{axis:H,keepDims:!0}}),M.push(q)}else{var K=r.upcastType(i.dtype,a.dtype),Y=new Nr(C,R,[F,_,S],o,s,L,U,B,z),Z=[O,D];if(null!=h&&Z.push(h),B&&Z.push(f),z){var $=c.makeTensorInfo([],"float32",r.util.createScalarValue(m,"float32"));Z.push($),M.push($)}N=c.runWebGLProgram(Y,Z,K)}var J=Fr({inputs:{x:N},backend:c,attrs:{shape:A}});M.push(N);try{for(var Q=u(M),tt=Q.next();!tt.done;tt=Q.next()){var et=tt.value;c.disposeIntermediateTensorInfo(et)}}catch(t){e={error:t}}finally{try{tt&&!tt.done&&(n=Q.return)&&n.call(Q)}finally{if(e)throw e.error}}return J}var Yr={kernelName:r._FusedMatMul,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.a,a=e.b,o=e.bias,s=e.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return Kr({a:i,b:a,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},Zr="return abs(x);",$r={kernelName:r.Abs,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=n.x;if(i.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var o=i.texData.get(a.dataId),s=_n(o.values);return i.makeTensorInfo(a.shape,a.dtype,s)}return e=r.env().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new rr(a.shape,Zr):new Vn(a.shape,Zr),i.runWebGLProgram(e,[a],a.dtype)}},Jr=kr({opSnippet:jn+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),Qr={kernelName:r.Acos,backendName:"webgl",kernelFunc:Jr},ti=kr({opSnippet:jn+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),ei={kernelName:r.Acosh,backendName:"webgl",kernelFunc:ti},ni="return a + b;",ri=Ir({opSnippet:ni,packedOpSnippet:ni,supportsComplex:!0,cpuKernelImpl:Ke}),ii={kernelName:r.Add,backendName:"webgl",kernelFunc:ri},ai=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T".concat(e)}));var n=[];this.variableNames.forEach((function(t){n.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));var r=this.variableNames.map((function(t){return"v".concat(t)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")},oi=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T".concat(e)}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));var r=this.variableNames.map((function(t){return"v".concat(t)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")},si={kernelName:r.AddN,backendName:"webgl",kernelFunc:function t(e){var n=e.inputs,i=e.backend,a=n;if(1===a.length)return mr({inputs:{x:a[0]},backend:i});if(a.length>r.env().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(a.length/2),s=t({inputs:a.slice(0,o),backend:i}),u=t({inputs:a.slice(o),backend:i});return t({inputs:[s,u],backend:i})}var c=a.map((function(t){return t.dtype})).reduce((function(t,e){return r.upcastType(t,e)})),l=a.map((function(t){return t.shape})),h=r.env().getBool("WEBGL_PACK")?new oi(a[0].shape,l):new ai(a[0].shape,l);return i.runWebGLProgram(h,a,c)}},ui={kernelName:r.All,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims,u=a.shape.length,l=r.util.parseAxisParam(o,a.shape),h=l,p=r.backend_util.getAxesPermutation(h,u),f=a;null!=p&&(f=Hr({inputs:{x:a},backend:n,attrs:{perm:p}}),h=r.backend_util.getInnerMostAxes(h.length,u)),r.backend_util.assertAxesAreInnerMostDims("all",h,u);var d,m=c(r.backend_util.computeOutAndReduceShapes(f.shape,h),2),g=m[0],v=m[1],y=Fr({inputs:{x:f},backend:n,attrs:{shape:[-1,r.util.sizeFromShape(v)]}}),b=zr(y,y.dtype,"all",n);return d=Fr(s?{inputs:{x:b},backend:n,attrs:{shape:r.backend_util.expandShapeToKeepDim(g,l)}}:{inputs:{x:b},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),null!=p&&n.disposeIntermediateTensorInfo(f),d}},ci={kernelName:r.Any,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims,u=a.shape.length,l=r.util.parseAxisParam(o,a.shape),h=l,p=r.backend_util.getAxesPermutation(h,u),f=a;null!=p&&(f=Hr({inputs:{x:a},backend:n,attrs:{perm:p}}),h=r.backend_util.getInnerMostAxes(h.length,u)),r.backend_util.assertAxesAreInnerMostDims("any",h,u);var d,m=c(r.backend_util.computeOutAndReduceShapes(f.shape,h),2),g=m[0],v=m[1],y=Fr({inputs:{x:f},backend:n,attrs:{shape:[-1,r.util.sizeFromShape(v)]}}),b=zr(y,y.dtype,"any",n);return d=Fr(s?{inputs:{x:b},backend:n,attrs:{shape:r.backend_util.expandShapeToKeepDim(g,l)}}:{inputs:{x:b},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),null!=p&&n.disposeIntermediateTensorInfo(f),d}},li=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,a=t.outSize;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];var o="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")},hi=function(t,e,n,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,r.util.assert(t.length>2,(function(){return"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")}));var a=t[t.length-1],o=Math.ceil(a/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");var s,u,c=this.outputShape,l=c.length,h=Ct(l),p=Pn("coords",l);if(1===o){var f=Ct(u=l+1);s="\n        ".concat(f," sourceLocR = ").concat(f,"(").concat(p.join(),", 0);\n        ++").concat(p[l-1],";\n        ").concat(f," sourceLocG = ").concat(f,"(").concat(p.join(),", 0);\n        ++").concat(p[l-2],";\n        ").concat(f," sourceLocA = ").concat(f,"(").concat(p.join(),", 0);\n        --").concat(p[l-1],";\n        ").concat(f," sourceLocB = ").concat(f,"(").concat(p.join(),", 0);\n        --").concat(p[l-2],";")}else u=l,s="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(p[l-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(p[l-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(p[l-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(p[l-2],";");var d=["x","y","z","w","u","v"].slice(0,u),m="."+d[u-1],g=d.map((function(t){return"int "+t})),v=Pn("sourceLocR",u-1).concat("inIdx.r"),y=Pn("sourceLocG",u-1).concat("inIdx.g"),b=Pn("sourceLocB",u-1).concat("inIdx.b"),x=Pn("sourceLocA",u-1).concat("inIdx.a"),w="max"===n?"greaterThan":"lessThan",_=i?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),S="vec4(\n            getAChannel(".concat(v.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),T=i?"":"\n      float getBestIndicesAChannel(".concat(g.join(),") {\n        return getChannel(getBestIndicesA(").concat(d.join(),"),\n                                          vec2(").concat(d.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(g.join(),") {\n        return getChannel(getA(").concat(d.join(),"),\n                               vec2(").concat(d.slice(-2).join(),"));\n      }\n      ").concat(T,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(p[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(m,", sourceLocG").concat(m,",\n          sourceLocB").concat(m,", sourceLocA").concat(m,") * ").concat(e,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(S,";\n\n        for (int i = 0; i < ").concat(e,"; i++) {\n          inIdx = srcIdx;\n          ").concat(_,"\n          vec4 candidate = ").concat(S,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(w,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")};function pi(t,e,n,i){void 0===i&&(i=null);var a=e.shape[0],o=e.shape[1];null!=i&&(a=i.shape[0],o=i.shape[1]);var s=r.backend_util.computeOptimalWindowSize(o),u={windowSize:s,inSize:o,batchSize:a,outSize:Math.ceil(o/s)},c=new li(u,n,null==i),l=[e];null!=i&&l.push(i);var h=t.runWebGLProgram(c,l,"int32");if(1===h.shape[1])return h;var p=pi(t,e,n,h);return t.disposeIntermediateTensorInfo(h),p}function fi(t,e,n,i){void 0===i&&(i=null);var a=null!=i?i.shape:e.shape,o=a[a.length-1],s=r.backend_util.computeOptimalWindowSize(o),u=new hi(a,s,n,null==i),c=null==i?[e]:[e,i],l=t.runWebGLProgram(u,c,"int32");if(l.shape.length===e.shape.length){var h=fi(t,e,n,l);return t.disposeIntermediateTensorInfo(l),h}return l}function di(t,e,n,i){var a=[n];if(r.backend_util.assertAxesAreInnerMostDims("arg"+i.charAt(0).toUpperCase()+i.slice(1),a,e.shape.length),!r.env().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){var o=[],s=t.texData.get(e.dataId),u=e;null!==s&&s.isPacked&&(u=t.unpackTensor(e),o.push(u));var l=c(r.backend_util.computeOutAndReduceShapes(u.shape,a),2),h=l[0],p=l[1],f=r.util.sizeFromShape(p),d=Fr({inputs:{x:u},backend:t,attrs:{shape:[-1,f]}});o.push(d);var m=pi(t,d,i);o.push(m);var g=Fr({inputs:{x:m},backend:t,attrs:{shape:h}});return o.forEach((function(e){return t.disposeIntermediateTensorInfo(e)})),g}return fi(t,e,i)}var mi={kernelName:r.ArgMax,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=r.util.parseAxisParam(o,a.shape),u=r.backend_util.getAxesPermutation(s,a.shape.length),c=a,l=[];null!=u&&(c=Hr({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(c),s=r.backend_util.getInnerMostAxes(s.length,c.shape.length)),r.backend_util.assertAxesAreInnerMostDims("argMax",[s[0]],c.shape.length);var h=di(n,c,s[0],"max");return l.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),h}},gi={kernelName:r.ArgMin,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=r.util.parseAxisParam(o,a.shape),u=r.backend_util.getAxesPermutation(s,a.shape.length),c=a,l=[];null!=u&&(c=Hr({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(c),s=r.backend_util.getInnerMostAxes(s.length,c.shape.length)),r.backend_util.assertAxesAreInnerMostDims("argMin",[s[0]],c.shape.length);var h=di(n,c,s[0],"min");return l.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),h}},vi=kr({opSnippet:jn+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),yi={kernelName:r.Asin,backendName:"webgl",kernelFunc:vi},bi=kr({opSnippet:jn+"return log(x + sqrt(x * x + 1.0));"}),xi={kernelName:r.Asinh,backendName:"webgl",kernelFunc:bi},wi=kr({opSnippet:jn+"\n  return atan(x);\n"}),_i={kernelName:r.Atan,backendName:"webgl",kernelFunc:wi},Si=Ir({opSnippet:hr+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+fr+"\n  return result;\n"}),Ti={kernelName:r.Atan2,backendName:"webgl",kernelFunc:Si},Ei=kr({opSnippet:jn+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),ki={kernelName:r.Atanh,backendName:"webgl",kernelFunc:Ei},Ii=function(t,e,n,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var a=t.filterWidth,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;var d="avg"===e,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),v="0.0";if(d||(v="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(p,", ").concat(f,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(">="," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?i?m:g:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var y="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / max(count, 1.0)");var b=4*Math.floor(a/4),x=a%4,w="\n      if (".concat(d,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(p,", ").concat(f,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(l,";\n            wR += ").concat(u,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}},Ai=function(t,e,n,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var a=t.filterWidth,o=t.strideDepth,s=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,h=t.dilationWidth,p=t.effectiveFilterDepth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;var y="avg"===e,b="0.0";if(y||(b="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(s,", ").concat(u,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(p,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(f,";\n                wR += ").concat(l,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(d,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(">="," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(f," * ").concat(d," +\n                      wR * ").concat(d," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var x="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(x="avgValue / max(count, 1.0)");var w=4*Math.floor(a/4),_=a%4,S="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(s,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(p,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===_,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===_,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===_,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}},Ni={kernelName:r.AvgPool,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x;pt(a,"avgPool");var o=i.filterSize,s=i.strides,u=i.pad,c=i.dimRoundingMode;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l=r.backend_util.computePool2DInfo(a.shape,o,s,1,u,c);if(1===l.filterWidth&&1===l.filterHeight&&r.util.arraysEqual(l.inShape,l.outShape))return mr({inputs:{x:a},backend:n});var h=new Ii(l,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},Ci={kernelName:r.AvgPool3D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.filterSize,s=i.strides,u=i.pad,c=i.dimRoundingMode,l=i.dataFormat,h=r.backend_util.computePool3DInfo(a.shape,o,s,[1,1,1],u,c,l),p=new Ai(h,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}},Ri=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(l,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(u,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Oi=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,f=l-1-t.padInfo.front,d=h-1-t.padInfo.top,m=p-1-t.padInfo.left,g=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(d,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(l,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(u,") {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Di={kernelName:r.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=i.filterSize,u=i.strides,c=i.pad,l=i.dimRoundingMode,h=r.backend_util.computePool3DInfo(o.shape,s,u,[1,1,1],c,l),p=new Oi(h);return n.runWebGLProgram(p,[a],o.dtype)}},Mi={kernelName:r.AvgPoolGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=o;pt([a,o],"avgPoolGrad");var u=i.filterSize,c=i.strides,l=i.pad,h=r.backend_util.computePool2DInfo(s.shape,u,c,1,l),p=new Ri(h);return n.runWebGLProgram(p,[a],s.dtype)}},Fi={kernelName:r.BatchMatMul,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;return Kr({a:e.a,b:e.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},Pi=function(t,e,n,i,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],r.backend_util.assertAndGetBroadcastShape(t,e),r.backend_util.assertAndGetBroadcastShape(t,n);var s="0.0";null!=i&&(r.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=a&&(r.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},Li=function(t,e,n,i,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],r.backend_util.assertAndGetBroadcastShape(t,e),r.backend_util.assertAndGetBroadcastShape(t,n);var s="vec4(0.0)";null!=i&&(r.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=a&&(r.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},Bi={kernelName:r.FusedBatchNorm,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.mean,s=e.variance,u=e.offset,c=e.scale;r.util.assert(o.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),r.util.assert(null==u||o.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),r.util.assert(null==c||o.shape.length===c.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var l=i.varianceEpsilon;null==l&&(l=.001);var h=[a,o,s],p=null;null!=u&&(p=u.shape,h.push(u));var f=null;null!=c&&(f=c.shape,h.push(c));var d=r.env().getBool("WEBGL_PACK_NORMALIZATION")?new Li(a.shape,o.shape,s.shape,p,f,l):new Pi(a.shape,o.shape,s.shape,p,f,l);return n.runWebGLProgram(d,h,h[0].dtype)}},zi=function(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e=Ct(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n,r=function(t){if(1===t)return"sourceLoc";if(t<=6)return Ui.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank),i=t.map((function(t,e){return"sourceLoc.".concat(Ui[e]," = start[").concat(e,"] + coords.").concat(Ui[e],";")}));n="\n        ".concat(e," sourceLoc;\n        ").concat(e," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(n,"\n        setOutput(getSource(").concat(r,"));\n      }\n    ")},Ui=["x","y","z","w","u","v"],Gi=function(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var e=Ct(this.rank),n=Pn("coords",this.rank),r=Pn("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),a="getChannel(getSource(".concat(r.join(),"), ").concat(i,")"),o="\n      result.x = ".concat(a,";\n      if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(a,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(a,";\n        if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(a,";\n        }\n      }\n    "),u=this.rank<=4?"sourceLoc = coords +\n            ".concat(e,"(").concat(t.map((function(t,e){return"start[".concat(e,"]")})).join(),");"):t.map((function(t,e){return"".concat(r[e]," = ").concat(n[e]," + start[").concat(e,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(e," coords = getOutputCoords();\n        ").concat(e," sourceLoc;\n        ").concat(u,"\n        vec4 result = vec4(0.);\n        ").concat(o,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")};function Wi(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.begin,s=i.size,u=c(r.slice_util.parseSliceParams(a,o,s),2),l=u[0],h=u[1];if(r.slice_util.assertParamsValid(a,l,h),0===r.util.sizeFromShape(h))return n.makeTensorInfo(h,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var p=n.texData.get(a.dataId),f=Sn(p.values,l,h,a.shape,a.dtype);return n.makeTensorInfo(h,a.dtype,f)}var d=n.texData.get(a.dataId).isPacked,m=r.slice_util.isSliceContinous(a.shape,l,h);if(d||!m){var g=r.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Gi(h):new zi(h),v=[l];return n.runWebGLProgram(g,[a],a.dtype,v)}return n.uploadToGPU(a.dataId),function(t,e,n,i){var a=i.texData.get(t.dataId),o=i.makeTensorInfo(n,t.dtype),s=i.texData.get(o.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=t.dtype;var u=r.slice_util.computeFlatOffset(e,r.util.computeStrides(t.shape));a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||t.dataId};var c=i.dataRefCount.get(s.slice.origDataId)||1;return i.dataRefCount.set(s.slice.origDataId,c+1),o}(a,l,h,n)}var Vi={kernelName:r.Slice,backendName:"webgl",kernelFunc:Wi},ji={kernelName:r.BatchToSpaceND,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.blockShape,s=i.crops;r.util.assert(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var u=o.reduce((function(t,e){return t*e})),c=r.backend_util.getReshaped(a.shape,o,u),l=r.backend_util.getPermuted(c.length,o.length),h=r.backend_util.getReshapedPermuted(a.shape,o,u),p=r.backend_util.getSliceBeginCoords(s,o.length),f=r.backend_util.getSliceSize(h,s,o.length),d=[],m=Fr({inputs:{x:a},backend:n,attrs:{shape:c}}),g=Hr({inputs:{x:m},backend:n,attrs:{perm:l}}),v=Fr({inputs:{x:g},backend:n,attrs:{shape:h}}),y=Wi({inputs:{x:v},backend:n,attrs:{begin:p,size:f}});return d.push(m),d.push(g),d.push(v),d.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),y}},Hi={kernelName:r.Bincount,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=e.weights,o=r.size,s=n.readSync(i.dataId),u=n.readSync(a.dataId),c=Ye(s,u,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,c)}},Xi={kernelName:r.BitwiseAnd,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=n.a,o=n.b,s=r.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"),u=r.env().getNumber("WEBGL_VERSION");if(i.shouldExecuteOnCPU([a,o])||1===u){var l=i.texData.get(a.dataId).values,h=i.texData.get(o.dataId).values,p=c($e(a.shape,o.shape,l,h,a.dtype),2),f=p[0],d=p[1],m=i.makeTensorInfo(d,a.dtype);return i.texData.get(m.dataId).values=f,m}return e=s?new dr("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",a.shape,o.shape,!1):new pr("\n  return float(int(a.r) & int(b.r));\n",a.shape,o.shape),i.runWebGLProgram(e,[a,o],a.dtype)}},qi={kernelName:r.BroadcastArgs,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.s0,a=e.s1,o=n.readSync(i.dataId),s=n.readSync(a.dataId),u=r.backend_util.assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}},Ki=Ir({opSnippet:"return float(a != b);",cpuKernelImpl:gn,dtype:"bool"}),Yi={kernelName:r.NotEqual,backendName:"webgl",kernelFunc:Ki};function Zi(t){var e=t.inputs,n=t.backend,r=e.input;return mr({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var $i={kernelName:r.Real,backendName:"webgl",kernelFunc:Zi},Ji={kernelName:r.Cast,backendName:"webgl",kernelFunc:function t(e){var n=e.inputs,a=e.backend,o=e.attrs,s=n.x,u=o.dtype;if("complex64"===u){if("complex64"===s.dtype)return mr({inputs:{x:s},backend:a});var l=i.zeros(s.shape),h=t({inputs:{x:s},backend:a,attrs:{dtype:"float32"}}),p=vr({inputs:{real:h,imag:l},backend:a});return l.dispose(),a.disposeIntermediateTensorInfo(h),p}if("complex64"===s.dtype){var f=Zi({inputs:{input:s},backend:a});p=t({inputs:{x:f},backend:a,attrs:{dtype:u}});return a.disposeIntermediateTensorInfo(f),p}if(!r.util.hasEncodingLoss(s.dtype,u))return{dataId:(p=mr({inputs:{x:s},backend:a})).dataId,shape:p.shape,dtype:u};if(a.shouldExecuteOnCPU([s])){var d=c(function(t,e,n,i){if("int32"===i)return[e,"int32",Int32Array.from(t)];if("bool"===i){var a=r.util.toTypedArray([0],n),o=c(de((function(t,e){return t!==e?1:0}))(e,[],t,a,"bool"),2),s=o[0];return[o[1],"bool",s]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(i))}(a.texData.get(s.dataId).values,s.shape,s.dtype,u),3),m=d[0],g=d[1],v=d[2];return a.makeTensorInfo(m,g,v)}if("int32"===u)return function(t,e){var n=new Vn(t.shape,"return float(int(x));"),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(s,a);if("bool"===u){var y=a.makeTensorInfo([],"bool",r.util.getTypedArrayFromDType("bool",1));return p=Ki({inputs:{a:s,b:y},backend:a}),a.disposeIntermediateTensorInfo(y),p}throw new Error("Error in Cast: failed to cast ".concat(s.dtype," to ").concat(u))}},Qi="return ceil(x);",ta=kr({opSnippet:Qi,packedOpSnippet:Qi,cpuKernelImpl:Je}),ea={kernelName:r.Ceil,backendName:"webgl",kernelFunc:ta},na=function(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "},ra=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "},ia={kernelName:r.ClipByValue,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.x,s=a.clipValueMin,u=a.clipValueMax;e=r.env().getBool("WEBGL_PACK_CLIP")?new ra(o.shape):new na(o.shape);var c=[[s],[u]];return i.runWebGLProgram(e,[o],o.dtype,c)}},aa=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "};function oa(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}var sa={kernelName:r.ComplexAbs,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n.texData.get(r.dataId),a=new aa(r.shape),o=[oa(r,i.complexTensorInfos.real),oa(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}},ua=function(t){this.outputShape=[],this.outputShape=r.backend_util.computeOutShape(t,1),this.variableNames=t.map((function(t,e){return"T".concat(e)}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var i=["if (yC < ".concat(e[0],") setOutput(getT0(yR, yC));")];for(n=1;n<e.length;n++){var a=e[n-1];i.push("else if (yC < ".concat(e[n],") ")+"setOutput(getT".concat(n,"(yR, yC-").concat(a,"));"))}var o=e.length,s=e[e.length-1];i.push("else setOutput(getT".concat(o,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(i.join("\n        "),"\n      }\n    ")},ca=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=r.backend_util.computeOutShape(t,e);var n=this.outputShape,i=n.length,a=Ct(i),o=Pn("coords",i),s=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((function(t,e){return"T".concat(e)}));var u=new Array(t.length-1);u[0]=t[0][e];for(var c=1;c<u.length;c++)u[c]=u[c-1]+t[c][e];var l=s[e],h=s.slice(-2),p=s.join(),f="if (".concat(l," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(h.join(),"));\n        }");for(c=1;c<u.length;c++){var d=u[c-1];f+="\n        if (".concat(l," < ").concat(u[c],"  && ").concat(l," >= ").concat(u[c-1],") {\n          return getChannel(\n            getT").concat(c,"(").concat(la(s,l,d),"),\n            vec2(").concat(la(h,l,d),"));\n        }")}var m=u.length,g=u[u.length-1];f+="\n        return getChannel(\n          getT".concat(m,"(").concat(la(s,l,g),"),\n          vec2(").concat(la(h,l,g),"));"),this.userCode="\n      float getValue(".concat(s.map((function(t){return"int "+t})),") {\n        ").concat(f,"\n      }\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[i-1]," = ").concat(o[i-1]," + 1;\n        if (").concat(o[i-1]," < ").concat(n[i-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[i-2]," = ").concat(o[i-2]," + 1;\n        if (").concat(o[i-2]," < ").concat(n[i-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[i-1]," = ").concat(o[i-1]," - 1;\n        if (").concat(o[i-2]," < ").concat(n[i-2]," &&\n            ").concat(o[i-1]," < ").concat(n[i-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")};function la(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?"".concat(t," - ").concat(n):t})).join()}function ha(t){var e=t.inputs,n=t.backend,r=e.input;return mr({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var pa={kernelName:r.Imag,backendName:"webgl",kernelFunc:ha};function fa(t,e,n){var i,a,o=t[0].dtype;if("complex64"===o){var s=t.map((function(t){return Zi({inputs:{input:t},backend:n})})),c=t.map((function(t){return ha({inputs:{input:t},backend:n})})),l=fa(s,e,n),h=fa(c,e,n),p=vr({inputs:{real:l,imag:h},backend:n});return s.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),c.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),p}var f=n.shouldExecuteOnCPU(t);if("string"===o&&(f=!0),f){var d=t.map((function(t){var i=r.util.sizeFromShape(t.shape.slice(e));return Fr({inputs:{x:t},backend:n,attrs:{shape:[-1,i]}})})),m=d.map((function(t){return{vals:n.readSync(t.dataId),shape:t.shape}})),g=r.backend_util.computeOutShape(d.map((function(t){return t.shape})),1),v=1===d[0].shape[0],y=Qe(m,g,o,v),b=r.backend_util.computeOutShape(t.map((function(t){return t.shape})),e),x=n.makeTensorInfo(b,o,y);return d.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),x}var w=t.filter((function(t){return r.util.sizeFromShape(t.shape)>0})),_=r.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&w[0].shape.length>1;if(1===w.length){var S=_?new Vn(t[0].shape,Zn):new rr(t[0].shape,Zn);return n.runWebGLProgram(S,t,o)}var T=r.env().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(w.length>T){for(var E=[],k=0;k<w.length;k+=T){var I=w.slice(k,k+T);E.push(fa(I,e,n))}var A=fa(E,e,n);try{for(var N=u(E),C=N.next();!C.done;C=N.next())k=C.value,n.disposeIntermediateTensorInfo(k)}catch(t){i={error:t}}finally{try{C&&!C.done&&(a=N.return)&&a.call(N)}finally{if(i)throw i.error}}return A}if(_){var R=new ca(w.map((function(t){return t.shape})),e);return n.runWebGLProgram(R,w,o)}var O=function(t,e,n){var i=r.backend_util.computeOutShape(t.map((function(t){return t.shape})),e),a=t.map((function(t){return Fr({inputs:{x:t},attrs:{shape:[-1,r.util.sizeFromShape(t.shape.slice(e))]},backend:n})}));return{tensors2D:a,outShape:i}}(w,e,n),D=O.tensors2D,M=O.outShape,F=new ua(D.map((function(t){return t.shape}))),P=n.runWebGLProgram(F,D,o);D.forEach((function(t){return n.disposeIntermediateTensorInfo(t)}));var L=Fr({inputs:{x:P},attrs:{shape:M},backend:n});return n.disposeIntermediateTensorInfo(P),L}function da(t){var e=t.inputs,n=t.backend,i=t.attrs.axis,a=r.util.parseAxisParam(i,e[0].shape)[0],o=e.map((function(t){return t.shape}));r.backend_util.assertParamsConsistent(o,a);var s=r.backend_util.computeOutShape(e.map((function(t){return t.shape})),a);if(0===r.util.sizeFromShape(s))return n.makeTensorInfo(s,e[0].dtype,[]);var u=e.filter((function(t){return r.util.sizeFromShape(t.shape)>0}));return 1===u.length?mr({inputs:{x:u[0]},backend:n}):fa(u,a,n)}var ma={kernelName:r.Concat,backendName:"webgl",kernelFunc:da},ga=function(t,e,n,r,i){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var a=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,h=t.filterHeight,p=t.filterWidth,f=4*Math.floor(t.inChannels/4),d=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,v=m?2:3,y=m?3:1,b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");var w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(v,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===d,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(f,") *\n                    getW(wR, wC, ").concat(f,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(f,", xR, xC) *\n                    getW(wR, wC, ").concat(f,", d2);\n              }\n\n            } else if (").concat(2===d,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===d,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2),\n                getW(wR, wC, ").concat(f," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1),\n                  getX(batch, xR, xC, ").concat(f," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC),\n                  getX(batch, ").concat(f," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")},va=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,p=t.filterWidth,f=4*Math.floor(t.inChannels/4),d=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(a,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(e,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(l,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(u,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===d,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(f,") *\n                  getW(wF, wR, wC, ").concat(f,", d2);\n              } else if (").concat(2===d,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===d,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1),\n                  getX(batch, xF, xR, xC, ").concat(f," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2),\n                  getW(wF, wR, wC, ").concat(f," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},ya=function(t,e,n,i,a){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===i&&(i=!1),void 0===a&&(a=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Pt(this.outputShape.length);for(var o=t.padInfo.left,s=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,h=l,p="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;",f=0;f<l;f++)p+="\n           vec4 xTexelC".concat(2*f,";\n           int xTexelC").concat(2*f,"Ready;\n           vec4 xTexelC").concat(2*f+1,";\n           int xTexelC").concat(2*f+1,"Ready;\n           vec4 xC").concat(f,";");for(p+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       "),f=0;f<l;f++)p+="\n           xTexelC".concat(2*f," = vec4(0.0);\n           xTexelC").concat(2*f,"Ready = 0;\n           xTexelC").concat(2*f+1," = vec4(0.0);\n           xTexelC").concat(2*f+1,"Ready = 0;\n           xC").concat(f," = vec4(0.0);");p+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(var d=0;d<(h+1)/2;d++){var m=2*d;if(p+="\n           xC = xCCorner + ".concat(m*u,";\n           "),1===s){if(m<l&&(o%2==1?(p+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n               "),p+=1===u&&m>0?"\n                 xC".concat(m," = vec4(xTexelC").concat(m-2,".zw, xTexelC").concat(m,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(m," = vec4(previous.zw, xTexelC").concat(m,".xy);\n                   } else {\n                     xC").concat(m," = vec4(0.0, 0.0, xTexelC").concat(m,".xy);\n                   }\n                   ")):p+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xC").concat(m," = xTexelC").concat(m,";\n                 "),m+1<l)){var g=o%2==0?r.util.nearestLargerEven(u):u;u%2==0&&o%2==1||u%2!=0&&o%2!=1?(p+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(g,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                     xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(m+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(m+1,"Ready = 1;\n                   }\n                   "),p+=u>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(m+1," = vec4(previous.zw, xTexelC").concat(m+1,".xy);\n                     } else {\n                      xC").concat(m+1," = vec4(0.0, 0.0, xTexelC").concat(m+1,".xy);\n                     }\n                     "):"\n                     xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".xy);\n                     ")):p+=1===g?"\n                     xC".concat(m+1," = xTexelC").concat(m,";\n                     "):"\n                     xCOffset = xC + ".concat(g,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                       xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(m+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(m+1,"Ready = 1;\n                     }\n\n                     xC").concat(m+1," = xTexelC").concat(m+1,";\n                     ")}}else m<l&&(o%2==1?(p+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n               "),m+1<l&&(p+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(m+1," = vec4(xTexelC").concat(m+1,".xy, final.xy);\n                 "))):(p+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(\n                   xTexelC").concat(m,".xy, xTexelC").concat(m+1,".xy);\n               "),m+1<l&&(p+="\n                   xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n                 "))));m<l&&(p+="\n             wTexel = getW(r, ".concat(m,", d1, d2);\n             dotProd += xC").concat(m,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(m,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),m+1<l&&(p+="\n               wTexel = getW(r, ".concat(m+1,", d1, d2);\n               dotProd += xC").concat(m+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(m+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}p+="\n     }\n   ",p+="\n     }\n   ",p+="\n     }\n   ";var v="",y="";n&&(v=i?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):a?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),y="result = activation(result);");var b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(v,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(p,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(b,"\n         ").concat(y,"\n         setOutput(result);\n       }\n     ")},ba=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Pt(this.outputShape.length);for(var n=e.dataFormat,r=mt(),i="channelsLast"===n,a=i?1:2,o=i?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {"),u="",c=0;c<=1;c++)for(var l=0;l<=1;l++)u+="\n          blockIndex = rc.z + ".concat(l,";\n          pos = rc.y + ").concat(c,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(a,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(o,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*c+l,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*c+l,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(u,"\n\n        ").concat(r.output," = result;\n      }\n    ")};function xa(t,e){var n=t.length;return n>=3?l(l([],c(t.slice(0,-3)),!1),e?[t[n-3]*t[n-2],t[n-1]]:[t[n-3],t[n-2]*t[n-1]],!1):!e&&1===n&&t[0]>1?[t[0],1]:null}function wa(t){var e,n,i,a=t.x,o=t.filter,s=t.convInfo,c=t.backend,l=t.bias,h=void 0===l?null:l,p=t.preluActivationWeights,f=void 0===p?null:p,d=t.leakyreluAlpha,m=void 0===d?0:d,g=t.activation,v=void 0===g?null:g,y=a.shape,b=c.texData.get(a.dataId),x=s.inChannels,w=y[0]*y[1]*y[2],_=s.outChannels,S="channelsLast"===s.dataFormat,T=[];if(null!=f&&null!=(E=xa(f.shape,S))&&(f=Fr({inputs:{x:f},backend:c,attrs:{shape:E}}),T.push(f)),null!=h&&null!=(E=xa(h.shape,S))&&(h=Fr({inputs:{x:h},backend:c,attrs:{shape:E}}),T.push(h)),(1!==w&&1!==_||!(x>qr))&&b.isPacked&&S&&null!=b.texture&&y[2]%2!=0&&r.util.arraysEqual(b.shape.slice(-3),y.slice(-3))){var E=y[0]*y[1]*(y[2]+1),k={dataId:a.dataId,shape:[1,E,s.inChannels],dtype:a.dtype},I=b.shape;b.shape=b.shape.slice(),b.shape[b.shape.length-2]++,r.util.assert(nt(b.shape,k.shape),(function(){return"packed reshape ".concat(b.shape," to ").concat(k.shape," isn't free")}));var A=Fr({inputs:{x:o},backend:c,attrs:{shape:[1,s.inChannels,s.outChannels]}});T.push(A);var N=Kr({a:k,b:A,backend:c,transposeA:!1,transposeB:!1,bias:h,activation:v,preluActivationWeights:f,leakyreluAlpha:m}),C=c.texData.get(N.dataId);r.util.assert(C.isPacked,(function(){return"batchMatMul result is expected to be packed"})),b.shape=I,C.shape=s.outShape,(i=mr({inputs:{x:N},backend:c})).shape=s.outShape,T.push(N)}else{var R=s.outHeight*s.outWidth,O=Fr({inputs:{x:a},backend:c,attrs:{shape:S?[s.batchSize,R,s.inChannels]:[s.batchSize,s.inChannels,R]}}),D=(A=Fr({inputs:{x:o},backend:c,attrs:{shape:[1,s.inChannels,s.outChannels]}}),Kr({a:S?O:A,b:S?A:O,transposeA:!S,transposeB:!1,backend:c,bias:h,activation:v,preluActivationWeights:f,leakyreluAlpha:m}));i=Fr({inputs:{x:D},backend:c,attrs:{shape:s.outShape}}),T.push(O),T.push(A),T.push(D)}try{for(var M=u(T),F=M.next();!F.done;F=M.next()){var P=F.value;c.disposeIntermediateTensorInfo(P)}}catch(t){e={error:t}}finally{try{F&&!F.done&&(n=M.return)&&n.call(M)}finally{if(e)throw e.error}}return i}function _a(t){var e,n,i,a=t.x,o=t.filter,s=t.convInfo,c=t.backend,l=t.bias,h=void 0===l?null:l,p=t.preluActivationWeights,f=void 0===p?null:p,d=t.leakyreluAlpha,m=void 0===d?0:d,g=t.activation,v=void 0===g?null:g,y=s.filterWidth,b=s.filterHeight,x=s.inChannels,w=s.outWidth,_=s.outHeight,S="channelsLast"===s.dataFormat,T=y*b*x,E=_*w,k=[s.batchSize,T,E],I=[];null!=f&&null!=(i=xa(f.shape,S))&&(f=Fr({inputs:{x:f},backend:c,attrs:{shape:i}}),I.push(f)),null!=h&&null!=(i=xa(h.shape,S))&&(h=Fr({inputs:{x:h},backend:c,attrs:{shape:i}}),I.push(h));var A=Fr({inputs:{x:o},backend:c,attrs:{shape:[1,T,r.util.sizeFromShape(o.shape)/T]}});I.push(A);var N=new ba(k,s),C=[a.shape,[s.padInfo.top,s.padInfo.left],[s.strideHeight,s.strideWidth],[s.dilationHeight,s.dilationWidth],[s.inChannels],[s.filterWidth*s.inChannels],[s.outWidth]],R=c.runWebGLProgram(N,[a],"float32",C),O=Fr({inputs:{x:R},backend:c,attrs:{shape:k}});I.push(R),I.push(O);var D=null!=h,M=null!=f,F="leakyrelu"===v,P=v?Ar(v,!0):null,L=new Nr(S?O.shape:A.shape,S?A.shape:O.shape,S?[s.batchSize,E,s.outChannels]:[s.batchSize,s.outChannels,E],!0,!1,D,P,M,F),B=S?[O,A]:[A,O];if(h&&B.push(h),M&&B.push(f),F){var z=c.makeTensorInfo([],"float32",r.util.createScalarValue(m,"float32"));B.push(z),I.push(z)}var U=c.runWebGLProgram(L,B,"float32"),G=Fr({inputs:{x:U},backend:c,attrs:{shape:s.outShape}});I.push(U);try{for(var W=u(I),V=W.next();!V.done;V=W.next()){var j=V.value;c.disposeIntermediateTensorInfo(j)}}catch(t){e={error:t}}finally{try{V&&!V.done&&(n=W.return)&&n.call(W)}finally{if(e)throw e.error}}return G}var Sa,Ta={kernelName:r.Conv2D,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.x,s=n.filter,u=a.strides,c=a.pad,l=a.dataFormat,h=a.dilations,p=a.dimRoundingMode,f=r.backend_util.convertConv2DDataFormat(l),d=r.backend_util.computeConv2DInfo(o.shape,s.shape,u,h,c,p,!1,f);if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===f&&r.env().getBool("WEBGL_EXP_CONV")){var m=new ya(d),g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];e=i.runWebGLProgram(m,[o,s],"float32",g)}else r.env().getBool("WEBGL_CONV_IM2COL")?e=_a({x:o,filter:s,convInfo:d,backend:i}):(m=new ga(d),e=i.runWebGLProgram(m,[o,s],"float32"));else e=wa({x:o,filter:s,convInfo:d,backend:i});var v=Fr({inputs:{x:e},backend:i,attrs:{shape:d.outShape}});return i.disposeIntermediateTensorInfo(e),v}},Ea=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              ").concat(a?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},ka=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=a?1:2,c=a?2:3,l=a?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(l,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(u,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(a,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ia=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,a=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Aa=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(e,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(e," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Na={kernelName:r.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.dy,s=i.strides,u=i.pad,c=i.dataFormat,l=i.dimRoundingMode,h=i.filterShape,p=r.backend_util.convertConv2DDataFormat(c),f=r.backend_util.computeConv2DInfo(a.shape,h,s,1,u,l,!1,p),d=new Ea(f);return n.runWebGLProgram(d,[a,o],"float32")}},Ca=function(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Pt(this.outputShape.length);var e=t.filterHeight,n=t.filterWidth,r=e-1-t.padInfo.top,i=n-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(t.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(t.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")},Ra={kernelName:r.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.filter,s=i.inputShape,u=i.strides,c=i.pad,l=i.dataFormat,h=i.dimRoundingMode,p=r.backend_util.convertConv2DDataFormat(l),f=r.backend_util.computeConv2DInfo(s,o.shape,u,1,c,h,!1,p);if(r.env().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===p){var d=[[f.strideHeight,f.strideWidth]],m=new Ca(f);return n.runWebGLProgram(m,[a,o],"float32",d)}return m=new ka(f),n.runWebGLProgram(m,[a,o],"float32")}},Oa={kernelName:r.Conv3D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=i.strides,u=i.pad,c=i.dilations,l=r.backend_util.computeConv3DInfo(a.shape,o.shape,s,c,u),h=new va(l);return n.runWebGLProgram(h,[a,o],"float32")}},Da={kernelName:r.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.dy,s=i.strides,u=i.pad,c=i.filterShape,l=r.backend_util.computeConv3DInfo(a.shape,c,s,1,u),h=new Ia(l);return n.runWebGLProgram(h,[a,o],"float32")}},Ma={kernelName:r.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.filter,s=i.pad,u=i.strides,c=i.inputShape,l=r.backend_util.computeConv3DInfo(c,o.shape,u,1,s),h=new Aa(l);return n.runWebGLProgram(h,[a,o],"float32")}},Fa=kr({opSnippet:Er+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(fr,"\n  return result;\n")}),Pa={kernelName:r.Cos,backendName:"webgl",kernelFunc:Fa},La=kr({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Ba={kernelName:r.Cosh,backendName:"webgl",kernelFunc:La},za=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=c(t,4),o=a[0],s=a[1],u=a[2],l=a[3],h=c(e,1)[0],p=c(n,2),f=p[0],d=p[1];this.outputShape=[h,f,d,l];var m="bilinear"===r?1:0,g=c(["".concat(s-1,".0"),"".concat(u-1,".0")],2),v=g[0],y=g[1],b=c(f>1?["".concat((s-1)/(f-1)),"(y2-y1) * height_ratio","y1*".concat(v," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(v)],3),x=b[0],w=b[1],_=b[2],S=c(d>1?["".concat((u-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(y," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(y)],3),T=S[0],E=S[1],k=S[2];this.userCode="\n      const float height_ratio = float(".concat(x,");\n      const float width_ratio = float(").concat(T,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(o,") {\n          return;\n        }\n\n        float height_scale = ").concat(w,";\n        float width_scale = ").concat(E,";\n\n        float in_y = ").concat(_,";\n        if( in_y < 0.0 || in_y > ").concat(v," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(k,";\n        if( in_x < 0.0 || in_x > ").concat(y," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},Ua={kernelName:r.CropAndResize,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.image,a=e.boxes,o=e.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new za(i.shape,a.shape,s,u,c);return n.runWebGLProgram(l,[i,a,o],"float32")}};!function(t){t.Prod="*",t.Sum="+"}(Sa||(Sa={}));var Ga=function(t,e,n,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];var i=this.outputShape.length,a=this.op===Sa.Prod?"1.0":"0.0",o=n?a:"getX(".concat(Wa(i,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1],u="",c="";n?(u=r?"end != ".concat(s-1):"end != 0",c=r?"end + 1":"end - 1"):(u=r?"end + pow2 < ".concat(s):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(Ct(i)," coords = getOutputCoords();\n        int end = ").concat(Va(i,"coords",this.op),";\n        float val = ").concat(o,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(u,") {\n          int idx = ").concat(c,";\n          ").concat(Va(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(Wa(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")};function Wa(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function Va(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function ja(t,e,n,i,a,o){var s=e.shape.length,u=r.backend_util.getAxesPermutation([i],s),c=e;null!=u&&(c=Hr({inputs:{x:e},backend:n,attrs:{perm:u}}));var l=r.backend_util.getInnerMostAxes(1,s)[0];if(l!==s-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(e.shape.length-1," ")+"but got axis=".concat(i));for(var h=c.shape[l],p=mr({inputs:{x:c},backend:n}),f=0;f<=Math.ceil(Math.log2(h))-1;f++){var d=new Ga(t,c.shape,!1,o),m=[[f]],g=p;p=n.runWebGLProgram(d,[p],p.dtype,m),n.disposeIntermediateTensorInfo(g)}if(a&&(d=new Ga(t,c.shape,a,o),g=p,p=n.runWebGLProgram(d,[p],p.dtype),n.disposeIntermediateTensorInfo(g)),null!=u){var v=Hr({inputs:{x:p},backend:n,attrs:{perm:r.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(c),v}return p}var Ha={kernelName:r.Cumprod,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=r.axis,o=r.exclusive,s=r.reverse;return ja(Sa.Prod,i,n,a,o,s)}},Xa={kernelName:r.Cumsum,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=r.axis,o=r.exclusive,s=r.reverse;return ja(Sa.Sum,i,n,a,o,s)}},qa={kernelName:r.DenseBincount,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=e.weights,o=r.size,s=r.binaryOutput;if(1===i.shape.length){var u=n.readSync(i.dataId),c=n.readSync(a.dataId),l=Ye(u,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,l)}if(2===i.shape.length){var h=n.bufferSync(i),p=n.bufferSync(a),f=Ze(h,p,o,s);return n.makeTensorInfo(f.shape,a.dtype,f.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(i.shape.length,"."))}},Ka=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(e,";\n      int offset_h = imod(h, ").concat(e,");\n      int in_w = w / ").concat(e,";\n      int offset_w = imod(w, ").concat(e,");\n      int offset_d = (offset_h * ").concat(e," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),Ya={kernelName:r.DepthToSpace,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=r.blockSize,o=r.dataFormat,s=i.shape[0],u=("NHWC"===o?i.shape[1]:i.shape[2])*a,c=("NHWC"===o?i.shape[2]:i.shape[3])*a,l=("NHWC"===o?i.shape[3]:i.shape[1])/(a*a),h=new Ka("NHWC"===o?[s,u,c,l]:[s,l,u,c],a,o);return n.runWebGLProgram(h,[i],i.dtype)}},Za=function(t,e,n,r,i){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Pt(this.outputShape.length);var a=t.filterHeight,o=t.filterWidth,s=t.outChannels/t.inChannels,u="",c="";n&&(u=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);");var l=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(u,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(a,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(l,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")},$a=function(t,e,n,i,a){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===i&&(i=!1),void 0===a&&(a=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Pt(this.outputShape.length);for(var o=t.outChannels/t.inChannels,s=t.padInfo.left,u=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,p=h,f="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",d=0;d<h;d++)f+="\n          vec4 xTexelC".concat(2*d,";\n          int xTexelC").concat(2*d,"Ready;\n          vec4 xTexelC").concat(2*d+1,";\n          int xTexelC").concat(2*d+1,"Ready;\n          vec4 xC").concat(d,";");for(f+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      "),d=0;d<h;d++)f+="\n          xTexelC".concat(2*d," = vec4(0.0);\n          xTexelC").concat(2*d,"Ready = 0;\n          xTexelC").concat(2*d+1," = vec4(0.0);\n          xTexelC").concat(2*d+1,"Ready = 0;\n          xC").concat(d," = vec4(0.0);");f+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(var m=0;m<(p+1)/2;m++){var g=2*m;if(f+="\n          xC = xCCorner + ".concat(g*c,";\n          "),1===u){if(g<h&&(s%2==1?(f+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n              "),f+=1===c&&g>0?"\n                xC".concat(g," = vec4(xTexelC").concat(g-2,".zw, xTexelC").concat(g,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(g," = vec4(previous.zw, xTexelC").concat(g,".xy);\n                  } else {\n                    xC").concat(g," = vec4(0.0, 0.0, xTexelC").concat(g,".xy);\n                  }\n                  ")):f+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xC").concat(g," = xTexelC").concat(g,";\n                "),g+1<h)){var v=s%2==0?r.util.nearestLargerEven(c):c;c%2==0&&s%2==1||c%2!=0&&s%2!=1?(f+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(v,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                    xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(g+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(g+1,"Ready = 1;\n                  }\n                  "),f+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(g+1," = vec4(previous.zw, xTexelC").concat(g+1,".xy);\n                    } else {\n                     xC").concat(g+1," = vec4(0.0, 0.0, xTexelC").concat(g+1,".xy);\n                    }\n                    "):"\n                    xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".xy);\n                    ")):f+=1===v?"\n                    xC".concat(g+1," = xTexelC").concat(g,";\n                    "):"\n                    xCOffset = xC + ".concat(v,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                      xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(g+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(g+1,"Ready = 1;\n                    }\n\n                    xC").concat(g+1," = xTexelC").concat(g+1,";\n                    ")}}else g<h&&(s%2==1?(f+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n              "),g+1<h&&(f+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(g+1," = vec4(xTexelC").concat(g+1,".xy, final.xy);\n                "))):(f+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(\n                  xTexelC").concat(g,".xy, xTexelC").concat(g+1,".xy);\n              "),g+1<h&&(f+="\n                  xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n                "))));g<h&&(f+="\n            wTexel = getW(r, ".concat(g,", d1, q);\n            dotProd += xC").concat(g," * vec4(wTexel.xz, wTexel.xz);\n          "),g+1<h&&(f+="\n              wTexel = getW(r, ".concat(g+1,", d1, q);\n              dotProd += xC").concat(g+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}f+="\n    }\n  ",f+="\n      }\n    ";var y="",b="";n&&(y=i?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),b="result = activation(result);");var x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(y,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(f,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(x,"\n        ").concat(b,"\n        setOutput(result);\n      }\n    ")},Ja={kernelName:r.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=i.strides,u=i.pad,c=i.dilations,l=i.dimRoundingMode,h=c;null==h&&(h=[1,1]),r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(s,h),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(h,"'")}));var p,f=r.backend_util.computeConv2DInfo(a.shape,o.shape,s,h,u,l,!0);p=r.env().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels==1?new $a(f):new Za(f);var d=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(p,[a,o],"float32",d)}},Qa=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(a," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},to=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},eo={kernelName:r.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.dy,s=i.strides,u=i.dilations,c=i.pad,l=i.dimRoundingMode,h=i.filterShape,p=r.backend_util.computeConv2DInfo(a.shape,h,s,u,c,l,!0),f=new Qa(p);return n.runWebGLProgram(f,[a,o],"float32")}},no={kernelName:r.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.filter,s=i.strides,u=i.dilations,c=i.pad,l=i.dimRoundingMode,h=i.inputShape,p=r.backend_util.computeConv2DInfo(h,o.shape,s,u,c,l,!0),f=new to(p);return n.runWebGLProgram(f,[a,o],"float32")}},ro=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},io={kernelName:r.Diag,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.x,a=l(l([],c(i.shape),!1),c(i.shape),!1),o=r.util.sizeFromShape(i.shape),s=Fr({inputs:{x:i},backend:n,attrs:{shape:[o]}}),u=new ro(o),h=n.runWebGLProgram(u,[s],s.dtype),p=Fr({inputs:{x:h},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(h),p}},ao=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.inHeight,n=t.inWidth,r=t.padInfo,i=t.strideHeight,a=t.strideWidth,o=t.filterHeight,s=t.filterWidth,u=t.dilationHeight,c=t.dilationWidth,l=r.top,h=r.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(a,");\n      const ivec2 pads = ivec2(").concat(l,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(o,"; h++) {\n          int hIn = hBeg + h * ").concat(u,";\n\n          if (hIn >= 0 && hIn < ").concat(e,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")},oo={kernelName:r.Dilation2D,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.x,s=n.filter,u=a.strides,c=a.pad,l=a.dilations,h=r.backend_util.computeDilation2DInfo(o.shape,s.shape,u,c,"NHWC",l),p=new ao(h),f=Fr({inputs:{x:e=i.runWebGLProgram(p,[o,s],"float32")},backend:i,attrs:{shape:h.outShape}});return i.disposeIntermediateTensorInfo(e),f}},so={kernelName:r.Einsum,backendName:"webgl",kernelFunc:function(t){var e,n,i,a,o=t.inputs,s=t.backend,c=t.attrs.equation,l=o,h=r.backend_util.decodeEinsumEquation(c,l.length),p=h.allDims,f=h.summedDims,d=h.idDims;r.backend_util.checkEinsumDimSizes(p.length,d,l);for(var m=r.backend_util.getEinsumComputePath(f,d),g=m.path,v=m.steps,y=v.length,b=null,x=p.length,w=[],_=0;_<y;++_){try{for(var S=(e=void 0,u(v[_])),T=S.next();!T.done;T=S.next()){var E=T.value,k=r.backend_util.getEinsumPermutation(x,d[E]),I=k.permutationIndices,A=k.expandDims,N=void 0;r.backend_util.isIdentityPermutation(I)?N=l[E]:(N=Hr({inputs:{x:l[E]},backend:s,attrs:{perm:I}}),w.push(N));for(var C=N.shape.slice(),R=0;R<A.length;++R)C.splice(A[R],0,1);r.util.arraysEqual(N.shape,C)||(N=Fr({inputs:{x:N},backend:s,attrs:{shape:C}}),w.push(N)),null===b?b=N:(b=Dr({inputs:{a:N,b},backend:s}),w.push(b))}}catch(t){e={error:t}}finally{try{T&&!T.done&&(n=S.return)&&n.call(S)}finally{if(e)throw e.error}}_<y-1&&(g[_]>=0&&(b=Vr({inputs:{x:b},backend:s,attrs:{axis:g[_]-(p.length-x),keepDims:!1}}),w.push(b)),x--)}try{for(var O=u(w),D=O.next();!D.done;D=O.next()){var M=D.value;M!==b&&s.disposeIntermediateTensorInfo(M)}}catch(t){i={error:t}}finally{try{D&&!D.done&&(a=O.return)&&a.call(O)}finally{if(i)throw i.error}}return b}},uo=kr({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),co={kernelName:r.Elu,backendName:"webgl",kernelFunc:uo},lo={kernelName:r.EluGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.dy,a=e.y,o=r.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new dr("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",i.shape,a.shape):new pr("return (b >= 0.0) ? a : a * (b + 1.0);",i.shape,a.shape);return n.runWebGLProgram(o,[i,a],i.dtype)}},ho=Ir({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:tn}),po={kernelName:r.Equal,backendName:"webgl",kernelFunc:ho},fo=kr({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(r.backend_util.ERF_P,";\n  float a1 = ").concat(r.backend_util.ERF_A1,";\n  float a2 = ").concat(r.backend_util.ERF_A2,";\n  float a3 = ").concat(r.backend_util.ERF_A3,";\n  float a4 = ").concat(r.backend_util.ERF_A4,";\n  float a5 = ").concat(r.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),mo={kernelName:r.Erf,backendName:"webgl",kernelFunc:fo},go=kr({opSnippet:Er+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:en,dtype:"float32"}),vo={kernelName:r.Exp,backendName:"webgl",kernelFunc:go};function yo(t){var e=t.inputs,n=t.attrs,i=t.backend,a=n.dim,o=e.input,s=o.shape.length,u=o.shape.slice(),c=a;return a<0&&(r.util.assert(-(s+1)<=a,(function(){return"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")})),c=s+a+1),u.splice(c,0,1),Fr({inputs:{x:o},backend:i,attrs:{shape:u}})}var bo={kernelName:r.ExpandDims,backendName:"webgl",kernelFunc:yo},xo="return exp(x) - 1.0;",wo=kr({opSnippet:xo,packedOpSnippet:xo,cpuKernelImpl:nn}),_o={kernelName:r.Expm1,backendName:"webgl",kernelFunc:wo},So=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i,a=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),o=n?"".concat(r,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(a,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(o,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")};function To(t,e,n){var i=n.texData.get(t.dataId),a=r.util.sizeFromShape(t.shape),o=t.shape[t.shape.length-1],s=Fr({inputs:{x:t},backend:n,attrs:{shape:[a/o,o]}}),u=s.shape,c=new So("real",u,e),l=new So("imag",u,e),h=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:u},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:u}],p=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(l,h,"float32"),d=vr({inputs:{real:p,imag:f},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f);var m=Fr({inputs:{x:d},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(d),m}var Eo={kernelName:r.FFT,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend;return To(e.input,!1,n)}},ko=function(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "};function Io(t){var e=t.backend,n=t.attrs,i=n.shape,a=n.value,o=n.dtype;if("string"===(o=o||r.util.inferDtype(a))){var s=r.util.getArrayFromDType(o,r.util.sizeFromShape(i));return s.fill(a),e.makeTensorInfo(i,o,s)}var u=new ko(i,a),c=[[a]];return e.runWebGLProgram(u,[],o,c)}var Ao,No={kernelName:r.Fill,backendName:"webgl",kernelFunc:Io},Co=function(t){this.variableNames=["Image"],this.outputShape=[];var e=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(e," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(e,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},Ro={kernelName:r.FlipLeftRight,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.image,i=n,a=new Co(r.shape);return i.runWebGLProgram(a,[r],r.dtype)}},Oo="return floor(x);",Do=kr({opSnippet:Oo,packedOpSnippet:Oo,cpuKernelImpl:rn}),Mo={kernelName:r.Floor,backendName:"webgl",kernelFunc:Do},Fo=Ir({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Po={kernelName:r.FloorDiv,backendName:"webgl",kernelFunc:Fo},Lo=function(t){this.variableNames=["A"];var e=mt(),n=c(t,2),r=n[0],i=n[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(r,".0);\n\n        vec4 values = ").concat(e.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},Bo=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=mt(),n=c(t,2),r=n[0],i=n[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(r,".0);\n            vec4 values = ").concat(e.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")},zo={kernelName:r.FromPixels,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.pixels,o=i.numChannels,s="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,u="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,l=c(s?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),h=l[0],f=l[1],d=[f,h],m=[f,h,o];if(u||s){var g=r.env().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=Ao&&g===Uo||(Uo=g,Ao=document.createElement("canvas").getContext("2d",{willReadFrequently:Uo})),Ao.canvas.width=h,Ao.canvas.height=f,Ao.drawImage(a,0,0,h,f),a=Ao.canvas}var v=n.makeTensorInfo(d,"int32");n.texData.get(v.dataId).usage=p.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(v.dataId),a);var y=r.env().getBool("WEBGL_PACK")?new Bo(m):new Lo(m),b=n.runWebGLProgram(y,[v],"int32");return n.disposeData(v.dataId),b}},Uo=r.env().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU"),Go={kernelName:r.FusedConv2D,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.x,s=n.filter,u=n.bias,c=n.preluActivationWeights,l=a.strides,h=a.pad,p=a.dataFormat,f=a.dilations,d=a.dimRoundingMode,m=a.activation,g=a.leakyreluAlpha,v=r.backend_util.convertConv2DDataFormat(p),y=r.backend_util.computeConv2DInfo(o.shape,s.shape,l,f,h,d,!1,v),b=[],x=null!=u,w=null!=c,_="leakyrelu"===m,S=function(){var t=[o,s],e=function(t,e){if("NCHW"===e&&1===t.shape.length&&1!==t.shape[0]){var n=Fr({inputs:{x:t},backend:i,attrs:{shape:[t.shape[0],1,1]}});return b.push(n),n}return t};if(x&&t.push(e(u,p)),w&&t.push(e(c,p)),_){var n=i.makeTensorInfo([],"float32",r.util.createScalarValue(g,"float32"));t.push(n),b.push(n)}return t};if(1!==y.filterHeight||1!==y.filterWidth||1!==y.dilationHeight||1!==y.dilationWidth||1!==y.strideHeight||1!==y.strideWidth||"SAME"!==y.padInfo.type&&"VALID"!==y.padInfo.type)if(y.strideWidth<=2&&"channelsLast"===v&&r.env().getBool("WEBGL_EXP_CONV")){var T=m?Ar(m,!0):null,E=new ya(y,x,T,w,_),k=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],I=S();e=i.runWebGLProgram(E,I,"float32",k)}else if(r.env().getBool("WEBGL_CONV_IM2COL"))e=_a({x:o,filter:s,convInfo:y,backend:i,bias:u,activation:m,preluActivationWeights:c,leakyreluAlpha:g});else{T=m?Ar(m,!1):null,E=new ga(y,x,T,w,_);var A=S();e=i.runWebGLProgram(E,A,"float32")}else e=wa({x:o,filter:s,convInfo:y,backend:i,bias:u,activation:m,preluActivationWeights:c,leakyreluAlpha:g});var N=Fr({inputs:{x:e},backend:i,attrs:{shape:y.outShape}});return b.push(e),b.forEach((function(t){return i.disposeIntermediateTensorInfo(t)})),N}},Wo={kernelName:r.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.filter,s=e.bias,u=e.preluActivationWeights,c=i.strides,l=i.pad,h=i.dilations,p=i.dimRoundingMode,f=i.activation,d=i.leakyreluAlpha,m=[],g=h;null==g&&(g=[1,1]),r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(c,g),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(g,"'")}));var v,y=r.backend_util.computeConv2DInfo(a.shape,o.shape,c,g,l,p,!0),b=r.env().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels==1,x=f?Ar(f,b):null,w=[a,o],_=null!=s,S=null!=u,T="leakyrelu"===f;if(_&&w.push(s),S&&w.push(u),T){var E=n.makeTensorInfo([],"float32",r.util.createScalarValue(d,"float32"));w.push(E),m.push(E)}v=b?new $a(y,_,x,S,T):new Za(y,_,x,S,T);var k=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],I=n.runWebGLProgram(v,w,"float32",k);return m.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),I}},Vo=function(t,e,n,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;for(var i=Ct(n.length),a="\n    int index;",o=0;o<this.sliceDim;o++)a+="\n          index = round(getIndices(coords[0], ".concat(o,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[o],";\n          flattenIndex += index * ").concat(this.strides[o],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(a,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")},jo={kernelName:r.GatherNd,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.params,a=e.indices,o=a.shape,s=o[o.length-1],u=r.util.sizeFromShape(i.shape),l=c(r.backend_util.prepareAndValidate(i,a),4),h=l[0],p=l[1],f=l[2],d=l[3],m=Fr({inputs:{x:a},backend:n,attrs:{shape:[p,s]}}),g=Fr({inputs:{x:i},backend:n,attrs:{shape:[r.util.sizeFromShape(i.shape)/f,f]}});if(n.shouldExecuteOnCPU([i,a])||"string"===i.dtype){var v=n.readSync(a.dataId),y=n.bufferSync(i),b=an(v,y,i.dtype,p,s,f,d,i.shape,u);return n.makeTensorInfo(h,i.dtype,b.values)}var x=new Vo(s,d,[p,f],i.shape),w=n.runWebGLProgram(x,[g,m],g.dtype),_=Fr({inputs:{x:w},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),_}},Ho=function(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;var n=Ct(this.rank),r=function(t){for(var e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[],r=0;r<t.length;r++)2===r?n.push("index"):n.push("".concat(e[r]));return n.join()}(t);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")};function Xo(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.indices,s=i.axis,u=i.batchDims,c=r.util.parseAxisParam(s,a.shape)[0];if(r.env().get("DEBUG"))for(var l=n.readSync(o.dataId),h=a.shape[c],p=function(t){var e=l[t];r.util.assert(e<=h-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(h-1,"]")}))},f=0;f<l.length;++f)p(f);var d=r.backend_util.segment_util.collectGatherOpShapeInfo(a,o,c,u),m=r.util.sizeFromShape(o.shape),g=[],v=Fr({inputs:{x:a},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),y=Fr({inputs:{x:o},backend:n,attrs:{shape:[d.batchSize,m/d.batchSize]}});g.push(v),g.push(y);var b=[d.batchSize,d.outerSize,m/d.batchSize,d.sliceSize];if(n.shouldExecuteOnCPU([a,o])||"string"===a.dtype){var x=n.bufferSync(y),w=function(t,e,n){for(var i=r.buffer(n,t.dtype),a=0;a<i.size;++a){var o=i.indexToLoc(a).slice(),s=o[0],u=o[2],c=e.locToIndex([s,u]);o[2]=e.values[c];var l=t.locToIndex(o);0<=l&&l<t.values.length&&(i.values[a]=t.values[l])}return i}(n.bufferSync(v),x,b);return g.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.makeTensorInfo(d.outputShape,w.dtype,w.values)}var _=new Ho(v.shape,b),S=n.runWebGLProgram(_,[v,y],v.dtype);g.push(S);var T=Fr({inputs:{x:S},backend:n,attrs:{shape:d.outputShape}});return g.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),T}var qo={kernelName:r.GatherV2,backendName:"webgl",kernelFunc:Xo},Ko=Ir({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:on,dtype:"bool"}),Yo={kernelName:r.Greater,backendName:"webgl",kernelFunc:Ko},Zo=Ir({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:sn}),$o={kernelName:r.GreaterEqual,backendName:"webgl",kernelFunc:Zo},Jo={kernelName:r.IFFT,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend;return To(e.input,!0,n)}},Qo=kr({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),ts={kernelName:r.IsFinite,backendName:"webgl",kernelFunc:Qo},es=kr({opSnippet:"return float(isinf(x));",dtype:"bool"}),ns={kernelName:r.IsInf,backendName:"webgl",kernelFunc:es},rs=kr({opSnippet:"return float(isnan(x));",dtype:"bool"}),is={kernelName:r.IsNan,backendName:"webgl",kernelFunc:rs},as=Ir({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:un,dtype:"bool"}),os={kernelName:r.Less,backendName:"webgl",kernelFunc:as},ss=Ir({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:cn,dtype:"bool"}),us={kernelName:r.LessEqual,backendName:"webgl",kernelFunc:ss},cs={kernelName:r.LinSpace,backendName:"webgl",kernelFunc:function(t){var e=t.backend,n=t.attrs,r=n.start,i=n.stop,a=n.num,o=ln(r,i,a);return e.makeTensorInfo([o.length],"float32",o)}},ls=kr({opSnippet:Er+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:hn}),hs={kernelName:r.Log,backendName:"webgl",kernelFunc:ls},ps=kr({opSnippet:Er+"\n  return log(1.0 + x);\n"}),fs={kernelName:r.Log1p,backendName:"webgl",kernelFunc:ps},ds=Ir({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),ms={kernelName:r.LogicalAnd,backendName:"webgl",kernelFunc:ds},gs=kr({opSnippet:"return float(!(x >= 1.0));"}),vs={kernelName:r.LogicalNot,backendName:"webgl",kernelFunc:gs},ys=Ir({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),bs={kernelName:r.LogicalOr,backendName:"webgl",kernelFunc:ys},xs=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=e,s=t[3]-1;this.outputShape=t;var u="float(".concat(n,") + float(").concat(r,") * sum");a=.5===i?"inversesqrt(".concat(u,")"):1===i?"1.0/(".concat(u,")"):"exp(log(".concat(u,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(o,"; j <= ").concat(o,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(s,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(a,";\n        setOutput(val);\n      }\n    ")},ws=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,o=e,s=t[3]-1;this.outputShape=t;var u="float(".concat(n,") + float(").concat(r,") * sum");a=.5===i?"inversesqrt(".concat(u,")"):1===i?"1.0/(".concat(u,")"):"exp(log(".concat(u,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(o,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(o,"; j <= ").concat(o,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(s,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(a,";\n        setOutput(result);\n      }\n    ")},_s={kernelName:r.LRN,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.depthRadius,s=i.bias,u=i.alpha,c=i.beta,l=r.env().getBool("WEBGL_PACK_NORMALIZATION")?new ws(a.shape,o,s,u,c):new xs(a.shape,o,s,u,c);return n.runWebGLProgram(l,[a],a.dtype)}},Ss=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(e,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(e," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},Ts={kernelName:r.LRNGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=e.y,o=e.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,h=new Ss(i.shape,s,u,c,l);return n.runWebGLProgram(h,[i,a,o],i.dtype)}};function Es(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.reductionIndices,s=i.keepDims,u=a.shape.length,l=r.util.parseAxisParam(o,a.shape),h=l,p=r.backend_util.getAxesPermutation(h,u),f=null!=p,d=n.shouldExecuteOnCPU([a]),m=a;if(f){if(d){for(var g=n.texData.get(m.dataId).values,v=new Array(u),y=0;y<v.length;y++)v[y]=a.shape[p[y]];var b=Dn(g,a.shape,a.dtype,p,v);m=n.makeTensorInfo(v,a.dtype),n.texData.get(m.dataId).values=b}else m=Wr(a,p,n);h=r.backend_util.getInnerMostAxes(h.length,u)}r.backend_util.assertAxesAreInnerMostDims("max",h,u);var x,w=c(r.backend_util.computeOutAndReduceShapes(m.shape,h),2),_=w[0],S=w[1],T=_;if(s&&(T=r.backend_util.expandShapeToKeepDim(_,l)),d){g=n.texData.get(m.dataId).values;var E=pn(g,r.util.sizeFromShape(S),T,a.dtype);x=n.makeTensorInfo(T,a.dtype),n.texData.get(x.dataId).values=E}else x=function(t,e,n,i){var a=r.util.sizeFromShape(e),o=Fr({inputs:{x:t},attrs:{shape:[r.util.sizeFromShape(t.shape)/a,a]},backend:i}),s=zr(o,t.dtype,"max",i),u=Fr({inputs:{x:s},attrs:{shape:n},backend:i});return i.disposeIntermediateTensorInfo(o),i.disposeIntermediateTensorInfo(s),u}(m,S,T,n);return f&&n.disposeIntermediateTensorInfo(m),x}var ks={kernelName:r.Max,backendName:"webgl",kernelFunc:Es},Is=Ir({opSnippet:hr+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+fr+"\n  return result;\n",cpuKernelImpl:fn}),As={kernelName:r.Maximum,backendName:"webgl",kernelFunc:Is},Ns={kernelName:r.MaxPool,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x;pt(a,"maxPool");var o=i.filterSize,s=i.strides,u=i.pad,c=i.dimRoundingMode;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l=r.backend_util.computePool2DInfo(a.shape,o,s,1,u,c);if(1===l.filterWidth&&1===l.filterHeight&&r.util.arraysEqual(l.inShape,l.outShape))return mr({inputs:{x:a},backend:n});var h=new Ii(l,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},Cs={kernelName:r.MaxPool3D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.filterSize,s=i.strides,u=i.pad,c=i.dataFormat,l=i.dimRoundingMode,h=r.backend_util.computePool3DInfo(a.shape,o,s,[1,1,1],u,l,c),p=new Ai(h,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}},Rs=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,a=t.effectiveFilterWidth,o=i-1-t.padInfo.top,s=a-1-t.padInfo.left,u=i*a-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(a,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(u," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(a," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Os=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,h=u-1-t.padInfo.top,p=c-1-t.padInfo.left,f=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(l,", ").concat(h,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(a,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(f," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(u," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ds={kernelName:r.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=i.filterSize,u=i.strides,c=i.pad,l=i.dimRoundingMode,h=r.backend_util.computePool3DInfo(o.shape,s,u,[1,1,1],c,l),p=new Ai(h,"max",!0),f=n.runWebGLProgram(p,[o],o.dtype),d=new Os(h),m=n.runWebGLProgram(d,[a,f],o.dtype);return n.disposeIntermediateTensorInfo(f),m}},Ms={kernelName:r.MaxPoolGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.dy,o=e.input,s=o;pt([o,e.output],"maxPoolGrad");var u=i.filterSize,c=i.strides,l=i.pad,h=i.dimRoundingMode,p=r.backend_util.computePool2DInfo(s.shape,u,c,1,l,h),f=new Ii(p,"max",!0),d=n.runWebGLProgram(f,[s],s.dtype),m=new Rs(p),g=n.runWebGLProgram(m,[a,d],s.dtype);return n.disposeIntermediateTensorInfo(d),g}},Fs={kernelName:r.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.x,o=n.filterSize,s=n.strides,u=n.pad,l=n.includeBatchInIndex,h=i;r.util.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var p=[1,1];r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(s,p),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(p,"'")}));var f=r.backend_util.computePool2DInfo(a.shape,o,s,p,u),d=c(function(t,e,n,r){var i=new Ii(n,"max",!1),a=r.runWebGLProgram(i,[t],"float32");return i=new Ii(n,"max",!0,!0,e),[a,r.runWebGLProgram(i,[t],"float32")]}(a,l,f,h),2);return[d[0],d[1]]}},Ps={kernelName:r.Mean,backendName:"webgl",kernelFunc:function(t){var e,n,i=t.inputs,a=t.attrs,o=t.backend,s=i.x,l=a.keepDims,h=a.axis,p=o,f=s.shape.length,d=r.util.parseAxisParam(h,s.shape),m=d,g=r.backend_util.getAxesPermutation(m,f),v=null!=g,y=p.shouldExecuteOnCPU([s]),b=[],x=s;if(v){if(y){for(var w=p.texData.get(x.dataId).values,_=new Array(f),S=0;S<_.length;S++)_[S]=s.shape[g[S]];var T=Dn(w,s.shape,s.dtype,g,_);x=p.makeTensorInfo(_,s.dtype),p.texData.get(x.dataId).values=T}else x=Wr(s,g,p);b.push(x),m=r.backend_util.getInnerMostAxes(m.length,f)}r.backend_util.assertAxesAreInnerMostDims("sum",m,f);var E=c(r.backend_util.computeOutAndReduceShapes(x.shape,m),2),k=E[0],I=E[1],A=k;l&&(A=r.backend_util.expandShapeToKeepDim(k,d));var N=function(t,e,n,i){var a=r.util.sizeFromShape(e),o=Fr({inputs:{x:t},attrs:{shape:[r.util.sizeFromShape(t.shape)/a,a]},backend:i}),s=zr(o,"float32","mean",i),u=Fr({inputs:{x:s},attrs:{shape:n},backend:i});return i.disposeIntermediateTensorInfo(o),i.disposeIntermediateTensorInfo(s),u}(x,I,A,p);try{for(var C=u(b),R=C.next();!R.done;R=C.next())S=R.value,p.disposeIntermediateTensorInfo(S)}catch(t){e={error:t}}finally{try{R&&!R.done&&(n=C.return)&&n.call(C)}finally{if(e)throw e.error}}return N}},Ls={kernelName:r.Min,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.axis,s=i.keepDims,u=a.shape.length,l=r.util.parseAxisParam(o,a.shape),h=l,p=r.backend_util.getAxesPermutation(h,u),f=a;null!=p&&(f=Hr({inputs:{x:a},backend:n,attrs:{perm:p}}),h=r.backend_util.getInnerMostAxes(h.length,a.shape.length)),r.backend_util.assertAxesAreInnerMostDims("min",h,u);var d,m=c(r.backend_util.computeOutAndReduceShapes(f.shape,h),2),g=m[0],v=m[1],y=Fr({inputs:{x:f},backend:n,attrs:{shape:[-1,r.util.sizeFromShape(v)]}}),b=zr(y,y.dtype,"min",n);return d=Fr(s?{inputs:{x:b},backend:n,attrs:{shape:r.backend_util.expandShapeToKeepDim(g,l)}}:{inputs:{x:b},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),null!=p&&n.disposeIntermediateTensorInfo(f),d}},Bs=Ir({opSnippet:hr+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+fr+"\n  return result;\n",cpuKernelImpl:dn}),zs={kernelName:r.Minimum,backendName:"webgl",kernelFunc:Bs},Us=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=Ct(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(i," start = ").concat(i,"(").concat(a,");\n      ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(u,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(u,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(a,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(u,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(u,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")},Gs=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=Ct(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=Pn("rc",r),u=Pn("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),l=1===r?"source":"vec2(".concat(u.slice(-2).join(),")"),h="reflect"===n?0:1,p="";if(1===r){var f="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");p="\n        ".concat(i," rc = outputLoc;\n        ").concat(f,"\n        result[0] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(f,"\n          result[1] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        }\n      ")}else f="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      "),p="\n        ".concat(i," rc = outputLoc;\n        ").concat(f,"\n        result[0] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(f,"\n          result[1] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(f,"\n          result[2] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(c,") {\n            ").concat(f,"\n            result[3] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n          }\n        }\n      ");this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(a,");\n      const ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")},Ws={kernelName:r.MirrorPad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.paddings,s=i.mode,u=r.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Gs(a.shape,o,s):new Us(a.shape,o,s);return n.runWebGLProgram(u,[a],a.dtype)}},Vs=Ir({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+fr+"\n  return result;\n"}),js={kernelName:r.Mod,backendName:"webgl",kernelFunc:Vs},Hs=function(t,e,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(e-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(e-1,"));\n      }\n    ")},Xs=Ir({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),qs={kernelName:r.RealDiv,backendName:"webgl",kernelFunc:Xs},Ks="return a - b;",Ys=Ir({opSnippet:Ks,packedOpSnippet:Ks,supportsComplex:!0,cpuKernelImpl:On}),Zs={kernelName:r.Sub,backendName:"webgl",kernelFunc:Ys};function $s(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.logits,o=i.dim,s=r.util.parseAxisParam([o],a.shape),u=Es({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),c=r.backend_util.expandShapeToKeepDim(u.shape,s),l=Fr({inputs:{x:u},backend:n,attrs:{shape:c}}),h=Ys({inputs:{a,b:l},backend:n}),p=go({inputs:{x:h},backend:n}),f=Vr({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:!1}}),d=Fr({inputs:{x:f},backend:n,attrs:{shape:c}}),m=Xs({inputs:{a:p,b:d},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),m}var Js={kernelName:r.Softmax,backendName:"webgl",kernelFunc:$s},Qs={kernelName:r.Multinomial,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.logits,a=r.numSamples,o=r.seed,s=r.normalized,u=s?i:$s({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),c=u.shape[0],l=u.shape[1],h=new Hs(c,l,a),p=[[o]],f=n.runWebGLProgram(h,[u],"int32",p);return s||n.disposeIntermediateTensorInfo(u),f}},tu=jn+"\n  return -x;\n",eu={kernelName:r.Neg,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=n.x;if(i.shouldExecuteOnCPU([a])){var o=c(function(t,e,n){var i=r.util.createScalarValue(-1,n);return Ce([],e,i,t,n)}(i.texData.get(a.dataId).values,a.shape,a.dtype),2),s=o[0],u=o[1];return i.makeTensorInfo(u,a.dtype,s)}return e=r.env().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new rr(a.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new Vn(a.shape,tu),i.runWebGLProgram(e,[a],a.dtype)}},nu=r.kernel_impls.nonMaxSuppressionV3Impl,ru={kernelName:r.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(t){r.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var e=t.inputs,n=t.backend,i=t.attrs,a=e.boxes,o=e.scores,s=i.maxOutputSize,u=i.iouThreshold,c=i.scoreThreshold,l=n.readSync(a.dataId),h=n.readSync(o.dataId),p=nu(l,h,s,u,c).selectedIndices;return n.makeTensorInfo([p.length],"int32",new Int32Array(p))}},iu=r.kernel_impls.nonMaxSuppressionV4Impl,au={kernelName:r.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(t){r.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var e=t.inputs,n=t.backend,i=t.attrs,a=e.boxes,o=e.scores,s=i.maxOutputSize,u=i.iouThreshold,c=i.scoreThreshold,l=i.padToMaxOutputSize,h=n.readSync(a.dataId),p=n.readSync(o.dataId),f=iu(h,p,s,u,c,l),d=f.selectedIndices,m=f.validOutputs;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([m]))]}},ou=r.kernel_impls.nonMaxSuppressionV5Impl,su={kernelName:r.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(t){r.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var e=t.inputs,n=t.backend,i=t.attrs,a=e.boxes,o=e.scores,s=i.maxOutputSize,u=i.iouThreshold,c=i.scoreThreshold,l=i.softNmsSigma,h=n.readSync(a.dataId),p=n.readSync(o.dataId),f=ou(h,p,s,u,c,l),d=f.selectedIndices,m=f.selectedScores;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}},uu=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")},cu={kernelName:r.OneHot,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.indices,o=i.dtype,s=i.depth,u=i.onValue,h=i.offValue,p=r.util.sizeFromShape(a.shape),f=new uu(p,s,u,h),d=Fr({inputs:{x:a},backend:n,attrs:{shape:[p]}}),m=n.runWebGLProgram(f,[d],o);n.disposeIntermediateTensorInfo(d);var g=Fr({inputs:{x:m},backend:n,attrs:{shape:l(l([],c(a.shape),!1),[s],!1)}});return n.disposeIntermediateTensorInfo(m),g}};function lu(t){var e=t.inputs,n=t.backend,r=e.x;if("complex64"===r.dtype){var i=Zi({inputs:{input:r},backend:n}),a=lu({inputs:{x:i},backend:n}),o=ha({inputs:{input:r},backend:n}),s=lu({inputs:{x:o},backend:n}),u=vr({inputs:{real:a,imag:s},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return Io({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var hu={kernelName:r.ZerosLike,backendName:"webgl",kernelFunc:lu},pu={kernelName:r.OnesLike,backendName:"webgl",kernelFunc:function t(e){var n=e.inputs,r=e.backend,i=n.x;if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===i.dtype){var a=Zi({inputs:{input:i},backend:r}),o=t({inputs:{x:a},backend:r}),s=ha({inputs:{input:i},backend:r}),u=lu({inputs:{x:s},backend:r}),c=vr({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return Io({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:r})}},fu={kernelName:r.Pack,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs.axis;if(1===e.length)return yo({inputs:{input:e[0]},backend:n,attrs:{dim:i}});var a=e[0].shape,o=e[0].dtype;e.forEach((function(t){r.util.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),r.util.assert(o===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=[],u=da({inputs:e.map((function(t){var e=yo({inputs:{input:t},backend:n,attrs:{dim:i}});return s.push(e),e})),backend:n,attrs:{axis:i}});return s.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),u}},du=function(t,e,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=Ct(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(i," start = ").concat(i,"(").concat(a,");\n      ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(a,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")},mu=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=Ct(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=Pn("rc",r),u=Pn("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),l=1===r?"source":"vec2(".concat(u.slice(-2).join(),")"),h=["".concat(i," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(c,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(c,") {")],p=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",d=0,m=1===r?2:4;d<m;d++)f+="\n        ".concat(h[d],"\n        if (").concat(p,") {\n          result[").concat(d,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(d,"] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        }\n      ");f+=1===r?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(a,");\n      const ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")},gu=function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.paddings,s=i.constantValue;if(0===r.util.sizeFromShape(a.shape))return Io({backend:n,attrs:{shape:o.map((function(t,e){return t[0]+a.shape[e]+t[1]})),value:s,dtype:a.dtype}});var u=r.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mu(a.shape,o,s):new du(a.shape,o,s),c=[[s]];return n.runWebGLProgram(u,[a],a.dtype,c)},vu={kernelName:r.PadV2,backendName:"webgl",kernelFunc:gu},yu=Ir({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+fr+"\n  return result;\n"}),bu={kernelName:r.Pow,backendName:"webgl",kernelFunc:yu},xu={kernelName:r.Prod,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.x,s=a.axis,u=a.keepDims,l=o.shape.length,h=[],p=r.util.parseAxisParam(s,o.shape),f=p,d=r.backend_util.getAxesPermutation(f,l),m=o;if(null!=d&&(m=Hr({inputs:{x:o},backend:i,attrs:{perm:d}}),f=r.backend_util.getInnerMostAxes(f.length,l),h.push(m)),r.backend_util.assertAxesAreInnerMostDims("prod",f,l),i.shouldExecuteOnCPU([m])){var g=i.texData.get(m.dataId).values,v=function(t,e,n,i){for(var a=c(r.backend_util.computeOutAndReduceShapes(t,i),2),o=a[0],s=a[1],u=r.upcastType(e,"int32"),l=r.util.makeZerosTypedArray(r.util.sizeFromShape(o),u),h=r.util.sizeFromShape(s),p=0;p<l.length;++p){for(var f=p*h,d=1,m=0;m<h;++m)d*=n[f+m];l[p]=d}return{outVals:l,outShape:o,outDtype:u}}(m.shape,m.dtype,g,f),y=v.outVals,b=v.outShape,x=v.outDtype;e=i.makeTensorInfo(b,x,y)}else{var w=c(r.backend_util.computeOutAndReduceShapes(m.shape,f),2),_=(b=w[0],w[1]),S=r.util.sizeFromShape(_),T=Fr({inputs:{x:m},backend:i,attrs:{shape:[-1,S]}}),E=zr(T,r.sumOutType(o.dtype),"prod",i);e=Fr({inputs:{x:E},backend:i,attrs:{shape:b}}),h.push(T),h.push(E)}if(u){h.push(e);var k=r.backend_util.expandShapeToKeepDim(e.shape,p);e=Fr({inputs:{x:e},backend:i,attrs:{shape:k}})}return h.forEach((function(t){return i.disposeIntermediateTensorInfo(t)})),e}},wu={kernelName:r.RaggedGather,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.paramsNestedSplits,a=e.paramsDenseValues,o=e.indices;r.outputRaggedRank;var s=i.map((function(t){return n.readSync(t.dataId)})),u=i.map((function(t){return t.shape})),l=n.readSync(a.dataId),h=n.readSync(o.dataId),p=c(vn(s,u,l,a.shape,a.dtype,h,o.shape),3),f=p[0],d=p[1],m=p[2],g=f.map((function(t){return n.makeTensorInfo([t.length],"int32",t)})),v=n.makeTensorInfo(m,a.dtype,d);return g.concat([v])}},_u={kernelName:r.RaggedRange,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.starts,i=e.limits,a=e.deltas,o=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(a.dataId),l=c(yn(o,r.shape,r.dtype,s,i.shape,u,a.shape),2),h=l[0],p=l[1];return[n.makeTensorInfo([h.length],"int32",h),n.makeTensorInfo([p.length],r.dtype,p)]}},Su={kernelName:r.RaggedTensorToTensor,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.shape,a=e.values,o=e.defaultValue,s=e.rowPartitionTensors,u=r.rowPartitionTypes,l=n.readSync(i.dataId),h=n.readSync(a.dataId),p=n.readSync(o.dataId),f=s.map((function(t){return n.readSync(t.dataId)})),d=s.map((function(t){return t.shape})),m=c(function(t,e,n,r,i,a,o,s,u,c){return new Pe(t,e,n,r,i,a,o,s,u,c).compute()}(l,i.shape,h,a.shape,a.dtype,p,o.shape,f,d,u),2),g=m[0],v=m[1];return n.makeTensorInfo(g,a.dtype,v)}},Tu=function(t){var e=t.backend,n=t.attrs,r=n.start,i=n.stop,a=n.step,o=n.dtype,s=bn(r,i,a,o);return e.makeTensorInfo([s.length],o,s)},Eu={kernelName:r.Range,backendName:"webgl",kernelFunc:Tu},ku=kr({opSnippet:"return 1.0 / x;"}),Iu={kernelName:r.Reciprocal,backendName:"webgl",kernelFunc:ku},Au=kr({opSnippet:jn+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Nu={kernelName:r.Relu,backendName:"webgl",kernelFunc:Au},Cu=kr({opSnippet:jn+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Ru={kernelName:r.Relu6,backendName:"webgl",kernelFunc:Cu},Ou=function(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];var a=c(t,4),o=a[0],s=a[1],u=a[2],l=a[3];this.outputShape=[o,e,n,l];var h,p=[r&&e>1?s-1:s,r&&n>1?u-1:u],f=[r&&e>1?e-1:e,r&&n>1?n-1:n];h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},Du=function(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=c(t,4),o=a[0],s=a[1],u=a[2],l=a[3];this.outputShape=[o,e,n,l];var h,p=[r&&e>1?s-1:s,r&&n>1?u-1:u],f=[r&&e>1?e-1:e,r&&n>1?n-1:n];h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],",\n          ").concat(p[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")},Mu={kernelName:r.ResizeBilinear,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.images,o=i.alignCorners,s=i.halfPixelCenters,u=c(i.size,2),l=u[0],h=u[1],p=r.env().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Du(a.shape,l,h,o,s):new Ou(a.shape,l,h,o,s);return n.runWebGLProgram(p,[a],"float32")}},Fu=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;var r=c(e,3),i=r[1],a=r[2],o=c(t,3),s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],h=[n&&s>1?s-1:s,n&&u>1?u-1:u],p=l[0]/h[0],f=l[1]/h[1],d=1/p,m=1/f,g=2*Math.ceil(d)+2,v=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(v,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(u,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(a-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},Pu={kernelName:r.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.images,a=e.dy,o=r.alignCorners,s=new Fu(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}},Lu=function(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];var a=c(t,4),o=a[0],s=a[1],u=a[2],l=a[3];this.outputShape=[o,e,n,l];var h,p=[r&&e>1?s-1:s,r&&n>1?u-1:u],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=r?"0.5":"0.0";h=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")},Bu=function(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=c(t,4),o=a[0],s=a[1],u=a[2],l=a[3];this.outputShape=[o,e,n,l];var h,p=[r&&e>1?s-1:s,r&&n>1?u-1:u],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=r?"0.5":"0.0";h=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],",\n          ").concat(p[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")},zu={kernelName:r.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.images,o=i.alignCorners,s=i.halfPixelCenters,u=c(i.size,2),l=u[0],h=u[1],p=r.env().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Bu(a.shape,l,h,o,s):new Lu(a.shape,l,h,o,s);return n.runWebGLProgram(p,[a],a.dtype)}},Uu=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;var r=c(e,3),i=r[1],a=r[2],o=c(t,3),s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],h=[n&&s>1?s-1:s,n&&u>1?u-1:u],p=l[0]/h[0],f=l[1]/h[1],d=1/p,m=1/f,g=2*Math.ceil(d)+2,v=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(v,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(u,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},Gu={kernelName:r.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.images,a=e.dy,o=r.alignCorners,s=new Uu(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}},Wu=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]")}(r)})).join(","),i=Ct(n);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")},Vu=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=t;var r=Pn("rc",n),i="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),a="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),o=Ct(n);function s(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(i,n)})),i=r.join(","),a=r.slice(-2).join(",");return"getChannel(getX(".concat(i,"), vec2(").concat(a,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(o," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return s(t)}(r.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice()),";\n          }\n          if(").concat(a,") {\n            result.b = ").concat(function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")},ju={kernelName:r.Reverse,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.dims,s=a.shape.length,u=r.util.parseAxisParam(o,a.shape);if(0===s)return mr({inputs:{x:a},backend:n});var c=r.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vu(a.shape,u):new Wu(a.shape,u);return n.runWebGLProgram(c,[a],a.dtype)}},Hu=function(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var n=t[1],r=t[2];this.outputShape=t;var i;i="number"==typeof e?"float outputValue = ".concat(e.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(e.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},Xu={kernelName:r.RotateWithOffset,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.image,o=n.radians,s=n.fillValue,u=n.center,l=i,h=new Hu(a.shape,s),p=c(r.backend_util.getImageCenter(u,a.shape[1],a.shape[2]),2),f=[[p[0],p[1],Math.sin(o),Math.cos(o)]];return l.runWebGLProgram(h,[a],a.dtype,f)}},qu=kr({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),Ku={kernelName:r.Round,backendName:"webgl",kernelFunc:qu},Yu=kr({opSnippet:"return inversesqrt(x);",cpuKernelImpl:xn}),Zu={kernelName:r.Rsqrt,backendName:"webgl",kernelFunc:Yu},$u=function(t,e,n,r,i,a,o,s){void 0===s&&(s=!1),this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var u=Ct(i.length),c=Ct(a.length),l="";1===n?l="i":2===n&&(l="i, j");var h="getIndices(".concat(l,")"),p="";1===r?p="i":2===r&&(p="i, coords[1]");var f="getUpdates(".concat(p,")"),d="";s&&(d="coords[0], coords[1]");var m="getDefaultValue(".concat(d,")"),g=e>1?"strides[j]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(e,"; j++) {\n              int index = round(").concat(h,");\n              flattenedIndex += index * ").concat(g,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(f,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(m,", sum, float(found)));\n        }\n      ")},Ju=function(t,e,n,r,i,a,o,s){void 0===s&&(s=!1),this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;var u=Ct(i.length),c=Ct(a.length),l="";1===n?l="i":2===n&&(l="i, j");var h="getIndices(".concat(l,")"),p="";1===r?p="i":2===r&&(p="i, coords[1]");var f="getUpdates(".concat(p,")"),d="";s&&(d="coords[0], coords[1]");var m="getDefaultValue(".concat(d,")"),g=e>1?"strides[j]":"strides",v=e>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(t,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(e,"; j+=2) {\n              ivec4 index = round(").concat(h,");\n              flattenedIndex += index.xz * ").concat(g,";\n              if (j + 1 < ").concat(e,") {\n                flattenedIndex += index.yw * ").concat(v,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(f,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(m,", sum, found));\n        }\n      ")},Qu={kernelName:r.ScatterNd,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.indices,o=e.updates,s=i.shape,u=r.backend_util.calculateShapes(o,a,s),c=u.sliceRank,l=u.numUpdates,h=u.sliceSize,p=u.strides,f=u.outputSize,d=[f/h,h];if(0===f)return n.makeTensorInfo(s,a.dtype);var m,g=Fr({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),v=Fr({inputs:{x:o},backend:n,attrs:{shape:[l,h]}}),y=n.makeTensorInfo([],"float32",new Float32Array([0]));m=r.env().getBool("WEBGL_PACK")?new Ju(l,c,g.shape.length,v.shape.length,p,d):new $u(l,c,g.shape.length,v.shape.length,p,d);var b=n.runWebGLProgram(m,[v,g,y],v.dtype),x=Fr({inputs:{x:b},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(y),x}},tc=function(t,e,n,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,n];var a="for (int i = 0; i < ".concat(Math.ceil(Math.log2(e+1)),"; ++i) { if (left >= right) break;"),o=2===r.env().getNumber("WEBGL_VERSION")?"while (left < right) {":a,s="left"===i?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")},ec={kernelName:r.SearchSorted,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.sortedSequence,a=e.values,o=r.side,s=new tc(i.shape[0],i.shape[1],a.shape[1],o),u=[[i.shape[1]]];return n.runWebGLProgram(s,[i,a],"int32",u)}},nc=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<e.length;u++)s.push("".concat(a[u])),u<t&&o.push("".concat(a[u]));r=o.join(),i=s.join()}var c=Ct(n);this.userCode="\n      void main() {\n        ".concat(c," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")},rc={kernelName:r.Select,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=e.condition,a=e.t,o=e.e,s=new nc(i.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[i,a,o],r.upcastType(a.dtype,o.dtype))}},ic=kr({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(r.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(r.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),ac={kernelName:r.Selu,backendName:"webgl",kernelFunc:ic},oc=kr({opSnippet:Er+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:wn}),sc={kernelName:r.Sigmoid,backendName:"webgl",kernelFunc:oc},uc=kr({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),cc={kernelName:r.Sign,backendName:"webgl",kernelFunc:uc},lc=kr({opSnippet:Er+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(fr,"\n  return result;\n")}),hc={kernelName:r.Sin,backendName:"webgl",kernelFunc:lc},pc=kr({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),fc={kernelName:r.Sinh,backendName:"webgl",kernelFunc:pc},dc=kr({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),mc={kernelName:r.Softplus,backendName:"webgl",kernelFunc:dc},gc={kernelName:r.SpaceToBatchND,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.blockShape,s=i.paddings;r.util.assert(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var u=o.reduce((function(t,e){return t*e})),h=[[0,0]];h.push.apply(h,l([],c(s),!1));for(var p=1+o.length;p<a.shape.length;++p)h.push([0,0]);var f=[],d=gu({inputs:{x:a},backend:n,attrs:{paddings:h,constantValue:0}}),m=r.backend_util.getReshaped(d.shape,o,u,!1),g=r.backend_util.getPermuted(m.length,o.length,!1),v=r.backend_util.getReshapedPermuted(d.shape,o,u,!1),y=Fr({inputs:{x:d},backend:n,attrs:{shape:m}}),b=Hr({inputs:{x:y},backend:n,attrs:{perm:g}}),x=Fr({inputs:{x:b},backend:n,attrs:{shape:v}});return f.push(d),f.push(y),f.push(b),f.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),x}},vc={kernelName:r.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.indices,i=e.values,a=e.denseShape,o=e.defaultValue;if(1!==a.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(a.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==i.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(i.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.readSync(r.dataId),u=n.readSync(i.dataId),l=n.readSync(a.dataId),h=n.readSync(o.dataId)[0],p=c(Tn(s,r.shape,r.dtype,u,i.dtype,l,h),5),f=p[0],d=p[1],m=p[2],g=p[3],v=p[4];return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,m),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map((function(t){return Number(t)})))),n.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}},yc={kernelName:r.SparseReshape,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.inputIndices,i=e.inputShape,a=e.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==i.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(i.shape));if(1!==a.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(a.shape));var o=Array.from(n.readSync(i.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(a.dataId)),l=c(En(s,r.shape,r.dtype,o,u),3),h=l[0],p=l[1],f=l[2];return[n.makeTensorInfo(p,r.dtype,h),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}},bc={kernelName:r.SparseSegmentMean,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.data,i=e.indices,a=e.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(a.shape));var o=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(a.dataId),l=c(kn(o,r.shape,r.dtype,s,u,!0),2),h=l[0],p=l[1];return n.makeTensorInfo(p,r.dtype,h)}},xc={kernelName:r.SparseSegmentSum,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.data,i=e.indices,a=e.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(a.shape));var o=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(a.dataId),l=c(kn(o,r.shape,r.dtype,s,u),2),h=l[0],p=l[1];return n.makeTensorInfo(p,r.dtype,h)}},wc={kernelName:r.SparseToDense,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.sparseIndices,o=e.sparseValues,s=e.defaultValue,u=i.outputShape,c=r.backend_util.calculateShapes(o,a,u),l=c.sliceRank,h=c.numUpdates,p=c.sliceSize,f=c.strides,d=c.outputSize;if("string"===o.dtype){var m=function(t,e,n,i,a,o,s,u,c,l){var h=[i/a,a],p=t.values,f=e.values;if(0===i)return r.buffer(n,e.dtype);var d=c instanceof r.TensorBuffer?c:r.buffer(h,e.dtype);"string"==typeof c||"number"==typeof c?d.values.fill(c):"boolean"==typeof c&&d.values.fill(+c);for(var m=0;m<o;m++){for(var g=[],v=0,y=0;y<s;y++){var b=p[m*s+y];g.push(b),v+=b*u[y]}if(v<0||v>=i/a)throw new Error("Invalid indices: ".concat(g," does not index into ").concat(n));for(var x=0;x<a;x++)l?d.values[v*a+x]+=f[m*a+x]:d.values[v*a+x]=0===e.rank?f[0]:f[m*a+x]}return d}(n.bufferSync(a),n.bufferSync(o),u,d,p,h,l,f,r.util.decodeString(n.readSync(s.dataId)[0]),!1);return n.makeTensorInfo(u,m.dtype,m.values)}var g=new $u(h,l,a.shape.length,o.shape.length,f,[d,1],!1),v=n.runWebGLProgram(g,[o,a,s],o.dtype),y=Fr({inputs:{x:v},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(v),y}},_c={kernelName:r.SplitV,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.numOrSizeSplits,s=i.axis,u=r.util.parseAxisParam(s,a.shape)[0],h=r.backend_util.prepareSplitSize(a,o,u),p=a.shape.length,f=new Array(p).fill(0),d=a.shape.slice();return h.map((function(t){var e=l([],c(d),!1);e[u]=t;var r=Wi({inputs:{x:a},backend:n,attrs:{begin:f,size:e}});return f[u]+=t,r}))}},Sc="return sqrt(x);",Tc=kr({opSnippet:Sc,packedOpSnippet:Sc,cpuKernelImpl:In}),Ec={kernelName:r.Sqrt,backendName:"webgl",kernelFunc:Tc},kc=kr({opSnippet:"return x * x;"}),Ic={kernelName:r.Square,backendName:"webgl",kernelFunc:kc},Ac="return (a - b) * (a - b);",Nc=Ir({opSnippet:Ac,packedOpSnippet:Ac}),Cc={kernelName:r.SquaredDifference,backendName:"webgl",kernelFunc:Nc},Rc={kernelName:r.StaticRegexReplace,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x;if("string"!==a.dtype)throw new Error("Input must be of datatype string");var o=n.readSync(a.dataId),s=r.backend_util.fromUint8ToStringArray(o),u=An(s,"string",i);return n.makeTensorInfo(a.shape,"string",u)}},Oc={kernelName:r.Step,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=e.x,a=jn+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new Vn(i.shape,a);return r.runWebGLProgram(o,[i],i.dtype)}},Dc=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Ct(n.length),a=Ct(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(t,e){return s++,1===n.length?"coords * strides[".concat(e,"] + begin[").concat(e,"]"):"coords[".concat(s-1,"] * strides[").concat(e,"] + begin[").concat(e,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(e,");\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")},Mc={kernelName:r.StridedSlice,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,i=t.backend,a=t.attrs,o=n.x,s=a.begin,u=a.end,c=a.strides,l=a.beginMask,h=a.endMask,p=a.ellipsisMask,f=a.newAxisMask,d=a.shrinkAxisMask,m=r.slice_util.sliceInfo(o.shape,s,u,c,l,h,p,f,d),g=m.finalShapeSparse,v=m.finalShape,y=m.isIdentity,b=m.sliceDim0,x=m.isSimpleSlice,w=m.begin,_=m.end,S=m.strides;if(y)e=Fr({inputs:{x:o},backend:i,attrs:{shape:v}});else if(b||x){r.util.assert(o.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(o.shape.length)}));var T=r.slice_util.computeOutShape(w,_,S),E=Wi({inputs:{x:o},backend:i,attrs:{begin:w,size:T}});e=Fr({inputs:{x:E},backend:i,attrs:{shape:v}}),i.disposeIntermediateTensorInfo(E)}else if(i.shouldExecuteOnCPU([o])){var k=i.readSync(o.dataId),I=r.buffer(o.shape,o.dtype,k),A=Nn(g,I,S,w);e=i.makeTensorInfo(v,o.dtype,A.values)}else{var N=new Dc(w,S,g);e=i.runWebGLProgram(N,[o],o.dtype)}var C=Fr({inputs:{x:e},backend:i,attrs:{shape:v}});return i.disposeIntermediateTensorInfo(e),C}},Fc={kernelName:r.StringNGrams,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=r.separator,a=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,l=r.preserveShortSequences,h=e.data,p=e.dataSplits,f=c(function(t,e,n,r,i,a,o,s){return new Ve(n,r,i,a,o,s).compute(t,e)}(n.readSync(h.dataId),n.readSync(p.dataId),i,a,o,s,u,l),2),d=f[0],m=f[1];return[n.makeTensorInfo([d.length],"string",d),n.makeTensorInfo(p.shape,"int32",m)]}},Pc={kernelName:r.StringSplit,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.skipEmpty,i=e.input,a=e.delimiter;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==a.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(a.shape));var o=n.readSync(i.dataId),s=n.readSync(a.dataId)[0],u=c(Cn(o,s,r),3),l=u[0],h=u[1],p=u[2],f=h.length;return[n.makeTensorInfo([f,2],"int32",l),n.makeTensorInfo([f],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(p))]}},Lc={kernelName:r.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.numBuckets,i=e.input;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var a=n.readSync(i.dataId),o=Rn(a,r);return n.makeTensorInfo(i.shape,"int32",o)}},Bc=kr({opSnippet:"return tan(x);"}),zc={kernelName:r.Tan,backendName:"webgl",kernelFunc:Bc},Uc=kr({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Gc={kernelName:r.Tanh,backendName:"webgl",kernelFunc:Uc},Wc={kernelName:r.TensorScatterUpdate,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend;t.attrs;var i=e.tensor,a=e.indices,o=e.updates,s=r.backend_util.calculateShapes(o,a,i.shape),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,p=s.outputSize,f=[p/l,l];if(0===p)return n.makeTensorInfo(i.shape,a.dtype);var d=Fr({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),m=Fr({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),g=Fr({inputs:{x:i},backend:n,attrs:{shape:f}}),v=new $u(c,u,d.shape.length,m.shape.length,h,f,!1,!0),y=n.runWebGLProgram(v,[m,d,g],g.dtype),b=Fr({inputs:{x:y},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}},Vc=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=Ct(this.rank),a=function(t){var e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod(".concat(n[i],", ").concat(t[i],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")};function jc(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.reps;if("string"===a.dtype||a.shape.length>5){var s=n.readSync(a.dataId),u="string"===a.dtype?s.map((function(t){return r.util.decodeString(t)})):s,c=function(t,e){for(var n=new Array(t.rank),i=0;i<n.length;i++)n[i]=t.shape[i]*e[i];var a=r.buffer(n,t.dtype);for(i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(t.rank),u=0;u<s.length;u++)s[u]=o[u]%t.shape[u];var c=t.locToIndex(s);a.values[i]=t.values[c]}return a}(r.buffer(a.shape,a.dtype,u),o);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new Vc(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}var Hc={kernelName:r.Tile,backendName:"webgl",kernelFunc:jc},Xc=function(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "},qc=function(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "};function Kc(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function Yc(t){for(var e=1;e<t;)e*=2;return e}var Zc,$c,Jc={kernelName:r.TopK,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=i.k,s=i.sorted,u=r.env().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=r.env().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),h=a.shape,p=h[h.length-1];if(n.shouldExecuteOnCPU([a])||p<u||o>l){var f=c(function(t,e,n,i,a){for(var o=e[e.length-1],s=c([t.length/o,o],2),u=s[0],l=s[1],h=r.util.getTypedArrayFromDType(n,u*i),p=r.util.getTypedArrayFromDType("int32",u*i),f=function(e){var n=e*l,r=t.subarray(n,n+l),o=new Array(r.length);r.forEach((function(t,e){return o[e]={value:t,index:e}})),i<o.length&&(qe(o,i),o=o.slice(0,i)),a&&o.sort(Xe);for(var s=e*i,u=h.subarray(s,s+i),c=p.subarray(s,s+i),f=0;f<i;f++)u[f]=o[f].value,c[f]=o[f].index},d=0;d<u;d++)f(d);var m=e.slice();return m[m.length-1]=i,[r.buffer(m,n,h),r.buffer(m,"int32",p)]}(n.readSync(a.dataId),h,a.dtype,o,s),2),d=f[0],m=f[1];return[n.makeTensorInfo(d.shape,d.dtype,d.values),n.makeTensorInfo(m.shape,m.dtype,m.values)]}if(0===o)return h[h.length-1]=0,[n.makeTensorInfo(h,a.dtype,[]),n.makeTensorInfo(h,"int32",[])];if(1===p)return[a,Io({attrs:{shape:h,dtype:"int32",value:0},backend:n})];var g=n.texData.get(a.dataId),v=null!==g&&g.isPacked,y=v?n.unpackTensor(a):a,b=r.util.sizeFromShape(h)/p,x=Fr({inputs:{x:y},attrs:{shape:[b,p]},backend:n});v&&Kc(n,y);for(var w=Yc(o),_=Yc(p),S=null,T=function(){return null===S?[x,x]:[x,S]},E=function(t,e,r){var i=T(),a=new Xc(r),o=[[p],[null===S?1:0],[Number.NEGATIVE_INFINITY],[t],[e]],s=S;S=n.runWebGLProgram(a,i,"int32",o),Kc(n,s)},k=1;k<w;k*=2)for(var I=2*k,A=k;A>=1;A/=2)E(I,A,[b,_]);for(var N=_;N>w;N/=2){var C=T(),R=new qc([b,N/2]),O=[[p],[null===S?1:0],[w]],D=S;for(S=n.runWebGLProgram(R,C,"int32",O),Kc(n,D),I=2*(k=w/2),A=k;A>=1;A/=2)E(I,A,S.shape)}var M=S;S=Wi({inputs:{x:S},backend:n,attrs:{begin:0,size:[b,o]}}),Kc(n,M);var F=Xo({inputs:{x,indices:S},backend:n,attrs:{axis:1,batchDims:1}});Kc(n,x);var P=h.slice(0,-1);P.push(o),M=S,S=Fr({inputs:{x:S},attrs:{shape:P},backend:n}),Kc(n,M);var L=F;return F=Fr({inputs:{x:F},attrs:{shape:P},backend:n}),Kc(n,L),[F,S]}},Qc=function(t,e,n,r,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;var o,s="nearest"===n?1:2;switch(r){case"constant":default:o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(o," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(o," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(o," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(e,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(e,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(s," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")},tl={kernelName:r.Transform,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.image,a=e.transforms,o=r.interpolation,s=r.fillMode,u=r.fillValue,l=r.outputShape,h=c(i.shape,4),p=h[0],f=h[1],d=h[2],m=h[3],g=c(null!=l?l:[f,d],2),v=g[0],y=g[1],b=new Qc(f,d,o,s,u,[p,v,y,m]);return n.runWebGLProgram(b,[i,a],"float32")}},el={kernelName:r.Unique,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n.axis,a=e.x;pt(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(a.dataId),s=Mn(o,i,a.shape,a.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,a.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}},nl={kernelName:r.Unpack,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.value,a=r.axis;a<0&&(a+=i.shape.length);for(var o=i,s=o.shape.length,u=i.shape[a],c=new Array(s-1),l=0,h=0;h<s;h++)h!==a&&(c[l++]=o.shape[h]);var p=[],f=new Array(s).fill(0),d=o.shape.slice();d[a]=1;var m=new Array(u);for(h=0;h<m.length;h++){f[a]=h;var g=Wi({inputs:{x:o},backend:n,attrs:{begin:f,size:d}}),v=Fr({inputs:{x:g},backend:n,attrs:{shape:c}});m[h]=v,p.push(g)}return p.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),m}},rl=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(a,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(a,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")},il=[Yr,$r,Qr,ei,ii,si,ui,ci,mi,gi,yi,xi,_i,Ti,ki,Ni,Ci,Di,Mi,Fi,Bi,ji,Hi,Xi,qi,Ji,ea,ia,yr,sa,ma,Ta,Na,Ra,Oa,Da,Ma,Pa,Ba,Ua,Ha,Xa,qa,Ya,Ja,eo,no,io,oo,so,co,lo,po,mo,vo,bo,_o,Eo,No,Ro,Mo,Po,zo,Go,Wo,jo,qo,Yo,$o,gr,Jo,pa,ts,ns,is,wr,os,us,cs,hs,fs,ms,vs,bs,_s,Ts,ks,As,Ns,Cs,Ds,Ms,Fs,Ps,Ls,zs,Ws,js,Qs,Mr,eu,ru,au,su,Yi,cu,pu,fu,vu,bu,Tr,xu,wu,_u,Su,Eu,$i,qs,Iu,Nu,Ru,Pr,Mu,Pu,zu,Gu,ju,Xu,Ku,Zu,Qu,ec,rc,ac,sc,cc,hc,fc,Vi,Js,mc,gc,vc,yc,bc,xc,wc,_c,Ec,Ic,Cc,Rc,Oc,Mc,Fc,Pc,Lc,Zs,jr,zc,Gc,Wc,Hc,Jc,tl,Xr,el,nl,{kernelName:r.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,i=t.attrs,a=e.x,o=e.segmentIds,s=i.numSegments,u=a.shape.length,c=[],l=0,h=r.backend_util.getAxesPermutation([l],u),p=a;null!=h&&(p=Hr({inputs:{x:a},backend:n,attrs:{perm:h}}),c.push(p),l=r.backend_util.getInnerMostAxes(1,u)[0]);var f=r.backend_util.segment_util.computeOutShape(p.shape,l,s),d=r.util.sizeFromShape([p.shape[l]]),m=Fr({inputs:{x:p},backend:n,attrs:{shape:[-1,d]}});c.push(m);var g=r.sumOutType(a.dtype),v=function(t,e,i,a,o){var s=t.shape[0],u=t.shape[1],l=r.backend_util.segment_util.segOpComputeOptimalWindowSize(u,o),h=new rl({windowSize:l,inSize:u,batchSize:s,numSegments:o},e),p=n.compileAndRun(h,[t,i],a);if(c.push(p),p.shape[1]===o)return p;var f=Tu({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),d=jc({inputs:{x:f},backend:n,attrs:{reps:[u/l]}});return c.push(f),c.push(d),v(p,e,d,a,o)},y=Fr({inputs:{x:v(m,"unsortedSegmentSum",o,g,s)},backend:n,attrs:{shape:f}}),b=y;if(null!=h){c.push(y);var x=r.backend_util.getUndoAxesPermutation(h);b=Hr({inputs:{x:b},backend:n,attrs:{perm:x}})}return c.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),b}},hu];try{for(var al=u(il),ol=al.next();!ol.done;ol=al.next()){var sl=ol.value;r.registerKernel(sl)}}catch(t){Zc={error:t}}finally{try{ol&&!ol.done&&($c=al.return)&&$c.call(al)}finally{if(Zc)throw Zc.error}}n.GPGPUContext=fe,n.MathBackendWebGL=ur,n.forceHalfFloat=cr,n.gpgpu_util=pe,n.setWebGLContext=g,n.version_webgl="4.17.0",n.webgl=lr,n.webgl_util=ft},{"@tensorflow/tfjs-core":7}],6:[function(t,e,n){(function(e,r,i){(function(){"use strict";var a=t("@tensorflow/tfjs-core");var o=function(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,e}(a);a.env().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(t){t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}));var s,u,c=function(t,e){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},c(t,e)};function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function h(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function p(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function f(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function m(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}!function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"}(s||(s={})),function(t){var e;(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(u||(u={}));var g={};function v(t){return g[t]}function y(t,e,n,r,i){var o=e.inputParams[t];if(o&&void 0!==o.inputIndexStart){var s=o.inputIndexStart,u=0===o.inputIndexEnd?void 0:void 0===o.inputIndexEnd?s+1:o.inputIndexEnd,c=s<0?e.inputNames.length+s:s;if("tensor"===o.type)return b(e.inputNames[c],n,r,i);if("tensors"===o.type){var l=e.inputs.slice(s,u);return e.inputNames.slice(s,u).filter((function(t,e){var n;return"NoOp"!==(null===(n=l[e])||void 0===n?void 0:n.op)})).map((function(t){return b(t,n,r,i)}))}var h=b(e.inputNames[c],n,r,i),p=h.dataSync();return"number"===o.type?p[0]:a.util.toNestedArray(h.shape,p)}var f=e.attrParams[t];return f&&f.value}function b(t,e,n,r){var i=d(S(t,n),2),a=i[0],o=i[1];if(null!=r){var s=r.getHashTableHandleByName(a);if(null!=s)return s}var u=n.currentContextIds.find((function(t){return!!e[_(a,t)]}));return void 0!==u?e[_(a,u)][o]:void 0}function x(t,e,n){return e[_(t,n.currentContextId)]}function w(t,e){var n=d(S(t,e),3),r=n[0],i=n[1],a=n[2];return[_(r,e&&e.currentContextId),i,a]}function _(t,e){return e?"".concat(t,"-").concat(e):t}function S(t,e){if(""===t)return["",0,void 0];var n=null!=e&&null!=e.parseNodeNameCache;if(n){var r=e.parseNodeNameCache.get(t);if(null!=r)return r}var i,a=t.split(":");if(1===a.length)i=[t,0,void 0];else{var o=a[0],s=3===a.length?a[1]:void 0;i=[o,Number(a[a.length-1]),s]}return n&&e.parseNodeNameCache.set(t,i),i}function T(t,e,n){var r=y("pad",t,e,n);if("explicit"===r){r=y("explicitPaddings",t,e,n);for(var i=[[0,0],[0,0],[0,0],[0,0]],a=0;a<4;a++)i[a][0]=r[2*a],i[a][1]=r[2*a+1];return i}return r}function E(t){return t.kept?t:a.clone(t)}var k={__proto__:null,json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},I={__proto__:null,json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},A={__proto__:null,json:[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}]},N={__proto__:null,json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]},C={__proto__:null,json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},R={__proto__:null,json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},O={__proto__:null,json:[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]},D={__proto__:null,json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},M={__proto__:null,json:[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}]},F={__proto__:null,json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}]},P={__proto__:null,json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}]},L={__proto__:null,json:[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}]},B={__proto__:null,json:[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}]},z={__proto__:null,json:[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},U={__proto__:null,json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}]},G={__proto__:null,json:[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}]},W={__proto__:null,json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},V={__proto__:null,json:[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}]},j={__proto__:null,json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}]},H=function(){function t(){var t=[k,I,A,N,C,R,O,D,M,F,P,L,B,z,U,G,W,V,j],e=[].concat.apply([],m([],d(t.map((function(t){return t.json}))),!1));this.opMappers=e.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),t.prototype.transformGraph=function(t,e){var n=this;void 0===e&&(e={});var r=t.node,i=[],a=[],o=[],s=r.reduce((function(t,e){return t[e.name]=n.mapNode(e),e.op.startsWith("Placeholder")?i.push(t[e.name]):"Const"===e.op?a.push(t[e.name]):null!=e.input&&0!==e.input.length||o.push(t[e.name]),t}),{}),u=[],c=[],l={},h={};null!=e&&(l=this.mapSignatureEntries(e.inputs),h=this.mapSignatureEntries(e.outputs));var p=Object.keys(s);p.forEach((function(t){var e=s[t];e.inputNames.forEach((function(t,n){var r=d(w(t),3),i=r[0],a=r[2],o=s[i];if(null!=o.outputs){var u=o.outputs.indexOf(a);if(-1!==u){var c="".concat(i,":").concat(u);e.inputNames[n]=c}}e.inputs.push(o),o.children.push(e)}))})),0===Object.keys(h).length?p.forEach((function(t){var e=s[t];0===e.children.length&&c.push(e)})):Object.keys(h).forEach((function(t){var e=d(w(t),1)[0],n=s[e];null!=n&&(n.signatureKey=h[t],c.push(n))})),Object.keys(l).length>0?Object.keys(l).forEach((function(t){var e=d(w(t),1)[0],n=s[e];n&&(n.signatureKey=l[t],u.push(n))})):u=i;var f={};null!=t.library&&null!=t.library.function&&(f=t.library.function.reduce((function(t,e){return t[e.signature.name]=n.mapFunction(e),t}),{}));var m={nodes:s,inputs:u,outputs:c,weights:a,placeholders:i,signature:e,functions:f};return o.length>0&&(m.initNodes=o),m},t.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce((function(e,n){return e[t[n].name]=n,e}),{})},t.prototype.mapNode=function(t){var e=v(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.slice(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,i=void 0;switch(n.type){case"string":void 0===(i=q(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=q(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(i=rt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=rt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(i=Y(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(i=Y(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(i=nt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=nt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(i=K(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=K(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(i=at(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=at(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(i=et(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=et(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(i=it(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=it(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(i=J(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=J(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(i=Q(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=Q(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(i=$(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=$(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(t.op))}return e[n.name]={value:i,type:r},e}),{})),n},t.prototype.mapFunction=function(t){var e=this,n=t.nodeDef,r=[],i={};null!=n&&(i=n.reduce((function(t,n){return t[n.name]=e.mapNode(n),"Const"===n.op&&r.push(t[n.name]),t}),{}));var a=[],o=[];t.signature.inputArg.forEach((function(t){var e=d(w(t.name),1)[0],n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Z(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,a.push(n),i[e]=n})),Object.keys(i).forEach((function(t){var e=i[t];e.inputNames.forEach((function(t,n){var r=d(w(t),3),a=r[0],o=r[2],s=i[a];if(null!=s.outputs){var u=s.outputs.indexOf(o);if(-1!==u){var c="".concat(a,":").concat(u);e.inputNames[n]=c}}e.inputs.push(s),s.children.push(e)}))}));var s=t.ret;t.signature.outputArg.forEach((function(t){var e=d(w(s[t.name]),2),n=e[0],r=e[1],a=i[n];null!=a&&(a.defaultOutput=r,o.push(a))}));var u=this.mapArgsToSignature(t);return{nodes:i,inputs:a,outputs:o,weights:r,placeholders:[],signature:u}},t.prototype.mapArgsToSignature=function(t){var e=this;return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((function(t,n){return t[n.name]=e.mapArgToTensorInfo(n),t}),{}),outputs:t.signature.outputArg.reduce((function(n,r){return n[r.name]=e.mapArgToTensorInfo(r,t.ret),n}),{})}},t.prototype.mapArgToTensorInfo=function(t,e){var n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}},t}();function X(t,e){var n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var e=a.env().global;if(void 0!==e.atob)return e.atob(t);if(void 0!==i)return new i(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function q(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return null!=i?X(i.s,r):n}function K(t,e,n){var r=t[e];return r?r.b:n}function Y(t,e,n){var r=t[e]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function Z(t){switch("string"==typeof t&&(t=s[t]),t){case s.DT_FLOAT:case s.DT_HALF:return"float32";case s.DT_INT32:case s.DT_INT64:case s.DT_INT8:case s.DT_UINT8:return"int32";case s.DT_BOOL:return"bool";case s.DT_DOUBLE:return"float32";case s.DT_STRING:return"string";case s.DT_COMPLEX64:case s.DT_COMPLEX128:return"complex64";default:return null}}function $(t,e,n){var r=t[e];return r&&r.func?r.func.name:n}function J(t,e,n){var r=t[e];return r&&r.type?Z(r.type):n}function Q(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return Z(t)})):n}function tt(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"==typeof t.size?t.size:parseInt(t.size,10)})):[]}function et(t,e,n){var r=t[e];return r&&r.shape?tt(r.shape):n}function nt(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"==typeof t?t:parseInt(t,10)})):n}function rt(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return i&&i.list&&i.list.s?i.list.s.map((function(t){return X(t,r)})):n}function it(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return tt(t)})):n}function at(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var ot=function(){function t(t,e,n){var r=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(t){return r.getInput(t)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(t,e){return t[e]=r.getAttr(e),t}),{}))}return t.prototype.getInput=function(t){return b(t,this.tensorMap,this.context)},t.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return b(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Y(this.node.rawAttrs,t,e);if(null!=n.s)return q(this.node.rawAttrs,t,e);if(null!=n.b)return K(this.node.rawAttrs,t,e);if(null!=n.shape)return et(this.node.rawAttrs,t,e);if(null!=n.type)return J(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return nt(this.node.rawAttrs,t,e);if(null!=n.list.s)return rt(this.node.rawAttrs,t,e);if(null!=n.list.shape)return it(this.node.rawAttrs,t,e);if(null!=n.list.b)return at(this.node.rawAttrs,t,e);if(null!=n.list.type)return Q(this.node.rawAttrs,t,e)}return e},t}(),st=function(){function t(){}return t.prototype.refCount=function(t){return ut("refCount")},t.prototype.incRef=function(t){return ut("incRef")},t.prototype.timerAvailable=function(){return!0},t.prototype.time=function(t){return ut("time")},t.prototype.read=function(t){return ut("read")},t.prototype.readSync=function(t){return ut("readSync")},t.prototype.readToGPU=function(t,e){return ut("readToGPU")},t.prototype.numDataIds=function(){return ut("numDataIds")},t.prototype.disposeData=function(t,e){return ut("disposeData")},t.prototype.write=function(t,e,n){return ut("write")},t.prototype.move=function(t,e,n,r,i){return ut("move")},t.prototype.createTensorFromGPUData=function(t,e,n){return ut("createTensorFromGPUData")},t.prototype.memory=function(){return ut("memory")},t.prototype.floatPrecision=function(){return ut("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.dispose=function(){return ut("dispose")},t}();function ut(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function ct(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function lt(t,e,n){void 0===n&&(n=""),ct(ft(t,e),(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}function ht(t){ct(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function pt(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function ft(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function dt(t){return t%1==0}function mt(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function gt(t,e){var n=e.length;return ct((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t)})),ct(t.every((function(t){return dt(t)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(t)})),t.map((function(t){return t<0?n+t:t}))}function vt(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function yt(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function bt(t){return"string"==typeof t||t instanceof String}function xt(t){return Array.isArray(t)?xt(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":"number"==typeof t?"float32":bt(t)?"string":function(t){return"boolean"==typeof t}(t)?"bool":"float32"}function wt(t){return!!(t&&t.constructor&&t.call&&t.apply)}function _t(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function St(t,e,n,r){void 0===r&&(r=!1);var i=new Array;if(1===e.length)for(var a=e[0]*(r?2:1),o=0;o<a;o++)i[o]=n[t+o];else{a=e[0];var s=e.slice(1),u=s.reduce((function(t,e){return t*e}))*(r?2:1);for(o=0;o<a;o++)i[o]=St(t+o*u,s,n,r)}return i}function Tt(t,e,n){if(void 0===n&&(n=!1),0===t.length)return e[0];var r=t.reduce((function(t,e){return t*e}))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return St(0,t,e,n)}function Et(t,e){for(var n=kt(t,e),r=0;r<n.length;r++)n[r]=1;return n}function kt(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function It(t){t.forEach((function(e){ct(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")}))}))}function At(t){return t&&t.then&&"function"==typeof t.then}var Nt="tfjsflags",Ct=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Rt,this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&(Ot().getBool("IS_TEST")||Ot().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];Ot().getBool("IS_TEST")||Ot().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(r,".")),this.set(t,r)}},t.prototype.getAsync=function(t){return h(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:return t in this.flags?[2,this.flags[t]]:(e=this.flags,n=t,[4,this.evaluateFlag(t)]);case 1:return e[n]=r.sent(),[2,this.flags[t]]}}))}))},t.prototype.get=function(t){if(t in this.flags)return this.flags[t];var e=this.evaluateFlag(t);if(At(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getString=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=this.getQueryParams(this.global.location.search);Nt in e&&e[Nt].split(",").forEach((function(e){var n=d(e.split(":"),2),r=n[0],i=n[1];t.urlFlags[r]=function(t,e){var n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:e}(0,i)}))}},t}();function Rt(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e}function Ot(){return Mt}var Dt,Mt=null;function Ft(){if(null==Dt){var t=void 0;if("undefined"!=typeof window)t=window;else if(void 0!==r)t=r;else if(void 0!==e)t=e;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}Dt=t}return Dt}function Pt(t,e){var n,r=(null==(n=Ft())._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals);if(r.has(t))return r.get(t);var i=e();return r.set(t,i),r.get(t)}var Lt="Cast",Bt="Identity",zt="Tile",Ut="Transpose",Gt="_FusedMatMul",Wt="FusedConv2D",Vt="FusedDepthwiseConv2D";function jt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Ot().getBool("IS_TEST")||Ot().getBool("PROD")||console.warn.apply(console,m([],d(t),!1))}var Ht=Pt("kernelRegistry",(function(){return new Map})),Xt=Pt("gradRegistry",(function(){return new Map}));function qt(t,e){var n=function(t,e){return"".concat(e,"_").concat(t)}(t,e);return Ht.get(n)}function Kt(t){return Xt.get(t)}function Yt(t){for(var e=Ht.entries(),n=[];;){var r=e.next(),i=r.done,a=r.value;if(i)break;var o=d(a,2),s=o[0],u=o[1];d(s.split("_"),1)[0]===t&&n.push(u)}return n}var Zt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{};var $t=Qt,Jt=null;try{Jt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function Qt(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function te(t){return!0===(t&&t.__isLong__)}Qt.prototype.__isLong__,Object.defineProperty(Qt.prototype,"__isLong__",{value:!0}),Qt.isLong=te;var ee={},ne={};function re(t,e){var n,r,i;return e?(i=0<=(t>>>=0)&&t<256)&&(r=ne[t])?r:(n=ae(t,(0|t)<0?-1:0,!0),i&&(ne[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(r=ee[t])?r:(n=ae(t,t<0?-1:0,!1),i&&(ee[t]=n),n)}function ie(t,e){if(isNaN(t))return e?de:fe;if(e){if(t<0)return de;if(t>=le)return be}else{if(t<=-he)return xe;if(t+1>=he)return ye}return t<0?ie(-t,e).neg():ae(t%ce|0,t/ce|0,e)}function ae(t,e,n){return new Qt(t,e,n)}Qt.fromInt=re,Qt.fromNumber=ie,Qt.fromBits=ae;var oe=Math.pow;function se(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return fe;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return se(t.substring(1),e,n).neg();for(var i=ie(oe(n,8)),a=fe,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),u=parseInt(t.substring(o,o+s),n);if(s<8){var c=ie(oe(n,s));a=a.mul(c).add(ie(u))}else a=(a=a.mul(i)).add(ie(u))}return a.unsigned=e,a}function ue(t,e){return"number"==typeof t?ie(t,e):"string"==typeof t?se(t,e):ae(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}Qt.fromString=se,Qt.fromValue=ue;var ce=4294967296,le=ce*ce,he=le/2,pe=re(1<<24),fe=re(0);Qt.ZERO=fe;var de=re(0,!0);Qt.UZERO=de;var me=re(1);Qt.ONE=me;var ge=re(1,!0);Qt.UONE=ge;var ve=re(-1);Qt.NEG_ONE=ve;var ye=ae(-1,2147483647,!1);Qt.MAX_VALUE=ye;var be=ae(-1,-1,!0);Qt.MAX_UNSIGNED_VALUE=be;var xe=ae(0,-2147483648,!1);Qt.MIN_VALUE=xe;var we=Qt.prototype;we.toInt=function(){return this.unsigned?this.low>>>0:this.low},we.toNumber=function(){return this.unsigned?(this.high>>>0)*ce+(this.low>>>0):this.high*ce+(this.low>>>0)},we.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(xe)){var e=ie(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=ie(oe(t,6),this.unsigned),a=this,o="";;){var s=a.div(i),u=(a.sub(s.mul(i)).toInt()>>>0).toString(t);if((a=s).isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},we.getHighBits=function(){return this.high},we.getHighBitsUnsigned=function(){return this.high>>>0},we.getLowBits=function(){return this.low},we.getLowBitsUnsigned=function(){return this.low>>>0},we.getNumBitsAbs=function(){if(this.isNegative())return this.eq(xe)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},we.isZero=function(){return 0===this.high&&0===this.low},we.eqz=we.isZero,we.isNegative=function(){return!this.unsigned&&this.high<0},we.isPositive=function(){return this.unsigned||this.high>=0},we.isOdd=function(){return!(1&~this.low)},we.isEven=function(){return!(1&this.low)},we.equals=function(t){return te(t)||(t=ue(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},we.eq=we.equals,we.notEquals=function(t){return!this.eq(t)},we.neq=we.notEquals,we.ne=we.notEquals,we.lessThan=function(t){return this.comp(t)<0},we.lt=we.lessThan,we.lessThanOrEqual=function(t){return this.comp(t)<=0},we.lte=we.lessThanOrEqual,we.le=we.lessThanOrEqual,we.greaterThan=function(t){return this.comp(t)>0},we.gt=we.greaterThan,we.greaterThanOrEqual=function(t){return this.comp(t)>=0},we.gte=we.greaterThanOrEqual,we.ge=we.greaterThanOrEqual,we.compare=function(t){if(te(t)||(t=ue(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},we.comp=we.compare,we.negate=function(){return!this.unsigned&&this.eq(xe)?xe:this.not().add(me)},we.neg=we.negate,we.add=function(t){te(t)||(t=ue(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=t.high>>>16,o=65535&t.high,s=t.low>>>16,u=0,c=0,l=0,h=0;return l+=(h+=i+(65535&t.low))>>>16,c+=(l+=r+s)>>>16,u+=(c+=n+o)>>>16,u+=e+a,ae((l&=65535)<<16|(h&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},we.subtract=function(t){return te(t)||(t=ue(t)),this.add(t.neg())},we.sub=we.subtract,we.multiply=function(t){if(this.isZero())return fe;if(te(t)||(t=ue(t)),Jt)return ae(Jt.mul(this.low,this.high,t.low,t.high),Jt.get_high(),this.unsigned);if(t.isZero())return fe;if(this.eq(xe))return t.isOdd()?xe:fe;if(t.eq(xe))return this.isOdd()?xe:fe;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(pe)&&t.lt(pe))return ie(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=t.high>>>16,o=65535&t.high,s=t.low>>>16,u=65535&t.low,c=0,l=0,h=0,p=0;return h+=(p+=i*u)>>>16,l+=(h+=r*u)>>>16,h&=65535,l+=(h+=i*s)>>>16,c+=(l+=n*u)>>>16,l&=65535,c+=(l+=r*s)>>>16,l&=65535,c+=(l+=i*o)>>>16,c+=e*u+n*s+r*o+i*a,ae((h&=65535)<<16|(p&=65535),(c&=65535)<<16|(l&=65535),this.unsigned)},we.mul=we.multiply,we.divide=function(t){if(te(t)||(t=ue(t)),t.isZero())throw Error("division by zero");var e,n,r;if(Jt)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?ae((this.unsigned?Jt.div_u:Jt.div_s)(this.low,this.high,t.low,t.high),Jt.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?de:fe;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return de;if(t.gt(this.shru(1)))return ge;r=de}else{if(this.eq(xe))return t.eq(me)||t.eq(ve)?xe:t.eq(xe)?me:(e=this.shr(1).div(t).shl(1)).eq(fe)?t.isNegative()?me:ve:(n=this.sub(t.mul(e)),r=e.add(n.div(t)));if(t.eq(xe))return this.unsigned?de:fe;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();r=fe}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var i=Math.ceil(Math.log(e)/Math.LN2),a=i<=48?1:oe(2,i-48),o=ie(e),s=o.mul(t);s.isNegative()||s.gt(n);)s=(o=ie(e-=a,this.unsigned)).mul(t);o.isZero()&&(o=me),r=r.add(o),n=n.sub(s)}return r},we.div=we.divide,we.modulo=function(t){return te(t)||(t=ue(t)),Jt?ae((this.unsigned?Jt.rem_u:Jt.rem_s)(this.low,this.high,t.low,t.high),Jt.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},we.mod=we.modulo,we.rem=we.modulo,we.not=function(){return ae(~this.low,~this.high,this.unsigned)},we.and=function(t){return te(t)||(t=ue(t)),ae(this.low&t.low,this.high&t.high,this.unsigned)},we.or=function(t){return te(t)||(t=ue(t)),ae(this.low|t.low,this.high|t.high,this.unsigned)},we.xor=function(t){return te(t)||(t=ue(t)),ae(this.low^t.low,this.high^t.high,this.unsigned)},we.shiftLeft=function(t){return te(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?ae(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):ae(0,this.low<<t-32,this.unsigned)},we.shl=we.shiftLeft,we.shiftRight=function(t){return te(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?ae(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):ae(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},we.shr=we.shiftRight,we.shiftRightUnsigned=function(t){if(te(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?ae(this.low>>>t|e<<32-t,e>>>t,this.unsigned):ae(32===t?e:e>>>t-32,0,this.unsigned)},we.shru=we.shiftRightUnsigned,we.shr_u=we.shiftRightUnsigned,we.toSigned=function(){return this.unsigned?ae(this.low,this.high,!1):this},we.toUnsigned=function(){return this.unsigned?this:ae(this.low,this.high,!0)},we.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},we.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},we.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},Qt.fromBytes=function(t,e,n){return n?Qt.fromBytesLE(t,e):Qt.fromBytesBE(t,e)},Qt.fromBytesLE=function(t,e){return new Qt(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},Qt.fromBytesBE=function(t,e){return new Qt(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};var _e=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}($t),Se=_e||function(t,e){return e.forEach((function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((function(n){if("default"!==n&&!(n in t)){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}))})),t}({__proto__:null,default:_e},[$t]);function Te(t){return Se.fromString(t,!0,16)}function Ee(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ne(t)),Ot().getBool("DEBUG")&&function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var n=new Uint8Array(t.length),r=0;r<n.length;++r)0!==Math.round(t[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(e))}function ke(){return Ot().platform.now()}function Ie(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",Ot().platform.decode(t,e)}function Ae(t){return null!=Ot().platform.isTypedArray?Ot().platform.isTypedArray(t):function(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}(t)}function Ne(t,e,n){var r,i;if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),"boolean"==typeof t||"number"==typeof t||"string"==typeof t||At(t)||null==t||Ae(t)&&n)e.push(t);else if(Array.isArray(t)||Ae(t))for(var a=0;a<t.length;++a)Ne(t[a],e,n);else{var o=-1;try{for(var s=f(Object.keys(t)),u=s.next();!u.done;u=s.next()){var c=u.value;/^([1-9]+[0-9]*|0)$/.test(c)&&(o=Math.max(o,Number(c)))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}for(a=0;a<=o;a++)Ne(t[a],e,n)}return e}Te("c3a5c85c97cb3127"),Te("b492b66fbe98f273"),Te("9ae16a3b2f90404f");var Ce=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new Re)}return t.prototype.profileKernel=function(t,e,n){var r,i,a,o,s=function(){a=n()},u=ke();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();try{for(var c=f(a),l=c.next();!l.done;l=c.next())l.value.dataSync()}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}o=Promise.resolve({kernelMs:ke()-u})}if(Ot().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var h=function(e){var n=a[e];n.data().then((function(e){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found ".concat(i," in the result of '").concat(n,"'")),!0}}(e,n.dtype,t)}))},p=0;p<a.length;p++)h(p);return{kernelName:t,outputs:a,inputs:e,timeMs:o.then((function(t){return t.kernelMs})),extraInfo:o.then((function(t){return null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""}))}},t.prototype.logKernelProfile=function(t){var e=this,n=t.kernelName,r=t.outputs,i=t.timeMs,a=t.inputs,o=t.extraInfo;r.forEach((function(t){Promise.all([t.data(),i,o]).then((function(r){e.logger.logKernelProfile(n,t,r[0],r[1],a,r[2])}))}))},t}(),Re=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,a){var o="number"==typeof r?mt("".concat(r,"ms"),9):r.error,s=mt(t,25),u=e.rank,c=e.size,l=mt(e.shape.toString(),14),h="";for(var p in i){var f=i[p];if(null!=f){var d=f.shape||e.shape,m=d.length;h+="".concat(p,": ").concat(m,"D ").concat(m>0?d:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(a),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),Oe=20,De=3,Me=7;function Fe(t,e,n,r){var i=_t(e),a=function(t,e,n,r){var i=pt(e),a=r[r.length-1],o=new Array(a).fill(0),s=e.length,u="complex64"===n?ze(t):t;if(s>1)for(var c=0;c<i/a;c++)for(var l=c*a,h=0;h<a;h++)o[h]=Math.max(o[h],Pe(u[l+h],0,n).length);return o}(t,e,n,i),o=e.length,s=Be(t,e,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}function Pe(t,e,n){return mt(Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(Me))," + ")+"".concat(parseFloat(t[1].toFixed(Me)),"j"):bt(t)?"'".concat(t,"'"):"bool"===n?Le(t):parseFloat(t.toFixed(Me)).toString(),e)}function Le(t){return 0===t?"false":"true"}function Be(t,e,n,r,i,a){void 0===a&&(a=!0);var o="complex64"===n?2:1,s=e[0],u=e.length;if(0===u)return"complex64"===n?[Pe(ze(t)[0],0,n)]:"bool"===n?[Le(t[0])]:[t[0].toString()];if(1===u){if(s>Oe){var c=De*o,l=Array.from(t.slice(0,c)),h=Array.from(t.slice((s-De)*o,s*o));return"complex64"===n&&(l=ze(l),h=ze(h)),["["+l.map((function(t,e){return Pe(t,i[e],n)})).join(", ")+", ..., "+h.map((function(t,e){return Pe(t,i[s-De+e],n)})).join(", ")+"]"]}return["["+("complex64"===n?ze(t):Array.from(t)).map((function(t,e){return Pe(t,i[e],n)})).join(", ")+"]"]}var p=e.slice(1),f=r.slice(1),g=r[0]*o,v=[];if(s>Oe){for(var y=0;y<De;y++){var b=(x=y*g)+g;v.push.apply(v,m([],d(Be(t.slice(x,b),p,n,f,i,!1)),!1))}for(v.push("..."),y=s-De;y<s;y++)b=(x=y*g)+g,v.push.apply(v,m([],d(Be(t.slice(x,b),p,n,f,i,y===s-1)),!1))}else for(y=0;y<s;y++){var x;b=(x=y*g)+g,v.push.apply(v,m([],d(Be(t.slice(x,b),p,n,f,i,y===s-1)),!1))}var w=2===u?",":"";for(v[0]="["+(s>0?v[0]+w:""),y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;var _=",\n";for(y=2;y<u;y++)_+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":_),v}function ze(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var Ue=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=pt(t),null!=n){var i=n.length;ct(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(r.size,"'.")}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||vt(e,this.size),this.strides=_t(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),ct(n.length===this.rank,(function(){return"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(e.rank,")")}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];0===n.length&&(n=[0]);var i=0;try{for(var a=f(n),o=a.next();!o.done;o=a.next()){var s=o.value;if(s<0||s>=this.shape[i]){var u="Requested out of range element at ".concat(n,". ")+"  Buffer shape=".concat(this.shape);throw new Error(u)}i++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}for(var c=n[n.length-1],l=0;l<n.length-1;++l)c+=this.strides[l]*n[l];return this.values[c]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!1,configurable:!0}),t.prototype.toTensor=function(){return Ge().makeTensor(this.values,this.shape,this.dtype)},t}(),Ge=null,We=null,Ve=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=pt(t),this.strides=_t(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!1,configurable:!0}),t.prototype.buffer=function(){return h(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,We.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return We.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return h(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Tt(this.shape,t,"complex64"===this.dtype)]}}))}))},t.prototype.arraySync=function(){return Tt(this.shape,this.dataSync(),"complex64"===this.dtype)},t.prototype.data=function(){return h(this,void 0,void 0,(function(){var t,e;return p(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=Ge().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return Ie(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataToGPU=function(t){return this.throwIfDisposed(),Ge().readToGPU(this.dataId,t)},t.prototype.dataSync=function(){this.throwIfDisposed();var t=Ge().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return Ie(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return h(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Ge().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ge().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!1,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.print=function(t){return void 0===t&&(t=!1),We.print(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),We.clone(this)},t.prototype.toString=function(t){return void 0===t&&(t=!1),Fe(this.dataSync(),this.shape,this.dtype,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),We.cast(this,t)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),Ge().makeVariable(this,t,e,n)},t}();function je(){return Pt("Tensor",(function(){return Ve}))}Object.defineProperty(Ve,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}}),je();var He,Xe,qe,Ke,Ye,Ze=function(t){function e(e,n,r,i){var a=t.call(this,e.shape,e.dtype,e.dataId,i)||this;return a.trainable=n,a.name=r,a}return l(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!ft(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));Ge().disposeTensor(this),this.dataId=t.dataId,Ge().incRef(this,null)},e.prototype.dispose=function(){Ge().disposeVariable(this),this.isDisposedInternal=!0},e}(Ve);Object.defineProperty(Ze,Symbol.hasInstance,{value:function(t){return t instanceof Ve&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(He||(He={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Xe||(Xe={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(qe||(qe={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Ke||(Ke={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Ye||(Ye={}));var $e={float32:Ke,int32:Xe,bool:qe,complex64:Ye};function Je(t){return null!=t&&"object"==typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function Qe(t){return"undefined"!=typeof GPUBuffer&&null!=t&&"object"==typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}function tn(t,e){if(t.dtype===e.dtype)return[t,e];var n=function(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return $e[t][e]}(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function en(t){var e=[];return nn(t,e,new Set),e}function nn(t,e,n){if(null!=t)if(t instanceof Ve)e.push(t);else if(r=t,Array.isArray(r)||"object"==typeof r){var r,i=t;for(var a in i){var o=i[a];n.has(o)||(n.add(o),nn(o,e,n))}}}function rn(t){return null!=t.kernelName}var an=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(t){return t.name}))))}}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),on=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new an}return t.prototype.ready=function(){return h(this,void 0,void 0,(function(){var t,e,n;return p(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!1,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(jt("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return h(this,void 0,void 0,(function(){var e,n,r;return p(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Ce(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;Yt(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;Yt(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{var r=n.factory();if(!r||r instanceof st||"function"!=typeof r.then)return this.registry[t]=r,{success:!0,asyncInit:!1};var i=++this.pendingBackendInitId,a=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return i<e.pendingBackendInitId||(e.pendingBackendInit=null,jt("Initialization of backend ".concat(t," failed")),jt(n.stack||n.message)),!1}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}catch(e){return jt("Initialization of backend ".concat(t," failed")),jt(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.success,a=r.asyncInit;if(a||i)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),a=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=sn.runKernel(Bt,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){var e={x:t};return sn.runKernel(Lt,e,{dtype:"float32"})}}}),[],{}),e},t.prototype.runKernel=function(t,e,n){if(null==this.backendName&&this.backend,null==qt(t,this.backendName))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),i=0;n.forEach((function(t){i+="complex64"===t.dtype?3:1}));var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))},t.prototype.runKernelFunc=function(t){var e,n,r,i=this,a=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=rn(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(rn(t)){var l=t.kernelName,h=t.inputs,p=t.attrs;null==this.backendName&&this.backend;var f=qt(l,this.backendName);ct(null!=f,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(i.backendName,"'")})),n=function(){var t=i.backend.numDataIds();r=f.kernelFunc({inputs:h,attrs:p,backend:i.backend});var e=Array.isArray(r)?r:[r];i.shouldCheckForMemLeaks()&&i.checkKernelForMemLeak(l,t,e);var n=e.map((function(t){return null!=t.rank?t:i.makeTensorFromTensorInfo(t)}));if(o){var s=i.getTensorsForGradient(l,h,n);a=i.saveTensorsForBackwardMode(s)}return n}}else{var d=t.forwardFunc,m=function(t){o&&(a=t.map((function(t){return i.keep(i.clone(t))})))};n=function(){var t=i.backend.numDataIds();r=i.tidy((function(){return d(i.backend,m)}));var e=Array.isArray(r)?r:[r];return i.shouldCheckForMemLeaks()&&i.checkKernelForMemLeak(c,t,e),e}}var g,v=t.inputs,y=t.attrs,b=rn(t)?null:t.backwardsFunc;return this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){i.ENV.getBool("DEBUG")||i.state.profiling?(g=i.profiler.profileKernel(c,v,(function(){return n()})),i.ENV.getBool("DEBUG")&&i.profiler.logKernelProfile(g),e=g.outputs):e=n()})),o&&this.addTapeNode(c,v,e,b,a,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(v).map((function(t){return null!=v[t]?v[t].shape:null})),outputShapes:e.map((function(t){return t.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(r)?e:e[0]},t.prototype.saveTensorsForBackwardMode=function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))},t.prototype.getTensorsForGradient=function(t,e,n){var r=Kt(t);if(null!=r){var i=r.inputsToSave||[],a=r.outputsToSave||[],o=void 0;r.saveAllInputs?(ct(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(e).map((function(t){return e[t]}))):o=i.map((function(t){return e[t]}));var s=n.filter((function(t,e){return a[e]}));return o.concat(s)}return[]},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var i=t;"string"===n&&bt(t[0])&&(i=t.map((function(t){return e=t,void 0===n&&(n="utf-8"),n=n||"utf-8",Ot().platform.encode(e,n);var e,n})));var a=r.write(i,e,n),o=new Ve(e,n,a,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(a),u=function(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}(i);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},t.prototype.makeTensorFromDataId=function(t,e,n,r){var i={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)},t.prototype.makeTensorFromTensorInfo=function(t,e){var n=t.dataId,r=t.shape,i=t.dtype,a=new Ve(r,i,n,this.nextTensorId());return this.trackTensor(a,e),a},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));var i=new Ze(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name ".concat(i.name," was already registered"));return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.trackTensor=function(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*yt(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof Ze||this.track(t)},t.prototype.incRef=function(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)},t.prototype.removeDataId=function(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){var e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){var n=t.size*yt(t.dtype);this.state.numBytes-=n}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return h(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,u,c,l,h;return p(this,(function(p){switch(p.label){case 0:return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],r=this.state.activeProfile,[4,t()];case 1:r.result=p.sent(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,m([],d(this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),!1)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,p.label=2;case 2:p.trys.push([2,8,9,10]),i=f(this.state.activeProfile.kernels),a=i.next(),p.label=3;case 3:return a.done?[3,7]:(o=a.value,s=o,[4,o.kernelTimeMs]);case 4:return s.kernelTimeMs=p.sent(),u=o,[4,o.extraInfo];case 5:u.extraInfo=p.sent(),p.label=6;case 6:return a=i.next(),[3,3];case 7:return[3,10];case 8:return c=p.sent(),l={error:c},[3,10];case 9:try{a&&!a.done&&(h=i.return)&&h.call(i)}finally{if(l)throw l.error}return[7];case 10:return[2,this.state.activeProfile]}}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,i,a){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},u=Kt(t);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],i=kt(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],i,a)}),this.state.activeTape.push(s)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=en(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||r.has(a.id)||a.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),ct(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var a=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));ct(a instanceof Ve,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},i={},a=0;a<e.length;a++)r[e[a].id]=!0;for(a=0;a<t.length;a++){var o=(d=t[a]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){d.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[d.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var p={};for(a=t.length-1;a>=0;a--)for(o=(d=t[a]).inputs,l=0;l<d.outputs.length;l++)if(h[d.outputs[l].id]){for(var s in o)h[o[s].id]=!0,p[d.id]=!0;break}var f=[];for(a=0;a<t.length;a++){var d;if(i[(d=t[a]).id]&&p[d.id]){var m={};for(var s in d.inputs){var g=d.inputs[s];r[g.id]&&(m[s]=g)}var v=Object.assign({},d);v.inputs=m,v.outputs=d.outputs,f.push(v)}}return f}(this.state.activeTape,e,a);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[a.id]=n??(r=Et(pt(t=a.shape),"float32"),sn.makeTensor(r,t,"float32")),function(t,e,n,r){for(var i=function(i){var a=e[i],o=[];if(a.outputs.forEach((function(e){var n=t[e.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var s=a.gradient(o),u=function(e){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var i=n((function(){return s[e]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[e];if(!ft(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=i;else{var u=t[o.id];t[o.id]=r(u,i),u.dispose()}};for(var c in a.inputs)u(c)},a=e.length-1;a>=0;a--)i(a)}(s,o,(function(t){return i.tidy(t)}),un);var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){var e,n;try{for(var r=f(t.saved),i=r.next();!i.done;i=r.next())i.value.dispose()}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}})),i.state.activeTape=null),{value:a,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return ct(wt(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];ct(r.every((function(t){return t instanceof Ve})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var a={};return r.forEach((function(t,e){a[e]=t})),e.runKernelFunc({forwardFunc:function(e,i){return ct((n=t.apply(void 0,m([],d(m(m([],d(r),!1),[i],!1)),!1))).value instanceof Ve,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),ct(wt(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value},backwardsFunc:function(t,e){var i=n.gradFunc(t,e),a=Array.isArray(i)?i:[i];ct(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),ct(a.every((function(t){return t instanceof Ve})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(t,e){o[e]=function(){return t}})),o},inputs:a})}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.readToGPU=function(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)},t.prototype.time=function(t){return h(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:return e=ke(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=ke()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!1,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new an,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t}();on.nextTensorId=0,on.nextVariableId=0;var sn=function(){var t=Ft();if(null==t._tfengine){var e=new Ct(t);t._tfengine=new on(e)}return function(t){Mt=t}(t._tfengine.ENV),Ge=function(){return t._tfengine},t._tfengine}();function un(t,e){var n={a:t,b:e};return sn.runKernel("Add",n)}function cn(t,e){var n=t;if(Ae(t))return"string"===e?[]:[t.length];if(Je(t)){var r=t.channels||"RGBA";return[t.height,t.width*r.length]}if(Qe(t))return[t.buffer.size/(null==e?4:yt(e))];if(!Array.isArray(t))return[];for(var i=[];Array.isArray(n)||Ae(n)&&"string"!==e;)i.push(n.length),n=n[0];return Array.isArray(t)&&Ot().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&ln(t,i,[]),i}function ln(t,e,n){if(n=n||[],Array.isArray(t)||Ae(t)){ct(e.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")})),ct(t.length===e[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")}));for(var r=e.slice(1),i=0;i<t.length;++i)ln(t[i],r,n.concat(i))}else ct(0===e.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")}))}function hn(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function pn(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof je())return hn(r,t.dtype,e,n),t;var i=xt(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),hn(r,i,e,n),null==t||!Ae(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){var a=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(a,"'"))}var o=cn(t,i);Ae(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?Ee(t,i):Ne(t,[],!0);return sn.makeTensor(s,o,i)}function fn(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map((function(t,i){return pn(t,"".concat(e,"[").concat(i,"]"),n,r)}))}var dn="__op";function mn(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=dn;var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];sn.startScope(n);try{var i=r.apply(void 0,m([],d(t),!1));return At(i)&&console.error("Cannot return a Promise inside of tidy."),sn.endScope(i),i}catch(t){throw sn.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}var gn=mn({abs_:function(t){var e=pn(t,"x","abs");if("complex64"===e.dtype){var n={x:e};return sn.runKernel("ComplexAbs",n)}return n={x:e},sn.runKernel("Abs",n)}}),vn=mn({acos_:function(t){var e={x:pn(t,"x","acos")};return sn.runKernel("Acos",e)}}),yn=mn({acosh_:function(t){var e={x:pn(t,"x","acosh")};return sn.runKernel("Acosh",e)}}),bn=mn({add_:function(t,e){var n,r=pn(t,"a","add"),i=pn(e,"b","add"),a={a:r=(n=d(tn(r,i),2))[0],b:i=n[1]};return sn.runKernel("Add",a)}}),xn=mn({addN_:function(t){ct(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),ct(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)}));var e=t.map((function(t,e){return pn(t,"tensors".concat(e),"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!ft(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return sn.runKernel("AddN",r)}}),wn=mn({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:pn(t,"x","all","bool")},i={axis:e,keepDims:n};return sn.runKernel("All",r,i)}}),_n=mn({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:pn(t,"x","any","bool")},i={axis:e,keepDims:n};return sn.runKernel("Any",r,i)}}),Sn=mn({argMax_:function(t,e){void 0===e&&(e=0);var n={x:pn(t,"x","argMax")},r={axis:e};return sn.runKernel("ArgMax",n,r)}}),Tn=mn({argMin_:function(t,e){void 0===e&&(e=0);var n={x:pn(t,"x","argMin")},r={axis:e};return sn.runKernel("ArgMin",n,r)}}),En=mn({asin_:function(t){var e={x:pn(t,"x","asin")};return sn.runKernel("Asin",e)}}),kn=mn({asinh_:function(t){var e={x:pn(t,"x","asinh")};return sn.runKernel("Asinh",e)}}),In=mn({atan_:function(t){var e={x:pn(t,"x","atan")};return sn.runKernel("Atan",e)}}),An=mn({atan2_:function(t,e){var n,r=pn(t,"a","atan2"),i=pn(e,"b","atan2"),a={a:r=(n=d(tn(r,i),2))[0],b:i=n[1]};return sn.runKernel("Atan2",a)}}),Nn=mn({atanh_:function(t){var e={x:pn(t,"x","atanh")};return sn.runKernel("Atanh",e)}}),Cn=mn({cast_:function(t,e){var n=pn(t,"x","cast");if(!function(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},i={dtype:e};return sn.runKernel(Lt,r,i)}});function Rn(t,e,n,r,i,a,o,s){var u,c;void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var l=d([-1,-1,-1,-1],4),h=l[0],p=l[1],f=l[2],m=l[3];if("channelsLast"===s)h=(u=d(t,4))[0],p=u[1],f=u[2],m=u[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));h=(c=d(t,4))[0],m=c[1],p=c[2],f=c[3]}var g,v=d(e,4),y=v[0],b=v[1],x=v[3],w=d(On(n),2),_=w[0],S=w[1],T=d(On(r),2),E=T[0],k=T[1],I=Dn(y,E),A=Dn(b,k),N=function(t,e,n,r,i,a,o,s,u){var c,l,h;if("number"==typeof t){c={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var p=function(t,e,n,r,i){null==r&&(r=function(t,e,n,r){void 0===r&&(r=1);var i=Dn(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}(t,e,n));var a=t[1];return[Mn((t[0]-e+2*r)/n+1,i),Mn((a-e+2*r)/n+1,i)]}([e,n],a,r,t,s);l=p[0],h=p[1]}else if("same"===t){l=Math.ceil(e/r),h=Math.ceil(n/i);var f=Math.max(0,(l-1)*r+a-e),d=Math.max(0,(h-1)*i+o-n);c={top:m=Math.floor(f/2),bottom:g=f-m,left:v=Math.floor(d/2),right:y=d-v,type:"SAME"}}else if("valid"===t)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-a+1)/r),h=Math.ceil((n-o+1)/i);else{if("object"!=typeof t)throw Error("Unknown padding parameter: ".concat(t));var m,g,v,y;c={top:m="channelsLast"===u?t[1][0]:t[2][0],bottom:g="channelsLast"===u?t[1][1]:t[2][1],left:v="channelsLast"===u?t[2][0]:t[3][0],right:y="channelsLast"===u?t[2][1]:t[3][1],type:0===m&&0===g&&0===v&&0===y?"VALID":"EXPLICIT"},l=Mn((e-a+m+g)/r+1,s),h=Mn((n-o+v+y)/i+1,s)}return{padInfo:c,outHeight:l,outWidth:h}}(i,p,f,_,S,I,A,a,s),C=N.padInfo,R=N.outHeight,O=N.outWidth,D=o?x*m:x;return"channelsFirst"===s?g=[h,D,R,O]:"channelsLast"===s&&(g=[h,R,O,D]),{batchSize:h,dataFormat:s,inHeight:p,inWidth:f,inChannels:m,outHeight:R,outWidth:O,outChannels:D,padInfo:C,strideHeight:_,strideWidth:S,filterHeight:y,filterWidth:b,effectiveFilterHeight:I,effectiveFilterWidth:A,dilationHeight:E,dilationWidth:k,inShape:t,outShape:g,filterShape:e}}function On(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function Dn(t,e){return e<=1?t:t+(t-1)*(e-1)}function Mn(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function Fn(t){var e=d(On(t),3),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function Pn(t,e){return Fn(t)||Fn(e)}function Ln(t){return On(t).every((function(t){return t>0}))}function Bn(t,e,n){if(null!=n){if("string"==typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"==typeof e)ct(dt(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}));else{if("object"!=typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach((function(e){e.forEach((function(e){ct(dt(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}))}))}))}}}var zn=mn({reshape_:function(t,e){var n={x:pn(t,"x","reshape","string_or_numeric")},r={shape:e};return sn.runKernel("Reshape",n,r)}}),Un=mn({avgPool_:function(t,e,n,r,i){var a=pn(t,"x","avgPool","float32");ct(Pn(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=a,s=!1;3===a.rank&&(s=!0,o=zn(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ct(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),Bn("avgPool",r,i);var u={x:o},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i},l=sn.runKernel("AvgPool",u,c);return l=Cn(l,a.dtype),s?zn(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),Gn=mn({avgPool3d_:function(t,e,n,r,i,a){void 0===a&&(a="NDHWC");var o=pn(t,"x","avgPool3d","float32"),s=o,u=!1;4===o.rank&&(u=!0,s=zn(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ct(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),ct("NDHWC"===a,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a)})),ct("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),Bn("avgPool3d",r,i);var c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},h=sn.runKernel("AvgPool3D",c,l);return h=Cn(h,s.dtype),u?zn(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),Wn=mn({clone_:function(t){var e={x:pn(t,"x","clone","string_or_numeric")};return sn.runKernel(Bt,e)}}),Vn=mn({concat_:function(t,e){void 0===e&&(e=0),ct(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=fn(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return Wn(n[0]);var r=n,i={axis:e};return sn.runKernel("Concat",r,i)}}),jn=mn({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var a=pn(t,"a","matMul"),o=pn(e,"b","matMul"),s={a:a=(i=d(tn(a,o),2))[0],b:o=i[1]},u={transposeA:n,transposeB:r};return sn.runKernel("BatchMatMul",s,u)}}),Hn=mn({mul_:function(t,e){var n,r=pn(t,"a","mul"),i=pn(e,"b","mul"),a={a:r=(n=d(tn(r,i),2))[0],b:i=n[1]};return sn.runKernel("Multiply",a)}}),Xn=mn({sigmoid_:function(t){var e={x:pn(t,"x","sigmoid","float32")};return sn.runKernel("Sigmoid",e)}}),qn=mn({slice_:function(t,e,n){var r=pn(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var i={x:r},a={begin:e,size:n};return sn.runKernel("Slice",i,a)}}),Kn=mn({tanh_:function(t){var e={x:pn(t,"x","tanh","float32")};return sn.runKernel("Tanh",e)}}),Yn=mn({basicLSTMCell_:function(t,e,n,r,i,a){var o=pn(t,"forgetBias","basicLSTMCell"),s=pn(e,"lstmKernel","basicLSTMCell"),u=pn(n,"lstmBias","basicLSTMCell"),c=pn(r,"data","basicLSTMCell"),l=pn(i,"c","basicLSTMCell"),h=pn(a,"h","basicLSTMCell"),p=Vn([c,h],1),f=jn(p,s),d=bn(f,u),m=d.shape[0],g=d.shape[1]/4,v=[m,g],y=qn(d,[0,0],v),b=qn(d,[0,g],v),x=qn(d,[0,2*g],v),w=qn(d,[0,3*g],v),_=bn(Hn(Xn(y),Kn(b)),Hn(l,Xn(bn(o,x))));return[_,Hn(Kn(_),Xn(w))]}}),Zn=mn({batchToSpaceND_:function(t,e,n){var r=pn(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));ct(r.rank>=1+e.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(e.length)})),ct(n.length===e.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length)})),ct(r.shape[0]%i==0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(i)}));var a={x:r},o={blockShape:e,crops:n};return sn.runKernel("BatchToSpaceND",a,o)}}),$n=mn({batchNorm_:function(t,e,n,r,i,a){null==a&&(a=.001);var o,s,u=pn(t,"x","batchNorm"),c=pn(e,"mean","batchNorm"),l=pn(n,"variance","batchNorm");null!=i&&(o=pn(i,"scale","batchNorm")),null!=r&&(s=pn(r,"offset","batchNorm")),ct(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),ct(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),ct(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h={x:function(t){return 0===t.rank||1===t.rank?zn(t,[1,1,1,t.size]):2===t.rank?zn(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?zn(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t}(u),scale:o,offset:s,mean:c,variance:l},p={varianceEpsilon:a},f=sn.runKernel("FusedBatchNorm",h,p);return zn(f,u.shape)}}),Jn=mn({batchNorm2d_:function(t,e,n,r,i,a){var o,s,u=pn(t,"x","batchNorm"),c=pn(e,"mean","batchNorm"),l=pn(n,"variance","batchNorm");return null!=i&&(o=pn(i,"scale","batchNorm")),null!=r&&(s=pn(r,"offset","batchNorm")),ct(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),ct(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),ct(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&ct(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&ct(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),$n(u,c,l,s,o,a)}}),Qn=mn({batchNorm3d_:function(t,e,n,r,i,a){var o,s,u=pn(t,"x","batchNorm"),c=pn(e,"mean","batchNorm"),l=pn(n,"variance","batchNorm");return null!=i&&(o=pn(i,"scale","batchNorm")),null!=r&&(s=pn(r,"offset","batchNorm")),ct(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),ct(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),ct(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&ct(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&ct(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),$n(u,c,l,s,o,a)}}),tr=mn({batchNorm4d_:function(t,e,n,r,i,a){var o,s,u=pn(t,"x","batchNorm"),c=pn(e,"mean","batchNorm"),l=pn(n,"variance","batchNorm");return null!=i&&(o=pn(i,"scale","batchNorm")),null!=r&&(s=pn(r,"offset","batchNorm")),ct(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),ct(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),ct(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&ct(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&ct(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),$n(u,c,l,s,o,a)}}),er=mn({bincount_:function(t,e,n){var r=pn(t,"x","bincount"),i=pn(e,"weights","bincount");ct("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),ct(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),ct(i.size===r.size||0===i.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(i.shape,".")}));var a={x:r,weights:i},o={size:n};return sn.runKernel("Bincount",a,o)}}),nr=mn({bitwiseAnd_:function(t,e){var n=pn(t,"x","bitwiseAnd"),r=pn(e,"y","bitwiseAnd");if(!ft(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));var i={a:n,b:r};return sn.runKernel("BitwiseAnd",i)}}),rr=mn({broadcastArgs_:function(t,e){var n=pn(t,"s0","broadcastArgs","int32"),r=pn(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));var i={s0:n,s1:r};return sn.runKernel("BroadcastArgs",i)}}),ir=mn({broadcastTo_:function(t,e){var n=pn(t,"broadcastTo","x"),r=n.shape;if(It(e),e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){for(var i=n.shape.slice();i.length<e.length;)i.unshift(1);n=zn(n,i)}for(var a=n.shape,o=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(e,"]."));if(0===o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0})).length)return Wn(n);var u={x:n},c={reps:o};return sn.runKernel(zt,u,c)}});function ar(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",It(t),new Ue(t,e,n)}var or=mn({ceil_:function(t){var e={x:pn(t,"x","ceil","float32")};return sn.runKernel("Ceil",e)}});function sr(t,e,n){It(t);var r={shape:t,value:e,dtype:n=n||xt(e)};return sn.runKernel("Fill",{},r)}var ur=mn({clipByValue_:function(t,e,n){var r=pn(t,"x","clipByValue");if(ct(e<=n,(function(){return"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,").")})),e===n)return sr(r.shape,e,r.dtype);var i={x:r},a={clipValueMin:e,clipValueMax:n};return sn.runKernel("ClipByValue",i,a)}}),cr=mn({complex_:function(t,e){var n=pn(t,"real","complex"),r=pn(e,"imag","complex");lt(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var i={real:n,imag:r};return sn.runKernel("Complex",i)}}),lr=mn({concat1d_:function(t){return Vn(t,0)}}),hr=mn({concat2d_:function(t,e){return Vn(t,e)}}),pr=mn({concat3d_:function(t,e){return Vn(t,e)}}),fr=mn({concat4d_:function(t,e){return Vn(t,e)}}),dr=mn({conv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=pn(t,"x","conv2d","float32"),u=pn(e,"filter","conv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=zn(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ct(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),ct(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),Bn("conv2d",r,o);var h="NHWC"===i?c.shape[3]:c.shape[1];ct(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),ct(Pn(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'")})),ct(Ln(a),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),ct(Ln(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var p={x:c,filter:u},f={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},d=sn.runKernel("Conv2D",p,f);return l?zn(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),mr=mn({conv1d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NWC"),void 0===a&&(a=1);var s=pn(t,"x","conv1d"),u=pn(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=zn(s,[1,s.shape[0],s.shape[1]])),ct(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),ct(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),Bn("conv1d",r,o),ct(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),ct(Pn(n,a),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(a,"'")})),ct(Ln(a),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),ct(Ln(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),ct("NWC"===i,(function(){return"Error in conv1d: got dataFormat of ".concat(i," but only NWC is currently supported.")}));var h=zn(u,[1,u.shape[0],u.shape[1],u.shape[2]]),p=zn(c,[c.shape[0],1,c.shape[1],c.shape[2]]),f=dr(p,h,[1,n],r,"NHWC",[1,a],o);return zn(f,l?[f.shape[2],f.shape[3]]:[f.shape[0],f.shape[2],f.shape[3]])}}),gr=mn({conv2DBackpropInput_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC"),ct(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=zn(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),ct(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),ct(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),ct(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===a?s[3]:s[1],h="NHWC"===a?u.shape[3]:u.shape[1];ct(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),ct(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),Bn("conv2dDerInput",i,o);var p={dy:u,filter:n},f={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,inputShape:s},d=sn.runKernel("Conv2DBackpropInput",p,f);return c?zn(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),vr=mn({conv2dTranspose_:function(t,e,n,r,i,a){var o=pn(t,"x","conv2dTranspose"),s=pn(e,"filter","conv2dTranspose");return gr(n,o,s,r,i,"NHWC",a)}}),yr=mn({conv3d_:function(t,e,n,r,i,a){void 0===i&&(i="NDHWC"),void 0===a&&(a=[1,1,1]);var o=pn(t,"x","conv3d"),s=pn(e,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=zn(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ct(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),ct(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),ct(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),ct(Pn(n,a),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'")})),ct("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of ".concat(i," but only NDHWC is currently supported.")})),ct(Ln(a),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),ct(Ln(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var l={x:u,filter:s},h={strides:n,pad:r,dataFormat:i,dilations:a},p=sn.runKernel("Conv3D",l,h);return c?zn(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),br=mn({conv3DBackpropInput_:function(t,e,n,r,i){ct(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var a=t,o=e,s=!1;4===e.rank&&(s=!0,o=zn(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);var u=a[4],c=o.shape[4];ct(5===a.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(a.length,".")})),ct(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),ct(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),ct(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),ct(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},h={pad:i,strides:r,inputShape:a},p=sn.runKernel("Conv3DBackpropInputV2",l,h);return s?zn(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),xr=mn({conv3dTranspose_:function(t,e,n,r,i){var a=pn(t,"x","conv3dTranspose"),o=pn(e,"filter","conv3dTranspose");return br(n,a,o,r,i)}}),wr=mn({cos_:function(t){var e={x:pn(t,"x","cos","float32")};return sn.runKernel("Cos",e)}}),_r=mn({cosh_:function(t){var e={x:pn(t,"x","cosh","float32")};return sn.runKernel("Cosh",e)}}),Sr=mn({cumprod_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i={x:pn(t,"x","cumprod")},a={axis:e,exclusive:n,reverse:r};return sn.runKernel("Cumprod",i,a)}}),Tr=mn({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i={x:pn(t,"x","cumsum")},a={axis:e,exclusive:n,reverse:r};return sn.runKernel("Cumsum",i,a)}}),Er=mn({denseBincount_:function(t,e,n,r){void 0===r&&(r=!1);var i=pn(t,"x","denseBincount"),a=pn(e,"weights","denseBincount");ct("int32"===i.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(i.dtype)})),ct(i.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(i.rank,".")})),ct(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),ct(a.size===i.size||0===a.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(i.shape,", weights shape: ")+"".concat(a.shape,".")}));var o={x:i,weights:a},s={size:n,binaryOutput:r};return sn.runKernel("DenseBincount",o,s)}}),kr=mn({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=pn(t,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];ct(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(e)})),ct(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(r.shape)})),ct(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(e," for depthToSpace with input shape\n        ").concat(r.shape)})),ct(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:e,dataFormat:n};return sn.runKernel("DepthToSpace",s,u)}}),Ir=mn({depthwiseConv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=pn(t,"x","depthwiseConv2d","float32"),u=pn(e,"filter","depthwiseConv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=zn(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ct(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),ct(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")}));var h="NHWC"===i?c.shape[3]:c.shape[1];ct(h===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),Bn("depthwiseConv2d",r,o);var p={x:c,filter:u},f={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},d=sn.runKernel("DepthwiseConv2dNative",p,f);return l?zn(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Ar=mn({diag_:function(t){var e={x:pn(t,"x","diag")};return sn.runKernel("Diag",e)}}),Nr=mn({dilation2d_:function(t,e,n,r,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var o=pn(t,"x","dilation2d"),s=pn(e,"filter","dilation2d");ct(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),ct(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),ct("NHWC"===a,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(a)}));var u=o,c=!1;3===o.rank&&(u=zn(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),ct(u.shape[3]===s.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(s.shape[2])}));var l={x:u,filter:s},h={strides:n,pad:r,dilations:i},p=sn.runKernel("Dilation2D",l,h);return c?zn(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Cr=mn({floorDiv_:function(t,e){var n,r=pn(t,"a","floorDiv"),i=pn(e,"b","floorDiv"),a={a:r=(n=d(tn(r,i),2))[0],b:i=n[1]};return sn.runKernel("FloorDiv",a)}}),Rr=mn({div_:function(t,e){var n,r=pn(t,"a","div"),i=pn(e,"b","div");if(r=(n=d(tn(r,i),2))[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype)return Cr(r,i);var a={a:r,b:i};return sn.runKernel("RealDiv",a,{})}});function Or(t,e){for(var n=Math.max(t.length,e.length),r=new Array(n),i=0;i<n;i++){var a=t[t.length-i-1];null==a&&(a=1);var o=e[e.length-i-1];if(null==o&&(o=1),1===a)r[n-i-1]=o;else if(1===o)r[n-i-1]=a;else{if(a!==o){var s="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(s)}r[n-i-1]=a}}return r}var Dr=mn({equal_:function(t,e){var n,r=pn(t,"a","equal","string_or_numeric"),i=pn(e,"b","equal","string_or_numeric");r=(n=d(tn(r,i),2))[0],i=n[1],Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("Equal",a)}}),Mr=mn({where_:function(t,e,n){var r=pn(e,"a","where"),i=pn(n,"b","where"),a=pn(t,"condition","where","bool"),o=Or(Or(a.shape,r.shape),i.shape),s={condition:ir(a,o),t:ir(r,o),e:ir(i,o)};return sn.runKernel("Select",s)}}),Fr=mn({zerosLike_:function(t){var e={x:pn(t,"x","zerosLike")};return sn.runKernel("ZerosLike",e)}}),Pr=mn({divNoNan_:function(t,e){var n,r=pn(t,"a","div"),i=pn(e,"b","div");r=(n=d(tn(r,i),2))[0],i=n[1];var a=Rr(r,i),o=Fr(a),s=Dr(i,o);return Mr(s,o,a)}}),Lr=mn({dot_:function(t,e){var n=pn(t,"t1","dot"),r=pn(e,"t2","dot");ct(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(ct(i===a,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(i," and ").concat(a,".")})),1===n.rank&&1===r.rank){var o=zn(n,[1,-1]),s=zn(r,[-1,1]),u=jn(o,s);return zn(u,[])}return 1===n.rank&&2===r.rank?(o=zn(n,[1,-1]),s=zn(r,[r.shape[0],r.shape[1]]),u=jn(o,s),zn(u,[u.size])):2===n.rank&&1===r.rank?(s=zn(r,[-1,1]),u=jn(n,s),zn(u,[u.size])):(s=zn(r,[r.shape[0],r.shape[1]]),jn(n,s))}}),Br=mn({einsum_:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e.map((function(t,e){return pn(t,"tensors".concat(e),"einsum")})),i={equation:t};return sn.runKernel("Einsum",r,i)}}),zr=mn({elu_:function(t){var e={x:pn(t,"x","elu","float32")};return sn.runKernel("Elu",e)}}),Ur=mn({ensureShape_:function(t,e){var n=pn(t,"x","ensureShape","string_or_numeric");if(!function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(null!==t[n]&&null!==e[n]&&t[n]!==e[n])return!1;return!0}(n.shape,e))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(e));return t}}),Gr=mn({erf_:function(t){var e=pn(t,"x","erf");ct("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=Cn(e,"float32"));var n={x:e};return sn.runKernel("Erf",n)}});function Wr(t,e){return function(t,e,n){for(var r=t.length+e.length,i=[],a=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}(t,e.map((function(t){return 1})),e)}var Vr=mn({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:pn(t,"x","max")},i={reductionIndices:e,keepDims:n};return sn.runKernel("Max",r,i)}}),jr=mn({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:pn(t,"x","min")},i={axis:e,keepDims:n};return sn.runKernel("Min",r,i)}}),Hr=mn({pow_:function(t,e){var n,r=pn(t,"base","pow"),i=pn(e,"exp","pow"),a={a:r=(n=d(tn(r,i),2))[0],b:i=n[1]};return sn.runKernel("Pow",a)}});function Xr(t,e,n,r){if(null==r)r=xt(t);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Qe(t)||Je(t)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return sn.backend.createTensorFromGPUData(t,e||n,r)}if(!Ae(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){It(e);var i=pt(e),a=pt(n);ct(i===a,(function(){return"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(i," values but has ").concat(a)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==pt(e.slice(o));ct(n[o]===e[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")}))}}return Ae(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?Ee(t,r):Ne(t,[],!0),sn.makeTensor(t,e,r)}function qr(t,e){if((Ae(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Ae(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Xr(t,[],[],e)}var Kr=mn({sqrt_:function(t){var e={x:pn(t,"x","sqrt","float32")};return sn.runKernel("Sqrt",e)}}),Yr=mn({square_:function(t){var e=pn(t,"x","square");return sn.runKernel("Square",{x:e},{})}}),Zr=mn({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=pn(t,"x","sum");"bool"===r.dtype&&(r=Cn(r,"int32"));var i={x:r},a={axis:e,keepDims:n};return sn.runKernel("Sum",i,a)}});function $r(t,e,n){if(void 0===n&&(n=null),0===t.rank)return gn(t);if(1!==t.rank&&null===n)return $r(zn(t,[-1]),e,n);if(1===t.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===e)return Zr(gn(t),n);if(e===1/0)return Vr(gn(t),n);if(e===-1/0)return jr(gn(t),n);if("euclidean"===e||2===e)return Kr(Zr(Hr(gn(t),qr(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return Vr(Zr(gn(t),n[0]),n[1]-1);if(e===1/0)return Vr(Zr(gn(t),n[1]),n[0]);if(e===-1/0)return jr(Zr(gn(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return Kr(Zr(Yr(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}var Jr=mn({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=$r(t=pn(t,"x","norm"),e,n),a=i.shape;if(r){var o=gt(n,t.shape);a=Wr(i.shape,o)}return zn(i,a)}}),Qr=mn({euclideanNorm_:function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=!1),Jr(t,"euclidean",e,n)}}),ti=mn({exp_:function(t){var e={x:pn(t,"x","exp")};return sn.runKernel("Exp",e)}}),ei=mn({expandDims_:function(t,e){void 0===e&&(e=0);var n=pn(t,"x","expandDims","string_or_numeric");ct(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},i={dim:e};return sn.runKernel("ExpandDims",r,i)}}),ni=mn({expm1_:function(t){var e={x:pn(t,"x","expm1")};return sn.runKernel("Expm1",e)}}),ri=mn({tile_:function(t,e){var n=pn(t,"x","tile","string_or_numeric");ct(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")}));var r={x:n},i={reps:e};return sn.runKernel(zt,r,i)}}),ii=mn({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=ar([t,e],r),a=t<=e?t:e,o=0;o<a;++o)i.set(1,o,o);var s=zn(i.toTensor(),[t,e]);if(null==n)return s;if(1===n.length)return ri(ei(s,0),[n[0],1,1]);if(2===n.length)return ri(ei(ei(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return ri(ei(ei(ei(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),ai=mn({floor_:function(t){var e={x:pn(t,"x","floor","float32")};return sn.runKernel("Floor",e)}}),oi=mn({gather_:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i={x:pn(t,"x","gather"),indices:pn(e,"indices","gather","int32")},a={axis:n,batchDims:r};return sn.runKernel("GatherV2",i,a)}}),si=mn({greater_:function(t,e){var n,r=pn(t,"a","greater","string_or_numeric"),i=pn(e,"b","greater","string_or_numeric");r=(n=d(tn(r,i),2))[0],i=n[1],Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("Greater",a)}}),ui=mn({greaterEqual_:function(t,e){var n,r=pn(t,"a","greaterEqual","string_or_numeric"),i=pn(e,"b","greaterEqual","string_or_numeric");r=(n=d(tn(r,i),2))[0],i=n[1],Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("GreaterEqual",a)}}),ci=mn({imag_:function(t){var e={input:pn(t,"input","imag")};return sn.runKernel("Imag",e)}}),li=mn({isFinite_:function(t){var e={x:pn(t,"x","isFinite")};return sn.runKernel("IsFinite",e)}}),hi=mn({isInf_:function(t){var e={x:pn(t,"x","isInf")};return sn.runKernel("IsInf",e)}}),pi=mn({isNaN_:function(t){var e={x:pn(t,"x","isNaN")};return sn.runKernel("IsNan",e)}}),fi=mn({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n={x:pn(t,"x","leakyRelu")},r={alpha:e};return sn.runKernel("LeakyRelu",n,r)}}),di=mn({less_:function(t,e){var n,r=pn(t,"a","less","string_or_numeric"),i=pn(e,"b","less","string_or_numeric");r=(n=d(tn(r,i),2))[0],i=n[1],Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("Less",a)}}),mi=mn({lessEqual_:function(t,e){var n,r=pn(t,"a","lessEqual","string_or_numeric"),i=pn(e,"b","lessEqual","string_or_numeric");r=(n=d(tn(r,i),2))[0],i=n[1],Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("LessEqual",a)}}),gi=mn({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var a=pn(t,"x","localResponseNormalization");ct(4===a.rank||3===a.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(a.rank,".")})),ct(dt(e),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")}));var o=a,s=!1;3===a.rank&&(s=!0,o=zn(a,[1,a.shape[0],a.shape[1],a.shape[2]]));var u={x:o},c={depthRadius:e,bias:n,alpha:r,beta:i},l=sn.runKernel("LRN",u,c);return s?zn(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),vi=mn({log_:function(t){var e={x:pn(t,"x","log","float32")};return sn.runKernel("Log",e)}}),yi=mn({log1p_:function(t){var e={x:pn(t,"x","log1p")};return sn.runKernel("Log1p",e)}});function bi(t){return sn.customGrad(t)}var xi=mn({neg_:function(t){var e={x:pn(t,"x","neg")};return sn.runKernel("Neg",e)}}),wi=mn({softplus_:function(t){var e={x:pn(t,"x","softplus")};return sn.runKernel("Softplus",e)}}),_i=mn({logSigmoid_:function(t){var e=pn(t,"x","logSigmoid");return bi((function(t){return{value:xi(wi(xi(t))),gradFunc:function(e){return Hn(e,Xn(xi(t)))}}}))(e)}}),Si=mn({sub_:function(t,e){var n,r=pn(t,"a","sub"),i=pn(e,"b","sub"),a={a:r=(n=d(tn(r,i),2))[0],b:i=n[1]};return sn.runKernel("Sub",a)}}),Ti=mn({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=pn(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));var r=bi((function(t,n){var r=Vr(t,e,!0),i=Si(t,r),a=Si(Cn(i,"float32"),vi(Zr(ti(i),e,!0)));return n([a]),{value:a,gradFunc:function(t,n){var r=d(n,1)[0],i=ti(r);return Si(t,Hn(Zr(t,e,!0),i))}}}));return r(n)}}),Ei=mn({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=pn(t,"x","logSumExp"),i=gt(e,r.shape),a=Vr(r,i,!0),o=Si(r,a),s=ti(o),u=Zr(s,i),c=vi(u),l=bn(zn(a,c.shape),c);if(n){var h=Wr(l.shape,i);return zn(l,h)}return l}}),ki=mn({logicalAnd_:function(t,e){var n=pn(t,"a","logicalAnd","bool"),r=pn(e,"b","logicalAnd","bool");Or(n.shape,r.shape);var i={a:n,b:r};return sn.runKernel("LogicalAnd",i)}}),Ii=mn({logicalNot_:function(t){var e={x:pn(t,"x","logicalNot","bool")};return sn.runKernel("LogicalNot",e)}}),Ai=mn({logicalOr_:function(t,e){var n=pn(t,"a","logicalOr","bool"),r=pn(e,"b","logicalOr","bool");Or(n.shape,r.shape);var i={a:n,b:r};return sn.runKernel("LogicalOr",i)}}),Ni=mn({logicalXor_:function(t,e){var n=pn(t,"a","logicalXor","bool"),r=pn(e,"b","logicalXor","bool");return Or(n.shape,r.shape),ki(Ai(t,e),Ii(ki(t,e)))}}),Ci=2147483648,Ri=mn({searchSorted_:function(t,e,n){void 0===n&&(n="left");var r=pn(t,"sortedSequence","searchSorted"),i=pn(e,"values","searchSorted"),a=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],s=zn(r,[-1,a]),u=zn(i,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(pt(u.shape)>=Ci)throw new Error("values tensor size must less than ".concat(Ci));if(s.shape[1]>=Ci)throw new Error("trailing dim_size must less than ".concat(Ci," for int32 output type, was ").concat(s.shape[1]));var c={sortedSequence:s,values:u},l={side:n};return sn.runKernel("SearchSorted",c,l)}}),Oi=mn({maxPool_:function(t,e,n,r,i){var a=pn(t,"x","maxPool"),o=a,s=!1;3===a.rank&&(s=!0,o=zn(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ct(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),ct(Pn(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),Bn("maxPool",r,i);var u={x:o},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i},l=sn.runKernel("MaxPool",u,c);return s?zn(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),Di=mn({maxPool3d_:function(t,e,n,r,i,a){void 0===e&&(e=[1,1,1]),void 0===a&&(a="NDHWC");var o=pn(t,"x","maxPool3d"),s=o,u=!1;4===o.rank&&(u=!0,s=zn(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ct(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),ct("NDHWC"===a,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a)})),Bn("maxPool3d",r,i);var c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},h=sn.runKernel("MaxPool3D",c,l);return u?zn(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),Mi=mn({maxPoolWithArgmax_:function(t,e,n,r,i){void 0===i&&(i=!1);var a={x:pn(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},s=sn.runKernel("MaxPoolWithArgmax",a,o);return{result:s[0],indexes:s[1]}}}),Fi=mn({maximum_:function(t,e){var n,r=pn(t,"a","maximum"),i=pn(e,"b","maximum");r=(n=d(tn(r,i),2))[0],i=n[1],"bool"===r.dtype&&(r=Cn(r,"int32"),i=Cn(i,"int32")),Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("Maximum",a)}}),Pi=mn({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:pn(t,"x","mean")},i={axis:e,keepDims:n};return sn.runKernel("Mean",r,i)}});function Li(t,e){if(void 0===e&&(e="float32"),It(t),"complex64"===e){var n=Li(t,"float32"),r=Li(t,"float32");return cr(n,r)}var i=kt(pt(t),e);return sn.makeTensor(i,t,e)}function Bi(t,e){if(void 0===e&&(e="float32"),It(t),"complex64"===e){var n=Bi(t,"float32"),r=Li(t,"float32");return cr(n,r)}var i=Et(pt(t),e);return sn.makeTensor(i,t,e)}var zi=mn({minimum_:function(t,e){var n,r=pn(t,"a","minimum"),i=pn(e,"b","minimum");r=(n=d(tn(r,i),2))[0],i=n[1],"bool"===r.dtype&&(r=Cn(r,"int32"),i=Cn(i,"int32")),Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("Minimum",a)}}),Ui=mn({mirrorPad_:function(t,e,n){ct("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=pn(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ct(e.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(e.length,".")}));for(var i="reflect"===n?1:0,a=function(t){ct(2===e[t].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ct(e[t][0]>=0&&e[t][0]<=r.shape[t]-i&&e[t][1]>=0&&e[t][1]<=r.shape[t]-i,(function(){return"Padding in dimension ".concat(t," cannot be greater than or equal ")+"to ".concat(r.shape[t]-i," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)a(o);var s={paddings:e,mode:n},u={x:r};return sn.runKernel("MirrorPad",u,s)}}),Gi=mn({mod_:function(t,e){var n,r=pn(t,"a","mod"),i=pn(e,"b","mod"),a={a:r=(n=d(tn(r,i),2))[0],b:i=n[1]};return sn.runKernel("Mod",a)}}),Wi=mn({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=gt(e,(t=pn(t,"x","moments")).shape),i=Pi(t,r,n),a=i.shape;n||(a=Wr(i.shape,r));var o=Yr(Si(Cn(t,"float32"),zn(i,a)));return{mean:i,variance:Pi(o,r,n)}}}),Vi=mn({multiRNNCell_:function(t,e,n,r){for(var i=pn(e,"data","multiRNNCell"),a=fn(n,"c","multiRNNCell"),o=fn(r,"h","multiRNNCell"),s=i,u=[],c=0;c<t.length;c++){var l=t[c](s,a[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var h=[],p=[];for(c=0;c<u.length;c+=2)h.push(u[c]),p.push(u[c+1]);return[h,p]}}),ji=mn({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=pn(t,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(a,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var s={logits:1===o?zn(i,[1,-1]):i},u={numSamples:e,seed:n,normalized:r},c=sn.runKernel("Multinomial",s,u);return 1===o?zn(c,[c.size]):c}}),Hi=mn({notEqual_:function(t,e){var n,r=pn(t,"a","notEqual","string_or_numeric"),i=pn(e,"b","notEqual","string_or_numeric");r=(n=d(tn(r,i),2))[0],i=n[1],Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("NotEqual",a)}}),Xi=mn({oneHot_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r=0),void 0===i&&(i="int32"),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));var a={indices:pn(t,"indices","oneHot","int32")},o={dtype:i,depth:e,onValue:n,offValue:r};return sn.runKernel("OneHot",a,o)}}),qi=mn({onesLike_:function(t){var e={x:pn(t,"x","onesLike")};return sn.runKernel("OnesLike",e)}}),Ki=mn({outerProduct_:function(t,e){var n=pn(t,"v1","outerProduct"),r=pn(e,"v2","outerProduct");ct(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var i=zn(n,[-1,1]),a=zn(r,[1,-1]);return jn(i,a)}}),Yi=mn({pad_:function(t,e,n){void 0===n&&(n=0);var r=pn(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:n},a={x:r};return sn.runKernel("PadV2",a,i)}}),Zi=mn({pad1d_:function(t,e,n){return void 0===n&&(n=0),ct(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Yi(t,[e],n)}}),$i=mn({pad2d_:function(t,e,n){return void 0===n&&(n=0),ct(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Yi(t,e,n)}}),Ji=mn({pad3d_:function(t,e,n){return void 0===n&&(n=0),ct(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Yi(t,e,n)}}),Qi=mn({pad4d_:function(t,e,n){return void 0===n&&(n=0),ct(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Yi(t,e,n)}}),ta=mn({spaceToBatchND_:function(t,e,n){var r=pn(t,"x","spaceToBatchND");ct(r.rank>=1+e.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(e.length)})),ct(n.length===e.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length)})),ct(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())}));var i={x:r},a={blockShape:e,paddings:n};return sn.runKernel("SpaceToBatchND",i,a)}}),ea=mn({pool_:function(t,e,n,r,i,a,o){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");var s=pn(t,"x","maxPool"),u=s,c=!1;3===s.rank&&(c=!0,u=zn(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ct(Pn(a,i),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(i,"'")}));var l,h=function(t,e,n,r,i,a,o){void 0===o&&(o="channelsLast");var s,u=d(On(e),2),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));s=[c,l,t[1],t[1]]}return Rn(t,s,n,r,i,void 0,!1,o)}(u.shape,e,a,i,r),p=[h.dilationHeight,h.dilationWidth];l="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([h.filterHeight,h.filterWidth],p):[[0,0],[0,0]];var f=1===p[0]&&1===p[1],m=d(function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),a=t.concat(r,i),o=e.map((function(t,e){return(t-a[e]%t)%t})),s=i.map((function(t,e){return t+o[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,o[e]]}))]}([h.inHeight,h.inWidth],p,l),2),g=m[0],v=m[1],y=f?r:"valid",b=f?u:ta(u,p,g),x=("avg"===n?function(){return Un(b,e,a,y,o)}:function(){return Oi(b,e,a,y,o)})(),w=f?x:Zn(x,p,v);return c?zn(w,[w.shape[1],w.shape[2],w.shape[3]]):w}}),na=mn({prelu_:function(t,e){var n={x:pn(t,"x","prelu"),alpha:pn(e,"alpha","prelu")};return sn.runKernel("Prelu",n)}}),ra=mn({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=pn(t,"x","prod");"bool"===r.dtype&&(r=Cn(r,"int32"));var i={x:r},a={axis:e,keepDims:n};return sn.runKernel("Prod",i,a)}}),ia=mn({raggedGather_:function(t,e,n,r){var i={paramsNestedSplits:t.map((function(t,e){return pn(t,"tensors".concat(e),"raggedGather","int32")})),paramsDenseValues:pn(e,"paramsDenseValues","raggedGather"),indices:pn(n,"indices","raggedGather","int32")},a={outputRaggedRank:r},o=sn.runKernel("RaggedGather",i,a);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}}),aa=mn({raggedRange_:function(t,e,n){var r=pn(t,"starts","raggedRange"),i={starts:r,limits:pn(e,"limits","raggedRange",r.dtype),deltas:pn(n,"deltas","raggedRange",r.dtype)},a=sn.runKernel("RaggedRange",i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}}),oa=mn({raggedTensorToTensor_:function(t,e,n,r,i){var a=pn(t,"shape","raggedTensorToTensor","int32"),o=pn(e,"values","raggedTensorToTensor"),s={shape:a,values:o,defaultValue:pn(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map((function(t,e){return pn(t,"tensors".concat(e),"raggedTensorToTensor","int32")}))},u={rowPartitionTypes:i};return sn.runKernel("RaggedTensorToTensor",s,u)}}),sa=mn({rand_:function(t,e,n){It(t);var r=pt(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=e();return sn.makeTensor(i,t,n)}}),ua={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197;return function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var i=new n(t),a=e&&e.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)}(ua);var ca=ua.exports,la={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)}(la);var ha=la.exports,pa={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)}(pa);var fa=pa.exports,da={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.x&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)}(da);var ma=da.exports,ga={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.X&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)}(ga);var va=ga.exports,ya={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)}(ya);var ba=ya.exports,xa={exports:{}},wa=function(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){if(this instanceof t){var n=[null];return n.push.apply(n,arguments),new(Function.bind.apply(e,n))}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}({__proto__:null,default:{}});!function(t){!function(e,n,r){var i,a=256,o="random",s=r.pow(a,6),u=r.pow(2,52),c=2*u,l=a-1;function h(t,l,h){var v=[],y=m(d((l=1==l?{entropy:!0}:l||{}).entropy?[t,g(n)]:t??function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(t){var r=e.navigator,o=r&&r.plugins;return[+new Date,e,o,e.screen,g(n)]}}(),3),v),b=new p(v),x=function(){for(var t=b.g(6),e=s,n=0;t<u;)t=(t+n)*a,e*=a,n=b.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,m(g(b.S),n),(l.pass||h||function(t,e,n,i){return i&&(i.S&&f(i,b),t.state=function(){return f(b,{})}),n?(r[o]=t,e):t})(x,y,"global"in l?l.global:this==r,l.state)}function p(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=l&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=l&i+1],n=n*a+s[l&(s[i]=s[o=l&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(d(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[l&i]=l&(n^=19*e[l&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(m(r.random(),n),t.exports){t.exports=h;try{i=wa}catch(t){}}else r["seed"+o]=h}("undefined"!=typeof self?self:Zt,[],Math)}(xa);var _a=ca,Sa=ha,Ta=fa,Ea=ma,ka=va,Ia=ba,Aa=xa.exports;Aa.alea=_a,Aa.xor128=Sa,Aa.xorwow=Ta,Aa.xorshift7=Ea,Aa.xor4096=ka,Aa.tychei=Ia;var Na=Aa,Ca=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Na.alea(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,a=void 0,o=void 0;do{o=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),Ra=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=Na.alea(i.toString()),this.randn=new Ca(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,a;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<e||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),Oa=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=1);var i=this;if(this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=Na.alea(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}(),Da=mn({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),It(t),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var a=new Ra(e,n,r,i),o=ar(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Ma=mn({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),It(t),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var a=new Ca(e,n,r,!1,i),o=ar(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Fa=mn({randomStandardNormal_:function(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type ".concat(e));return Ma(t,0,1,e,n)}}),Pa=mn({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32"),It(t);for(var a=ar(t,r),o=new Oa(e,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),La=mn({randomUniformInt_:function(t,e,n,r){return Pa(t,e,n,"int32",r)}});function Ba(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");var i={start:t,stop:e,step:n,dtype:r};return sn.runKernel("Range",{},i)}var za=mn({real_:function(t){var e={input:pn(t,"input","real")};return sn.runKernel("Real",e)}}),Ua=mn({reciprocal_:function(t){var e={x:pn(t,"x","reciprocal")};return sn.runKernel("Reciprocal",e)}}),Ga=mn({relu_:function(t){var e={x:pn(t,"x","relu")};return sn.runKernel("Relu",e)}}),Wa=mn({relu6_:function(t){var e={x:pn(t,"x","relu6")};return sn.runKernel("Relu6",e)}}),Va=mn({reverse_:function(t,e){var n={x:pn(t,"x","reverse")},r={dims:e};return sn.runKernel("Reverse",n,r)}}),ja=mn({reverse1d_:function(t){var e=pn(t,"x","reverse");return ct(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")})),Va(e,0)}}),Ha=mn({reverse2d_:function(t,e){var n=pn(t,"x","reverse");return ct(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),Va(n,e)}}),Xa=mn({reverse3d_:function(t,e){var n=pn(t,"x","reverse");return ct(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),Va(n,e)}}),qa=mn({reverse4d_:function(t,e){var n=pn(t,"x","reverse");return ct(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),Va(n,e)}}),Ka=mn({round_:function(t){var e={x:pn(t,"x","round")};return sn.runKernel("Round",e)}}),Ya=mn({rsqrt_:function(t){var e={x:pn(t,"x","rsqrt","float32")};return sn.runKernel("Rsqrt",e)}}),Za=mn({selu_:function(t){var e={x:pn(t,"x","selu")};return sn.runKernel("Selu",e)}}),$a=mn({separableConv2d_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]),void 0===o&&(o="NHWC");var s=pn(t,"x","separableConv2d"),u=pn(e,"depthwiseFilter","separableConv2d"),c=pn(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=zn(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ct(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),ct(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),ct(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),ct(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),ct(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var p=u.shape[2],f=u.shape[3];ct(c.shape[2]===p*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(p*f,", ")+"but got ".concat(c.shape[2],".")}));var d=Ir(l,u,r,i,o,a),m=dr(d,c,1,"valid",o);return h?zn(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),Ja=mn({sign_:function(t){var e={x:pn(t,"x","sign")};return sn.runKernel("Sign",e)}}),Qa=mn({sin_:function(t){var e={x:pn(t,"x","sin","float32")};return sn.runKernel("Sin",e)}}),to=mn({sinh_:function(t){var e={x:pn(t,"x","sinh")};return sn.runKernel("Sinh",e)}}),eo=mn({slice1d_:function(t,e,n){var r=pn(t,"x","slice1d");return ct(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),qn(r,[e],[n])}}),no=mn({slice2d_:function(t,e,n){var r=pn(t,"x","slice2d");return ct(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),qn(r,e,n)}}),ro=mn({slice3d_:function(t,e,n){var r=pn(t,"x","slice3d");return ct(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),qn(r,e,n)}}),io=mn({slice4d_:function(t,e,n){var r=pn(t,"x","slice4d");return ct(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),qn(r,e,n)}}),ao=mn({softmax_:function(t,e){void 0===e&&(e=-1);var n=pn(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));var r={logits:n},i={dim:e};return sn.runKernel("Softmax",r,i)}}),oo=mn({fft_:function(t){ct("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return sn.runKernel("FFT",e)}}),so=mn({ifft_:function(t){ct("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return sn.runKernel("IFFT",e)}}),uo=mn({irfft_:function(t){var e,n=t.shape[t.shape.length-1],r=t.size/n;if(n<=2){var i=zn(t,[r,n]);e=so(i)}else{var a=[r,2*(n-1)],o=zn(za(t),[r,n]),s=zn(ci(t),[r,n]),u=Va(qn(o,[0,1],[r,n-2]),1),c=Hn(Va(qn(s,[0,1],[r,n-2]),1),qr(-1)),l=Vn([o,u],1),h=Vn([s,c],1);i=zn(cr(l,h),[a[0],a[1]]),e=so(i)}if(e=za(e),3===t.rank&&0!==t.shape[0]){var p=e,f=t.shape[0];e=zn(e,[f,e.shape[0]/f,e.shape[1]]),p.dispose()}return e}}),co=mn({split_:function(t,e,n){void 0===n&&(n=0);var r={x:pn(t,"x","split")},i={numOrSizeSplits:e,axis:n};return sn.runKernel("SplitV",r,i)}}),lo=mn({rfft_:function(t,e){ct("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(t.dtype)}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var a=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=qn(t,a,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=Vn([t,Li(s)],t.shape.length-1),r=e}else n=t;var u=Fr(n),c=zn(cr(n,u),[i,r]),l=oo(c),h=Math.floor(r/2)+1,p=za(l),f=ci(l),d=co(p,[h,r-h],p.shape.length-1),m=co(f,[h,r-h],f.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,zn(cr(d[0],m[0]),g)}}),ho=mn({squaredDifference_:function(t,e){var n,r=pn(t,"a","squaredDifference"),i=pn(e,"b","squaredDifference");r=(n=d(tn(r,i),2))[0],i=n[1],Or(r.shape,i.shape);var a={a:r,b:i};return sn.runKernel("SquaredDifference",a,{})}}),po=mn({squeeze_:function(t,e){var n=pn(t,"x","squeeze","string_or_numeric");return zn(n,function(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:gt(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=a){if(a[o]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==a[o]||a[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}(n.shape,e).newShape)}}),fo=mn({stack_:function(t,e){void 0===e&&(e=0);var n=fn(t,"tensors","stack","string_or_numeric");ct(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&ct(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,i={axis:e};return sn.runKernel("Pack",r,i)}}),mo=mn({step_:function(t,e){void 0===e&&(e=0);var n={x:pn(t,"x","step")},r={alpha:e};return sn.runKernel("Step",n,r)}}),go=mn({stridedSlice_:function(t,e,n,r,i,a,o,s,u){void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0);var c={x:pn(t,"x","stridedSlice","string_or_numeric")},l={begin:e,end:n,strides:r,beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return sn.runKernel("StridedSlice",c,l)}}),vo=mn({tan_:function(t){var e={x:pn(t,"x","tan","float32")};return sn.runKernel("Tan",e)}});function yo(t,e,n){return Xr(t,e,cn(t,n),n)}function bo(t,e){ht(t);var n=cn(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Xr(t,null,n,e)}function xo(t,e,n){if(ht(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=cn(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Xr(t,e,r,n)}function wo(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(i,".");if(n.rank<i)throw new Error(a+" update.rank < ".concat(i,". "));if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < ".concat(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != ".concat(i+t.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==t[o+r])throw new Error(a+" updates.shape[".concat(o+i,"] (").concat(n.shape[o+i],") != shape[").concat(o+i,"] (").concat(t[o+i],")"))}(n,e,t)}var _o=mn({tensorScatterUpdate_:function(t,e,n){var r=pn(t,"tensor","tensorScatterupdate"),i=pn(e,"indices","tensorScatterupdate","int32"),a=pn(n,"updates","tensorScatterupdate");if(wo(a,i,r.shape),r.dtype!==a.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(a.dtype,"."));var o={tensor:r,indices:i,updates:a};return sn.runKernel("TensorScatterUpdate",o,{})}}),So=mn({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=pn(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(i,") ")+"but got ".concat(e));var a={x:r},o={k:e,sorted:n},s=d(sn.runKernel("TopK",a,o),2);return{values:s[0],indices:s[1]}}}),To=mn({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),It(t),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var a=new Ca(e,n,r,!0,i),o=ar(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Eo=mn({unique_:function(t,e){void 0===e&&(e=0);var n=pn(t,"x","unique","string_or_numeric");ct(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},i={axis:e},a=d(sn.runKernel("Unique",r,i),2);return{values:a[0],indices:a[1]}}}),ko=mn({unsortedSegmentSum_:function(t,e,n){var r=pn(t,"x","unsortedSegmentSum"),i=pn(e,"segmentIds","unsortedSegmentSum","int32");ct(dt(n),(function(){return"numSegments must be of dtype int"}));var a={x:r,segmentIds:i},o={numSegments:n};return sn.runKernel("UnsortedSegmentSum",a,o)}}),Io=mn({unstack_:function(t,e){void 0===e&&(e=0);var n=pn(t,"x","unstack","string_or_numeric");ct(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},i={axis:e};return sn.runKernel("Unpack",r,i)}}),Ao=function(t){return h(this,void 0,void 0,(function(){var e,n,r;return p(this,(function(i){switch(i.label){case 0:return[4,(e=pn(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=function(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=ar(t,"int32"),a=ar([n.length,t.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*t.length;a.values.set(o,s)}return a.toTensor()}(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},No=mn({transpose_:function(t,e,n){var r=pn(t,"x","transpose");if(null==e&&(e=r.shape.map((function(t,e){return e})).reverse()),ct(r.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(e,".")})),e.forEach((function(t){ct(t>=0&&t<r.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(e)}))})),r.rank<=1)return r.clone();var i,a={x:r},o={perm:e};return"complex64"===r.dtype?(i=function(){var t=za(r),e=ci(r);return t=sn.runKernel(Ut,{x:t},o),e=sn.runKernel(Ut,{x:e},o),n&&(e=xi(e)),cr(t,e)},sn.tidy(i,undefined)):sn.runKernel(Ut,a,o)}}),Co=mn({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var a,o,s=pn(t,"v","movingAverage"),u=pn(e,"x","movingAverage"),c=pn(n,"decay","movingAverage");o=u,ct((a=s).dtype===o.dtype,(function(){return"The dtypes of the first(".concat(a.dtype,") and")+" second(".concat(o.dtype,") input must match")})),ct(ft(s.shape,u.shape),(function(){return"Shape mismatch in v and x"}));var l=qr(1),h=Si(l,c),p=Hn(Si(u,s),h);if(i){ct(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=pn(r,"step","movingAverage");p=Rr(p,Si(l,Hr(c,f)))}return bn(s,p)}}),Ro=mn({scatterND_:function(t,e,n){It(n);var r=pn(t,"indices","scatterND","int32"),i=pn(e,"updates","scatterND");wo(i,r,n);var a={indices:r,updates:i},o={shape:n};return sn.runKernel("ScatterNd",a,o)}}),Oo=mn({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0),It(n);var i=pn(t,"sparseIndices","sparseToDense","int32"),a=pn(e,"sparseValues","sparseToDense","string_or_numeric"),o=pn(r,"defaultValue","sparseToDense",a.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));var i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(a,"."));var o=e.size;if(0!==e.rank&&(1!==e.rank||o!==i))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(i,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o);var s={sparseIndices:i,sparseValues:a,defaultValue:o},u={outputShape:n};return sn.runKernel("SparseToDense",s,u)}}),Do=mn({gatherND_:function(t,e){var n=pn(e,"indices","gatherND","int32"),r={params:pn(t,"x","gatherND","string_or_numeric"),indices:n};return sn.runKernel("GatherNd",r)}}),Mo=mn({dropout_:function(t,e,n,r){var i=pn(t,"x","dropout");if(ct("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(i.dtype," tensor instead.")})),ct(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(e,".")})),0===e)return t instanceof Ve?i.clone():i;var a=function(t,e){if(null==e)return t.shape.slice();if(ft(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),o=1-e,s=Rr(ai(bn(Pa(a,0,1,"float32",r),o)),o);return Hn(i,s)}});function Fo(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Po(t,e,n){for(var r=1-t%2,i=new Float32Array(t),a=0;a<t;++a){var o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return bo(i,"float32")}var Lo=mn({conv2DBackpropFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC");var s=t;3===t.rank&&(s=zn(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=zn(e,[1,e.shape[0],e.shape[1],e.shape[2]])),ct(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),ct(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),ct(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===a?s.shape[3]:s.shape[1],l="NHWC"===a?u.shape[3]:u.shape[1];ct(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),ct(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),Bn("conv2dDerFilter",i,o);var h={x:s,dy:u},p={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,filterShape:n};return sn.runKernel("Conv2DBackpropFilter",h,p)}});function Bo(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return Hn(t,mo(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function zo(t,e){var n=e,r=function(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}(t.shape,e.shape);return r.length>0&&(n=Zr(n,r)),zn(n,t.shape)}function Uo(t,e,n,r){if("linear"===e)return t;if("relu"===e)return Ga(t);if("elu"===e)return zr(t);if("relu6"===e)return Wa(t);if("prelu"===e)return na(t,n);if("leakyrelu"===e)return fi(t,r);if("sigmoid"===e)return Xn(t);throw new Error("Unknown fused activation ".concat(e,"."))}var Go=function(t,e){return!(t>0)||"linear"===e},Wo=mn({fusedConv2d_:function(t){var e,n=t.x,r=t.filter,i=t.strides,a=t.pad,o=t.dataFormat,s=void 0===o?"NHWC":o,u=t.dilations,c=void 0===u?[1,1]:u,l=t.dimRoundingMode,h=t.bias,p=t.activation,f=void 0===p?"linear":p,m=t.preluActivationWeights,g=t.leakyreluAlpha;if(f=f||"linear",!1===Go(sn.state.gradientDepth,f)){ct("NHWC"===s,(function(){return"Error in fused conv2d: got dataFormat of ".concat(s," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var v=dr(n,r,i,a,s,c,l);return null!=h&&(v=bn(v,h)),Uo(v,f,m,g)}var y=pn(n,"x","conv2d","float32"),b=pn(r,"filter","conv2d","float32"),x=y,w=!1;3===y.rank&&(w=!0,x=zn(y,[1,y.shape[0],y.shape[1],y.shape[2]])),ct(4===x.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(x.rank,".")})),ct(4===b.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(b.rank,".")})),Bn("fused conv2d",a,l);var _="NHWC"===s?x.shape[3]:x.shape[1];ct(b.shape[2]===_,(function(){return"Error in conv2d: depth of input (".concat(_,") must match ")+"input depth for filter ".concat(b.shape[2],".")})),ct(Pn(i,c),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(c,"'")}));var S,T,E=Rn(x.shape,b.shape,i,c,a,l);if(null!=h&&(e=d(tn(S=pn(h,"bias","fused conv2d"),y),1),S=e[0],"NHWC"===s?Or(E.outShape,S.shape):(ct(S.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(S.shape.length,".")})),ct(0===S.shape.length||S.shape[0]===E.outChannels||1===S.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(S.shape,") is not ")+"compatible with the number of output channels "+"(".concat(E.outChannels,")")})))),null!=m){var k=m.shape;if(ct(k.length<=1||3===k.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(k.length,".")})),1===k.length)ct(1===k[0]||k[0]===E.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(k,") is not compatible with the number of output ")+"channels (".concat(E.outChannels,").")}));else if(3===k.length)try{Or(k,E.outShape)}catch(t){var I="Error in fused conv2d: PReLU activation weights (".concat(k,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(E.outShape,").");throw Error(I)}T=pn(m,"prelu weights","fused conv2d")}var A=function(t,e){ct("NHWC"===s,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(s," but only NHWC is currently supported.")}));var n=d(e,4),r=n[0],o=n[1],u=n[2],l=n[3],h=Bo(t,u,f);ct(Fn(c),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(c,"'")}));var p=[gr(o.shape,h,r,i,a),Lo(o,h,r.shape,i,a)];if(null!=l){var m=zo(l,h);p.push(m)}return p},N={x,filter:b,bias:S,preluActivationWeights:T},C={strides:i,pad:a,dataFormat:s,dilations:c,dimRoundingMode:l,activation:f,leakyreluAlpha:g};if(null==h){var R=bi((function(t,e,n){var r=sn.runKernel(Wt,N,C);return n([e,t,r]),w&&(r=zn(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:A}}));return R(x,b)}return bi((function(t,e,n,r){var i=sn.runKernel(Wt,N,C);return r([e,t,i,n]),w&&(i=zn(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:A}}))(x,b,S)}}),Vo=mn({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]);var s=t;3===t.rank&&(s=zn(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=zn(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,filterShape:n};return sn.runKernel("DepthwiseConv2dNativeBackpropFilter",c,l)}}),jo=mn({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]);var s=e,u=!1;3===e.rank&&(u=!0,s=zn(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,inputShape:t},h=sn.runKernel("DepthwiseConv2dNativeBackpropInput",c,l);return u?zn(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),Ho=mn({fusedDepthwiseConv2d_:function(t){var e,n=t.x,r=t.filter,i=t.strides,a=t.pad,o=t.dataFormat,s=void 0===o?"NHWC":o,u=t.dilations,c=void 0===u?[1,1]:u,l=t.dimRoundingMode,h=t.bias,p=t.activation,f=void 0===p?"linear":p,m=t.preluActivationWeights,g=t.leakyreluAlpha;if(!1===Go(sn.state.gradientDepth,f)){var v=Ir(n,r,i,a,s,c,l);return null!=h&&(v=bn(v,h)),Uo(v,f,m,g)}var y=pn(n,"x","depthwiseConv2d","float32"),b=pn(r,"filter","depthwiseConv2d","float32"),x=y,w=!1;3===y.rank&&(w=!0,x=zn(y,[1,y.shape[0],y.shape[1],y.shape[2]])),ct(4===x.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(x.rank,".")})),ct(4===b.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(b.rank,".")})),ct(x.shape[3]===b.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(x.shape[3],") must match the inChannels dimension in ")+"filter ".concat(b.shape[2],".")})),null==c&&(c=[1,1]),ct(Pn(i,c),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(i," and dilations '").concat(c,"'")})),Bn("fused depthwiseConv2d",a,l);var _,S,T=Rn(x.shape,b.shape,i,c,a,l,!0);null!=h&&(e=d(tn(_=pn(h,"bias","fused conv2d"),y),1),_=e[0],Or(T.outShape,_.shape)),null!=m&&(S=pn(m,"prelu weights","fused depthwiseConv2d"));var E=function(t,e){ct(Fn(c),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(c,"'")}));var n=d(e,4),r=n[0],o=n[1],s=n[2],u=n[3],h=Bo(t,s,f),p=jo(o.shape,h,r,i,a,c,l),m=Vo(o,h,r.shape,i,a,c,l);return null!=u?[p,m,zo(_,h)]:[p,m]},k={x,filter:b,bias:_,preluActivationWeights:S},I={strides:i,pad:a,dataFormat:s,dilations:c,dimRoundingMode:l,activation:f,leakyreluAlpha:g};if(null==h){var A=bi((function(t,e,n){var r=sn.runKernel(Vt,k,I);return n([e,t,r]),w&&(r=zn(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:E}}));return A(x,b)}return bi((function(t,e,n,r){var i=sn.runKernel(Vt,k,I);return r([e,t,i,n]),w&&(i=zn(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:E}}))(x,b,_)}}),Xo={__proto__:null,conv2d:Wo,depthwiseConv2d:Ho,matMul:mn({fusedMatMul_:function(t){var e,n=t.a,r=t.b,i=t.transposeA,a=void 0!==i&&i,o=t.transposeB,s=void 0!==o&&o,u=t.bias,c=t.activation,l=void 0===c?"linear":c,h=t.preluActivationWeights,p=t.leakyreluAlpha,f=void 0===p?.2:p;if(!1===Go(sn.state.gradientDepth,l)){var m=jn(n,r,a,s);return null!=u&&(m=bn(m,u)),Uo(m,l,h,f)}var g=pn(n,"a","fused matMul"),v=pn(r,"b","fused matMul");e=d(tn(g,v),2),g=e[0],v=e[1];var y=a?g.shape[g.rank-2]:g.shape[g.rank-1],b=s?v.shape[v.rank-1]:v.shape[v.rank-2],x=a?g.shape[g.rank-1]:g.shape[g.rank-2],w=s?v.shape[v.rank-2]:v.shape[v.rank-1],_=g.shape.slice(0,-2),S=v.shape.slice(0,-2),T=pt(_),E=pt(S);ct(y===b,(function(){return"Error in fused matMul: inner shapes (".concat(y,") and (")+"".concat(b,") of Tensors with shapes ").concat(g.shape," and ")+"".concat(v.shape," and transposeA=").concat(a)+" and transposeB=".concat(s," must match.")}));var k,I,A=Or(g.shape.slice(0,-2),v.shape.slice(0,-2)).concat([x,w]),N=zn(g,a?[T,y,x]:[T,x,y]),C=zn(v,s?[E,w,b]:[E,b,w]);null!=u&&(k=d(tn(k=pn(u,"bias","fused matMul"),g),1)[0],Or(A,k.shape)),null!=h&&(I=pn(h,"prelu weights","fused matMul"));var R=function(t,e){var n,r,i=d(e,4),o=i[0],c=i[1],h=i[2],p=i[3],f=Bo(zn(t,h.shape),h,l);return a||s?!a&&s?(n=jn(f,c,!1,!1),r=jn(f,o,!0,!1)):a&&!s?(n=jn(c,f,!1,!0),r=jn(o,f,!1,!1)):(n=jn(c,f,!0,!0),r=jn(f,o,!0,!0)):(n=jn(f,c,!1,!0),r=jn(o,f,!0,!1)),null!=u?[n,r,zo(p,f)]:[n,r]},O={a:N,b:C,bias:k,preluActivationWeights:I},D={transposeA:a,transposeB:s,activation:l,leakyreluAlpha:f};if(null==u){var M=bi((function(t,e,n){var r=sn.runKernel(Gt,O,D);return n([t,e,r]),{value:zn(r,A),gradFunc:R}}));return M(N,C)}return bi((function(t,e,n,r){var i=sn.runKernel(Gt,O,D);return r([t,e,i,n]),{value:zn(i,A),gradFunc:R}}))(N,C,k)}})},qo=mn({hammingWindow_:function(t){return Po(t,.54,.46)}}),Ko=mn({hannWindow_:function(t){return Po(t,.5,.5)}}),Yo=mn({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var a=0,o=[];a+e<=t.size;)o.push(qn(t,a,e)),a+=n;if(r)for(;a<t.size;){var s=a+e-t.size,u=Vn([qn(t,a,e-s),sr([s],i)]);o.push(u),a+=n}return 0===o.length?xo([],[0,e]):zn(Vn(o),[o.length,e])}}),Zo=mn({stft_:function(t,e,n,r,i){void 0===i&&(i=Ko),null==r&&(r=Fo(e));var a=Yo(t,e,n),o=Hn(a,i(e));return lo(o,r)}}),$o=mn({cropAndResize_:function(t,e,n,r,i,a){void 0===i&&(i="bilinear"),void 0===a&&(a=0);var o=pn(t,"image","cropAndResize"),s=pn(e,"boxes","cropAndResize","float32"),u=pn(n,"boxInd","cropAndResize","int32"),c=s.shape[0];ct(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),ct(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),ct(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),ct(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),ct(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),ct("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was ".concat(i)}));var l={image:o,boxes:s,boxInd:u},h={method:i,extrapolationValue:a,cropSize:r};return sn.runKernel("CropAndResize",l,h)}}),Jo=mn({flipLeftRight_:function(t){var e=pn(t,"image","flipLeftRight","float32");ct(4===e.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")}));var n={image:e};return sn.runKernel("FlipLeftRight",n,{})}}),Qo=mn({grayscaleToRGB_:function(t){var e=pn(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];ct(e.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")})),ct(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,ri(e,i)}}),ts=mn({rgbToGrayscale_:function(t){var e=pn(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];ct(e.rank>=2,(function(){return"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")})),ct(3===r,(function(){return"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")}));var i,a=e.dtype,o=Cn(e,"float32"),s=bo([.2989,.587,.114]);switch(e.rank){case 2:i=Br("ij,j->i",o,s);break;case 3:i=Br("ijk,k->ij",o,s);break;case 4:i=Br("ijkl,l->ijk",o,s);break;case 5:i=Br("ijklm,m->ijkl",o,s);break;case 6:i=Br("ijklmn,n->ijklm",o,s);break;default:throw new Error("Not a valid tensor rank.")}return i=ei(i,-1),Cn(i,a)}}),es=mn({rotateWithOffset_:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=.5);var i=pn(t,"image","rotateWithOffset","float32");ct(4===i.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(i.rank,".")}));var a={image:i},o={radians:e,fillValue:n,center:r};return sn.runKernel("RotateWithOffset",a,o)}});function ns(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);var o=t.shape[0];return n=Math.min(n,o),ct(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),ct(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'")})),ct(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1])})),ct(1===e.rank,(function(){return"scores must be a 1D tensor"})),ct(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0])})),ct(0<=a&&a<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(a,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var rs=mn({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var a=pn(t,"boxes","nonMaxSuppression","float32"),o=pn(e,"scores","nonMaxSuppression","float32"),s=ns(a,o,n,r,i),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:i=s.scoreThreshold};return sn.runKernel("NonMaxSuppressionV3",{boxes:a,scores:o},u)}});function is(t,e,n){var r=function(t,e,n){return function(t,e,n){for(var r=0,i=t.length,a=0,o=!1;r<i;){var s=n(e,t[a=r+(i-r>>>1)]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||as)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function as(t,e){return t>e?1:t<e?-1:0}function os(t,e,n,r,i,a,o,s,u){void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===u&&(u=!1);for(var c=[],l=0;l<e.length;l++)e[l]>i&&c.push({score:e[l],boxIndex:l,suppressBeginIndex:0});c.sort(cs);for(var h=a>0?-.5/a:0,p=[],f=[];p.length<n&&c.length>0;){var g=c.pop(),v=g.score,y=g.boxIndex,b=g.suppressBeginIndex;if(v<i)break;for(var x=!1,w=p.length-1;w>=b;--w){var _=ss(t,y,p[w]);if(_>=r){x=!0;break}if(g.score=g.score*us(r,h,_),g.score<=i)break}g.suppressBeginIndex=p.length,x||(g.score===v?(p.push(y),f.push(g.score)):g.score>i&&is(c,g,cs))}var S=p.length,T=n-S;s&&T>0&&(p.push.apply(p,m([],d(new Array(T).fill(0)),!1)),f.push.apply(f,m([],d(new Array(T).fill(0)),!1)));var E={selectedIndices:p};return o&&(E.selectedScores=f),u&&(E.validOutputs=S),E}function ss(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),f=(s-a)*(u-o),d=(h-c)*(p-l);if(f<=0||d<=0)return 0;var m=Math.max(a,c),g=Math.max(o,l),v=Math.min(s,h),y=Math.min(u,p),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(f+d-b)}function us(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function cs(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}var ls=mn({nonMaxSuppressionWithScore_:function(t,e,n,r,i,a){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0);var o=pn(t,"boxes","nonMaxSuppression"),s=pn(e,"scores","nonMaxSuppression"),u=ns(o,s,n,r,i,a),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},h=sn.runKernel("NonMaxSuppressionV5",c,l);return{selectedIndices:h[0],selectedScores:h[1]}}}),hs=mn({nonMaxSuppressionPadded_:function(t,e,n,r,i,a){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=!1);var o=pn(t,"boxes","nonMaxSuppression"),s=pn(e,"scores","nonMaxSuppression"),u=ns(o,s,n,r,i,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:a},h=sn.runKernel("NonMaxSuppressionV4",c,l);return{selectedIndices:h[0],validOutputs:h[1]}}}),ps=mn({resizeBilinear_:function(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);var i=pn(t,"images","resizeBilinear");ct(3===i.rank||4===i.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(i.rank,".")})),ct(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")})),ct(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var a=i,o=!1;3===i.rank&&(o=!0,a=zn(i,[1,i.shape[0],i.shape[1],i.shape[2]])),d(e,0);var s={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=sn.runKernel("ResizeBilinear",s,u);return o?zn(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),fs=mn({resizeNearestNeighbor_:function(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);var i=pn(t,"images","resizeNearestNeighbor");ct(3===i.rank||4===i.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(i.rank,".")})),ct(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")})),ct("float32"===i.dtype||"int32"===i.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),ct(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var a=i,o=!1;3===i.rank&&(o=!0,a=zn(i,[1,i.shape[0],i.shape[1],i.shape[2]])),d(e,0);var s={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=sn.runKernel("ResizeNearestNeighbor",s,u);return o?zn(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),ds=mn({threshold_:function(t,e,n,r){var i;void 0===e&&(e="binary"),void 0===n&&(n=!1),void 0===r&&(r=.5);var a,o,s,u,c=pn(t,"image","threshold"),l=c.shape[0]*c.shape[1],h=Hn(bo([r]),255);if(ct(3===c.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(c.rank,".")})),ct(3===c.shape[2]||1===c.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(c.shape[2],".")})),ct("int32"===c.dtype||"float32"===c.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(c.dtype,".")})),ct("otsu"===e||"binary"===e,(function(){return"Method must be binary or otsu, but was ".concat(e)})),3===c.shape[2]){a=(i=d(co(c,[1,1,1],-1),3))[0],o=i[1],s=i[2];var p=Hn(a,.2989),f=Hn(o,.587),m=Hn(s,.114);u=bn(bn(p,f),m)}else u=t;"otsu"===e&&(h=function(t,e){for(var n,r,i,a,o,s,u=bo([-1]),c=bo([0]),l=bo([0]),h=0;h<t.size-1;h++){n=qn(t,0,h+1),r=qn(t,h+1),o=Rr(Zr(n),e),s=Rr(Zr(r),e);var p=Zr(Hn(n,Ba(0,n.size)));i=Rr(p,Zr(n));var f=sr(r.shape,n.size),d=bn(Ba(0,r.size),f),m=Hn(r,d);a=Rr(Zr(m),Zr(r));var g=Si(i,a),v=Si(i,a),y=Hn(o,s);l=Hn(Hn(y,g),v);var b=si(l,c);c=Mr(b,l,c),u=Mr(b,bo([h]),u)}return u}(er(Cn(Ka(u),"int32"),yo([]),256),l));var g=n?mi(u,h):si(u,h);return Cn(Hn(g,255),"int32")}}),ms=mn({transform_:function(t,e,n,r,i,a){void 0===n&&(n="nearest"),void 0===r&&(r="constant"),void 0===i&&(i=0);var o=pn(t,"image","transform","float32"),s=pn(e,"transforms","transform","float32");ct(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),ct(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),ct(null==a||2===a.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(a,".")}));var u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return sn.runKernel("Transform",u,c)}}),gs=mn({bandPart_:function(t,e,n){var r=pn(t,"a","bandPart");ct(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var i,a,o=r.shape,s=d(r.shape.slice(-2),2),u=s[0],c=s[1];"number"==typeof e?(ct(e%1==0,(function(){return"bandPart(): numLower must be an integer, got ".concat(e,".")})),ct(e<=u,(function(){return"bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(u,").")})),i=pn(e<0?u:e,"numLower","bandPart")):(ct("int32"===e.dtype,(function(){return"bandPart(): numLower's dtype must be an int32."})),i=Mr(di(e,0),u,zi(e,u))),"number"==typeof n?(ct(n%1==0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")})),ct(n<=c,(function(){return"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(c,").")})),a=pn(n<0?c:n,"numUpper","bandPart")):(ct("int32"===n.dtype,(function(){return"bandPart(): numUpper's dtype must be an int32."})),a=Mr(di(n,0),c,zi(n,c)));var l=zn(Ba(0,u,1,"int32"),[-1,1]),h=Ba(0,c,1,"int32"),p=Si(l,h),f=ki(mi(p,i),ui(p,xi(a))),m=Li([u,c],r.dtype);return zn(fo(Io(zn(r,[-1,u,c])).map((function(t){return Mr(f,t,m)}))),o)}}),vs=mn({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,ct(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){ct(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")}))},i=1;i<t.length;++i)r(i)}else e=!0,t=co(t,t.shape[0],0).map((function(t){return po(t,[0])}));ct(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")}));var a=[],o=t,s=function(t){a.push(sn.tidy((function(){var e=o[t];if(t>0)for(var n=0;n<t;++n){var r=Hn(Zr(Hn(a[n],e)),a[n]);e=Si(e,r)}return Rr(e,Jr(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?fo(a,0):a}});function ys(t,e){return void 0===e&&(e=!1),sn.tidy((function(){ct(2===t.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")}));for(var n=t.shape[0],r=t.shape[1],i=ii(n),a=Wn(t),o=xo([[1]],[1,1]),s=Wn(o),u=n>=r?r:n,c=function(t){var e,u=a,c=s,l=i;e=d(sn.tidy((function(){var e=qn(a,[t,t],[n-t,1]),u=Jr(e),c=qn(a,[t,t],[1,1]),l=Mr(si(c,0),xo([[-1]]),xo([[1]])),h=Si(c,Hn(l,u)),p=Rr(e,h);s=1===p.shape[0]?Wn(o):Vn([o,qn(p,[1,0],[p.shape[0]-1,p.shape[1]])],0);var f=xi(Rr(jn(l,h),u)),d=qn(a,[t,0],[n-t,r]),m=Hn(f,s),g=No(s);if(0===t)a=Si(d,jn(m,jn(g,d)));else{var v=Si(d,jn(m,jn(g,d)));a=Vn([qn(a,[0,0],[t,r]),v],0)}var y=No(m),b=qn(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=Si(b,jn(jn(b,s),y));else{var x=Si(b,jn(jn(b,s),y));i=Vn([qn(i,[0,0],[n,t]),x],1)}return[s,a,i]})),3),s=e[0],a=e[1],i=e[2],en([u,c,l]).forEach((function(t){return t.dispose()}))},l=0;l<u;++l)c(l);return!e&&n>r&&(i=qn(i,[0,0],[n,r]),a=qn(a,[0,0],[r,r])),[i,a]}))}var bs,xs=mn({qr_:function(t,e){if(void 0===e&&(e=!1),ct(t.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank)})),2===t.rank)return ys(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Io(zn(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];return r.forEach((function(t){var n=d(ys(t,e),2),r=n[0],o=n[1];i.push(r),a.push(o)})),[zn(fo(i,0),t.shape),zn(fo(a,0),t.shape)]}});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(bs||(bs={}));var ws=mn({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=bs.SUM_BY_NONZERO_WEIGHTS);var r=pn(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=pn(e,"weights","computeWeightedLoss"));var a=null==i?r:Hn(r,i);if(n===bs.NONE)return a;if(n===bs.SUM)return Zr(a);if(n===bs.MEAN){if(null==i)return Pi(a);var o=r.size/i.size,s=Rr(Zr(a),Zr(i));return o>1?Rr(s,qr(o)):s}if(n===bs.SUM_BY_NONZERO_WEIGHTS){if(null==i)return Rr(Zr(a),qr(r.size));var u=Hn(i,Bi(r.shape)),c=Cn(Zr(Hi(u,qr(0))),"float32");return Rr(Zr(a),c)}throw Error("Unknown reduction: ".concat(n))}}),_s=mn({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=bs.SUM_BY_NONZERO_WEIGHTS);var i=pn(t,"labels","absoluteDifference"),a=pn(e,"predictions","absoluteDifference"),o=null;null!=n&&(o=pn(n,"weights","absoluteDifference")),lt(i.shape,a.shape,"Error in absoluteDifference: ");var s=gn(Si(i,a));return ws(s,o,r)}}),Ss=mn({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=bs.SUM_BY_NONZERO_WEIGHTS);var a=pn(t,"labels","cosineDistance"),o=pn(e,"predictions","cosineDistance"),s=null;null!=r&&(s=pn(r,"weights","cosineDistance")),lt(a.shape,o.shape,"Error in cosineDistance: ");var u=qr(1),c=Si(u,Zr(Hn(a,o),n,!0));return ws(c,s,i)}}),Ts=mn({hingeLoss_:function(t,e,n,r){void 0===r&&(r=bs.SUM_BY_NONZERO_WEIGHTS);var i=pn(t,"labels","hingeLoss"),a=pn(e,"predictions","hingeLoss"),o=null;null!=n&&(o=pn(n,"weights","hingeLoss")),lt(i.shape,a.shape,"Error in hingeLoss: ");var s=qr(1);i=Si(Hn(qr(2),i),s);var u=Ga(Si(s,Hn(i,a)));return ws(u,o,r)}}),Es=mn({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=bs.SUM_BY_NONZERO_WEIGHTS);var a=pn(t,"labels","huberLoss"),o=pn(e,"predictions","huberLoss"),s=null;null!=n&&(s=pn(n,"weights","huberLoss")),lt(a.shape,o.shape,"Error in huberLoss: ");var u=qr(r),c=gn(Si(o,a)),l=zi(c,u),h=Si(c,l),p=bn(Hn(qr(.5),Yr(l)),Hn(u,h));return ws(p,s,i)}}),ks=mn({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=bs.SUM_BY_NONZERO_WEIGHTS);var a=pn(t,"labels","logLoss"),o=pn(e,"predictions","logLoss"),s=null;null!=n&&(s=pn(n,"weights","logLoss")),lt(a.shape,o.shape,"Error in logLoss: ");var u=qr(1),c=qr(r),l=xi(Hn(a,vi(bn(o,c)))),h=Hn(Si(u,a),vi(bn(Si(u,o),c))),p=Si(l,h);return ws(p,s,i)}}),Is=mn({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=bs.SUM_BY_NONZERO_WEIGHTS);var i=pn(t,"labels","meanSquaredError"),a=pn(e,"predictions","meanSquaredError"),o=null;null!=n&&(o=pn(n,"weights","meanSquaredError")),lt(i.shape,a.shape,"Error in meanSquaredError: ");var s=ho(i,a);return ws(s,o,r)}}),As=mn({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=bs.SUM_BY_NONZERO_WEIGHTS);var a=pn(t,"multiClassLabels","sigmoidCrossEntropy"),o=pn(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=pn(n,"weights","sigmoidCrossEntropy")),lt(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=qr(r),c=qr(1),l=qr(.5);a=bn(Hn(a,Si(c,u)),Hn(l,u))}var h=function(t,e){var n=pn(t,"labels","sigmoidCrossEntropyWithLogits"),r=pn(e,"logits","sigmoidCrossEntropyWithLogits");lt(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=Ga(r),a=Hn(r,n),o=yi(ti(xi(gn(r))));return bn(Si(i,a),o)}(a,o);return ws(h,s,i)}}),Ns=mn({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=bs.SUM_BY_NONZERO_WEIGHTS);var a=pn(t,"onehotLabels","softmaxCrossEntropy"),o=pn(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=pn(n,"weights","softmaxCrossEntropy")),lt(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=qr(r),c=qr(1),l=qr(a.shape[1]);a=bn(Hn(a,Si(c,u)),Rr(u,l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));var r=bi((function(t,e,r){var i=Ei(e,[n],!0),a=Si(Cn(e,"float32"),i);r([t,a]);var o=xi(Hn(a,t));return{value:Zr(o,[n]),gradFunc:function(t,e){var r=d(e,2),i=r[0],a=r[1],o=Wr(t.shape,[n]);return[Hn(zn(t,o),Si(Cn(i,"float32"),ti(a))),Hn(zn(t,o),Si(ti(a),Cn(i,"float32")))]}}}));return r(t,e)}(a,o);return ws(h,s,i)}}),Cs=mn({sparseFillEmptyRows_:function(t,e,n,r){var i=pn(t,"indices","sparseFillEmptyRows","int32"),a=pn(e,"values","sparseFillEmptyRows"),o=pn(n,"denseShape","sparseFillEmptyRows","int32"),s=pn(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(2!==i.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(i.shape));if(1!==a.rank)throw new Error("Values should be Tensor1D but received shape ".concat(a.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));var u={indices:i,values:a,denseShape:o,defaultValue:s},c=sn.runKernel("SparseFillEmptyRows",u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}}),Rs=mn({sparseReshape_:function(t,e,n){var r=pn(t,"inputIndices","sparseReshape","int32"),i=pn(e,"inputShape","sparseReshape","int32"),a=pn(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==i.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(i.shape));if(1!==a.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(a.shape));var o={inputIndices:r,inputShape:i,newShape:a},s=sn.runKernel("SparseReshape",o);return{outputIndices:s[0],outputShape:s[1]}}}),Os=mn({sparseSegmentMean_:function(t,e,n){var r=pn(t,"data","sparseSegmentMean"),i=pn(e,"indices","sparseSegmentMean","int32"),a=pn(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(a.shape));var o={data:r,indices:i,segmentIds:a};return sn.runKernel("SparseSegmentMean",o)}}),Ds=mn({sparseSegmentSum_:function(t,e,n){var r=pn(t,"data","sparseSegmentSum"),i=pn(e,"indices","sparseSegmentSum","int32"),a=pn(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(a.shape));var o={data:r,indices:i,segmentIds:a};return sn.runKernel("SparseSegmentSum",o)}}),Ms=mn({stringNGrams_:function(t,e,n,r,i,a,o,s){var u=pn(t,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));var c=pn(e,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:i,rightPad:a,padWidth:o,preserveShortSequences:s},h={data:u,dataSplits:c},p=sn.runKernel("StringNGrams",h,l);return{nGrams:p[0],nGramsSplits:p[1]}}}),Fs={__proto__:null,OP_SCOPE_SUFFIX:dn,abs:gn,acos:vn,acosh:yn,add:bn,addN:xn,all:wn,any:_n,argMax:Sn,argMin:Tn,asin:En,asinh:kn,atan:In,atan2:An,atanh:Nn,avgPool:Un,avgPool3d:Gn,basicLSTMCell:Yn,batchNorm:$n,batchNorm2d:Jn,batchNorm3d:Qn,batchNorm4d:tr,batchToSpaceND:Zn,bincount:er,bitwiseAnd:nr,booleanMaskAsync:function(t,e,n){return h(this,void 0,void 0,(function(){var r,i,a,o,s,u,c,l,h,f,d,m,g;return p(this,(function(p){switch(p.label){case 0:for(r=pn(t,"tensor","boolMask"),i=pn(e,"mask","boolMask","bool"),a=n??0,o=i.rank,s=r.shape,ct(o>0,(function(){return"mask cannot be scalar"})),lt(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=a;c<a+o;c++)u*=s[c];return l=s.slice(0,a).concat([u],s.slice(a+o)),h=zn(r,l),f=zn(i,[-1]),[4,Ao(f)];case 1:return d=p.sent(),m=po(d,[1]),g=oi(h,m,a),t!==r&&r.dispose(),e!==i&&i.dispose(),m.dispose(),h.dispose(),f.dispose(),d.dispose(),[2,g]}}))}))},broadcastArgs:rr,broadcastTo:ir,buffer:ar,cast:Cn,ceil:or,clipByValue:ur,clone:Wn,complex:cr,concat:Vn,concat1d:lr,concat2d:hr,concat3d:pr,concat4d:fr,conv1d:mr,conv2d:dr,conv2dTranspose:vr,conv3d:yr,conv3dTranspose:xr,cos:wr,cosh:_r,cosineWindow:Po,cumprod:Sr,cumsum:Tr,denseBincount:Er,depthToSpace:kr,depthwiseConv2d:Ir,diag:Ar,dilation2d:Nr,div:Rr,divNoNan:Pr,dot:Lr,dropout:Mo,einsum:Br,elu:zr,enclosingPowerOfTwo:Fo,ensureShape:Ur,equal:Dr,erf:Gr,euclideanNorm:Qr,exp:ti,expandDims:ei,expm1:ni,eye:ii,fft:oo,fill:sr,floor:ai,floorDiv:Cr,fused:Xo,gather:oi,gatherND:Do,greater:si,greaterEqual:ui,ifft:so,imag:ci,image:{flipLeftRight:Jo,grayscaleToRGB:Qo,resizeNearestNeighbor:fs,resizeBilinear:ps,rgbToGrayscale:ts,rotateWithOffset:es,cropAndResize:$o,nonMaxSuppression:rs,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),h(this,void 0,void 0,(function(){var a,o,s,u,c,l,h;return p(this,(function(p){switch(p.label){case 0:return a=pn(t,"boxes","nonMaxSuppressionAsync"),o=pn(e,"scores","nonMaxSuppressionAsync"),s=ns(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return u=p.sent(),c=u[0],l=u[1],h=function(t,e,n,r,i){return os(t,e,n,r,i,0)}(c,l,n,r,i).selectedIndices,a!==t&&a.dispose(),o!==e&&o.dispose(),[2,bo(h,"int32")]}}))}))},nonMaxSuppressionWithScore:ls,nonMaxSuppressionWithScoreAsync:function(t,e,n,r,i,a){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0),h(this,void 0,void 0,(function(){var o,s,u,c,l,h,f,d,m;return p(this,(function(p){switch(p.label){case 0:return o=pn(t,"boxes","nonMaxSuppressionAsync"),s=pn(e,"scores","nonMaxSuppressionAsync"),u=ns(o,s,n,r,i,a),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return c=p.sent(),l=c[0],h=c[1],f=function(t,e,n,r,i,a){return os(t,e,n,r,i,a,!0)}(l,h,n,r,i,a),d=f.selectedIndices,m=f.selectedScores,o!==t&&o.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:bo(d,"int32"),selectedScores:bo(m)}]}}))}))},nonMaxSuppressionPadded:hs,nonMaxSuppressionPaddedAsync:function(t,e,n,r,i,a){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=!1),h(this,void 0,void 0,(function(){var o,s,u,c,l,h,f,m,g,v,y,b;return p(this,(function(p){switch(p.label){case 0:return o=pn(t,"boxes","nonMaxSuppressionAsync"),s=pn(e,"scores","nonMaxSuppressionAsync"),u=ns(o,s,n,r,i,null),c=u.maxOutputSize,l=u.iouThreshold,h=u.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return f=d.apply(void 0,[p.sent(),2]),m=f[0],g=f[1],v=function(t,e,n,r,i,a){return os(t,e,n,r,i,0,!1,a,!0)}(m,g,c,l,h,a),y=v.selectedIndices,b=v.validOutputs,o!==t&&o.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:bo(y,"int32"),validOutputs:qr(b,"int32")}]}}))}))},threshold:ds,transform:ms},inTopKAsync:function(t,e,n){return void 0===n&&(n=1),h(this,void 0,void 0,(function(){var r,i,a,o,s,u,c,l,h,f,m,g,v,y;return p(this,(function(p){switch(p.label){case 0:return r=pn(t,"predictions","inTopK"),i=pn(e,"targets","inTopK"),ct(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank)})),ct(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(i.rank)})),lt(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],ct(n>0&&n<=a,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(a,"), but got ").concat(n)})),[4,r.data()];case 1:return o=p.sent(),[4,i.data()];case 2:for(s=p.sent(),u=d([o.length/a,a],2),c=u[0],l=u[1],h=function(t,e){return vt("bool",e)}(0,c),f=0;f<c;f++){for(m=f*l,g=o.subarray(m,m+l),v=[],y=0;y<g.length;y++)v.push({value:g[y],index:y});for(v.sort((function(t,e){return e.value-t.value})),h[f]=0,y=0;y<n;y++)if(v[y].index===s[f]){h[f]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,yo(h,i.shape,"bool")]}}))}))},irfft:uo,isFinite:li,isInf:hi,isNaN:pi,leakyRelu:fi,less:di,lessEqual:mi,linalg:{bandPart:gs,gramSchmidt:vs,qr:xs},linspace:function(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:t,stop:e,num:n};return sn.runKernel("LinSpace",{},r)},localResponseNormalization:gi,log:vi,log1p:yi,logSigmoid:_i,logSoftmax:Ti,logSumExp:Ei,logicalAnd:ki,logicalNot:Ii,logicalOr:Ai,logicalXor:Ni,losses:{absoluteDifference:_s,computeWeightedLoss:ws,cosineDistance:Ss,hingeLoss:Ts,huberLoss:Es,logLoss:ks,meanSquaredError:Is,sigmoidCrossEntropy:As,softmaxCrossEntropy:Ns},lowerBound:function(t,e){return Ri(t,e,"left")},matMul:jn,max:Vr,maxPool:Oi,maxPool3d:Di,maxPoolWithArgmax:Mi,maximum:Fi,mean:Pi,meshgrid:function(t,e,n){var r=(void 0===n?{}:n).indexing,i=void 0===r?"xy":r;if("xy"!==i&&"ij"!==i)throw new TypeError("".concat(i," is not a valid third argument to meshgrid"));if(void 0===t)return[];var a=pn(t,"x","meshgrid",t instanceof Ve?t.dtype:"float32");if(void 0===e)return[a];var o=pn(e,"y","meshgrid",e instanceof Ve?e.dtype:"float32"),s=pt(a.shape),u=pt(o.shape);return"xy"===i?(a=zn(a,[1,-1]),o=zn(o,[-1,1]),[jn(Bi([u,1],a.dtype),a),jn(o,Bi([1,s],o.dtype))]):(a=zn(a,[-1,1]),o=zn(o,[1,-1]),[jn(a,Bi([1,u],a.dtype)),jn(Bi([s,1],o.dtype),o)])},min:jr,minimum:zi,mirrorPad:Ui,mod:Gi,moments:Wi,movingAverage:Co,mul:Hn,multiRNNCell:Vi,multinomial:ji,neg:xi,norm:Jr,notEqual:Hi,oneHot:Xi,ones:Bi,onesLike:qi,op:mn,outerProduct:Ki,pad:Yi,pad1d:Zi,pad2d:$i,pad3d:Ji,pad4d:Qi,pool:ea,pow:Hr,prelu:na,print:function(t,e){void 0===e&&(e=!1),console.log(t.toString(e))},prod:ra,raggedGather:ia,raggedRange:aa,raggedTensorToTensor:oa,rand:sa,randomGamma:Da,randomNormal:Ma,randomStandardNormal:Fa,randomUniform:Pa,randomUniformInt:La,range:Ba,real:za,reciprocal:Ua,relu:Ga,relu6:Wa,reshape:zn,reverse:Va,reverse1d:ja,reverse2d:Ha,reverse3d:Xa,reverse4d:qa,rfft:lo,round:Ka,rsqrt:Ya,scalar:qr,scatterND:Ro,searchSorted:Ri,selu:Za,separableConv2d:$a,setdiff1dAsync:function(t,e){return h(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,c,l,h;return p(this,(function(p){switch(p.label){case 0:return n=pn(t,"x","setdiff1d"),r=pn(e,"y","setdiff1d"),ct(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,").")})),ct(1===n.rank,(function(){return"x should be 1D tensor, but got x (".concat(n.shape,").")})),ct(1===r.rank,(function(){return"y should be 1D tensor, but got y (".concat(r.shape,").")})),[4,n.data()];case 1:return i=p.sent(),[4,r.data()];case 2:for(a=p.sent(),o=new Set(a),s=0,l=0;l<i.length;l++)o.has(i[l])||s++;for(u=new Ue([s],n.dtype),c=new Ue([s],"int32"),l=0,h=0;l<i.length;l++)o.has(i[l])||(u.values[h]=i[l],c.values[h]=l,h++);return[2,[u.toTensor(),c.toTensor()]]}}))}))},sigmoid:Xn,sign:Ja,signal:{hammingWindow:qo,hannWindow:Ko,frame:Yo,stft:Zo},sin:Qa,sinh:to,slice:qn,slice1d:eo,slice2d:no,slice3d:ro,slice4d:io,softmax:ao,softplus:wi,spaceToBatchND:ta,sparse:{sparseFillEmptyRows:Cs,sparseReshape:Rs,sparseSegmentMean:Os,sparseSegmentSum:Ds},sparseToDense:Oo,spectral:{fft:oo,ifft:so,rfft:lo,irfft:uo},split:co,sqrt:Kr,square:Yr,squaredDifference:ho,squeeze:po,stack:fo,step:mo,stridedSlice:go,string:{stringNGrams:Ms,stringSplit:mn({stringSplit_:function(t,e,n){void 0===n&&(n=!0);var r=pn(t,"input","stringSplit","string"),i=pn(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==i.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(i.shape));var a={skipEmpty:n},o={input:r,delimiter:i},s=sn.runKernel("StringSplit",o,a);return{indices:s[0],values:s[1],shape:s[2]}}}),stringToHashBucketFast:mn({stringToHashBucketFast_:function(t,e){var n=pn(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");var i={input:n};return sn.runKernel("StringToHashBucketFast",i,r)}}),staticRegexReplace:mn({staticRegexReplace_:function(t,e,n,r){void 0===r&&(r=!0);var i=pn(t,"input","staticRegexReplace","string"),a={pattern:e,rewrite:n,replaceGlobal:r};return sn.runKernel("StaticRegexReplace",{x:i},a)}})},sub:Si,sum:Zr,tan:vo,tanh:Kn,tensor:yo,tensor1d:bo,tensor2d:xo,tensor3d:function(t,e,n){if(ht(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=cn(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Xr(t,e,r,n)},tensor4d:function(t,e,n){if(ht(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=cn(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Xr(t,e,r,n)},tensor5d:function(t,e,n){if(ht(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=cn(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Xr(t,e,r,n)},tensor6d:function(t,e,n){if(ht(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=cn(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Xr(t,e=e||r,r,n)},tensorScatterUpdate:_o,tile:ri,topk:So,transpose:No,truncatedNormal:To,unique:Eo,unsortedSegmentSum:ko,unstack:Io,upperBound:function(t,e){return Ri(t,e,"right")},variable:function(t,e,n,r){return void 0===e&&(e=!0),sn.makeVariable(t,e,n,r)},where:Mr,whereAsync:Ao,zeros:Li,zerosLike:Fr};function Ps(t,e,n){if(void 0===n&&(n=""),"number"!=typeof t&&"number"!=typeof e){a.util.assert(t.length===e.length,(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}));for(var r=0;r<t.length;r++){var i=t[r],o=e[r];a.util.assert(i<0||o<0||i===o,(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}}}function Ls(t){return"number"!=typeof t&&!t.some((function(t){return t<0}))}function Bs(t,e,n){var r=zs(t,n),i=!Ls(r);if(i&&0===e.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(i&&e.forEach((function(t){r=zs(t.shape,r)})),!Ls(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function zs(t,e){if("number"==typeof t)return e;if("number"==typeof e)return t;if(t.length!==e.length)throw new Error("Incompatible ranks during merge: ".concat(t," vs. ").concat(e));for(var n=[],r=0;r<t.length;++r){var i=t[r],a=e[r];if(i>=0&&a>=0&&i!==a)throw new Error("Incompatible shape during merge: ".concat(t," vs. ").concat(e));n[r]=i>=0?i:a}return n}var Us=function(){function t(t,e,n,r,i,o,s){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=a.scalar(0),a.keep(this.idTensor)}return Object.defineProperty(t.prototype,"id",{get:function(){return this.idTensor.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!1,configurable:!0}),t.prototype.clearAndClose=function(t){this.tensors.forEach((function(e){null!=t&&t.has(e.tensor.id)||e.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||t>=this.size())throw new Error("Tried to read from index ".concat(t,", but array size is: ").concat(this.size()));var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(t," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(t){var e=this;return t.map((function(t){return e.read(t)}))},t.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index ".concat(t,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,",\n          because the value dtype is ").concat(e.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),Ps(this.elementShape,e.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been written."));n.tensor=e,a.keep(e),n.written=!0,this.tensors[t]=n},t.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(t.length," is not the same as tensors size: ").concat(e.length,"."));t.forEach((function(t,r){return n.write(t,e[r])}))},t.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(e));if(t)t=t.slice(0,this.size());else{t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return a.tensor([],[0].concat(this.elementShape));var r=this.readMany(t);return Ps(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),a.stack(r,0)},t.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(t));if(0===this.size())return a.tensor([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return Ps(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),a.concat(r,0)},t.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var n=Math.max.apply(Math,m([],d(t),!1));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(t,a.unstack(e,0))},t.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));var r=0,i=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(t.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var o=0===r?0:e.size/r,s=[];a.tidy((function(){e=a.reshape(e,[1,r,o]);for(var u=0;u<t.length;++u){var c=[0,0===u?0:i[u-1],0],l=[1,t[u],o];s[u]=a.reshape(a.slice(e,c,l),n.elementShape)}return s}));for(var u=[],c=0;c<t.length;c++)u[c]=c;this.writeMany(u,s)},t}(),Gs=function(){function t(t,e,n,r){void 0===r&&(r=-1),this.tensors=t,this.elementShape=e,this.elementDtype=n,null!=t&&t.forEach((function(t){if(n!==t.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(t.dtype));Ps(e,t.shape,"TensorList shape mismatch: "),a.keep(t)})),this.idTensor=a.scalar(0),this.maxNumElements=r,a.keep(this.idTensor)}return Object.defineProperty(t.prototype,"id",{get:function(){return this.idTensor.id},enumerable:!1,configurable:!0}),t.prototype.copy=function(){return new t(m([],d(this.tensors),!1),this.elementShape,this.elementDtype)},t.prototype.clearAndClose=function(t){this.tensors.forEach((function(e){null!=t&&t.has(e.id)||e.dispose()})),this.tensors.length=0,this.idTensor.dispose()},t.prototype.size=function(){return this.tensors.length},t.prototype.stack=function(t,e,n){var r=this;if(void 0===n&&(n=-1),e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));Ps(t,this.elementShape,"TensorList shape mismatch: ");var i=Bs(this.elementShape,this.tensors,t);return a.tidy((function(){var t=r.tensors.map((function(t){return a.reshape(t,i)}));return a.stack(t,0)}))},t.prototype.popBack=function(t,e){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=Bs(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,Ps(r.shape,t,"TensorList shape mismatch: "),a.reshape(r,n)},t.prototype.pushBack=function(t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(Ps(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");a.keep(t),this.tensors.push(t)},t.prototype.resize=function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));var n=new t([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(var r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n},t.prototype.getItem=function(t,e,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(t<0||t>this.tensors.length)throw new Error("Trying to access element ".concat(t," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[t])throw new Error("element at index ".concat(t," is null."));Ps(this.tensors[t].shape,e,"TensorList shape mismatch: ");var r=Bs(this.elementShape,this.tensors,e);return a.reshape(this.tensors[t],r)},t.prototype.setItem=function(t,e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error("Trying to set element ".concat(t," in a list with max ").concat(this.maxNumElements," elements."));Ps(this.elementShape,e.shape,"TensorList shape mismatch: "),a.keep(e),null!=this.tensors[t]&&(this.tensors[t].kept=!1),this.tensors[t]=e},t.prototype.gather=function(t,e,n){var r=this;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));Ps(this.elementShape,n,"TensorList shape mismatch: "),t=t.slice(0,this.size());var i=Bs(this.elementShape,this.tensors,n);return 0===t.length?a.tensor([],[0].concat(i)):a.tidy((function(){var e=t.map((function(t){return a.reshape(r.tensors[t],i)}));return a.stack(e,0)}))},t.prototype.concat=function(t,e){var n=this;if(t&&t!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(t));Ps(this.elementShape,e,"TensorList shape mismatch: ");var r=Bs(this.elementShape,this.tensors,e);return 0===this.size()?a.tensor([],[0].concat(r)):a.tidy((function(){var t=n.tensors.map((function(t){return a.reshape(t,r)}));return a.concat(t,0)}))},t}();function Ws(t,e,n){var r=d(y("fusedOps",t,e,n),2),i=r[0],a=r[1],o="biasadd"===i,s=!o,u="prelu"===a,c="fusedbatchnorm"===i,l=y("numArgs",t,e,n);if(o){if(u&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&o&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var h=y("strides",t,e,n),p=T(t,e,n),f=y("dataFormat",t,e,n).toUpperCase(),m=y("dilations",t,e,n),g=d(y("args",t,e,n),2),v=g[0],b=g[1];return s&&(b=v,v=void 0),{stride:h,pad:p,dataFormat:f,dilations:m,biasArg:v,preluArg:b,activationFunc:a,leakyreluAlpha:y("leakyreluAlpha",t,e,n)}}function Vs(t,e,n){return{boxes:y("boxes",t,e,n),scores:y("scores",t,e,n),maxOutputSize:y("maxOutputSize",t,e,n),iouThreshold:y("iouThreshold",t,e,n),scoreThreshold:y("scoreThreshold",t,e,n),softNmsSigma:y("softNmsSigma",t,e,n)}}var js=function(){function t(t,e){this.keyDType=t,this.valueDType=e,this.handle=a.scalar(0),this.tensorMap=new Map,a.keep(this.handle)}return Object.defineProperty(t.prototype,"id",{get:function(){return this.handle.id},enumerable:!1,configurable:!0}),t.prototype.clearAndClose=function(){this.tensorMap.forEach((function(t){return t.dispose()})),this.tensorMap.clear(),this.handle.dispose()},t.prototype.size=function(){return this.tensorMap.size},t.prototype.tensorSize=function(){return qr(this.size(),"int32")},t.prototype.import=function(t,e){return h(this,void 0,void 0,(function(){var n,r=this;return p(this,(function(i){switch(i.label){case 0:return this.checkKeyAndValueTensor(t,e),[4,t.data()];case 1:return n=i.sent(),this.tensorMap.forEach((function(t){return t.dispose()})),this.tensorMap.clear(),[2,a.tidy((function(){var t=a.unstack(e),i=n.length,o=t.length;a.util.assert(i===o,(function(){return"The number of elements doesn't match, keys has "+"".concat(i," elements, the values has ").concat(o," ")+"elements."}));for(var s=0;s<i;s++){var u=n[s],c=t[s];a.keep(c),r.tensorMap.set(u,c)}return r.handle}))]}}))}))},t.prototype.find=function(t,e){return h(this,void 0,void 0,(function(){var n,r=this;return p(this,(function(i){switch(i.label){case 0:return this.checkKeyAndValueTensor(t,e),[4,t.data()];case 1:return n=i.sent(),[2,a.tidy((function(){for(var t=[],i=0;i<n.length;i++){var o=n[i],s=r.findWithDefault(o,e);t.push(s)}return a.stack(t)}))]}}))}))},t.prototype.findWithDefault=function(t,e){var n=this.tensorMap.get(t);return null!=n?n:e},t.prototype.checkKeyAndValueTensor=function(t,e){if(t.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(t.dtype));if(e.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(e.dtype))},t}();function Hs(t,e,n,r,i){void 0===i&&(i=o.tidy);var s=function(t,e,n){switch(t.category){case"arithmetic":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(y("a",t,e,n),y("b",t,e,n))];case"AddN":return[r.addN(y("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(y("a",t,e,n),y("b",t,e,n))];case"Mul":return[r.mul(y("a",t,e,n),y("b",t,e,n))];case"RealDiv":case"Div":return[r.div(y("a",t,e,n),y("b",t,e,n))];case"DivNoNan":return[r.divNoNan(y("a",t,e,n),y("b",t,e,n))];case"FloorDiv":return[r.floorDiv(y("a",t,e,n),y("b",t,e,n))];case"Sub":return[r.sub(y("a",t,e,n),y("b",t,e,n))];case"Minimum":return[r.minimum(y("a",t,e,n),y("b",t,e,n))];case"Maximum":return[r.maximum(y("a",t,e,n),y("b",t,e,n))];case"Pow":return[r.pow(y("a",t,e,n),y("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(y("a",t,e,n),y("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"basic_math":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"Abs":case"ComplexAbs":return[r.abs(y("x",t,e,n))];case"Acos":return[r.acos(y("x",t,e,n))];case"Acosh":return[r.acosh(y("x",t,e,n))];case"Asin":return[r.asin(y("x",t,e,n))];case"Asinh":return[r.asinh(y("x",t,e,n))];case"Atan":return[r.atan(y("x",t,e,n))];case"Atan2":return[r.atan2(y("x",t,e,n),y("y",t,e,n))];case"Atanh":return[r.atanh(y("x",t,e,n))];case"Ceil":return[r.ceil(y("x",t,e,n))];case"Complex":return[r.complex(y("real",t,e,n),y("imag",t,e,n))];case"Cos":return[r.cos(y("x",t,e,n))];case"Cosh":return[r.cosh(y("x",t,e,n))];case"Elu":return[r.elu(y("x",t,e,n))];case"Erf":return[r.erf(y("x",t,e,n))];case"Exp":return[r.exp(y("x",t,e,n))];case"Expm1":return[r.expm1(y("x",t,e,n))];case"Floor":return[r.floor(y("x",t,e,n))];case"Log":return[r.log(y("x",t,e,n))];case"Log1p":return[r.log1p(y("x",t,e,n))];case"Imag":return[r.imag(y("x",t,e,n))];case"Neg":return[r.neg(y("x",t,e,n))];case"Reciprocal":return[r.reciprocal(y("x",t,e,n))];case"Real":return[r.real(y("x",t,e,n))];case"Relu":return[r.relu(y("x",t,e,n))];case"Round":return[r.round(y("x",t,e,n))];case"Selu":return[r.selu(y("x",t,e,n))];case"Sigmoid":return[r.sigmoid(y("x",t,e,n))];case"Sin":return[r.sin(y("x",t,e,n))];case"Sign":return[r.sign(y("x",t,e,n))];case"Sinh":return[r.sinh(y("x",t,e,n))];case"Softplus":return[r.softplus(y("x",t,e,n))];case"Sqrt":return[r.sqrt(y("x",t,e,n))];case"Square":return[r.square(y("x",t,e,n))];case"Tanh":return[r.tanh(y("x",t,e,n))];case"Tan":return[r.tan(y("x",t,e,n))];case"ClipByValue":return[r.clipByValue(y("x",t,e,n),y("clipValueMin",t,e,n),y("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(y("x",t,e,n))];case"Rsqrt":return[r.rsqrt(b(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(y("x",t,e,n),y("alpha",t,e,n))];case"Prelu":return[r.prelu(y("x",t,e,n),y("alpha",t,e,n))];case"IsNan":return[r.isNaN(b(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(b(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(b(t.inputNames[0],e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"control":return function(t,e,n){return h(void 0,void 0,void 0,(function(){var r,i,o,s,u,c,l,h,f,g,v,x,w,_,S,T,k,I,A,N,C,R,O,D,M,F,P,L,B,z,U,G,W,V,j,H,X,q,K,Y,Z,$,J,Q,tt,et,nt,rt,it,at,ot,st,ut,ct,lt,ht,pt;return p(this,(function(ft){switch(ft.label){case 0:switch(t.op){case"If":case"StatelessIf":return[3,1];case"While":case"StatelessWhile":return[3,3];case"LoopCond":return[3,9];case"Switch":return[3,10];case"Merge":return[3,12];case"Enter":return[3,13];case"Exit":return[3,14];case"NextIteration":return[3,15];case"TensorArrayV3":return[3,16];case"TensorArrayWriteV3":return[3,17];case"TensorArrayReadV3":return[3,18];case"TensorArrayGatherV3":return[3,19];case"TensorArrayScatterV3":return[3,20];case"TensorArrayConcatV3":return[3,21];case"TensorArraySplitV3":return[3,22];case"TensorArraySizeV3":return[3,23];case"TensorArrayCloseV3":return[3,24];case"TensorListSetItem":return[3,25];case"TensorListGetItem":return[3,26];case"TensorListScatterV2":case"TensorListScatter":return[3,27];case"TensorListReserve":case"EmptyTensorList":return[3,28];case"TensorListGather":return[3,29];case"TensorListStack":return[3,30];case"TensorListFromTensor":return[3,31];case"TensorListConcat":case"TensorListConcatV2":return[3,32];case"TensorListPushBack":return[3,33];case"TensorListPopBack":return[3,34];case"TensorListSplit":return[3,35];case"TensorListLength":return[3,36];case"TensorListResize":return[3,37]}return[3,38];case 1:return r=y("thenBranch",t,e,n),i=y("elseBranch",t,e,n),o=y("cond",t,e,n),c=y("args",t,e,n),[4,o.data()];case 2:return(f=ft.sent())[0]?[2,n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap)]:[2,n.functionMap[i].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap)];case 3:return s=y("body",t,e,n),u=y("cond",t,e,n),c=y("args",t,e,n),[4,n.functionMap[u].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap)];case 4:return l=ft.sent(),h=c.map((function(t){return t.id})),[4,l[0].data()];case 5:f=ft.sent(),l.forEach((function(t){t.kept||-1!==h.indexOf(t.id)||t.dispose()})),g=c,v=function(){var t,e,r;return p(this,(function(i){switch(i.label){case 0:return t=g,[4,n.functionMap[s].executeFunctionAsync(g,n.tensorArrayMap,n.tensorListMap)];case 1:return g=i.sent(),e=g.map((function(t){return t.id})),t.forEach((function(t){t.kept||-1!==h.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()})),[4,n.functionMap[u].executeFunctionAsync(g,n.tensorArrayMap,n.tensorListMap)];case 2:return[4,(r=i.sent())[0].data()];case 3:return f=i.sent(),r.forEach((function(t){t.kept||-1!==h.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()})),[2]}}))},ft.label=6;case 6:return f[0]?[5,v()]:[3,8];case 7:return ft.sent(),[3,6];case 8:return[2,g];case 9:return[2,[E(x=y("pred",t,e,n))]];case 10:return x=y("pred",t,e,n),(S=y("data",t,e,n)).kept||(S=E(S)),[4,x.data()];case 11:return[2,ft.sent()[0]?[void 0,S]:[S,void 0]];case 12:return(w=t.inputNames.find((function(t){return void 0!==b(t,e,n)})))?[2,[E(S=b(w,e,n))]]:[2,void 0];case 13:return _=y("frameName",t,e,n),S=y("tensor",t,e,n),n.enterFrame(_),[2,[E(S)]];case 14:return S=y("tensor",t,e,n),n.exitFrame(),[2,[E(S)]];case 15:return S=y("tensor",t,e,n),n.nextIteration(),[2,[E(S)]];case 16:return lt=y("size",t,e,n),T=y("dtype",t,e,n),ot=y("elementShape",t,e,n),k=y("dynamicSize",t,e,n),I=y("clearAfterRead",t,e,n),A=y("identicalElementShapes",t,e,n),N=y("name",t,e,n),C=new Us(N,T,lt,ot,A,k,I),n.addTensorArray(C),[2,[C.idTensor,a.scalar(1)]];case 17:return R=y("tensorArrayId",t,e,n),j=y("index",t,e,n),rt=y("tensor",t,e,n),(O=n.getTensorArray(R.id)).write(j,rt),[2,[O.idTensor]];case 18:return D=y("tensorArrayId",t,e,n),H=y("index",t,e,n),[2,[n.getTensorArray(D.id).read(H)]];case 19:return Z=y("tensorArrayId",t,e,n),$=y("indices",t,e,n),M=y("dtype",t,e,n),[2,[n.getTensorArray(Z.id).gather($,M)]];case 20:return F=y("tensorArrayId",t,e,n),X=y("indices",t,e,n),q=y("tensor",t,e,n),(P=n.getTensorArray(F.id)).scatter(X,q),[2,[P.idTensor]];case 21:return et=y("tensorArrayId",t,e,n),L=n.getTensorArray(et.id),nt=y("dtype",t,e,n),[2,[L.concat(nt)]];case 22:return B=y("tensorArrayId",t,e,n),at=y("tensor",t,e,n),st=y("lengths",t,e,n),(z=n.getTensorArray(B.id)).split(st,at),[2,[z.idTensor]];case 23:return U=y("tensorArrayId",t,e,n),G=n.getTensorArray(U.id),[2,[a.scalar(G.size(),"int32")]];case 24:return W=y("tensorArrayId",t,e,n),(V=n.getTensorArray(W.id)).clearAndClose(),[2,[V.idTensor]];case 25:return ct=y("tensorListId",t,e,n),j=y("index",t,e,n),rt=y("tensor",t,e,n),(ut=n.getTensorList(ct.id)).setItem(j,rt),[2,[ut.idTensor]];case 26:return ct=y("tensorListId",t,e,n),H=y("index",t,e,n),ot=y("elementShape",t,e,n),it=y("elementDType",t,e,n),[2,[(ut=n.getTensorList(ct.id)).getItem(H,ot,it)]];case 27:return X=y("indices",t,e,n),q=y("tensor",t,e,n),ot=y("elementShape",t,e,n),J=y("numElements",t,e,n),ut=function(t,e,n,r){if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var i=Math.max.apply(Math,m([],d(e),!1));if(null!=r&&-1!==r&&i>=r)throw new Error("Max index must be < array size (".concat(i,"  vs. ").concat(r,")"));var o=new Gs([],n,t.dtype,r),s=a.unstack(t,0);return e.forEach((function(t,e){o.setItem(t,s[e])})),o}(q,X,ot,J),n.addTensorList(ut),[2,[ut.idTensor]];case 28:return ot=y("elementShape",t,e,n),tt=y("elementDType",t,e,n),K="TensorListReserve"===t.op?"numElements":"maxNumElements",J=y(K,t,e,n),Y="TensorListReserve"===t.op?-1:J,ut=function(t,e,n,r){return new Gs([],t,e,r)}(ot,tt,0,Y),n.addTensorList(ut),[2,[ut.idTensor]];case 29:return Z=y("tensorListId",t,e,n),$=y("indices",t,e,n),ot=y("elementShape",t,e,n),tt=y("elementDType",t,e,n),[2,[(ut=n.getTensorList(Z.id)).gather($,tt,ot)]];case 30:return ct=y("tensorListId",t,e,n),ot=y("elementShape",t,e,n),tt=y("elementDType",t,e,n),J=y("numElements",t,e,n),[2,[(ut=n.getTensorList(ct.id)).stack(ot,tt,J)]];case 31:return Q=y("tensor",t,e,n),ot=y("elementShape",t,e,n),tt=y("elementDType",t,e,n),ut=function(t,e,n){var r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(t.shape));if(t.dtype!==n)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(n));Ps(t.shape.slice(1),e,"TensorList shape mismatch: ");var i=a.unstack(t);return new Gs(i,e,r)}(Q,ot,tt),n.addTensorList(ut),[2,[ut.idTensor]];case 32:return et=y("tensorListId",t,e,n),ut=n.getTensorList(et.id),nt=y("dtype",t,e,n),ot=y("elementShape",t,e,n),[2,[ut.concat(nt,ot)]];case 33:return ct=y("tensorListId",t,e,n),rt=y("tensor",t,e,n),(ut=n.getTensorList(ct.id)).pushBack(rt),[2,[ut.idTensor]];case 34:return ct=y("tensorListId",t,e,n),ot=y("elementShape",t,e,n),it=y("elementDType",t,e,n),[2,[(ut=n.getTensorList(ct.id)).popBack(ot,it)]];case 35:return at=y("tensor",t,e,n),ot=y("elementShape",t,e,n),st=y("lengths",t,e,n),ut=function(t,e,n){var r=0,i=e.map((function(t){return r+=t}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));for(var o=zs(t.shape.slice(1),n),s=0===r?0:t.size/r,u=a.tidy((function(){var n=[];t=a.reshape(t,[1,r,s]);for(var u=0;u<e.length;++u){var c=[0,0===u?0:i[u-1],0],l=[1,e[u],s];n[u]=a.reshape(a.slice(t,c,l),o)}return t.dispose(),n})),c=new Gs([],n,t.dtype,e.length),l=0;l<u.length;l++)c.setItem(l,u[l]);return c}(at,st,ot),n.addTensorList(ut),[2,[ut.idTensor]];case 36:return ct=y("tensorListId",t,e,n),ut=n.getTensorList(ct.id),[2,[a.scalar(ut.size(),"int32")]];case 37:return ct=y("tensorListId",t,e,n),lt=y("size",t,e,n),ht=n.getTensorList(ct.id),pt=ht.resize(lt),n.addTensorList(pt),[2,[pt.idTensor]];case 38:throw TypeError("Node type ".concat(t.op," is not implemented"))}}))}))}(t,e,n);case"convolution":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"Conv1D":var i=y("stride",t,e,n),a=y("pad",t,e,n),o=y("dataFormat",t,e,n).toUpperCase(),s=y("dilation",t,e,n);return[r.conv1d(y("x",t,e,n),y("filter",t,e,n),i,a,o,s)];case"Conv2D":i=y("strides",t,e,n),a=T(t,e,n),o=y("dataFormat",t,e,n).toUpperCase();var u=y("dilations",t,e,n);return[r.conv2d(y("x",t,e,n),y("filter",t,e,n),[i[1],i[2]],a,o,[u[1],u[2]])];case"_FusedConv2D":var c=Ws(t,e,n),l=(i=c.stride,a=c.pad,o=c.dataFormat,u=c.dilations,c.biasArg),h=c.preluArg,p=c.activationFunc,f=c.leakyreluAlpha;return[r.fused.conv2d({x:y("x",t,e,n),filter:y("filter",t,e,n),strides:[i[1],i[2]],pad:a,dataFormat:o,dilations:[u[1],u[2]],bias:l,activation:p,preluActivationWeights:h,leakyreluAlpha:f})];case"FusedDepthwiseConv2dNative":var d=Ws(t,e,n);return i=d.stride,a=d.pad,o=d.dataFormat,u=d.dilations,l=d.biasArg,h=d.preluArg,p=d.activationFunc,f=d.leakyreluAlpha,[r.fused.depthwiseConv2d({x:y("x",t,e,n),filter:y("filter",t,e,n),strides:[i[1],i[2]],pad:a,dataFormat:o,dilations:[u[1],u[2]],bias:l,activation:p,preluActivationWeights:h,leakyreluAlpha:f})];case"Conv2DBackpropInput":case"Conv2dTranspose":var m=y("outputShape",t,e,n);return i=y("strides",t,e,n),a=T(t,e,n),[r.conv2dTranspose(y("x",t,e,n),y("filter",t,e,n),m,[i[1],i[2]],a)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return i=y("strides",t,e,n),a=T(t,e,n),u=y("dilations",t,e,n),o=y("dataFormat",t,e,n).toUpperCase(),[r.depthwiseConv2d(y("input",t,e,n),y("filter",t,e,n),[i[1],i[2]],a,o,[u[1],u[2]])];case"Conv3D":return i=y("strides",t,e,n),a=y("pad",t,e,n),o=y("dataFormat",t,e,n).toUpperCase(),u=y("dilations",t,e,n),[r.conv3d(y("x",t,e,n),y("filter",t,e,n),[i[1],i[2],i[3]],a,o,[u[1],u[2],u[3]])];case"AvgPool":i=y("strides",t,e,n),a=y("pad",t,e,n);var g=y("kernelSize",t,e,n);return[r.avgPool(y("x",t,e,n),[g[1],g[2]],[i[1],i[2]],a)];case"MaxPool":return i=y("strides",t,e,n),a=y("pad",t,e,n),g=y("kernelSize",t,e,n),[r.maxPool(y("x",t,e,n),[g[1],g[2]],[i[1],i[2]],a)];case"MaxPoolWithArgmax":i=y("strides",t,e,n),a=y("pad",t,e,n),g=y("kernelSize",t,e,n);var v=y("includeBatchInIndex",t,e,n),b=r.maxPoolWithArgmax(y("x",t,e,n),[g[1],g[2]],[i[1],i[2]],a,v);return[b.result,b.indexes];case"AvgPool3D":return i=y("strides",t,e,n),a=y("pad",t,e,n),g=y("kernelSize",t,e,n),[r.avgPool3d(y("x",t,e,n),[g[1],g[2],g[3]],[i[1],i[2],i[3]],a)];case"MaxPool3D":return i=y("strides",t,e,n),a=y("pad",t,e,n),g=y("kernelSize",t,e,n),[r.maxPool3d(y("x",t,e,n),[g[1],g[2],g[3]],[i[1],i[2],i[3]],a)];case"Dilation2D":var x=y("strides",t,e,n),w=(a=y("pad",t,e,n),u=y("dilations",t,e,n),x[1]),_=x[2],S=u[1],E=u[2];return[r.dilation2d(y("x",t,e,n),y("filter",t,e,n),[w,_],a,[S,E],"NHWC")];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"creation":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"Fill":var i=y("shape",t,e,n),a=y("dtype",t,e,n),o=y("value",t,e,n);return[r.fill(i,o,a)];case"LinSpace":var s=y("start",t,e,n),u=y("stop",t,e,n),c=y("num",t,e,n);return[r.linspace(s,u,c)];case"Multinomial":var l=y("logits",t,e,n),h=y("numSamples",t,e,n),p=y("seed",t,e,n);return[r.multinomial(l,h,p)];case"OneHot":var f=y("indices",t,e,n),d=y("depth",t,e,n),m=y("onValue",t,e,n),g=y("offValue",t,e,n);return a=y("dtype",t,e,n),[r.oneHot(f,d,m,g,a)];case"Ones":return[r.ones(y("shape",t,e,n),y("dtype",t,e,n))];case"OnesLike":return[r.onesLike(y("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(y("shape",t,e,n),y("dtype",t,e,n),y("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(y("shape",t,e,n),y("minval",t,e,n),y("maxval",t,e,n),y("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(y("shape",t,e,n),y("minval",t,e,n),y("maxval",t,e,n),y("seed",t,e,n))];case"Range":s=y("start",t,e,n),u=y("stop",t,e,n);var v=y("step",t,e,n);return[r.range(s,u,v,y("dtype",t,e,n))];case"TruncatedNormal":i=y("shape",t,e,n);var b=y("mean",t,e,n),x=y("stdDev",t,e,n);return p=y("seed",t,e,n),[r.truncatedNormal(i,b,x,y("dtype",t,e,n),p)];case"Zeros":return[r.zeros(y("shape",t,e,n),y("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(y("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"dynamic":return function(t,e,n,r,i){return void 0===i&&(i=Fs),h(void 0,void 0,void 0,(function(){var r,a,o,s,u,c,l,h,f,d,m,g;return p(this,(function(p){switch(p.label){case 0:switch(t.op){case"NonMaxSuppressionV5":return[3,1];case"NonMaxSuppressionV4":return[3,3];case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,5];case"Where":return[3,7];case"ListDiff":return[3,9]}return[3,10];case 1:return r=Vs(t,e,n),c=r.boxes,l=r.scores,h=r.maxOutputSize,f=r.iouThreshold,d=r.scoreThreshold,a=r.softNmsSigma,[4,i.image.nonMaxSuppressionWithScoreAsync(c,l,h,f,d,a)];case 2:return[2,[(g=p.sent()).selectedIndices,g.selectedScores]];case 3:return o=Vs(t,e,n),c=o.boxes,l=o.scores,h=o.maxOutputSize,f=o.iouThreshold,d=o.scoreThreshold,s=y("padToMaxOutputSize",t,e,n),[4,i.image.nonMaxSuppressionPaddedAsync(c,l,h,f,d,s)];case 4:return[2,[(g=p.sent()).selectedIndices,g.validOutputs]];case 5:return u=Vs(t,e,n),c=u.boxes,l=u.scores,h=u.maxOutputSize,f=u.iouThreshold,d=u.scoreThreshold,[4,i.image.nonMaxSuppressionAsync(c,l,h,f,d)];case 6:return[2,[p.sent()]];case 7:return m=i.cast(y("condition",t,e,n),"bool"),[4,i.whereAsync(m)];case 8:return g=[p.sent()],m.dispose(),[2,g];case 9:return[2,i.setdiff1dAsync(y("x",t,e,n),y("y",t,e,n))];case 10:throw TypeError("Node type ".concat(t.op," is not implemented"))}}))}))}(t,e,n);case"evaluation":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"LowerBound":var i=y("sortedSequence",t,e,n),a=y("values",t,e,n);return[r.lowerBound(i,a)];case"TopKV2":var o=y("x",t,e,n),s=y("k",t,e,n),u=y("sorted",t,e,n);return[(c=r.topk(o,s,u)).values,c.indices];case"UpperBound":return i=y("sortedSequence",t,e,n),a=y("values",t,e,n),[r.upperBound(i,a)];case"Unique":return o=y("x",t,e,n),[(c=r.unique(o)).values,c.indices];case"UniqueV2":o=y("x",t,e,n);var c,l=y("axis",t,e,n);return[(c=r.unique(o,l)).values,c.indices];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"image":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"ResizeBilinear":var i=y("images",t,e,n),a=y("size",t,e,n),o=y("alignCorners",t,e,n),s=y("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(i,[a[0],a[1]],o,s)];case"ResizeNearestNeighbor":return i=y("images",t,e,n),a=y("size",t,e,n),o=y("alignCorners",t,e,n),s=y("halfPixelCenters",t,e,n),[r.image.resizeNearestNeighbor(i,[a[0],a[1]],o,s)];case"CropAndResize":var u=y("image",t,e,n),c=y("boxes",t,e,n),l=y("boxInd",t,e,n),h=y("cropSize",t,e,n),p=y("method",t,e,n),f=y("extrapolationValue",t,e,n);return[r.image.cropAndResize(u,c,l,h,p,f)];case"ImageProjectiveTransformV3":i=y("images",t,e,n);var d=y("transforms",t,e,n),m=y("outputShape",t,e,n),g=y("fillValue",t,e,n),v=y("interpolation",t,e,n),b=y("fillMode",t,e,n);return[r.image.transform(i,d,v.toLowerCase(),b.toLowerCase(),g,m)];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"graph":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var i=y("default",t,e,n);return[b(t.name,e,n)||i];case"Placeholder":return[b(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[E(y("x",t,e,n))];case"IdentityN":return y("x",t,e,n).map((function(t){return E(t)}));case"Shape":return[r.tensor1d(y("x",t,e,n).shape,"int32")];case"ShapeN":return y("x",t,e,n).map((function(t){return r.tensor1d(t.shape)}));case"Size":return[r.scalar(y("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(y("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":var a=y("x",t,e,n),o=y("data",t,e,n),s=y("message",t,e,n),u=y("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[a];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"logical":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"Equal":return[r.equal(y("a",t,e,n),y("b",t,e,n))];case"NotEqual":return[r.notEqual(y("a",t,e,n),y("b",t,e,n))];case"Greater":return[r.greater(y("a",t,e,n),y("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(y("a",t,e,n),y("b",t,e,n))];case"Less":return[r.less(y("a",t,e,n),y("b",t,e,n))];case"LessEqual":return[r.lessEqual(y("a",t,e,n),y("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(y("a",t,e,n),y("b",t,e,n))];case"LogicalNot":return[r.logicalNot(y("a",t,e,n))];case"LogicalOr":return[r.logicalOr(y("a",t,e,n),y("b",t,e,n))];case"Select":case"SelectV2":return[r.where(y("condition",t,e,n),y("a",t,e,n),y("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(y("a",t,e,n),y("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"matrices":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(y("a",t,e,n),y("b",t,e,n),y("transposeA",t,e,n),y("transposeB",t,e,n))];case"Einsum":return[r.einsum.apply(r,m([y("equation",t,e,n)],d(y("tensors",t,e,n)),!1))];case"Transpose":return[r.transpose(y("x",t,e,n),y("perm",t,e,n))];case"_FusedMatMul":var i=d(y("fusedOps",t,e,n),2),a=i[0],o=i[1],s="biasadd"===a,u="prelu"===o,c=y("numArgs",t,e,n),l=y("leakyreluAlpha",t,e,n);if(s){if(u&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var h=d(y("args",t,e,n),2),p=h[0],f=h[1];return[r.fused.matMul({a:y("a",t,e,n),b:y("b",t,e,n),transposeA:y("transposeA",t,e,n),transposeB:y("transposeB",t,e,n),bias:p,activation:o,preluActivationWeights:f,leakyreluAlpha:l})];case"MatrixBandPart":return[r.linalg.bandPart(y("a",t,e,n),y("numLower",t,e,n),y("numUpper",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"normalization":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"EuclideanNorm":return[r.euclideanNorm(y("x",t,e,n),y("axis",t,e,n),y("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(y("x",t,e,n),y("mean",t,e,n),y("variance",t,e,n),y("offset",t,e,n),y("scale",t,e,n),y("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(y("x",t,e,n),y("radius",t,e,n),y("bias",t,e,n),y("alpha",t,e,n),y("beta",t,e,n))];case"Softmax":return[r.softmax(y("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(y("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"ragged":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"RaggedGather":var i=r.raggedGather(y("paramsNestedSplits",t,e,n),y("paramsDenseValues",t,e,n),y("indices",t,e,n),y("outputRaggedRank",t,e,n)),a=i.outputNestedSplits,o=i.outputDenseValues;return a.concat(o);case"RaggedRange":var s=r.raggedRange(y("starts",t,e,n),y("limits",t,e,n),y("splits",t,e,n));return[s.rtNestedSplits,s.rtDenseValues];case"RaggedTensorToTensor":return[r.raggedTensorToTensor(y("shape",t,e,n),y("values",t,e,n),y("defaultValue",t,e,n),y("rowPartitionTensors",t,e,n),y("rowPartitionTypes",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"reduction":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"Max":var i=y("axis",t,e,n),a=y("keepDims",t,e,n);return[r.max(y("x",t,e,n),i,a)];case"Mean":return i=y("axis",t,e,n),a=y("keepDims",t,e,n),[r.mean(y("x",t,e,n),i,a)];case"Min":return i=y("axis",t,e,n),a=y("keepDims",t,e,n),[r.min(y("x",t,e,n),i,a)];case"Sum":return i=y("axis",t,e,n),a=y("keepDims",t,e,n),[r.sum(y("x",t,e,n),i,a)];case"All":return i=y("axis",t,e,n),a=y("keepDims",t,e,n),[r.all(y("x",t,e,n),i,a)];case"Any":return i=y("axis",t,e,n),a=y("keepDims",t,e,n),[r.any(y("x",t,e,n),i,a)];case"ArgMax":return i=y("axis",t,e,n),[r.argMax(y("x",t,e,n),i)];case"ArgMin":return i=y("axis",t,e,n),[r.argMin(y("x",t,e,n),i)];case"Prod":return i=y("axis",t,e,n),a=y("keepDims",t,e,n),[r.prod(y("x",t,e,n),i,a)];case"Cumprod":i=y("axis",t,e,n);var o=y("exclusive",t,e,n),s=y("reverse",t,e,n);return[r.cumprod(y("x",t,e,n),i,o,s)];case"Cumsum":return i=y("axis",t,e,n),o=y("exclusive",t,e,n),s=y("reverse",t,e,n),[r.cumsum(y("x",t,e,n),i,o,s)];case"Bincount":var u=y("x",t,e,n),c=y("weights",t,e,n),l=y("size",t,e,n);return[r.bincount(u,c,l)];case"DenseBincount":var h=y("x",t,e,n),p=y("weights",t,e,n),f=y("size",t,e,n),d=y("binaryOutput",t,e,n);return[r.denseBincount(h,p,f,d)];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"slice_join":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"ConcatV2":case"Concat":var i=y("n",t,e,n),o=y("axis",t,e,n),s=y("tensors",t,e,n);return s=s.slice(0,i),[r.concat(s,o)];case"Gather":var u=y("x",t,e,n),c=y("indices",t,e,n);return[r.gather(u,r.cast(c,"int32"),0)];case"GatherV2":o=y("axis",t,e,n);var l=y("batchDims",t,e,n);return u=y("x",t,e,n),c=y("indices",t,e,n),[r.gather(u,r.cast(c,"int32"),o,l)];case"Reverse":for(var h=y("dims",t,e,n),p=(o=[],0);p<h.length;p++)h[p]&&o.push(p);return u=y("x",t,e,n),[r.reverse(u,o)];case"ReverseV2":return o=y("axis",t,e,n),u=y("x",t,e,n),[r.reverse(u,o)];case"Slice":var f=y("begin",t,e,n),d=y("size",t,e,n);return[r.slice(y("x",t,e,n),f,d)];case"StridedSlice":f=y("begin",t,e,n);var m=y("end",t,e,n),g=y("strides",t,e,n),v=y("beginMask",t,e,n),b=y("endMask",t,e,n),x=y("ellipsisMask",t,e,n),w=y("newAxisMask",t,e,n),_=y("shrinkAxisMask",t,e,n),S=y("x",t,e,n);return[r.stridedSlice(S,f,m,g,v,b,x,w,_)];case"Pack":return a.tidy((function(){var i=y("axis",t,e,n),o=y("tensors",t,e,n),s=o[0].shape,u=r.squeeze(o[0]).shape,c=o.map((function(t){var e=a.util.arraysEqual(t.shape,s);if(!e&&!a.util.arraysEqual(r.squeeze(t).shape,u))throw new Error("the input tensors shape does not match");return e?t:r.reshape(t,s)}));return[r.stack(c,i)]}));case"Unpack":return o=y("axis",t,e,n),S=y("tensor",t,e,n),r.unstack(S,o);case"Tile":var T=y("reps",t,e,n);return[r.tile(y("x",t,e,n),T)];case"Split":case"SplitV":o=y("axis",t,e,n);var E=y("numOrSizeSplits",t,e,n);return S=y("x",t,e,n),r.split(S,E,o);case"ScatterNd":c=y("indices",t,e,n);var k=y("values",t,e,n),I=y("shape",t,e,n);return[r.scatterND(c,k,I)];case"GatherNd":var A=y("x",t,e,n);return c=y("indices",t,e,n),[r.gatherND(A,c)];case"SparseToDense":c=y("sparseIndices",t,e,n),I=y("outputShape",t,e,n);var N=y("sparseValues",t,e,n),C=y("defaultValue",t,e,n);return[r.sparseToDense(c,N,I,N.dtype===C.dtype?C:r.cast(C,N.dtype))];case"TensorScatterUpdate":return c=y("indices",t,e,n),k=y("values",t,e,n),S=y("tensor",t,e,n),[r.tensorScatterUpdate(S,c,k)];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"sparse":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"SparseFillEmptyRows":var i=r.sparse.sparseFillEmptyRows(y("indices",t,e,n),y("values",t,e,n),y("denseShape",t,e,n),y("defaultValue",t,e,n));return[i.outputIndices,i.outputValues,i.emptyRowIndicator,i.reverseIndexMap];case"SparseReshape":var a=r.sparse.sparseReshape(y("inputIndices",t,e,n),y("inputShape",t,e,n),y("newShape",t,e,n));return[a.outputIndices,a.outputShape];case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(y("data",t,e,n),y("indices",t,e,n),y("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(y("data",t,e,n),y("indices",t,e,n),y("segmentIds",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"spectral":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"FFT":return[r.fft(y("x",t,e,n))];case"IFFT":return[r.ifft(y("x",t,e,n))];case"RFFT":return[r.rfft(y("x",t,e,n))];case"IRFFT":return[r.irfft(y("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"string":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(y("input",t,e,n),y("pattern",t,e,n),y("rewrite",t,e,n),y("replaceGlobal",t,e,n))];case"StringNGrams":var i=r.string.stringNGrams(y("data",t,e,n),y("dataSplits",t,e,n),y("separator",t,e,n),y("nGramWidths",t,e,n),y("leftPad",t,e,n),y("rightPad",t,e,n),y("padWidth",t,e,n),y("preserveShortSequences",t,e,n));return[i.nGrams,i.nGramsSplits];case"StringSplit":var a=r.string.stringSplit(y("input",t,e,n),y("delimiter",t,e,n),y("skipEmpty",t,e,n));return[a.indices,a.values,a.shape];case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(y("input",t,e,n),y("numBuckets",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"transformation":return i((function(){return function(t,e,n,r){switch(void 0===r&&(r=Fs),t.op){case"Cast":return[r.cast(y("x",t,e,n),y("dtype",t,e,n))];case"ExpandDims":var i=y("axis",t,e,n);return[r.expandDims(y("x",t,e,n),i)];case"Squeeze":return i=y("axis",t,e,n),[r.squeeze(y("x",t,e,n),i)];case"Reshape":return[r.reshape(y("x",t,e,n),y("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(y("x",t,e,n),y("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(y("x",t,e,n),y("padding",t,e,n),y("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(y("x",t,e,n),y("padding",t,e,n),y("constantValue",t,e,n))];case"SpaceToBatchND":var a=y("blockShape",t,e,n),o=y("paddings",t,e,n);return[r.spaceToBatchND(y("x",t,e,n),a,o)];case"BatchToSpaceND":a=y("blockShape",t,e,n);var s=y("crops",t,e,n);return[r.batchToSpaceND(y("x",t,e,n),a,s)];case"DepthToSpace":var u=y("blockSize",t,e,n),c=y("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(y("x",t,e,n),u,c)];case"BroadcastTo":return[r.broadcastTo(y("x",t,e,n),y("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(y("s0",t,e,n),y("s1",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"hash_table":return function(t,e,n,r){return h(void 0,void 0,void 0,(function(){var i,a,o,s,u,c,l,h;return p(this,(function(p){switch(p.label){case 0:switch(t.op){case"HashTable":case"HashTableV2":return[3,1];case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":return[3,2];case"LookupTableFind":case"LookupTableFindV2":return[3,4];case"LookupTableSize":case"LookupTableSizeV2":return[3,6]}return[3,7];case 1:return null!=(i=r.getHashTableHandleByName(t.name))?[2,[i]]:(a=y("keyDType",t,e,n),o=y("valueDType",t,e,n),h=new js(a,o),r.addHashTable(t.name,h),[2,[h.handle]]);case 2:return l=y("tableHandle",t,e,n,r),u=y("keys",t,e,n),s=y("values",t,e,n),[4,(h=r.getHashTableById(l.id)).import(u,s)];case 3:case 5:return[2,[p.sent()]];case 4:return l=y("tableHandle",t,e,n,r),u=y("keys",t,e,n),c=y("defaultValue",t,e,n),[4,(h=r.getHashTableById(l.id)).find(u,c)];case 6:return l=y("tableHandle",t,e,n,r),[2,[(h=r.getHashTableById(l.id)).tensorSize()]];case 7:throw TypeError("Node type ".concat(t.op," is not implemented"))}}))}))}(t,e,n,r);case"custom":var o=v(t.op);if(o&&o.customExecutor)return o.customExecutor(new ot(t,e,n));throw TypeError("Custom op ".concat(t.op," is not registered."));default:throw TypeError("Unknown op '".concat(t.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return o.util.isPromise(s)?s.then((function(t){return[].concat(t)})):[].concat(s)}var Xs=function(){function t(t,e,n,r,i){void 0===t&&(t={}),void 0===e&&(e={}),void 0===n&&(n={}),void 0===r&&(r={}),this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!1,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":"".concat(t.frameName,"-").concat(t.iterationId)})).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},t.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},t.prototype.addTensorList=function(t){this.tensorListMap[t.id]=t},t.prototype.getTensorList=function(t){return this.tensorListMap[t]},t.prototype.dispose=function(t){for(var e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(var e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)},t}();function qs(t,e,n,r){var i=new Set,a=[],o=null,s=null,u=new Set,c=new Set(Object.keys(t).map((function(t){return S(t)[0]})));r=r||[];for(var l=new Set(r.map((function(t){return S(t.name)[0]}))),h=m([],d(e),!1);h.length>0;){var p=h.pop();(Js(p)||Qs(p)||tu(p))&&null==o&&(s=(o=p).children.map((function(t){return t.name})).filter((function(t){return i.has(t)}))),i.add(p.name),null==n[p.name]&&(c.has(p.name)||l.has(p.name)||(0!==p.inputs.length?p.inputs.forEach((function(t){u.has(t.name)||(u.add(t.name),h.push(t))})):a.push(p.name)))}return{inputs:t,outputs:e,usedNodes:i,missingInputs:a,dynamicNode:o,syncInputs:s}}var Ks=function(t){function e(e){return t.call(this,"NodesExecutionOrderError: ".concat(e))||this}return l(e,t),e}(Error),Ys=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Zs=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),$s=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Js(t){return Ys.has(t.op)}function Qs(t){return Zs.has(t.op)}function tu(t){return $s.has(t.op)}var eu=function(){function t(e,n){var r=this;this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((function(n){r._functionExecutorMap[n]=new t(e.functions[n],r)}))}return Object.defineProperty(t.prototype,"weightIds",{get:function(){return this.parent?this.parent.weightIds:this._weightIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"functionExecutorMap",{get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weightMap",{get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(t){var e=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this._weightIds=[].concat.apply([],m([],d(e),!1)),this._weightMap=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resourceManager",{set:function(t){this._resourceManager=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this._inputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this._inputs.map((function(t){return t.signatureKey||t.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this._outputs.map((function(t){var e=t.signatureKey||t.name;return t.defaultOutput?"".concat(e,":").concat(t.defaultOutput):e}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"functions",{get:function(){var t=this;return Object.keys(this._functions).reduce((function(e,n){return e[n]=t._functions[n].signature,e}),{})},enumerable:!1,configurable:!0}),t.prototype.getCompilationKey=function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)},t.prototype.compile=function(t,e){var n=qs(t,e,this.weightMap,this._initNodes),r=n.missingInputs,i=n.dynamicNode,a=n.syncInputs;if(null!=i)throw new Error("This execution contains the node '".concat(i.name,"', which has ")+"the dynamic op '".concat(i.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(a,"]"));if(r.length>0){var o=e.map((function(t){return t.name})),s=Object.keys(t);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(r,"]"))}var u=function(t,e){var n,r,i,a,o,s,u=e.usedNodes,c=e.inputs,l=Object.keys(c).map((function(t){return S(t)[0]})).map((function(e){return t.nodes[e]})),h=t.initNodes||[],p=function(t){return u.has("string"==typeof t?t:t.name)};function g(t){return m([],d(new Map(t.map((function(t){return[t.name,t]}))).values()),!1)}var v=g(m(m(m([],d(l),!1),d(t.weights),!1),d(h),!1)).filter(p),y=g(m(m([],d(v),!1),d(Object.values(t.nodes)),!1)).filter(p),b=new Map(y.map((function(t){return[t.name,t]}))),x={};try{for(var w=f(y),_=w.next();!_.done;_=w.next()){x[(N=_.value).name]=x[N.name]||0;try{for(var T=(i=void 0,f(N.children)),E=T.next();!E.done;E=T.next())p(O=E.value)||(x[O.name]=Number.POSITIVE_INFINITY),x[O.name]=(x[O.name]||0)+1}catch(t){i={error:t}}finally{try{E&&!E.done&&(a=T.return)&&a.call(T)}finally{if(i)throw i.error}}}}catch(t){n={error:t}}finally{try{_&&!_.done&&(r=w.return)&&r.call(w)}finally{if(n)throw n.error}}for(var k=Object.entries(x).filter((function(t){return 0===d(t,2)[1]})).map((function(t){return d(t,1)[0]})),I=m([],d(k),!1);k.length>0;){var A=k.pop(),N=b.get(A);try{for(var C=(o=void 0,f(N.children.filter(p))),R=C.next();!R.done;R=C.next()){var O;0==--x[(O=R.value).name]&&(I.push(O.name),k.push(O.name))}}catch(t){o={error:t}}finally{try{R&&!R.done&&(s=C.return)&&s.call(C)}finally{if(o)throw o.error}}}var D=function(t,e){for(var n,r,i=new Map(t.map((function(t){return[t.name,t]}))),a=e.map((function(t){return t.name})),o=new Set(a);a.length>0;){var s=a.pop(),u=i.get(s);try{for(var c=(n=void 0,f(u.children)),l=c.next();!l.done;l=c.next()){var h=l.value;i.has(h.name)&&!o.has(h.name)&&(o.add(h.name),a.push(h.name))}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}return t.filter((function(t){return o.has(t.name)}))}(I.map((function(t){return b.get(t)})),v);return function(t,e){var n,r,i,a,o,s,u=new Map(t.map((function(t,e){return[t.name,e]}))),c=new Set(e.map((function(t){return t.name}))),l=function(t){return c.has("string"==typeof t?t:t.name)},h=new Set(t.map((function(t){return t.name}))),p=function(t){return h.has("string"==typeof t?t:t.name)};try{for(var d=f(t),m=d.next();!m.done;m=d.next()){var g=m.value;try{for(var v=(i=void 0,f(g.children.filter(p))),y=v.next();!y.done;y=v.next()){var b=y.value;if(!u.has(b.name))throw new Ks("Child ".concat(b.name," of node ").concat(g.name," is unreachable."));if(u.get(g.name)>u.get(b.name))throw new Ks("Node ".concat(g.name," is scheduled to run after its child ").concat(b.name,"."))}}catch(t){i={error:t}}finally{try{y&&!y.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}if(!l(g))try{for(var x=(o=void 0,f(g.inputs)),w=x.next();!w.done;w=x.next()){var _=w.value;if(!u.has(_.name))throw new Ks("Input ".concat(_.name," of node ").concat(g.name," is unreachable."));if(u.get(_.name)>u.get(g.name))throw new Ks("Node ".concat(g.name," is scheduled to run before its input ").concat(_.name,"."))}}catch(t){o={error:t}}finally{try{w&&!w.done&&(s=x.return)&&s.call(x)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{m&&!m.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}(D,v),D}(this.graph,n),c=function(t){for(var e=new Map(t.map((function(t,e){return[t.name,e]}))),n=Number.MAX_SAFE_INTEGER,r=t.map((function(t,e){return Js(t)?n:e})),i=function(t){var n=r[e.get(t.name)];return n??-1},a=t.map((function(t,e){return t.children.map(i).reduce((function(t,e){return Math.max(t,e)}),r[e])})),o=new Map,s=0;s<t.length;++s){var u=a[s];if(u!==n){var c=t[s],l=t[u];o.has(l.name)||o.set(l.name,[]),o.get(l.name).push(c)}}return o}(u);return{orderedNodes:u,nodeLiveUntilMap:c}},t.prototype.cloneAndKeepTensor=function(t){if(null==t)return null;var e=t.clone();return a.keep(e),e},t.prototype.cloneTensorList=function(t){var e=this;return t?t.map((function(t){return e.cloneAndKeepTensor(t)})):null},t.prototype.cloneTensorMap=function(t){var e=this;return Object.fromEntries(Object.entries(t).map((function(t){var n=d(t,2),r=n[0],i=n[1];return[r,e.cloneTensorList(i)]})))},t.prototype.execute=function(t,e){var n=this;this.disposeIntermediateTensors(),t=this.mapInputs(t);var r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);var i=r.map((function(t){return n.graph.nodes[S(t)[0]]})),o=e.map((function(t){return S(t)[0]})),s=new Set(o),u=o.map((function(t){return n.graph.nodes[t]}));0===u.length&&(u=this._outputs);var c=this.getCompilationKey(i,u),l=this.compiledMap.get(c);null==l&&(l=this.compile(t,u),this.compiledMap.set(c,l));try{this.keepIntermediateTensors=a.env().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(t){this.keepIntermediateTensors=!1,console.warn(t.message)}var h={},p={};return a.tidy((function(){var r,i,o=new Xs(n.weightMap,h,p,n.functionExecutorMap,n.parseNodeNameCache),u=Object.assign({},n.weightMap);n.keepIntermediateTensors&&(n.clonedTensorsMap=n.cloneTensorMap(n.weightMap)),Object.keys(t).forEach((function(e){var r=d(S(e,o),2),i=r[0],a=[];a[r[1]]=t[e],u[i]=a,n.keepIntermediateTensors&&(n.clonedTensorsMap[i]=n.cloneTensorList(a))}));var c=n.getFrozenTensorIds(u),m=l.orderedNodes,g=l.nodeLiveUntilMap;try{for(var v=f(m),y=v.next();!y.done;y=v.next()){var x=y.value;if(!u[x.name]){var w=Hs(x,u,o,n._resourceManager);if(a.util.isPromise(w))throw new Error("The execution of the op '".concat(x.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");u[x.name]=w,n.keepIntermediateTensors&&(n.clonedTensorsMap[x.name]=n.cloneTensorList(w)),n.checkTensorForDisposalWithNodeLiveUntilInfo(x,u,o,c,s,g.get(x.name))}}}catch(t){r={error:t}}finally{try{y&&!y.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}return null==n.parent&&o.dispose(c),e.map((function(t){return b(t,u,o)}))}))},t.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)},t.prototype.checkTensorForDisposal=function(t,e,n,r,i,a,o){var s,u,c,l,h,p;if(!Js(e)&&!a.has(t)){try{for(var d=f(n[t]),m=d.next();!m.done;m=d.next())null!=(S=m.value)&&(o[S.id]=(o[S.id]||0)+e.children.length)}catch(t){s={error:t}}finally{try{m&&!m.done&&(u=d.return)&&u.call(d)}finally{if(s)throw s.error}}try{for(var g=f(e.inputs),v=g.next();!v.done;v=g.next()){var y=v.value;if(!Js(y)){var b=x(y.name,n,r);if(null!=b)try{for(var w=(h=void 0,f(b)),_=w.next();!_.done;_=w.next()){var S;if((S=_.value)&&!S.kept&&!i.has(S.id)){var T=o[S.id];1===T?(S.dispose(),delete o[S.id]):null!=T&&o[S.id]--}}}catch(t){h={error:t}}finally{try{_&&!_.done&&(p=w.return)&&p.call(w)}finally{if(h)throw h.error}}}}}catch(t){c={error:t}}finally{try{v&&!v.done&&(l=g.return)&&l.call(g)}finally{if(c)throw c.error}}}},t.prototype.checkTensorForDisposalWithNodeLiveUntilInfo=function(t,e,n,r,i,a){var o,s,u,c;function l(t){return Js(t)||i.has(t.name)}if(!Js(t)&&null!=a)try{for(var h=f(a),p=h.next();!p.done;p=h.next()){var d=p.value;if(!l(d)){var m=x(d.name,e,n);try{for(var g=(u=void 0,f(m)),v=g.next();!v.done;v=g.next()){var y=v.value;!y||y.kept||r.has(y.id)||y.dispose()}}catch(t){u={error:t}}finally{try{v&&!v.done&&(c=g.return)&&c.call(g)}finally{if(u)throw u.error}}}}}catch(t){o={error:t}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}},t.prototype.executeAsync=function(t,e){return h(this,void 0,void 0,(function(){return p(this,(function(n){return[2,this._executeAsync(t,e)]}))}))},t.prototype.disposeIntermediateTensors=function(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((function(t){var e,n;try{for(var r=f(t),i=r.next();!i.done;i=r.next()){var a=i.value;a&&!a.isDisposed&&a.dispose()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}})),this.clonedTensorsMap=null)},t.prototype.getIntermediateTensors=function(){return this.clonedTensorsMap},t.prototype._executeAsync=function(t,e,n,r,i){return void 0===n&&(n=!1),void 0===r&&(r={}),void 0===i&&(i={}),h(this,void 0,void 0,(function(){var o,s,u,c,l,h;return p(this,(function(p){switch(p.label){case 0:this.disposeIntermediateTensors(),n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));try{this.keepIntermediateTensors=a.env().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(t){this.keepIntermediateTensors=!1,console.warn(t.message)}return o=new Xs(this.weightMap,r,i,this.functionExecutorMap,this.parseNodeNameCache),this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),[4,this.executeWithControlFlow(t,o,e,n)];case 1:return s=p.sent(),u=e.map((function(t){return b(t,s,o)})),c=u.map((function(t){return t.id})),l=Object.keys(t).map((function(e){return t[e].id})),h=new Set(m(m(m([],d(c),!1),d(l),!1),d(this.weightIds),!1)),Object.values(s).forEach((function(t){t.forEach((function(t){!t||t.isDisposed||h.has(t.id)||t.dispose()}))})),null==this.parent&&o.dispose(h),[2,u]}}))}))},t.prototype.executeFunctionAsync=function(t,e,n){return h(this,void 0,void 0,(function(){var r,i=this;return p(this,(function(a){return r=t.reduce((function(t,e,n){return t[i.inputs[n].name]=e,t}),{}),[2,this._executeAsync(r,this.outputNodes,!0,e,n)]}))}))},t.prototype.executeWithControlFlow=function(t,e,n,r){return h(this,void 0,void 0,(function(){var i,a,o,s,u,c,l,h,f,g,v,y,x,w,_,T,E,k,I=this;return p(this,(function(p){switch(p.label){case 0:i=Object.keys(t),a=i.map((function(t){return I.graph.nodes[S(t)[0]]})),o=n.map((function(t){return S(t)[0]})),s=new Set(o),0===(u=o.map((function(t){return I.graph.nodes[t]}))).length&&(u=this._outputs),c=qs(t,u,this.weightMap,this._initNodes),l=c.usedNodes,h=c.missingInputs,f=c.dynamicNode,g=c.syncInputs,v=m(m(m([],d(a),!1),d(this.graph.weights),!1),d(this._initNodes||[]),!1).map((function(t){return{node:t,contexts:e.currentContext}})),y=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=d(S(e),2),r=n[0],i=[];i[n[1]]=t[e],y[r]=i})),x={},w=this.getFrozenTensorIds(y),_={},p.label=1;case 1:return v.length>0?(T=this.processStack(a,v,e,y,_,w,s,x,l),[4,Promise.all(T)]):[3,3];case 2:return p.sent(),[3,1];case 3:if(null!=f||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(E=u.filter((function(t){return!Js(t)&&!b(t.name,y,e)})).map((function(t){return t.name}))).length>0)throw k="",null!=f&&(k="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(g,"]")),new Error("Cannot compute the outputs [".concat(E,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(h,"]. ").concat(k));return[2,y]}}))}))},t.prototype.processStack=function(t,e,n,r,i,o,s,u,c){for(var l=this,h=[],p=function(){var t,p,m=e.pop();n.currentContext=m.contexts;var g="";if("Enter"===m.node.op&&y("isConstant",m.node,r,n)&&(t=d(w(m.node.name,n),1),g=t[0]),null==r[m.node.name]){var v=Hs(m.node,r,n,f._resourceManager);g||(p=d(w(m.node.name,n),1),g=p[0]);var b=n.currentContext;a.util.isPromise(v)?h.push(v.then((function(t){return r[g]=t,l.keepIntermediateTensors&&(l.clonedTensorsMap[g]=l.cloneTensorList(t)),n.currentContext=b,l.checkTensorForDisposal(g,m.node,r,n,o,s,u),l.processChildNodes(m.node,e,n,r,i,c),t}))):(r[g]=v,f.keepIntermediateTensors&&(f.clonedTensorsMap[g]=f.cloneTensorList(v)),f.checkTensorForDisposal(g,m.node,r,n,o,s,u),f.processChildNodes(m.node,e,n,r,i,c))}else f.processChildNodes(m.node,e,n,r,i,c)},f=this;e.length>0;)p();return h},t.prototype.processChildNodes=function(t,e,n,r,i,a){t.children.forEach((function(t){var o=d(w(t.name,n),1)[0];!i[o]&&a.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!b(t,r,n)}))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!b(t,r,n)}))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})))}))},t.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))},t.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],i=d(S(n),1)[0],o=e.graph.nodes[i];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===r.shape.length&&r.shape.every((function(t,e){return-1===s[e]||s[e]===t}));a.util.assert(u,(function(){return"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(s,"], but was ")+"[".concat(r.shape,"]")}))}o.attrParams.dtype&&o.attrParams.dtype.value&&a.util.assert(r.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))},t.prototype.mapInputs=function(t){var e,n,r={};for(var i in t){var a=null===(n=null===(e=this._signature)||void 0===e?void 0:e.inputs)||void 0===n?void 0:n[i];null!=a?r[a.name]=t[i]:r[i]=t[i]}return r},t.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter((function(t){var n=d(S(t),1)[0];return null==e.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))},t.prototype.mapOutputs=function(t){var e=this;return t.map((function(t){var n,r,i=null===(r=null===(n=e._signature)||void 0===n?void 0:n.outputs)||void 0===r?void 0:r[t];return null!=i?i.name:t}),{})},t.prototype.checkOutputs=function(t){var e=this;t.forEach((function(t){var n=d(S(t),1)[0];if(!e.graph.nodes[n])throw new Error("The output '".concat(t,"' is not found in the graph"))}))},t}(),nu=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this.hashTableNameToHandle=t,this.hashTableMap=e}return t.prototype.addHashTable=function(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e},t.prototype.getHashTableHandleByName=function(t){return this.hashTableNameToHandle[t]},t.prototype.getHashTableById=function(t){return this.hashTableMap[t]},t.prototype.dispose=function(){for(var t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(var e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]},t}(),ru={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},iu=4;function au(t,e){return h(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,c;return p(this,(function(l){switch(l.label){case 0:return n=pt(t.shape),"quantization"in t?(i=t.quantization,r=ru[i.dtype],[3,7]):[3,1];case 1:if("string"!==t.dtype)return[3,6];a=0,o=0,l.label=2;case 2:return o<n?(s=a,u=iu,c=Uint32Array.bind,[4,e(a,a+iu)]):[3,5];case 3:a=s+(u+(new(c.apply(Uint32Array,[void 0,l.sent()])))[0]),l.label=4;case 4:return o++,[3,2];case 5:return[2,a];case 6:r=ru[t.dtype],l.label=7;case 7:return[2,n*r]}}))}))}function ou(t,e,n){return h(this,void 0,void 0,(function(){var r,i,a,o,s,u;return p(this,(function(c){switch(c.label){case 0:r=new Uint8Array(e),c.label=1;case 1:return r.byteLength<n?[4,t.read()]:[3,3];case 2:if(i=c.sent(),a=i.done,o=i.value,a&&null==o)throw s=n-r.byteLength,new Error("Reader is done but ".concat(s," bytes are still expected"));return(u=new Uint8Array(r.length+o.byteLength)).set(r,0),u.set(new Uint8Array(o),r.length),r=u,[3,1];case 3:return[2,r.buffer]}}))}))}function su(t,e){return h(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,c,l,d,m,g,v,y=this;return p(this,(function(b){switch(b.label){case 0:n={},r=t.getReader(),i=new ArrayBuffer(0),b.label=1;case 1:b.trys.push([1,7,8,9]),a=f(e),o=a.next(),b.label=2;case 2:return o.done?[3,6]:[4,au(s=o.value,(function(t,e){return h(y,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,ou(r,i,e)];case 1:return[2,(i=n.sent()).slice(t,e)]}}))}))}))];case 3:return u=b.sent(),[4,ou(r,i,u)];case 4:i=b.sent(),c=i.slice(0,u),i=i.slice(u),l=function(t,e){var n,r,i,a,o=t.name,s=t.dtype,u=t.shape,c=pt(u),l=0;if("quantization"in t){var h=t.quantization;if("uint8"===h.dtype||"uint16"===h.dtype){if(!("min"in h)||!("scale"in h))throw new Error("Weight ".concat(t.name," with quantization ").concat(h.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==h.dtype)throw new Error("Weight ".concat(t.name," has unknown ")+"quantization dtype ".concat(h.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==s)throw new Error("Weight ".concat(t.name," is quantized with ").concat(h.dtype," ")+"which only supports weights of type float32 not ".concat(s,"."))}var p=ru[h.dtype],f="uint8"===h.dtype?new Uint8Array(e):new Uint16Array(e);if("float32"===s)if("uint8"===h.dtype||"uint16"===h.dtype){n=new Float32Array(f.length);for(var d=0;d<f.length;d++){var m=f[d];n[d]=m*h.scale+h.min}}else{if("float16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type float32.");var g=(r=function(){var t=function(t){for(var e=t<<13,n=0;!(8388608&e);)n-=8388608,e<<=1;return(e&=-8388609)|n+947912704},e=new Uint32Array(2048);e[0]=0;for(var n=1;n<1024;n++)e[n]=t(n);for(n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),i=function(){var t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(var e=1;e<31;e++)t[e]=e<<23;for(e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),a=function(){for(var t=new Uint32Array(64),e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}(),function(t){for(var e=new ArrayBuffer(4*t.length),n=new Uint32Array(e),o=0;o<t.length;o++){var s=t[o],u=r[a[s>>10]+(1023&s)]+i[s>>10];n[o]=u}return new Float32Array(e)});n=g(f)}else{if("int32"!==s)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s));if("uint8"!==h.dtype&&"uint16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type int32.");for(n=new Int32Array(f.length),d=0;d<f.length;d++)m=f[d],n[d]=Math.round(m*h.scale+h.min)}l+=c*p}else if("string"===s){var v=pt(t.shape);for(n=[],d=0;d<v;d++){var y=new Uint32Array(e.slice(l,l+iu))[0];l+=iu;var b=new Uint8Array(e.slice(l,l+y));n.push(b),l+=y}}else{var x=ru[s];if("float32"===s)n=new Float32Array(e);else if("int32"===s)n=new Int32Array(e);else{if("bool"!==s){if("complex64"===s){n=new Float32Array(e);var w=new Float32Array(n.length/2),_=new Float32Array(n.length/2);for(d=0;d<w.length;d++)w[d]=n[2*d],_[d]=n[2*d+1];var S=yo(w,u,"float32"),T=yo(_,u,"float32"),E=cr(S,T);return S.dispose(),T.dispose(),E}throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s))}n=new Uint8Array(e)}l+=c*x}return yo(n,u,s)}(s,c),n[s.name]=l,"webgpu"===sn.backendName&&"uploadToGPU"in(d=sn.backend)&&pt(l.shape)>=Ot().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&d.uploadToGPU(l.dataId),b.label=5;case 5:return o=a.next(),[3,2];case 6:return[3,9];case 7:return m=b.sent(),g={error:m},[3,9];case 8:try{o&&!o.done&&(v=a.return)&&v.call(a)}finally{if(g)throw g.error}return[7];case 9:return[2,n]}}))}))}var uu=function(){function t(t,e,n){void 0===e&&(e={}),void 0===n&&(n=a.io),this.modelUrl=t,this.loadOptions=e,this.version="n/a",this.io=n,null==e&&(this.loadOptions={}),this.resourceManager=new nu}return Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this.artifacts.userDefinedMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"modelSignature",{get:function(){return this.signature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"modelStructuredOutputKeys",{get:function(){return this.structuredOutputKeys},enumerable:!1,configurable:!0}),t.prototype.findIOHandler=function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{var e=this.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one (".concat(e.length,") load handlers for ")+"URL '".concat([t],"'"));this.handler=e[0]}},t.prototype.load=function(){var t=this;if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");var e=this.handler.load();return a.util.isPromise(e)?e.then((function(e){return null==e.getWeightStream?t.loadSync(e):t.loadStreaming(e)})):this.loadSync(e)},t.prototype.loadSync=function(t){var e=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,e)},t.prototype.loadStreaming=function(t){return h(this,void 0,void 0,(function(){var e;return p(this,(function(n){switch(n.label){case 0:if(null==t.getWeightStream)throw new Error("Model artifacts missing streamWeights function");return[4,su(t.getWeightStream(),t.weightSpecs)];case 1:return e=n.sent(),[2,this.loadWithWeightMap(t,e)]}}))}))},t.prototype.loadWithWeightMap=function(t,e){this.artifacts=t;var n=this.artifacts.modelTopology,r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){var i=this.artifacts.userDefinedMetadata;null!=i.signature&&(r=i.signature),null!=i.structuredOutputKeys&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=r,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new eu(H.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(e),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){var a=H.Instance.transformGraph(t.modelInitializer);this.initializer=new eu(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0},t.prototype.save=function(t,e){return h(this,void 0,void 0,(function(){var e;return p(this,(function(n){if("string"==typeof t){if(0===(e=this.io.getSaveHandlers(t)).length)throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new Error("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]}))}))},t.prototype.addStructuredOutputNames=function(t){var e=this;if(this.structuredOutputKeys){var n=t instanceof a.Tensor?[t]:t,r={};return n.forEach((function(t,n){return r[e.structuredOutputKeys[n]]=t})),r}return t},t.prototype.predict=function(t,e){var n=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(n)},t.prototype.predictAsync=function(t,e){return h(this,void 0,void 0,(function(){var e;return p(this,(function(n){switch(n.label){case 0:return[4,this.executeAsync(t,this.outputNodes)];case 1:return e=n.sent(),[2,this.addStructuredOutputNames(e)]}}))}))},t.prototype.normalizeInputs=function(t){var e,n=this;if(!(t instanceof a.Tensor||Array.isArray(t))){var r=null===(e=this.signature)||void 0===e?void 0:e.inputs;if(null!=r)for(var i in r){var o=r[i];null!=o.resourceId&&(t[i]=this.resourceIdToCapturedInput[o.resourceId])}return t}t=Array.isArray(t)?t:[t];var s=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+s!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-s," non-resource placeholders, while there are ").concat(t.length," input tensors provided."));var u=0;return this.inputNodes.reduce((function(e,r){var i,a,o,s=null===(o=null===(a=null===(i=n.signature)||void 0===i?void 0:i.inputs)||void 0===a?void 0:a[r])||void 0===o?void 0:o.resourceId;return e[r]=null!=s?n.resourceIdToCapturedInput[s]:t[u++],e}),{})},t.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},t.prototype.executeInitializerGraph=function(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))},t.prototype.executeInitializerGraphAsync=function(){return h(this,void 0,void 0,(function(){return p(this,(function(t){return null==this.initializer?[2,[]]:null==this.initializerSignature?[2,this.initializer.executeAsync({},[])]:[2,this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))]}))}))},t.prototype.setResourceIdToCapturedInput=function(t){if(this.resourceIdToCapturedInput={},this.initializerSignature)for(var e=this.initializerSignature.outputs,n=Object.keys(e),r=0;r<n.length;r++){var i=e[n[r]];this.resourceIdToCapturedInput[i.resourceId]=t[r]}},t.prototype.execute=function(t,e){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},t.prototype.executeAsync=function(t,e){return h(this,void 0,void 0,(function(){var n,r;return p(this,(function(i){switch(i.label){case 0:return null!=this.resourceIdToCapturedInput?[3,2]:(n=this.setResourceIdToCapturedInput,[4,this.executeInitializerGraphAsync()]);case 1:n.apply(this,[i.sent()]),i.label=2;case 2:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 3:return[2,(r=i.sent()).length>1?r:r[0]]}}))}))},t.prototype.getIntermediateTensors=function(){return this.executor.getIntermediateTensors()},t.prototype.disposeIntermediateTensors=function(){this.executor.disposeIntermediateTensors()},t.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})},t.prototype.dispose=function(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&a.dispose(this.resourceIdToCapturedInput)),this.resourceManager.dispose()},t}();n.GraphModel=uu,n.deregisterOp=function(t){delete g[t]},n.loadGraphModel=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=a.io),h(this,void 0,void 0,(function(){var r;return p(this,(function(i){switch(i.label){case 0:if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==e&&(e={}),e.fromTFHub&&"string"==typeof t&&(t=function(t){return t.endsWith("/")||(t+="/"),"".concat(t).concat("model.json").concat("?tfjs-format=file")}(t)),[4,(r=new uu(t,e,n)).load()];case 1:return i.sent(),[2,r]}}))}))},n.loadGraphModelSync=function(t){if(null==t)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");var e;if(t instanceof Array){var n=d(t,2),r=n[0],i=n[1];if(!r)throw new Error("modelJSON must be the first element of the array");if(!(i&&i instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");var o=a.io.getWeightSpecs(r.weightsManifest),s=a.io.getModelArtifactsForJSONSync(r,o,i);e=a.io.fromMemorySync(s)}else if("load"in t)e=t;else{if(!("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t))throw new Error("Unknown model format");e=a.io.fromMemorySync(t)}var u=new uu(e);return u.load(),u},n.registerOp=function(t,e){var n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};g[t]=n},n.version_converter="4.17.0"}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"@tensorflow/tfjs-core":7,_process:16,buffer:13}],7:[function(t,e,n){(function(e,r,i,a,o,s,u,c){(function(){"use strict";var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},a(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function u(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function p(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var f=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),d=function(){function t(){}return t.prototype.refCount=function(t){return m("refCount")},t.prototype.incRef=function(t){return m("incRef")},t.prototype.timerAvailable=function(){return!0},t.prototype.time=function(t){return m("time")},t.prototype.read=function(t){return m("read")},t.prototype.readSync=function(t){return m("readSync")},t.prototype.readToGPU=function(t,e){return m("readToGPU")},t.prototype.numDataIds=function(){return m("numDataIds")},t.prototype.disposeData=function(t,e){return m("disposeData")},t.prototype.write=function(t,e,n){return m("write")},t.prototype.move=function(t,e,n,r,i){return m("move")},t.prototype.createTensorFromGPUData=function(t,e,n){return m("createTensorFromGPUData")},t.prototype.memory=function(){return m("memory")},t.prototype.floatPrecision=function(){return m("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.dispose=function(){return m("dispose")},t}();function m(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function g(t){for(var e=t.length,n=0;e>0;)n=Math.random()*e|0,y(t,--e,n)}function v(t,e,n){return Math.max(t,Math.min(e,n))}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function x(t,e,n){void 0===n&&(n=""),b(T(t,e),(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}function w(t){b(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function _(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function S(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(null!==t[n]&&null!==e[n]&&t[n]!==e[n])return!1;return!0}function T(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function E(t){return t%1==0}function k(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function I(t,e){var n=e.length;return b((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t)})),b(t.every((function(t){return E(t)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(t)})),t.map((function(t){return t<0?n+t:t}))}function A(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:I(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=a){if(a[o]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==a[o]||a[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function N(t,e){return C(t,e)}function C(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function R(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}function O(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function D(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function M(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function F(t){return"string"==typeof t||t instanceof String}function P(t){return"boolean"==typeof t}function L(t){return"number"==typeof t}function B(t){return Array.isArray(t)?B(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":L(t)?"float32":F(t)?"string":P(t)?"bool":"float32"}function z(t){return!!(t&&t.constructor&&t.call&&t.apply)}function U(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function G(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function W(t,e,n,r){void 0===r&&(r=!1);var i=new Array;if(1===e.length)for(var a=e[0]*(r?2:1),o=0;o<a;o++)i[o]=n[t+o];else{a=e[0];var s=e.slice(1),u=s.reduce((function(t,e){return t*e}))*(r?2:1);for(o=0;o<a;o++)i[o]=W(t+o*u,s,n,r)}return i}function V(t,e,n){if(void 0===n&&(n=!1),0===t.length)return e[0];var r=t.reduce((function(t,e){return t*e}))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return W(0,t,e,n)}function j(t,e){for(var n=H(t,e),r=0;r<n.length;r++)n[r]=1;return n}function H(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function X(t){t.forEach((function(e){b(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")}))}))}function q(t){return t&&t.then&&"function"==typeof t.then}var K,Y="tfjsflags",Z=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=$,this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&(J().getBool("IS_TEST")||J().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];J().getBool("IS_TEST")||J().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(r,".")),this.set(t,r)}},t.prototype.getAsync=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){switch(r.label){case 0:return t in this.flags?[2,this.flags[t]]:(e=this.flags,n=t,[4,this.evaluateFlag(t)]);case 1:return e[n]=r.sent(),[2,this.flags[t]]}}))}))},t.prototype.get=function(t){if(t in this.flags)return this.flags[t];var e=this.evaluateFlag(t);if(q(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getString=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=this.getQueryParams(this.global.location.search);Y in e&&e[Y].split(",").forEach((function(e){var n=h(e.split(":"),2),r=n[0],i=n[1];t.urlFlags[r]=function(t,e){var n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:e}(0,i)}))}},t}();function $(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e}function J(){return n.ENV}function Q(){if(null==K){var t=void 0;if("undefined"!=typeof window)t=window;else if(void 0!==r)t=r;else if(void 0!==e)t=e;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}K=t}return K}function tt(t,e){var n,r=(null==(n=Q())._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals);if(r.has(t))return r.get(t);var i=e();return r.set(t,i),r.get(t)}n.ENV=null;var et="Acos",nt="Acosh",rt="Add",it="AddN",at="ArgMax",ot="ArgMin",st="Asin",ut="Asinh",ct="Atan",lt="Atanh",ht="Atan2",pt="AvgPool",ft="AvgPool3D",dt="BatchMatMul",mt="BatchToSpaceND",gt="Bincount",vt="BitwiseAnd",yt="BroadcastArgs",bt="Cast",xt="Ceil",wt="ClipByValue",_t="Complex",St="ComplexAbs",Tt="Concat",Et="Conv2D",kt="Conv2DBackpropFilter",It="Conv2DBackpropInput",At="Conv3D",Nt="Conv3DBackpropInputV2",Ct="Cosh",Rt="Cumprod",Ot="Cumsum",Dt="CropAndResize",Mt="DenseBincount",Ft="DepthToSpace",Pt="DepthwiseConv2dNative",Lt="DepthwiseConv2dNativeBackpropFilter",Bt="DepthwiseConv2dNativeBackpropInput",zt="Diag",Ut="Dilation2D",Gt="Draw",Wt="RealDiv",Vt="Einsum",jt="Equal",Ht="ExpandDims",Xt="Expm1",qt="Fill",Kt="FlipLeftRight",Yt="Floor",Zt="FloorDiv",$t="FusedBatchNorm",Jt="GatherV2",Qt="GatherNd",te="Greater",ee="GreaterEqual",ne="Identity",re="IFFT",ie="Imag",ae="IsFinite",oe="IsInf",se="IsNan",ue="LeakyRelu",ce="Less",le="LessEqual",he="LinSpace",pe="Log1p",fe="LogicalAnd",de="LogicalNot",me="LogicalOr",ge="Maximum",ve="MaxPool",ye="MaxPool3D",be="MaxPoolWithArgmax",xe="Mean",we="Minimum",_e="MirrorPad",Se="Multinomial",Te="Multiply",Ee="NotEqual",ke="NonMaxSuppressionV3",Ie="NonMaxSuppressionV4",Ae="NonMaxSuppressionV5",Ne="OnesLike",Ce="OneHot",Re="Pack",Oe="PadV2",De="Prelu",Me="Prod",Fe="RaggedGather",Pe="RaggedRange",Le="RaggedTensorToTensor",Be="Range",ze="Real",Ue="Reciprocal",Ge="Relu",We="Reshape",Ve="ResizeNearestNeighbor",je="ResizeBilinear",He="Relu6",Xe="Reverse",qe="Round",Ke="Rsqrt",Ye="ScatterNd",Ze="TensorScatterUpdate",$e="SearchSorted",Je="Select",Qe="Selu",tn="Slice",en="Sinh",nn="Sign",rn="Sigmoid",an="Softplus",on="Sqrt",sn="SpaceToBatchND",un="SplitV",cn="Softmax",ln="SparseFillEmptyRows",hn="SparseReshape",pn="SparseSegmentMean",fn="SparseSegmentSum",dn="SparseToDense",mn="SquaredDifference",gn="StaticRegexReplace",vn="StridedSlice",yn="StringNGrams",bn="StringSplit",xn="StringToHashBucketFast",wn="Tanh",_n="Tile",Sn="TopK",Tn="Transform",En="Transpose",kn="Unique",In="Unpack",An="UnsortedSegmentSum",Nn="ZerosLike",Cn="Step",Rn="FromPixels",On="RotateWithOffset",Dn="_FusedMatMul",Mn="FusedConv2D",Fn="FusedDepthwiseConv2D";function Pn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];J().getBool("IS_TEST")||J().getBool("PROD")||console.warn.apply(console,p([],h(t),!1))}var Ln=tt("kernelRegistry",(function(){return new Map})),Bn=tt("gradRegistry",(function(){return new Map}));function zn(t,e){var n=Vn(t,e);return Ln.get(n)}function Un(t){return Bn.get(t)}function Gn(t){for(var e=Ln.entries(),n=[];;){var r=e.next(),i=r.done,a=r.value;if(i)break;var o=h(a,2),s=o[0],u=o[1];h(s.split("_"),1)[0]===t&&n.push(u)}return n}function Wn(t){var e=t.kernelName,n=t.backendName,r=Vn(e,n);Ln.has(r)&&Pn("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),Ln.set(r,t)}function Vn(t,e){return"".concat(e,"_").concat(t)}function jn(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var Hn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{};var Xn=Kn,qn=null;try{qn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function Kn(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function Yn(t){return!0===(t&&t.__isLong__)}Kn.prototype.__isLong__,Object.defineProperty(Kn.prototype,"__isLong__",{value:!0}),Kn.isLong=Yn;var Zn={},$n={};function Jn(t,e){var n,r,i;return e?(i=0<=(t>>>=0)&&t<256)&&(r=$n[t])?r:(n=tr(t,(0|t)<0?-1:0,!0),i&&($n[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(r=Zn[t])?r:(n=tr(t,t<0?-1:0,!1),i&&(Zn[t]=n),n)}function Qn(t,e){if(isNaN(t))return e?cr:ur;if(e){if(t<0)return cr;if(t>=ar)return dr}else{if(t<=-or)return mr;if(t+1>=or)return fr}return t<0?Qn(-t,e).neg():tr(t%ir|0,t/ir|0,e)}function tr(t,e,n){return new Kn(t,e,n)}Kn.fromInt=Jn,Kn.fromNumber=Qn,Kn.fromBits=tr;var er=Math.pow;function nr(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return ur;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return nr(t.substring(1),e,n).neg();for(var i=Qn(er(n,8)),a=ur,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),u=parseInt(t.substring(o,o+s),n);if(s<8){var c=Qn(er(n,s));a=a.mul(c).add(Qn(u))}else a=(a=a.mul(i)).add(Qn(u))}return a.unsigned=e,a}function rr(t,e){return"number"==typeof t?Qn(t,e):"string"==typeof t?nr(t,e):tr(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}Kn.fromString=nr,Kn.fromValue=rr;var ir=4294967296,ar=ir*ir,or=ar/2,sr=Jn(1<<24),ur=Jn(0);Kn.ZERO=ur;var cr=Jn(0,!0);Kn.UZERO=cr;var lr=Jn(1);Kn.ONE=lr;var hr=Jn(1,!0);Kn.UONE=hr;var pr=Jn(-1);Kn.NEG_ONE=pr;var fr=tr(-1,2147483647,!1);Kn.MAX_VALUE=fr;var dr=tr(-1,-1,!0);Kn.MAX_UNSIGNED_VALUE=dr;var mr=tr(0,-2147483648,!1);Kn.MIN_VALUE=mr;var gr=Kn.prototype;gr.toInt=function(){return this.unsigned?this.low>>>0:this.low},gr.toNumber=function(){return this.unsigned?(this.high>>>0)*ir+(this.low>>>0):this.high*ir+(this.low>>>0)},gr.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(mr)){var e=Qn(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=Qn(er(t,6),this.unsigned),a=this,o="";;){var s=a.div(i),u=(a.sub(s.mul(i)).toInt()>>>0).toString(t);if((a=s).isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},gr.getHighBits=function(){return this.high},gr.getHighBitsUnsigned=function(){return this.high>>>0},gr.getLowBits=function(){return this.low},gr.getLowBitsUnsigned=function(){return this.low>>>0},gr.getNumBitsAbs=function(){if(this.isNegative())return this.eq(mr)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},gr.isZero=function(){return 0===this.high&&0===this.low},gr.eqz=gr.isZero,gr.isNegative=function(){return!this.unsigned&&this.high<0},gr.isPositive=function(){return this.unsigned||this.high>=0},gr.isOdd=function(){return!(1&~this.low)},gr.isEven=function(){return!(1&this.low)},gr.equals=function(t){return Yn(t)||(t=rr(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},gr.eq=gr.equals,gr.notEquals=function(t){return!this.eq(t)},gr.neq=gr.notEquals,gr.ne=gr.notEquals,gr.lessThan=function(t){return this.comp(t)<0},gr.lt=gr.lessThan,gr.lessThanOrEqual=function(t){return this.comp(t)<=0},gr.lte=gr.lessThanOrEqual,gr.le=gr.lessThanOrEqual,gr.greaterThan=function(t){return this.comp(t)>0},gr.gt=gr.greaterThan,gr.greaterThanOrEqual=function(t){return this.comp(t)>=0},gr.gte=gr.greaterThanOrEqual,gr.ge=gr.greaterThanOrEqual,gr.compare=function(t){if(Yn(t)||(t=rr(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},gr.comp=gr.compare,gr.negate=function(){return!this.unsigned&&this.eq(mr)?mr:this.not().add(lr)},gr.neg=gr.negate,gr.add=function(t){Yn(t)||(t=rr(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=t.high>>>16,o=65535&t.high,s=t.low>>>16,u=0,c=0,l=0,h=0;return l+=(h+=i+(65535&t.low))>>>16,c+=(l+=r+s)>>>16,u+=(c+=n+o)>>>16,u+=e+a,tr((l&=65535)<<16|(h&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},gr.subtract=function(t){return Yn(t)||(t=rr(t)),this.add(t.neg())},gr.sub=gr.subtract,gr.multiply=function(t){if(this.isZero())return ur;if(Yn(t)||(t=rr(t)),qn)return tr(qn.mul(this.low,this.high,t.low,t.high),qn.get_high(),this.unsigned);if(t.isZero())return ur;if(this.eq(mr))return t.isOdd()?mr:ur;if(t.eq(mr))return this.isOdd()?mr:ur;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(sr)&&t.lt(sr))return Qn(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=t.high>>>16,o=65535&t.high,s=t.low>>>16,u=65535&t.low,c=0,l=0,h=0,p=0;return h+=(p+=i*u)>>>16,l+=(h+=r*u)>>>16,h&=65535,l+=(h+=i*s)>>>16,c+=(l+=n*u)>>>16,l&=65535,c+=(l+=r*s)>>>16,l&=65535,c+=(l+=i*o)>>>16,c+=e*u+n*s+r*o+i*a,tr((h&=65535)<<16|(p&=65535),(c&=65535)<<16|(l&=65535),this.unsigned)},gr.mul=gr.multiply,gr.divide=function(t){if(Yn(t)||(t=rr(t)),t.isZero())throw Error("division by zero");var e,n,r;if(qn)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?tr((this.unsigned?qn.div_u:qn.div_s)(this.low,this.high,t.low,t.high),qn.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?cr:ur;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return cr;if(t.gt(this.shru(1)))return hr;r=cr}else{if(this.eq(mr))return t.eq(lr)||t.eq(pr)?mr:t.eq(mr)?lr:(e=this.shr(1).div(t).shl(1)).eq(ur)?t.isNegative()?lr:pr:(n=this.sub(t.mul(e)),r=e.add(n.div(t)));if(t.eq(mr))return this.unsigned?cr:ur;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();r=ur}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var i=Math.ceil(Math.log(e)/Math.LN2),a=i<=48?1:er(2,i-48),o=Qn(e),s=o.mul(t);s.isNegative()||s.gt(n);)s=(o=Qn(e-=a,this.unsigned)).mul(t);o.isZero()&&(o=lr),r=r.add(o),n=n.sub(s)}return r},gr.div=gr.divide,gr.modulo=function(t){return Yn(t)||(t=rr(t)),qn?tr((this.unsigned?qn.rem_u:qn.rem_s)(this.low,this.high,t.low,t.high),qn.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},gr.mod=gr.modulo,gr.rem=gr.modulo,gr.not=function(){return tr(~this.low,~this.high,this.unsigned)},gr.and=function(t){return Yn(t)||(t=rr(t)),tr(this.low&t.low,this.high&t.high,this.unsigned)},gr.or=function(t){return Yn(t)||(t=rr(t)),tr(this.low|t.low,this.high|t.high,this.unsigned)},gr.xor=function(t){return Yn(t)||(t=rr(t)),tr(this.low^t.low,this.high^t.high,this.unsigned)},gr.shiftLeft=function(t){return Yn(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?tr(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):tr(0,this.low<<t-32,this.unsigned)},gr.shl=gr.shiftLeft,gr.shiftRight=function(t){return Yn(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?tr(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):tr(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},gr.shr=gr.shiftRight,gr.shiftRightUnsigned=function(t){if(Yn(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?tr(this.low>>>t|e<<32-t,e>>>t,this.unsigned):tr(32===t?e:e>>>t-32,0,this.unsigned)},gr.shru=gr.shiftRightUnsigned,gr.shr_u=gr.shiftRightUnsigned,gr.toSigned=function(){return this.unsigned?tr(this.low,this.high,!1):this},gr.toUnsigned=function(){return this.unsigned?this:tr(this.low,this.high,!0)},gr.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},gr.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},gr.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},Kn.fromBytes=function(t,e,n){return n?Kn.fromBytesLE(t,e):Kn.fromBytesBE(t,e)},Kn.fromBytesLE=function(t,e){return new Kn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},Kn.fromBytesBE=function(t,e){return new Kn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};var vr=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(Xn),yr=vr||function(t,e){return e.forEach((function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((function(n){if("default"!==n&&!(n in t)){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}))})),t}({__proto__:null,default:vr},[Xn]);function br(t){return yr.fromString(t,!0,16)}var xr=br("c3a5c85c97cb3127"),wr=br("b492b66fbe98f273"),_r=br("9ae16a3b2f90404f");function Sr(t){return t.xor(t.shru(47))}function Tr(t,e,n){var r=t.slice(e,e+n);return yr.fromBytes(Array.from(r),!0,!0)}function Er(t,e){return Tr(t,e,8)}function kr(t,e){return Tr(t,e,4)}function Ir(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function Ar(t,e,n){void 0===n&&(n=br("9ddfea08eb382d69"));var r=t.xor(e).mul(n);r=r.xor(r.shru(47));var i=e.xor(r).mul(n);return(i=i.xor(i.shru(47))).mul(n)}function Nr(t,e,n,r){return function(t,e,n,r,i,a){i=i.add(t),a=Ir(a.add(i).add(r),21);var o=i;return i=(i=i.add(e)).add(n),a=a.add(Ir(i,44)),[i.add(r),a.add(o)]}(Er(t,e),Er(t,e+8),Er(t,e+16),Er(t,e+24),n,r)}function Cr(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Fr(t)),J().getBool("DEBUG")&&R(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var n=new Uint8Array(t.length),r=0;r<n.length;++r)0!==Math.round(t[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(e))}function Rr(){return J().platform.now()}function Or(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",J().platform.encode(t,e)}function Dr(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",J().platform.decode(t,e)}function Mr(t){return null!=J().platform.isTypedArray?J().platform.isTypedArray(t):jn(t)}function Fr(t,e,n){var r,i;if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),"boolean"==typeof t||"number"==typeof t||"string"==typeof t||q(t)||null==t||Mr(t)&&n)e.push(t);else if(Array.isArray(t)||Mr(t))for(var a=0;a<t.length;++a)Fr(t[a],e,n);else{var o=-1;try{for(var s=l(Object.keys(t)),u=s.next();!u.done;u=s.next()){var c=u.value;/^([1-9]+[0-9]*|0)$/.test(c)&&(o=Math.max(o,Number(c)))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}for(a=0;a<=o;a++)Fr(t[a],e,n)}return e}var Pr={__proto__:null,arraysEqual:T,arraysEqualWithNull:S,assert:b,assertNonNegativeIntegerDimensions:X,assertNonNull:w,assertShapesMatch:x,bytesFromStringArray:M,bytesPerElement:D,checkConversionForErrors:R,clamp:v,computeStrides:G,convertBackendValuesAndArrayBuffer:function(t,e){if(Array.isArray(t))return t;if("float32"===e)return t instanceof Float32Array?t:new Float32Array(t);if("int32"===e)return t instanceof Int32Array?t:new Int32Array(t);if("bool"===e||"string"===e)return Uint8Array.from(new Int32Array(t));throw new Error("Unknown dtype ".concat(e))},createScalarValue:function(t,e){return"string"===e?Or(t):Cr([t],e)},createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return g(e),e},decodeString:Dr,distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},encodeString:Or,fetch:function(t,e){return J().platform.fetch(t,e)},fingerPrint64:function(t,e){var n,r;void 0===e&&(e=t.length);var i=yr.fromNumber(81,!0);if(e<=32)return e<=16?function(t,e){if(void 0===e&&(e=t.length),e>=8){var n=_r.add(2*e),r=Er(t,0).add(_r);return Ar(Ir(i=Er(t,e-8),37).mul(n).add(r),Ir(r,25).add(i).mul(n),n)}if(e>=4)return n=_r.add(2*e),Ar((r=kr(t,0)).shl(3).add(e),kr(t,e-4),n);if(e>0){var i,a=(r=t[0])+((i=t[e>>1])<<8),o=e+(t[e-1]<<2);return Sr(_r.mul(a).xor(xr.mul(o))).mul(_r)}return _r}(t,e):function(t,e){void 0===e&&(e=t.length);var n=_r.add(2*e),r=Er(t,0).mul(wr),i=Er(t,8),a=Er(t,e-8).mul(n),o=Er(t,e-16).mul(_r);return Ar(Ir(r.add(i),43).add(Ir(a,30)).add(o),r.add(Ir(i.add(_r),18)).add(a),n)}(t,e);if(e<=64)return function(t,e){void 0===e&&(e=t.length);var n=_r.add(2*e),r=Er(t,0).mul(_r),i=Er(t,8),a=Er(t,e-8).mul(n),o=Er(t,e-16).mul(_r),s=Ir(r.add(i),43).add(Ir(a,30)).add(o),u=Ar(s,r.add(Ir(i.add(_r),18)).add(a),n),c=Er(t,16).mul(n),l=Er(t,24),h=s.add(Er(t,e-32)).mul(n),p=u.add(Er(t,e-24)).mul(n);return Ar(Ir(c.add(l),43).add(Ir(h,30)).add(p),c.add(Ir(l.add(r),18)).add(h),n)}(t,e);var a=i,o=i.mul(wr).add(113),s=Sr(o.mul(_r).add(113)).mul(_r),u=[yr.UZERO,yr.UZERO],c=[yr.UZERO,yr.UZERO];a=a.mul(_r).add(Er(t,0));var l=0,p=64*(e-1>>6),f=p+(e-1&63)-63;do{a=Ir(a.add(o).add(u[0]).add(Er(t,l+8)),37).mul(wr),o=Ir(o.add(u[1]).add(Er(t,l+48)),42).mul(wr),a=a.xor(c[1]),o=o.add(u[0]).add(Er(t,l+40)),s=Ir(s.add(c[0]),33).mul(wr),u=Nr(t,l,u[1].mul(wr),a.add(c[0])),c=Nr(t,l+32,s.add(c[1]),o.add(Er(t,l+16))),s=(n=h([a,s],2))[0],a=n[1],l+=64}while(l!==p);var d=wr.add(s.and(255).shl(1));return l=f,c[0]=c[0].add(e-1&63),u[0]=u[0].add(c[0]),c[0]=c[0].add(u[0]),a=Ir(a.add(o).add(u[0]).add(Er(t,l+8)),37).mul(d),o=Ir(o.add(u[1]).add(Er(t,l+48)),42).mul(d),a=a.xor(c[1].mul(9)),o=o.add(u[0].mul(9).add(Er(t,l+40))),s=Ir(s.add(c[0]),33).mul(d),u=Nr(t,l,u[1].mul(d),a.add(c[0])),c=Nr(t,l+32,s.add(c[1]),o.add(Er(t,l+16))),s=(r=h([a,s],2))[0],a=r[1],Ar(Ar(u[0],c[0],d).add(Sr(o).mul(xr)).add(s),Ar(u[1],c[1],d).add(a),d)},flatten:Fr,getArrayFromDType:C,getTypedArrayFromDType:N,hasEncodingLoss:function(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)},hexToLong:br,indexToLoc:function(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r},inferDtype:B,inferFromImplicitShape:function(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(i));r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found ".concat(t[i]," at dim ").concat(i));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));var a=t.slice();return a[r]=e/n,a},isBoolean:P,isFunction:z,isInt:E,isNumber:L,isPromise:q,isScalarShape:function(t){return 0===t.length},isString:F,isTypedArray:Mr,isValidDtype:O,locToIndex:function(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],i=0;i<t.length-1;++i)r+=n[i]*t[i];return r},makeOnesTypedArray:j,makeZerosNestedTypedArray:function(t,e){var n=t.reduce((function(t,e){return t*e}),1);if(null==e||"float32"===e)return V(t,new Float32Array(n));if("int32"===e)return V(t,new Int32Array(n));if("bool"===e)return V(t,new Uint8Array(n));throw new Error("Unknown data type ".concat(e))},makeZerosTypedArray:H,nearestDivisor:U,nearestLargerEven:function(t){return t%2==0?t:t+1},now:Rr,parseAxisParam:I,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},repeatedTry:function(t,e,n,r){return void 0===e&&(e=function(t){return 0}),new Promise((function(i,a){var o=0,s=function(){if(t())i();else{o++;var u=e(o);null!=n&&o>=n?a():null!=r?r(s,u):setTimeout(s,u)}};s()}))},rightPad:k,shuffle:g,shuffleCombo:function(t,e){if(t.length!==e.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(t.length)+"Second array length was ".concat(e.length));for(var n=t.length,r=0;n>0;)r=Math.random()*n|0,y(t,--n,r),y(e,n,r)},sizeFromShape:_,sizeToSquarishShape:function(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]},squeezeShape:A,sum:function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e},swap:y,tanh:function(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)},toNestedArray:V,toTypedArray:Cr},Lr=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new Br)}return t.prototype.profileKernel=function(t,e,n){var r,i,a,o,s=function(){a=n()},u=Rr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();try{for(var c=l(a),h=c.next();!h.done;h=c.next())h.value.dataSync()}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}o=Promise.resolve({kernelMs:Rr()-u})}if(J().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var p=function(e){var n=a[e];n.data().then((function(e){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found ".concat(i," in the result of '").concat(n,"'")),!0}}(e,n.dtype,t)}))},f=0;f<a.length;f++)p(f);return{kernelName:t,outputs:a,inputs:e,timeMs:o.then((function(t){return t.kernelMs})),extraInfo:o.then((function(t){return null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""}))}},t.prototype.logKernelProfile=function(t){var e=this,n=t.kernelName,r=t.outputs,i=t.timeMs,a=t.inputs,o=t.extraInfo;r.forEach((function(t){Promise.all([t.data(),i,o]).then((function(r){e.logger.logKernelProfile(n,t,r[0],r[1],a,r[2])}))}))},t}(),Br=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,a){var o="number"==typeof r?k("".concat(r,"ms"),9):r.error,s=k(t,25),u=e.rank,c=e.size,l=k(e.shape.toString(),14),h="";for(var p in i){var f=i[p];if(null!=f){var d=f.shape||e.shape,m=d.length;h+="".concat(p,": ").concat(m,"D ").concat(m>0?d:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(a),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),zr=20,Ur=3,Gr=7;function Wr(t,e,n,r){var i=G(e),a=function(t,e,n,r){var i=_(e),a=r[r.length-1],o=new Array(a).fill(0),s=e.length,u="complex64"===n?Xr(t):t;if(s>1)for(var c=0;c<i/a;c++)for(var l=c*a,h=0;h<a;h++)o[h]=Math.max(o[h],Vr(u[l+h],0,n).length);return o}(t,e,n,i),o=e.length,s=Hr(t,e,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}function Vr(t,e,n){return k(Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(Gr))," + ")+"".concat(parseFloat(t[1].toFixed(Gr)),"j"):F(t)?"'".concat(t,"'"):"bool"===n?jr(t):parseFloat(t.toFixed(Gr)).toString(),e)}function jr(t){return 0===t?"false":"true"}function Hr(t,e,n,r,i,a){void 0===a&&(a=!0);var o="complex64"===n?2:1,s=e[0],u=e.length;if(0===u)return"complex64"===n?[Vr(Xr(t)[0],0,n)]:"bool"===n?[jr(t[0])]:[t[0].toString()];if(1===u){if(s>zr){var c=Ur*o,l=Array.from(t.slice(0,c)),f=Array.from(t.slice((s-Ur)*o,s*o));return"complex64"===n&&(l=Xr(l),f=Xr(f)),["["+l.map((function(t,e){return Vr(t,i[e],n)})).join(", ")+", ..., "+f.map((function(t,e){return Vr(t,i[s-Ur+e],n)})).join(", ")+"]"]}return["["+("complex64"===n?Xr(t):Array.from(t)).map((function(t,e){return Vr(t,i[e],n)})).join(", ")+"]"]}var d=e.slice(1),m=r.slice(1),g=r[0]*o,v=[];if(s>zr){for(var y=0;y<Ur;y++){var b=(x=y*g)+g;v.push.apply(v,p([],h(Hr(t.slice(x,b),d,n,m,i,!1)),!1))}for(v.push("..."),y=s-Ur;y<s;y++)b=(x=y*g)+g,v.push.apply(v,p([],h(Hr(t.slice(x,b),d,n,m,i,y===s-1)),!1))}else for(y=0;y<s;y++){var x;b=(x=y*g)+g,v.push.apply(v,p([],h(Hr(t.slice(x,b),d,n,m,i,y===s-1)),!1))}var w=2===u?",":"";for(v[0]="["+(s>0?v[0]+w:""),y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;var _=",\n";for(y=2;y<u;y++)_+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":_),v}function Xr(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var qr=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=_(t),null!=n){var i=n.length;b(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(r.size,"'.")}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||C(e,this.size),this.strides=G(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),b(n.length===this.rank,(function(){return"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(e.rank,")")}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];0===n.length&&(n=[0]);var i=0;try{for(var a=l(n),o=a.next();!o.done;o=a.next()){var s=o.value;if(s<0||s>=this.shape[i]){var u="Requested out of range element at ".concat(n,". ")+"  Buffer shape=".concat(this.shape);throw new Error(u)}i++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}for(var c=n[n.length-1],h=0;h<n.length-1;++h)c+=this.strides[h]*n[h];return this.values[c]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!1,configurable:!0}),t.prototype.toTensor=function(){return Kr().makeTensor(this.values,this.shape,this.dtype)},t}(),Kr=null,Yr=null,Zr=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=_(t),this.strides=G(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!1,configurable:!0}),t.prototype.buffer=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Yr.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return Yr.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,V(this.shape,t,"complex64"===this.dtype)]}}))}))},t.prototype.arraySync=function(){return V(this.shape,this.dataSync(),"complex64"===this.dtype)},t.prototype.data=function(){return s(this,void 0,void 0,(function(){var t,e;return u(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=Kr().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return Dr(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataToGPU=function(t){return this.throwIfDisposed(),Kr().readToGPU(this.dataId,t)},t.prototype.dataSync=function(){this.throwIfDisposed();var t=Kr().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return Dr(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Kr().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Kr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!1,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.print=function(t){return void 0===t&&(t=!1),Yr.print(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),Yr.clone(this)},t.prototype.toString=function(t){return void 0===t&&(t=!1),Wr(this.dataSync(),this.shape,this.dtype,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),Yr.cast(this,t)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),Kr().makeVariable(this,t,e,n)},t}();function $r(){return tt("Tensor",(function(){return Zr}))}Object.defineProperty(Zr,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}}),$r();var Jr,Qr,ti,ei,ni,ri=function(t){function e(e,n,r,i){var a=t.call(this,e.shape,e.dtype,e.dataId,i)||this;return a.trainable=n,a.name=r,a}return o(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!T(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));Kr().disposeTensor(this),this.dataId=t.dataId,Kr().incRef(this,null)},e.prototype.dispose=function(){Kr().disposeVariable(this),this.isDisposedInternal=!0},e}(Zr);Object.defineProperty(ri,Symbol.hasInstance,{value:function(t){return t instanceof Zr&&null!=t.assign&&t.assign instanceof Function}}),n.Rank=void 0,(Jr=n.Rank||(n.Rank={})).R0="R0",Jr.R1="R1",Jr.R2="R2",Jr.R3="R3",Jr.R4="R4",Jr.R5="R5",Jr.R6="R6",function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Qr||(Qr={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(ti||(ti={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(ei||(ei={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(ni||(ni={}));var ii={float32:ei,int32:Qr,bool:ti,complex64:ni};function ai(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return ii[t][e]}function oi(t){return null!=t&&"object"==typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function si(t){return"undefined"!=typeof GPUBuffer&&null!=t&&"object"==typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}function ui(t,e){if(t.dtype===e.dtype)return[t,e];var n=ai(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function ci(t,e){b(t.dtype===e.dtype,(function(){return"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")}))}function li(t){var e=[];return hi(t,e,new Set),e}function hi(t,e,n){if(null!=t)if(t instanceof Zr)e.push(t);else if(r=t,Array.isArray(r)||"object"==typeof r){var r,i=t;for(var a in i){var o=i[a];n.has(o)||(n.add(o),hi(o,e,n))}}}var pi={__proto__:null,assertTypesMatch:ci,getTensorsInContainer:li,isTensorInList:function(t,e){return e.some((function(e){return e.id===t.id}))},makeTypesMatch:ui};function fi(t){return null!=t.kernelName}var di=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(t){return t.name}))))}}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),mi=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new di}return t.prototype.ready=function(){return s(this,void 0,void 0,(function(){var t,e,n;return u(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!1,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(Pn("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Lr(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;Gn(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;Gn(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{var r=n.factory();if(!r||r instanceof d||"function"!=typeof r.then)return this.registry[t]=r,{success:!0,asyncInit:!1};var i=++this.pendingBackendInitId,a=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return i<e.pendingBackendInitId||(e.pendingBackendInit=null,Pn("Initialization of backend ".concat(t," failed")),Pn(n.stack||n.message)),!1}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}catch(e){return Pn("Initialization of backend ".concat(t," failed")),Pn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.success,a=r.asyncInit;if(a||i)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),a=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=yi.runKernel(ne,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){var e={x:t};return yi.runKernel(bt,e,{dtype:"float32"})}}}),[],{}),e},t.prototype.runKernel=function(t,e,n){if(null==this.backendName&&this.backend,null==zn(t,this.backendName))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),i=0;n.forEach((function(t){i+="complex64"===t.dtype?3:1}));var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))},t.prototype.runKernelFunc=function(t){var e,n,r,i=this,a=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=fi(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(fi(t)){var l=t.kernelName,h=t.inputs,p=t.attrs;null==this.backendName&&this.backend;var f=zn(l,this.backendName);b(null!=f,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(i.backendName,"'")})),n=function(){var t=i.backend.numDataIds();r=f.kernelFunc({inputs:h,attrs:p,backend:i.backend});var e=Array.isArray(r)?r:[r];i.shouldCheckForMemLeaks()&&i.checkKernelForMemLeak(l,t,e);var n=e.map((function(t){return null!=t.rank?t:i.makeTensorFromTensorInfo(t)}));if(o){var s=i.getTensorsForGradient(l,h,n);a=i.saveTensorsForBackwardMode(s)}return n}}else{var d=t.forwardFunc,m=function(t){o&&(a=t.map((function(t){return i.keep(i.clone(t))})))};n=function(){var t=i.backend.numDataIds();r=i.tidy((function(){return d(i.backend,m)}));var e=Array.isArray(r)?r:[r];return i.shouldCheckForMemLeaks()&&i.checkKernelForMemLeak(c,t,e),e}}var g,v=t.inputs,y=t.attrs,x=fi(t)?null:t.backwardsFunc;return this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){i.ENV.getBool("DEBUG")||i.state.profiling?(g=i.profiler.profileKernel(c,v,(function(){return n()})),i.ENV.getBool("DEBUG")&&i.profiler.logKernelProfile(g),e=g.outputs):e=n()})),o&&this.addTapeNode(c,v,e,x,a,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(v).map((function(t){return null!=v[t]?v[t].shape:null})),outputShapes:e.map((function(t){return t.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(r)?e:e[0]},t.prototype.saveTensorsForBackwardMode=function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))},t.prototype.getTensorsForGradient=function(t,e,n){var r=Un(t);if(null!=r){var i=r.inputsToSave||[],a=r.outputsToSave||[],o=void 0;r.saveAllInputs?(b(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(e).map((function(t){return e[t]}))):o=i.map((function(t){return e[t]}));var s=n.filter((function(t,e){return a[e]}));return o.concat(s)}return[]},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var i=t;"string"===n&&F(t[0])&&(i=t.map((function(t){return Or(t)})));var a=r.write(i,e,n),o=new Zr(e,n,a,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(a),u=M(i);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},t.prototype.makeTensorFromDataId=function(t,e,n,r){var i={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)},t.prototype.makeTensorFromTensorInfo=function(t,e){var n=t.dataId,r=t.shape,i=t.dtype,a=new Zr(r,i,n,this.nextTensorId());return this.trackTensor(a,e),a},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));var i=new ri(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name ".concat(i.name," was already registered"));return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.trackTensor=function(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*D(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof ri||this.track(t)},t.prototype.incRef=function(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)},t.prototype.removeDataId=function(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){var e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){var n=t.size*D(t.dtype);this.state.numBytes-=n}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,c,f,d,m;return u(this,(function(u){switch(u.label){case 0:return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],r=this.state.activeProfile,[4,t()];case 1:r.result=u.sent(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,p([],h(this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),!1)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,u.label=2;case 2:u.trys.push([2,8,9,10]),i=l(this.state.activeProfile.kernels),a=i.next(),u.label=3;case 3:return a.done?[3,7]:(o=a.value,s=o,[4,o.kernelTimeMs]);case 4:return s.kernelTimeMs=u.sent(),c=o,[4,o.extraInfo];case 5:c.extraInfo=u.sent(),u.label=6;case 6:return a=i.next(),[3,3];case 7:return[3,10];case 8:return f=u.sent(),d={error:f},[3,10];case 9:try{a&&!a.done&&(m=i.return)&&m.call(i)}finally{if(d)throw d.error}return[7];case 10:return[2,this.state.activeProfile]}}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,i,a){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},u=Un(t);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],i=H(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],i,a)}),this.state.activeTape.push(s)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=li(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||r.has(a.id)||a.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),b(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var a=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));b(a instanceof Zr,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},i={},a=0;a<e.length;a++)r[e[a].id]=!0;for(a=0;a<t.length;a++){var o=(d=t[a]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){d.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[d.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var p={};for(a=t.length-1;a>=0;a--)for(o=(d=t[a]).inputs,l=0;l<d.outputs.length;l++)if(h[d.outputs[l].id]){for(var s in o)h[o[s].id]=!0,p[d.id]=!0;break}var f=[];for(a=0;a<t.length;a++){var d;if(i[(d=t[a]).id]&&p[d.id]){var m={};for(var s in d.inputs){var g=d.inputs[s];r[g.id]&&(m[s]=g)}var v=Object.assign({},d);v.inputs=m,v.outputs=d.outputs,f.push(v)}}return f}(this.state.activeTape,e,a);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[a.id]=n??(r=j(_(t=a.shape),"float32"),yi.makeTensor(r,t,"float32")),function(t,e,n,r){for(var i=function(i){var a=e[i],o=[];if(a.outputs.forEach((function(e){var n=t[e.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var s=a.gradient(o),u=function(e){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var i=n((function(){return s[e]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[e];if(!T(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=i;else{var u=t[o.id];t[o.id]=r(u,i),u.dispose()}};for(var c in a.inputs)u(c)},a=e.length-1;a>=0;a--)i(a)}(s,o,(function(t){return i.tidy(t)}),bi);var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){var e,n;try{for(var r=l(t.saved),i=r.next();!i.done;i=r.next())i.value.dispose()}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}})),i.state.activeTape=null),{value:a,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return b(z(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];b(r.every((function(t){return t instanceof Zr})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var a={};return r.forEach((function(t,e){a[e]=t})),e.runKernelFunc({forwardFunc:function(e,i){return b((n=t.apply(void 0,p([],h(p(p([],h(r),!1),[i],!1)),!1))).value instanceof Zr,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),b(z(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value},backwardsFunc:function(t,e){var i=n.gradFunc(t,e),a=Array.isArray(i)?i:[i];b(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),b(a.every((function(t){return t instanceof Zr})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(t,e){o[e]=function(){return t}})),o},inputs:a})}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.readToGPU=function(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)},t.prototype.time=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){switch(r.label){case 0:return e=Rr(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=Rr()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!1,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new di,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t}();function gi(){var t=Q();if(null==t._tfengine){var e=new Z(t);t._tfengine=new mi(e)}return function(t){n.ENV=t}(t._tfengine.ENV),Kr=function(){return t._tfengine},t._tfengine}mi.nextTensorId=0,mi.nextVariableId=0;var vi,yi=gi();function bi(t,e){var n={a:t,b:e};return yi.runKernel(rt,n)}function xi(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var wi={__proto__:null,isBrowser:xi,isMobile:function(t){if(void 0!==vi)return vi;if(t||"undefined"!=typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;var e=t.userAgent||t.vendor||("undefined"!=typeof window?window.opera:"");if(!e){var n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1},mockIsMobile:function(t){vi=t}},_i=J();function Si(t,e){var n=t;if(Mr(t))return"string"===e?[]:[t.length];if(oi(t)){var r=t.channels||"RGBA";return[t.height,t.width*r.length]}if(si(t))return[t.buffer.size/(null==e?4:D(e))];if(!Array.isArray(t))return[];for(var i=[];Array.isArray(n)||Mr(n)&&"string"!==e;)i.push(n.length),n=n[0];return Array.isArray(t)&&J().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Ti(t,i,[]),i}function Ti(t,e,n){if(n=n||[],Array.isArray(t)||Mr(t)){b(e.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")})),b(t.length===e[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")}));for(var r=e.slice(1),i=0;i<t.length;++i)Ti(t[i],r,n.concat(i))}else b(0===e.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")}))}function Ei(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function ki(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof $r())return Ei(r,t.dtype,e,n),t;var i=B(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Ei(r,i,e,n),null==t||!Mr(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){var a=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(a,"'"))}var o=Si(t,i);Mr(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?Cr(t,i):Fr(t,[],!0);return yi.makeTensor(s,o,i)}function Ii(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map((function(t,i){return ki(t,"".concat(e,"[").concat(i,"]"),n,r)}))}_i.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),_i.registerFlag("IS_BROWSER",(function(){return xi()})),_i.registerFlag("IS_NODE",(function(){return void 0!==e&&void 0!==e.versions&&void 0!==e.versions.node})),_i.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),_i.registerFlag("IS_SAFARI",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)})),_i.registerFlag("PROD",(function(){return!1})),_i.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return _i.getBool("DEBUG")})),_i.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),_i.registerFlag("IS_TEST",(function(){return!1})),_i.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return _i.getBool("DEBUG")})),_i.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),_i.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),_i.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var Ai="__op";function Ni(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=Ai;var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];yi.startScope(n);try{var i=r.apply(void 0,p([],h(t),!1));return q(i)&&console.error("Cannot return a Promise inside of tidy."),yi.endScope(i),i}catch(t){throw yi.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}var Ci=Ni({complex_:function(t,e){var n=ki(t,"real","complex"),r=ki(e,"imag","complex");x(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var i={real:n,imag:r};return yi.runKernel(_t,i)}});function Ri(t,e,n,r){if(null==r)r=B(t);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(si(t)||oi(t)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return yi.backend.createTensorFromGPUData(t,e||n,r)}if(!Mr(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){X(e);var i=_(e),a=_(n);b(i===a,(function(){return"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(i," values but has ").concat(a)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==_(e.slice(o));b(n[o]===e[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")}))}}return Mr(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?Cr(t,r):Fr(t,[],!0),yi.makeTensor(t,e,r)}function Oi(t,e,n){return Ri(t,e,Si(t,n),n)}var Di={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Mi=function(){function t(t){if(this.shards=[],this.previousShardIndex=0,null!=t&&(t instanceof Array||(t=[t]),0!==(t=t.map((function(t){return Mr(t)?t.buffer:t}))).length)){this.bufferUniformSize=t[0].byteLength;for(var e=0,n=0;n<t.length;n++){var r=t[n];n!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);var i=e+r.byteLength;this.shards.push({buffer:r,start:e,end:i}),e=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}}return t.join=function(e){return new t(e).slice()},t.prototype.slice=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=this.byteLength),0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),(e=Math.min(this.byteLength,e))<=t)return new ArrayBuffer(0);var n=this.findShardForByte(t);if(-1===n)throw new Error("Could not find start shard for byte ".concat(t));for(var r=new ArrayBuffer(e-t),i=new Uint8Array(r),a=0,o=n;o<this.shards.length;o++){var s=this.shards[o],u=t+a-s.start,c=a,l=Math.min(e,s.end)-s.start,h=new Uint8Array(s.buffer,u,l-u);if(i.set(h,c),a+=h.length,e<s.end)break}return r},t.prototype.findShardForByte=function(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(e){return t<e.start?-1:t>=e.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;var n=function(t,e){for(var n=0,r=t.length;n<=r;){var i=Math.floor((r-n)/2)+n,a=e(t[i]);if(0===a)return i;a<0?r=i:n=i+1}return-1}(this.shards,e);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)},t}();function Fi(t,e){return yi.tidy(t,e)}function Pi(t){li(t).forEach((function(t){return t.dispose()}))}function Li(t){return yi.keep(t)}function Bi(){return yi.backendName}function zi(){return yi.backend}var Ui=4;function Gi(t,e){var n,r,i=new Mi(t),a={},o=0;try{for(var s=l(e),u=s.next();!u.done;u=s.next()){var c=u.value,h=Wi(c,(function(t,e){return i.slice(o+t,o+e)}));a[c.name]=ji(c,i.slice(o,o+h)),o+=h}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a}function Wi(t,e){var n,r=_(t.shape);if("quantization"in t){var i=t.quantization;n=Di[i.dtype]}else{if("string"===t.dtype){for(var a=0,o=0;o<r;o++)a+=Ui+new Uint32Array(e(a,a+Ui))[0];return a}n=Di[t.dtype]}return r*n}function Vi(t,e){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s,c,l;return u(this,(function(u){switch(u.label){case 0:return n=_(t.shape),"quantization"in t?(i=t.quantization,r=Di[i.dtype],[3,7]):[3,1];case 1:if("string"!==t.dtype)return[3,6];a=0,o=0,u.label=2;case 2:return o<n?(s=a,c=Ui,l=Uint32Array.bind,[4,e(a,a+Ui)]):[3,5];case 3:a=s+(c+(new(l.apply(Uint32Array,[void 0,u.sent()])))[0]),u.label=4;case 4:return o++,[3,2];case 5:return[2,a];case 6:r=Di[t.dtype],u.label=7;case 7:return[2,n*r]}}))}))}function ji(t,e){var n,r,i,a,o=t.name,s=t.dtype,u=t.shape,c=_(u),l=0;if("quantization"in t){var h=t.quantization;if("uint8"===h.dtype||"uint16"===h.dtype){if(!("min"in h)||!("scale"in h))throw new Error("Weight ".concat(t.name," with quantization ").concat(h.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==h.dtype)throw new Error("Weight ".concat(t.name," has unknown ")+"quantization dtype ".concat(h.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==s)throw new Error("Weight ".concat(t.name," is quantized with ").concat(h.dtype," ")+"which only supports weights of type float32 not ".concat(s,"."))}var p=Di[h.dtype],f="uint8"===h.dtype?new Uint8Array(e):new Uint16Array(e);if("float32"===s)if("uint8"===h.dtype||"uint16"===h.dtype){n=new Float32Array(f.length);for(var d=0;d<f.length;d++){var m=f[d];n[d]=m*h.scale+h.min}}else{if("float16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type float32.");var g=(r=function(){var t=function(t){for(var e=t<<13,n=0;!(8388608&e);)n-=8388608,e<<=1;return(e&=-8388609)|n+947912704},e=new Uint32Array(2048);e[0]=0;for(var n=1;n<1024;n++)e[n]=t(n);for(n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),i=function(){var t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(var e=1;e<31;e++)t[e]=e<<23;for(e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),a=function(){for(var t=new Uint32Array(64),e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}(),function(t){for(var e=new ArrayBuffer(4*t.length),n=new Uint32Array(e),o=0;o<t.length;o++){var s=t[o],u=r[a[s>>10]+(1023&s)]+i[s>>10];n[o]=u}return new Float32Array(e)});n=g(f)}else{if("int32"!==s)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s));if("uint8"!==h.dtype&&"uint16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type int32.");for(n=new Int32Array(f.length),d=0;d<f.length;d++)m=f[d],n[d]=Math.round(m*h.scale+h.min)}l+=c*p}else if("string"===s){var v=_(t.shape);for(n=[],d=0;d<v;d++){var y=new Uint32Array(e.slice(l,l+Ui))[0];l+=Ui;var b=new Uint8Array(e.slice(l,l+y));n.push(b),l+=y}}else{var x=Di[s];if("float32"===s)n=new Float32Array(e);else if("int32"===s)n=new Int32Array(e);else{if("bool"!==s){if("complex64"===s){n=new Float32Array(e);var w=new Float32Array(n.length/2),S=new Float32Array(n.length/2);for(d=0;d<w.length;d++)w[d]=n[2*d],S[d]=n[2*d+1];var T=Oi(w,u,"float32"),E=Oi(S,u,"float32"),k=Ci(T,E);return T.dispose(),E.dispose(),k}throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s))}n=new Uint8Array(e)}l+=c*x}return Oi(n,u,s)}function Hi(t,e,n){return s(this,void 0,void 0,(function(){var r,i,a,o,s,c;return u(this,(function(u){switch(u.label){case 0:r=new Uint8Array(e),u.label=1;case 1:return r.byteLength<n?[4,t.read()]:[3,3];case 2:if(i=u.sent(),a=i.done,o=i.value,a&&null==o)throw s=n-r.byteLength,new Error("Reader is done but ".concat(s," bytes are still expected"));return(c=new Uint8Array(r.length+o.byteLength)).set(r,0),c.set(new Uint8Array(o),r.length),r=c,[3,1];case 3:return[2,r.buffer]}}))}))}function Xi(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var qi=void 0!==i&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Ki(t){return qi?i.byteLength(t,"utf8"):new Blob([t]).size}function Yi(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function Zi(t,e){var n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(n.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function $i(t,e,n){var r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(r.initializerSignature=t.initializerSignature),r}function Ji(t,e){return s(this,void 0,void 0,(function(){var n,r,i;return u(this,(function(a){switch(a.label){case 0:return null==t.weightsManifest?[3,2]:[4,e(t.weightsManifest)];case 1:i=h.apply(void 0,[a.sent(),2]),n=i[0],r=i[1],a.label=2;case 2:return[2,$i(t,n,r)]}}))}))}function Qi(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Ki(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Ki(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:new Mi(t.weightData).byteLength}}function ta(t){var e,n,r=[];try{for(var i=l(t),a=i.next();!a.done;a=i.next()){var o=a.value;r.push.apply(r,p([],h(o.weights),!1))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}var ea=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),na="tensorflowjs",ra="models_store",ia="model_info_store";function aa(){if(!J().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function oa(t){var e=t.result;e.createObjectStore(ra,{keyPath:"modelPath"}),e.createObjectStore(ia,{keyPath:"modelPath"})}var sa=function(){function t(t){if(this.indexedDB=aa(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open(na,1);i.onupgradeneeded=function(){return oa(i)},i.onsuccess=function(){var a=i.result;if(null==e){var o=a.transaction(ra,"readonly"),s=o.objectStore(ra).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return a.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return a.close(),r(s.error)},o.oncomplete=function(){return a.close()}}else{e.weightData=Mi.join(e.weightData);var u,c,l=Qi(e),h=a.transaction(ia,"readwrite"),p=h.objectStore(ia);try{u=p.put({modelPath:n.modelPath,modelArtifactsInfo:l})}catch(t){return r(t)}u.onsuccess=function(){var i,o=(c=a.transaction(ra,"readwrite")).objectStore(ra);try{i=o.put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:l})}catch(t){return r(t)}i.onsuccess=function(){return t({modelArtifactsInfo:l})},i.onerror=function(t){var e=(p=h.objectStore(ia)).delete(n.modelPath);e.onsuccess=function(){return a.close(),r(i.error)},e.onerror=function(t){return a.close(),r(i.error)}}},u.onerror=function(t){return a.close(),r(u.error)},h.oncomplete=function(){null==c?a.close():c.oncomplete=function(){return a.close()}}}},i.onerror=function(t){return r(i.error)}}))},t}();sa.URL_SCHEME="indexeddb://";var ua=function(t){return J().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(sa.URL_SCHEME)?(e=t.slice(sa.URL_SCHEME.length),new sa(e)):null;var e};ea.registerSaveRouter(ua),ea.registerLoadRouter(ua);var ca=function(){function t(){this.indexedDB=aa()}return t.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open(na,1);r.onupgradeneeded=function(){return oa(r)},r.onsuccess=function(){var t=r.result,i=t.transaction(ia,"readonly"),a=i.objectStore(ia).getAll();a.onsuccess=function(){var t,n,r={};try{for(var i=l(a.result),o=i.next();!o.done;o=i.next()){var s=o.value;r[s.modelPath]=s.modelArtifactsInfo}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e(r)},a.onerror=function(e){return t.close(),n(a.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return s(this,void 0,void 0,(function(){var e=this;return u(this,(function(n){var r;return t=(r=t).startsWith(sa.URL_SCHEME)?r.slice(sa.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open(na,1);i.onupgradeneeded=function(){return oa(i)},i.onsuccess=function(){var e,a=i.result,o=a.transaction(ia,"readwrite"),s=o.objectStore(ia),u=s.get(t);u.onsuccess=function(){if(null==u.result)return a.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var i=s.delete(t),o=function(){var i=(e=a.transaction(ra,"readwrite")).objectStore(ra).delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=o,i.onerror=function(t){return o(),a.close(),r(u.error)}},u.onerror=function(t){return a.close(),r(u.error)},o.oncomplete=function(){null==e?a.close():e.oncomplete=function(){return a.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}(),la="/",ha="tensorflowjs_models",pa="info",fa="model_topology",da="weight_specs",ma="weight_data",ga="model_metadata";function va(t){return{info:[ha,t,pa].join(la),topology:[ha,t,fa].join(la),weightSpecs:[ha,t,da].join(la),weightData:[ha,t,ma].join(la),modelMetadata:[ha,t,ga].join(la)}}function ya(t){var e,n;try{for(var r=l(Object.values(t)),i=r.next();!i.done;i=r.next()){var a=i.value;window.localStorage.removeItem(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}function ba(t){var e=t.split(la);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(la)}var xa=function(){function t(t){if(!J().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=va(this.modelPath)}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r,a,o;return u(this,(function(s){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Qi(t),a=Mi.join(t.weightData);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(qi)return i.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(a)),o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),[2,{modelArtifactsInfo:r}]}catch(t){throw ya(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(r.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(r.weightSpecsBytes,", ")+"weightDataBytes=".concat(r.weightDataBytes,"."))}return[2]}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,a,o,s;return u(this,(function(u){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");if(e.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(a),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy,null!=o.signature&&(e.signature=o.signature),null!=o.userDefinedMetadata&&(e.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(e.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(e.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(e.trainingConfig=o.trainingConfig)),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return e.weightData=function(t){if(qi){var e=i.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),[2,e]}))}))},t}();xa.URL_SCHEME="localstorage://";var wa=function(t){return J().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(xa.URL_SCHEME)?(e=t.slice(xa.URL_SCHEME.length),new xa(e)):null;var e};ea.registerSaveRouter(wa),ea.registerLoadRouter(wa);var _a=function(){function t(){b(J().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),b("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,a;return u(this,(function(o){for(t={},e=ha+la,n=la+pa,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(a=ba(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){var i;if(t=(i=t).startsWith(xa.URL_SCHEME)?i.slice(xa.URL_SCHEME.length):i,e=va(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '".concat(t,"'"));return n=JSON.parse(this.LS.getItem(e.info)),ya(e),[2,n]}))}))},t}(),Sa="://",Ta=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){b(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(Sa)&&(e=e.slice(0,e.indexOf(Sa))),b(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();b(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '".concat(e,"'.")})),r.managers[e]=n},t.getManager=function(e){var n=t.getInstance().managers[e];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return n},t.getSchemes=function(){return Object.keys(t.getInstance().managers)},t}();function Ea(t){if(-1===t.indexOf(Sa))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Ta.getSchemes().join(",")));return{scheme:t.split(Sa)[0],path:t.split(Sa)[1]}}function ka(t,e,n){return void 0===n&&(n=!1),s(this,void 0,void 0,(function(){var r,i,a,o,s,c,l,h,p;return u(this,(function(u){switch(u.label){case 0:return b(t!==e,(function(){return"Old path and new path are the same: '".concat(t,"'")})),b((r=ea.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),b(r.length<2,(function(){return"Copying failed because more than one (".concat(r.length,") ")+"load handlers for source URL ".concat(t,".")})),i=r[0],b((a=ea.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(e,".")})),b(a.length<2,(function(){return"Copying failed because more than one (".concat(r.length,") ")+"save handlers for destination URL ".concat(e,".")})),o=a[0],s=Ea(t).scheme,c=Ea(t).path,l=s===Ea(t).scheme,[4,i.load()];case 1:return h=u.sent(),n&&l?[4,Ta.getManager(s).removeModel(c)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[4,o.save(h)];case 4:return p=u.sent(),!n||l?[3,6]:[4,Ta.getManager(s).removeModel(c)];case 5:u.sent(),u.label=6;case 6:return[2,p.modelArtifactsInfo]}}))}))}var Ia=function(){function t(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t.prototype.setTimeoutCustom=function(t,e){var n=this;"undefined"!=typeof window&&J().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(t){t.source===window&&t.data.name===n.messageName&&(t.stopPropagation(),(0,n.functionRefs[t.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(t,e)},t.prototype.isTypedArray=function(t){return jn(t)},t}();if(J().get("IS_BROWSER")){J().setPlatform("browser",new Ia);try{Ta.registerManager(xa.URL_SCHEME,new _a)}catch(t){}try{Ta.registerManager(sa.URL_SCHEME,new ca)}catch(t){}}var Aa,Na=function(){return t("node-fetch")},Ca=function(){function n(){this.util=t("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(t,e){return null!=J().global.fetch?J().global.fetch(t,e):(null==Aa&&(Aa=Na()),Aa(t,e))},n.prototype.now=function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6},n.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},n.prototype.isTypedArray=function(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)},n}();function Ra(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",X(t),new qr(t,e,n)}J().get("IS_NODE")&&!J().get("IS_BROWSER")&&J().setPlatform("node",new Ca);var Oa=Ni({cast_:function(t,e){var n=ki(t,"x","cast");if(!O(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},i={dtype:e};return yi.runKernel(bt,r,i)}}),Da=Ni({clone_:function(t){var e={x:ki(t,"x","clone","string_or_numeric")};return yi.runKernel(ne,e)}});function Ma(t,e){void 0===e&&(e=!1),console.log(t.toString(e))}gi(),Yr={buffer:Ra,cast:Oa,clone:Da,print:Ma};var Fa=Ni({add_:function(t,e){var n,r=ki(t,"a","add"),i=ki(e,"b","add"),a={a:r=(n=h(ui(r,i),2))[0],b:i=n[1]};return yi.runKernel(rt,a)}}),Pa=Ni({floorDiv_:function(t,e){var n,r=ki(t,"a","floorDiv"),i=ki(e,"b","floorDiv"),a={a:r=(n=h(ui(r,i),2))[0],b:i=n[1]};return yi.runKernel(Zt,a)}}),La=Ni({div_:function(t,e){var n,r=ki(t,"a","div"),i=ki(e,"b","div");if(r=(n=h(ui(r,i),2))[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype)return Pa(r,i);var a={a:r,b:i};return yi.runKernel(Wt,a,{})}}),Ba=Ni({mul_:function(t,e){var n,r=ki(t,"a","mul"),i=ki(e,"b","mul"),a={a:r=(n=h(ui(r,i),2))[0],b:i=n[1]};return yi.runKernel(Te,a)}}),za=Ni({abs_:function(t){var e=ki(t,"x","abs");if("complex64"===e.dtype){var n={x:e};return yi.runKernel(St,n)}return n={x:e},yi.runKernel("Abs",n)}}),Ua=Ni({acos_:function(t){var e={x:ki(t,"x","acos")};return yi.runKernel(et,e)}}),Ga=Ni({acosh_:function(t){var e={x:ki(t,"x","acosh")};return yi.runKernel(nt,e)}}),Wa=Ni({addN_:function(t){b(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),b(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)}));var e=t.map((function(t,e){return ki(t,"tensors".concat(e),"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!T(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return yi.runKernel(it,r)}}),Va=Ni({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:ki(t,"x","all","bool")},i={axis:e,keepDims:n};return yi.runKernel("All",r,i)}}),ja=Ni({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:ki(t,"x","any","bool")},i={axis:e,keepDims:n};return yi.runKernel("Any",r,i)}}),Ha=Ni({argMax_:function(t,e){void 0===e&&(e=0);var n={x:ki(t,"x","argMax")},r={axis:e};return yi.runKernel(at,n,r)}}),Xa=Ni({argMin_:function(t,e){void 0===e&&(e=0);var n={x:ki(t,"x","argMin")},r={axis:e};return yi.runKernel(ot,n,r)}}),qa=Ni({asin_:function(t){var e={x:ki(t,"x","asin")};return yi.runKernel(st,e)}}),Ka=Ni({asinh_:function(t){var e={x:ki(t,"x","asinh")};return yi.runKernel(ut,e)}}),Ya=Ni({atan_:function(t){var e={x:ki(t,"x","atan")};return yi.runKernel(ct,e)}}),Za=Ni({atan2_:function(t,e){var n,r=ki(t,"a","atan2"),i=ki(e,"b","atan2"),a={a:r=(n=h(ui(r,i),2))[0],b:i=n[1]};return yi.runKernel(ht,a)}}),$a=Ni({atanh_:function(t){var e={x:ki(t,"x","atanh")};return yi.runKernel(lt,e)}});function Ja(t,e,n,r,i,a,o){void 0===o&&(o="channelsLast");var s,u=h(no(e),2),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));s=[c,l,t[1],t[1]]}return Qa(t,s,n,r,i,a,!1,o)}function Qa(t,e,n,r,i,a,o,s){var u,c;void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var l=h([-1,-1,-1,-1],4),p=l[0],f=l[1],d=l[2],m=l[3];if("channelsLast"===s)p=(u=h(t,4))[0],f=u[1],d=u[2],m=u[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));p=(c=h(t,4))[0],m=c[1],f=c[2],d=c[3]}var g,v=h(e,4),y=v[0],b=v[1],x=v[3],w=h(no(n),2),_=w[0],S=w[1],T=h(no(r),2),E=T[0],k=T[1],I=io(y,E),A=io(b,k),N=function(t,e,n,r,i,a,o,s,u){var c,l,h;if("number"==typeof t){c={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var p=function(t,e,n,r,i){null==r&&(r=eo(t,e,n));var a=t[1];return[ao((t[0]-e+2*r)/n+1,i),ao((a-e+2*r)/n+1,i)]}([e,n],a,r,t,s);l=p[0],h=p[1]}else if("same"===t){l=Math.ceil(e/r),h=Math.ceil(n/i);var f=Math.max(0,(l-1)*r+a-e),d=Math.max(0,(h-1)*i+o-n);c={top:m=Math.floor(f/2),bottom:g=f-m,left:v=Math.floor(d/2),right:y=d-v,type:"SAME"}}else if("valid"===t)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-a+1)/r),h=Math.ceil((n-o+1)/i);else{if("object"!=typeof t)throw Error("Unknown padding parameter: ".concat(t));var m,g,v,y;c={top:m="channelsLast"===u?t[1][0]:t[2][0],bottom:g="channelsLast"===u?t[1][1]:t[2][1],left:v="channelsLast"===u?t[2][0]:t[3][0],right:y="channelsLast"===u?t[2][1]:t[3][1],type:0===m&&0===g&&0===v&&0===y?"VALID":"EXPLICIT"},l=ao((e-a+m+g)/r+1,s),h=ao((n-o+v+y)/i+1,s)}return{padInfo:c,outHeight:l,outWidth:h}}(i,f,d,_,S,I,A,a,s),C=N.padInfo,R=N.outHeight,O=N.outWidth,D=o?x*m:x;return"channelsFirst"===s?g=[p,D,R,O]:"channelsLast"===s&&(g=[p,R,O,D]),{batchSize:p,dataFormat:s,inHeight:f,inWidth:d,inChannels:m,outHeight:R,outWidth:O,outChannels:D,padInfo:C,strideHeight:_,strideWidth:S,filterHeight:y,filterWidth:b,effectiveFilterHeight:I,effectiveFilterWidth:A,dilationHeight:E,dilationWidth:k,inShape:t,outShape:g,filterShape:e}}function to(t,e,n,r,i,a,o,s){var u,c;void 0===a&&(a=!1),void 0===o&&(o="channelsLast");var l=h([-1,-1,-1,-1,-1],5),p=l[0],f=l[1],d=l[2],m=l[3],g=l[4];if("channelsLast"===o)p=(u=h(t,5))[0],f=u[1],d=u[2],m=u[3],g=u[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));p=(c=h(t,5))[0],g=c[1],f=c[2],d=c[3],m=c[4]}var v,y=h(e,5),b=y[0],x=y[1],w=y[2],_=y[4],S=h(ro(n),3),T=S[0],E=S[1],k=S[2],I=h(ro(r),3),A=I[0],N=I[1],C=I[2],R=io(b,A),O=io(x,N),D=io(w,C),M=function(t,e,n,r,i,a,o,s,u,c,l){var h,p,f,d;if("valid"===t&&(t=0),"number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var m=function(t,e,n,r,i,a){null==i&&(i=eo(t,e[0],r[0]));for(var o=[0,0,0,1],s=0;s<3;s++)t[s]+2*i>=e[s]&&(o[s]=ao((t[s]-e[s]+2*i)/r[s]+1,a));return o}([e,n,r,1],[s,u,c],0,[i,a,o],t,l);p=m[0],f=m[1],d=m[2]}else{if("same"!==t)throw Error("Unknown padding parameter: ".concat(t));var g=((p=Math.ceil(e/i))-1)*i+s-e,v=((f=Math.ceil(n/a))-1)*a+u-n,y=((d=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(g/2),x=g-b,w=Math.floor(v/2),_=v-w,S=Math.floor(y/2);h={top:w,bottom:_,left:S,right:y-S,front:b,back:x,type:"SAME"}}return{padInfo:h,outDepth:p,outHeight:f,outWidth:d}}(i,f,d,m,T,E,k,R,O,D,s),F=M.padInfo,P=M.outDepth,L=M.outHeight,B=M.outWidth,z=a?_*g:_;return"channelsFirst"===o?v=[p,z,P,L,B]:"channelsLast"===o&&(v=[p,P,L,B,z]),{batchSize:p,dataFormat:o,inDepth:f,inHeight:d,inWidth:m,inChannels:g,outDepth:P,outHeight:L,outWidth:B,outChannels:z,padInfo:F,strideDepth:T,strideHeight:E,strideWidth:k,filterDepth:b,filterHeight:x,filterWidth:w,effectiveFilterDepth:R,effectiveFilterHeight:O,effectiveFilterWidth:D,dilationDepth:A,dilationHeight:N,dilationWidth:C,inShape:t,outShape:v,filterShape:e}}function eo(t,e,n,r){void 0===r&&(r=1);var i=io(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function no(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function ro(t){return"number"==typeof t?[t,t,t]:t}function io(t,e){return e<=1?t:t+(t-1)*(e-1)}function ao(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function oo(t){var e=h(no(t),3),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function so(t,e){return oo(t)||oo(e)}function uo(t){return no(t).every((function(t){return t>0}))}function co(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}function lo(t,e,n){if(null!=n){if("string"==typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"==typeof e)b(E(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}));else{if("object"!=typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach((function(e){e.forEach((function(e){b(E(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}))}))}))}}}var ho=Ni({reshape_:function(t,e){var n={x:ki(t,"x","reshape","string_or_numeric")},r={shape:e};return yi.runKernel(We,n,r)}}),po=Ni({avgPool_:function(t,e,n,r,i){var a=ki(t,"x","avgPool","float32");b(so(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=a,s=!1;3===a.rank&&(s=!0,o=ho(a,[1,a.shape[0],a.shape[1],a.shape[2]])),b(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),lo("avgPool",r,i);var u={x:o},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i},l=yi.runKernel(pt,u,c);return l=Oa(l,a.dtype),s?ho(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),fo=Ni({avgPool3d_:function(t,e,n,r,i,a){void 0===a&&(a="NDHWC");var o=ki(t,"x","avgPool3d","float32"),s=o,u=!1;4===o.rank&&(u=!0,s=ho(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),b(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),b("NDHWC"===a,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a)})),b("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),lo("avgPool3d",r,i);var c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},h=yi.runKernel(ft,c,l);return h=Oa(h,s.dtype),u?ho(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),mo=Ni({concat_:function(t,e){void 0===e&&(e=0),b(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Ii(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return Da(n[0]);var r=n,i={axis:e};return yi.runKernel(Tt,r,i)}}),go=Ni({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var a=ki(t,"a","matMul"),o=ki(e,"b","matMul"),s={a:a=(i=h(ui(a,o),2))[0],b:o=i[1]},u={transposeA:n,transposeB:r};return yi.runKernel(dt,s,u)}}),vo=Ni({sigmoid_:function(t){var e={x:ki(t,"x","sigmoid","float32")};return yi.runKernel(rn,e)}}),yo=Ni({slice_:function(t,e,n){var r=ki(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var i={x:r},a={begin:e,size:n};return yi.runKernel(tn,i,a)}}),bo=Ni({tanh_:function(t){var e={x:ki(t,"x","tanh","float32")};return yi.runKernel(wn,e)}}),xo=Ni({basicLSTMCell_:function(t,e,n,r,i,a){var o=ki(t,"forgetBias","basicLSTMCell"),s=ki(e,"lstmKernel","basicLSTMCell"),u=ki(n,"lstmBias","basicLSTMCell"),c=ki(r,"data","basicLSTMCell"),l=ki(i,"c","basicLSTMCell"),h=ki(a,"h","basicLSTMCell"),p=mo([c,h],1),f=go(p,s),d=Fa(f,u),m=d.shape[0],g=d.shape[1]/4,v=[m,g],y=yo(d,[0,0],v),b=yo(d,[0,g],v),x=yo(d,[0,2*g],v),w=yo(d,[0,3*g],v),_=Fa(Ba(vo(y),bo(b)),Ba(l,vo(Fa(o,x))));return[_,Ba(bo(_),vo(w))]}}),wo=Ni({batchToSpaceND_:function(t,e,n){var r=ki(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));b(r.rank>=1+e.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(e.length)})),b(n.length===e.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length)})),b(r.shape[0]%i==0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(i)}));var a={x:r},o={blockShape:e,crops:n};return yi.runKernel(mt,a,o)}}),_o=Ni({batchNorm_:function(t,e,n,r,i,a){null==a&&(a=.001);var o,s,u=ki(t,"x","batchNorm"),c=ki(e,"mean","batchNorm"),l=ki(n,"variance","batchNorm");null!=i&&(o=ki(i,"scale","batchNorm")),null!=r&&(s=ki(r,"offset","batchNorm")),b(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),b(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),b(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h={x:function(t){return 0===t.rank||1===t.rank?ho(t,[1,1,1,t.size]):2===t.rank?ho(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?ho(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t}(u),scale:o,offset:s,mean:c,variance:l},p={varianceEpsilon:a},f=yi.runKernel($t,h,p);return ho(f,u.shape)}}),So=Ni({batchNorm2d_:function(t,e,n,r,i,a){var o,s,u=ki(t,"x","batchNorm"),c=ki(e,"mean","batchNorm"),l=ki(n,"variance","batchNorm");return null!=i&&(o=ki(i,"scale","batchNorm")),null!=r&&(s=ki(r,"offset","batchNorm")),b(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),b(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),b(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&b(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&b(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),_o(u,c,l,s,o,a)}}),To=Ni({batchNorm3d_:function(t,e,n,r,i,a){var o,s,u=ki(t,"x","batchNorm"),c=ki(e,"mean","batchNorm"),l=ki(n,"variance","batchNorm");return null!=i&&(o=ki(i,"scale","batchNorm")),null!=r&&(s=ki(r,"offset","batchNorm")),b(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),b(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),b(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&b(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&b(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),_o(u,c,l,s,o,a)}}),Eo=Ni({batchNorm4d_:function(t,e,n,r,i,a){var o,s,u=ki(t,"x","batchNorm"),c=ki(e,"mean","batchNorm"),l=ki(n,"variance","batchNorm");return null!=i&&(o=ki(i,"scale","batchNorm")),null!=r&&(s=ki(r,"offset","batchNorm")),b(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),b(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),b(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&b(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&b(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),_o(u,c,l,s,o,a)}}),ko=Ni({bincount_:function(t,e,n){var r=ki(t,"x","bincount"),i=ki(e,"weights","bincount");b("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),b(i.size===r.size||0===i.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(i.shape,".")}));var a={x:r,weights:i},o={size:n};return yi.runKernel(gt,a,o)}}),Io=Ni({bitwiseAnd_:function(t,e){var n=ki(t,"x","bitwiseAnd"),r=ki(e,"y","bitwiseAnd");if(!T(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));var i={a:n,b:r};return yi.runKernel(vt,i)}}),Ao=Ni({broadcastArgs_:function(t,e){var n=ki(t,"s0","broadcastArgs","int32"),r=ki(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));var i={s0:n,s1:r};return yi.runKernel(yt,i)}}),No=Ni({broadcastTo_:function(t,e){var n=ki(t,"broadcastTo","x"),r=n.shape;if(X(e),e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){for(var i=n.shape.slice();i.length<e.length;)i.unshift(1);n=ho(n,i)}for(var a=n.shape,o=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(e,"]."));if(0===o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0})).length)return Da(n);var u={x:n},c={reps:o};return yi.runKernel(_n,u,c)}}),Co=Ni({ceil_:function(t){var e={x:ki(t,"x","ceil","float32")};return yi.runKernel(xt,e)}});function Ro(t,e,n){X(t);var r={shape:t,value:e,dtype:n=n||B(e)};return yi.runKernel(qt,{},r)}var Oo=Ni({clipByValue_:function(t,e,n){var r=ki(t,"x","clipByValue");if(b(e<=n,(function(){return"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,").")})),e===n)return Ro(r.shape,e,r.dtype);var i={x:r},a={clipValueMin:e,clipValueMax:n};return yi.runKernel(wt,i,a)}}),Do=Ni({concat1d_:function(t){return mo(t,0)}}),Mo=Ni({concat2d_:function(t,e){return mo(t,e)}}),Fo=Ni({concat3d_:function(t,e){return mo(t,e)}}),Po=Ni({concat4d_:function(t,e){return mo(t,e)}}),Lo=Ni({conv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=ki(t,"x","conv2d","float32"),u=ki(e,"filter","conv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=ho(s,[1,s.shape[0],s.shape[1],s.shape[2]])),b(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),b(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),lo("conv2d",r,o);var h="NHWC"===i?c.shape[3]:c.shape[1];b(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),b(so(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'")})),b(uo(a),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),b(uo(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var p={x:c,filter:u},f={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},d=yi.runKernel(Et,p,f);return l?ho(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Bo=Ni({conv1d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NWC"),void 0===a&&(a=1);var s=ki(t,"x","conv1d"),u=ki(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=ho(s,[1,s.shape[0],s.shape[1]])),b(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),b(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),lo("conv1d",r,o),b(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),b(so(n,a),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(a,"'")})),b(uo(a),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),b(uo(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),b("NWC"===i,(function(){return"Error in conv1d: got dataFormat of ".concat(i," but only NWC is currently supported.")}));var h=ho(u,[1,u.shape[0],u.shape[1],u.shape[2]]),p=ho(c,[c.shape[0],1,c.shape[1],c.shape[2]]),f=Lo(p,h,[1,n],r,"NHWC",[1,a],o);return ho(f,l?[f.shape[2],f.shape[3]]:[f.shape[0],f.shape[2],f.shape[3]])}}),zo=Ni({conv2DBackpropInput_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC"),b(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=ho(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),b(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),b(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),b(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===a?s[3]:s[1],h="NHWC"===a?u.shape[3]:u.shape[1];b(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),b(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),lo("conv2dDerInput",i,o);var p={dy:u,filter:n},f={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,inputShape:s},d=yi.runKernel(It,p,f);return c?ho(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Uo=Ni({conv2dTranspose_:function(t,e,n,r,i,a){var o=ki(t,"x","conv2dTranspose"),s=ki(e,"filter","conv2dTranspose");return zo(n,o,s,r,i,"NHWC",a)}}),Go=Ni({conv3d_:function(t,e,n,r,i,a){void 0===i&&(i="NDHWC"),void 0===a&&(a=[1,1,1]);var o=ki(t,"x","conv3d"),s=ki(e,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=ho(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),b(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),b(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),b(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),b(so(n,a),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'")})),b("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of ".concat(i," but only NDHWC is currently supported.")})),b(uo(a),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),b(uo(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var l={x:u,filter:s},h={strides:n,pad:r,dataFormat:i,dilations:a},p=yi.runKernel(At,l,h);return c?ho(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),Wo=Ni({conv3DBackpropInput_:function(t,e,n,r,i){b(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var a=t,o=e,s=!1;4===e.rank&&(s=!0,o=ho(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);var u=a[4],c=o.shape[4];b(5===a.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(a.length,".")})),b(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),b(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),b(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),b(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},h={pad:i,strides:r,inputShape:a},p=yi.runKernel(Nt,l,h);return s?ho(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),Vo=Ni({conv3dTranspose_:function(t,e,n,r,i){var a=ki(t,"x","conv3dTranspose"),o=ki(e,"filter","conv3dTranspose");return Wo(n,a,o,r,i)}}),jo=Ni({cos_:function(t){var e={x:ki(t,"x","cos","float32")};return yi.runKernel("Cos",e)}}),Ho=Ni({cosh_:function(t){var e={x:ki(t,"x","cosh","float32")};return yi.runKernel(Ct,e)}}),Xo=Ni({cumprod_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i={x:ki(t,"x","cumprod")},a={axis:e,exclusive:n,reverse:r};return yi.runKernel(Rt,i,a)}}),qo=Ni({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i={x:ki(t,"x","cumsum")},a={axis:e,exclusive:n,reverse:r};return yi.runKernel(Ot,i,a)}}),Ko=Ni({denseBincount_:function(t,e,n,r){void 0===r&&(r=!1);var i=ki(t,"x","denseBincount"),a=ki(e,"weights","denseBincount");b("int32"===i.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(i.dtype)})),b(i.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(i.rank,".")})),b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),b(a.size===i.size||0===a.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(i.shape,", weights shape: ")+"".concat(a.shape,".")}));var o={x:i,weights:a},s={size:n,binaryOutput:r};return yi.runKernel(Mt,o,s)}}),Yo=Ni({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=ki(t,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];b(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(e)})),b(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(r.shape)})),b(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(e," for depthToSpace with input shape\n        ").concat(r.shape)})),b(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:e,dataFormat:n};return yi.runKernel(Ft,s,u)}}),Zo=Ni({depthwiseConv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=ki(t,"x","depthwiseConv2d","float32"),u=ki(e,"filter","depthwiseConv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=ho(s,[1,s.shape[0],s.shape[1],s.shape[2]])),b(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),b(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")}));var h="NHWC"===i?c.shape[3]:c.shape[1];b(h===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),lo("depthwiseConv2d",r,o);var p={x:c,filter:u},f={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},d=yi.runKernel(Pt,p,f);return l?ho(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),$o=Ni({diag_:function(t){var e={x:ki(t,"x","diag")};return yi.runKernel(zt,e)}}),Jo=Ni({dilation2d_:function(t,e,n,r,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var o=ki(t,"x","dilation2d"),s=ki(e,"filter","dilation2d");b(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),b(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),b("NHWC"===a,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(a)}));var u=o,c=!1;3===o.rank&&(u=ho(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),b(u.shape[3]===s.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(s.shape[2])}));var l={x:u,filter:s},h={strides:n,pad:r,dilations:i},p=yi.runKernel(Ut,l,h);return c?ho(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});function Qo(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var a=n-1-i,o=t[a]||1;(e[e.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function ts(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function es(t,e){for(var n=Math.max(t.length,e.length),r=new Array(n),i=0;i<n;i++){var a=t[t.length-i-1];null==a&&(a=1);var o=e[e.length-i-1];if(null==o&&(o=1),1===a)r[n-i-1]=o;else if(1===o)r[n-i-1]=a;else{if(a!==o){var s="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(s)}r[n-i-1]=a}}return r}var ns={__proto__:null,assertAndGetBroadcastShape:es,getBroadcastDims:Qo,getReductionAxes:ts},rs=Ni({equal_:function(t,e){var n,r=ki(t,"a","equal","string_or_numeric"),i=ki(e,"b","equal","string_or_numeric");r=(n=h(ui(r,i),2))[0],i=n[1],es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(jt,a)}}),is=Ni({where_:function(t,e,n){var r=ki(e,"a","where"),i=ki(n,"b","where"),a=ki(t,"condition","where","bool"),o=es(es(a.shape,r.shape),i.shape),s={condition:No(a,o),t:No(r,o),e:No(i,o)};return yi.runKernel(Je,s)}}),as=Ni({zerosLike_:function(t){var e={x:ki(t,"x","zerosLike")};return yi.runKernel(Nn,e)}}),os=Ni({divNoNan_:function(t,e){var n,r=ki(t,"a","div"),i=ki(e,"b","div");r=(n=h(ui(r,i),2))[0],i=n[1];var a=La(r,i),o=as(a),s=rs(i,o);return is(s,o,a)}}),ss=Ni({dot_:function(t,e){var n=ki(t,"t1","dot"),r=ki(e,"t2","dot");b(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(b(i===a,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(i," and ").concat(a,".")})),1===n.rank&&1===r.rank){var o=ho(n,[1,-1]),s=ho(r,[-1,1]),u=go(o,s);return ho(u,[])}return 1===n.rank&&2===r.rank?(o=ho(n,[1,-1]),s=ho(r,[r.shape[0],r.shape[1]]),u=go(o,s),ho(u,[u.size])):2===n.rank&&1===r.rank?(s=ho(r,[-1,1]),u=go(n,s),ho(u,[u.size])):(s=ho(r,[r.shape[0],r.shape[1]]),go(n,s))}}),us=Ni({einsum_:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e.map((function(t,e){return ki(t,"tensors".concat(e),"einsum")})),i={equation:t};return yi.runKernel(Vt,r,i)}}),cs=Ni({elu_:function(t){var e={x:ki(t,"x","elu","float32")};return yi.runKernel("Elu",e)}}),ls=Ni({ensureShape_:function(t,e){var n=ki(t,"x","ensureShape","string_or_numeric");if(!S(n.shape,e))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(e));return t}}),hs=Ni({erf_:function(t){var e=ki(t,"x","erf");b("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=Oa(e,"float32"));var n={x:e};return yi.runKernel("Erf",n)}});function ps(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function fs(t,e,n){for(var r=t.length+e.length,i=[],a=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}function ds(t,e){return fs(t,e.map((function(t){return 1})),e)}var ms=Ni({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:ki(t,"x","max")},i={reductionIndices:e,keepDims:n};return yi.runKernel("Max",r,i)}}),gs=Ni({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:ki(t,"x","min")},i={axis:e,keepDims:n};return yi.runKernel("Min",r,i)}}),vs=Ni({pow_:function(t,e){var n,r=ki(t,"base","pow"),i=ki(e,"exp","pow"),a={a:r=(n=h(ui(r,i),2))[0],b:i=n[1]};return yi.runKernel("Pow",a)}});function ys(t,e){if((Mr(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Mr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ri(t,[],[],e)}var bs=Ni({sqrt_:function(t){var e={x:ki(t,"x","sqrt","float32")};return yi.runKernel(on,e)}}),xs=Ni({square_:function(t){var e=ki(t,"x","square");return yi.runKernel("Square",{x:e},{})}}),ws=Ni({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=ki(t,"x","sum");"bool"===r.dtype&&(r=Oa(r,"int32"));var i={x:r},a={axis:e,keepDims:n};return yi.runKernel("Sum",i,a)}});function _s(t,e,n){if(void 0===n&&(n=null),0===t.rank)return za(t);if(1!==t.rank&&null===n)return _s(ho(t,[-1]),e,n);if(1===t.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===e)return ws(za(t),n);if(e===1/0)return ms(za(t),n);if(e===-1/0)return gs(za(t),n);if("euclidean"===e||2===e)return bs(ws(vs(za(t),ys(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return ms(ws(za(t),n[0]),n[1]-1);if(e===1/0)return ms(ws(za(t),n[1]),n[0]);if(e===-1/0)return gs(ws(za(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return bs(ws(xs(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}var Ss=Ni({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=_s(t=ki(t,"x","norm"),e,n),a=i.shape;if(r){var o=I(n,t.shape);a=ds(i.shape,o)}return ho(i,a)}}),Ts=Ni({euclideanNorm_:function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=!1),Ss(t,"euclidean",e,n)}}),Es=Ni({exp_:function(t){var e={x:ki(t,"x","exp")};return yi.runKernel("Exp",e)}}),ks=Ni({expandDims_:function(t,e){void 0===e&&(e=0);var n=ki(t,"x","expandDims","string_or_numeric");b(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},i={dim:e};return yi.runKernel(Ht,r,i)}}),Is=Ni({expm1_:function(t){var e={x:ki(t,"x","expm1")};return yi.runKernel(Xt,e)}}),As=Ni({tile_:function(t,e){var n=ki(t,"x","tile","string_or_numeric");b(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")}));var r={x:n},i={reps:e};return yi.runKernel(_n,r,i)}}),Ns=Ni({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=Ra([t,e],r),a=t<=e?t:e,o=0;o<a;++o)i.set(1,o,o);var s=ho(i.toTensor(),[t,e]);if(null==n)return s;if(1===n.length)return As(ks(s,0),[n[0],1,1]);if(2===n.length)return As(ks(ks(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return As(ks(ks(ks(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),Cs=Ni({floor_:function(t){var e={x:ki(t,"x","floor","float32")};return yi.runKernel(Yt,e)}}),Rs=Ni({gather_:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i={x:ki(t,"x","gather"),indices:ki(e,"indices","gather","int32")},a={axis:n,batchDims:r};return yi.runKernel(Jt,i,a)}}),Os=Ni({greater_:function(t,e){var n,r=ki(t,"a","greater","string_or_numeric"),i=ki(e,"b","greater","string_or_numeric");r=(n=h(ui(r,i),2))[0],i=n[1],es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(te,a)}}),Ds=Ni({greaterEqual_:function(t,e){var n,r=ki(t,"a","greaterEqual","string_or_numeric"),i=ki(e,"b","greaterEqual","string_or_numeric");r=(n=h(ui(r,i),2))[0],i=n[1],es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(ee,a)}}),Ms=Ni({imag_:function(t){var e={input:ki(t,"input","imag")};return yi.runKernel(ie,e)}}),Fs=Ni({isFinite_:function(t){var e={x:ki(t,"x","isFinite")};return yi.runKernel(ae,e)}}),Ps=Ni({isInf_:function(t){var e={x:ki(t,"x","isInf")};return yi.runKernel(oe,e)}}),Ls=Ni({isNaN_:function(t){var e={x:ki(t,"x","isNaN")};return yi.runKernel(se,e)}}),Bs=Ni({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n={x:ki(t,"x","leakyRelu")},r={alpha:e};return yi.runKernel(ue,n,r)}}),zs=Ni({less_:function(t,e){var n,r=ki(t,"a","less","string_or_numeric"),i=ki(e,"b","less","string_or_numeric");r=(n=h(ui(r,i),2))[0],i=n[1],es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(ce,a)}}),Us=Ni({lessEqual_:function(t,e){var n,r=ki(t,"a","lessEqual","string_or_numeric"),i=ki(e,"b","lessEqual","string_or_numeric");r=(n=h(ui(r,i),2))[0],i=n[1],es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(le,a)}}),Gs=Ni({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var a=ki(t,"x","localResponseNormalization");b(4===a.rank||3===a.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(a.rank,".")})),b(E(e),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")}));var o=a,s=!1;3===a.rank&&(s=!0,o=ho(a,[1,a.shape[0],a.shape[1],a.shape[2]]));var u={x:o},c={depthRadius:e,bias:n,alpha:r,beta:i},l=yi.runKernel("LRN",u,c);return s?ho(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),Ws=Ni({log_:function(t){var e={x:ki(t,"x","log","float32")};return yi.runKernel("Log",e)}}),Vs=Ni({log1p_:function(t){var e={x:ki(t,"x","log1p")};return yi.runKernel(pe,e)}});function js(t,e){b(z(t),(function(){return"The f passed in variableGrads(f) must be a function"})),b(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof ri})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],yi.registeredVariables)e.push(yi.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,a=e.length;e=e.filter((function(t){return t.trainable})),b(e.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable."}));var o=yi.gradients(t,e,null,!0),s=o.value,u=o.grads;b(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),b(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}function Hs(t){return yi.customGrad(t)}function Xs(t){if(t.filter((function(t){return null==t})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var qs=Ni({neg_:function(t){var e={x:ki(t,"x","neg")};return yi.runKernel("Neg",e)}}),Ks=Ni({softplus_:function(t){var e={x:ki(t,"x","softplus")};return yi.runKernel(an,e)}}),Ys=Ni({logSigmoid_:function(t){var e=ki(t,"x","logSigmoid");return Hs((function(t){return{value:qs(Ks(qs(t))),gradFunc:function(e){return Ba(e,vo(qs(t)))}}}))(e)}}),Zs=Ni({sub_:function(t,e){var n,r=ki(t,"a","sub"),i=ki(e,"b","sub"),a={a:r=(n=h(ui(r,i),2))[0],b:i=n[1]};return yi.runKernel("Sub",a)}}),$s=Ni({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=ki(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));var r=Hs((function(t,n){var r=ms(t,e,!0),i=Zs(t,r),a=Zs(Oa(i,"float32"),Ws(ws(Es(i),e,!0)));return n([a]),{value:a,gradFunc:function(t,n){var r=h(n,1)[0],i=Es(r);return Zs(t,Ba(ws(t,e,!0),i))}}}));return r(n)}}),Js=Ni({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=ki(t,"x","logSumExp"),i=I(e,r.shape),a=ms(r,i,!0),o=Zs(r,a),s=Es(o),u=ws(s,i),c=Ws(u),l=Fa(ho(a,c.shape),c);if(n){var h=ds(l.shape,i);return ho(l,h)}return l}}),Qs=Ni({logicalAnd_:function(t,e){var n=ki(t,"a","logicalAnd","bool"),r=ki(e,"b","logicalAnd","bool");es(n.shape,r.shape);var i={a:n,b:r};return yi.runKernel(fe,i)}}),tu=Ni({logicalNot_:function(t){var e={x:ki(t,"x","logicalNot","bool")};return yi.runKernel(de,e)}}),eu=Ni({logicalOr_:function(t,e){var n=ki(t,"a","logicalOr","bool"),r=ki(e,"b","logicalOr","bool");es(n.shape,r.shape);var i={a:n,b:r};return yi.runKernel(me,i)}}),nu=Ni({logicalXor_:function(t,e){var n=ki(t,"a","logicalXor","bool"),r=ki(e,"b","logicalXor","bool");return es(n.shape,r.shape),Qs(eu(t,e),tu(Qs(t,e)))}}),ru=2147483648,iu=Ni({searchSorted_:function(t,e,n){void 0===n&&(n="left");var r=ki(t,"sortedSequence","searchSorted"),i=ki(e,"values","searchSorted"),a=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],s=ho(r,[-1,a]),u=ho(i,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(_(u.shape)>=ru)throw new Error("values tensor size must less than ".concat(ru));if(s.shape[1]>=ru)throw new Error("trailing dim_size must less than ".concat(ru," for int32 output type, was ").concat(s.shape[1]));var c={sortedSequence:s,values:u},l={side:n};return yi.runKernel($e,c,l)}}),au=Ni({maxPool_:function(t,e,n,r,i){var a=ki(t,"x","maxPool"),o=a,s=!1;3===a.rank&&(s=!0,o=ho(a,[1,a.shape[0],a.shape[1],a.shape[2]])),b(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),b(so(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),lo("maxPool",r,i);var u={x:o},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i},l=yi.runKernel(ve,u,c);return s?ho(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),ou=Ni({maxPool3d_:function(t,e,n,r,i,a){void 0===e&&(e=[1,1,1]),void 0===a&&(a="NDHWC");var o=ki(t,"x","maxPool3d"),s=o,u=!1;4===o.rank&&(u=!0,s=ho(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),b(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),b("NDHWC"===a,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a)})),lo("maxPool3d",r,i);var c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},h=yi.runKernel(ye,c,l);return u?ho(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),su=Ni({maxPoolWithArgmax_:function(t,e,n,r,i){void 0===i&&(i=!1);var a={x:ki(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},s=yi.runKernel(be,a,o);return{result:s[0],indexes:s[1]}}}),uu=Ni({maximum_:function(t,e){var n,r=ki(t,"a","maximum"),i=ki(e,"b","maximum");r=(n=h(ui(r,i),2))[0],i=n[1],"bool"===r.dtype&&(r=Oa(r,"int32"),i=Oa(i,"int32")),es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(ge,a)}}),cu=Ni({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r={x:ki(t,"x","mean")},i={axis:e,keepDims:n};return yi.runKernel(xe,r,i)}});function lu(t,e){if(void 0===e&&(e="float32"),X(t),"complex64"===e){var n=lu(t,"float32"),r=lu(t,"float32");return Ci(n,r)}var i=H(_(t),e);return yi.makeTensor(i,t,e)}function hu(t,e){if(void 0===e&&(e="float32"),X(t),"complex64"===e){var n=hu(t,"float32"),r=lu(t,"float32");return Ci(n,r)}var i=j(_(t),e);return yi.makeTensor(i,t,e)}var pu=Ni({minimum_:function(t,e){var n,r=ki(t,"a","minimum"),i=ki(e,"b","minimum");r=(n=h(ui(r,i),2))[0],i=n[1],"bool"===r.dtype&&(r=Oa(r,"int32"),i=Oa(i,"int32")),es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(we,a)}}),fu=Ni({mirrorPad_:function(t,e,n){b("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=ki(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");b(e.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(e.length,".")}));for(var i="reflect"===n?1:0,a=function(t){b(2===e[t].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),b(e[t][0]>=0&&e[t][0]<=r.shape[t]-i&&e[t][1]>=0&&e[t][1]<=r.shape[t]-i,(function(){return"Padding in dimension ".concat(t," cannot be greater than or equal ")+"to ".concat(r.shape[t]-i," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)a(o);var s={paddings:e,mode:n},u={x:r};return yi.runKernel(_e,u,s)}}),du=Ni({mod_:function(t,e){var n,r=ki(t,"a","mod"),i=ki(e,"b","mod"),a={a:r=(n=h(ui(r,i),2))[0],b:i=n[1]};return yi.runKernel("Mod",a)}}),mu=Ni({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=I(e,(t=ki(t,"x","moments")).shape),i=cu(t,r,n),a=i.shape;n||(a=ds(i.shape,r));var o=xs(Zs(Oa(t,"float32"),ho(i,a)));return{mean:i,variance:cu(o,r,n)}}}),gu=Ni({multiRNNCell_:function(t,e,n,r){for(var i=ki(e,"data","multiRNNCell"),a=Ii(n,"c","multiRNNCell"),o=Ii(r,"h","multiRNNCell"),s=i,u=[],c=0;c<t.length;c++){var l=t[c](s,a[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var h=[],p=[];for(c=0;c<u.length;c+=2)h.push(u[c]),p.push(u[c+1]);return[h,p]}}),vu=Ni({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=ki(t,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(a,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var s={logits:1===o?ho(i,[1,-1]):i},u={numSamples:e,seed:n,normalized:r},c=yi.runKernel(Se,s,u);return 1===o?ho(c,[c.size]):c}}),yu=Ni({notEqual_:function(t,e){var n,r=ki(t,"a","notEqual","string_or_numeric"),i=ki(e,"b","notEqual","string_or_numeric");r=(n=h(ui(r,i),2))[0],i=n[1],es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(Ee,a)}}),bu=Ni({oneHot_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r=0),void 0===i&&(i="int32"),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));var a={indices:ki(t,"indices","oneHot","int32")},o={dtype:i,depth:e,onValue:n,offValue:r};return yi.runKernel(Ce,a,o)}}),xu=Ni({onesLike_:function(t){var e={x:ki(t,"x","onesLike")};return yi.runKernel(Ne,e)}}),wu=Ni({outerProduct_:function(t,e){var n=ki(t,"v1","outerProduct"),r=ki(e,"v2","outerProduct");b(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var i=ho(n,[-1,1]),a=ho(r,[1,-1]);return go(i,a)}}),_u=Ni({pad_:function(t,e,n){void 0===n&&(n=0);var r=ki(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:n},a={x:r};return yi.runKernel(Oe,a,i)}}),Su=Ni({pad1d_:function(t,e,n){return void 0===n&&(n=0),b(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),_u(t,[e],n)}}),Tu=Ni({pad2d_:function(t,e,n){return void 0===n&&(n=0),b(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_u(t,e,n)}}),Eu=Ni({pad3d_:function(t,e,n){return void 0===n&&(n=0),b(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_u(t,e,n)}}),ku=Ni({pad4d_:function(t,e,n){return void 0===n&&(n=0),b(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_u(t,e,n)}}),Iu=Ni({spaceToBatchND_:function(t,e,n){var r=ki(t,"x","spaceToBatchND");b(r.rank>=1+e.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(e.length)})),b(n.length===e.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length)})),b(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())}));var i={x:r},a={blockShape:e,paddings:n};return yi.runKernel(sn,i,a)}}),Au=Ni({pool_:function(t,e,n,r,i,a,o){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");var s=ki(t,"x","maxPool"),u=s,c=!1;3===s.rank&&(c=!0,u=ho(s,[1,s.shape[0],s.shape[1],s.shape[2]])),b(so(a,i),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(i,"'")}));var l,p=Ja(u.shape,e,a,i,r),f=[p.dilationHeight,p.dilationWidth];l="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([p.filterHeight,p.filterWidth],f):[[0,0],[0,0]];var d=1===f[0]&&1===f[1],m=h(function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),a=t.concat(r,i),o=e.map((function(t,e){return(t-a[e]%t)%t})),s=i.map((function(t,e){return t+o[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,o[e]]}))]}([p.inHeight,p.inWidth],f,l),2),g=m[0],v=m[1],y=d?r:"valid",x=d?u:Iu(u,f,g),w=("avg"===n?function(){return po(x,e,a,y,o)}:function(){return au(x,e,a,y,o)})(),_=d?w:wo(w,f,v);return c?ho(_,[_.shape[1],_.shape[2],_.shape[3]]):_}}),Nu=Ni({prelu_:function(t,e){var n={x:ki(t,"x","prelu"),alpha:ki(e,"alpha","prelu")};return yi.runKernel(De,n)}}),Cu=Ni({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=ki(t,"x","prod");"bool"===r.dtype&&(r=Oa(r,"int32"));var i={x:r},a={axis:e,keepDims:n};return yi.runKernel(Me,i,a)}}),Ru=Ni({raggedGather_:function(t,e,n,r){var i={paramsNestedSplits:t.map((function(t,e){return ki(t,"tensors".concat(e),"raggedGather","int32")})),paramsDenseValues:ki(e,"paramsDenseValues","raggedGather"),indices:ki(n,"indices","raggedGather","int32")},a={outputRaggedRank:r},o=yi.runKernel(Fe,i,a);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}}),Ou=Ni({raggedRange_:function(t,e,n){var r=ki(t,"starts","raggedRange"),i={starts:r,limits:ki(e,"limits","raggedRange",r.dtype),deltas:ki(n,"deltas","raggedRange",r.dtype)},a=yi.runKernel(Pe,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}}),Du=Ni({raggedTensorToTensor_:function(t,e,n,r,i){var a=ki(t,"shape","raggedTensorToTensor","int32"),o=ki(e,"values","raggedTensorToTensor"),s={shape:a,values:o,defaultValue:ki(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map((function(t,e){return ki(t,"tensors".concat(e),"raggedTensorToTensor","int32")}))},u={rowPartitionTypes:i};return yi.runKernel(Le,s,u)}}),Mu=Ni({rand_:function(t,e,n){X(t);var r=_(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=e();return yi.makeTensor(i,t,n)}}),Fu={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197;return function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var i=new n(t),a=e&&e.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)}(Fu);var Pu=Fu.exports,Lu={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)}(Lu);var Bu=Lu.exports,zu={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)}(zu);var Uu=zu.exports,Gu={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.x&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)}(Gu);var Wu=Gu.exports,Vu={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.X&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)}(Vu);var ju=Vu.exports,Hu={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)}(Hu);var Xu=Hu.exports,qu={exports:{}};!function(e){!function(n,r,i){var a,o=256,s="random",u=i.pow(o,6),c=i.pow(2,52),l=2*c,h=o-1;function p(t,e,h){var p=[],y=g(m((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(r)]:t??function(){try{var t;return a&&(t=a.randomBytes)?t=t(o):(t=new Uint8Array(o),(n.crypto||n.msCrypto).getRandomValues(t)),v(t)}catch(t){var e=n.navigator,i=e&&e.plugins;return[+new Date,n,i,n.screen,v(r)]}}(),3),p),b=new f(p),x=function(){for(var t=b.g(6),e=u,n=0;t<c;)t=(t+n)*o,e*=o,n=b.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,g(v(b.S),r),(e.pass||h||function(t,e,n,r){return r&&(r.S&&d(r,b),t.state=function(){return d(b,{})}),n?(i[s]=t,e):t})(x,y,"global"in e?e.global:this==i,e.state)}function f(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=h&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*o+s[h&(s[i]=s[a=h&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(o)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(m(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function g(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(g(i.random(),r),e.exports){e.exports=p;try{a=t("crypto")}catch(t){}}else i["seed"+s]=p}("undefined"!=typeof self?self:Hn,[],Math)}(qu);var Ku=Pu,Yu=Bu,Zu=Uu,$u=Wu,Ju=ju,Qu=Xu,tc=qu.exports;tc.alea=Ku,tc.xor128=Yu,tc.xorwow=Zu,tc.xorshift7=$u,tc.xor4096=Ju,tc.tychei=Qu;var ec=tc;function nc(){return 32===yi.backend.floatPrecision()?.001:.1}function rc(t,e,n){var r=!0;if((Mr(t)||Mr(e))&&(r=!1),Mr(t)&&Mr(e)&&(r=!0),r){var i=t.constructor.name,a=e.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: ".concat(i,". ")+"Expected: ".concat(a))}if(Array.isArray(t)&&Array.isArray(e)){var o=Si(t),s=Si(e);if(!T(o,s))throw new Error("Arrays have different shapes. "+"Actual: [".concat(o,"]. Expected: [").concat(s,"]"))}var u=Mr(t)?t:Fr(t),c=Mr(e)?e:Fr(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: ".concat(u.length," vs ")+"expected: ".concat(c.length,".\n")+"Actual:   ".concat(u,".\n")+"Expected: ".concat(c,"."));for(var l=0;l<c.length;++l){var h=u[l],p=c[l];if(!n(h,p))throw new Error("Arrays differ: actual[".concat(l,"] = ").concat(h,", expected[").concat(l,"] = ").concat(p,".\n")+"Actual:   ".concat(u,".\n")+"Expected: ".concat(c,"."))}"undefined"!=typeof expect&&expect().nothing()}function ic(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}var ac={__proto__:null,TEST_EPSILON_FLOAT16:.1,createVideoElement:function(t){var e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise((function(t){e.addEventListener("loadeddata",(function(n){return t(e)})),e.load()}))},encodeStrings:function t(e){for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t(r):e[n]=Or(r)}return e},expectArrayBuffersEqual:function(t,e){var n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error("Expected ArrayBuffer to be of length "+"".concat(r.length,", but it was ").concat(n.length));for(var i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error("Expected ArrayBuffer value at ".concat(i," to be ")+"".concat(r[i]," but got ").concat(n[i]," instead"))},expectArraysClose:function(t,e,n){return null==n&&(n=nc()),rc(t,e,(function(t,e){return ic(t,e,n)}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return F(t)||F(t[0])||F(e)||F(e[0])?rc(t,n,(function(t,e){return t==e})):rc(t,e,(function(t,e){return ic(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=nc()),!ic(t,e,n))throw new Error("Numbers differ: actual === ".concat(t,", expected === ").concat(e));"undefined"!=typeof expect&&expect().nothing()},expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()})),"undefined"!=typeof expect&&expect().nothing()},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:".concat(t[r]," low: ").concat(e,", high: ").concat(n))},play:function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,t.play()];case 1:return e.sent(),"requestVideoFrameCallback"in t?[4,new Promise((function(e){t.requestVideoFrameCallback(e)}))]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},testEpsilon:nc},oc=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=ec.alea(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,a=void 0,o=void 0;do{o=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),sc=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=ec.alea(i.toString()),this.randn=new oc(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,a;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<e||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),uc=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=1);var i=this;if(this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=ec.alea(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}(),cc=Ni({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),X(t),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var a=new sc(e,n,r,i),o=Ra(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),lc=Ni({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),X(t),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var a=new oc(e,n,r,!1,i),o=Ra(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),hc=Ni({randomStandardNormal_:function(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type ".concat(e));return lc(t,0,1,e,n)}}),pc=Ni({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32"),X(t);for(var a=Ra(t,r),o=new uc(e,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),fc=Ni({randomUniformInt_:function(t,e,n,r){return pc(t,e,n,"int32",r)}});function dc(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");var i={start:t,stop:e,step:n,dtype:r};return yi.runKernel(Be,{},i)}var mc=Ni({real_:function(t){var e={input:ki(t,"input","real")};return yi.runKernel(ze,e)}}),gc=Ni({reciprocal_:function(t){var e={x:ki(t,"x","reciprocal")};return yi.runKernel(Ue,e)}}),vc=Ni({relu_:function(t){var e={x:ki(t,"x","relu")};return yi.runKernel(Ge,e)}}),yc=Ni({relu6_:function(t){var e={x:ki(t,"x","relu6")};return yi.runKernel(He,e)}}),bc=Ni({reverse_:function(t,e){var n={x:ki(t,"x","reverse")},r={dims:e};return yi.runKernel(Xe,n,r)}}),xc=Ni({reverse1d_:function(t){var e=ki(t,"x","reverse");return b(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")})),bc(e,0)}}),wc=Ni({reverse2d_:function(t,e){var n=ki(t,"x","reverse");return b(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),bc(n,e)}}),_c=Ni({reverse3d_:function(t,e){var n=ki(t,"x","reverse");return b(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),bc(n,e)}}),Sc=Ni({reverse4d_:function(t,e){var n=ki(t,"x","reverse");return b(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),bc(n,e)}}),Tc=Ni({round_:function(t){var e={x:ki(t,"x","round")};return yi.runKernel(qe,e)}}),Ec=Ni({rsqrt_:function(t){var e={x:ki(t,"x","rsqrt","float32")};return yi.runKernel(Ke,e)}}),kc=Ni({selu_:function(t){var e={x:ki(t,"x","selu")};return yi.runKernel(Qe,e)}}),Ic=Ni({separableConv2d_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]),void 0===o&&(o="NHWC");var s=ki(t,"x","separableConv2d"),u=ki(e,"depthwiseFilter","separableConv2d"),c=ki(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=ho(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");b(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),b(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),b(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),b(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),b(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var p=u.shape[2],f=u.shape[3];b(c.shape[2]===p*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(p*f,", ")+"but got ".concat(c.shape[2],".")}));var d=Zo(l,u,r,i,o,a),m=Lo(d,c,1,"valid",o);return h?ho(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),Ac=Ni({sign_:function(t){var e={x:ki(t,"x","sign")};return yi.runKernel(nn,e)}}),Nc=Ni({sin_:function(t){var e={x:ki(t,"x","sin","float32")};return yi.runKernel("Sin",e)}}),Cc=Ni({sinh_:function(t){var e={x:ki(t,"x","sinh")};return yi.runKernel(en,e)}}),Rc=Ni({slice1d_:function(t,e,n){var r=ki(t,"x","slice1d");return b(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),yo(r,[e],[n])}}),Oc=Ni({slice2d_:function(t,e,n){var r=ki(t,"x","slice2d");return b(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),yo(r,e,n)}}),Dc=Ni({slice3d_:function(t,e,n){var r=ki(t,"x","slice3d");return b(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),yo(r,e,n)}}),Mc=Ni({slice4d_:function(t,e,n){var r=ki(t,"x","slice4d");return b(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),yo(r,e,n)}}),Fc=Ni({softmax_:function(t,e){void 0===e&&(e=-1);var n=ki(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));var r={logits:n},i={dim:e};return yi.runKernel(cn,r,i)}}),Pc=Ni({fft_:function(t){b("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return yi.runKernel("FFT",e)}}),Lc=Ni({ifft_:function(t){b("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return yi.runKernel(re,e)}}),Bc=Ni({irfft_:function(t){var e,n=t.shape[t.shape.length-1],r=t.size/n;if(n<=2){var i=ho(t,[r,n]);e=Lc(i)}else{var a=[r,2*(n-1)],o=ho(mc(t),[r,n]),s=ho(Ms(t),[r,n]),u=bc(yo(o,[0,1],[r,n-2]),1),c=Ba(bc(yo(s,[0,1],[r,n-2]),1),ys(-1)),l=mo([o,u],1),h=mo([s,c],1);i=ho(Ci(l,h),[a[0],a[1]]),e=Lc(i)}if(e=mc(e),3===t.rank&&0!==t.shape[0]){var p=e,f=t.shape[0];e=ho(e,[f,e.shape[0]/f,e.shape[1]]),p.dispose()}return e}}),zc=Ni({split_:function(t,e,n){void 0===n&&(n=0);var r={x:ki(t,"x","split")},i={numOrSizeSplits:e,axis:n};return yi.runKernel(un,r,i)}}),Uc=Ni({rfft_:function(t,e){b("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(t.dtype)}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var a=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=yo(t,a,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=mo([t,lu(s)],t.shape.length-1),r=e}else n=t;var u=as(n),c=ho(Ci(n,u),[i,r]),l=Pc(c),h=Math.floor(r/2)+1,p=mc(l),f=Ms(l),d=zc(p,[h,r-h],p.shape.length-1),m=zc(f,[h,r-h],f.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,ho(Ci(d[0],m[0]),g)}}),Gc=Ni({squaredDifference_:function(t,e){var n,r=ki(t,"a","squaredDifference"),i=ki(e,"b","squaredDifference");r=(n=h(ui(r,i),2))[0],i=n[1],es(r.shape,i.shape);var a={a:r,b:i};return yi.runKernel(mn,a,{})}}),Wc=Ni({squeeze_:function(t,e){var n=ki(t,"x","squeeze","string_or_numeric");return ho(n,A(n.shape,e).newShape)}}),Vc=Ni({stack_:function(t,e){void 0===e&&(e=0);var n=Ii(t,"tensors","stack","string_or_numeric");b(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&b(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,i={axis:e};return yi.runKernel(Re,r,i)}}),jc=Ni({step_:function(t,e){void 0===e&&(e=0);var n={x:ki(t,"x","step")},r={alpha:e};return yi.runKernel(Cn,n,r)}}),Hc=Ni({stridedSlice_:function(t,e,n,r,i,a,o,s,u){void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0);var c={x:ki(t,"x","stridedSlice","string_or_numeric")},l={begin:e,end:n,strides:r,beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return yi.runKernel(vn,c,l)}}),Xc=Ni({tan_:function(t){var e={x:ki(t,"x","tan","float32")};return yi.runKernel("Tan",e)}});function qc(t,e){w(t);var n=Si(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ri(t,null,n,e)}function Kc(t,e,n){if(w(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Si(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ri(t,e,r,n)}function Yc(t,e,n){if(w(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Si(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ri(t,e,r,n)}function Zc(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(i,".");if(n.rank<i)throw new Error(a+" update.rank < ".concat(i,". "));if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < ".concat(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != ".concat(i+t.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==t[o+r])throw new Error(a+" updates.shape[".concat(o+i,"] (").concat(n.shape[o+i],") != shape[").concat(o+i,"] (").concat(t[o+i],")"))}function $c(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}Zc(n,e,t)}function Jc(t,e,n){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:_(e.shape)/u,sliceSize:o,strides:p(p([],h(G(n.slice(0,i))),!1),[1],!1),outputSize:_(n)}}var Qc={__proto__:null,calculateShapes:Jc,validateInput:$c,validateUpdateShape:Zc},tl=Ni({tensorScatterUpdate_:function(t,e,n){var r=ki(t,"tensor","tensorScatterupdate"),i=ki(e,"indices","tensorScatterupdate","int32"),a=ki(n,"updates","tensorScatterupdate");if($c(a,i,r.shape),r.dtype!==a.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(a.dtype,"."));var o={tensor:r,indices:i,updates:a};return yi.runKernel(Ze,o,{})}}),el=Ni({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=ki(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(i,") ")+"but got ".concat(e));var a={x:r},o={k:e,sorted:n},s=h(yi.runKernel(Sn,a,o),2);return{values:s[0],indices:s[1]}}}),nl=Ni({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),X(t),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var a=new oc(e,n,r,!0,i),o=Ra(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),rl=Ni({unique_:function(t,e){void 0===e&&(e=0);var n=ki(t,"x","unique","string_or_numeric");b(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},i={axis:e},a=h(yi.runKernel(kn,r,i),2);return{values:a[0],indices:a[1]}}}),il=Ni({unsortedSegmentSum_:function(t,e,n){var r=ki(t,"x","unsortedSegmentSum"),i=ki(e,"segmentIds","unsortedSegmentSum","int32");b(E(n),(function(){return"numSegments must be of dtype int"}));var a={x:r,segmentIds:i},o={numSegments:n};return yi.runKernel(An,a,o)}}),al=Ni({unstack_:function(t,e){void 0===e&&(e=0);var n=ki(t,"x","unstack","string_or_numeric");b(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},i={axis:e};return yi.runKernel(In,r,i)}});function ol(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=Ra(t,"int32"),a=Ra([n.length,t.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*t.length;a.values.set(o,s)}return a.toTensor()}var sl=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(i){switch(i.label){case 0:return[4,(e=ki(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=ol(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},ul=Ni({transpose_:function(t,e,n){var r=ki(t,"x","transpose");if(null==e&&(e=r.shape.map((function(t,e){return e})).reverse()),b(r.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(e,".")})),e.forEach((function(t){b(t>=0&&t<r.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(e)}))})),r.rank<=1)return r.clone();var i={x:r},a={perm:e};return"complex64"===r.dtype?Fi((function(){var t=mc(r),e=Ms(r);return t=yi.runKernel(En,{x:t},a),e=yi.runKernel(En,{x:e},a),n&&(e=qs(e)),Ci(t,e)})):yi.runKernel(En,i,a)}}),cl=Ni({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var a=ki(t,"v","movingAverage"),o=ki(e,"x","movingAverage"),s=ki(n,"decay","movingAverage");ci(a,o),b(T(a.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=ys(1),c=Zs(u,s),l=Ba(Zs(o,a),c);if(i){b(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=ki(r,"step","movingAverage");l=La(l,Zs(u,vs(s,h)))}return Fa(a,l)}}),ll=Ni({scatterND_:function(t,e,n){X(n);var r=ki(t,"indices","scatterND","int32"),i=ki(e,"updates","scatterND");$c(i,r,n);var a={indices:r,updates:i},o={shape:n};return yi.runKernel(Ye,a,o)}}),hl=Ni({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0),X(n);var i=ki(t,"sparseIndices","sparseToDense","int32"),a=ki(e,"sparseValues","sparseToDense","string_or_numeric"),o=ki(r,"defaultValue","sparseToDense",a.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));var i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(a,"."));var o=e.size;if(0!==e.rank&&(1!==e.rank||o!==i))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(i,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o);var s={sparseIndices:i,sparseValues:a,defaultValue:o},u={outputShape:n};return yi.runKernel(dn,s,u)}}),pl=Ni({gatherND_:function(t,e){var n=ki(e,"indices","gatherND","int32"),r={params:ki(t,"x","gatherND","string_or_numeric"),indices:n};return yi.runKernel(Qt,r)}}),fl=Ni({dropout_:function(t,e,n,r){var i=ki(t,"x","dropout");if(b("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(i.dtype," tensor instead.")})),b(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(e,".")})),0===e)return t instanceof Zr?i.clone():i;var a=function(t,e){if(null==e)return t.shape.slice();if(T(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),o=1-e,s=La(Cs(Fa(pc(a,0,1,"float32",r),o)),o);return Ba(i,s)}});function dl(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function ml(t,e,n){for(var r=1-t%2,i=new Float32Array(t),a=0;a<t;++a){var o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return qc(i,"float32")}var gl=Ni({conv2DBackpropFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC");var s=t;3===t.rank&&(s=ho(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=ho(e,[1,e.shape[0],e.shape[1],e.shape[2]])),b(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),b(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),b(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===a?s.shape[3]:s.shape[1],l="NHWC"===a?u.shape[3]:u.shape[1];b(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),b(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),lo("conv2dDerFilter",i,o);var h={x:s,dy:u},p={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,filterShape:n};return yi.runKernel(kt,h,p)}});function vl(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return Ba(t,jc(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function yl(t,e){var n=e,r=ts(t.shape,e.shape);return r.length>0&&(n=ws(n,r)),ho(n,t.shape)}function bl(t,e,n,r){if("linear"===e)return t;if("relu"===e)return vc(t);if("elu"===e)return cs(t);if("relu6"===e)return yc(t);if("prelu"===e)return Nu(t,n);if("leakyrelu"===e)return Bs(t,r);if("sigmoid"===e)return vo(t);throw new Error("Unknown fused activation ".concat(e,"."))}var xl=function(t,e){return!(t>0)||"linear"===e},wl=Ni({fusedConv2d_:function(t){var e,n=t.x,r=t.filter,i=t.strides,a=t.pad,o=t.dataFormat,s=void 0===o?"NHWC":o,u=t.dilations,c=void 0===u?[1,1]:u,l=t.dimRoundingMode,p=t.bias,f=t.activation,d=void 0===f?"linear":f,m=t.preluActivationWeights,g=t.leakyreluAlpha;if(d=d||"linear",!1===xl(yi.state.gradientDepth,d)){b("NHWC"===s,(function(){return"Error in fused conv2d: got dataFormat of ".concat(s," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var v=Lo(n,r,i,a,s,c,l);return null!=p&&(v=Fa(v,p)),bl(v,d,m,g)}var y=ki(n,"x","conv2d","float32"),x=ki(r,"filter","conv2d","float32"),w=y,_=!1;3===y.rank&&(_=!0,w=ho(y,[1,y.shape[0],y.shape[1],y.shape[2]])),b(4===w.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(w.rank,".")})),b(4===x.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(x.rank,".")})),lo("fused conv2d",a,l);var S="NHWC"===s?w.shape[3]:w.shape[1];b(x.shape[2]===S,(function(){return"Error in conv2d: depth of input (".concat(S,") must match ")+"input depth for filter ".concat(x.shape[2],".")})),b(so(i,c),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(c,"'")}));var T,E,k=Qa(w.shape,x.shape,i,c,a,l);if(null!=p&&(e=h(ui(T=ki(p,"bias","fused conv2d"),y),1),T=e[0],"NHWC"===s?es(k.outShape,T.shape):(b(T.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(T.shape.length,".")})),b(0===T.shape.length||T.shape[0]===k.outChannels||1===T.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(T.shape,") is not ")+"compatible with the number of output channels "+"(".concat(k.outChannels,")")})))),null!=m){var I=m.shape;if(b(I.length<=1||3===I.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(I.length,".")})),1===I.length)b(1===I[0]||I[0]===k.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(I,") is not compatible with the number of output ")+"channels (".concat(k.outChannels,").")}));else if(3===I.length)try{es(I,k.outShape)}catch(t){var A="Error in fused conv2d: PReLU activation weights (".concat(I,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(k.outShape,").");throw Error(A)}E=ki(m,"prelu weights","fused conv2d")}var N=function(t,e){b("NHWC"===s,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(s," but only NHWC is currently supported.")}));var n=h(e,4),r=n[0],o=n[1],u=n[2],l=n[3],p=vl(t,u,d);b(oo(c),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(c,"'")}));var f=[zo(o.shape,p,r,i,a),gl(o,p,r.shape,i,a)];if(null!=l){var m=yl(l,p);f.push(m)}return f},C={x:w,filter:x,bias:T,preluActivationWeights:E},R={strides:i,pad:a,dataFormat:s,dilations:c,dimRoundingMode:l,activation:d,leakyreluAlpha:g};if(null==p){var O=Hs((function(t,e,n){var r=yi.runKernel(Mn,C,R);return n([e,t,r]),_&&(r=ho(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:N}}));return O(w,x)}var D=Hs((function(t,e,n,r){var i=yi.runKernel(Mn,C,R);return r([e,t,i,n]),_&&(i=ho(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:N}}));return D(w,x,T)}}),_l=Ni({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]);var s=t;3===t.rank&&(s=ho(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=ho(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,filterShape:n};return yi.runKernel(Lt,c,l)}}),Sl=Ni({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]);var s=e,u=!1;3===e.rank&&(u=!0,s=ho(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,inputShape:t},h=yi.runKernel(Bt,c,l);return u?ho(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),Tl=Ni({fusedDepthwiseConv2d_:function(t){var e,n=t.x,r=t.filter,i=t.strides,a=t.pad,o=t.dataFormat,s=void 0===o?"NHWC":o,u=t.dilations,c=void 0===u?[1,1]:u,l=t.dimRoundingMode,p=t.bias,f=t.activation,d=void 0===f?"linear":f,m=t.preluActivationWeights,g=t.leakyreluAlpha;if(!1===xl(yi.state.gradientDepth,d)){var v=Zo(n,r,i,a,s,c,l);return null!=p&&(v=Fa(v,p)),bl(v,d,m,g)}var y=ki(n,"x","depthwiseConv2d","float32"),x=ki(r,"filter","depthwiseConv2d","float32"),w=y,_=!1;3===y.rank&&(_=!0,w=ho(y,[1,y.shape[0],y.shape[1],y.shape[2]])),b(4===w.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(w.rank,".")})),b(4===x.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(x.rank,".")})),b(w.shape[3]===x.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(w.shape[3],") must match the inChannels dimension in ")+"filter ".concat(x.shape[2],".")})),null==c&&(c=[1,1]),b(so(i,c),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(i," and dilations '").concat(c,"'")})),lo("fused depthwiseConv2d",a,l);var S,T,E=Qa(w.shape,x.shape,i,c,a,l,!0);null!=p&&(e=h(ui(S=ki(p,"bias","fused conv2d"),y),1),S=e[0],es(E.outShape,S.shape)),null!=m&&(T=ki(m,"prelu weights","fused depthwiseConv2d"));var k=function(t,e){b(oo(c),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(c,"'")}));var n=h(e,4),r=n[0],o=n[1],s=n[2],u=n[3],p=vl(t,s,d),f=Sl(o.shape,p,r,i,a,c,l),m=_l(o,p,r.shape,i,a,c,l);return null!=u?[f,m,yl(S,p)]:[f,m]},I={x:w,filter:x,bias:S,preluActivationWeights:T},A={strides:i,pad:a,dataFormat:s,dilations:c,dimRoundingMode:l,activation:d,leakyreluAlpha:g};if(null==p){var N=Hs((function(t,e,n){var r=yi.runKernel(Fn,I,A);return n([e,t,r]),_&&(r=ho(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:k}}));return N(w,x)}var C=Hs((function(t,e,n,r){var i=yi.runKernel(Fn,I,A);return r([e,t,i,n]),_&&(i=ho(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:k}}));return C(w,x,S)}}),El=Ni({fusedMatMul_:function(t){var e,n=t.a,r=t.b,i=t.transposeA,a=void 0!==i&&i,o=t.transposeB,s=void 0!==o&&o,u=t.bias,c=t.activation,l=void 0===c?"linear":c,p=t.preluActivationWeights,f=t.leakyreluAlpha,d=void 0===f?.2:f;if(!1===xl(yi.state.gradientDepth,l)){var m=go(n,r,a,s);return null!=u&&(m=Fa(m,u)),bl(m,l,p,d)}var g=ki(n,"a","fused matMul"),v=ki(r,"b","fused matMul");e=h(ui(g,v),2),g=e[0],v=e[1];var y=a?g.shape[g.rank-2]:g.shape[g.rank-1],x=s?v.shape[v.rank-1]:v.shape[v.rank-2],w=a?g.shape[g.rank-1]:g.shape[g.rank-2],S=s?v.shape[v.rank-2]:v.shape[v.rank-1],T=g.shape.slice(0,-2),E=v.shape.slice(0,-2),k=_(T),I=_(E);b(y===x,(function(){return"Error in fused matMul: inner shapes (".concat(y,") and (")+"".concat(x,") of Tensors with shapes ").concat(g.shape," and ")+"".concat(v.shape," and transposeA=").concat(a)+" and transposeB=".concat(s," must match.")}));var A,N,C=es(g.shape.slice(0,-2),v.shape.slice(0,-2)).concat([w,S]),R=ho(g,a?[k,y,w]:[k,w,y]),O=ho(v,s?[I,S,x]:[I,x,S]);null!=u&&(A=h(ui(A=ki(u,"bias","fused matMul"),g),1)[0],es(C,A.shape)),null!=p&&(N=ki(p,"prelu weights","fused matMul"));var D=function(t,e){var n,r,i=h(e,4),o=i[0],c=i[1],p=i[2],f=i[3],d=vl(ho(t,p.shape),p,l);return a||s?!a&&s?(n=go(d,c,!1,!1),r=go(d,o,!0,!1)):a&&!s?(n=go(c,d,!1,!0),r=go(o,d,!1,!1)):(n=go(c,d,!0,!0),r=go(d,o,!0,!0)):(n=go(d,c,!1,!0),r=go(o,d,!0,!1)),null!=u?[n,r,yl(f,d)]:[n,r]},M={a:R,b:O,bias:A,preluActivationWeights:N},F={transposeA:a,transposeB:s,activation:l,leakyreluAlpha:d};if(null==u){var P=Hs((function(t,e,n){var r=yi.runKernel(Dn,M,F);return n([t,e,r]),{value:ho(r,C),gradFunc:D}}));return P(R,O)}var L=Hs((function(t,e,n,r){var i=yi.runKernel(Dn,M,F);return r([t,e,i,n]),{value:ho(i,C),gradFunc:D}}));return L(R,O,A)}}),kl={__proto__:null,conv2d:wl,depthwiseConv2d:Tl,matMul:El},Il=Ni({hammingWindow_:function(t){return ml(t,.54,.46)}}),Al=Ni({hannWindow_:function(t){return ml(t,.5,.5)}}),Nl=Ni({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var a=0,o=[];a+e<=t.size;)o.push(yo(t,a,e)),a+=n;if(r)for(;a<t.size;){var s=a+e-t.size,u=mo([yo(t,a,e-s),Ro([s],i)]);o.push(u),a+=n}return 0===o.length?Kc([],[0,e]):ho(mo(o),[o.length,e])}}),Cl=Ni({stft_:function(t,e,n,r,i){void 0===i&&(i=Al),null==r&&(r=dl(e));var a=Nl(t,e,n),o=Ba(a,i(e));return Uc(o,r)}}),Rl=Ni({cropAndResize_:function(t,e,n,r,i,a){void 0===i&&(i="bilinear"),void 0===a&&(a=0);var o=ki(t,"image","cropAndResize"),s=ki(e,"boxes","cropAndResize","float32"),u=ki(n,"boxInd","cropAndResize","int32"),c=s.shape[0];b(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),b(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),b(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),b(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),b(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),b("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was ".concat(i)}));var l={image:o,boxes:s,boxInd:u},h={method:i,extrapolationValue:a,cropSize:r};return yi.runKernel(Dt,l,h)}}),Ol=Ni({flipLeftRight_:function(t){var e=ki(t,"image","flipLeftRight","float32");b(4===e.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")}));var n={image:e};return yi.runKernel(Kt,n,{})}}),Dl=Ni({grayscaleToRGB_:function(t){var e=ki(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];b(e.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")})),b(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,As(e,i)}}),Ml=Ni({rgbToGrayscale_:function(t){var e=ki(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];b(e.rank>=2,(function(){return"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")})),b(3===r,(function(){return"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")}));var i,a=e.dtype,o=Oa(e,"float32"),s=qc([.2989,.587,.114]);switch(e.rank){case 2:i=us("ij,j->i",o,s);break;case 3:i=us("ijk,k->ij",o,s);break;case 4:i=us("ijkl,l->ijk",o,s);break;case 5:i=us("ijklm,m->ijkl",o,s);break;case 6:i=us("ijklmn,n->ijklm",o,s);break;default:throw new Error("Not a valid tensor rank.")}return i=ks(i,-1),Oa(i,a)}}),Fl=Ni({rotateWithOffset_:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=.5);var i=ki(t,"image","rotateWithOffset","float32");b(4===i.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(i.rank,".")}));var a={image:i},o={radians:e,fillValue:n,center:r};return yi.runKernel(On,a,o)}});function Pl(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);var o=t.shape[0];return n=Math.min(n,o),b(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),b(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'")})),b(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1])})),b(1===e.rank,(function(){return"scores must be a 1D tensor"})),b(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0])})),b(0<=a&&a<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(a,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var Ll=Ni({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var a=ki(t,"boxes","nonMaxSuppression","float32"),o=ki(e,"scores","nonMaxSuppression","float32"),s=Pl(a,o,n,r,i),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:i=s.scoreThreshold};return yi.runKernel(ke,{boxes:a,scores:o},u)}});function Bl(t,e,n){var r=function(t,e,n){return function(t,e,n){for(var r=0,i=t.length,a=0,o=!1;r<i;){var s=n(e,t[a=r+(i-r>>>1)]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||zl)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function zl(t,e){return t>e?1:t<e?-1:0}function Ul(t,e,n,r,i){return Vl(t,e,n,r,i,0)}function Gl(t,e,n,r,i,a){return Vl(t,e,n,r,i,0,!1,a,!0)}function Wl(t,e,n,r,i,a){return Vl(t,e,n,r,i,a,!0)}function Vl(t,e,n,r,i,a,o,s,u){void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===u&&(u=!1);for(var c=[],l=0;l<e.length;l++)e[l]>i&&c.push({score:e[l],boxIndex:l,suppressBeginIndex:0});c.sort(Xl);for(var f=a>0?-.5/a:0,d=[],m=[];d.length<n&&c.length>0;){var g=c.pop(),v=g.score,y=g.boxIndex,b=g.suppressBeginIndex;if(v<i)break;for(var x=!1,w=d.length-1;w>=b;--w){var _=jl(t,y,d[w]);if(_>=r){x=!0;break}if(g.score=g.score*Hl(r,f,_),g.score<=i)break}g.suppressBeginIndex=d.length,x||(g.score===v?(d.push(y),m.push(g.score)):g.score>i&&Bl(c,g,Xl))}var S=d.length,T=n-S;s&&T>0&&(d.push.apply(d,p([],h(new Array(T).fill(0)),!1)),m.push.apply(m,p([],h(new Array(T).fill(0)),!1)));var E={selectedIndices:d};return o&&(E.selectedScores=m),u&&(E.validOutputs=S),E}function jl(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),f=(s-a)*(u-o),d=(h-c)*(p-l);if(f<=0||d<=0)return 0;var m=Math.max(a,c),g=Math.max(o,l),v=Math.min(s,h),y=Math.min(u,p),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(f+d-b)}function Hl(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Xl(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}var ql=Ni({nonMaxSuppressionWithScore_:function(t,e,n,r,i,a){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0);var o=ki(t,"boxes","nonMaxSuppression"),s=ki(e,"scores","nonMaxSuppression"),u=Pl(o,s,n,r,i,a),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},h=yi.runKernel(Ae,c,l);return{selectedIndices:h[0],selectedScores:h[1]}}}),Kl=Ni({nonMaxSuppressionPadded_:function(t,e,n,r,i,a){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=!1);var o=ki(t,"boxes","nonMaxSuppression"),s=ki(e,"scores","nonMaxSuppression"),u=Pl(o,s,n,r,i,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:a},h=yi.runKernel(Ie,c,l);return{selectedIndices:h[0],validOutputs:h[1]}}}),Yl=Ni({resizeBilinear_:function(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);var i=ki(t,"images","resizeBilinear");b(3===i.rank||4===i.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(i.rank,".")})),b(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")})),b(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var a=i,o=!1;3===i.rank&&(o=!0,a=ho(i,[1,i.shape[0],i.shape[1],i.shape[2]])),h(e,0);var s={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=yi.runKernel(je,s,u);return o?ho(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),Zl=Ni({resizeNearestNeighbor_:function(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);var i=ki(t,"images","resizeNearestNeighbor");b(3===i.rank||4===i.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(i.rank,".")})),b(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")})),b("float32"===i.dtype||"int32"===i.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),b(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var a=i,o=!1;3===i.rank&&(o=!0,a=ho(i,[1,i.shape[0],i.shape[1],i.shape[2]])),h(e,0);var s={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=yi.runKernel(Ve,s,u);return o?ho(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),$l=Ni({threshold_:function(t,e,n,r){var i;void 0===e&&(e="binary"),void 0===n&&(n=!1),void 0===r&&(r=.5);var a,o,s,u,c=ki(t,"image","threshold"),l=c.shape[0]*c.shape[1],p=Ba(qc([r]),255);if(b(3===c.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(c.rank,".")})),b(3===c.shape[2]||1===c.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(c.shape[2],".")})),b("int32"===c.dtype||"float32"===c.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(c.dtype,".")})),b("otsu"===e||"binary"===e,(function(){return"Method must be binary or otsu, but was ".concat(e)})),3===c.shape[2]){a=(i=h(zc(c,[1,1,1],-1),3))[0],o=i[1],s=i[2];var f=Ba(a,.2989),d=Ba(o,.587),m=Ba(s,.114);u=Fa(Fa(f,d),m)}else u=t;"otsu"===e&&(p=function(t,e){for(var n,r,i,a,o,s,u=qc([-1]),c=qc([0]),l=qc([0]),h=0;h<t.size-1;h++){n=yo(t,0,h+1),r=yo(t,h+1),o=La(ws(n),e),s=La(ws(r),e);var p=ws(Ba(n,dc(0,n.size)));i=La(p,ws(n));var f=Ro(r.shape,n.size),d=Fa(dc(0,r.size),f),m=Ba(r,d);a=La(ws(m),ws(r));var g=Zs(i,a),v=Zs(i,a),y=Ba(o,s);l=Ba(Ba(y,g),v);var b=Os(l,c);c=is(b,l,c),u=is(b,qc([h]),u)}return u}(ko(Oa(Tc(u),"int32"),Oi([]),256),l));var g=n?Us(u,p):Os(u,p);return Oa(Ba(g,255),"int32")}}),Jl=Ni({transform_:function(t,e,n,r,i,a){void 0===n&&(n="nearest"),void 0===r&&(r="constant"),void 0===i&&(i=0);var o=ki(t,"image","transform","float32"),s=ki(e,"transforms","transform","float32");b(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),b(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),b(null==a||2===a.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(a,".")}));var u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return yi.runKernel(Tn,u,c)}}),Ql=Ni({bandPart_:function(t,e,n){var r=ki(t,"a","bandPart");b(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var i,a,o=r.shape,s=h(r.shape.slice(-2),2),u=s[0],c=s[1];"number"==typeof e?(b(e%1==0,(function(){return"bandPart(): numLower must be an integer, got ".concat(e,".")})),b(e<=u,(function(){return"bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(u,").")})),i=ki(e<0?u:e,"numLower","bandPart")):(b("int32"===e.dtype,(function(){return"bandPart(): numLower's dtype must be an int32."})),i=is(zs(e,0),u,pu(e,u))),"number"==typeof n?(b(n%1==0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")})),b(n<=c,(function(){return"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(c,").")})),a=ki(n<0?c:n,"numUpper","bandPart")):(b("int32"===n.dtype,(function(){return"bandPart(): numUpper's dtype must be an int32."})),a=is(zs(n,0),c,pu(n,c)));var l=ho(dc(0,u,1,"int32"),[-1,1]),p=dc(0,c,1,"int32"),f=Zs(l,p),d=Qs(Us(f,i),Ds(f,qs(a))),m=lu([u,c],r.dtype);return ho(Vc(al(ho(r,[-1,u,c])).map((function(t){return is(d,t,m)}))),o)}}),th=Ni({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,b(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){b(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")}))},i=1;i<t.length;++i)r(i)}else e=!0,t=zc(t,t.shape[0],0).map((function(t){return Wc(t,[0])}));b(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")}));var a=[],o=t,s=function(t){a.push(yi.tidy((function(){var e=o[t];if(t>0)for(var n=0;n<t;++n){var r=Ba(ws(Ba(a[n],e)),a[n]);e=Zs(e,r)}return La(e,Ss(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?Vc(a,0):a}});function eh(t,e){return void 0===e&&(e=!1),yi.tidy((function(){b(2===t.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")}));for(var n=t.shape[0],r=t.shape[1],i=Ns(n),a=Da(t),o=Kc([[1]],[1,1]),s=Da(o),u=n>=r?r:n,c=function(t){var e,u=a,c=s,l=i;e=h(yi.tidy((function(){var e=yo(a,[t,t],[n-t,1]),u=Ss(e),c=yo(a,[t,t],[1,1]),l=is(Os(c,0),Kc([[-1]]),Kc([[1]])),h=Zs(c,Ba(l,u)),p=La(e,h);s=1===p.shape[0]?Da(o):mo([o,yo(p,[1,0],[p.shape[0]-1,p.shape[1]])],0);var f=qs(La(go(l,h),u)),d=yo(a,[t,0],[n-t,r]),m=Ba(f,s),g=ul(s);if(0===t)a=Zs(d,go(m,go(g,d)));else{var v=Zs(d,go(m,go(g,d)));a=mo([yo(a,[0,0],[t,r]),v],0)}var y=ul(m),b=yo(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=Zs(b,go(go(b,s),y));else{var x=Zs(b,go(go(b,s),y));i=mo([yo(i,[0,0],[n,t]),x],1)}return[s,a,i]})),3),s=e[0],a=e[1],i=e[2],Pi([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(i=yo(i,[0,0],[n,r]),a=yo(a,[0,0],[r,r])),[i,a]}))}var nh,rh=Ni({qr_:function(t,e){if(void 0===e&&(e=!1),b(t.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank)})),2===t.rank)return eh(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=al(ho(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];return r.forEach((function(t){var n=h(eh(t,e),2),r=n[0],o=n[1];i.push(r),a.push(o)})),[ho(Vc(i,0),t.shape),ho(Vc(a,0),t.shape)]}});n.Reduction=void 0,(nh=n.Reduction||(n.Reduction={}))[nh.NONE=0]="NONE",nh[nh.MEAN=1]="MEAN",nh[nh.SUM=2]="SUM",nh[nh.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS";var ih=Ni({computeWeightedLoss_:function(t,e,r){void 0===r&&(r=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var i=ki(t,"losses","computeWeightedLoss"),a=null;null!=e&&(a=ki(e,"weights","computeWeightedLoss"));var o=null==a?i:Ba(i,a);if(r===n.Reduction.NONE)return o;if(r===n.Reduction.SUM)return ws(o);if(r===n.Reduction.MEAN){if(null==a)return cu(o);var s=i.size/a.size,u=La(ws(o),ws(a));return s>1?La(u,ys(s)):u}if(r===n.Reduction.SUM_BY_NONZERO_WEIGHTS){if(null==a)return La(ws(o),ys(i.size));var c=Ba(a,hu(i.shape)),l=Oa(ws(yu(c,ys(0))),"float32");return La(ws(o),l)}throw Error("Unknown reduction: ".concat(r))}}),ah=Ni({absoluteDifference_:function(t,e,r,i){void 0===i&&(i=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=ki(t,"labels","absoluteDifference"),o=ki(e,"predictions","absoluteDifference"),s=null;null!=r&&(s=ki(r,"weights","absoluteDifference")),x(a.shape,o.shape,"Error in absoluteDifference: ");var u=za(Zs(a,o));return ih(u,s,i)}}),oh=Ni({cosineDistance_:function(t,e,r,i,a){void 0===a&&(a=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=ki(t,"labels","cosineDistance"),s=ki(e,"predictions","cosineDistance"),u=null;null!=i&&(u=ki(i,"weights","cosineDistance")),x(o.shape,s.shape,"Error in cosineDistance: ");var c=ys(1),l=Zs(c,ws(Ba(o,s),r,!0));return ih(l,u,a)}}),sh=Ni({hingeLoss_:function(t,e,r,i){void 0===i&&(i=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=ki(t,"labels","hingeLoss"),o=ki(e,"predictions","hingeLoss"),s=null;null!=r&&(s=ki(r,"weights","hingeLoss")),x(a.shape,o.shape,"Error in hingeLoss: ");var u=ys(1);a=Zs(Ba(ys(2),a),u);var c=vc(Zs(u,Ba(a,o)));return ih(c,s,i)}}),uh=Ni({huberLoss_:function(t,e,r,i,a){void 0===i&&(i=1),void 0===a&&(a=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=ki(t,"labels","huberLoss"),s=ki(e,"predictions","huberLoss"),u=null;null!=r&&(u=ki(r,"weights","huberLoss")),x(o.shape,s.shape,"Error in huberLoss: ");var c=ys(i),l=za(Zs(s,o)),h=pu(l,c),p=Zs(l,h),f=Fa(Ba(ys(.5),xs(h)),Ba(c,p));return ih(f,u,a)}}),ch=Ni({logLoss_:function(t,e,r,i,a){void 0===i&&(i=1e-7),void 0===a&&(a=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=ki(t,"labels","logLoss"),s=ki(e,"predictions","logLoss"),u=null;null!=r&&(u=ki(r,"weights","logLoss")),x(o.shape,s.shape,"Error in logLoss: ");var c=ys(1),l=ys(i),h=qs(Ba(o,Ws(Fa(s,l)))),p=Ba(Zs(c,o),Ws(Fa(Zs(c,s),l))),f=Zs(h,p);return ih(f,u,a)}}),lh=Ni({meanSquaredError_:function(t,e,r,i){void 0===i&&(i=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=ki(t,"labels","meanSquaredError"),o=ki(e,"predictions","meanSquaredError"),s=null;null!=r&&(s=ki(r,"weights","meanSquaredError")),x(a.shape,o.shape,"Error in meanSquaredError: ");var u=Gc(a,o);return ih(u,s,i)}}),hh=Ni({sigmoidCrossEntropy_:function(t,e,r,i,a){void 0===i&&(i=0),void 0===a&&(a=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=ki(t,"multiClassLabels","sigmoidCrossEntropy"),s=ki(e,"logits","sigmoidCrossEntropy"),u=null;if(null!=r&&(u=ki(r,"weights","sigmoidCrossEntropy")),x(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),i>0){var c=ys(i),l=ys(1),h=ys(.5);o=Fa(Ba(o,Zs(l,c)),Ba(h,c))}var p=function(t,e){var n=ki(t,"labels","sigmoidCrossEntropyWithLogits"),r=ki(e,"logits","sigmoidCrossEntropyWithLogits");x(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=vc(r),a=Ba(r,n),o=Vs(Es(qs(za(r))));return Fa(Zs(i,a),o)}(o,s);return ih(p,u,a)}}),ph=Ni({softmaxCrossEntropy_:function(t,e,r,i,a){void 0===i&&(i=0),void 0===a&&(a=n.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=ki(t,"onehotLabels","softmaxCrossEntropy"),s=ki(e,"logits","softmaxCrossEntropy"),u=null;if(null!=r&&(u=ki(r,"weights","softmaxCrossEntropy")),x(o.shape,s.shape,"Error in softmaxCrossEntropy: "),i>0){var c=ys(i),l=ys(1),p=ys(o.shape[1]);o=Fa(Ba(o,Zs(l,c)),La(c,p))}var f=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));var r=Hs((function(t,e,r){var i=Js(e,[n],!0),a=Zs(Oa(e,"float32"),i);r([t,a]);var o=qs(Ba(a,t));return{value:ws(o,[n]),gradFunc:function(t,e){var r=h(e,2),i=r[0],a=r[1],o=ds(t.shape,[n]);return[Ba(ho(t,o),Zs(Oa(i,"float32"),Es(a))),Ba(ho(t,o),Zs(Es(a),Oa(i,"float32")))]}}}));return r(t,e)}(o,s);return ih(f,u,a)}}),fh=Ni({sparseFillEmptyRows_:function(t,e,n,r){var i=ki(t,"indices","sparseFillEmptyRows","int32"),a=ki(e,"values","sparseFillEmptyRows"),o=ki(n,"denseShape","sparseFillEmptyRows","int32"),s=ki(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(2!==i.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(i.shape));if(1!==a.rank)throw new Error("Values should be Tensor1D but received shape ".concat(a.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));var u={indices:i,values:a,denseShape:o,defaultValue:s},c=yi.runKernel(ln,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}}),dh=Ni({sparseReshape_:function(t,e,n){var r=ki(t,"inputIndices","sparseReshape","int32"),i=ki(e,"inputShape","sparseReshape","int32"),a=ki(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==i.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(i.shape));if(1!==a.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(a.shape));var o={inputIndices:r,inputShape:i,newShape:a},s=yi.runKernel(hn,o);return{outputIndices:s[0],outputShape:s[1]}}}),mh=Ni({sparseSegmentMean_:function(t,e,n){var r=ki(t,"data","sparseSegmentMean"),i=ki(e,"indices","sparseSegmentMean","int32"),a=ki(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(a.shape));var o={data:r,indices:i,segmentIds:a};return yi.runKernel(pn,o)}}),gh=Ni({sparseSegmentSum_:function(t,e,n){var r=ki(t,"data","sparseSegmentSum"),i=ki(e,"indices","sparseSegmentSum","int32"),a=ki(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(a.shape));var o={data:r,indices:i,segmentIds:a};return yi.runKernel(fn,o)}}),vh=Ni({stringNGrams_:function(t,e,n,r,i,a,o,s){var u=ki(t,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));var c=ki(e,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:i,rightPad:a,padWidth:o,preserveShortSequences:s},h={data:u,dataSplits:c},p=yi.runKernel(yn,h,l);return{nGrams:p[0],nGramsSplits:p[1]}}}),yh={fft:Pc,ifft:Lc,rfft:Uc,irfft:Bc},bh={hammingWindow:Il,hannWindow:Al,frame:Nl,stft:Cl},xh={flipLeftRight:Ol,grayscaleToRGB:Dl,resizeNearestNeighbor:Zl,resizeBilinear:Yl,rgbToGrayscale:Ml,rotateWithOffset:Fl,cropAndResize:Rl,nonMaxSuppression:Ll,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),s(this,void 0,void 0,(function(){var a,o,s,c,l,h,p;return u(this,(function(u){switch(u.label){case 0:return a=ki(t,"boxes","nonMaxSuppressionAsync"),o=ki(e,"scores","nonMaxSuppressionAsync"),s=Pl(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return c=u.sent(),l=c[0],h=c[1],p=Ul(l,h,n,r,i).selectedIndices,a!==t&&a.dispose(),o!==e&&o.dispose(),[2,qc(p,"int32")]}}))}))},nonMaxSuppressionWithScore:ql,nonMaxSuppressionWithScoreAsync:function(t,e,n,r,i,a){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0),s(this,void 0,void 0,(function(){var o,s,c,l,h,p,f,d,m;return u(this,(function(u){switch(u.label){case 0:return o=ki(t,"boxes","nonMaxSuppressionAsync"),s=ki(e,"scores","nonMaxSuppressionAsync"),c=Pl(o,s,n,r,i,a),n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,a=c.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=u.sent(),h=l[0],p=l[1],f=Wl(h,p,n,r,i,a),d=f.selectedIndices,m=f.selectedScores,o!==t&&o.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:qc(d,"int32"),selectedScores:qc(m)}]}}))}))},nonMaxSuppressionPadded:Kl,nonMaxSuppressionPaddedAsync:function(t,e,n,r,i,a){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=!1),s(this,void 0,void 0,(function(){var o,s,c,l,p,f,d,m,g,v,y,b;return u(this,(function(u){switch(u.label){case 0:return o=ki(t,"boxes","nonMaxSuppressionAsync"),s=ki(e,"scores","nonMaxSuppressionAsync"),c=Pl(o,s,n,r,i,null),l=c.maxOutputSize,p=c.iouThreshold,f=c.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return d=h.apply(void 0,[u.sent(),2]),m=d[0],g=d[1],v=Gl(m,g,l,p,f,a),y=v.selectedIndices,b=v.validOutputs,o!==t&&o.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:qc(y,"int32"),validOutputs:ys(b,"int32")}]}}))}))},threshold:$l,transform:Jl},wh={bandPart:Ql,gramSchmidt:th,qr:rh},_h={absoluteDifference:ah,computeWeightedLoss:ih,cosineDistance:oh,hingeLoss:sh,huberLoss:uh,logLoss:ch,meanSquaredError:lh,sigmoidCrossEntropy:hh,softmaxCrossEntropy:ph},Sh={sparseFillEmptyRows:fh,sparseReshape:dh,sparseSegmentMean:mh,sparseSegmentSum:gh},Th={stringNGrams:vh,stringSplit:Ni({stringSplit_:function(t,e,n){void 0===n&&(n=!0);var r=ki(t,"input","stringSplit","string"),i=ki(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==i.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(i.shape));var a={skipEmpty:n},o={input:r,delimiter:i},s=yi.runKernel(bn,o,a);return{indices:s[0],values:s[1],shape:s[2]}}}),stringToHashBucketFast:Ni({stringToHashBucketFast_:function(t,e){var n=ki(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");var i={input:n};return yi.runKernel(xn,i,r)}}),staticRegexReplace:Ni({staticRegexReplace_:function(t,e,n,r){void 0===r&&(r=!0);var i=ki(t,"input","staticRegexReplace","string"),a={pattern:e,rewrite:n,replaceGlobal:r};return yi.runKernel(gn,{x:i},a)}})},Eh=new Map,kh=new Map,Ih=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),Ah=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Nh(t,e,n){b(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),b("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),b(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),void 0===e&&(e="Custom"),void 0===n&&(n=t.className);var r=e+">"+n;return Ah.register(t),Eh.set(r,t),kh.set(t,r),t}var Ch={__proto__:null,Serializable:Ih,SerializationMap:Ah,getRegisteredName:function(t){return kh.has(t)?kh.get(t):t.className},registerClass:Nh},Rh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,a=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:a[t.name]}}));this.applyGradients(o)}else this.applyGradients(a);return Pi(a),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!1,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return js(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&Pi(this.iterations_)},e.prototype.saveIterations=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:ys(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}))}))},e.prototype.extractIterations=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(Ih);Object.defineProperty(Rh,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var Oh=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=yi.backend.epsilon()),i}return o(e,t),Object.defineProperty(e,"className",{get:function(){return"Adadelta"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=yi.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:Fi((function(){return as(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:Fi((function(){return as(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;Fi((function(){var t=Fa(Ba(o,e.rho),Ba(xs(a),1-e.rho)),n=Ba(La(bs(Fa(s,e.epsilon)),bs(Fa(o,e.epsilon))),a),r=Fa(Ba(s,e.rho),Ba(xs(n),1-e.rho));o.assign(t),s.assign(r);var u=Fa(Ba(n,-e.learningRate),i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Pi(this.accumulatedGrads.map((function(t){return t.variable}))),Pi(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=p(p([],h(this.accumulatedGrads),!1),h(this.accumulatedUpdates),!1),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=t.length/2,this.accumulatedGrads=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e}(Rh),Dh=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return o(e,t),Object.defineProperty(e,"className",{get:function(){return"Adagrad"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=yi.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:Fi((function(){return Ro(i.shape,e.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable;Fi((function(){var t=Fa(o,xs(a));o.assign(t);var n=Fa(Ba(La(a,bs(Fa(t,yi.backend.epsilon()))),-e.learningRate),i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&Pi(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e}(Rh),Mh=function(t){function e(e,n,r,i){void 0===i&&(i=null);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],Fi((function(){a.accBeta1=ys(n).variable(),a.accBeta2=ys(r).variable()})),null==i&&(a.epsilon=yi.backend.epsilon()),a}return o(e,t),Object.defineProperty(e,"className",{get:function(){return"Adam"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Fi((function(){var r=Zs(1,e.accBeta1),i=Zs(1,e.accBeta2);n.forEach((function(n,a){var o=yi.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:"".concat(n,"/m"),variable:Fi((function(){return as(o).variable(!1)}))}),null==e.accumulatedSecondMoment[a]&&(e.accumulatedSecondMoment[a]={originalName:"".concat(n,"/v"),variable:Fi((function(){return as(o).variable(!1)}))});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedSecondMoment[a].variable,l=Fa(Ba(u,e.beta1),Ba(s,1-e.beta1)),h=Fa(Ba(c,e.beta2),Ba(xs(s),1-e.beta2)),p=La(l,r),f=La(h,i);u.assign(l),c.assign(h);var d=Fa(Ba(La(p,Fa(bs(f),e.epsilon)),-e.learningRate),o);o.assign(d)}})),e.accBeta1.assign(Ba(e.accBeta1,e.beta1)),e.accBeta2.assign(Ba(e.accBeta2,e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Pi(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Pi(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=p(p([],h(this.accumulatedFirstMoment),!1),h(this.accumulatedSecondMoment),!1),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return u(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),Fi((function(){n.accBeta1.assign(vs(n.beta1,n.iterations_+1)),n.accBeta2.assign(vs(n.beta2,n.iterations_+1))})),e=t.length/2,this.accumulatedFirstMoment=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e}(Rh),Fh=function(t){function e(e,n,r,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.decay=a,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],Fi((function(){o.iteration=ys(0).variable(),o.accBeta1=ys(n).variable()})),null==i&&(o.epsilon=yi.backend.epsilon()),o}return o(e,t),Object.defineProperty(e,"className",{get:function(){return"Adamax"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Fi((function(){var r=Zs(1,e.accBeta1),i=La(-e.learningRate,Fa(Ba(e.iteration,e.decay),1));n.forEach((function(n,a){var o=yi.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:"".concat(n,"/m"),variable:as(o).variable(!1)}),null==e.accumulatedWeightedInfNorm[a]&&(e.accumulatedWeightedInfNorm[a]={originalName:"".concat(n,"/v"),variable:as(o).variable(!1)});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedWeightedInfNorm[a].variable,l=Fa(Ba(u,e.beta1),Ba(s,1-e.beta1)),h=Ba(c,e.beta2),p=za(s),f=uu(h,p);u.assign(l),c.assign(f);var d=Fa(Ba(La(i,r),La(l,Fa(f,e.epsilon))),o);o.assign(d)}})),e.iteration.assign(Fa(e.iteration,1)),e.accBeta1.assign(Ba(e.accBeta1,e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Pi(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Pi(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e}(Rh),Ph=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return o(e,t),Object.defineProperty(e,"className",{get:function(){return"SGD"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var a=yi.registeredVariables[n];Fi((function(){var t=Fa(Ba(e.c,i),a);a.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Li(ys(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e}(Rh),Lh=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=ys(i.momentum),i}return o(e,t),Object.defineProperty(e,"className",{get:function(){return"Momentum"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=yi.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:Fi((function(){return as(i).variable(!1)}))});var a=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&Fi((function(){var t,n=Fa(Ba(e.m,a),o);t=e.useNesterov?Fa(Ba(e.c,Fa(o,Ba(n,e.m))),i):Fa(Ba(e.c,n),i),a.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Pi(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e}(Ph),Bh=function(t){function e(e,n,r,i,a){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===a&&(a=!1);var o=t.call(this)||this;if(o.learningRate=e,o.decay=n,o.momentum=r,o.epsilon=i,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=a,null==i&&(o.epsilon=yi.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return o(e,t),Object.defineProperty(e,"className",{get:function(){return"RMSProp"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=yi.registeredVariables[n],a=!1;null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:Fi((function(){return as(i).variable(a)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:Fi((function(){return as(i).variable(a)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:Fi((function(){return as(i).variable(a)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedMeanSquares[r].variable,u=e.accumulatedMoments[r].variable;Fi((function(){var t=Fa(Ba(s,e.decay),Ba(xs(o),1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,a=Fa(Ba(n,e.decay),Ba(o,1-e.decay)),c=La(Ba(o,e.learningRate),bs(Zs(t,Fa(xs(a),e.epsilon)))),l=Fa(Ba(u,e.momentum),c);s.assign(t),n.assign(a),u.assign(l);var h=Zs(i,l);i.assign(h)}else{var p=Fa(Ba(s,e.decay),Ba(xs(o),1-e.decay));l=Fa(Ba(u,e.momentum),La(Ba(o,e.learningRate),bs(Fa(p,e.epsilon)))),s.assign(p),u.assign(l),h=Zs(i,l),i.assign(h)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Pi(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Pi(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Pi(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=p(p([],h(this.accumulatedMeanSquares),!1),h(this.accumulatedMoments),!1),this.centered&&t.push.apply(t,p([],h(this.accumulatedMeanGrads),!1)),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),e=this.centered?t.length/3:t.length/2,n=!1,this.accumulatedMeanSquares=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(n)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(n)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(n)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e}(Rh),zh=[Oh,Dh,Mh,Fh,Lh,Bh,Ph];function Uh(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var Gh=function(){function t(e){if(!J().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,a,o,s;return u(this,(function(u){switch(u.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=Mi.join(t.weightData),n=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i=Zi(t,r),a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,o.href=a,[4,Uh((function(){return o.dispatchEvent(new MouseEvent("click"))}))];case 2:return u.sent(),null==t.weightData?[3,4]:((s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Uh((function(){return s.dispatchEvent(new MouseEvent("click"))}))]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Qi(t)}]}}))}))},t}();Gh.URL_SCHEME="downloads://";var Wh=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}return t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(e){return[2,new Promise((function(e,n){var r=new FileReader;r.onload=function(r){var i=JSON.parse(r.target.result),a=i.modelTopology;if(null!=a)if(null!=i.weightsManifest)if(0!==t.weightsFiles.length){var o=Ji(i,(function(e){return t.loadWeights(e)}));e(o)}else e({modelTopology:a});else n(new Error("weightManifest field is missing from file ".concat(t.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(t.jsonFile.name)))},r.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(t.jsonFile)}))]}))}))},t.prototype.loadWeights=function(t){var e,n,r=this,i=[],a=[];try{for(var o=l(t),s=o.next();!s.done;s=o.next()){var u=s.value;i.push.apply(i,p([],h(u.weights),!1)),a.push.apply(a,p([],h(u.paths),!1))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}var c=this.checkManifestAndWeightFiles(t),f=a.map((function(t){return r.loadWeightsFile(t,c[t])}));return Promise.all(f).then((function(t){return[i,t]}))},t.prototype.loadWeightsFile=function(t,e){return new Promise((function(n,r){var i=new FileReader;i.onload=function(t){var e=t.target.result;n(e)},i.onerror=function(e){return r("Failed to weights data from file of path '".concat(t,"'."))},i.readAsArrayBuffer(e)}))},t.prototype.checkManifestAndWeightFiles=function(t){var e,n,r=this,i=[],a=this.weightsFiles.map((function(t){return Yi(t.name)})),o={};try{for(var s=l(t),u=s.next();!u.done;u=s.next())u.value.paths.forEach((function(t){var e=Yi(t);if(-1!==i.indexOf(e))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(e,"'"));if(i.push(e),-1===a.indexOf(e))throw new Error("Weight file with basename '".concat(e,"' is not provided."));o[t]=r.weightsFiles[a.indexOf(e)]}))}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}if(i.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(i.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return o},t}();function Vh(t,e,n,r){!function(t){b(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){b(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t)})),b(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e)})),b(e>=t,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)}))}(n=n??0,r=r??1);var i=0;return Promise.all(t.map((function(a){return a.then((function(a){var o=n+ ++i/t.length*(r-n);return e(o),a})),a})))}function jh(t,e){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s,c,l,h;return u(this,(function(u){switch(u.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?J().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,a=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=u.sent(),[3,4];case 2:return[4,Vh(r,e.onProgress,i,a)];case 3:o=u.sent(),u.label=4;case 4:return s=o.map((function(t){return t.arrayBuffer()})),c=.5,l=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return h=u.sent(),[3,8];case 6:return[4,Vh(s,e.onProgress,c,l)];case 7:h=u.sent(),u.label=8;case 8:return[2,h]}}))}))}function Hh(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),s(e,void 0,void 0,(function(){var e,a,o,s,c,l,h,p,f,d;return u(this,(function(u){switch(u.label){case 0:if(e=n.map((function(){return!1})),a={},o=null!=i?i.map((function(){return!1})):[],s=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u="quantization"in t?t.quantization.dtype:t.dtype,c=Di[u]*_(t.shape),l=function(){e[n]=!0,null==a[n]&&(a[n]=[]),a[n].push({manifestEntry:t,groupOffset:r,sizeBytes:c})};null!=i?i.forEach((function(e,n){e===t.name&&(l(),o[n]=!0)})):l(),s.push(t.name),r+=c}))})),!o.every((function(t){return t})))throw c=i.filter((function(t,e){return!o[e]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."));return l=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),h=[],l.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;h.push(e)}))})),[4,t(h)];case 1:return p=u.sent(),f={},d=0,l.forEach((function(t){var e=n[t].paths.length,r=new Mi(p.slice(d,d+e));a[t].forEach((function(t){var e=Gi(r.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)f[n]=e[n]})),d+=e})),[2,f]}}))}))}}ea.registerSaveRouter((function(t){return J().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Gh.URL_SCHEME)?function(t){return void 0===t&&(t="model"),new Gh(t)}(t.slice(Gh.URL_SCHEME.length)):null}));var Xh=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(b("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=J().platform.fetch,b(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&b(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,a;return u(this,(function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=Zi(t,n),e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&(i=Mi.join(t.weightData),e.body.append("model.weights.bin",new Blob([i],{type:"application/octet-stream"}),"model.weights.bin")),[4,this.fetch(this.path,e)];case 1:if((a=o.sent()).ok)return[2,{modelArtifactsInfo:Qi(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(a.status,"."))}}))}))},t.prototype.loadModelJSON=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i;return u(this,(function(a){switch(a.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=a.sent()).ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");a.label=2;case 2:return a.trys.push([2,4,,5]),[4,t.json()];case 3:return e=a.sent(),[3,5];case 4:throw a.sent(),n="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=e.modelTopology,i=e.weightsManifest,null==r&&null==i)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return[2,e]}}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(e){switch(e.label){case 0:return this.loadOptions.streamWeights?[2,this.loadStream()]:[4,this.loadModelJSON()];case 1:return[2,Ji(e.sent(),(function(e){return t.loadWeights(e)}))]}}))}))},t.prototype.loadStream=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i=this;return u(this,(function(a){switch(a.label){case 0:return[4,this.loadModelJSON()];case 1:return t=a.sent(),[4,this.getWeightUrls(t.weightsManifest)];case 2:return e=a.sent(),n=ta(t.weightsManifest),r=function(){return function(t,e){var n,r,i=this,a=null==e.fetchFunc?J().platform.fetch:e.fetchFunc,o=0;return null===(n=e.onProgress)||void 0===n||n.call(e,0),new ReadableStream({pull:function(n){return s(i,void 0,void 0,(function(){var i,s,c,l,h;return u(this,(function(u){switch(u.label){case 0:return o<t.length?r?[3,2]:[4,a(t[o],e.requestInit,{isBinary:!0})]:[3,4];case 1:s=u.sent().body,r=s.getReader(),u.label=2;case 2:return[4,r.read()];case 3:return c=u.sent(),l=c.done,h=c.value,l?(o++,r=void 0,null===(i=e.onProgress)||void 0===i||i.call(e,o/t.length),[3,0]):(n.enqueue(h),[2]);case 4:return n.close(),[2]}}))}))}})}(e,i.loadOptions)},[2,Object.assign(Object.assign({},t),{weightSpecs:n,getWeightStream:r})]}}))}))},t.prototype.getWeightUrls=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,c,f,d,m,g,v,y,b,x,w,_,S,T,E;return u(this,(function(u){switch(u.label){case 0:e=Array.isArray(this.path)?this.path[1]:this.path,n=h(function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),2),r=n[0],i=n[1],a=this.weightPathPrefix||r,o=[],s=[];try{for(c=l(t),f=c.next();!f.done;f=c.next()){d=f.value;try{for(T=void 0,m=l(d.paths),g=m.next();!g.done;g=m.next())v=g.value,null!=this.weightUrlConverter?s.push(this.weightUrlConverter(v)):o.push(a+v+i)}catch(t){T={error:t}}finally{try{g&&!g.done&&(E=m.return)&&E.call(m)}finally{if(T)throw T.error}}}}catch(t){_={error:t}}finally{try{f&&!f.done&&(S=c.return)&&S.call(c)}finally{if(_)throw _.error}}return this.weightUrlConverter?(b=(y=o.push).apply,x=[o],w=[[]],[4,Promise.all(s)]):[3,2];case 1:b.apply(y,x.concat([p.apply(void 0,w.concat([h.apply(void 0,[u.sent()]),!1]))])),u.label=2;case 2:return[2,o]}}))}))},t.prototype.loadWeights=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(i){switch(i.label){case 0:return[4,this.getWeightUrls(t)];case 1:return e=i.sent(),n=ta(t),[4,jh(e,this.loadOptions)];case 2:return r=i.sent(),[2,[n,r]]}}))}))},t}();function qh(t){return null!=t.match(Xh.URL_SCHEME_REGEX)}Xh.URL_SCHEME_REGEX=/^https?:\/\//;var Kh=function(t,e){return("undefined"!=typeof fetch||null!=e&&null!=e.fetchFunc)&&(Array.isArray(t)?t.every((function(t){return qh(t)})):qh(t))?Yh(t,e):null};function Yh(t,e){return new Xh(t,e)}ea.registerSaveRouter(Kh),ea.registerLoadRouter(Kh);var Zh=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return this.modelArtifacts},t}(),$h=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return this.saveHandler(t)},t}(),Jh=function(t){t.load&&(this.load=function(){return Promise.resolve(t.load())}),t.save&&(this.save=function(e){return Promise.resolve(t.save(e))})};function Qh(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Zh(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Zh({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Zh({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}var tp,ep={__proto__:null,CompositeArrayBuffer:Mi,browserFiles:function(t){return new Wh(t)},browserHTTPRequest:function(t,e){return Yh(t,e)},concatenateArrayBuffers:function(t){return Mi.join(t)},copyModel:function(t,e){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,ka(t,e,!1)]}))}))},decodeWeights:Gi,decodeWeightsStream:function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,a,o,c,h,p,f,d,m,g,v,y=this;return u(this,(function(b){switch(b.label){case 0:n={},r=t.getReader(),i=new ArrayBuffer(0),b.label=1;case 1:b.trys.push([1,7,8,9]),a=l(e),o=a.next(),b.label=2;case 2:return o.done?[3,6]:[4,Vi(c=o.value,(function(t,e){return s(y,void 0,void 0,(function(){return u(this,(function(n){switch(n.label){case 0:return[4,Hi(r,i,e)];case 1:return[2,(i=n.sent()).slice(t,e)]}}))}))}))];case 3:return h=b.sent(),[4,Hi(r,i,h)];case 4:i=b.sent(),p=i.slice(0,h),i=i.slice(h),f=ji(c,p),n[c.name]=f,"webgpu"===Bi()&&"uploadToGPU"in(d=zi())&&_(f.shape)>=J().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&d.uploadToGPU(f.dataId),b.label=5;case 5:return o=a.next(),[3,2];case 6:return[3,9];case 7:return m=b.sent(),g={error:m},[3,9];case 8:try{o&&!o.done&&(v=a.return)&&v.call(a)}finally{if(g)throw g.error}return[7];case 9:return[2,n]}}))}))},encodeWeights:function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,a,o,c=this;return u(this,(function(l){switch(l.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),a=function(a){var o=i[a],l=Array.isArray(t)?t[a].tensor:t[o];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype&&"complex64"!==l.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(l.dtype));var h={name:o,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var p=new Promise((function(t){return s(c,void 0,void 0,(function(){var e,n,r,i,a,o,s;return u(this,(function(u){switch(u.label){case 0:return[4,l.bytes()];case 1:for(e=u.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+Ui*e.length,r=new Uint8Array(n),i=0,a=0;a<e.length;a++)o=e[a],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,i),i+=Ui,r.set(o,i),i+=o.length;return t(r),[2]}}))}))}));r.push(p)}else r.push(l.data());null!=e&&(h.group=e),n.push(h)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:Xi(l.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){var i=arguments;return new Jh(Qh.apply(void 0,p([],h(i),!1)))},fromMemorySync:Qh,getLoadHandlers:function(t,e){return ea.getLoadHandlers(t,e)},getModelArtifactsForJSON:Ji,getModelArtifactsForJSONSync:$i,getModelArtifactsInfoForJSON:Qi,getSaveHandlers:function(t){return ea.getSaveHandlers(t)},getWeightSpecs:ta,http:Yh,isHTTPScheme:qh,listModels:function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,a,o,s,c,h;return u(this,(function(u){switch(u.label){case 0:t=Ta.getSchemes(),e={},u.label=1;case 1:u.trys.push([1,6,7,8]),n=l(t),r=n.next(),u.label=2;case 2:return r.done?[3,5]:(i=r.value,[4,Ta.getManager(i).listModels()]);case 3:for(o in a=u.sent())e[i+Sa+o]=a[o];u.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return s=u.sent(),c={error:s},[3,8];case 7:try{r&&!r.done&&(h=n.return)&&h.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2,e]}}))}))},loadWeights:function(t,e,n,r){return void 0===e&&(e=""),s(this,void 0,void 0,(function(){return u(this,(function(i){return[2,Hh((function(t){return jh(t,{requestInit:r})}))(t,e,n)]}))}))},moveModel:function(t,e){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,ka(t,e,!0)]}))}))},registerLoadRouter:function(t){return ea.registerLoadRouter(t)},registerSaveRouter:function(t){return ea.registerSaveRouter(t)},removeModel:function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){return e=Ea(t),[2,Ta.getManager(e.scheme).removeModel(e.path)]}))}))},weightsLoaderFactory:Hh,withSaveHandler:function(t){return new $h(t)},withSaveHandlerSync:function(t){return new $h(t)}},np={__proto__:null,confusionMatrix:Ni({confusionMatrix_:function(t,e,n){var r=ki(t,"labels","confusionMatrix"),i=ki(e,"predictions","confusionMatrix");b(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),b(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),b(1===i.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(i.rank)})),b(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(i.shape[0],". ")+"Labels and predictions should have the same number of elements."})),b(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var a=bu(Oa(r,"int32"),n),o=bu(Oa(i,"int32"),n),s=ul(a),u=go(s,o);return Oa(u,"int32")}})},rp=!1;function ip(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));s=!0}if(null!=zn(Rn,yi.backendName)){var u={pixels:t},c={numChannels:e};return yi.runKernel(Rn,u,c)}var l,p,f=h(i?[t.videoWidth,t.videoHeight]:[t.width,t.height],2),d=f[0],m=f[1];if(o)l=t.getContext("2d").getImageData(0,0,d,m).data;else if(r||n)l=t.data;else if(a||i||s){if(null==tp)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");tp=new OffscreenCanvas(1,1).getContext("2d")}else tp=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});tp.canvas.width=d,tp.canvas.height=m,tp.drawImage(t,0,0,d,m),l=tp.getImageData(0,0,d,m).data}if(4===e)p=new Int32Array(l);else{var g=d*m;p=new Int32Array(g*e);for(var v=0;v<g;v++)for(var y=0;y<e;++y)p[v*e+y]=l[4*v+y]}return Yc(p,[m,d,e],"int32")}function ap(t){if(2!==t.rank&&3!==t.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(t.rank,"."));var e=2===t.rank?1:t.shape[2];if(e>4||2===e)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(e));if("float32"!==t.dtype&&"int32"!==t.dtype)throw new Error("Unsupported type for toPixels: ".concat(t.dtype,".")+" Please use float32 or int32 tensors.")}var op={__proto__:null,draw:function(t,e,n){var r=ki(t,"img","draw");if(!(t instanceof Zr)){var i=r;r=Oa(i,"int32"),i.dispose()}ap(r),function(t){var e=(null==t?void 0:t.alpha)||1;if(e>1||e<0)throw new Error("Alpha value ".concat(e," is suppoed to be in range [0 - 1]."))}(null==n?void 0:n.imageOptions);var a={image:r},o={canvas:e,options:n};yi.runKernel(Gt,a,o)},fromPixels:Ni({fromPixels_:ip}),fromPixelsAsync:function(t,e){return void 0===e&&(e=3),s(this,void 0,void 0,(function(){var n,r;return u(this,(function(i){switch(i.label){case 0:if(n=null,!J().getBool("WRAP_TO_IMAGEBITMAP")||!function(t){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(t instanceof ImageBitmap)&&function(t){return null!=t&&0!==t.width&&0!==t.height}(t)&&!function(t){return null!=t&&t.data instanceof Uint8Array}(t)}(t))return[3,5];r=void 0,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,createImageBitmap(t,{premultiplyAlpha:"none"})];case 2:return r=i.sent(),[3,4];case 3:return i.sent(),r=null,[3,4];case 4:return n=null!=r&&r.width===t.width&&r.height===t.height?r:t,[3,6];case 5:n=t,i.label=6;case 6:return[2,ip(n,e)]}}))}))},toPixels:function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s,c,l,p,f,d,m,g,v,y,b;return u(this,(function(u){switch(u.label){case 0:return n=ki(t,"img","toPixels"),t instanceof Zr||(n=Oa(r=n,"int32"),r.dispose()),ap(n),i=h(n.shape.slice(0,2),2),a=i[0],o=i[1],s=2===n.rank?1:n.shape[2],[4,n.data()];case 1:for(c=u.sent(),l="float32"===n.dtype?255:1,p=new Uint8ClampedArray(o*a*4),f=0;f<a*o;++f){for(d=[0,0,0,255],m=0;m<s;m++){if(g=c[f*s+m],"float32"===n.dtype){if(g<0||g>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(g,"."))}else if("int32"===n.dtype&&(g<0||g>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(g,"."));1===s?(d[0]=g*l,d[1]=g*l,d[2]=g*l):d[m]=g*l}p[0+(v=4*f)]=Math.round(d[0]),p[v+1]=Math.round(d[1]),p[v+2]=Math.round(d[2]),p[v+3]=Math.round(d[3])}return null!=e&&(rp||null!=zn(Gt,yi.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),rp=!0),e.width=o,e.height=a,y=e.getContext("2d"),b=new ImageData(p,o,a),y.putImageData(b,0,0)),n!==t&&n.dispose(),[2,p]}}))}))}};function sp(t,e){var n=t.shape.length,r=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[r-1]," vs. ").concat(n));if(0===_(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));for(var i=e.shape,a=i[i.length-1],o=1,s=0;s<i.length-1;++s)o*=i[s];var u=t.shape,c=i.slice();c.pop();var l=1;for(s=a;s<n;++s)l*=u[s],c.push(u[s]);var f=p(p([],h(G(t.shape).map((function(t){return t/l}))),!1),[1],!1).slice(0,a);return[c,o,l,f]}var up={__proto__:null,prepareAndValidate:sp};function cp(t,e,n,r){for(var i=p([],h(t),!1),a=i.length;a<r.length;a++)i.push(1);for(a=0;a<n;a++)0===a?i[e]=1:(i.splice(e,0,1),i.pop());return i}function lp(t,e,n){return n<=t?n:n-(e-1)}function hp(t,e){for(var n=[],r=0;r<t;r++)n.push(e+r);return n}function pp(t,e,n,r,i){for(var a=p([],h(i),!1),o=hp(n,e),s=0;s<a.length;s++)if(o.indexOf(s)>-1)a[s]=0;else{var u=lp(e,n,s),c=r[u];t&1<<u&&(c=0),a[s]=c}return a}function fp(t,e,n,r,i){for(var a=p([],h(i),!1),o=hp(n,e),s=0;s<a.length;s++)if(o.indexOf(s)>-1)a[s]=Number.MAX_SAFE_INTEGER;else{var u=lp(e,n,s),c=r[u];t&1<<u&&(c=Number.MAX_SAFE_INTEGER),a[s]=c}for(var l=0;l<a.length;l++){var f=i[l];a[l]<0&&(a[l]+=f),a[l]=v(0,a[l],i[l])}return a}function dp(t,e,n){var r=t[e];return(n&1<<e||null==r)&&(r=1),r}function mp(t,e,n,r,i,a){var o=e[i],s=n[i]||1;(t&1<<i||a&1<<i||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var u=r[i];return o<0&&(o+=u),v(0,o,u-1)}function gp(t,e,n,r,i,a){var o=e[i],s=n[i]||1;(t&1<<i||a&1<<i||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=r[i];return o<0&&(o+=u),s>0?v(0,o,u):v(-1,o,u-1)}function vp(t,e,n,r,i,a){if(i[e])return n>0?a[e]:a[e+1&1];var o=t<0?r+t:t;return o<a[0]?a[0]:o>a[1]?a[1]:o}var yp,bp={__proto__:null,assertParamsValid:function(t,e,n){var r=t.shape.length;b(r===e.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(r,").")})),b(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var i=function(i){b(e[i]+n[i]<=t.shape[i],(function(){return"Error in slice".concat(r,"D: begin[").concat(i,"] + size[").concat(i,"] ")+"(".concat(e[i]+n[i],") would overflow input.shape[").concat(i,"] (").concat(t.shape[i],")")}))},a=0;a<r;++a)i(a)},computeFlatOffset:function(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n},computeOutShape:function(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r},getNormalizedAxes:function(t,e,n,r,i,a,o,s,u){var c=t.length,l=new Array(c),h=new Array(c),p=new Array(c);if(e.length&&n>0){var f=e[0],d=n+1;l=pp(o,f,d,r,t),h=fp(s,f,d,i,t),p=cp(a,f,d,t)}else for(var m=0;m<c;m++)l[m]=mp(o,r,a,t,m,u),h[m]=gp(s,i,a,t,m,u),p[m]=dp(a,m,u);return{begin:l,end:h,strides:p}},isSliceContinous:function(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0},maskToAxes:function(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e},parseSliceParams:function(t,e,n){var r,i,a=t.shape.length;return(r="number"==typeof e?p([e],h(new Array(a-1).fill(0)),!1):e.length<a?e.concat(new Array(a-e.length).fill(0)):e.slice()).forEach((function(t){b(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(a).fill(-1):"number"==typeof n?p([n],h(new Array(a-1).fill(-1)),!1):n.length<a?n.concat(new Array(a-n.length).fill(-1)):n).map((function(e,n){return e>=0?e:(b(-1===e,(function(){return"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,".")})),t.shape[n]-r[n])})),[r,i]},sliceInfo:function(t,e,n,r,i,a,o,s,u){var c;if(null==r?(c=new Array(e.length)).fill(1):c=r,null!=o&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u},p=0;p<h.dims;p++)l&&1<<p&s&&h.numAddAxisAfterEllipsis++,1<<p&o&&(l=!0);l||(h.ellipsisMask|=1<<h.dims,h.dims++);var f={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;var n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(var r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask)for(var i=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);n<i;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(-2),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(-1),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}(h,f);var d=!0,m=!0,g=!0,v=[],y=[];for(p=0;p<t.length;++p){if(0===f.strides[p])throw Error("strides[".concat(p,"] must be non-zero"));var b=!!(f.shrinkAxisMask&1<<p),x=t[p];if(-1!==x){var w=[f.beginMask&1<<p,f.endMask&1<<p],_=[f.strides[p]>0?0:-1,f.strides[p]>0?x:x-1];if(b&&f.strides[p]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===f.strides[p];var S=!!(f.beginMask&1<<p&&f.endMask&1<<p);if(f.beginValid&&f.endValid){if(b){var T=f.begin[p]<0?x+f.begin[p]:f.begin[p];if(f.begin[p]=T,f.end[p]=f.begin[p]+1,T<0||T>=x)throw Error("slice index ".concat(f.begin[p]," of dimension ").concat(p," out of bounds."))}else f.begin[p]=vp(f.begin[p],0,f.strides[p],x,w,_),f.end[p]=vp(f.end[p],1,f.strides[p],x,w,_);var E=1===f.strides[p]&&0===f.begin[p]&&f.end[p]===x;d=d&&E,m=m&&(0===p&&1===f.strides[p]||E)}else d=d&&1===f.strides[p]&&S,m=m&&(0===p&&1===f.strides[p]||S);var k=void 0,I=!1;if(f.beginValid&&f.endValid?(k=f.end[p]-f.begin[p],I=!0):b?(k=1,I=!0):S&&x>=0&&(k=f.strides[p]<0?-x:x,I=!0),I){var A;A=0===k||k<0!=f.strides[p]<0?0:Math.trunc(k/f.strides[p])+(k%f.strides[p]!=0?1:0),v.push(A)}else v.push(-1)}else v.push(b?1:-1)}for(var N=0;N<f.finalShapeGatherIndices.length;++N){var C=f.finalShapeGatherIndices[N];C>=0?y.push(v[C]):-2===C&&y.push(1)}return{finalShapeSparse:y.filter((function(t,e){return-2!==f.finalShapeGatherIndices[e]})),finalShape:y,isIdentity:d,sliceDim0:m,isSimpleSlice:g,begin:f.begin,end:f.end,strides:f.strides}},startForAxis:mp,startIndicesWithElidedDims:pp,stopForAxis:gp,stopIndicesWithElidedDims:fp,stridesForAxis:dp,stridesWithElidedDims:cp},xp=function(){function t(){}return t.sgd=function(t){return new Ph(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new Lh(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new Bh(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new Mh(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new Oh(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new Fh(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new Dh(t,e)},t}(),wp=xp,_p="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:void 0!==c?c:function(t){return t()};!function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(yp||(yp={}));var Sp=/->/g;function Tp(t,e){for(var n=[],r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}var Ep={__proto__:null,ERF_A1:.254829592,ERF_A2:-.284496736,ERF_A3:1.421413741,ERF_A4:-1.453152027,ERF_A5:1.061405429,ERF_P:.3275911,PARALLELIZE_THRESHOLD:30,get RowPartitionType(){return yp},SELU_SCALE:1.0507009873554805,SELU_SCALEALPHA:1.7580993408473768,applyActivation:bl,assertAndGetBroadcastShape:es,assertAxesAreInnerMostDims:function(t,e,n){b(ps(e,n),(function(){return"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")}))},assertParamsConsistent:function(t,e){var n=t[0].length;t.forEach((function(t,e){b(t.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),b(e>=0&&e<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=t[0];t.forEach((function(t,i){for(var a=0;a<n;a++)b(a===e||t[a]===r[a],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(i,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(i,".")}))}))},assignToTypedArray:function(t,e,n,r){t[2*r]=e,t[2*r+1]=n},axesAreInnerMostDims:ps,calculateShapes:Jc,checkEinsumDimSizes:function(t,e,n){for(var r=new Array(t),i=function(t){for(var i=n[t].shape,a=function(n){void 0===r[e[t][n]]?r[e[t][n]]=i[n]:b(r[e[t][n]]===i[n],(function(){return"Expected dimension ".concat(r[e[t][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(i),", ")+"but got dimension ".concat(i[n])}))},o=0;o<e[t].length;++o)a(o)},a=0;a<n.length;++a)i(a)},checkPadOnDimRoundingMode:lo,combineLocations:fs,combineRaggedTensorToTensorShapes:function(t,e,n){var r=new Array;if(null==n&&null==e)return r;if(null==e)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(t+n.length,", but shape.rank = ").concat(r.length));for(var i=1;i<n.length;++i){var a=n[i],o=r[r.length-n.length+i],s=r[o];if(a>=0)if(s>=0){if(s!==a)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(i+t,"] = ").concat(a," but shape[").concat(i+t,"] = ").concat(s))}else r[o]=a}return r},complexWithEvenIndex:function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}},complexWithOddIndex:function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}},computeConv2DInfo:Qa,computeConv3DInfo:to,computeDefaultPad:eo,computeDilation2DInfo:function(t,e,n,r,i,a){void 0===i&&(i="NHWC");var o=t[3];return Qa(t,p(p([],h(e),!1),[o],!1),n,a,r,null,null,co(i))},computeOptimalWindowSize:function(t){return t<=30?t:U(t,Math.floor(Math.sqrt(t)))},computeOutAndReduceShapes:function(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]},computeOutShape:function(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n},computePool2DInfo:Ja,computePool3DInfo:function(t,e,n,r,i,a,o){void 0===o&&(o="NDHWC");var s,u,c=h(ro(e),3),l=c[0],p=c[1],f=c[2];if("NDHWC"===o)u="channelsLast",s=[l,p,f,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat ".concat(o));u="channelsFirst",s=[l,p,f,t[1],t[1]]}return to(t,s,n,r,i,!1,u,a)},convertConv2DDataFormat:co,decodeEinsumEquation:function(t,e){var n=((t=t.replace(/\s/g,"")).length-t.replace(Sp,"").length)/2;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat("->",'").'));var r=h(t.split("->"),2),i=r[0],a=r[1];b(-1===i.indexOf("..."),(function(){return'The ellipsis notation ("'.concat("...",'") is not supported yet.')}));var o=i.split(","),s=o.length;if(e!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(e));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var u=[],c=function(t){var e=a[t];if(!o.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===u.indexOf(e)&&u.push(e)},l=0;l<a.length;++l)c(l);for(l=0;l<i.length;++l){var p=i[l];-1===u.indexOf(p)&&","!==p&&u.push(p)}var f=new Array(o.length);for(l=0;l<s;++l){if(new Set(o[l].split("")).size!==o[l].length)throw new Error("Found duplicate axes in input component ".concat(o[l],". ")+"Support for duplicate axes in input is not implemented yet.");f[l]=[];for(var d=0;d<o[l].length;++d)f[l].push(u.indexOf(o[l][d]))}var m=u.length,g=[];for(l=a.length;l<m;++l)g.push(l);return{allDims:u,summedDims:g,idDims:f}},eitherStridesOrDilationsAreOne:so,expandShapeToKeepDim:ds,exponent:function(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}},exponents:function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}},fromStringArrayToUint8:function(t){return t.map((function(t){return Or(t)}))},fromUint8ToStringArray:function(t){try{return t.map((function(t){return Dr(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(t))}},getAxesPermutation:function(t,e){if(ps(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n},getBroadcastDims:Qo,getComplexWithIndex:function(t,e){return{real:t[2*e],imag:t[2*e+1]}},getEinsumComputePath:function(t,e){var n,r,i,a=t,o=[];0===t.length&&a.push(-1),i=t.length+1;for(var s=0;s<i;++s)o.push([]);var u=[];for(s=0;s<a.length;++s){var c=Tp(e,a[s]);try{for(var h=(n=void 0,l(c)),p=h.next();!p.done;p=h.next()){var f=p.value;-1===u.indexOf(f)&&(o[s].push(f),u.push(f))}}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}}return{path:a,steps:o}},getEinsumPermutation:function(t,e){var n=new Array(t);n.fill(-1);for(var r=0;r<e.length;++r)n[e[r]]=r;var i=[];for(r=0;r<t;++r)-1===n[r]&&i.push(r);return{permutationIndices:n=n.filter((function(t){return-1!==t})),expandDims:i}},getFusedBiasGradient:yl,getFusedDyActivation:vl,getImageCenter:function(t,e,n){return[n*("number"==typeof t?t:t[0]),e*("number"==typeof t?t:t[1])]},getInnerMostAxes:function(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n},getPermuted:function(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,p([],h(a),!1)),r.push(0),r.push.apply(r,p([],h(o),!1))}return r},getRaggedRank:function(t){return 0===t.length?0:t[0]===yp.FIRST_DIM_SIZE?t.length-1:t.length},getReductionAxes:ts,getReshaped:function(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var a=e.length,o=0;o<a;++o)i=i.concat([t[o+1]/e[o],e[o]]);i=i.concat(t.slice(a+1))}return i},getReshapedPermuted:function(t,e,n,r){void 0===r&&(r=!0);var i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(var a=1;a<t.length;++a)a<=e.length?r?i.push(e[a-1]*t[a]):i.push(t[a]/e[a-1]):i.push(t[a]);return i},getRowPartitionTypesHelper:function(t){var e,n,r={FIRST_DIM_SIZE:yp.FIRST_DIM_SIZE,VALUE_ROWIDS:yp.VALUE_ROWIDS,ROW_LENGTHS:yp.ROW_LENGTHS,ROW_SPLITS:yp.ROW_SPLITS,ROW_LIMITS:yp.ROW_LIMITS,ROW_STARTS:yp.ROW_STARTS},i=[];try{for(var a=l(t),o=a.next();!o.done;o=a.next()){var s=o.value;if(!(s in r))break;i.push(r[s])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},getSliceBeginCoords:function(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n},getSliceSize:function(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r},getSparseFillEmptyRowsIndicesDenseShapeMismatch:function(t){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(t)},getSparseFillEmptyRowsNegativeIndexErrorMessage:function(t,e){return"indices(".concat(t,", 0) is invalid: ").concat(e," < 0")},getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:function(t,e,n){return"indices(".concat(t,", 0) is invalid: ").concat(e," >= ").concat(n)},getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"},getSparseReshapeInputOutputMismatchErrorMessage:function(t,e){var n=_(t),r=_(e);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(t," outputShape=").concat(e)},getSparseReshapeInputOutputMultipleErrorMessage:function(t,e){var n=_(t),r=_(e);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(t," outputShape= ").concat(e)},getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:function(t,e){return"only one output dimension may be -1, not both ".concat(t," and ").concat(e)},getSparseReshapeNegativeOutputDimErrorMessage:function(t,e){return"size ".concat(t," must be non-negative, not ").concat(e)},getSparseSegmentReductionIndicesOutOfRangeErrorMessage:function(t,e,n){return"Bad: indices[".concat(t,"] == ").concat(e," out of range [0, ").concat(n,")")},getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return"segment ids must be >= 0"},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return"segment ids are not increasing"},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:function(t,e){return"Segment id ".concat(t," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")},getUndoAxesPermutation:function(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))},isIdentityPermutation:function(t){return t.every((function(t,e){return t===e}))},log:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];J().getBool("IS_TEST")||J().getBool("PROD")||console.log.apply(console,p([],h(t),!1))},mergeRealAndImagArrays:function(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n},prepareAndValidate:sp,prepareSplitSize:function(t,e,n){void 0===n&&(n=0);var r=[];if("number"==typeof e)b(t.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(t.shape[n]/e);else{b(e.reduce((function(t,e){return-1===e&&(t+=1),t}),0)<=1,(function(){return"There should be only one negative value in split array."}));var i=e.indexOf(-1);if(-1!==i){var a=e.reduce((function(t,e){return e>0?t+e:t}));e[i]=t.shape[n]-a}b(t.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e}return r},segment_util:{__proto__:null,collectGatherOpShapeInfo:function(t,e,n,r){var i=e.shape.length,a=t.shape.length;if(0!==r&&(r<-i||r>i))throw new Error("Expect batchDims in the range of [-".concat(i,", ").concat(i,"], but got ").concat(r));if(r<0&&(r+=i),r>a)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(a,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(t.shape[o]!==e.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(t.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(e.shape[o],"."));var s=t.shape[n],u=[],c=1,l=1,h=1;for(o=0;o<r;++o)u.push(t.shape[o]),c*=t.shape[o];for(o=r;o<n;o++)u.push(t.shape[o]),l*=t.shape[o];for(o=r;o<i;o++)u.push(e.shape[o]);for(o=n+1;o<a;o++)u.push(t.shape[o]),h*=t.shape[o];return{batchSize:c,sliceSize:h,outerSize:l,dimSize:s,outputShape:u}},computeOutShape:function(t,e,n){for(var r=[],i=t.length,a=0;a<i;a++)a!==e?r.push(t[a]):r.push(n);return r},segOpComputeOptimalWindowSize:function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=U(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=U(t,n+1);return n}},shouldFuse:xl,slice_util:bp,splitRealAndImagArrays:function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}},stridesOrDilationsArePositive:uo,tupleValuesAreOne:oo,upcastType:ai,validateDefaultValueShape:function(t,e){if(null!=t&&null!=e){var n=t.length,r=e.length;if(n>=r)throw new Error("defaultValue.shape=".concat(t," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var i=0;i<Math.min(n,r-1);++i){var a=t[i],o=e[i+1];if(a>=0&&o>=0&&1!==a&&a!==o)throw new Error("defaultValue.shape=".concat(t,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(i-t.length,"] = ").concat(a," but ragged tensor input.flatValues.shape[").concat(i-t.length,"] = ").concat(o))}}},validateInput:$c,validateUpdateShape:Zc,warn:Pn},kp={__proto__:null,nonMaxSuppressionV3Impl:Ul,nonMaxSuppressionV4Impl:Gl,nonMaxSuppressionV5Impl:Wl,whereImpl:ol};!function(){var t,e;try{for(var n=l(zh),r=n.next();!r.done;r=n.next())Nh(r.value)}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}(),n.Abs="Abs",n.Acos=et,n.Acosh=nt,n.AdadeltaOptimizer=Oh,n.AdagradOptimizer=Dh,n.AdamOptimizer=Mh,n.AdamaxOptimizer=Fh,n.Add=rt,n.AddN=it,n.All="All",n.Any="Any",n.ArgMax=at,n.ArgMin=ot,n.Asin=st,n.Asinh=ut,n.Atan=ct,n.Atan2=ht,n.Atanh=lt,n.AvgPool=pt,n.AvgPool3D=ft,n.AvgPool3DGrad="AvgPool3DGrad",n.AvgPoolGrad="AvgPoolGrad",n.BatchMatMul=dt,n.BatchToSpaceND=mt,n.Bincount=gt,n.BitwiseAnd=vt,n.BroadcastArgs=yt,n.BroadcastTo="BroadcastTo",n.Cast=bt,n.Ceil=xt,n.ClipByValue=wt,n.Complex=_t,n.ComplexAbs=St,n.Concat=Tt,n.Conv2D=Et,n.Conv2DBackpropFilter=kt,n.Conv2DBackpropInput=It,n.Conv3D=At,n.Conv3DBackpropFilterV2="Conv3DBackpropFilterV2",n.Conv3DBackpropInputV2=Nt,n.Cos="Cos",n.Cosh=Ct,n.CropAndResize=Dt,n.Cumprod=Rt,n.Cumsum=Ot,n.DataStorage=f,n.DenseBincount=Mt,n.DepthToSpace=Ft,n.DepthwiseConv2dNative=Pt,n.DepthwiseConv2dNativeBackpropFilter=Lt,n.DepthwiseConv2dNativeBackpropInput=Bt,n.Diag=zt,n.Dilation2D=Ut,n.Dilation2DBackpropFilter="Dilation2DBackpropFilter",n.Dilation2DBackpropInput="Dilation2DBackpropInput",n.Draw=Gt,n.Einsum=Vt,n.Elu="Elu",n.EluGrad="EluGrad",n.Environment=Z,n.Equal=jt,n.Erf="Erf",n.Exp="Exp",n.ExpandDims=Ht,n.Expm1=Xt,n.FFT="FFT",n.Fill=qt,n.FlipLeftRight=Kt,n.Floor=Yt,n.FloorDiv=Zt,n.FromPixels=Rn,n.FusedBatchNorm=$t,n.FusedConv2D=Mn,n.FusedDepthwiseConv2D=Fn,n.GatherNd=Qt,n.GatherV2=Jt,n.Greater=te,n.GreaterEqual=ee,n.IFFT=re,n.Identity=ne,n.Imag=ie,n.IsFinite=ae,n.IsInf=oe,n.IsNan=se,n.KernelBackend=d,n.LRN="LRN",n.LRNGrad="LRNGrad",n.LeakyRelu=ue,n.Less=ce,n.LessEqual=le,n.LinSpace=he,n.Log="Log",n.Log1p=pe,n.LogSoftmax="LogSoftmax",n.LogicalAnd=fe,n.LogicalNot=de,n.LogicalOr=me,n.LogicalXor="LogicalXor",n.LowerBound="LowerBound",n.MatrixBandPart="MatrixBandPart",n.Max="Max",n.MaxPool=ve,n.MaxPool3D=ye,n.MaxPool3DGrad="MaxPool3DGrad",n.MaxPoolGrad="MaxPoolGrad",n.MaxPoolWithArgmax=be,n.Maximum=ge,n.Mean=xe,n.Min="Min",n.Minimum=we,n.MirrorPad=_e,n.Mod="Mod",n.MomentumOptimizer=Lh,n.Multinomial=Se,n.Multiply=Te,n.Neg="Neg",n.NonMaxSuppressionV3=ke,n.NonMaxSuppressionV4=Ie,n.NonMaxSuppressionV5=Ae,n.NotEqual=Ee,n.OP_SCOPE_SUFFIX=Ai,n.OneHot=Ce,n.OnesLike=Ne,n.Optimizer=Rh,n.OptimizerConstructors=xp,n.Pack=Re,n.PadV2=Oe,n.Pool="Pool",n.Pow="Pow",n.Prelu=De,n.Prod=Me,n.RMSPropOptimizer=Bh,n.RaggedGather=Fe,n.RaggedRange=Pe,n.RaggedTensorToTensor=Le,n.Range=Be,n.Real=ze,n.RealDiv=Wt,n.Reciprocal=Ue,n.Relu=Ge,n.Relu6=He,n.Reshape=We,n.ResizeBilinear=je,n.ResizeBilinearGrad="ResizeBilinearGrad",n.ResizeNearestNeighbor=Ve,n.ResizeNearestNeighborGrad="ResizeNearestNeighborGrad",n.Reverse=Xe,n.RotateWithOffset=On,n.Round=qe,n.Rsqrt=Ke,n.SGDOptimizer=Ph,n.ScatterNd=Ye,n.SearchSorted=$e,n.Select=Je,n.Selu=Qe,n.Sigmoid=rn,n.Sign=nn,n.Sin="Sin",n.Sinh=en,n.Slice=tn,n.Softmax=cn,n.Softplus=an,n.SpaceToBatchND=sn,n.SparseFillEmptyRows=ln,n.SparseReshape=hn,n.SparseSegmentMean=pn,n.SparseSegmentSum=fn,n.SparseToDense=dn,n.SplitV=un,n.Sqrt=on,n.Square="Square",n.SquaredDifference=mn,n.StaticRegexReplace=gn,n.Step=Cn,n.StridedSlice=vn,n.StringNGrams=yn,n.StringSplit=bn,n.StringToHashBucketFast=xn,n.Sub="Sub",n.Sum="Sum",n.Tan="Tan",n.Tanh=wn,n.Tensor=Zr,n.TensorBuffer=qr,n.TensorScatterUpdate=Ze,n.Tile=_n,n.TopK=Sn,n.Transform=Tn,n.Transpose=En,n.Unique=kn,n.Unpack=In,n.UnsortedSegmentSum=An,n.UpperBound="UpperBound",n.Variable=ri,n.ZerosLike=Nn,n._FusedMatMul=Dn,n.abs=za,n.acos=Ua,n.acosh=Ga,n.add=Fa,n.addN=Wa,n.all=Va,n.any=ja,n.argMax=Ha,n.argMin=Xa,n.asin=qa,n.asinh=Ka,n.atan=Ya,n.atan2=Za,n.atanh=$a,n.avgPool=po,n.avgPool3d=fo,n.backend=zi,n.backend_util=Ep,n.basicLSTMCell=xo,n.batchNorm=_o,n.batchNorm2d=So,n.batchNorm3d=To,n.batchNorm4d=Eo,n.batchToSpaceND=wo,n.bincount=ko,n.bitwiseAnd=Io,n.booleanMaskAsync=function(t,e,n){return s(this,void 0,void 0,(function(){var r,i,a,o,s,c,l,h,p,f,d,m,g;return u(this,(function(u){switch(u.label){case 0:for(r=ki(t,"tensor","boolMask"),i=ki(e,"mask","boolMask","bool"),a=n??0,o=i.rank,s=r.shape,b(o>0,(function(){return"mask cannot be scalar"})),x(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=a;l<a+o;l++)c*=s[l];return h=s.slice(0,a).concat([c],s.slice(a+o)),p=ho(r,h),f=ho(i,[-1]),[4,sl(f)];case 1:return d=u.sent(),m=Wc(d,[1]),g=Rs(p,m,a),t!==r&&r.dispose(),e!==i&&i.dispose(),m.dispose(),p.dispose(),f.dispose(),d.dispose(),[2,g]}}))}))},n.broadcastArgs=Ao,n.broadcastTo=No,n.broadcast_util=ns,n.browser=op,n.buffer=Ra,n.cast=Oa,n.ceil=Co,n.clipByValue=Oo,n.clone=Da,n.complex=Ci,n.concat=mo,n.concat1d=Do,n.concat2d=Mo,n.concat3d=Fo,n.concat4d=Po,n.conv1d=Bo,n.conv2d=Lo,n.conv2dTranspose=Uo,n.conv3d=Go,n.conv3dTranspose=Vo,n.copyRegisteredKernels=function(t,e){Gn(t).forEach((function(t){Wn(Object.assign({},t,{backendName:e}))}))},n.cos=jo,n.cosh=Ho,n.cosineWindow=ml,n.cumprod=Xo,n.cumsum=qo,n.customGrad=Hs,n.denseBincount=Ko,n.deprecationWarn=function(t){J().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")},n.depthToSpace=Yo,n.depthwiseConv2d=Zo,n.device_util=wi,n.diag=$o,n.dilation2d=Jo,n.disableDeprecationWarnings=function(){J().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")},n.dispose=Pi,n.disposeVariables=function(){yi.disposeVariables()},n.div=La,n.divNoNan=os,n.dot=ss,n.dropout=fl,n.einsum=us,n.elu=cs,n.enableDebugMode=function(){J().set("DEBUG",!0)},n.enableProdMode=function(){J().set("PROD",!0)},n.enclosingPowerOfTwo=dl,n.engine=function(){return yi},n.ensureShape=ls,n.env=J,n.equal=rs,n.erf=hs,n.euclideanNorm=Ts,n.exp=Es,n.expandDims=ks,n.expm1=Is,n.eye=Ns,n.fft=Pc,n.fill=Ro,n.findBackend=function(t){return yi.findBackend(t)},n.findBackendFactory=function(t){return yi.findBackendFactory(t)},n.floor=Cs,n.floorDiv=Pa,n.fused=kl,n.gather=Rs,n.gatherND=pl,n.gather_util=up,n.getBackend=Bi,n.getGradient=Un,n.getKernel=zn,n.getKernelsForBackend=Gn,n.grad=function(t){return b(z(t),(function(){return"The f passed in grad(f) must be a function"})),function(e,n){var r=ki(e,"x","tf.grad","string_or_numeric"),i=null!=n?ki(n,"dy","tf.grad"):null;return yi.tidy((function(){var e=yi.gradients((function(){return t(r)}),[r],i),n=e.value,a=e.grads;return null!=i&&x(n.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Xs(a),a[0]}))}},n.grads=function(t){return b(z(t),(function(){return"The f passed in grads(f) must be a function"})),function(e,n){b(Array.isArray(e),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var r=Ii(e,"args","tf.grads","string_or_numeric"),i=null!=n?ki(n,"dy","tf.grads"):null;return yi.tidy((function(){var e=yi.gradients((function(){return t.apply(void 0,p([],h(r),!1))}),r,i),n=e.value,a=e.grads;return null!=i&&x(n.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Xs(a),a}))}},n.greater=Os,n.greaterEqual=Ds,n.ifft=Lc,n.imag=Ms,n.image=xh,n.inTopKAsync=function(t,e,n){return void 0===n&&(n=1),s(this,void 0,void 0,(function(){var r,i,a,o,s,c,l,p,f,d,m,g,v,y;return u(this,(function(u){switch(u.label){case 0:return r=ki(t,"predictions","inTopK"),i=ki(e,"targets","inTopK"),b(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank)})),b(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(i.rank)})),x(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],b(n>0&&n<=a,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(a,"), but got ").concat(n)})),[4,r.data()];case 1:return o=u.sent(),[4,i.data()];case 2:for(s=u.sent(),c=h([o.length/a,a],2),l=c[0],p=c[1],f=N("bool",l),d=0;d<l;d++){for(m=d*p,g=o.subarray(m,m+p),v=[],y=0;y<g.length;y++)v.push({value:g[y],index:y});for(v.sort((function(t,e){return e.value-t.value})),f[d]=0,y=0;y<n;y++)if(v[y].index===s[d]){f[d]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,Oi(f,i.shape,"bool")]}}))}))},n.io=ep,n.irfft=Bc,n.isFinite=Fs,n.isInf=Ps,n.isNaN=Ls,n.keep=Li,n.kernel_impls=kp,n.leakyRelu=Bs,n.less=zs,n.lessEqual=Us,n.linalg=wh,n.linspace=function(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:t,stop:e,num:n};return yi.runKernel(he,{},r)},n.localResponseNormalization=Gs,n.log=Ws,n.log1p=Vs,n.logSigmoid=Ys,n.logSoftmax=$s,n.logSumExp=Js,n.logicalAnd=Qs,n.logicalNot=tu,n.logicalOr=eu,n.logicalXor=nu,n.losses=_h,n.lowerBound=function(t,e){return iu(t,e,"left")},n.matMul=go,n.math=np,n.max=ms,n.maxPool=au,n.maxPool3d=ou,n.maxPoolWithArgmax=su,n.maximum=uu,n.mean=cu,n.memory=function(){return yi.memory()},n.meshgrid=function(t,e,n){var r=(void 0===n?{}:n).indexing,i=void 0===r?"xy":r;if("xy"!==i&&"ij"!==i)throw new TypeError("".concat(i," is not a valid third argument to meshgrid"));if(void 0===t)return[];var a=ki(t,"x","meshgrid",t instanceof Zr?t.dtype:"float32");if(void 0===e)return[a];var o=ki(e,"y","meshgrid",e instanceof Zr?e.dtype:"float32"),s=_(a.shape),u=_(o.shape);return"xy"===i?(a=ho(a,[1,-1]),o=ho(o,[-1,1]),[go(hu([u,1],a.dtype),a),go(o,hu([1,s],o.dtype))]):(a=ho(a,[-1,1]),o=ho(o,[1,-1]),[go(a,hu([1,u],a.dtype)),go(hu([s,1],o.dtype),o)])},n.min=gs,n.minimum=pu,n.mirrorPad=fu,n.mod=du,n.moments=mu,n.movingAverage=cl,n.mul=Ba,n.multiRNNCell=gu,n.multinomial=vu,n.neg=qs,n.nextFrame=function(){return new Promise((function(t){return _p((function(){return t()}))}))},n.norm=Ss,n.notEqual=yu,n.oneHot=bu,n.ones=hu,n.onesLike=xu,n.op=Ni,n.outerProduct=wu,n.pad=_u,n.pad1d=Su,n.pad2d=Tu,n.pad3d=Eu,n.pad4d=ku,n.pool=Au,n.pow=vs,n.prelu=Nu,n.print=Ma,n.prod=Cu,n.profile=function(t){return yi.profile(t)},n.raggedGather=Ru,n.raggedRange=Ou,n.raggedTensorToTensor=Du,n.rand=Mu,n.randomGamma=cc,n.randomNormal=lc,n.randomStandardNormal=hc,n.randomUniform=pc,n.randomUniformInt=fc,n.range=dc,n.ready=function(){return yi.ready()},n.real=mc,n.reciprocal=gc,n.registerBackend=function(t,e,n){return void 0===n&&(n=1),yi.registerBackend(t,e,n)},n.registerGradient=function(t){var e=t.kernelName;Bn.has(e)&&J().getBool("DEBUG")&&Pn("Overriding the gradient for '".concat(e,"'")),Bn.set(e,t)},n.registerKernel=Wn,n.relu=vc,n.relu6=yc,n.removeBackend=function(t){yi.removeBackend(t)},n.reshape=ho,n.reverse=bc,n.reverse1d=xc,n.reverse2d=wc,n.reverse3d=_c,n.reverse4d=Sc,n.rfft=Uc,n.round=Tc,n.rsqrt=Ec,n.scalar=ys,n.scatterND=ll,n.scatter_util=Qc,n.searchSorted=iu,n.selu=kc,n.separableConv2d=Ic,n.serialization=Ch,n.setBackend=function(t){return yi.setBackend(t)},n.setPlatform=function(t,e){J().setPlatform(t,e)},n.setdiff1dAsync=function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s,c,l,h,p;return u(this,(function(u){switch(u.label){case 0:return n=ki(t,"x","setdiff1d"),r=ki(e,"y","setdiff1d"),b(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,").")})),b(1===n.rank,(function(){return"x should be 1D tensor, but got x (".concat(n.shape,").")})),b(1===r.rank,(function(){return"y should be 1D tensor, but got y (".concat(r.shape,").")})),[4,n.data()];case 1:return i=u.sent(),[4,r.data()];case 2:for(a=u.sent(),o=new Set(a),s=0,h=0;h<i.length;h++)o.has(i[h])||s++;for(c=new qr([s],n.dtype),l=new qr([s],"int32"),h=0,p=0;h<i.length;h++)o.has(i[h])||(c.values[p]=i[h],l.values[p]=h,p++);return[2,[c.toTensor(),l.toTensor()]]}}))}))},n.sigmoid=vo,n.sign=Ac,n.signal=bh,n.sin=Nc,n.sinh=Cc,n.slice=yo,n.slice1d=Rc,n.slice2d=Oc,n.slice3d=Dc,n.slice4d=Mc,n.slice_util=bp,n.softmax=Fc,n.softplus=Ks,n.spaceToBatchND=Iu,n.sparse=Sh,n.sparseToDense=hl,n.spectral=yh,n.split=zc,n.sqrt=bs,n.square=xs,n.squaredDifference=Gc,n.squeeze=Wc,n.stack=Vc,n.step=jc,n.stridedSlice=Hc,n.string=Th,n.sub=Zs,n.sum=ws,n.sumOutType=function(t){return ai(t,"int32")},n.tan=Xc,n.tanh=bo,n.tensor=Oi,n.tensor1d=qc,n.tensor2d=Kc,n.tensor3d=Yc,n.tensor4d=function(t,e,n){if(w(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Si(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ri(t,e,r,n)},n.tensor5d=function(t,e,n){if(w(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Si(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ri(t,e,r,n)},n.tensor6d=function(t,e,n){if(w(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Si(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ri(t,e=e||r,r,n)},n.tensorScatterUpdate=tl,n.tensor_util=pi,n.test_util=ac,n.tidy=Fi,n.tile=As,n.time=function(t){return yi.time(t)},n.topk=el,n.train=wp,n.transpose=ul,n.truncatedNormal=nl,n.unique=rl,n.unregisterGradient=function(t){if(!Bn.has(t))throw new Error("The gradient '".concat(t,"' for backend is not registered"));Bn.delete(t)},n.unregisterKernel=function(t,e){var n=Vn(t,e);if(!Ln.has(n))throw new Error("The kernel '".concat(t,"' for backend ")+"'".concat(e,"' is not registered"));Ln.delete(n)},n.unsortedSegmentSum=il,n.unstack=al,n.upcastType=ai,n.upperBound=function(t,e){return iu(t,e,"right")},n.util=Pr,n.valueAndGrad=function(t){return b(z(t),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(e,n){b(e instanceof Zr,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),b(null==n||n instanceof Zr,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=yi.gradients((function(){return t(e)}),[e],n),i=r.grads,a=r.value;return Xs(i),{grad:i[0],value:a}}},n.valueAndGrads=function(t){return b(z(t),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(e,n){b(Array.isArray(e)&&e.every((function(t){return t instanceof Zr})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),b(null==n||n instanceof Zr,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var r=yi.gradients((function(){return t.apply(void 0,p([],h(e),!1))}),e,n);return null!=n&&x(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Xs(r.grads),r}},n.variable=function(t,e,n,r){return void 0===e&&(e=!0),yi.makeVariable(t,e,n,r)},n.variableGrads=js,n.version_core="4.17.0",n.where=is,n.whereAsync=sl,n.zeros=lu,n.zerosLike=as}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],t("timers").setImmediate)},{_process:16,buffer:13,crypto:12,"node-fetch":12,timers:25,util:12}],8:[function(t,e,n){(function(e,r){(function(){"use strict";var i=t("@tensorflow/tfjs-core");var a=function(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,e}(i),o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)};function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function u(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};var p={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197;return function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var i=new n(t),a=e&&e.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)}(p);var f=p.exports,d={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)}(d);var m=d.exports,g={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)}(g);var v=g.exports,y={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.x&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)}(y);var b=y.exports,x={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.X&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)}(x);var w=x.exports,_={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)}(_);var S=_.exports,T={exports:{}},E=function(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){if(this instanceof t){var n=[null];return n.push.apply(n,arguments),new(Function.bind.apply(e,n))}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}({__proto__:null,default:{}});!function(t){!function(e,n,r){var i,a=256,o="random",s=r.pow(a,6),u=r.pow(2,52),c=2*u,l=a-1;function h(t,l,h){var v=[],y=m(d((l=1==l?{entropy:!0}:l||{}).entropy?[t,g(n)]:t??function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(t){var r=e.navigator,o=r&&r.plugins;return[+new Date,e,o,e.screen,g(n)]}}(),3),v),b=new p(v),x=function(){for(var t=b.g(6),e=s,n=0;t<u;)t=(t+n)*a,e*=a,n=b.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,m(g(b.S),n),(l.pass||h||function(t,e,n,i){return i&&(i.S&&f(i,b),t.state=function(){return f(b,{})}),n?(r[o]=t,e):t})(x,y,"global"in l?l.global:this==r,l.state)}function p(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=l&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=l&i+1],n=n*a+s[l&(s[i]=s[o=l&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(d(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[l&i]=l&(n^=19*e[l&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(m(r.random(),n),t.exports){t.exports=h;try{i=E}catch(t){}}else r["seed"+o]=h}("undefined"!=typeof self?self:h,[],Math)}(T);var k=f,I=m,A=v,N=b,C=w,R=S,O=T.exports;O.alea=k,O.xor128=I,O.xorwow=A,O.xorshift7=N,O.xor4096=C,O.tychei=R;var D=O;function M(t,e,n,r){if(void 0===n&&(n=new Map),void 0===r&&(r=new Set),null==t)return null;if("function"==typeof Blob&&t instanceof Blob)return t.slice();if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);var i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(z(t)){var a=Array.isArray(t)?[]:{};for(var o in r.add(t),t){var s=M(t[o],e,n,r);a[o]=s}return r.delete(t),t.__proto__&&(a.__proto__=t.__proto__),a}throw new Error("Can't recurse into non-iterable type: ".concat(t))}return n.set(t,i.value),i.value}function F(t,e){return void 0===e&&(e=L),P(t,e)}function P(t,e,n){void 0===n&&(n=new Set);var r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");var i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(z(r)){var a=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var i=P(t.map((function(t){return t[r]})),e,n);a[r]=i};for(var s in r)o(s);return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return i.value}function L(t){return null===t?null:z(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function B(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s,u,h,p,f;return c(this,(function(c){switch(c.label){case 0:n=new Map,M(t,e,n),c.label=1;case 1:c.trys.push([1,6,7,8]),r=l(Array.from(n.keys())),i=r.next(),c.label=2;case 2:return i.done?[3,5]:(o=i.value,s=n.get(o),a.util.isPromise(s)?[4,s]:[3,4]);case 3:u=c.sent(),n.set(o,u),c.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return h=c.sent(),p={error:h},[3,8];case 7:try{i&&!i.done&&(f=r.return)&&f.call(r)}finally{if(p)throw p.error}return[7];case 8:return[2,M(t,e,n)]}}))}))}function z(e){var n=!1;return n=a.env().get("IS_BROWSER")?e instanceof TextDecoder:e instanceof t("string_decoder").StringDecoder,null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof a.Tensor)&&!(e instanceof Promise)&&!n)}function U(t){return M(t,G)}function G(t){return t instanceof a.Tensor?{value:t.clone(),recurse:!1}:z(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}var W=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){var e,n;try{for(var r=l(t),i=r.next();!i.done;i=r.next()){var a=i.value;this.push(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n},t}(),V=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return s(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=new Array(t),n=this.length(),r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n},e}(W);function j(t){return new K(t)}function H(t){return new Y(t)}V.INITIAL_CAPACITY=32;var X,q=function(){function t(){}return t.prototype.toArray=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return t=[],[4,this.next()];case 1:e=n.sent(),n.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=n.sent(),[3,2];case 4:return[2,t]}}))}))},t.prototype.toArrayForTest=function(){return u(this,void 0,void 0,(function(){var t,e,n;return c(this,(function(r){switch(r.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(e.push(n.value),[4,t.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,e]}}))}))},t.prototype.resolveFully=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}}))}))},t.prototype.resolveWhile=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return[4,this.next()];case 1:e=r.sent(),n=t(e.value),r.label=2;case 2:return e.done||!n?[3,4]:[4,this.next()];case 3:return e=r.sent(),n=t(e.value),[3,2];case 4:return[2]}}))}))},t.prototype.handleErrors=function(t){return new nt(this,t)},t.prototype.filter=function(t){return new tt(this,t)},t.prototype.map=function(t){return new et(this,t)},t.prototype.mapAsync=function(t){return new rt(this,t)},t.prototype.serialMapAsync=function(t){return new rt(this,t).serial()},t.prototype.flatmap=function(t){return new at(this,t)},t.prototype.forEachAsync=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,this.map(t).resolveFully()]}))}))},t.prototype.serialForEach=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,this.serialMapAsync(t).resolveWhile((function(t){return!0===t}))]}))}))},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new Q(this,t,e)},t.prototype.columnMajorBatch=function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=L),this.rowMajorBatch(t,e).map((function(t){return F(t,n)}))},t.prototype.concatenate=function(t,e){return new ot(j([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new J(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new $(this,t)},t.prototype.prefetch=function(t){return new ut(this,t)},t.prototype.shuffle=function(t,e){return new ct(this,t,e)},t.prototype.serial=function(){return new Z(this)},t}(),K=function(t){function e(e){var n=t.call(this)||this;return n.items=e,n.trav=0,n}return s(e,t),e.prototype.summary=function(){return"Array of ".concat(this.items.length," items")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:U(t),done:!1}])}))}))},e}(q),Y=function(t){function e(e){var n=t.call(this)||this;return n.nextFn=e,n}return s(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: ".concat(t.message),t}return[2]}))}))},e}(q),Z=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Serial")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this.upstream.next()]}))}))},e}(q),$=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Skip")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=e.sent()).done?[2,t]:(a.dispose(t.value),[3,0]);case 2:return[2,this.upstream.next()]}}))}))},e}(q),J=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Take")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]}))}))},e}(q),Q=function(t){function e(e,n,r){void 0===r&&(r=!0);var i=t.call(this)||this;return i.upstream=e,i.batchSize=n,i.enableSmallLastBatch=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:t=[],n.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=n.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}}))}))},e}(q),tt=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.predicate=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Filter")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return[4,this.upstream.next()];case 1:return(t=e.sent()).done||this.predicate(t.value)?[2,t]:(a.dispose(t.value),[3,0]);case 2:return[2]}}))}))},e}(q),et=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Map")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,h;return c(this,(function(c){switch(c.label){case 0:return[4,this.upstream.next()];case 1:if((t=c.sent()).done)return[2,{value:null,done:!0}];e=a.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=a.tensor_util.getTensorsInContainer(n);try{for(i=l(e),o=i.next();!o.done;o=i.next())s=o.value,a.tensor_util.isTensorInList(s,r)||s.dispose()}catch(t){u={error:t}}finally{try{o&&!o.done&&(h=i.return)&&h.call(i)}finally{if(u)throw u.error}}return[2,{value:n,done:!1}]}}))}))},e}(q),nt=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.handler=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> handleErrors")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}}))}))},e}(q),rt=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> AsyncMap")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,h;return c(this,(function(c){switch(c.label){case 0:return[4,this.upstream.next()];case 1:return(t=c.sent()).done?[2,{value:null,done:!0}]:(e=a.tensor_util.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:n=c.sent(),r=a.tensor_util.getTensorsInContainer(n);try{for(i=l(e),o=i.next();!o.done;o=i.next())s=o.value,a.tensor_util.isTensorInList(s,r)||s.dispose()}catch(t){u={error:t}}finally{try{o&&!o.done&&(h=i.return)&&h.call(i)}finally{if(u)throw u.error}}return[2,{value:n,done:!1}]}}))}))},e}(q),it=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new V,e.lastRead=Promise.resolve({value:null,done:!1}),e}return s(e,t),e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}}))}))},e}(q),at=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Flatmap")},e.prototype.pump=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,h;return c(this,(function(c){switch(c.label){case 0:return[4,this.upstream.next()];case 1:if((t=c.sent()).done)return[2,!1];e=a.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=a.tensor_util.getTensorsInContainer(n),this.outputQueue.pushAll(n);try{for(i=l(e),o=i.next();!o.done;o=i.next())s=o.value,a.tensor_util.isTensorInList(s,r)||s.dispose()}catch(t){u={error:t}}finally{try{o&&!o.done&&(h=i.return)&&h.call(i)}finally{if(u)throw u.error}}return[2,!0]}}))}))},e}(it),ot=function(t){function e(e,n){var r=t.call(this)||this;return r.baseErrorHandler=n,r.lastRead=null,r.iterator=null,r.moreIterators=e,r}return s(e,t),e.prototype.summary=function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")},e.prototype.next=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]}))}))},e.prototype.readFromChain=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return r.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=r.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),r.label=3;case 3:return[4,this.iterator.next()];case 4:return(n=r.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,n]}}))}))},e}(q);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(X||(X={}));var st=function(t){function e(e,n){void 0===n&&(n=X.FAIL);var r=t.call(this)||this;return r.iterators=e,r.mismatchMode=n,r.count=0,r.currentPromise=null,r}return s(e,t),e.prototype.summary=function(){return"{".concat("TODO: fill in upstream of zip summaries","} -> Zip")},e.prototype.nextState=function(t){return u(this,void 0,void 0,(function(){function e(t){return t instanceof q?{value:t.next().then((function(t){return n++,t.done&&r++,t.value})),recurse:!1}:{value:null,recurse:!0}}var n,r,i;return c(this,(function(a){switch(a.label){case 0:return[4,t];case 1:return a.sent(),n=0,r=0,[4,B(this.iterators,e)];case 2:if(i=a.sent(),n===r)return[2,{value:null,done:!0}];if(r>0)switch(this.mismatchMode){case X.FAIL:throw new Error("Zipped streams should have the same length. "+"Mismatched at element ".concat(this.count,"."));case X.SHORTEST:return[2,{value:null,done:!0}];case X.LONGEST:}return this.count++,[2,{value:i,done:!1}]}}))}))},e.prototype.next=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]}))}))},e}(q),ut=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.bufferSize=n,r.buffer=new W(n),r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Prefetch")},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(q),ct=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.upstream=e,i.windowSize=n,i.upstreamExhausted=!1,i.random=D.alea(r||a.util.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return s(e,t),e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:this.upstreamExhausted||this.refill(),n.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=n.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}}))}))},e}(ut),lt=function(){function t(){this.size=null}return t.prototype.batch=function(t,e){var n=this;void 0===e&&(e=!0);var r=this;return a.util.assert(t>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(t)})),ht((function(){return u(n,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r.iterator()];case 1:return[2,n.sent().columnMajorBatch(t,e,pt)]}}))}))}),this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,n=this;return ht((function(){return u(e,void 0,void 0,(function(){var e,r;return c(this,(function(i){switch(i.label){case 0:return[4,n.iterator()];case 1:return r=(e=i.sent()).concatenate,[4,t.iterator()];case 2:return[2,r.apply(e,[i.sent()])]}}))}))}),this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var e=this,n=this;return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().filter((function(e){return a.tidy((function(){return t(e)}))}))]}}))}))}),this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}}))}))},t.prototype.map=function(t){var e=this,n=this;return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().map((function(e){return a.tidy((function(){return t(e)}))}))]}}))}))}),this.size)},t.prototype.mapAsync=function(t){var e=this,n=this;return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().mapAsync(t)]}}))}))}),this.size)},t.prototype.prefetch=function(t){var e=this;if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().prefetch(t)]}}))}))}),this.size)},t.prototype.repeat=function(t){var e=this,n=this;return ht((function(){return u(e,void 0,void 0,(function(){var e,r=this;return c(this,(function(i){return e=H((function(){return u(r,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return t={},[4,n.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}}))}))})),[2,(a=e.take(t),new ot(a,undefined))];var a}))}))}),null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,n=this;return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().skip(t)]}}))}))}),null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,e,n){var r=this;if(void 0===n&&(n=!0),null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var i=this,o=D.alea(e||a.util.now().toString());return ht((function(){return u(r,void 0,void 0,(function(){var e;return c(this,(function(r){switch(r.label){case 0:return e=o.int32(),n&&(e+=o.int32()),[4,i.iterator()];case 1:return[2,r.sent().shuffle(t,e.toString())]}}))}))}),this.size)},t.prototype.take=function(t){var e=this,n=this;return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().take(t)]}}))}))}),null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}}))}))},t.prototype.toArrayForTest=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}}))}))},t}();function ht(t,e){return void 0===e&&(e=null),new(function(n){function r(){var t=n.apply(this,function(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}(arguments),!1))||this;return t.size=e,t}return s(r,n),r.prototype.iterator=function(){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,t()]}))}))},r}(lt))}function pt(t){return null===t?null:function(t){return null==t||null===(e=t)||"object"!=typeof e&&"function"!=typeof e||Array.isArray(t)||"object"==typeof t&&t instanceof a.Tensor||a.util.isTypedArray(t);var e}(t[0])?{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof a.Tensor?a.stack(t):a.tensor(t)}(t),recurse:!1}:{value:null,recurse:!0}}lt.MAX_BUFFER_SIZE=1e4;var ft=function(t){function e(e){var n=t.call(this)||this;return n.input=e,n}return s(e,t),e.prototype.iterator=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return[4,this.input.iterator()];case 1:return t=e.sent(),[2,t.decodeUTF8().split("\n").map((function(t){return t.endsWith("\r")&&(t=t.slice(0,-1)),t}))]}}))}))},e}(lt),dt='"',mt=Symbol("out"),gt=Symbol("field"),vt=Symbol("quote"),yt=Symbol("quoteafterquote"),bt=Symbol("quoteinquote"),xt=function(t){function e(e,n){var r=t.call(this)||this;return r.input=e,r.hasHeader=!0,r.fullColumnNames=null,r.columnNamesValidated=!1,r.columnConfigs=null,r.configuredColumnsOnly=!1,r.delimiter=",",r.delimWhitespace=!1,r.base=new ft(e),n||(n={}),r.hasHeader=!1!==n.hasHeader,r.fullColumnNames=n.columnNames,r.columnConfigs=n.columnConfigs,r.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(i.util.assert(null==n.delimiter,(function(){return"Delimiter should not be provided when delimWhitespace is true."})),r.delimWhitespace=!0,r.delimiter=" "):r.delimiter=n.delimiter?n.delimiter:",",r}return s(e,t),e.prototype.columnNames=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}}))}))},e.prototype.setColumnNames=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,a,o,s,u,h=this;return c(this,(function(c){switch(c.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=c.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&i.util.assert(t.length===this.fullColumnNames.length,(function(){return"The length of provided columnNames ("+h.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."})),this.fullColumnNames||(this.fullColumnNames=t),e=this.fullColumnNames.reduce((function(t,e){return t[e]=t[e]+1||1,t}),{}),n=Object.keys(e).filter((function(t){return e[t]>1})),i.util.assert(0===n.length,(function(){return"Duplicate column names found: "+n.toString()})),this.columnConfigs)try{for(r=l(Object.keys(this.columnConfigs)),a=r.next();!a.done;a=r.next())if(o=a.value,-1===this.fullColumnNames.indexOf(o))throw new Error('The key "'+o+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}catch(t){s={error:t}}finally{try{a&&!a.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}return this.columnNamesValidated=!0,[2]}}))}))},e.prototype.maybeReadHeaderLine=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,n.sent().next()];case 2:if((t=n.sent()).done)throw new Error("No data was found for CSV parsing.");return e=t.value,[2,this.parseRow(e,!1)];case 3:return[2,null]}}))}))},e.prototype.iterator=function(){return u(this,void 0,void 0,(function(){var t,e=this;return c(this,(function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[4,this.base.iterator()];case 3:return t=n.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map((function(t){return e.makeDataElement(t)}))]}}))}))},e.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),n={},r={},i=0;i<this.fullColumnNames.length;i++){var a=this.fullColumnNames[i],o=this.columnConfigs?this.columnConfigs[a]:null;if(!this.configuredColumnsOnly||o){var s=e[i],u=null;if(""===s)if(o&&void 0!==o.default)u=o.default;else{if(o&&(o.required||o.isLabel))throw new Error("Required column ".concat(a," is empty in this line: ").concat(t));u=void 0}else{var c=Number(s);if(isNaN(c))u=o&&"bool"===o.dtype?this.getBoolean(s):s;else if(o&&o.dtype)switch(o.dtype){case"float32":default:u=c;break;case"int32":u=Math.floor(c);break;case"bool":u=this.getBoolean(s)}else u=c}o&&o.isLabel?r[a]=u:n[a]=u}}return 0===Object.keys(r).length?n:{xs:n,ys:r}},e.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},e.prototype.parseRow=function(t,e){void 0===e&&(e=!0);for(var n=[],r=0,i=t.length,a=mt,o=0;o<i;o++)switch(a){case mt:switch(t.charAt(o)){case dt:r=o+1,a=vt;break;case this.delimiter:if(r=o+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),a=mt;break;default:a=gt,r=o}break;case gt:t.charAt(o)===this.delimiter&&(n.push(t.substring(r,o)),a=mt,r=o+1);break;case vt:t.charAt(o)===dt&&(a=yt);break;case yt:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(r,o-1)),a=mt,r=o+1;break;case dt:a=vt;break;default:a=bt}break;case bt:t.charAt(o)===dt&&(a=vt)}if(a===yt?n.push(t.substring(r,i-1)):n.push(t.substring(r)),e&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have ".concat(this.fullColumnNames.length," elements in a row, but got ").concat(n));return n},e}(lt),wt=function(t){function e(e){var n=t.call(this)||this;n.microphoneConfig=e,n.isClosed=!1,n.fftSize=e.fftSize||1024;var r=Math.log2(n.fftSize);if(n.fftSize<0||r<4||r>14||!Number.isInteger(r))throw new Error("Invalid fftSize: it must be a power of 2 between "+"2 to 4 and 2 to 14, but got ".concat(n.fftSize));if(n.numFrames=e.numFramesPerSpectrogram||43,n.sampleRateHz=e.sampleRateHz,n.columnTruncateLength=e.columnTruncateLength||n.fftSize,n.audioTrackConstraints=e.audioTrackConstraints,n.smoothingTimeConstant=e.smoothingTimeConstant||0,n.includeSpectrogram=!1!==e.includeSpectrogram,n.includeWaveform=!0===e.includeWaveform,!n.includeSpectrogram&&!n.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return n}return s(e,t),e.prototype.summary=function(){return"microphone"},e.create=function(t){return void 0===t&&(t={}),u(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:if(!i.env().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");return[4,(n=new e(t)).start()];case 1:return r.sent(),[2,n]}}))}))},e.prototype.start=function(){return u(this,void 0,void 0,(function(){var t,e,n,r;return c(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})];case 1:return t.stream=i.sent(),[3,3];case 2:throw e=i.sent(),new Error("Error thrown while initializing video stream: ".concat(e.message));case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(n=window.AudioContext||window.webkitAudioContext,this.audioContext=new n,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: "+"Expected: ".concat(this.sampleRateHz,"; ")+"Actual: ".concat(this.audioContext.sampleRate))}else this.sampleRateHz=this.audioContext.sampleRate;return r=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,r.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}}))}))},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i;return c(this,(function(a){switch(a.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return n=a.sent(),this.includeSpectrogram&&(r=this.flattenQueue(n.freqDataQueue),t=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(i=this.flattenQueue(n.timeDataQueue),e=this.getTensorFromAudioDataArray(i,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:e},done:!1}]}}))}))},e.prototype.capture=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.getAudioData=function(){return u(this,void 0,void 0,(function(){var t,e,n,r=this;return c(this,(function(i){return t=[],e=[],n=0,[2,new Promise((function(i){var a=setInterval((function(){r.includeSpectrogram&&(r.analyser.getFloatFrequencyData(r.freqData),r.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(r.freqData.slice(0,r.columnTruncateLength))),r.includeWaveform&&(r.analyser.getFloatTimeDomainData(r.timeData),e.push(r.timeData.slice())),++n===r.numFrames&&(clearInterval(a),i({freqDataQueue:t,timeDataQueue:e}))}),r.fftSize/r.sampleRateHz*1e3)}))]}))}))},e.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},e.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var e=t[0].length,n=new Float32Array(t.length*e);return t.forEach((function(t,r){return n.set(t,r*e)})),n},e.prototype.getTensorFromAudioDataArray=function(t,e){var n=new Float32Array(i.util.sizeFromShape(e));return n.set(t,n.length-t.length),i.tensor(n,e)},e}(q),_t=function(t){function e(e,n){var r=t.call(this)||this;if(r.webcamVideoElement=e,r.webcamConfig=n,r.isClosed=!0,r.resize=!1,r.needToResize())if(r.resize=!0,r.cropSize=[r.webcamConfig.resizeHeight,r.webcamConfig.resizeWidth],r.cropBoxInd=i.tensor1d([0],"int32"),r.webcamConfig.centerCrop){var a=1*r.webcamConfig.resizeWidth/r.webcamVideoElement.width,o=1*r.webcamConfig.resizeHeight/r.webcamVideoElement.height,s=(1-a)/2,u=(1-o)/2,c=s+a,l=o+u;r.cropBox=i.tensor2d([u,s,l,c],[1,4])}else r.cropBox=i.tensor2d([0,0,1,1],[1,4]);return r}return s(e,t),e.prototype.summary=function(){return"webcam"},e.create=function(t,n){return void 0===n&&(n={}),u(this,void 0,void 0,(function(){var r;return c(this,(function(a){switch(a.label){case 0:if(!i.env().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}return[4,(r=new e(t,n)).start()];case 1:return a.sent(),[2,r]}}))}))},e.prototype.start=function(){return u(this,void 0,void 0,(function(){var t,e,n=this;return c(this,(function(r){switch(r.label){case 0:this.webcamConfig.facingMode&&i.util.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,(function(){return"Invalid webcam facing mode: ".concat(n.webcamConfig.facingMode,". ")+"Please provide 'user' or 'environment'"})),r.label=1;case 1:return r.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=r.sent(),[3,4];case 3:throw(e=r.sent()).message="Error thrown while initializing video stream: ".concat(e.message),e;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise((function(t){n.webcamVideoElement.onloadedmetadata=function(){t()}}))]}}))}))},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){if(this.isClosed)return[2,{value:null,done:!0}];try{t=i.browser.fromPixels(this.webcamVideoElement)}catch(t){throw new Error("Error thrown converting video to pixels: ".concat(JSON.stringify(t)))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(t){throw new Error("Error thrown cropping the video: ".concat(t.message))}finally{t.dispose()}return[2]}))}))},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var e=this;return i.tidy((function(){var n,r=i.expandDims(i.cast(t,"float32"),0),a=(n=i.image.cropAndResize(r,e.cropBox,e.cropBoxInd,e.cropSize,"bilinear")).shape;return i.reshape(n,a.slice(1))}))},e.prototype.capture=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.stop=function(){this.stream.getTracks().forEach((function(t){return t.stop()}));try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},e}(q),St=function(){},Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.split=function(t){return new Et(this,t)},e}(q),Et=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.impl=new kt(e,n),r}return s(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this.impl.next()]}))}))},e}(Tt),kt=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.separator=n,r.carryover="",r}return s(e,t),e.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")},e.prototype.pump=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,a,o;return c(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((t=s.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);(e=t.value.split(this.separator))[0]=this.carryover+e[0];try{for(n=l(e.slice(0,-1)),r=n.next();!r.done;r=n.next())i=r.value,this.outputQueue.push(i)}catch(t){a={error:t}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}}return this.carryover=e[e.length-1],[2,!0]}}))}))},e}(it),It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.decodeUTF8=function(){return new At(this)},e}(q),At=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.impl=new Nt(e),n}return s(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this.impl.next()]}))}))},e}(Tt),Nt=function(e){function n(n){var r=e.call(this)||this;if(r.upstream=n,i.env().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var a=t("string_decoder").StringDecoder;r.decoder=new a("utf8")}return r}return s(n,e),n.prototype.summary=function(){return"".concat(this.upstream.summary()," -> Utf8")},n.prototype.pump=function(){return u(this,void 0,void 0,(function(){var t,e,n;return c(this,(function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(t=a.sent()).done?[2,!1]:(e=t.value,n=i.env().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(r.from(e.buffer)),this.outputQueue.push(n),[2,!0])}}))}))},n}(it),Ct=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.file=e,r.options=n,i.util.assert(e instanceof Uint8Array||!!i.env().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),(function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."})),r.offset=n.offset||0,r.chunkSize=n.chunkSize||1048576,r}return s(e,t),e.prototype.summary=function(){return"FileChunks ".concat(this.file)},e.prototype.next=function(){return u(this,void 0,void 0,(function(){var t,e,n=this;return c(this,(function(r){switch(r.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise((function(t,e){var r=n.offset+n.chunkSize;if(n.file instanceof Uint8Array)t(new Uint8Array(n.file.slice(n.offset,r)));else{var i=new FileReader;i.onload=function(n){var r=i.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(r)},i.onabort=function(t){return e(new Error("Aborted"))},i.onerror=function(t){return e(new Error(t.type))};var a=n.file.slice(n.offset,r);i.readAsArrayBuffer(a)}n.offset=r})),e={},[4,t]);case 1:return[2,(e.value=r.sent(),e.done=!1,e)]}}))}))},e}(It);function Rt(t,e,n){return void 0===e&&(e={}),u(this,void 0,void 0,(function(){var r,a,o,s,u;return c(this,(function(c){switch(c.label){case 0:return"string"==typeof t?r=t:(r=t.url,a=Ot(t)),[4,(n||i.util.fetch)(r,a)];case 1:return(o=c.sent()).ok?(u=Uint8Array.bind,[4,o.arrayBuffer()]):[3,3];case 2:return s=new(u.apply(Uint8Array,[void 0,c.sent()])),[2,new Ct(s,e)];case 3:throw new Error(o.statusText)}}))}))}var Ot=function(t){return{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity}};function Dt(t){return"string"==typeof t&&"file://"===t.slice(0,7)}var Mt=function(e){function n(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.input=t,r.options=n,r}return s(n,e),n.prototype.iterator=function(){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){return Dt(this.input)&&i.env().get("IS_NODE")&&(e=t("fs"),this.input=e.readFileSync(this.input.slice(7))),[2,new Ct(this.input,this.options)]}))}))},n}(St),Ft=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.url=e,r.fileOptions=n,r}return s(e,t),e.prototype.iterator=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return Dt(this.url)?[2,new Mt(this.url,this.fileOptions).iterator()]:[2,Rt(this.url,this.fileOptions)]}))}))},e}(St);n.CSVDataset=xt,n.Dataset=lt,n.FileDataSource=Mt,n.TextLineDataset=ft,n.URLDataSource=Ft,n.array=function(t){var e=this;return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){return[2,j(t)]}))}))}),t.length)},n.csv=function(t,e){return void 0===e&&(e={}),new xt(new Ft(t),e)},n.func=function(t){var e=this,n=H(t);return ht((function(){return u(e,void 0,void 0,(function(){return c(this,(function(t){return[2,n]}))}))}))},n.generator=function(t){var e=this;return ht((function(){return u(e,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return e=n.sent(),[2,H((function(){return e.next()}))]}}))}))}))},n.microphone=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,wt.create(t)]}))}))},n.version_data="4.17.0",n.webcam=function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){return[2,_t.create(t,e)]}))}))},n.zip=function(t){var e,n=this;if(!z(t))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(t))for(var r=0;r<t.length;r++)e=null==e?t[r].size:Math.min(e,t[r].size);else if(t instanceof Object)for(var i in t)e=null==e?t[i].size:Math.min(e,t[i].size);return ht((function(){return u(n,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,B(t,(function(t){if(t instanceof lt)return{value:t.iterator(),recurse:!1};if(z(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}))];case 1:return[2,(n=e.sent(),r=X.SHORTEST,void 0===r&&(r=X.FAIL),new st(n,r))]}var n,r}))}))}),e)}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"@tensorflow/tfjs-core":7,buffer:13,fs:12,string_decoder:12}],9:[function(t,e,n){(function(e,r,i,a,o,s,u,c){(function(){"use strict";var a=t("@tensorflow/tfjs-core");var o=function(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,e}(a),s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},s(t,e)};function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function l(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function h(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function f(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var d=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return u(e,t),e}(Error),m=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return u(e,t),e}(Error),g=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return u(e,t),e}(Error),v=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return u(e,t),e}(Error),y=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return u(e,t),e}(Error);!function(t){u((function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}),t)}(Error);var b=function(){function t(t){this.maxEntries=t||100,this.cache=new Map}return t.prototype.get=function(t){var e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e},t.prototype.put=function(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,e)},t.prototype.getMaxEntries=function(){return this.maxEntries},t.prototype.setMaxEntries=function(t){if(t<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(t,"."));if(this.maxEntries>t)for(var e=0;e<this.maxEntries-t;e++){var n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=t},t}();function x(t,e){if(Array.isArray(t)){for(var n=[],r=0;r<e;r++)n=n.concat(t);return n}return(n=new Array(e)).fill(t),n}function w(t,e){if(!t)throw new y(e)}function _(t,e){var n,r,i=0;try{for(var a=h(t),o=a.next();!o.done;o=a.next())o.value===e&&i++}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function S(t){return 1===t.length?t[0]:t}function T(t){return Array.isArray(t)?t:[t]}function E(t){var e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function k(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(function(t,e){return e.toUpperCase()}))}var I={};function A(t){if(null==t)return null;var e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function N(t){var e,n;if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach((function(t){return N(t)}));else{var r=Object.keys(t);try{for(var i=h(r),a=i.next();!a.done;a=i.next()){var o=a.value,s=t[o];null!=s&&"object"==typeof s&&(Array.isArray(s)||"ndarray"!==s.type||"number"!=typeof s.value?N(s):t[o]=s.value)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}}function C(t,e,n,r,i){var a,o,s,u,c,l,f,d,m,v,y;if(void 0===e&&(e={}),void 0===n&&(n={}),void 0===r&&(r="object"),void 0===i&&(i=!1),"string"==typeof t){var b=t,x=void 0;if(b in n)x=n[b];else if(b in I)x=I[b];else if(null==(x=e[b]))throw new g("Unknown ".concat(r,": ").concat(t,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return x}var w=t;if(null==w.className||null==w.config)throw new g("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(w),".\n")+"'className' and 'config' must set.");var _=w.className,S=void 0,T=void 0;if(_ in n?(S=(a=p(n[_],2))[0],T=a[1]):_ in I?(S=(o=p(I.className,2))[0],T=o[1]):_ in e&&(S=(s=p(e[_],2))[0],T=s[1]),null==S)throw new g("Unknown ".concat(r,": ").concat(_,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=T){var E={};try{for(var k=h(Object.keys(I)),A=k.next();!A.done;A=k.next())E[F=A.value]=I[F]}catch(t){u={error:t}}finally{try{A&&!A.done&&(c=k.return)&&c.call(k)}finally{if(u)throw u.error}}try{for(var C=h(Object.keys(n)),R=C.next();!R.done;R=C.next())E[F=R.value]=n[F]}catch(t){l={error:t}}finally{try{R&&!R.done&&(f=C.return)&&f.call(C)}finally{if(l)throw l.error}}w.config.customObjects=E;var O=Object.assign({},I);try{for(var D=h(Object.keys(n)),M=D.next();!M.done;M=D.next()){var F=M.value;I[F]=n[F]}}catch(t){d={error:t}}finally{try{M&&!M.done&&(m=D.return)&&m.call(D)}finally{if(d)throw d.error}}N(w.config);var P=T(S,w.config,n,i);return I=Object.assign({},O),P}O=Object.assign({},I);try{for(var L=h(Object.keys(n)),B=L.next();!B.done;B=L.next())F=B.value,I[F]=n[F]}catch(t){v={error:t}}finally{try{B&&!B.done&&(y=L.return)&&y.call(L)}finally{if(v)throw v.error}}return P=new S(w.config),I=Object.assign({},O),P}function R(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function O(t){var e,n;if(null==t)return t;var r=[];try{for(var i=h(t),a=i.next();!a.done;a=i.next()){var o=a.value;-1===r.indexOf(o)&&r.push(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function D(t){if(null==t)throw new g("Invalid value in obj: ".concat(JSON.stringify(t)));for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function M(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new g("".concat(n," is not a valid ").concat(e,".  Valid values are ").concat(t," or null/undefined."))}function F(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=1/0),w(n>=0),w(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((function(t){return typeof t===e}))}function P(t,e){Array.isArray(t)?(a.util.assert(t.length>0,(function(){return"".concat(e," is unexpectedly an empty array.")})),t.forEach((function(t,n){return P(t,"element ".concat(n+1," of ").concat(e))}))):a.util.assert(Number.isInteger(t)&&t>0,(function(){return"Expected ".concat(e," to be a positive integer, but got ")+"".concat(L(t),".")}))}function L(t){return null===t?"null":Array.isArray(t)?"["+t.map((function(t){return L(t)})).join(",")+"]":"string"==typeof t?'"'.concat(t,'"'):"".concat(t)}function B(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}var z=0;function U(){return z++}var G={};function W(t){return void 0===t&&(t=""),t in G||(G[t]=0),G[t]+=1,t+G[t].toString()}var V=["channelsFirst","channelsLast"],j=["nearest","bilinear"],H=["valid","same","causal"],X=["max","avg"],q=["sum","mul","concat","ave"],K=new Map;function Y(t){M(V,"DataFormat",t)}function Z(t){M(H,"PaddingMode",t)}function $(t){M(X,"PoolMode",t)}var J=[];function Q(t,e){J.push(t);try{var n=e();return J.pop(),n}catch(t){throw J.pop(),t}}function tt(t){if(!it(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===J.length?"":J.join("/")+"/")+t}function et(t){if(!it(t))throw new Error("Not a valid tensor name: '"+t+"'");K.has(t)||K.set(t,0);var e=K.get(t);if(K.set(t,K.get(t)+1),e>0){var n="".concat(t,"_").concat(e);return K.set(n,1),n}return t}var nt,rt=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function it(t){return!!t.match(rt)}function at(t,e,n){null==e&&(e=0),null==n&&(n=t.length);for(var r=1,i=e;i<n;++i)r*=t[i];return r}function ot(t){if(0===t.length)return Number.NaN;for(var e=Number.POSITIVE_INFINITY,n=0;n<t.length;n++){var r=t[n];r<e&&(e=r)}return e}function st(t){if(0===t.length)return Number.NaN;for(var e=Number.NEGATIVE_INFINITY,n=0;n<t.length;n++){var r=t[n];r>e&&(e=r)}return e}function ut(t,e){if(e<t)throw new g("end (".concat(e,") < begin (").concat(t,") is forbidden."));for(var n=[],r=t;r<e;++r)n.push(r);return n}function ct(){return null==nt&&(nt=a.backend().epsilon()),nt}function lt(t,e){return o.cast(t,e)}function ht(t,e){void 0===e&&(e=-1);var n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),o.reshape(t,n)}function pt(t,e,n){return a.tidy((function(){switch(t.rank){case 1:return o.slice1d(t,e,n);case 2:return o.slice2d(t,[e,0],[n,t.shape[1]]);case 3:return o.slice3d(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return o.slice4d(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return o.slice(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return o.slice(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new g("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function ft(t,e,n){return a.tidy((function(){switch(t.rank){case 1:return o.slice1d(t,e,n);case 2:return o.slice2d(t,[0,e],[t.shape[0],n]);case 3:return o.slice3d(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return o.slice4d(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new g("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function dt(t,e,n,r){return a.tidy((function(){switch(t.rank){case 1:return o.slice1d(t,e,n);case 2:switch(r){case 1:return pt(t,e,n);case 2:return ft(t,e,n);default:throw new g("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return pt(t,e,n);case 2:return o.slice3d(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return ft(t,e,n);default:throw new g("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return pt(t,e,n);case 2:return o.slice4d(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return o.slice4d(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return ft(t,e,n);default:throw new g("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new g("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function mt(t,e){var n;return void 0===e&&(e=-1),e<0&&(e=0!==(n=t[0].rank)?n:0),e===t[0].rank&&(e=-1),o.concat(t,e)}function gt(t,e){switch(t.rank){case 1:return o.concat1d([t,e]);case 2:return o.concat2d([t,e],0);case 3:return o.concat3d([t,e],0);case 4:return o.concat4d([t,e],0);default:throw new g("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(t.rank))}}function vt(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new g("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(t.rank,")"));return o.tile(t,e)}function yt(t,e,n,r,i){return void 0===e&&(e=0),void 0===n&&(n=1),o.randomNormal(t,e,n,r,i)}function bt(t,e,n,r){if(t.rank<2||e.rank<2)throw new v("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(t.shape," and y shape = ").concat(e.shape));if(e.rank>=3&&t.shape.slice(-1)[0]!==(h=e.shape.slice(-2)[0]))throw new v("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(t.shape," and ")+" y shape = ".concat(e.shape));if(2===t.rank&&2===e.rank){var i=!1,a=!1;return o.fused.matMul({a:t,b:e,transposeA:i,transposeB:a,bias:r?_t(t.rank,r,"channelsLast"):null,activation:n})}var s=t.shape.slice(),u=s.pop();t=o.reshape(t,[-1,u]);var c=e.shape.slice(),l=c.pop(),h=c.pop(),d=f(f([],p(c),!1),[l],!1),m=Array.from({length:e.rank},(function(t,n){return 0===n?e.rank-2:n<=e.rank-2?n-1:n}));e=o.reshape(o.transpose(e,m),[h,-1]);var g=f(f([],p(s),!1),p(d),!1);return i=!1,a=!1,o.reshape(o.fused.matMul({a:t,b:e,transposeA:i,transposeB:a,bias:r?_t(t.rank,r,"channelsLast"):null,activation:n}),g)}function xt(t,e,n){return a.tidy((function(){return e=Array.isArray(e)?a.tensor1d(e,"int32"):o.cast(e,"int32"),o.gather(t,e,n)}))}function wt(t){return o.mul(t,t)}function _t(t,e,n){var r=e.shape;if(1!==e.rank&&e.rank!==t)throw new g("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(t));if(5===t){if("channelsFirst"===n)return 1===r.length?o.reshape(e,[1,r[0],1,1,1]):o.reshape(e,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?o.reshape(e,[1,1,1,1,r[0]]):o.reshape(e,[1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?o.reshape(e,[1,r[0],1,1]):o.reshape(e,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?o.reshape(e,[1,1,1,r[0]]):o.reshape(e,[1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?o.reshape(e,[1,r[0],1]):o.reshape(e,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?o.reshape(e,[1,1,r[0]]):o.reshape(e,[1].concat(r))}else if(t<3)return e;throw new g("Unsupported input rank by biasAdd: ".concat(e.rank))}function St(t,e,n){return a.tidy((function(){return null==n&&(n="channelsLast"),Y(n),o.add(t,_t(t.rank,e,n))}))}function Tt(t,e,n,r){return a.tidy((function(){return o.dropout(t,e,n,r)}))}function Et(t,e,n){return void 0===n&&(n=!1),n?t():e()}var kt=["fanIn","fanOut","fanAvg"],It=["normal","uniform","truncatedNormal"],At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},e}(a.serialization.Serializable),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){return a.zeros(t,e)},e}(At);Nt.className="Zeros",a.serialization.registerClass(Nt);var Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){return a.ones(t,e)},e}(At);Ct.className="Ones",a.serialization.registerClass(Ct);var Rt=function(t){function e(e){var n=t.call(this)||this;if("object"!=typeof e)throw new g("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new g("config must have value set but got ".concat(e));return n.value=e.value,n}return u(e,t),e.prototype.apply=function(t,e){var n=this;return a.tidy((function(){return a.mul(a.scalar(n.value),a.ones(t,e))}))},e.prototype.getConfig=function(){return{value:this.value}},e}(At);Rt.className="Constant",a.serialization.registerClass(Rt);var Ot=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=e.minval||n.DEFAULT_MINVAL,n.maxval=e.maxval||n.DEFAULT_MAXVAL,n.seed=e.seed,n}return u(e,t),e.prototype.apply=function(t,e){return a.randomUniform(t,this.minval,this.maxval,e,this.seed)},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e}(At);Ot.className="RandomUniform",a.serialization.registerClass(Ot);var Dt=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return u(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new v("randomNormal does not support dType ".concat(e,"."));return yt(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e}(At);Dt.className="RandomNormal",a.serialization.registerClass(Dt);var Mt=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return u(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new v("truncatedNormal does not support dType ".concat(e,"."));return a.truncatedNormal(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e}(At);Mt.className="TruncatedNormal",a.serialization.registerClass(Mt);var Ft=function(t){function e(e){var n=t.call(this)||this;return n.gain=null!=e.gain?e.gain:1,n}return u(e,t),e.prototype.apply=function(t,e){var n=this;return a.tidy((function(){if(2!==t.length||t[0]!==t[1])throw new g("Identity matrix initializer can only be used for 2D square matrices.");return a.mul(n.gain,a.eye(t[0]))}))},e.prototype.getConfig=function(){return{gain:this.gain}},e}(At);Ft.className="Identity",a.serialization.registerClass(Ft);var Pt=function(t){function e(e){var n,r=t.call(this)||this;if(e.scale<0)throw new g("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,n=r.mode,M(kt,"FanMode",n),r.distribution=null==e.distribution?"normal":e.distribution,function(t){M(It,"Distribution",t)}(r.distribution),r.seed=e.seed,r}return u(e,t),e.prototype.apply=function(t,e){var n=function(t,e){var n,r;if(void 0===e&&(e="channelsLast"),Y(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length))if("channelsFirst"===e){var i=at(t,2);n=t[1]*i,r=t[0]*i}else"channelsLast"===e&&(i=at(t,0,t.length-2),n=t[t.length-2]*i,r=t[t.length-1]*i);else{var a=at(t);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}(t),r=n[0],i=n[1],o=this.scale;if("fanIn"===this.mode?o/=Math.max(1,r):"fanOut"===this.mode?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),"normal"===this.distribution){var s=Math.sqrt(o);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new v("".concat(this.getClassName()," does not support dType ").concat(e,"."));return a.truncatedNormal(t,0,s,e,this.seed)}var u=Math.sqrt(3*o);return a.randomUniform(t,-u,u,e,this.seed)},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e}(At);Pt.className="VarianceScaling",a.serialization.registerClass(Pt);var Lt=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})||this}return u(e,t),e.prototype.getClassName=function(){return Pt.className},e}(Pt);Lt.className="GlorotUniform",a.serialization.registerClass(Lt);var Bt=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})||this}return u(e,t),e.prototype.getClassName=function(){return Pt.className},e}(Pt);Bt.className="GlorotNormal",a.serialization.registerClass(Bt);var zt=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return u(e,t),e.prototype.getClassName=function(){return Pt.className},e}(Pt);zt.className="HeNormal",a.serialization.registerClass(zt);var Ut=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return u(e,t),e.prototype.getClassName=function(){return Pt.className},e}(Pt);Ut.className="HeUniform",a.serialization.registerClass(Ut);var Gt=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return u(e,t),e.prototype.getClassName=function(){return Pt.className},e}(Pt);Gt.className="LeCunNormal",a.serialization.registerClass(Gt);var Wt=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return u(e,t),e.prototype.getClassName=function(){return Pt.className},e}(Pt);Wt.className="LeCunUniform",a.serialization.registerClass(Wt);var Vt=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_GAIN=1,n.ELEMENTS_WARN_SLOW=2e3,n.gain=null==e.gain?n.DEFAULT_GAIN:e.gain,n.seed=e.seed,n}return u(e,t),e.prototype.apply=function(t,e){var n=this;return a.tidy((function(){if(t.length<2)throw new v("Shape must be at least 2D.");if("int32"!==e&&"float32"!==e&&void 0!==e)throw new TypeError("Unsupported data type ".concat(e,"."));var r=a.util.sizeFromShape(t.slice(0,-1)),i=t[t.length-1],o=r*i;o>n.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(n.ELEMENTS_WARN_SLOW," (").concat(o,") elements: ")+"Slowness may result.");var s=yt([Math.max(i,r),Math.min(i,r)],0,1,e,n.seed),u=a.linalg.qr(s,!1),c=u[0],l=u[1].flatten().stridedSlice([0],[Math.min(i,r)*Math.min(i,r)],[Math.min(i,r)+1]);return c=a.mul(c,l.sign()),r<i&&(c=c.transpose()),a.mul(a.scalar(n.gain),c.reshape(t))}))},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e}(At);Vt.className="Orthogonal",a.serialization.registerClass(Vt);var jt={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Ht(t,e){return void 0===e&&(e={}),C(t,a.serialization.SerializationMap.getMap().classNameMap,e,"initializer")}function Xt(t){return A(t)}function qt(t){if("string"==typeof t){var e=t in jt?jt[t]:t;if("GlorotNormal"===e)return new Bt;if("GlorotUniform"===e)return new Lt;if("HeNormal"===e)return new zt;if("HeUniform"===e)return new Ut;if("LeCunNormal"===e)return new Gt;if("LeCunUniform"===e)return new Wt;var n={};return n.className=e,n.config={},Ht(n)}return t instanceof At?t:Ht(t)}function Kt(t){return Array.isArray(t)&&Array.isArray(t[0])}function Yt(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function Zt(t){var e;if(Array.isArray(t)){if(1!==t.length)throw new g("Expected Tensor length to be 1; got ".concat(t.length));e=t[0]}else e=t;return e}function $t(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new g("Expected exactly 1 Shape; got ".concat(t.length))}return t}function Jt(t){var e,n,r=0;try{for(var i=h(t),a=i.next();!a.done;a=i.next()){var o=a.value;0===o.shape.length?r+=1:r+=o.shape.reduce((function(t,e){return t*e}))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}var Qt="Variable",te=function(){function t(t,e,n,r,i){void 0===e&&(e="float32"),void 0===n&&(n=Qt),void 0===r&&(r=!0),void 0===i&&(i=null),this.dtype=e??"float32",this.shape=t.shape,this.id=U(),n=n??Qt,this.originalName=tt(n),this.name=et(this.originalName),this.trainable_=r,this.constraint=i,this.val=o.variable(t,this.trainable_,this.name,this.dtype)}return t.prototype.read=function(){return this.assertNotDisposed(),this.val},t.prototype.write=function(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this},t.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},t.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!1,configurable:!0}),t}();function ee(t){return t.map((function(t){return t.read()}))}function ne(t){t.forEach((function(t){t[0].write(t[1])}))}var re=function(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},ie=function(t,e,n,r,i,a,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=U(),null!=a&&(this.originalName=tt(a),this.name=et(this.originalName)),this.rank=e.length},ae=0,oe=function(){function t(t,e){var n,r;this.callArgs=e,this.id=ae++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;try{for(var i=h(t.inboundLayers),a=i.next();!a.done;a=i.next()){var o=a.value;null!=o&&o.outboundNodes.push(this)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.outboundLayer.inboundNodes.push(this)}return t.prototype.getConfig=function(){var t,e,n=[];try{for(var r=h(this.inboundLayers),i=r.next();!i.done;i=r.next()){var a=i.value;null!=a?n.push(a.name):n.push(null)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:n,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},t}(),se=0,ue=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=se++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var r=e.name;if(!r){var i=n.getClassName();r=E(i)+"_"+W(i)}if(n.name=r,n.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){var a=void 0;if(null!=e.batchInputShape)a=e.batchInputShape;else if(null!=e.inputShape){var o=null;null!=e.batchSize&&(o=e.batchSize),a=[o].concat(e.inputShape)}n.batchInputShape=a;var s=e.dtype;null==s&&(s=e.inputDType),null==s&&(s="float32"),n.dtype=s}return null!=e.weights?n.initialWeights=e.weights:n.initialWeights=null,n._refCount=null,n.fastWeightInitDuringBuild=!1,n}return u(e,t),e.nodeKey=function(t,e){return t.name+"_ib-"+e.toString()},e.prototype.getNodeAtIndex=function(t,e){if(0===this.inboundNodes.length)throw new m("The layer has never been called "+"and thus has no defined ".concat(e,"."));if(this.inboundNodes.length<=t)throw new g("Asked to get ".concat(e," at node ").concat(t,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[t]},e.prototype.getInputAt=function(t){return S(this.getNodeAtIndex(t,"input").inputTensors)},e.prototype.getOutputAt=function(t){return S(this.getNodeAtIndex(t,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new d("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new d("Layer ".concat(this.name)+" is not connected, no input to return.");return S(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new d("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new d("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return S(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!1,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map((function(t){return t()}))},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(t){this._built=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach((function(e){return e.trainable=t})),this.trainable_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter((function(t){return t.trainable})):[]},set:function(t){this._trainableWeights=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter((function(t){return!t.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!1,configurable:!0}),e.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},e.prototype.assertInputCompatibility=function(t){var e=T(t);if(null!=this.inputSpec&&0!==this.inputSpec.length){var n=T(this.inputSpec);if(e.length!==n.length)throw new g("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(t));for(var r=0;r<e.length;r++){var i=e[r],a=n[r];if(null!=a){var o=i.rank;if(null!=a.ndim&&o!==a.ndim)throw new g("Input ".concat(r," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(o));if(null!=a.maxNDim&&o>a.maxNDim)throw new g("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(o));if(null!=a.minNDim&&o<a.minNDim)throw new g("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(o,"."));if(null!=a.dtype&&i.dtype!==a.dtype)throw new g("Input ".concat(r," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(i.dtype,"."));if(a.axes){var s=i.shape;for(var u in a.axes){var c=Number(u),l=a.axes[u],h=c>=0?s[c]:s[s.length+c];if(null!=l&&-1===[l,null].indexOf(h))throw new g("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(c," of input shape to ")+"have value ".concat(l," but got shape ").concat(s,"."))}}if(null!=a.shape)for(var p=0;p<a.shape.length;++p){var f=a.shape[p],d=i.shape[p];if(null!=f&&null!=d&&f!==d)throw new g("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(i.shape,"."))}}}}},e.prototype.call=function(t,e){return t},e.prototype.invokeCallHook=function(t,e){null!=this._callHook&&this._callHook(t,e)},e.prototype.setCallHook=function(t){this._callHook=t},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(t,e){var n=this;e=e||{},this.assertNotDisposed();var r=T(t),i=function(t){var e,n,r=!0;try{for(var i=h(T(t)),a=i.next();!a.done;a=i.next())if(!(a.value instanceof ie)){r=!1;break}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t),a=function(t){var e,n,r=!0;try{for(var i=h(T(t)),a=i.next();!a.done;a=i.next())if(a.value instanceof ie){r=!1;break}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t);if(i===a)throw new g("Arguments to apply() must be all SymbolicTensors or all Tensors");return Q(this.name,(function(){var i,o,s,u;if(!n.built){n.assertInputCompatibility(t);var c=[];try{for(var l=h(T(t)),p=l.next();!p.done;p=l.next()){var f=p.value;c.push(f.shape)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}n.build(S(c)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&a&&(n._refCount=1)}if(n.assertInputCompatibility(t),a){var d=n.call(t,e);n.supportsMasking&&n.setMaskMetadata(t,d);var m=T(d),g=[];try{for(var y=h(m),b=y.next();!b.done;b=y.next()){var x=b.value;-1!==r.indexOf(x)&&(x=x.clone()),g.push(x)}}catch(t){s={error:t}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(s)throw s.error}}if(d=S(g),null!=n.activityRegularizer)throw new v("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return d}var w=function(t){var e,n;t=T(t);var r=[];try{for(var i=h(t),a=i.next();!a.done;a=i.next()){var o=a.value;r.push(o.shape)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return S(r)}(t),_=n.computeOutputShape(w),E=(d=void 0,"float32");if(n.warnOnIncompatibleInputShape(Array.isArray(t)?w[0]:w),d=null!=_&&_.length>0&&Array.isArray(_[0])?_.map((function(r,i){return new ie(E,r,n,T(t),e,n.name,i)})):new ie(E,_,n,T(t),e,n.name),n.addInboundNode(t,d,null,null,w,_,e),n._refCount++,null!=n.activityRegularizer)throw new v("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return d}))},e.prototype.warnOnIncompatibleInputShape=function(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(t),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var e=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(t),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}},Object.defineProperty(e.prototype,"outputShape",{get:function(){var t,e;if(null==this.inboundNodes||0===this.inboundNodes.length)throw new d("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var n=[];try{for(var r=h(this.inboundNodes),i=r.next();!i.done;i=r.next()){var a=i.value,o=JSON.stringify(a.outputShapes);-1===n.indexOf(o)&&n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}if(1===n.length){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&1===s.length?s[0]:s}throw new d("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')},enumerable:!1,configurable:!0}),e.prototype.countParams=function(){if(!this.built)throw new m("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Jt(this.weights)},e.prototype.build=function(t){this.built=!0},e.prototype.getWeights=function(t){return void 0===t&&(t=!1),ee(t?this.trainableWeights:this.weights)},e.prototype.setWeights=function(t){var e=this;a.tidy((function(){var n=e.weights;if(n.length!==t.length)throw new g('You called setWeights(weights) on layer "'.concat(e.name,'" ')+"with a weight list of length ".concat(t.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(t,"..."));if(0!==n.length){for(var r=[],i=ee(n),o=0;o<i.length;++o){var s=i[o],u=n[o],c=t[o];if(!a.util.arraysEqual(s.shape,c.shape))throw new g("Layer weight shape ".concat(s.shape," ")+"not compatible with provided weight shape ".concat(c.shape));r.push([u,c])}ne(r)}}))},e.prototype.addWeight=function(t,e,n,r,i,a,o,s){if(-1!==this._addedWeightNames.indexOf(t))throw new g("Duplicate weight name ".concat(t," for layer ").concat(this.name));this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():qt("zeros"));var u=r.apply(e,n),c=new te(u,n,t,a,o);return u.dispose(),null!=i&&this.addLoss((function(){return i.apply(c.read())})),null==a&&(a=!0),a?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},e.prototype.setFastWeightInitDuringBuild=function(t){this.fastWeightInitDuringBuild=t},e.prototype.addLoss=function(t){var e;null==t||Array.isArray(t)&&0===t.length||(t=T(t),void 0!==this._losses&&null!==this._losses&&(e=this.losses).push.apply(e,f([],p(t),!1)))},e.prototype.computeOutputShape=function(t){return t},e.prototype.computeMask=function(t,e){var n=this;if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");e.forEach((function(t){if(null!=t)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return e},e.prototype.setMaskMetadata=function(t,e,n){if(this.supportsMasking){var r=this.computeMask(t,n),i=T(e),a=T(r);if(i.length!==a.length)throw new Error("".concat(this.name," outputs ").concat(i.length," tensors ")+"but ".concat(i.length," masks for those tensors"));for(var o=0;o<i.length;o++)i[o].kerasMask=a[o]}},e.prototype.addInboundNode=function(t,e,n,r,i,a,o){var s,u;void 0===o&&(o=null);var c=T(t);e=T(e),n=T(n),r=T(r),i=Yt(i),a=Yt(a);var l=[],p=[],f=[];try{for(var d=h(c),m=d.next();!m.done;m=d.next()){var g=m.value;l.push(g.sourceLayer),p.push(g.nodeIndex),f.push(g.tensorIndex)}}catch(t){s={error:t}}finally{try{m&&!m.done&&(u=d.return)&&u.call(d)}finally{if(s)throw s.error}}new oe({outboundLayer:this,inboundLayers:l,nodeIndices:p,tensorIndices:f,inputTensors:c,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},o);for(var v=0;v<e.length;v++)e[v].sourceLayer=this,e[v].nodeIndex=this.inboundNodes.length-1,e[v].tensorIndex=v},e.prototype.getConfig=function(){var t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t},e.prototype.disposeWeights=function(){return this.weights.forEach((function(t){return t.dispose()})),this.weights.length},e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))},e.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}},e}(a.serialization.Serializable);function ce(t,e,n){var r,i;if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];var a=e.inboundNodes[n];if(0===a.inboundLayers.length)return a.inputTensors;for(var o=[],s=0;s<a.inboundLayers.length;s++){var u=ce(a.inputTensors[s],a.inboundLayers[s],a.nodeIndices[s]);try{for(var c=(r=void 0,h(u)),l=c.next();!l.done;l=c.next()){var p=l.value;-1===o.indexOf(p)&&o.push(p)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return o}var le=function(t){function e(e){var n=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:W("input").toString()})||this;if(null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new g("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=e.batchInputShape;if(null==r){if(null==e.inputShape)throw new g("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new g("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";n.batchInputShape=r,n.dtype=i,n.inputSpec=[{shape:r}];var a=new ie(n.dtype,n.batchInputShape,n,[],{},n.name);return a.nodeIndex=0,a.tensorIndex=0,new oe({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return u(e,t),e.prototype.apply=function(t,e){throw new g("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))},e.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},e.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},e}(ue);function he(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new g("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));var n=t.dtype;return null==n&&(n="float32"),new le({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}le.className="InputLayer",a.serialization.registerClass(le);var pe=function(){function t(e){var n,r;if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof t)for(var i in e.id2Value)this.id2Value[i]=e.id2Value[i],i in e.id2Mask&&(this.id2Mask[i]=e.id2Mask[i]);else{if(null==e)return;try{for(var a=h(e),o=a.next();!o.done;o=a.next()){var s=o.value;this.add(s.key,s.value)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}return t.prototype.add=function(t,e,n){if(null!=this.id2Value[t.id])throw new g("Duplicate key: name=".concat(t.name,", id=").concat(t.id));return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return a.cast(e,t.dtype)}catch(n){throw new g("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(t.name,"' (").concat(t.dtype,")."))}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this},t.prototype.addFeed=function(t){this.add(t.key,t.value)},t.prototype.hasKey=function(t){return null!=this.id2Value[t.id]},t.prototype.names=function(){return Object.keys(this.name2Id)},t.prototype.getValue=function(t){if(t instanceof ie){if(null==this.id2Value[t.id])throw new g("Nonexistent key: ".concat(t.name));return this.id2Value[t.id]}var e=this.name2Id[t];if(null==e)throw new g("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Value[e]},t.prototype.getMask=function(t){if(t instanceof ie){if(null==this.id2Value[t.id])throw new g("Nonexistent key: ".concat(t.name));return this.id2Mask[t.id]}var e=this.name2Id[t];if(null==e)throw new g("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Mask[e]},t.prototype.disposeMasks=function(){null!=this.id2Mask&&a.dispose(this.id2Mask)},t}(),fe=new b,de=new b;function me(t,e,n,r){var i,o,s,u,c=null!=n&&n.training,l=Array.isArray(t),p=l?t:[t],f=p.map((function(t){return t.name})),d=[],m=e.names();try{for(var g=h(f),v=g.next();!v.done;v=g.next()){var y=v.value;-1!==m.indexOf(y)?d.push(e.getValue(y)):d.push(null)}}catch(t){i={error:t}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var b,x=f.join(",")+"|"+e.names().sort().join(","),w=fe.get(x);if(null==w){var _=function(t,e){var n,r,i,o;a.util.assert(null!=t&&t.length>0,(function(){return"Expected at least one fetch, got none"}));var s=[],u={};if(1===t.length){var c=ve(t[0],e);s=c.sorted,u=c.recipientMap}else{var l=new Set;try{for(var p=h(t),f=p.next();!f.done;f=p.next()){var d=ve(f.value,e),m=d.sorted,g=d.recipientMap;try{for(var v=(i=void 0,h(m)),y=v.next();!y.done;y=v.next()){var b=y.value;l.has(b.name)||(s.push(b),l.add(b.name))}}catch(t){i={error:t}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}var x=function(t){null==u[t]&&(u[t]=new Set),g[t].forEach((function(e){return u[t].add(e)}))};for(var w in g)x(w)}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}}return{sorted:s,recipientCounts:ge(u)}}(p,e);w=_.sorted,b=_.recipientCounts,fe.put(x,w),de.put(x,b)}b={},c||Object.assign(b,de.get(x));for(var S=new pe(e),E=0;E<w.length;++E){if(null!=r){var k=a.memory().numTensors;k>r.maxNumTensors&&(r.maxNumTensors=k),k<r.minNumTensors&&(r.minNumTensors=k)}var I=w[E],A=I.sourceLayer;if(!(A instanceof le)){var N=[],C=[],R=[],O=!1;try{for(var D=(s=void 0,h(I.inputs)),M=D.next();!M.done;M=D.next()){var F=M.value,P=S.getValue(F),L=S.getMask(F);N.push(P),C.push(L),null!=L&&(O=!0),c||(b[F.name]--,0!==b[F.name]||e.hasKey(F)||-1!==f.indexOf(F.name)||P.isDisposed||!0===F.sourceLayer.stateful||R.push(P))}}catch(t){s={error:t}}finally{try{M&&!M.done&&(u=D.return)&&u.call(D)}finally{if(s)throw s.error}}O&&((n=n||{}).mask=C[0]);var B=T(A.apply(N,n)),z=null;A.supportsMasking&&(z=A.computeMask(N,C));for(var U=ye(I),G=Array.isArray(U)?U:[U],W=0;W<G.length;++W){S.hasKey(G[W])||S.add(G[W],B[W],Array.isArray(z)?z[0]:z);var V=f.indexOf(G[W].name);-1!==V&&(d[V]=B[W])}c||a.dispose(R)}}return S.disposeMasks(),l?d:d[0]}function ge(t){var e={};for(var n in t)e[n]=t[n].size;return e}function ve(t,e){var n,r,i,a,o=new Set,s=[],u={};try{for(var c=h(e.names()),l=c.next();!l.done;l=c.next()){var p=l.value;o.add(p)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}var f=[],d=[];for(f.push(t);f.length>0;){var m=f[f.length-1];if(o.has(m.name))f.pop();else{var g=d[d.length-1]===f.length-1;if(0===m.inputs.length||g)f.pop(),s.push(m),o.add(m.name),g&&d.pop();else{d.push(f.length-1);try{for(var v=(i=void 0,h(m.inputs)),y=v.next();!y.done;y=v.next()){var b=y.value;null==u[b.name]&&(u[b.name]=new Set),u[b.name].add(m.name),o.has(b.name)||f.push(b)}}catch(t){i={error:t}}finally{try{y&&!y.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}}}}return{sorted:s,recipientMap:u}}function ye(t){var e,n,r;if(1===t.sourceLayer.inboundNodes.length)r=t.sourceLayer.output;else{for(var i=null,a=0;a<t.sourceLayer.inboundNodes.length;++a)try{for(var o=(e=void 0,h(t.sourceLayer.inboundNodes[a].outputTensors)),s=o.next();!s.done;s=o.next())if(s.value.id===t.id){i=a;break}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}r=t.sourceLayer.getOutputAt(i)}return r}a.env().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(function(){return 100}),(function(t){null!=fe&&fe.setMaxEntries(t),null!=de&&de.setMaxEntries(t)}));var be="Add",xe="BatchMatMul",we="BatchToSpaceND",_e="Cast",Se="ComplexAbs",Te="Concat",Ee="Conv2D",ke="Conv2DBackpropInput",Ie="Cosh",Ae="Cumsum",Ne="RealDiv",Ce="ExpandDims",Re="Floor",Oe="FloorDiv",De="GatherV2",Me="GreaterEqual",Fe="Identity",Pe="Maximum",Le="Multiply",Be="Pack",ze="PadV2",Ue="Reshape",Ge="Reverse",We="Rsqrt",Ve="Select",je="Slice",He="Sinh",Xe="Sigmoid",qe="Sqrt",Ke="SpaceToBatchND",Ye="SplitV",Ze="Tile",$e="Transpose",Je="Unpack",Qe="UnsortedSegmentSum",tn="ZerosLike",en="Step",nn=function(){function t(){}return t.prototype.refCount=function(t){return rn("refCount")},t.prototype.incRef=function(t){return rn("incRef")},t.prototype.timerAvailable=function(){return!0},t.prototype.time=function(t){return rn("time")},t.prototype.read=function(t){return rn("read")},t.prototype.readSync=function(t){return rn("readSync")},t.prototype.readToGPU=function(t,e){return rn("readToGPU")},t.prototype.numDataIds=function(){return rn("numDataIds")},t.prototype.disposeData=function(t,e){return rn("disposeData")},t.prototype.write=function(t,e,n){return rn("write")},t.prototype.move=function(t,e,n,r,i){return rn("move")},t.prototype.createTensorFromGPUData=function(t,e,n){return rn("createTensorFromGPUData")},t.prototype.memory=function(){return rn("memory")},t.prototype.floatPrecision=function(){return rn("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.dispose=function(){return rn("dispose")},t}();function rn(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function an(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function on(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function sn(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function un(t){return t%1==0}function cn(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function ln(t,e){var n=e.length;return an((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t)})),an(t.every((function(t){return un(t)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(t)})),t.map((function(t){return t<0?n+t:t}))}function hn(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function pn(t){return"string"==typeof t||t instanceof String}function fn(t){return Array.isArray(t)?fn(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":"number"==typeof t?"float32":pn(t)?"string":function(t){return"boolean"==typeof t}(t)?"bool":"float32"}function dn(t){return!!(t&&t.constructor&&t.call&&t.apply)}function mn(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function gn(t,e,n,r){void 0===r&&(r=!1);var i=new Array;if(1===e.length)for(var a=e[0]*(r?2:1),o=0;o<a;o++)i[o]=n[t+o];else{a=e[0];var s=e.slice(1),u=s.reduce((function(t,e){return t*e}))*(r?2:1);for(o=0;o<a;o++)i[o]=gn(t+o*u,s,n,r)}return i}function vn(t,e,n){if(void 0===n&&(n=!1),0===t.length)return e[0];var r=t.reduce((function(t,e){return t*e}))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return gn(0,t,e,n)}function yn(t,e){for(var n=bn(t,e),r=0;r<n.length;r++)n[r]=1;return n}function bn(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function xn(t){t.forEach((function(e){an(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")}))}))}function wn(t){return t&&t.then&&"function"==typeof t.then}var _n="tfjsflags",Sn=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Tn,this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&(En().getBool("IS_TEST")||En().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];En().getBool("IS_TEST")||En().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(r,".")),this.set(t,r)}},t.prototype.getAsync=function(t){return c(this,void 0,void 0,(function(){var e,n;return l(this,(function(r){switch(r.label){case 0:return t in this.flags?[2,this.flags[t]]:(e=this.flags,n=t,[4,this.evaluateFlag(t)]);case 1:return e[n]=r.sent(),[2,this.flags[t]]}}))}))},t.prototype.get=function(t){if(t in this.flags)return this.flags[t];var e=this.evaluateFlag(t);if(wn(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getString=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=this.getQueryParams(this.global.location.search);_n in e&&e[_n].split(",").forEach((function(e){var n=p(e.split(":"),2),r=n[0],i=n[1];t.urlFlags[r]=function(t,e){var n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:e}(0,i)}))}},t}();function Tn(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e}function En(){return In}var kn,In=null;function An(){if(null==kn){var t=void 0;if("undefined"!=typeof window)t=window;else if(void 0!==r)t=r;else if(void 0!==e)t=e;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}kn=t}return kn}function Nn(t,e){var n,r=(null==(n=An())._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals);if(r.has(t))return r.get(t);var i=e();return r.set(t,i),r.get(t)}function Cn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];En().getBool("IS_TEST")||En().getBool("PROD")||console.warn.apply(console,f([],p(t),!1))}var Rn=Nn("kernelRegistry",(function(){return new Map})),On=Nn("gradRegistry",(function(){return new Map}));function Dn(t,e){var n=function(t,e){return"".concat(e,"_").concat(t)}(t,e);return Rn.get(n)}function Mn(t){return On.get(t)}function Fn(t){for(var e=Rn.entries(),n=[];;){var r=e.next(),i=r.done,a=r.value;if(i)break;var o=p(a,2),s=o[0],u=o[1];p(s.split("_"),1)[0]===t&&n.push(u)}return n}var Pn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{};var Ln=zn,Bn=null;try{Bn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function zn(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function Un(t){return!0===(t&&t.__isLong__)}zn.prototype.__isLong__,Object.defineProperty(zn.prototype,"__isLong__",{value:!0}),zn.isLong=Un;var Gn={},Wn={};function Vn(t,e){var n,r,i;return e?(i=0<=(t>>>=0)&&t<256)&&(r=Wn[t])?r:(n=Hn(t,(0|t)<0?-1:0,!0),i&&(Wn[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(r=Gn[t])?r:(n=Hn(t,t<0?-1:0,!1),i&&(Gn[t]=n),n)}function jn(t,e){if(isNaN(t))return e?tr:Qn;if(e){if(t<0)return tr;if(t>=Zn)return ar}else{if(t<=-$n)return or;if(t+1>=$n)return ir}return t<0?jn(-t,e).neg():Hn(t%Yn|0,t/Yn|0,e)}function Hn(t,e,n){return new zn(t,e,n)}zn.fromInt=Vn,zn.fromNumber=jn,zn.fromBits=Hn;var Xn=Math.pow;function qn(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return Qn;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return qn(t.substring(1),e,n).neg();for(var i=jn(Xn(n,8)),a=Qn,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),u=parseInt(t.substring(o,o+s),n);if(s<8){var c=jn(Xn(n,s));a=a.mul(c).add(jn(u))}else a=(a=a.mul(i)).add(jn(u))}return a.unsigned=e,a}function Kn(t,e){return"number"==typeof t?jn(t,e):"string"==typeof t?qn(t,e):Hn(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}zn.fromString=qn,zn.fromValue=Kn;var Yn=4294967296,Zn=Yn*Yn,$n=Zn/2,Jn=Vn(1<<24),Qn=Vn(0);zn.ZERO=Qn;var tr=Vn(0,!0);zn.UZERO=tr;var er=Vn(1);zn.ONE=er;var nr=Vn(1,!0);zn.UONE=nr;var rr=Vn(-1);zn.NEG_ONE=rr;var ir=Hn(-1,2147483647,!1);zn.MAX_VALUE=ir;var ar=Hn(-1,-1,!0);zn.MAX_UNSIGNED_VALUE=ar;var or=Hn(0,-2147483648,!1);zn.MIN_VALUE=or;var sr=zn.prototype;sr.toInt=function(){return this.unsigned?this.low>>>0:this.low},sr.toNumber=function(){return this.unsigned?(this.high>>>0)*Yn+(this.low>>>0):this.high*Yn+(this.low>>>0)},sr.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(or)){var e=jn(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=jn(Xn(t,6),this.unsigned),a=this,o="";;){var s=a.div(i),u=(a.sub(s.mul(i)).toInt()>>>0).toString(t);if((a=s).isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},sr.getHighBits=function(){return this.high},sr.getHighBitsUnsigned=function(){return this.high>>>0},sr.getLowBits=function(){return this.low},sr.getLowBitsUnsigned=function(){return this.low>>>0},sr.getNumBitsAbs=function(){if(this.isNegative())return this.eq(or)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},sr.isZero=function(){return 0===this.high&&0===this.low},sr.eqz=sr.isZero,sr.isNegative=function(){return!this.unsigned&&this.high<0},sr.isPositive=function(){return this.unsigned||this.high>=0},sr.isOdd=function(){return!(1&~this.low)},sr.isEven=function(){return!(1&this.low)},sr.equals=function(t){return Un(t)||(t=Kn(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},sr.eq=sr.equals,sr.notEquals=function(t){return!this.eq(t)},sr.neq=sr.notEquals,sr.ne=sr.notEquals,sr.lessThan=function(t){return this.comp(t)<0},sr.lt=sr.lessThan,sr.lessThanOrEqual=function(t){return this.comp(t)<=0},sr.lte=sr.lessThanOrEqual,sr.le=sr.lessThanOrEqual,sr.greaterThan=function(t){return this.comp(t)>0},sr.gt=sr.greaterThan,sr.greaterThanOrEqual=function(t){return this.comp(t)>=0},sr.gte=sr.greaterThanOrEqual,sr.ge=sr.greaterThanOrEqual,sr.compare=function(t){if(Un(t)||(t=Kn(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},sr.comp=sr.compare,sr.negate=function(){return!this.unsigned&&this.eq(or)?or:this.not().add(er)},sr.neg=sr.negate,sr.add=function(t){Un(t)||(t=Kn(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=t.high>>>16,o=65535&t.high,s=t.low>>>16,u=0,c=0,l=0,h=0;return l+=(h+=i+(65535&t.low))>>>16,c+=(l+=r+s)>>>16,u+=(c+=n+o)>>>16,u+=e+a,Hn((l&=65535)<<16|(h&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},sr.subtract=function(t){return Un(t)||(t=Kn(t)),this.add(t.neg())},sr.sub=sr.subtract,sr.multiply=function(t){if(this.isZero())return Qn;if(Un(t)||(t=Kn(t)),Bn)return Hn(Bn.mul(this.low,this.high,t.low,t.high),Bn.get_high(),this.unsigned);if(t.isZero())return Qn;if(this.eq(or))return t.isOdd()?or:Qn;if(t.eq(or))return this.isOdd()?or:Qn;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(Jn)&&t.lt(Jn))return jn(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=t.high>>>16,o=65535&t.high,s=t.low>>>16,u=65535&t.low,c=0,l=0,h=0,p=0;return h+=(p+=i*u)>>>16,l+=(h+=r*u)>>>16,h&=65535,l+=(h+=i*s)>>>16,c+=(l+=n*u)>>>16,l&=65535,c+=(l+=r*s)>>>16,l&=65535,c+=(l+=i*o)>>>16,c+=e*u+n*s+r*o+i*a,Hn((h&=65535)<<16|(p&=65535),(c&=65535)<<16|(l&=65535),this.unsigned)},sr.mul=sr.multiply,sr.divide=function(t){if(Un(t)||(t=Kn(t)),t.isZero())throw Error("division by zero");var e,n,r;if(Bn)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?Hn((this.unsigned?Bn.div_u:Bn.div_s)(this.low,this.high,t.low,t.high),Bn.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?tr:Qn;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return tr;if(t.gt(this.shru(1)))return nr;r=tr}else{if(this.eq(or))return t.eq(er)||t.eq(rr)?or:t.eq(or)?er:(e=this.shr(1).div(t).shl(1)).eq(Qn)?t.isNegative()?er:rr:(n=this.sub(t.mul(e)),r=e.add(n.div(t)));if(t.eq(or))return this.unsigned?tr:Qn;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();r=Qn}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var i=Math.ceil(Math.log(e)/Math.LN2),a=i<=48?1:Xn(2,i-48),o=jn(e),s=o.mul(t);s.isNegative()||s.gt(n);)s=(o=jn(e-=a,this.unsigned)).mul(t);o.isZero()&&(o=er),r=r.add(o),n=n.sub(s)}return r},sr.div=sr.divide,sr.modulo=function(t){return Un(t)||(t=Kn(t)),Bn?Hn((this.unsigned?Bn.rem_u:Bn.rem_s)(this.low,this.high,t.low,t.high),Bn.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},sr.mod=sr.modulo,sr.rem=sr.modulo,sr.not=function(){return Hn(~this.low,~this.high,this.unsigned)},sr.and=function(t){return Un(t)||(t=Kn(t)),Hn(this.low&t.low,this.high&t.high,this.unsigned)},sr.or=function(t){return Un(t)||(t=Kn(t)),Hn(this.low|t.low,this.high|t.high,this.unsigned)},sr.xor=function(t){return Un(t)||(t=Kn(t)),Hn(this.low^t.low,this.high^t.high,this.unsigned)},sr.shiftLeft=function(t){return Un(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Hn(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Hn(0,this.low<<t-32,this.unsigned)},sr.shl=sr.shiftLeft,sr.shiftRight=function(t){return Un(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Hn(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Hn(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},sr.shr=sr.shiftRight,sr.shiftRightUnsigned=function(t){if(Un(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?Hn(this.low>>>t|e<<32-t,e>>>t,this.unsigned):Hn(32===t?e:e>>>t-32,0,this.unsigned)},sr.shru=sr.shiftRightUnsigned,sr.shr_u=sr.shiftRightUnsigned,sr.toSigned=function(){return this.unsigned?Hn(this.low,this.high,!1):this},sr.toUnsigned=function(){return this.unsigned?this:Hn(this.low,this.high,!0)},sr.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},sr.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},sr.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},zn.fromBytes=function(t,e,n){return n?zn.fromBytesLE(t,e):zn.fromBytesBE(t,e)},zn.fromBytesLE=function(t,e){return new zn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},zn.fromBytesBE=function(t,e){return new zn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};var ur=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(Ln),cr=ur||function(t,e){return e.forEach((function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((function(n){if("default"!==n&&!(n in t)){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}))})),t}({__proto__:null,default:ur},[Ln]);function lr(t){return cr.fromString(t,!0,16)}function hr(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=mr(t)),En().getBool("DEBUG")&&function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var n=new Uint8Array(t.length),r=0;r<n.length;++r)0!==Math.round(t[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(e))}function pr(){return En().platform.now()}function fr(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",En().platform.decode(t,e)}function dr(t){return null!=En().platform.isTypedArray?En().platform.isTypedArray(t):function(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}(t)}function mr(t,e,n){var r,i;if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),"boolean"==typeof t||"number"==typeof t||"string"==typeof t||wn(t)||null==t||dr(t)&&n)e.push(t);else if(Array.isArray(t)||dr(t))for(var a=0;a<t.length;++a)mr(t[a],e,n);else{var o=-1;try{for(var s=h(Object.keys(t)),u=s.next();!u.done;u=s.next()){var c=u.value;/^([1-9]+[0-9]*|0)$/.test(c)&&(o=Math.max(o,Number(c)))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}for(a=0;a<=o;a++)mr(t[a],e,n)}return e}lr("c3a5c85c97cb3127"),lr("b492b66fbe98f273"),lr("9ae16a3b2f90404f");var gr=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new vr)}return t.prototype.profileKernel=function(t,e,n){var r,i,a,o,s=function(){a=n()},u=pr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();try{for(var c=h(a),l=c.next();!l.done;l=c.next())l.value.dataSync()}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}o=Promise.resolve({kernelMs:pr()-u})}if(En().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var p=function(e){var n=a[e];n.data().then((function(e){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found ".concat(i," in the result of '").concat(n,"'")),!0}}(e,n.dtype,t)}))},f=0;f<a.length;f++)p(f);return{kernelName:t,outputs:a,inputs:e,timeMs:o.then((function(t){return t.kernelMs})),extraInfo:o.then((function(t){return null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""}))}},t.prototype.logKernelProfile=function(t){var e=this,n=t.kernelName,r=t.outputs,i=t.timeMs,a=t.inputs,o=t.extraInfo;r.forEach((function(t){Promise.all([t.data(),i,o]).then((function(r){e.logger.logKernelProfile(n,t,r[0],r[1],a,r[2])}))}))},t}(),vr=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,a){var o="number"==typeof r?cn("".concat(r,"ms"),9):r.error,s=cn(t,25),u=e.rank,c=e.size,l=cn(e.shape.toString(),14),h="";for(var p in i){var f=i[p];if(null!=f){var d=f.shape||e.shape,m=d.length;h+="".concat(p,": ").concat(m,"D ").concat(m>0?d:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(a),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),yr=20,br=3,xr=7;function wr(t,e,n,r){var i=mn(e),a=function(t,e,n,r){var i=on(e),a=r[r.length-1],o=new Array(a).fill(0),s=e.length,u="complex64"===n?Er(t):t;if(s>1)for(var c=0;c<i/a;c++)for(var l=c*a,h=0;h<a;h++)o[h]=Math.max(o[h],_r(u[l+h],0,n).length);return o}(t,e,n,i),o=e.length,s=Tr(t,e,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}function _r(t,e,n){return cn(Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(xr))," + ")+"".concat(parseFloat(t[1].toFixed(xr)),"j"):pn(t)?"'".concat(t,"'"):"bool"===n?Sr(t):parseFloat(t.toFixed(xr)).toString(),e)}function Sr(t){return 0===t?"false":"true"}function Tr(t,e,n,r,i,a){void 0===a&&(a=!0);var o="complex64"===n?2:1,s=e[0],u=e.length;if(0===u)return"complex64"===n?[_r(Er(t)[0],0,n)]:"bool"===n?[Sr(t[0])]:[t[0].toString()];if(1===u){if(s>yr){var c=br*o,l=Array.from(t.slice(0,c)),h=Array.from(t.slice((s-br)*o,s*o));return"complex64"===n&&(l=Er(l),h=Er(h)),["["+l.map((function(t,e){return _r(t,i[e],n)})).join(", ")+", ..., "+h.map((function(t,e){return _r(t,i[s-br+e],n)})).join(", ")+"]"]}return["["+("complex64"===n?Er(t):Array.from(t)).map((function(t,e){return _r(t,i[e],n)})).join(", ")+"]"]}var d=e.slice(1),m=r.slice(1),g=r[0]*o,v=[];if(s>yr){for(var y=0;y<br;y++){var b=(x=y*g)+g;v.push.apply(v,f([],p(Tr(t.slice(x,b),d,n,m,i,!1)),!1))}for(v.push("..."),y=s-br;y<s;y++)b=(x=y*g)+g,v.push.apply(v,f([],p(Tr(t.slice(x,b),d,n,m,i,y===s-1)),!1))}else for(y=0;y<s;y++){var x;b=(x=y*g)+g,v.push.apply(v,f([],p(Tr(t.slice(x,b),d,n,m,i,y===s-1)),!1))}var w=2===u?",":"";for(v[0]="["+(s>0?v[0]+w:""),y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;var _=",\n";for(y=2;y<u;y++)_+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":_),v}function Er(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}!function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=on(t),null!=n){var i=n.length;an(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(r.size,"'.")}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||function(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}(e,this.size),this.strides=mn(t)}t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),an(n.length===this.rank,(function(){return"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(e.rank,")")}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];0===n.length&&(n=[0]);var i=0;try{for(var a=h(n),o=a.next();!o.done;o=a.next()){var s=o.value;if(s<0||s>=this.shape[i]){var u="Requested out of range element at ".concat(n,". ")+"  Buffer shape=".concat(this.shape);throw new Error(u)}i++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}for(var c=n[n.length-1],l=0;l<n.length-1;++l)c+=this.strides[l]*n[l];return this.values[c]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!1,configurable:!0}),t.prototype.toTensor=function(){return kr().makeTensor(this.values,this.shape,this.dtype)}}();var kr=null,Ir=null,Ar=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=on(t),this.strides=mn(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!1,configurable:!0}),t.prototype.buffer=function(){return c(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Ir.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return Ir.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return c(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,vn(this.shape,t,"complex64"===this.dtype)]}}))}))},t.prototype.arraySync=function(){return vn(this.shape,this.dataSync(),"complex64"===this.dtype)},t.prototype.data=function(){return c(this,void 0,void 0,(function(){var t,e;return l(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=kr().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return fr(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataToGPU=function(t){return this.throwIfDisposed(),kr().readToGPU(this.dataId,t)},t.prototype.dataSync=function(){this.throwIfDisposed();var t=kr().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return fr(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return c(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,kr().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),kr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!1,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.print=function(t){return void 0===t&&(t=!1),Ir.print(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),Ir.clone(this)},t.prototype.toString=function(t){return void 0===t&&(t=!1),wr(this.dataSync(),this.shape,this.dtype,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),Ir.cast(this,t)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),kr().makeVariable(this,t,e,n)},t}();function Nr(){return Nn("Tensor",(function(){return Ar}))}Object.defineProperty(Ar,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}}),Nr();var Cr,Rr,Or,Dr,Mr,Fr=function(t){function e(e,n,r,i){var a=t.call(this,e.shape,e.dtype,e.dataId,i)||this;return a.trainable=n,a.name=r,a}return u(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!sn(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));kr().disposeTensor(this),this.dataId=t.dataId,kr().incRef(this,null)},e.prototype.dispose=function(){kr().disposeVariable(this),this.isDisposedInternal=!0},e}(Ar);Object.defineProperty(Fr,Symbol.hasInstance,{value:function(t){return t instanceof Ar&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(Cr||(Cr={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Rr||(Rr={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(Or||(Or={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Dr||(Dr={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Mr||(Mr={}));var Pr={float32:Dr,int32:Rr,bool:Or,complex64:Mr};function Lr(t){return null!=t&&"object"==typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function Br(t){return"undefined"!=typeof GPUBuffer&&null!=t&&"object"==typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}function zr(t,e){if(t.dtype===e.dtype)return[t,e];var n=function(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return Pr[t][e]}(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Ur(t){var e=[];return Gr(t,e,new Set),e}function Gr(t,e,n){if(null!=t)if(t instanceof Ar)e.push(t);else if(r=t,Array.isArray(r)||"object"==typeof r){var r,i=t;for(var a in i){var o=i[a];n.has(o)||(n.add(o),Gr(o,e,n))}}}function Wr(t){return null!=t.kernelName}var Vr=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(t){return t.name}))))}}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),jr=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Vr}return t.prototype.ready=function(){return c(this,void 0,void 0,(function(){var t,e,n;return l(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!1,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(Cn("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return c(this,void 0,void 0,(function(){var e,n,r;return l(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new gr(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;Fn(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;Fn(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{var r=n.factory();if(!r||r instanceof nn||"function"!=typeof r.then)return this.registry[t]=r,{success:!0,asyncInit:!1};var i=++this.pendingBackendInitId,a=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return i<e.pendingBackendInitId||(e.pendingBackendInit=null,Cn("Initialization of backend ".concat(t," failed")),Cn(n.stack||n.message)),!1}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}catch(e){return Cn("Initialization of backend ".concat(t," failed")),Cn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.success,a=r.asyncInit;if(a||i)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),a=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=Hr.runKernel(Fe,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){var e={x:t};return Hr.runKernel(_e,e,{dtype:"float32"})}}}),[],{}),e},t.prototype.runKernel=function(t,e,n){if(null==this.backendName&&this.backend,null==Dn(t,this.backendName))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),i=0;n.forEach((function(t){i+="complex64"===t.dtype?3:1}));var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))},t.prototype.runKernelFunc=function(t){var e,n,r,i=this,a=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=Wr(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(Wr(t)){var l=t.kernelName,h=t.inputs,p=t.attrs;null==this.backendName&&this.backend;var f=Dn(l,this.backendName);an(null!=f,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(i.backendName,"'")})),n=function(){var t=i.backend.numDataIds();r=f.kernelFunc({inputs:h,attrs:p,backend:i.backend});var e=Array.isArray(r)?r:[r];i.shouldCheckForMemLeaks()&&i.checkKernelForMemLeak(l,t,e);var n=e.map((function(t){return null!=t.rank?t:i.makeTensorFromTensorInfo(t)}));if(o){var s=i.getTensorsForGradient(l,h,n);a=i.saveTensorsForBackwardMode(s)}return n}}else{var d=t.forwardFunc,m=function(t){o&&(a=t.map((function(t){return i.keep(i.clone(t))})))};n=function(){var t=i.backend.numDataIds();r=i.tidy((function(){return d(i.backend,m)}));var e=Array.isArray(r)?r:[r];return i.shouldCheckForMemLeaks()&&i.checkKernelForMemLeak(c,t,e),e}}var g,v=t.inputs,y=t.attrs,b=Wr(t)?null:t.backwardsFunc;return this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){i.ENV.getBool("DEBUG")||i.state.profiling?(g=i.profiler.profileKernel(c,v,(function(){return n()})),i.ENV.getBool("DEBUG")&&i.profiler.logKernelProfile(g),e=g.outputs):e=n()})),o&&this.addTapeNode(c,v,e,b,a,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(v).map((function(t){return null!=v[t]?v[t].shape:null})),outputShapes:e.map((function(t){return t.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(r)?e:e[0]},t.prototype.saveTensorsForBackwardMode=function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))},t.prototype.getTensorsForGradient=function(t,e,n){var r=Mn(t);if(null!=r){var i=r.inputsToSave||[],a=r.outputsToSave||[],o=void 0;r.saveAllInputs?(an(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(e).map((function(t){return e[t]}))):o=i.map((function(t){return e[t]}));var s=n.filter((function(t,e){return a[e]}));return o.concat(s)}return[]},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var i=t;"string"===n&&pn(t[0])&&(i=t.map((function(t){return e=t,void 0===n&&(n="utf-8"),n=n||"utf-8",En().platform.encode(e,n);var e,n})));var a=r.write(i,e,n),o=new Ar(e,n,a,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(a),u=function(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}(i);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},t.prototype.makeTensorFromDataId=function(t,e,n,r){var i={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)},t.prototype.makeTensorFromTensorInfo=function(t,e){var n=t.dataId,r=t.shape,i=t.dtype,a=new Ar(r,i,n,this.nextTensorId());return this.trackTensor(a,e),a},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));var i=new Fr(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name ".concat(i.name," was already registered"));return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.trackTensor=function(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*hn(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof Fr||this.track(t)},t.prototype.incRef=function(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)},t.prototype.removeDataId=function(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){var e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){var n=t.size*hn(t.dtype);this.state.numBytes-=n}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,u,c,d,m;return l(this,(function(l){switch(l.label){case 0:return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],r=this.state.activeProfile,[4,t()];case 1:r.result=l.sent(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,f([],p(this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),!1)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,l.label=2;case 2:l.trys.push([2,8,9,10]),i=h(this.state.activeProfile.kernels),a=i.next(),l.label=3;case 3:return a.done?[3,7]:(o=a.value,s=o,[4,o.kernelTimeMs]);case 4:return s.kernelTimeMs=l.sent(),u=o,[4,o.extraInfo];case 5:u.extraInfo=l.sent(),l.label=6;case 6:return a=i.next(),[3,3];case 7:return[3,10];case 8:return c=l.sent(),d={error:c},[3,10];case 9:try{a&&!a.done&&(m=i.return)&&m.call(i)}finally{if(d)throw d.error}return[7];case 10:return[2,this.state.activeProfile]}}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,i,a){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},u=Mn(t);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],i=bn(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],i,a)}),this.state.activeTape.push(s)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=Ur(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||r.has(a.id)||a.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),an(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var a=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));an(a instanceof Ar,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},i={},a=0;a<e.length;a++)r[e[a].id]=!0;for(a=0;a<t.length;a++){var o=(d=t[a]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){d.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[d.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var p={};for(a=t.length-1;a>=0;a--)for(o=(d=t[a]).inputs,l=0;l<d.outputs.length;l++)if(h[d.outputs[l].id]){for(var s in o)h[o[s].id]=!0,p[d.id]=!0;break}var f=[];for(a=0;a<t.length;a++){var d;if(i[(d=t[a]).id]&&p[d.id]){var m={};for(var s in d.inputs){var g=d.inputs[s];r[g.id]&&(m[s]=g)}var v=Object.assign({},d);v.inputs=m,v.outputs=d.outputs,f.push(v)}}return f}(this.state.activeTape,e,a);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[a.id]=n??(r=yn(on(t=a.shape),"float32"),Hr.makeTensor(r,t,"float32")),function(t,e,n,r){for(var i=function(i){var a=e[i],o=[];if(a.outputs.forEach((function(e){var n=t[e.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var s=a.gradient(o),u=function(e){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var i=n((function(){return s[e]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[e];if(!sn(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=i;else{var u=t[o.id];t[o.id]=r(u,i),u.dispose()}};for(var c in a.inputs)u(c)},a=e.length-1;a>=0;a--)i(a)}(s,o,(function(t){return i.tidy(t)}),Xr);var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){var e,n;try{for(var r=h(t.saved),i=r.next();!i.done;i=r.next())i.value.dispose()}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}})),i.state.activeTape=null),{value:a,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return an(dn(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];an(r.every((function(t){return t instanceof Ar})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var a={};return r.forEach((function(t,e){a[e]=t})),e.runKernelFunc({forwardFunc:function(e,i){return an((n=t.apply(void 0,f([],p(f(f([],p(r),!1),[i],!1)),!1))).value instanceof Ar,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),an(dn(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value},backwardsFunc:function(t,e){var i=n.gradFunc(t,e),a=Array.isArray(i)?i:[i];an(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),an(a.every((function(t){return t instanceof Ar})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(t,e){o[e]=function(){return t}})),o},inputs:a})}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.readToGPU=function(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)},t.prototype.time=function(t){return c(this,void 0,void 0,(function(){var e,n;return l(this,(function(r){switch(r.label){case 0:return e=pr(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=pr()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!1,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Vr,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t}();jr.nextTensorId=0,jr.nextVariableId=0;var Hr=function(){var t=An();if(null==t._tfengine){var e=new Sn(t);t._tfengine=new jr(e)}return function(t){In=t}(t._tfengine.ENV),kr=function(){return t._tfengine},t._tfengine}();function Xr(t,e){var n={a:t,b:e};return Hr.runKernel(be,n)}function qr(t,e){var n=t;if(dr(t))return"string"===e?[]:[t.length];if(Lr(t)){var r=t.channels||"RGBA";return[t.height,t.width*r.length]}if(Br(t))return[t.buffer.size/(null==e?4:hn(e))];if(!Array.isArray(t))return[];for(var i=[];Array.isArray(n)||dr(n)&&"string"!==e;)i.push(n.length),n=n[0];return Array.isArray(t)&&En().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Kr(t,i,[]),i}function Kr(t,e,n){if(n=n||[],Array.isArray(t)||dr(t)){an(e.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")})),an(t.length===e[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")}));for(var r=e.slice(1),i=0;i<t.length;++i)Kr(t[i],r,n.concat(i))}else an(0===e.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")}))}function Yr(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function Zr(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof Nr())return Yr(r,t.dtype,e,n),t;var i=fn(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Yr(r,i,e,n),null==t||!dr(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){var a=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(a,"'"))}var o=qr(t,i);dr(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?hr(t,i):mr(t,[],!0);return Hr.makeTensor(s,o,i)}function $r(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map((function(t,i){return Zr(t,"".concat(e,"[").concat(i,"]"),n,r)}))}function Jr(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Hr.startScope(n);try{var i=r.apply(void 0,f([],p(t),!1));return wn(i)&&console.error("Cannot return a Promise inside of tidy."),Hr.endScope(i),i}catch(t){throw Hr.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}var Qr=Jr({cast_:function(t,e){var n=Zr(t,"x","cast");if(!function(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},i={dtype:e};return Hr.runKernel(_e,r,i)}}),ti=Jr({mul_:function(t,e){var n,r=Zr(t,"a","mul"),i=Zr(e,"b","mul"),a={a:r=(n=p(zr(r,i),2))[0],b:i=n[1]};return Hr.runKernel(Le,a)}}),ei=Jr({step_:function(t,e){void 0===e&&(e=0);var n={x:Zr(t,"x","step")},r={alpha:e};return Hr.runKernel(en,n,r)}}),ni={kernelName:"Abs",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(t,ei(Qr(n,"float32"),-1))}}}},ri=Jr({floorDiv_:function(t,e){var n,r=Zr(t,"a","floorDiv"),i=Zr(e,"b","floorDiv"),a={a:r=(n=p(zr(r,i),2))[0],b:i=n[1]};return Hr.runKernel(Oe,a)}}),ii=Jr({div_:function(t,e){var n,r=Zr(t,"a","div"),i=Zr(e,"b","div");if(r=(n=p(zr(r,i),2))[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype)return ri(r,i);var a={a:r,b:i};return Hr.runKernel(Ne,a,{})}}),ai=Jr({neg_:function(t){var e={x:Zr(t,"x","neg")};return Hr.runKernel("Neg",e)}});function oi(t,e){if((dr(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&dr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return function(t,e,n,r){if(null==r)r=fn(t);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Br(t)||Lr(t)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return Hr.backend.createTensorFromGPUData(t,e||n,r)}if(!dr(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){xn(e);var i=on(e),a=on(n);an(i===a,(function(){return"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(i," values but has ").concat(a)}));for(var o=0;o<n.length;++o){var s=o!==n.length-1||n[o]!==on(e.slice(o));an(n[o]===e[o]||!s,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")}))}}return dr(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?hr(t,r):mr(t,[],!0),Hr.makeTensor(t,e,r)}(t,[],[],e)}var si=Jr({sqrt_:function(t){var e={x:Zr(t,"x","sqrt","float32")};return Hr.runKernel(qe,e)}}),ui=Jr({square_:function(t){var e=Zr(t,"x","square");return Hr.runKernel("Square",{x:e},{})}}),ci=Jr({sub_:function(t,e){var n,r=Zr(t,"a","sub"),i=Zr(e,"b","sub"),a={a:r=(n=p(zr(r,i),2))[0],b:i=n[1]};return Hr.runKernel("Sub",a)}}),li={kernelName:"Acos",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){var e=ui(Qr(n,"float32")),r=si(ci(oi(1),e));return ai(ii(t,r))}}}},hi={kernelName:"Acosh",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){var e=si(ci(ui(Qr(n,"float32")),1));return ii(t,e)}}}};function pi(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function fi(t,e){for(var n=Math.max(t.length,e.length),r=new Array(n),i=0;i<n;i++){var a=t[t.length-i-1];null==a&&(a=1);var o=e[e.length-i-1];if(null==o&&(o=1),1===a)r[n-i-1]=o;else if(1===o)r[n-i-1]=a;else{if(a!==o){var s="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(s)}r[n-i-1]=a}}return r}var di=Jr({reshape_:function(t,e){var n={x:Zr(t,"x","reshape","string_or_numeric")},r={shape:e};return Hr.runKernel(Ue,n,r)}}),mi=Jr({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Zr(t,"x","sum");"bool"===r.dtype&&(r=Qr(r,"int32"));var i={x:r},a={axis:e,keepDims:n};return Hr.runKernel("Sum",i,a)}}),gi={kernelName:be,inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=fi(r.shape,i.shape);return{a:function(){var e=t,n=pi(r.shape,a);return n.length>0&&(e=mi(e,n)),di(e,r.shape)},b:function(){var e=t,n=pi(i.shape,a);return n.length>0&&(e=mi(e,n)),di(e,i.shape)}}}},vi=Jr({zerosLike_:function(t){var e={x:Zr(t,"x","zerosLike")};return Hr.runKernel(tn,e)}}),yi={kernelName:"ArgMax",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return vi(n)}}}},bi={kernelName:"ArgMin",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return vi(n)}}}},xi={kernelName:"Asin",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,si(ci(oi(1),ui(Qr(n,"float32")))))}}}},wi=Jr({add_:function(t,e){var n,r=Zr(t,"a","add"),i=Zr(e,"b","add"),a={a:r=(n=p(zr(r,i),2))[0],b:i=n[1]};return Hr.runKernel(be,a)}}),_i={kernelName:"Asinh",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){var e=si(wi(oi(1),ui(Qr(n,"float32"))));return ii(t,e)}}}},Si={kernelName:"Atan2",inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=fi(r.shape,i.shape);return{a:function(){var e=wi(ui(r),ui(i)),n=ti(t,ii(i,e)),o=pi(r.shape,a);return o.length>0&&(n=mi(n,o)),di(n,r.shape)},b:function(){var e=wi(ui(r),ui(i)),n=ai(ti(t,ii(r,e))),o=pi(i.shape,a);return o.length>0&&(n=mi(n,o)),di(n,i.shape)}}}},Ti={kernelName:"Atan",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,wi(ui(Qr(n,"float32")),1))}}}},Ei={kernelName:"Atanh",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,ci(oi(1),ui(Qr(n,"float32"))))}}}};function ki(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function Ii(t){var e=p(ki(t),3),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function Ai(t,e){return Ii(t)||Ii(e)}function Ni(t){return ki(t).every((function(t){return t>0}))}function Ci(t,e,n){if(null!=n){if("string"==typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"==typeof e)an(un(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}));else{if("object"!=typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach((function(e){e.forEach((function(e){an(un(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}))}))}))}}}var Ri=Jr({avgPool3dGrad_:function(t,e,n,r,i,a){var o=Zr(t,"dy","avgPool3dGrad"),s=Zr(e,"input","avgPool3dGrad"),u=o,c=s,l=!1;4===s.rank&&(l=!0,u=di(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=di(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),an(5===u.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")})),an(5===c.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")})),Ci("avgPool3dGrad",i,a);var h={dy:u,input:c},p={filterSize:n,strides:r,pad:i,dimRoundingMode:a},f=Hr.runKernel("AvgPool3DGrad",h,p);return l?di(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),Oi={kernelName:"AvgPool3D",inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.filterSize,a=n.strides,o=n.pad,s=n.dimRoundingMode;return{x:function(){return Ri(t,r,i,a,o,s)}}}},Di=Jr({avgPoolGrad_:function(t,e,n,r,i){var a=Zr(t,"dy","avgPoolGrad"),o=Zr(e,"input","avgPoolGrad");an(o.rank===a.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(a.rank,")")}));var s=o,u=a,c=!1;3===o.rank&&(c=!0,s=di(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=di(a,[1,a.shape[0],a.shape[1],a.shape[2]])),an(4===u.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),an(4===s.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")}));var l={dy:u,input:s},h={filterSize:n,strides:r,pad:i},p=Hr.runKernel("AvgPoolGrad",l,h);return c?di(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Mi={kernelName:"AvgPool",inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.filterSize,a=n.strides,o=n.pad;return{x:function(){return Di(t,r,i,a,o)}}}},Fi=Jr({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Zr(t,"a","matMul"),o=Zr(e,"b","matMul"),s={a:a=(i=p(zr(a,o),2))[0],b:o=i[1]},u={transposeA:n,transposeB:r};return Hr.runKernel(xe,s,u)}}),Pi={kernelName:xe,inputsToSave:["a","b"],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return Fi(t,a,!1,!1)},b:function(){return Fi(t,i,!0,!1)}}:o&&!s?{a:function(){return Fi(a,t,!1,!0)},b:function(){return Fi(i,t,!1,!1)}}:{a:function(){return Fi(a,t,!0,!0)},b:function(){return Fi(t,i,!0,!0)}}:{a:function(){return Fi(t,a,!1,!0)},b:function(){return Fi(i,t,!0,!1)}}}},Li=Jr({spaceToBatchND_:function(t,e,n){var r=Zr(t,"x","spaceToBatchND");an(r.rank>=1+e.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(e.length)})),an(n.length===e.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length)})),an(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())}));var i={x:r},a={blockShape:e,paddings:n};return Hr.runKernel(Ke,i,a)}}),Bi={kernelName:we,gradFunc:function(t,e,n){var r=n.blockShape,i=n.crops;return{x:function(){return Li(t,r,i)}}}},zi={kernelName:"BroadcastTo",gradFunc:function(t,e,n){for(var r=n,i=r.inputShape,a=r.shape,o=Array.from(a),s=i.length-1;s>=0;s--)if(i[s]===a[s])o[s]=1;else if(1!==i[s])throw new Error("broadcastTo(): [".concat(i,"] cannot be broadcast to [").concat(a,"]."));var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return mi(t,u,!0)}}}},Ui={kernelName:_e,gradFunc:function(t){return{x:function(){return t.clone()}}}},Gi={kernelName:"Ceil",gradFunc:function(t){return{x:function(){return vi(t)}}}},Wi=Jr({greaterEqual_:function(t,e){var n,r=Zr(t,"a","greaterEqual","string_or_numeric"),i=Zr(e,"b","greaterEqual","string_or_numeric");r=(n=p(zr(r,i),2))[0],i=n[1],fi(r.shape,i.shape);var a={a:r,b:i};return Hr.runKernel(Me,a)}}),Vi=Jr({lessEqual_:function(t,e){var n,r=Zr(t,"a","lessEqual","string_or_numeric"),i=Zr(e,"b","lessEqual","string_or_numeric");r=(n=p(zr(r,i),2))[0],i=n[1],fi(r.shape,i.shape);var a={a:r,b:i};return Hr.runKernel("LessEqual",a)}}),ji=Jr({logicalAnd_:function(t,e){var n=Zr(t,"a","logicalAnd","bool"),r=Zr(e,"b","logicalAnd","bool");fi(n.shape,r.shape);var i={a:n,b:r};return Hr.runKernel("LogicalAnd",i)}}),Hi=Jr({clone_:function(t){var e={x:Zr(t,"x","clone","string_or_numeric")};return Hr.runKernel(Fe,e)}}),Xi=Jr({broadcastTo_:function(t,e){var n=Zr(t,"broadcastTo","x"),r=n.shape;if(xn(e),e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){for(var i=n.shape.slice();i.length<e.length;)i.unshift(1);n=di(n,i)}for(var a=n.shape,o=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(e,"]."));if(0===o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0})).length)return Hi(n);var u={x:n},c={reps:o};return Hr.runKernel(Ze,u,c)}}),qi=Jr({where_:function(t,e,n){var r=Zr(e,"a","where"),i=Zr(n,"b","where"),a=Zr(t,"condition","where","bool"),o=fi(fi(a.shape,r.shape),i.shape),s={condition:Xi(a,o),t:Xi(r,o),e:Xi(i,o)};return Hr.runKernel(Ve,s)}}),Ki={kernelName:"ClipByValue",inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.clipValueMin,a=n.clipValueMax;return{x:function(){return qi(ji(Wi(r,i),Vi(r,a)),t,vi(t))}}}},Yi={kernelName:Se,inputsToSave:["x"],gradFunc:ni.gradFunc},Zi=Jr({split_:function(t,e,n){void 0===n&&(n=0);var r={x:Zr(t,"x","split")},i={numOrSizeSplits:e,axis:n};return Hr.runKernel(Ye,r,i)}}),$i={kernelName:Te,saveAllInputs:!0,gradFunc:function(t,e,n){var r=e.map((function(t){return t.shape})),i=ln(n.axis,e[0].shape)[0],a=r.map((function(t){return t[i]}));return Zi(t,a,i).map((function(t){return function(){return t}}))}},Ji=Jr({conv2DBackpropFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC");var s=t;3===t.rank&&(s=di(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=di(e,[1,e.shape[0],e.shape[1],e.shape[2]])),an(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),an(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),an(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===a?s.shape[3]:s.shape[1],l="NHWC"===a?u.shape[3]:u.shape[1];an(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),an(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),Ci("conv2dDerFilter",i,o);var h={x:s,dy:u},p={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,filterShape:n};return Hr.runKernel("Conv2DBackpropFilter",h,p)}}),Qi=Jr({conv2DBackpropInput_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC"),an(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=di(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),an(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),an(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),an(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===a?s[3]:s[1],h="NHWC"===a?u.shape[3]:u.shape[1];an(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),an(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),Ci("conv2dDerInput",i,o);var p={dy:u,filter:n},f={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,inputShape:s},d=Hr.runKernel(ke,p,f);return c?di(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),ta={kernelName:Ee,inputsToSave:["x","filter"],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o=n.dilations,s=n.strides,u=n.pad,c=n.dataFormat;return an(Ii(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return Qi(i.shape,t,a,s,u,c)},filter:function(){return Ji(i,t,a.shape,s,u,c)}}}},ea=Jr({conv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=Zr(t,"x","conv2d","float32"),u=Zr(e,"filter","conv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=di(s,[1,s.shape[0],s.shape[1],s.shape[2]])),an(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),an(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),Ci("conv2d",r,o);var h="NHWC"===i?c.shape[3]:c.shape[1];an(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),an(Ai(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'")})),an(Ni(a),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),an(Ni(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var p={x:c,filter:u},f={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},d=Hr.runKernel(Ee,p,f);return l?di(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),na={kernelName:ke,inputsToSave:["dy","filter"],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o=n.strides,s=n.pad,u=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return ea(t,a,o,s,u,1,c)},filter:function(){return Ji(t,i,a.shape,o,s,u,c)}}}},ra=Jr({conv3DBackpropFilter_:function(t,e,n,r,i){var a=t;4===t.rank&&(a=di(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));var o=e;4===o.rank&&(o=di(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),an(5===a.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(a.shape,".")})),an(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),an(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),an(a.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(a.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),an(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var s={x:a,dy:o},u={strides:r,pad:i,filterShape:n};return Hr.runKernel("Conv3DBackpropFilterV2",s,u)}}),ia=Jr({conv3DBackpropInput_:function(t,e,n,r,i){an(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var a=t,o=e,s=!1;4===e.rank&&(s=!0,o=di(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);var u=a[4],c=o.shape[4];an(5===a.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(a.length,".")})),an(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),an(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),an(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),an(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},h={pad:i,strides:r,inputShape:a},p=Hr.runKernel("Conv3DBackpropInputV2",l,h);return s?di(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),aa={kernelName:"Conv3D",inputsToSave:["x","filter"],gradFunc:function(t,e,n){var r=n.dilations,i=n.strides,a=n.pad;an(Ii(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=p(e,2),s=o[0],u=o[1];return{x:function(){return ia(s.shape,t,u,i,a)},filter:function(){return ra(s,t,u.shape,i,a)}}}},oa=Jr({sin_:function(t){var e={x:Zr(t,"x","sin","float32")};return Hr.runKernel("Sin",e)}}),sa={kernelName:"Cos",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(ai(oa(Qr(n,"float32"))),t)}}}},ua=Jr({sinh_:function(t){var e={x:Zr(t,"x","sinh")};return Hr.runKernel(He,e)}}),ca={kernelName:Ie,inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(ua(Qr(n,"float32")),t)}}}};function la(t,e){return function(t,e,n){for(var r=t.length+e.length,i=[],a=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}(t,e.map((function(t){return 1})),e)}function ha(t,e){if(function(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function pa(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}var fa=Jr({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i={x:Zr(t,"x","cumsum")},a={axis:e,exclusive:n,reverse:r};return Hr.runKernel(Ae,i,a)}});function da(t,e){return Hr.tidy(t,e)}function ma(t){Ur(t).forEach((function(t){return t.dispose()}))}var ga=Jr({complex_:function(t,e){var n,r,i,a=Zr(t,"real","complex"),o=Zr(e,"imag","complex");n=a.shape,r=o.shape,void 0===(i="real and imag shapes, ".concat(a.shape," and ").concat(o.shape,", ")+"must match in call to tf.complex().")&&(i=""),an(sn(n,r),(function(){return i+" Shapes ".concat(n," and ").concat(r," must match")}));var s={real:a,imag:o};return Hr.runKernel("Complex",s)}}),va=Jr({imag_:function(t){var e={input:Zr(t,"input","imag")};return Hr.runKernel("Imag",e)}}),ya=Jr({real_:function(t){var e={input:Zr(t,"input","real")};return Hr.runKernel("Real",e)}}),ba=Jr({transpose_:function(t,e,n){var r=Zr(t,"x","transpose");if(null==e&&(e=r.shape.map((function(t,e){return e})).reverse()),an(r.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(e,".")})),e.forEach((function(t){an(t>=0&&t<r.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(e)}))})),r.rank<=1)return r.clone();var i={x:r},a={perm:e};return"complex64"===r.dtype?da((function(){var t=ya(r),e=va(r);return t=Hr.runKernel($e,{x:t},a),e=Hr.runKernel($e,{x:e},a),n&&(e=ai(e)),ga(t,e)})):Hr.runKernel($e,i,a)}}),xa={kernelName:Ae,inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.axis,a=n.exclusive,o=n.reverse;return{x:function(){var e=ha([i],r.rank),n=fa(t,i,a,!o);return null!=e&&(n=ba(n,e)),n}}}},wa=Jr({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]);var s=t;3===t.rank&&(s=di(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=di(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,filterShape:n};return Hr.runKernel("DepthwiseConv2dNativeBackpropFilter",c,l)}}),_a=Jr({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]);var s=e,u=!1;3===e.rank&&(u=!0,s=di(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,inputShape:t},h=Hr.runKernel("DepthwiseConv2dNativeBackpropInput",c,l);return u?di(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),Sa={kernelName:"DepthwiseConv2dNative",inputsToSave:["x","filter"],gradFunc:function(t,e,n){var r=n.dilations,i=n.strides,a=n.pad,o=n.dimRoundingMode,s=r??[1,1];an(Ii(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=p(e,2),c=u[0],l=u[1];return an(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),an(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")})),an(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")})),an(Ai(i,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(i," and dilations ")+"'".concat(s,"'.")})),Ci("depthwiseConv2d",a,o),{x:function(){return _a(c.shape,t,l,i,a,s,o)},filter:function(){return wa(c,t,l.shape,i,a,s,o)}}}},Ta={kernelName:"Dilation2D",inputsToSave:["x","filter"],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o={x:i,filter:a,dy:t},s={x:i,filter:a,dy:t};return{x:function(){return Hr.runKernel("Dilation2DBackpropInput",o,n)},filter:function(){return Hr.runKernel("Dilation2DBackpropFilter",s,n)}}}},Ea={kernelName:"Elu",outputsToSave:[!0],gradFunc:function(t,e){var n={dy:t,y:p(e,1)[0]};return{x:function(){return Hr.runKernel("EluGrad",n)}}}},ka=Jr({exp_:function(t){var e={x:Zr(t,"x","exp")};return Hr.runKernel("Exp",e)}}),Ia={kernelName:"Erf",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0],r=ti(ka(ai(ui(n))),2/Math.sqrt(Math.PI));return{x:function(){return ti(t,r)}}}},Aa={kernelName:"Exp",outputsToSave:[!0],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(t,n)}}}},Na={kernelName:Ce,inputsToSave:["input"],gradFunc:function(t,e){var n=p(e,1)[0];return{input:function(){return di(t,n.shape)}}}},Ca={kernelName:"Expm1",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(t,ka(n))}}}},Ra={kernelName:Re,gradFunc:function(t){return{x:function(){return vi(t)}}}},Oa={kernelName:Oe,inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=fi(r.shape,i.shape);return{a:function(){var e=ii(t,Qr(i,"float32")),n=pi(r.shape,a);return n.length>0?di(mi(e,n),r.shape):e},b:function(){var e=ti(t,Qr(r,"float32")),n=pi(i.shape,a);n.length>0&&(e=di(mi(e,n),i.shape));var o=ui(i);return ai(ii(e,Qr(o,"float32")))}}}},Da=Jr({rsqrt_:function(t){var e={x:Zr(t,"x","rsqrt","float32")};return Hr.runKernel(We,e)}}),Ma=Jr({tile_:function(t,e){var n=Zr(t,"x","tile","string_or_numeric");an(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")}));var r={x:n},i={reps:e};return Hr.runKernel(Ze,r,i)}}),Fa={kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(t,e,n){var r=n.varianceEpsilon,i=p(e,4),a=i[0],o=i[1],s=i[2],u=i[3],c=u??oi(1),l=pi(o.shape,a.shape),h=[];if(1===o.rank){for(var f=0;f<a.shape.length-1;++f)h.push(a.shape[f]);h.push(1)}var d=ci(a,o),m=ti(t,c),g=Da(wi(s,oi(r))),v=ti(ti(ti(g,g),g),oi(-.5));return{x:function(){return 1===o.rank?di(ti(ti(t,Ma(di(g,[1,1,1,o.shape[0]]),h)),c),a.shape):di(ti(ti(t,g),c),a.shape)},mean:function(){var t=ti(ti(g,oi(-1)),m);return 1===o.rank&&(t=mi(t,l)),di(t,o.shape)},variance:function(){var t=ti(ti(v,d),m);return 1===o.rank&&(t=mi(t,l)),di(t,o.shape)},scale:function(){var e=ti(d,g),n=ti(t,e);return 1===o.rank&&(n=mi(n,l)),di(n,o.shape)},offset:function(){var e=t;return 1===o.rank&&(e=mi(e,l)),di(e,o.shape)}}}},Pa=Jr({stack_:function(t,e){void 0===e&&(e=0);var n=$r(t,"tensors","stack","string_or_numeric");an(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&an(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,i={axis:e};return Hr.runKernel(Be,r,i)}}),La=Jr({unsortedSegmentSum_:function(t,e,n){var r=Zr(t,"x","unsortedSegmentSum"),i=Zr(e,"segmentIds","unsortedSegmentSum","int32");an(un(n),(function(){return"numSegments must be of dtype int"}));var a={x:r,segmentIds:i},o={numSegments:n};return Hr.runKernel(Qe,a,o)}}),Ba={kernelName:De,inputsToSave:["x","indices"],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o=n.axis,s=n.batchDims,u=ln(o,i.shape)[0],c=function(t,e,n){return function(){var r=t.shape,i=e.size,a=r.slice(0,u),s=a.length,c=r.slice(o,r.length).slice(1),l=c.length,h=za(0,s),p=za(s+1,s+1+l),f=Ua([a,[i],c]),d=di(n,f),m=di(e,[i]),g=Ua([[s],h,p]),v=ba(d,g),y=La(v,m,t.shape[u]),b=pa(g);return ba(y,b)}};if(1===s){var l=i.shape[0],h=i.split(l,0);return{x:function(){var e=Pa(h.map((function(e,n){return c(e,a.slice(n,1),t.slice(n,1))()})));return e.reshape(i.shape)},indices:function(){return a}}}return{x:c(i,a,t),indices:function(){return a}}}};function za(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function Ua(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var Ga={kernelName:Me,inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1];return{a:function(){return vi(r)},b:function(){return vi(i)}}}},Wa={kernelName:Fe,gradFunc:function(t){return{x:function(){return Qr(t,"float32")}}}},Va={kernelName:"IsFinite",gradFunc:function(t){return{x:function(){return vi(t)}}}},ja={kernelName:"IsInf",gradFunc:function(t){return{x:function(){return vi(t)}}}},Ha={kernelName:"IsNan",gradFunc:function(t){return{x:function(){return vi(t)}}}},Xa=Jr({greater_:function(t,e){var n,r=Zr(t,"a","greater","string_or_numeric"),i=Zr(e,"b","greater","string_or_numeric");r=(n=p(zr(r,i),2))[0],i=n[1],fi(r.shape,i.shape);var a={a:r,b:i};return Hr.runKernel("Greater",a)}}),qa={kernelName:"LeakyRelu",inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.alpha,a=Xa(r,0);return{x:function(){return qi(a,t,ti(t,i))}}}},Ka={kernelName:"Log1p",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,wi(n,1))}}}},Ya={kernelName:"Log",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,Qr(n,"float32"))}}}},Za={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.axis;return{logits:function(){var e=ka(r);return ci(t,ti(mi(t,i,!0),e))}}}},$a=Jr({localResponseNormalizationBackprop_:function(t,e,n,r,i,a,o){void 0===r&&(r=5),void 0===i&&(i=1),void 0===a&&(a=1),void 0===o&&(o=.5);var s={x:t,y:e,dy:n},u={depthRadius:r,bias:i,alpha:a,beta:o};return Hr.runKernel("LRNGrad",s,u)}}),Ja={kernelName:"LRN",inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,c=n.beta;return{x:function(){return $a(i,a,t,o,s,u,c)}}}},Qa=Jr({equal_:function(t,e){var n,r=Zr(t,"a","equal","string_or_numeric"),i=Zr(e,"b","equal","string_or_numeric");r=(n=p(zr(r,i),2))[0],i=n[1],fi(r.shape,i.shape);var a={a:r,b:i};return Hr.runKernel("Equal",a)}});function to(t,e,n,r){return e.rank<n.rank&&(e=di(e,la(e.shape,r))),t.rank<n.rank&&(t=di(t,la(t.shape,r))),{x:function(){return ti(t,Qr(Qa(n,e),t.dtype))}}}var eo={kernelName:"Max",inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(t,e,n){var r=n.reductionIndices,i=e[0],a=to(t,e[1],i,ln(r,i.shape));return{x:function(){return a.x()}}}},no=Jr({less_:function(t,e){var n,r=Zr(t,"a","less","string_or_numeric"),i=Zr(e,"b","less","string_or_numeric");r=(n=p(zr(r,i),2))[0],i=n[1],fi(r.shape,i.shape);var a={a:r,b:i};return Hr.runKernel("Less",a)}}),ro={kernelName:Pe,inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1];return{a:function(){return ti(t,Qr(Wi(r,i),"float32"))},b:function(){return ti(t,Qr(no(r,i),"float32"))}}}},io=Jr({maxPool3dGrad_:function(t,e,n,r,i,a,o){var s=Zr(t,"dy","maxPool3dGrad"),u=Zr(e,"input","maxPool3dGrad"),c=Zr(n,"output","maxPool3dGrad"),l=s,h=u,p=c,f=!1;4===u.rank&&(f=!0,l=di(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),h=di(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=di(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),an(5===l.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")})),an(5===h.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")})),an(5===p.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(p.rank,".")})),Ci("maxPool3dGrad",a,o);var d={dy:l,input:h,output:p},m={filterSize:r,strides:i,pad:a,dimRoundingMode:o},g=Hr.runKernel("MaxPool3DGrad",d,m);return f?di(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),ao={kernelName:"MaxPool3D",inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o=n.filterSize,s=n.strides,u=n.pad,c=n.dimRoundingMode;return{x:function(){return io(t,i,a,o,s,u,c)}}}},oo=Jr({maxPoolGrad_:function(t,e,n,r,i,a,o){var s=Zr(t,"dy","maxPoolGrad"),u=Zr(e,"input","maxPoolGrad"),c=Zr(n,"output","maxPoolGrad");an(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")")})),an(4===s.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),an(4===u.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")})),Ci("maxPoolGrad",a,o);var l={dy:s,input:u,output:c},h={filterSize:r,strides:i,pad:a,dimRoundingMode:o};return Hr.runKernel("MaxPoolGrad",l,h)}}),so={kernelName:"MaxPool",inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(t,e,n){var r=p(e,2),i=r[0],a=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return oo(t,i,a,o,s,u)}}}};function uo(t,e){if(void 0===e&&(e="float32"),xn(t),"complex64"===e){var n=uo(t,"float32"),r=uo(t,"float32");return ga(n,r)}var i=bn(on(t),e);return Hr.makeTensor(i,t,e)}function co(t,e){if(void 0===e&&(e="float32"),xn(t),"complex64"===e){var n=co(t,"float32"),r=uo(t,"float32");return ga(n,r)}var i=yn(on(t),e);return Hr.makeTensor(i,t,e)}var lo={kernelName:"Mean",inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=ln(n.axis,r.shape),a=function(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}(r.shape,i),o=on(a[1]);return{x:function(){var e=r.shape.slice();i.forEach((function(t){e[t]=1}));var n=di(t,e);return ii(ti(n,co(r.shape,"float32")),o)}}}},ho={kernelName:"Min",inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(t,e,n){var r=n.axis,i=p(e,2),a=i[0],o=to(t,i[1],a,ln(r,a.shape));return{x:function(){return o.x()}}}},po={kernelName:"Minimum",inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1];return{a:function(){return ti(t,Qr(Vi(r,i),"float32"))},b:function(){return ti(t,Qr(Xa(r,i),"float32"))}}}},fo=Jr({slice_:function(t,e,n){var r=Zr(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var i={x:r},a={begin:e,size:n};return Hr.runKernel(je,i,a)}}),mo={kernelName:"MirrorPad",inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],i=n.paddings.map((function(t){return t[0]}));return{x:function(){return fo(t,i,r.shape)}}}},go=Jr({floor_:function(t){var e={x:Zr(t,"x","floor","float32")};return Hr.runKernel(Re,e)}}),vo={kernelName:"Mod",inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=fi(r.shape,i.shape);return{a:function(){var e=pi(r.shape,a);return e.length>0?di(mi(t,e),r.shape):t},b:function(){var e=ti(t,ai(go(ii(r,i)))),n=pi(i.shape,a);return n.length>0?di(mi(e,n),i.shape):e}}}},yo={kernelName:Le,inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=fi(r.shape,i.shape);return{a:function(){var e=ti(t,Qr(i,"float32")),n=pi(r.shape,a);return n.length>0?di(mi(e,n),r.shape):e},b:function(){var e=ti(t,Qr(r,"float32")),n=pi(i.shape,a);return n.length>0?di(mi(e,n),i.shape):e}}}},bo={kernelName:"Neg",gradFunc:function(t){return{x:function(){return ai(t)}}}},xo={kernelName:"OneHot",inputsToSave:["indices"],gradFunc:function(t,e){var n=e[0];return{indices:function(){return uo(n.shape,"float32")}}}},wo={kernelName:"OnesLike",gradFunc:function(t){return{x:function(){return vi(t)}}}},_o=Jr({unstack_:function(t,e){void 0===e&&(e=0);var n=Zr(t,"x","unstack","string_or_numeric");an(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},i={axis:e};return Hr.runKernel(Je,r,i)}}),So={kernelName:Be,saveAllInputs:!0,gradFunc:function(t,e,n){var r=n.axis;return _o(t,r).map((function(t){return function(){return t}}))}},To={kernelName:ze,inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],i=n.paddings.map((function(t){return t[0]}));return{x:function(){return fo(t,i,r.shape)}}}},Eo=Jr({log_:function(t){var e={x:Zr(t,"x","log","float32")};return Hr.runKernel("Log",e)}}),ko=Jr({pow_:function(t,e){var n,r=Zr(t,"base","pow"),i=Zr(e,"exp","pow"),a={a:r=(n=p(zr(r,i),2))[0],b:i=n[1]};return Hr.runKernel("Pow",a)}}),Io={kernelName:"Pow",inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(t,e){var n=p(e,3),r=n[0],i=n[1],a=n[2],o=r,s=i,u=fi(o.shape,s.shape);return{a:function(){var e=Qr(s,"float32"),n=ti(t,ti(e,ko(o,ci(e,oi(1))))),r=pi(o.shape,u);return r.length>0&&(n=mi(n,r)),di(n,o.shape)},b:function(){var e=Xa(o,0),n=qi(e,Eo(o),vi(o)),r=ti(t,ti(a,n)),i=pi(s.shape,u);return i.length>0&&(r=mi(r,i)),di(r,s.shape)}}}},Ao={kernelName:"Prelu",inputsToSave:["x","alpha"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=Xa(r,0);return{x:function(){return qi(a,t,ti(t,i))},alpha:function(){var e=qi(a,vi(t),ti(t,r)),n=pi(i.shape,t.shape);return n.length>0&&(e=mi(e,n)),di(e,i.shape)}}}},No=En();No.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),No.registerFlag("IS_BROWSER",(function(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope})),No.registerFlag("IS_NODE",(function(){return void 0!==e&&void 0!==e.versions&&void 0!==e.versions.node})),No.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),No.registerFlag("IS_SAFARI",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)})),No.registerFlag("PROD",(function(){return!1})),No.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return No.getBool("DEBUG")})),No.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),No.registerFlag("IS_TEST",(function(){return!1})),No.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return No.getBool("DEBUG")})),No.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),No.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),No.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var Co=function(){function t(t){if(this.shards=[],this.previousShardIndex=0,null!=t&&(t instanceof Array||(t=[t]),0!==(t=t.map((function(t){return dr(t)?t.buffer:t}))).length)){this.bufferUniformSize=t[0].byteLength;for(var e=0,n=0;n<t.length;n++){var r=t[n];n!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);var i=e+r.byteLength;this.shards.push({buffer:r,start:e,end:i}),e=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}}return t.join=function(e){return new t(e).slice()},t.prototype.slice=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=this.byteLength),0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),(e=Math.min(this.byteLength,e))<=t)return new ArrayBuffer(0);var n=this.findShardForByte(t);if(-1===n)throw new Error("Could not find start shard for byte ".concat(t));for(var r=new ArrayBuffer(e-t),i=new Uint8Array(r),a=0,o=n;o<this.shards.length;o++){var s=this.shards[o],u=t+a-s.start,c=a,l=Math.min(e,s.end)-s.start,h=new Uint8Array(s.buffer,u,l-u);if(i.set(h,c),a+=h.length,e<s.end)break}return r},t.prototype.findShardForByte=function(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(e){return t<e.start?-1:t>=e.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;var n=function(t,e){for(var n=0,r=t.length;n<=r;){var i=Math.floor((r-n)/2)+n,a=e(t[i]);if(0===a)return i;a<0?r=i:n=i+1}return-1}(this.shards,e);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)},t}(),Ro=void 0!==i&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Oo(t){return Ro?i.byteLength(t,"utf8"):new Blob([t]).size}function Do(t,e){var n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(n.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function Mo(t,e,n){var r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(r.initializerSignature=t.initializerSignature),r}function Fo(t,e){return c(this,void 0,void 0,(function(){var n,r,i;return l(this,(function(a){switch(a.label){case 0:return null==t.weightsManifest?[3,2]:[4,e(t.weightsManifest)];case 1:i=p.apply(void 0,[a.sent(),2]),n=i[0],r=i[1],a.label=2;case 2:return[2,Mo(t,n,r)]}}))}))}function Po(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Oo(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Oo(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:new Co(t.weightData).byteLength}}function Lo(t){var e,n,r=[];try{for(var i=h(t),a=i.next();!a.done;a=i.next()){var o=a.value;r.push.apply(r,f([],p(o.weights),!1))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}var Bo=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),zo="models_store",Uo="model_info_store",Go=function(){function t(t){if(this.indexedDB=function(){if(!En().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return function(t){var e=t.result;e.createObjectStore(zo,{keyPath:"modelPath"}),e.createObjectStore(Uo,{keyPath:"modelPath"})}(i)},i.onsuccess=function(){var a=i.result;if(null==e){var o=a.transaction(zo,"readonly"),s=o.objectStore(zo).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return a.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return a.close(),r(s.error)},o.oncomplete=function(){return a.close()}}else{e.weightData=Co.join(e.weightData);var u,c,l=Po(e),h=a.transaction(Uo,"readwrite"),p=h.objectStore(Uo);try{u=p.put({modelPath:n.modelPath,modelArtifactsInfo:l})}catch(t){return r(t)}u.onsuccess=function(){var i,o=(c=a.transaction(zo,"readwrite")).objectStore(zo);try{i=o.put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:l})}catch(t){return r(t)}i.onsuccess=function(){return t({modelArtifactsInfo:l})},i.onerror=function(t){var e=(p=h.objectStore(Uo)).delete(n.modelPath);e.onsuccess=function(){return a.close(),r(i.error)},e.onerror=function(t){return a.close(),r(i.error)}}},u.onerror=function(t){return a.close(),r(u.error)},h.oncomplete=function(){null==c?a.close():c.oncomplete=function(){return a.close()}}}},i.onerror=function(t){return r(i.error)}}))},t}();Go.URL_SCHEME="indexeddb://";var Wo=function(t){return En().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Go.URL_SCHEME)?(e=t.slice(Go.URL_SCHEME.length),new Go(e)):null;var e};Bo.registerSaveRouter(Wo),Bo.registerLoadRouter(Wo);var Vo="/",jo="tensorflowjs_models",Ho="info",Xo="model_topology",qo="weight_specs",Ko="weight_data",Yo="model_metadata",Zo=function(){function t(t){if(!En().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");var e;this.modelPath=t,this.keys=(e=this.modelPath,{info:[jo,e,Ho].join(Vo),topology:[jo,e,Xo].join(Vo),weightSpecs:[jo,e,qo].join(Vo),weightData:[jo,e,Ko].join(Vo),modelMetadata:[jo,e,Yo].join(Vo)})}return t.prototype.save=function(t){return c(this,void 0,void 0,(function(){var e,n,r,a,o;return l(this,(function(s){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Po(t),a=Co.join(t.weightData);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(Ro)return i.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(a)),o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),[2,{modelArtifactsInfo:r}]}catch(t){throw function(t){var e,n;try{for(var r=h(Object.values(t)),i=r.next();!i.done;i=r.next()){var a=i.value;window.localStorage.removeItem(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(r.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(r.weightSpecsBytes,", ")+"weightDataBytes=".concat(r.weightDataBytes,"."))}return[2]}))}))},t.prototype.load=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,a,o,s;return l(this,(function(u){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");if(e.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(a),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy,null!=o.signature&&(e.signature=o.signature),null!=o.userDefinedMetadata&&(e.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(e.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(e.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(e.trainingConfig=o.trainingConfig)),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return e.weightData=function(t){if(Ro){var e=i.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),[2,e]}))}))},t}();Zo.URL_SCHEME="localstorage://";var $o=function(t){return En().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Zo.URL_SCHEME)?(e=t.slice(Zo.URL_SCHEME.length),new Zo(e)):null;var e};function Jo(t){return new Promise((function(t){return setTimeout(t)})).then(t)}Bo.registerSaveRouter($o),Bo.registerLoadRouter($o);var Qo=function(){function t(e){if(!En().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,a,o,s;return l(this,(function(u){switch(u.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=Co.join(t.weightData),n=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i=Do(t,r),a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,o.href=a,[4,Jo((function(){return o.dispatchEvent(new MouseEvent("click"))}))];case 2:return u.sent(),null==t.weightData?[3,4]:((s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Jo((function(){return s.dispatchEvent(new MouseEvent("click"))}))]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Po(t)}]}}))}))},t}();function ts(t,e,n,r){!function(t){an(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){an(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t)})),an(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e)})),an(e>=t,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)}))}(n=n??0,r=r??1);var i=0;return Promise.all(t.map((function(a){return a.then((function(a){var o=n+ ++i/t.length*(r-n);return e(o),a})),a})))}function es(t,e){return c(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,c,h;return l(this,(function(l){switch(l.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?En().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,a=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=l.sent(),[3,4];case 2:return[4,ts(r,e.onProgress,i,a)];case 3:o=l.sent(),l.label=4;case 4:return s=o.map((function(t){return t.arrayBuffer()})),u=.5,c=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return h=l.sent(),[3,8];case 6:return[4,ts(s,e.onProgress,u,c)];case 7:h=l.sent(),l.label=8;case 8:return[2,h]}}))}))}Qo.URL_SCHEME="downloads://",Bo.registerSaveRouter((function(t){return En().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Qo.URL_SCHEME)?function(t){return void 0===t&&(t="model"),new Qo(t)}(t.slice(Qo.URL_SCHEME.length)):null}));var ns=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(an("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=En().platform.fetch,an(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&an(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}return t.prototype.save=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,a;return l(this,(function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=Do(t,n),e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&(i=Co.join(t.weightData),e.body.append("model.weights.bin",new Blob([i],{type:"application/octet-stream"}),"model.weights.bin")),[4,this.fetch(this.path,e)];case 1:if((a=o.sent()).ok)return[2,{modelArtifactsInfo:Po(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(a.status,"."))}}))}))},t.prototype.loadModelJSON=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,i;return l(this,(function(a){switch(a.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=a.sent()).ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");a.label=2;case 2:return a.trys.push([2,4,,5]),[4,t.json()];case 3:return e=a.sent(),[3,5];case 4:throw a.sent(),n="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=e.modelTopology,i=e.weightsManifest,null==r&&null==i)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return[2,e]}}))}))},t.prototype.load=function(){return c(this,void 0,void 0,(function(){var t=this;return l(this,(function(e){switch(e.label){case 0:return this.loadOptions.streamWeights?[2,this.loadStream()]:[4,this.loadModelJSON()];case 1:return[2,Fo(e.sent(),(function(e){return t.loadWeights(e)}))]}}))}))},t.prototype.loadStream=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,i=this;return l(this,(function(a){switch(a.label){case 0:return[4,this.loadModelJSON()];case 1:return t=a.sent(),[4,this.getWeightUrls(t.weightsManifest)];case 2:return e=a.sent(),n=Lo(t.weightsManifest),r=function(){return function(t,e){var n,r,i=this,a=null==e.fetchFunc?En().platform.fetch:e.fetchFunc,o=0;return null===(n=e.onProgress)||void 0===n||n.call(e,0),new ReadableStream({pull:function(n){return c(i,void 0,void 0,(function(){var i,s,u,c,h;return l(this,(function(l){switch(l.label){case 0:return o<t.length?r?[3,2]:[4,a(t[o],e.requestInit,{isBinary:!0})]:[3,4];case 1:s=l.sent().body,r=s.getReader(),l.label=2;case 2:return[4,r.read()];case 3:return u=l.sent(),c=u.done,h=u.value,c?(o++,r=void 0,null===(i=e.onProgress)||void 0===i||i.call(e,o/t.length),[3,0]):(n.enqueue(h),[2]);case 4:return n.close(),[2]}}))}))}})}(e,i.loadOptions)},[2,Object.assign(Object.assign({},t),{weightSpecs:n,getWeightStream:r})]}}))}))},t.prototype.getWeightUrls=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,u,c,d,m,g,v,y,b,x,w,_,S,T,E;return l(this,(function(l){switch(l.label){case 0:e=Array.isArray(this.path)?this.path[1]:this.path,n=p(function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),2),r=n[0],i=n[1],a=this.weightPathPrefix||r,o=[],s=[];try{for(u=h(t),c=u.next();!c.done;c=u.next()){d=c.value;try{for(T=void 0,m=h(d.paths),g=m.next();!g.done;g=m.next())v=g.value,null!=this.weightUrlConverter?s.push(this.weightUrlConverter(v)):o.push(a+v+i)}catch(t){T={error:t}}finally{try{g&&!g.done&&(E=m.return)&&E.call(m)}finally{if(T)throw T.error}}}}catch(t){_={error:t}}finally{try{c&&!c.done&&(S=u.return)&&S.call(u)}finally{if(_)throw _.error}}return this.weightUrlConverter?(b=(y=o.push).apply,x=[o],w=[[]],[4,Promise.all(s)]):[3,2];case 1:b.apply(y,x.concat([f.apply(void 0,w.concat([p.apply(void 0,[l.sent()]),!1]))])),l.label=2;case 2:return[2,o]}}))}))},t.prototype.loadWeights=function(t){return c(this,void 0,void 0,(function(){var e,n,r;return l(this,(function(i){switch(i.label){case 0:return[4,this.getWeightUrls(t)];case 1:return e=i.sent(),n=Lo(t),[4,es(e,this.loadOptions)];case 2:return r=i.sent(),[2,[n,r]]}}))}))},t}();function rs(t){return null!=t.match(ns.URL_SCHEME_REGEX)}ns.URL_SCHEME_REGEX=/^https?:\/\//;var is=function(t,e){return("undefined"!=typeof fetch||null!=e&&null!=e.fetchFunc)&&(Array.isArray(t)?t.every((function(t){return rs(t)})):rs(t))?function(t,e){return new ns(t,e)}(t,e):null};Bo.registerSaveRouter(is),Bo.registerLoadRouter(is);var as=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),os=Jr({abs_:function(t){var e=Zr(t,"x","abs");if("complex64"===e.dtype){var n={x:e};return Hr.runKernel(Se,n)}return n={x:e},Hr.runKernel("Abs",n)}}),ss=Jr({concat_:function(t,e){void 0===e&&(e=0),an(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=$r(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return Hi(n[0]);var r=n,i={axis:e};return Hr.runKernel(Te,r,i)}}),us=Jr({sigmoid_:function(t){var e={x:Zr(t,"x","sigmoid","float32")};return Hr.runKernel(Xe,e)}}),cs=Jr({batchToSpaceND_:function(t,e,n){var r=Zr(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));an(r.rank>=1+e.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(e.length)})),an(n.length===e.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length)})),an(r.shape[0]%i==0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(i)}));var a={x:r},o={blockShape:e,crops:n};return Hr.runKernel(we,a,o)}}),ls=Jr({cos_:function(t){var e={x:Zr(t,"x","cos","float32")};return Hr.runKernel("Cos",e)}}),hs=Jr({cosh_:function(t){var e={x:Zr(t,"x","cosh","float32")};return Hr.runKernel(Ie,e)}}),ps=Jr({cumprod_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i={x:Zr(t,"x","cumprod")},a={axis:e,exclusive:n,reverse:r};return Hr.runKernel("Cumprod",i,a)}}),fs=Jr({expandDims_:function(t,e){void 0===e&&(e=0);var n=Zr(t,"x","expandDims","string_or_numeric");an(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},i={dim:e};return Hr.runKernel(Ce,r,i)}}),ds=Jr({gather_:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i={x:Zr(t,"x","gather"),indices:Zr(e,"indices","gather","int32")},a={axis:n,batchDims:r};return Hr.runKernel(De,i,a)}}),ms=Jr({logicalNot_:function(t){var e={x:Zr(t,"x","logicalNot","bool")};return Hr.runKernel("LogicalNot",e)}}),gs=Jr({maximum_:function(t,e){var n,r=Zr(t,"a","maximum"),i=Zr(e,"b","maximum");r=(n=p(zr(r,i),2))[0],i=n[1],"bool"===r.dtype&&(r=Qr(r,"int32"),i=Qr(i,"int32")),fi(r.shape,i.shape);var a={a:r,b:i};return Hr.runKernel(Pe,a)}}),vs=Jr({pad_:function(t,e,n){void 0===n&&(n=0);var r=Zr(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:n},a={x:r};return Hr.runKernel(ze,a,i)}}),ys={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197;return function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var i=new n(t),a=e&&e.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)}(ys);var bs=ys.exports,xs={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)}(xs);var ws=xs.exports,_s={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)}(_s);var Ss=_s.exports,Ts={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.x&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)}(Ts);var Es=Ts.exports,ks={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.X&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)}(ks);var Is=ks.exports,As={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)}(As);var Ns=As.exports,Cs={exports:{}},Rs=function(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){if(this instanceof t){var n=[null];return n.push.apply(n,arguments),new(Function.bind.apply(e,n))}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}({__proto__:null,default:{}});!function(t){!function(e,n,r){var i,a=256,o="random",s=r.pow(a,6),u=r.pow(2,52),c=2*u,l=a-1;function h(t,l,h){var v=[],y=m(d((l=1==l?{entropy:!0}:l||{}).entropy?[t,g(n)]:t??function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(t){var r=e.navigator,o=r&&r.plugins;return[+new Date,e,o,e.screen,g(n)]}}(),3),v),b=new p(v),x=function(){for(var t=b.g(6),e=s,n=0;t<u;)t=(t+n)*a,e*=a,n=b.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,m(g(b.S),n),(l.pass||h||function(t,e,n,i){return i&&(i.S&&f(i,b),t.state=function(){return f(b,{})}),n?(r[o]=t,e):t})(x,y,"global"in l?l.global:this==r,l.state)}function p(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=l&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=l&i+1],n=n*a+s[l&(s[i]=s[o=l&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(d(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[l&i]=l&(n^=19*e[l&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(m(r.random(),n),t.exports){t.exports=h;try{i=Rs}catch(t){}}else r["seed"+o]=h}("undefined"!=typeof self?self:Pn,[],Math)}(Cs);var Os=bs,Ds=ws,Ms=Ss,Fs=Es,Ps=Is,Ls=Ns,Bs=Cs.exports;Bs.alea=Os,Bs.xor128=Ds,Bs.xorwow=Ms,Bs.xorshift7=Fs,Bs.xor4096=Ps,Bs.tychei=Ls;var zs,Us=Jr({reverse_:function(t,e){var n={x:Zr(t,"x","reverse")},r={dims:e};return Hr.runKernel(Ge,n,r)}});Jr({tensorScatterUpdate_:function(t,e,n){var r=Zr(t,"tensor","tensorScatterupdate"),i=Zr(e,"indices","tensorScatterupdate","int32"),a=Zr(n,"updates","tensorScatterupdate");if(function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(i,".");if(n.rank<i)throw new Error(a+" update.rank < ".concat(i,". "));if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < ".concat(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != ".concat(i+t.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==t[o+r])throw new Error(a+" updates.shape[".concat(o+i,"] (").concat(n.shape[o+i],") != shape[").concat(o+i,"] (").concat(t[o+i],")"))}(n,e,t)}(a,i,r.shape),r.dtype!==a.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(a.dtype,"."));var o={tensor:r,indices:i,updates:a};return Hr.runKernel("TensorScatterUpdate",o,{})}}),function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(zs||(zs={}));var Gs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,a=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:a[t.name]}}));this.applyGradients(o)}else this.applyGradients(a);return ma(a),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!1,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return function(t,e){an(dn(t),(function(){return"The f passed in variableGrads(f) must be a function"})),an(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof Fr})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],Hr.registeredVariables)e.push(Hr.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,a=e.length;an((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable."}));var o=Hr.gradients(t,e,null,!0),s=o.value,u=o.grads;an(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),an(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&ma(this.iterations_)},e.prototype.saveIterations=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:oi(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}))}))},e.prototype.extractIterations=function(t){return c(this,void 0,void 0,(function(){var e;return l(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(as);Object.defineProperty(Gs,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}}),function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=Hr.backend.epsilon()),i}u(e,t),Object.defineProperty(e,"className",{get:function(){return"Adadelta"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Hr.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:da((function(){return vi(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:da((function(){return vi(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;da((function(){var t=wi(ti(o,e.rho),ti(ui(a),1-e.rho)),n=ti(ii(si(wi(s,e.epsilon)),si(wi(o,e.epsilon))),a),r=wi(ti(s,e.rho),ti(ui(n),1-e.rho));o.assign(t),s.assign(r);var u=wi(ti(n,-e.learningRate),i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(ma(this.accumulatedGrads.map((function(t){return t.variable}))),ma(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return t=f(f([],p(this.accumulatedGrads),!1),p(this.accumulatedUpdates),!1),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){var e;return l(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=t.length/2,this.accumulatedGrads=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}(Gs),function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}u(e,t),Object.defineProperty(e,"className",{get:function(){return"Adagrad"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Hr.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:da((function(){return function(t,e,n){xn(t);var r={shape:t,value:e,dtype:n=n||fn(e)};return Hr.runKernel("Fill",{},r)}(i.shape,e.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable;da((function(){var t=wi(o,ui(a));o.assign(t);var n=wi(ti(ii(a,si(wi(t,Hr.backend.epsilon()))),-e.learningRate),i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&ma(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}(Gs),function(t){function e(e,n,r,i){void 0===i&&(i=null);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],da((function(){a.accBeta1=oi(n).variable(),a.accBeta2=oi(r).variable()})),null==i&&(a.epsilon=Hr.backend.epsilon()),a}u(e,t),Object.defineProperty(e,"className",{get:function(){return"Adam"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);da((function(){var r=ci(1,e.accBeta1),i=ci(1,e.accBeta2);n.forEach((function(n,a){var o=Hr.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:"".concat(n,"/m"),variable:da((function(){return vi(o).variable(!1)}))}),null==e.accumulatedSecondMoment[a]&&(e.accumulatedSecondMoment[a]={originalName:"".concat(n,"/v"),variable:da((function(){return vi(o).variable(!1)}))});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedSecondMoment[a].variable,l=wi(ti(u,e.beta1),ti(s,1-e.beta1)),h=wi(ti(c,e.beta2),ti(ui(s),1-e.beta2)),p=ii(l,r),f=ii(h,i);u.assign(l),c.assign(h);var d=wi(ti(ii(p,wi(si(f),e.epsilon)),-e.learningRate),o);o.assign(d)}})),e.accBeta1.assign(ti(e.accBeta1,e.beta1)),e.accBeta2.assign(ti(e.accBeta2,e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&ma(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&ma(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return t=f(f([],p(this.accumulatedFirstMoment),!1),p(this.accumulatedSecondMoment),!1),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){var e,n=this;return l(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),da((function(){n.accBeta1.assign(ko(n.beta1,n.iterations_+1)),n.accBeta2.assign(ko(n.beta2,n.iterations_+1))})),e=t.length/2,this.accumulatedFirstMoment=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}(Gs),function(t){function e(e,n,r,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.decay=a,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],da((function(){o.iteration=oi(0).variable(),o.accBeta1=oi(n).variable()})),null==i&&(o.epsilon=Hr.backend.epsilon()),o}u(e,t),Object.defineProperty(e,"className",{get:function(){return"Adamax"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);da((function(){var r=ci(1,e.accBeta1),i=ii(-e.learningRate,wi(ti(e.iteration,e.decay),1));n.forEach((function(n,a){var o=Hr.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:"".concat(n,"/m"),variable:vi(o).variable(!1)}),null==e.accumulatedWeightedInfNorm[a]&&(e.accumulatedWeightedInfNorm[a]={originalName:"".concat(n,"/v"),variable:vi(o).variable(!1)});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedWeightedInfNorm[a].variable,l=wi(ti(u,e.beta1),ti(s,1-e.beta1)),h=ti(c,e.beta2),p=os(s),f=gs(h,p);u.assign(l),c.assign(f);var d=wi(ti(ii(i,r),ii(l,wi(f,e.epsilon))),o);o.assign(d)}})),e.iteration.assign(wi(e.iteration,1)),e.accBeta1.assign(ti(e.accBeta1,e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&ma(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&ma(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}(Gs);var Ws,Vs=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return u(e,t),Object.defineProperty(e,"className",{get:function(){return"SGD"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var a=Hr.registeredVariables[n];da((function(){var t=wi(ti(e.c,i),a);a.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){var e;this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=(e=oi(-t),Hr.keep(e))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e}(Gs);!function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=oi(i.momentum),i}u(e,t),Object.defineProperty(e,"className",{get:function(){return"Momentum"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Hr.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:da((function(){return vi(i).variable(!1)}))});var a=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&da((function(){var t,n=wi(ti(e.m,a),o);t=e.useNesterov?wi(ti(e.c,wi(o,ti(n,e.m))),i):wi(ti(e.c,n),i),a.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&ma(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}(Vs),function(t){function e(e,n,r,i,a){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===a&&(a=!1);var o=t.call(this)||this;if(o.learningRate=e,o.decay=n,o.momentum=r,o.epsilon=i,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=a,null==i&&(o.epsilon=Hr.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}u(e,t),Object.defineProperty(e,"className",{get:function(){return"RMSProp"},enumerable:!1,configurable:!0}),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Hr.registeredVariables[n],a=!1;null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:da((function(){return vi(i).variable(a)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:da((function(){return vi(i).variable(a)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:da((function(){return vi(i).variable(a)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedMeanSquares[r].variable,u=e.accumulatedMoments[r].variable;da((function(){var t=wi(ti(s,e.decay),ti(ui(o),1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,a=wi(ti(n,e.decay),ti(o,1-e.decay)),c=ii(ti(o,e.learningRate),si(ci(t,wi(ui(a),e.epsilon)))),l=wi(ti(u,e.momentum),c);s.assign(t),n.assign(a),u.assign(l);var h=ci(i,l);i.assign(h)}else{var p=wi(ti(s,e.decay),ti(ui(o),1-e.decay));l=wi(ti(u,e.momentum),ii(ti(o,e.learningRate),si(wi(p,e.epsilon)))),s.assign(p),u.assign(l),h=ci(i,l),i.assign(h)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&ma(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&ma(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&ma(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return c(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return t=f(f([],p(this.accumulatedMeanSquares),!1),p(this.accumulatedMoments),!1),this.centered&&t.push.apply(t,f([],p(this.accumulatedMeanGrads),!1)),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return c(this,void 0,void 0,(function(){var e,n;return l(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),e=this.centered?t.length/3:t.length/2,n=!1,this.accumulatedMeanSquares=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(n)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(n)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(n)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}(Gs),"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(Ws||(Ws={}));var js,Hs,Xs,qs,Ks={kernelName:Ne,inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=fi(r.shape,i.shape);return{a:function(){var e=ii(t,Qr(i,"float32")),n=pi(r.shape,a);return n.length>0?di(mi(e,n),r.shape):e},b:function(){var e=ti(t,Qr(r,"float32")),n=pi(i.shape,a);n.length>0&&(e=di(mi(e,n),i.shape));var o=ui(i);return ai(ii(e,Qr(o,"float32")))}}}},Ys={kernelName:Ke,gradFunc:function(t,e,n){var r=n.blockShape,i=n.paddings;return{x:function(){return cs(t,r,i)}}}},Zs={kernelName:Ye,gradFunc:function(t,e,n){var r=n.axis;return{x:function(){return ss(t,r)}}}},$s={kernelName:"SquaredDifference",inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=oi(2);return{a:function(){return ti(t,ti(a,ci(r,i)))},b:function(){return ti(t,ti(a,ci(i,r)))}}}},Js={kernelName:"Sub",inputsToSave:["a","b"],gradFunc:function(t,e){var n=p(e,2),r=n[0],i=n[1],a=fi(r.shape,i.shape);return{a:function(){var e=t,n=pi(r.shape,a);return n.length>0&&(e=mi(e,n)),di(e,r.shape)},b:function(){var e=t,n=pi(i.shape,a);return n.length>0&&(e=mi(e,n)),di(ai(e),i.shape)}}}},Qs=[ni,li,hi,gi,{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(t,e){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}},yi,bi,xi,_i,Si,Ti,Ei,Oi,Mi,Pi,Bi,zi,Ui,Gi,Ki,Yi,$i,na,ta,aa,sa,ca,xa,Sa,Ta,Ks,Ea,Ia,Aa,Na,Ca,Oa,Ra,Fa,Ba,Ga,Wa,Va,ja,Ha,qa,Ka,Ya,Za,Ja,eo,eo,ro,ao,so,lo,ho,po,mo,vo,yo,bo,xo,wo,So,To,To,Io,Ao,{kernelName:"Prod",inputsToSave:["x"],gradFunc:function(t,e,n){var r,i=p(e,1)[0],a=n.axis;return r=null==a?i.shape.map((function(t,e){return e})):"number"==typeof a?[a]:a,{x:function(){return function(t,e,n){var r=t.shape.length,i=r-n.length,a=ha(n,r),o=t;null!=a&&(o=ba(t,a));var s=o.shape.slice(),u=s.splice(r-n.length,n.length).reduce((function(t,e){return t*e}),1);s.push(u);var c=function(t,e,n){var r=t.shape.slice();r[n]=1;var i=di(e,r),a=ps(t,n,!0,!1),o=ps(t,n,!0,!0),s=ti(a,o);return ti(i,s)}(o.reshape(s),e,i);if(c=c.reshape(o.shape),null!=a){var l=pa(a);c=ba(c,l)}return c}(i,t,r)}}}},{kernelName:"Reciprocal",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,ai(ui(n)))}}}},{kernelName:"Relu6",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0],r=ti(Vi(n,6),ei(n));return{x:function(){return ti(t,Qr(r,"float32"))}}}},{kernelName:"Relu",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(t,Qr(ei(n),"float32"))}}}},{kernelName:Ue,inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return di(t,n.shape)}}}},{kernelName:"ResizeBilinear",inputsToSave:["images"],gradFunc:function(t,e,n){var r={dy:t,images:p(e,1)[0]};return{images:function(){return Hr.runKernel("ResizeBilinearGrad",r,n)}}}},{kernelName:"ResizeNearestNeighbor",inputsToSave:["images"],gradFunc:function(t,e,n){var r={dy:t,images:p(e,1)[0]};return{images:function(){return Hr.runKernel("ResizeNearestNeighborGrad",r,n)}}}},{kernelName:Ge,gradFunc:function(t,e,n){var r=ln(n.dims,t.shape);return{x:function(){return Us(t,r)}}}},{kernelName:"Round",gradFunc:function(t){return{x:function(){return vi(t)}}}},{kernelName:We,inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ai(ii(t,ti(ko(n,1.5),2)))}}}},{kernelName:Ve,inputsToSave:["condition"],gradFunc:function(t,e){var n=p(e,1)[0];return{condition:function(){return Qr(vi(n),"float32")},t:function(){return ti(t,Qr(n,t.dtype))},e:function(){return ti(t,Qr(ms(n),t.dtype))}}}},{kernelName:"Selu",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){var e=Xa(n,oi(0)),r=oi(1.7580993408473768),i=oi(1.0507009873554805),a=ti(t,i),o=ti(ti(t,r),ka(Qr(n,"float32")));return qi(e,a,o)}}}},{kernelName:Xe,outputsToSave:[!0],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(t,ti(n,ci(oi(1),n)))}}}},{kernelName:"Sign",gradFunc:function(t){return{x:function(){return vi(t)}}}},{kernelName:"Sin",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(ls(Qr(n,"float32")),t)}}}},{kernelName:He,inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(hs(Qr(n,"float32")),t)}}}},{kernelName:je,inputsToSave:["x"],gradFunc:function(t,e,n){for(var r=p(e,1)[0],i=n.begin,a=n.size,o=r.shape,s=p(function(t,e,n){var r,i,a=t.shape.length;return(r="number"==typeof e?f([e],p(new Array(a-1).fill(0)),!1):e.length<a?e.concat(new Array(a-e.length).fill(0)):e.slice()).forEach((function(t){an(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(a).fill(-1):"number"==typeof n?f([n],p(new Array(a-1).fill(-1)),!1):n.length<a?n.concat(new Array(a-n.length).fill(-1)):n).map((function(e,n){return e>=0?e:(an(-1===e,(function(){return"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,".")})),t.shape[n]-r[n])})),[r,i]}(r,i,a),2),u=s[0],c=s[1],l=[],h=0;h<t.rank;h++)l.push([u[h],o[h]-u[h]-c[h]]);return{x:function(){return vs(t,l)}}}},{kernelName:"Softmax",outputsToSave:[!0],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.dim,a=ti(t,r);return{logits:function(){return ci(a,ti(mi(a,[i],!0),r))}}}},{kernelName:"Softplus",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(t,us(n))}}}},Ys,Ys,Zs,Zs,{kernelName:qe,inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,ti(si(Qr(n,"float32")),2))}}}},$s,{kernelName:"Square",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(t,ti(Qr(n,"float32"),2))}}}},{kernelName:en,gradFunc:function(t){return{x:function(){return vi(t)}}}},Js,{kernelName:"Sum",inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=r.shape.slice();ln(n.axis,r.shape).forEach((function(t){i[t]=1}));var a=di(t,i),o=ti(a,co(r.shape,"float32"));return{x:function(){return o}}}},{kernelName:"Tan",inputsToSave:["x"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ii(t,ui(ls(n)))}}}},{kernelName:"Tanh",outputsToSave:[!0],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return ti(ci(oi(1),ui(n)),t)}}}},{kernelName:Ze,inputsToSave:["x"],gradFunc:function(t,e,n){var r=p(e,1)[0],i=n.reps;return{x:function(){var e=vi(r);if(1===r.rank)for(var n=0;n<i[0];++n)e=wi(e,fo(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(n=0;n<i[0];++n)for(var a=0;a<i[1];++a)e=wi(e,fo(t,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(n=0;n<i[0];++n)for(a=0;a<i[1];++a)for(var o=0;o<i[2];++o)e=wi(e,fo(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(n=0;n<i[0];++n)for(a=0;a<i[1];++a)for(o=0;o<i[2];++o)for(var s=0;s<i[3];++s)e=wi(e,fo(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:$e,gradFunc:function(t,e,n){var r=pa(n.perm);return{x:function(){return ba(t,r)}}}},{kernelName:Je,gradFunc:function(t,e,n){var r=n.axis;return{value:function(){return Pa(t,r)}}}},{kernelName:Qe,inputsToSave:["segmentIds"],gradFunc:function(t,e){var n=p(e,1)[0];return{x:function(){return function(t,e){for(var n=gs(e,vi(e)),r=ds(t,n),i=Wi(e,oi(0,"int32")),a=r.rank-i.rank,o=0;o<a;++o)i=fs(i,o+1);i=ji(i,co(r.shape,"bool"));var s=vi(r);return qi(i,r,s)}(t,n)}}}},{kernelName:tn,gradFunc:function(t){return{x:function(){return vi(t)}}}}];try{for(var tu=h(Qs),eu=tu.next();!eu.done;eu=tu.next()){var nu=eu.value;void 0,qs=(Xs=nu).kernelName,On.has(qs)&&En().getBool("DEBUG")&&Cn("Overriding the gradient for '".concat(qs,"'")),On.set(qs,Xs)}}catch(t){js={error:t}}finally{try{eu&&!eu.done&&(Hs=tu.return)&&Hs.call(tu)}finally{if(js)throw js.error}}function ru(t,e){return a.tidy((function(){return o.sqrt(o.sum(o.mul(t,t),e,!0))}))}var iu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.getConfig=function(){return{}},e}(a.serialization.Serializable),au=function(t){function e(e){var n=t.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return u(e,t),e.prototype.apply=function(t){var e=this;return a.tidy((function(){var n=ru(t,e.axis),r=o.clipByValue(n,0,e.maxValue);return o.mul(t,o.div(r,o.add(ct(),n)))}))},e.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},e}(iu);au.className="MaxNorm",a.serialization.registerClass(au);var ou=function(t){function e(e){var n=t.call(this)||this;return n.defaultAxis=0,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return u(e,t),e.prototype.apply=function(t){var e=this;return a.tidy((function(){return o.div(t,o.add(ct(),ru(t,e.axis)))}))},e.prototype.getConfig=function(){return{axis:this.axis}},e}(iu);ou.className="UnitNorm",a.serialization.registerClass(ou);var su=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return o.relu(t)},e}(iu);su.className="NonNeg",a.serialization.registerClass(su);var uu=function(t){function e(e){var n=t.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=e.minValue?e.minValue:n.defaultMinValue,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.rate=null!=e.rate?e.rate:n.defaultRate,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return u(e,t),e.prototype.apply=function(t){var e=this;return a.tidy((function(){var n=ru(t,e.axis),r=o.add(o.mul(e.rate,o.clipByValue(n,e.minValue,e.maxValue)),o.mul(1-e.rate,n));return o.mul(t,o.div(r,o.add(ct(),n)))}))},e.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},e}(iu);uu.className="MinMaxNorm",a.serialization.registerClass(uu);var cu={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function lu(t){return A(t)}function hu(t,e){return void 0===e&&(e={}),C(t,a.serialization.SerializationMap.getMap().classNameMap,e,"constraint")}function pu(t){return null==t?null:"string"==typeof t?hu({className:t in cu?cu[t]:t,config:{}}):t instanceof iu?t:hu(t)}var fu,du={__proto__:null,maxNorm:function(t){return new au(t)},minMaxNorm:function(t){return new uu(t)},nonNeg:function(){return new su},unitNorm:function(t){return new ou(t)}},mu={__proto__:null,constant:function(t){return new Rt(t)},glorotNormal:function(t){return new Bt(t)},glorotUniform:function(t){return new Lt(t)},heNormal:function(t){return new zt(t)},heUniform:function(t){return new Ut(t)},identity:function(t){return new Ft(t)},leCunNormal:function(t){return new Gt(t)},leCunUniform:function(t){return new Wt(t)},ones:function(){return new Ct},orthogonal:function(t){return new Vt(t)},randomNormal:function(t){return new Dt(t)},randomUniform:function(t){return new Ot(t)},truncatedNormal:function(t){return new Mt(t)},varianceScaling:function(t){return new Pt(t)},zeros:function(){return new Nt}};function gu(t){return c(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c;return l(this,(function(l){switch(l.label){case 0:if(null==t)return[2];for(i in e=[],n=[],r=[],t)"number"!=typeof(o=t[i])&&(s=o,e.push(s.data()),n.push(i),r.push(s));return e.length>0?[4,Promise.all(e)]:[3,2];case 1:for(u=l.sent(),c=0;c<u.length;++c)t[n[c]]=u[c][0];a.dispose(r),l.label=2;case 2:return[2]}}))}))}function vu(t){if(null!=t)for(var e in t){var n=t[e];"number"!=typeof n&&n.dispose()}}!function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(fu||(fu={}));var yu=function(){function t(){this.validationData=null}return t.prototype.setParams=function(t){this.params=t},t.prototype.onEpochBegin=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2]}))}))},t.prototype.onEpochEnd=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2]}))}))},t.prototype.onBatchBegin=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2]}))}))},t.prototype.onBatchEnd=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2]}))}))},t.prototype.onTrainBegin=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2]}))}))},t.prototype.onTrainEnd=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2]}))}))},t.prototype.setModel=function(t){},t}(),bu=function(){function t(t,e){void 0===e&&(e=10),null==t&&(t=[]),this.callbacks=t,this.queueLength=e}return t.prototype.append=function(t){this.callbacks.push(t)},t.prototype.setParams=function(t){var e,n;try{for(var r=h(this.callbacks),i=r.next();!i.done;i=r.next())i.value.setParams(t)}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.setModel=function(t){var e,n;try{for(var r=h(this.callbacks),i=r.next();!i.done;i=r.next())i.value.setModel(t)}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.onEpochBegin=function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,a,o;return l(this,(function(s){switch(s.label){case 0:null==e&&(e={}),s.label=1;case 1:s.trys.push([1,6,7,8]),n=h(this.callbacks),r=n.next(),s.label=2;case 2:return r.done?[3,5]:[4,r.value.onEpochBegin(t,e)];case 3:s.sent(),s.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return i=s.sent(),a={error:i},[3,8];case 7:try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.onEpochEnd=function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,a,o;return l(this,(function(s){switch(s.label){case 0:null==e&&(e={}),s.label=1;case 1:s.trys.push([1,6,7,8]),n=h(this.callbacks),r=n.next(),s.label=2;case 2:return r.done?[3,5]:[4,r.value.onEpochEnd(t,e)];case 3:s.sent(),s.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return i=s.sent(),a={error:i},[3,8];case 7:try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.onBatchBegin=function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,a,o;return l(this,(function(s){switch(s.label){case 0:null==e&&(e={}),s.label=1;case 1:s.trys.push([1,6,7,8]),n=h(this.callbacks),r=n.next(),s.label=2;case 2:return r.done?[3,5]:[4,r.value.onBatchBegin(t,e)];case 3:s.sent(),s.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return i=s.sent(),a={error:i},[3,8];case 7:try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.onBatchEnd=function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,a,o;return l(this,(function(s){switch(s.label){case 0:null==e&&(e={}),s.label=1;case 1:s.trys.push([1,6,7,8]),n=h(this.callbacks),r=n.next(),s.label=2;case 2:return r.done?[3,5]:[4,r.value.onBatchEnd(t,e)];case 3:s.sent(),s.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return i=s.sent(),a={error:i},[3,8];case 7:try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.onTrainBegin=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,a;return l(this,(function(o){switch(o.label){case 0:null==t&&(t={}),o.label=1;case 1:o.trys.push([1,6,7,8]),e=h(this.callbacks),n=e.next(),o.label=2;case 2:return n.done?[3,5]:[4,n.value.onTrainBegin(t)];case 3:o.sent(),o.label=4;case 4:return n=e.next(),[3,2];case 5:return[3,8];case 6:return r=o.sent(),i={error:r},[3,8];case 7:try{n&&!n.done&&(a=e.return)&&a.call(e)}finally{if(i)throw i.error}return[7];case 8:return[2]}}))}))},t.prototype.onTrainEnd=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,a;return l(this,(function(o){switch(o.label){case 0:null==t&&(t={}),o.label=1;case 1:o.trys.push([1,6,7,8]),e=h(this.callbacks),n=e.next(),o.label=2;case 2:return n.done?[3,5]:[4,n.value.onTrainEnd(t)];case 3:o.sent(),o.label=4;case 4:return n=e.next(),[3,2];case 5:return[3,8];case 6:return r=o.sent(),i={error:r},[3,8];case 7:try{n&&!n.done&&(a=e.return)&&a.call(e)}finally{if(i)throw i.error}return[7];case 8:return[2]}}))}))},t}(),xu=function(t){function e(){return t.call(this)||this}return u(e,t),e.prototype.onEpochBegin=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){return this.seen=0,this.totals={},[2]}))}))},e.prototype.onBatchEnd=function(t,e){return c(this,void 0,void 0,(function(){var t,n,r,i,o=this;return l(this,(function(s){for(i in null==e&&(e={}),t=null==e.size?0:e.size,this.seen+=t,n=function(n){var i=e[n];if("number"==typeof i)r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+i*t;else{var s=void 0;n in r.totals?s=r.totals[n]:r.totals[n]=0;var u=a.tidy((function(){return a.add(o.totals[n],a.mul(i,t))}));r.totals[n]=u,null!=s&&s.dispose()}},r=this,e)n(i);return[2]}))}))},e.prototype.onEpochEnd=function(t,e){return c(this,void 0,void 0,(function(){var t,n,r,i,o,s,u,c=this;return l(this,(function(l){if(null!=e){t=function(t){if(null==n.totals[t])return"continue";"number"==typeof n.totals[t]?e[t]=n.totals[t]/n.seen:a.tidy((function(){var n=a.mul(a.div(1,c.seen),c.totals[t]);e[t]=n,c.totals[t].dispose(),a.keep(e[t])}))},n=this;try{for(r=h(this.params.metrics),i=r.next();!i.done;i=r.next())o=i.value,t(o)}catch(t){s={error:t}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}}return[2]}))}))},e}(yu),wu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.onTrainBegin=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){return this.epoch=[],this.history={},[2]}))}))},e.prototype.onEpochEnd=function(t,e){return c(this,void 0,void 0,(function(){var n;return l(this,(function(r){for(n in null==e&&(e={}),this.epoch.push(t),e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n]);return[2]}))}))},e.prototype.syncData=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,i,a,o,s,u;return l(this,(function(c){switch(c.label){case 0:for(r in t=[],e=[],n=[],this.history)for(i=this.history[r],a=0;a<i.length;++a)"number"!=typeof i[a]&&(o=i[a],t.push(o.data()),e.push(r),n.push(a));return[4,Promise.all(t)];case 1:for(s=c.sent(),u=0;u<s.length;++u)this.history[e[u]][n[u]].dispose(),this.history[e[u]][n[u]]=s[u][0];return[2]}}))}))},e}(yu),_u=function(t){function e(e,n){var r,i,o,s,u,c=t.call(this)||this;if(c.currentEpoch=0,c.nowFunc=e.nowFunc,c.nextFrameFunc=e.nextFrameFunc||a.nextFrame,c.yieldEvery=n||"auto","auto"===c.yieldEvery&&(c.yieldEvery=125),"never"===c.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return a.util.isNumber(c.yieldEvery)&&(c.maybeWait=(r=c.maybeWait.bind(c),i=c.yieldEvery,o=c.nowFunc,u=null!=o?o():a.util.now(),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null!=o?o():a.util.now();return n-u<i?s:(u=n,s=r.apply(void 0,f([],p(t),!1)))})),c.trainBegin=e.onTrainBegin,c.trainEnd=e.onTrainEnd,c.epochBegin=e.onEpochBegin,c.epochEnd=e.onEpochEnd,c.batchBegin=e.onBatchBegin,c.batchEnd=e.onBatchEnd,c.yield=e.onYield,c}return u(e,t),e.prototype.maybeWait=function(t,e,n){return c(this,void 0,void 0,(function(){var r;return l(this,(function(i){switch(i.label){case 0:return r=[],null==this.yield?[3,2]:[4,gu(n)];case 1:i.sent(),r.push(this.yield(t,e,n)),i.label=2;case 2:return r.push(this.nextFrameFunc()),[4,Promise.all(r)];case 3:return i.sent(),[2]}}))}))},e.prototype.onEpochBegin=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(n){switch(n.label){case 0:return this.currentEpoch=t,null==this.epochBegin?[3,3]:[4,gu(e)];case 1:return n.sent(),[4,this.epochBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onEpochEnd=function(t,e){return c(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return n=[],null==this.epochEnd?[3,2]:[4,gu(e)];case 1:r.sent(),n.push(this.epochEnd(t,e)),r.label=2;case 2:return"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onBatchBegin=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,gu(e)];case 1:return n.sent(),[4,this.batchBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onBatchEnd=function(t,e){return c(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return n=[],null==this.batchEnd?[3,2]:[4,gu(e)];case 1:r.sent(),n.push(this.batchEnd(t,e)),r.label=2;case 2:return"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):a.util.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onTrainBegin=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return null==this.trainBegin?[3,3]:[4,gu(t)];case 1:return e.sent(),[4,this.trainBegin(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e.prototype.onTrainEnd=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return null==this.trainEnd?[3,3]:[4,gu(t)];case 1:return e.sent(),[4,this.trainEnd(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e}(yu);function Su(t,e){return null==t&&(t={}),t instanceof yu?[t]:Array.isArray(t)&&t[0]instanceof yu?t:T(t).map((function(t){return new _u(t,e)}))}var Tu=function(){function t(){}return t.registerCallbackConstructor=function(e,n){a.util.assert(e>=0&&Number.isInteger(e),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e)})),t.checkForDuplicate(n),null==t.constructors[e]&&(t.constructors[e]=[]),t.constructors[e].push(n)},t.checkForDuplicate=function(e){for(var n in t.constructors)t.constructors[+n].forEach((function(t){if(t===e)throw new g("Duplicate callback constructor.")}))},t.clear=function(){t.constructors={}},t.createCallbacks=function(e){var n=[];for(var r in t.constructors){var i=+r;e>=i&&n.push.apply(n,f([],p(t.constructors[i]),!1))}return n.map((function(t){return new t}))},t}();function Eu(t,e,n,r,i,a,o,s,u){var c=new wu,l=f([new xu],p(Tu.createCallbacks(e)),!1);null!=t&&l.push.apply(l,f([],p(t),!1)),l.push(c);var h=new bu(l);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:e,doValidation:s,metrics:u}),{callbackList:h,history:c}}function ku(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=!1),C(t,a.serialization.SerializationMap.getMap().classNameMap,e,"layer",n)}function Iu(t,e){return a.tidy((function(){"float32"!==t.dtype&&(t=o.cast(t,"float32"));var n=o.sum(wt(t),e,!0),r=o.fill(n.shape,ct()),i=o.sqrt(o.maximum(n,r));return o.div(t,i)}))}function Au(t,e){return a.tidy((function(){return o.mean(wt(o.sub(e,t)),-1)}))}function Nu(t,e){return a.tidy((function(){return o.mean(o.abs(o.sub(e,t)),-1)}))}function Cu(t,e){return a.tidy((function(){var n=o.sub(t,e),r=o.clipByValue(o.abs(t),ct(),Number.MAX_VALUE),i=o.abs(o.div(n,r));return o.mul(100,o.mean(i,-1))}))}function Ru(t,e,n){return void 0===n&&(n=!1),a.tidy((function(){if(n)e=o.softmax(e);else{var r=o.sum(e,e.shape.length-1,!0);e=o.div(e,r)}return e=o.clipByValue(e,ct(),1-ct()),o.neg(o.sum(o.mul(o.cast(t,"float32"),o.log(e)),e.shape.length-1))}))}function Ou(t,e,n){return void 0===n&&(n=!1),a.tidy((function(){var r,i,a=o.cast(o.floor((i=[at((r=t).shape)],o.reshape(r,i))),"int32"),s=(e=o.clipByValue(e,ct(),1-ct())).shape;return Ru(o.reshape(o.oneHot(a,s[s.length-1]),s),e,n)}))}function Du(t,e){return a.tidy((function(){var n;return n=o.clipByValue(e,ct(),1-ct()),n=o.log(o.div(n,o.sub(1,n))),o.mean(function(t,e){if(!a.util.arraysEqual(t.shape,e.shape))throw new g("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(t.shape)," and ").concat(JSON.stringify(e.shape)));return a.tidy((function(){var n=o.relu(e),r=o.neg(o.abs(e));return o.add(o.sub(n,o.mul(e,t)),o.log1p(o.exp(r)))}))}(t,n),-1)}))}function Mu(t,e){return a.tidy((function(){var n=Iu(t,-1),r=Iu(e,-1),i=o.mul(n,r);return o.neg(o.sum(i,-1))}))}Tu.constructors={};var Fu={meanSquaredError:Au,meanAbsoluteError:Nu,meanAbsolutePercentageError:Cu,meanSquaredLogarithmicError:function(t,e){return a.tidy((function(){var n=o.clipByValue(e,ct(),Number.MAX_VALUE),r=o.log(o.add(1,n)),i=o.clipByValue(t,ct(),Number.MAX_VALUE),a=o.log(o.add(1,i));return o.mean(wt(o.sub(r,a)),-1)}))},squaredHinge:function(t,e){return a.tidy((function(){var n=o.maximum(0,o.sub(1,o.mul(t,e)));return o.mean(wt(n),-1)}))},hinge:function(t,e){return a.tidy((function(){var n=o.maximum(0,o.sub(1,o.mul(t,e)));return o.mean(n,-1)}))},categoricalHinge:function(t,e){return a.tidy((function(){var n=o.sum(o.mul(t,e),-1),r=o.max(o.mul(o.sub(1,t),e),-1);return o.maximum(0,o.add(1,o.sub(r,n)))}))},logcosh:function(t,e){return a.tidy((function(){var n=Math.log(2),r=o.sub(e,t),i=o.sub(o.add(r,o.softplus(o.mul(-2,r))),n);return o.mean(i,-1)}))},categoricalCrossentropy:Ru,sparseCategoricalCrossentropy:Ou,binaryCrossentropy:Du,kullbackLeiblerDivergence:function(t,e){return a.tidy((function(){var n=o.clipByValue(t,ct(),1),r=o.clipByValue(e,ct(),1);return o.sum(o.mul(t,o.log(o.div(n,r))),-1)}))},poisson:function(t,e){return a.tidy((function(){var n=o.log(o.add(ct(),e));return o.mean(o.sub(e,o.mul(t,n)),-1)}))},cosineProximity:Mu};function Pu(t){if("string"==typeof t){if(t in Fu)return Fu[t];var e="Unknown loss ".concat(t);throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(t,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new g(e)}return t}function Lu(t,e){return a.tidy((function(){var n=o.mul(.5,o.onesLike(e)),r=lt(o.greater(e,n),t.dtype);return o.mean(o.equal(t,r),-1)}))}function Bu(t,e){return a.tidy((function(){return lt(o.equal(o.argMax(t,-1),o.argMax(e,-1)),"float32")}))}function zu(t,e){return a.tidy((function(){return o.cast(o.sum(o.logicalAnd(o.equal(t,1),o.equal(e,1))),"float32")}))}function Uu(t,e){return a.tidy((function(){var n=zu(t,e),r=function(t,e){return a.tidy((function(){return o.cast(o.sum(o.logicalAnd(o.equal(t,0),o.equal(e,1))),"float32")}))}(t,e),i=o.add(n,r);return o.cast(o.where(o.greater(i,0),o.div(n,i),0),"float32")}))}function Gu(t,e){return Du(t,e)}function Wu(t,e){return t.rank===e.rank&&(t=o.squeeze(t,[t.rank-1])),(e=o.argMax(e,-1)).dtype!==t.dtype&&(e=o.cast(e,t.dtype)),o.cast(o.equal(t,e),"float32")}var Vu=Ru,ju=Ou,Hu={binaryAccuracy:Lu,categoricalAccuracy:Bu,precision:Uu,categoricalCrossentropy:Vu,sparseCategoricalCrossentropy:ju,mse:Au,MSE:Au,mae:Nu,MAE:Nu,mape:Cu,MAPE:Cu,cosine:Mu};function Xu(t){var e,n,r,i;if(w(null!==t,"Unknown LossOrMetricFn ".concat(t)),"string"==typeof t)return t;var a=void 0;try{for(var o=h(Object.keys(Fu)),s=o.next();!s.done;s=o.next()){var u=s.value;if(Fu[u]===t){a=u;break}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}if(void 0!==a)return a;try{for(var c=h(Object.keys(Hu)),l=c.next();!l.done;l=c.next())if(u=l.value,Hu[u]===t){a=u;break}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return void 0!==a?a:t.name}var qu=1048576;function Ku(t,e,n){if(void 0===n&&(n=!1),null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!Yu(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(t);r.length>qu&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(qu,"."))}}function Yu(t){var e,n,r,i;if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){var a=Object.keys(t);try{for(var o=h(a),s=o.next();!s.done;s=o.next()){var u=s.value;if("string"!=typeof u)return!1;if(!Yu(t[u]))return!1}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!0}if(Array.isArray(t)){try{for(var c=h(t),l=c.next();!l.done;l=c.next())if(!Yu(l.value))return!1}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return!0}return!1}var p=typeof t;return"string"===p||"number"===p||"boolean"===p}function Zu(t,e,n){void 0===n&&(n=console.log);for(var r="",i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=t[i]).slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function $u(t,e,n){var r,i;try{i=t.inboundNodes.map((function(t){return JSON.stringify(t.inputShapes)})).join(",")}catch(t){i="multiple"}try{r=JSON.stringify(t.outputShape)}catch(t){r="multiple"}var a=t.name,o=t.getClassName();Zu(["".concat(a," (").concat(o,")"),i,r,t.countParams().toString()],e,n)}function Ju(t,e,n,r){var i,a,o,s;try{s=t.inboundNodes.map((function(t){return JSON.stringify(t.inputShapes)})).join(",")}catch(t){s="multiple"}try{o=JSON.stringify(t.outputShape)}catch(t){o="multiple"}var u=[];try{for(var c=h(t.inboundNodes),l=c.next();!l.done;l=c.next()){var p=l.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(p)))for(var f=0;f<p.inboundLayers.length;++f){var d=p.inboundLayers[f].name,m=p.nodeIndices[f],g=p.tensorIndices[f];u.push("".concat(d,"[").concat(m,"][").concat(g,"]"))}}}catch(t){i={error:t}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}var v=t.name,y=t.getClassName(),b=0===u.length?"":u[0];for(Zu(["".concat(v," (").concat(y,")"),s,o,t.countParams().toString(),b],e,r),f=1;f<u.length;++f)Zu(["","","","",u[f]],e,r)}function Qu(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function tc(t,e){var n,r;if(null===t)return null;if("string"==typeof t)return k(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var i=[],a=t.length,o=0;o<a;++o){var s=t[o];Qu(e,o,s)?i.push(s):i.push(tc(s,e))}return i}var u={};try{for(var c=h(Object.keys(t)),l=c.next();!l.done;l=c.next()){var p=l.value,f=t[p];if("name"===p&&"string"==typeof f)u[p]=f;else{var d=k(p);u[d]=tc(f,d)}}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u}function ec(t,e){var n,r;if(null==t)return null;if("string"==typeof t)return E(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var i=[],a=t.length,o=0;o<a;++o){var s=t[o];Qu(e,o,s)?i.push(s):i.push(ec(s,e))}return i}var u={};try{for(var c=h(Object.keys(t)),l=c.next();!l.done;l=c.next()){var p=l.value,f=t[p];u[E(p)]="name"!==p&&"className"!==p||"string"!=typeof f?ec(f,p):f}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u}var nc="4.17.0",rc=function(t){function e(n){var r,i,a,o,s,u,c,l,p,f,d,v,y,b,x,_,S,T,E,k,I,A,N,C,D=t.call(this,{})||this;if(D.containerNodes=new Set,D.name=n.name,null==D.name){var M=D.getClassName().toLowerCase();D.name=W(M)}if(D.supportsMasking=!1,D.trainable_=!0,Array.isArray(n.inputs)?D.inputs=n.inputs.slice():D.inputs=[n.inputs],Array.isArray(n.outputs)?D.outputs=n.outputs.slice():D.outputs=[n.outputs],O(D.inputs).length!==D.inputs.length)throw new g("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(D.inputs.map((function(t){return t.name}))));O(D.outputs).length!==D.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(D.outputs.map((function(t){return t.name})))),D.inputLayers=[],D.inputLayersNodeIndices=[],D.inputLayersTensorIndices=[],D.outputLayers=[],D.outputLayersNodeIndices=[],D.outputLayersTensorIndices=[],D.layers=[],D.internalContainerRefs=[];try{for(var F=h(D.outputs),P=F.next();!P.done;P=F.next()){var L=(rt=P.value).sourceLayer,B=rt.nodeIndex,z=rt.tensorIndex;D.outputLayers.push(L),D.outputLayersNodeIndices.push(B),D.outputLayersTensorIndices.push(z)}}catch(t){r={error:t}}finally{try{P&&!P.done&&(i=F.return)&&i.call(F)}finally{if(r)throw r.error}}try{for(var U=h(D.inputs),G=U.next();!G.done;G=U.next())L=(rt=G.value).sourceLayer,B=rt.nodeIndex,z=rt.tensorIndex,w(0===B,"input layer has >1 nodes"),w(0===z,"input layer has >1 tensors"),D.inputLayers.push(L),D.inputLayersNodeIndices.push(B),D.inputLayersTensorIndices.push(z)}catch(t){a={error:t}}finally{try{G&&!G.done&&(o=U.return)&&o.call(U)}finally{if(a)throw a.error}}D.inputNames=[],D.outputNames=[],D.feedInputShapes=[],D.feedInputNames=[],D.feedOutputNames=[];for(var V=0;V<D.inputLayers.length;V++){if(!((L=D.inputLayers[V])instanceof le))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(n.inputs,". ")+"Input ".concat(V," (0-based) originates ")+"from layer type ".concat(L.getClassName(),"."));D.inputNames.push(L.name),D.feedInputShapes.push(L.batchInputShape),D.feedInputNames.push(L.name)}try{for(var j=h(D.outputLayers),H=j.next();!H.done;H=j.next())L=H.value,D.outputNames.push(L.name)}catch(t){s={error:t}}finally{try{H&&!H.done&&(u=j.return)&&u.call(j)}finally{if(s)throw s.error}}D.internalInputShapes=D.inputs.map((function(t){return t.shape})),D.internalOutputShapes=D.outputs.map((function(t){return t.shape}));var X={},q={},K={},Y={},Z={},$=[],J=function(t,n,r,i,a,o){null!=i&&null!=a&&null!=o||(i=t.sourceLayer,a=t.nodeIndex,o=t.tensorIndex);var s=i.inboundNodes[a];if(-1!==r.indexOf(s))throw new m("The tensor ".concat(t.name,' at layer "').concat(i.name,'" ')+"is part of a cycle.");if(-1===n.indexOf(s)){D.containerNodes.add(e.nodeKey(i,a)),i.id in Z||(Z[i.id]=Object.keys(Z).length),-1===r.indexOf(s)&&r.push(s);for(var u=s.inboundLayers.length,c=0;c<u;c++){var l=s.inputTensors[c],h=s.inboundLayers[c],p=s.nodeIndices[c],f=s.tensorIndices[c];J(l,n,r,h,p,f)}for(n.push(s);r.indexOf(s)>=0;)r.splice(r.indexOf(s),1);$.push(s)}},Q=[],tt=[];try{for(var et=h(D.outputs),nt=et.next();!nt.done;nt=et.next()){var rt=nt.value;J(rt,Q,tt)}}catch(t){c={error:t}}finally{try{nt&&!nt.done&&(l=et.return)&&l.call(et)}finally{if(c)throw c.error}}var it=$.slice().reverse();try{for(var at=h(it),ot=at.next();!ot.done;ot=at.next()){q[(At=ot.value).id]=At,At.id in X||(X[At.id]=0);var st=X[At.id],ut=null==K[At.outboundLayer.id]?0:K[At.outboundLayer.id];for(st=Math.max(st,ut),K[At.outboundLayer.id]=st,Y[At.outboundLayer.id]=At.outboundLayer,X[At.id]=st,V=0;V<At.inboundLayers.length;V++){var ct=At.inboundLayers[V],lt=(B=At.nodeIndices[V],ct.inboundNodes[B]),ht=null==X[lt.id]?0:X[lt.id];X[lt.id]=Math.max(st+1,ht),q[lt.id]=lt}}}catch(t){p={error:t}}finally{try{ot&&!ot.done&&(f=at.return)&&f.call(at)}finally{if(p)throw p.error}}var pt={};for(var ft in X)(st=X[ft])in pt||(pt[st]=[]),pt[st].push(q[ft]);var dt={};for(var mt in K)(st=K[mt])in dt||(dt[st]=[]),dt[st].push(Y[mt]);var gt=Object.keys(dt).map((function(t){return parseInt(t,10)})).sort(R);D.layers=[];try{for(var vt=h(gt),yt=vt.next();!yt.done;yt=vt.next()){var bt=dt[st=yt.value];bt.sort((function(t,e){var n=Z[t.id],r=Z[e.id];return n<r?-1:n>r?1:0}));try{for(var xt=(y=void 0,h(bt)),wt=xt.next();!wt.done;wt=xt.next())(L=wt.value)instanceof e&&D.internalContainerRefs.push(L),D.layers.push(L)}catch(t){y={error:t}}finally{try{wt&&!wt.done&&(b=xt.return)&&b.call(xt)}finally{if(y)throw y.error}}}}catch(t){d={error:t}}finally{try{yt&&!yt.done&&(v=vt.return)&&v.call(vt)}finally{if(d)throw d.error}}D.layersByDepth=dt,gt=Object.keys(pt).map((function(t){return parseInt(t,10)})).sort(R);var _t=D.inputs.slice(),St=[];try{for(var Tt=h(gt),Et=Tt.next();!Et.done;Et=Tt.next()){st=Et.value;try{for(var kt=(S=void 0,h(pt[st])),It=kt.next();!It.done;It=kt.next()){var At;if(null!=(L=(At=It.value).outboundLayer)){try{for(var Nt=(E=void 0,h(At.inputTensors)),Ct=Nt.next();!Ct.done;Ct=Nt.next())if(rt=Ct.value,-1===_t.indexOf(rt))throw new m("Graph disconnected: cannot obtain value for tensor ".concat(rt)+' at layer "'.concat(L.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(St))}catch(t){E={error:t}}finally{try{Ct&&!Ct.done&&(k=Nt.return)&&k.call(Nt)}finally{if(E)throw E.error}}try{for(var Rt=(I=void 0,h(At.outputTensors)),Ot=Rt.next();!Ot.done;Ot=Rt.next())rt=Ot.value,_t.push(rt)}catch(t){I={error:t}}finally{try{Ot&&!Ot.done&&(A=Rt.return)&&A.call(Rt)}finally{if(I)throw I.error}}St.push(L.name)}}}catch(t){S={error:t}}finally{try{It&&!It.done&&(T=kt.return)&&T.call(kt)}finally{if(S)throw S.error}}}}catch(t){x={error:t}}finally{try{Et&&!Et.done&&(_=Tt.return)&&_.call(Tt)}finally{if(x)throw x.error}}D.nodesByDepth=pt;var Dt=D.layers.map((function(t){return t.name})),Mt=function(t){var e=Dt.filter((function(e){return e===t})).length;if(1!==e)throw new m('The name "'.concat(t,'" is used ').concat(e," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(Dt))};try{for(var Ft=h(Dt),Pt=Ft.next();!Pt.done;Pt=Ft.next())Mt(Pt.value)}catch(t){N={error:t}}finally{try{Pt&&!Pt.done&&(C=Ft.return)&&C.call(Ft)}finally{if(N)throw N.error}}return D.outboundNodes=[],D.inboundNodes=[],new oe({outboundLayer:D,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:D.inputs,outputTensors:D.outputs,inputMasks:D.inputs.map((function(t){return null})),outputMasks:D.outputs.map((function(t){return null})),inputShapes:D.inputs.map((function(t){return t.shape})),outputShapes:D.outputs.map((function(t){return t.shape}))}),D.built=!0,D._refCount=1,D}return u(e,t),e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))},e.prototype.dispose=function(){var t,e,n,r;this.assertNotDisposed();var i={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){try{for(var a=h(this.layers),o=a.next();!o.done;o=a.next()){var s=o.value;i.numDisposedVariables+=s.dispose().numDisposedVariables}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}try{for(var u=h(this.internalContainerRefs),c=u.next();!c.done;c=u.next()){var l=c.value;i.numDisposedVariables+=l.dispose().numDisposedVariables}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}return i.refCountAfterDispose=this._refCount,i},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.layers.forEach((function(e){e._trainableWeights.forEach((function(e){return e.trainable=t}))})),this.trainable_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){var t,e;if(this._trainableWeights.length>0)throw new g("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var n=[];try{for(var r=h(this.layers),i=r.next();!i.done;i=r.next()){var a=i.value;n=n.concat(a.trainableWeights)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){var t,e,n,r,i=[];try{for(var a=h(this.layers),o=a.next();!o.done;o=a.next()){var s=o.value;i.push.apply(i,f([],p(s.nonTrainableWeights),!1))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}if(!this.trainable){var u=[];try{for(var c=h(this.layers),l=c.next();!l.done;l=c.next())s=l.value,u.push.apply(u,f([],p(s.trainableWeights),!1))}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u.concat(i)}return i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!1,configurable:!0}),e.prototype.loadWeights=function(t,e){var n,r,i,a;void 0===e&&(e=!0);var o={},s=0,u=function(t){var e=Object.keys(t);if(0===e.length)return!1;var n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))}(t);u&&this.parseWeights(t);try{for(var c=h(this.layers),l=c.next();!l.done;l=c.next()){var f=l.value;try{for(var d=(i=void 0,h(f.weights.entries())),m=d.next();!m.done;m=d.next()){var v=p(m.value,2),y=v[0],b=v[1],x=u?"".concat(b.name.split("/").slice(0,-1).join("/")+"/").concat(y):b.originalName;if(null!=o[x])throw new g("Duplicate weight name: ".concat(x));o[x]=b,s++}}catch(t){i={error:t}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}var w=[];for(var _ in t){var S=_;if(null==o[_]){var T=_.split("/");S=T.slice(0,-2).concat([T[T.length-1]]).join("/")}if(null!=o[S])w.push([o[S],t[_]]);else if(e)throw new g("Provided weight data has no target variable: ".concat(_));delete o[S]}if(e){var E=[];for(var _ in o)E.push(_);if(E.length>0)throw new g("".concat(E.length," of ").concat(s," weights are not set: ")+"".concat(E))}ne(w)},e.prototype.parseWeights=function(t){var e=function(e){var n=e.split("/"),r=["vars","layer_checkpoint_dependencies"],i=n.map((function(t){return t.startsWith("_")?t.slice(1):t})).filter((function(t){return!r.includes(t)})).join("/");i!==e&&(t[i]=t[e],delete t[e])};for(var n in Object.keys(t))e(n)},e.prototype.updatedConfig=function(){var t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers ".concat(nc),e.backend="TensorFlow.js",e},e.prototype.toJSON=function(t,e){void 0===e&&(e=!0);var n=ec(this.updatedConfig());return e?JSON.stringify(n):n},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){t=T(t);for(var r=new pe,i=0;i<n.inputs.length;++i)r.add(n.inputs[i],t[i]);return me(n.outputs,r,e)}))},e.prototype.computeMask=function(t,e){var n=this;return a.tidy((function(){var r;return t=T(t),r=null==e?x(null,t.length):T(e),n.runInternalGraph(t,r)[1]}))},e.prototype.computeOutputShape=function(t){var e,n,r,i,a=Yt(t);if(a.length!==this.inputLayers.length)throw new g("Invalid inputShape argument ".concat(t,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var o={},s=0;s<a.length;s++){var u=this.inputLayers[s],c=a[s];o[D=u.name+"_0_0"]=c}var l=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(R);if(l.length>1)try{for(var p=h(l),f=p.next();!f.done;f=p.next()){var d=f.value,m=this.nodesByDepth[d];try{for(var v=(r=void 0,h(m)),y=v.next();!y.done;y=v.next()){var b=y.value;if(u=b.outboundLayer,-1===this.inputLayers.map((function(t){return t.id})).indexOf(u.id)){for(var x=[],_=0;_<b.inboundLayers.length;_++){var T=b.inboundLayers[_],E=b.nodeIndices[_],k=b.tensorIndices[_],I=o[D="".concat(T.name,"_").concat(E,"_").concat(k)];x.push(I)}var A=Yt(u.computeOutputShape(S(x))),N=u.inboundNodes.indexOf(b);for(_=0;_<A.length;_++)o[D="".concat(u.name,"_").concat(N,"_").concat(_)]=A[_]}}}catch(t){r={error:t}}finally{try{y&&!y.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(e)throw e.error}}var C=[],O=[];for(s=0;s<this.outputLayers.length;s++){u=this.outputLayers[s],N=this.outputLayersNodeIndices[s],k=this.outputLayersTensorIndices[s];var D="".concat(u.name,"_").concat(N,"_").concat(k);O.push(D)}for(s=0;s<O.length;s++){var M=O[s];w(M in o),C.push(o[M])}return S(C)},e.prototype.runInternalGraph=function(t,e){var n,r,i,a,o,s,u,c;null==e&&(e=x(null,t.length));for(var l={},f=0;f<this.inputs.length;++f){var d=this.inputs[f],m=t[f],g=e[f];l[d.id]=[m,g]}var y=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(R);try{for(var b=h(y),_=b.next();!_.done;_=b.next()){var S=_.value,E=this.nodesByDepth[S];try{for(var k=(i=void 0,h(E)),I=k.next();!I.done;I=k.next()){var A=I.value,N=A.outboundLayer,C=A.inputTensors,O=A.outputTensors,D=new Array;try{for(var M=(o=void 0,h(C)),F=M.next();!F.done;F=M.next())(d=F.value).id in l&&D.push(l[d.id])}catch(t){o={error:t}}finally{try{F&&!F.done&&(s=M.return)&&s.call(M)}finally{if(o)throw o.error}}if(D.length===C.length){var P={},L=void 0,B=void 0,z=void 0,U=void 0;if(null!=A.callArgs&&(P=A.callArgs),1===D.length){var G=p(D[0],2),W=G[0],V=G[1];null==P.mask&&(P.mask=V),z=T(N.call(W,P)),U=T(N.computeMask(W,V)),L=[W],B=[V]}else L=D.map((function(t){return t[0]})),B=D.map((function(t){return t[1]})),null==P.mask&&(P.mask=B),z=T(N.call(L,P)),U=T(N.computeMask(L,B));if(N.activityRegularizer)throw new v("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(f=0;f<O.length;++f)d=O[f],m=z[f],g=U[f],l[d.id]=[m,g]}}}catch(t){i={error:t}}finally{try{I&&!I.done&&(a=k.return)&&a.call(k)}finally{if(i)throw i.error}}}}catch(t){n={error:t}}finally{try{_&&!_.done&&(r=b.return)&&r.call(b)}finally{if(n)throw n.error}}var j=[],H=[],X=[];try{for(var q=h(this.outputs),K=q.next();!K.done;K=q.next()){w((d=K.value).id in l,"Could not compute output ".concat(d.name," : ").concat(d.id));var Y=p(l[d.id],2),Z=Y[0];g=Y[1],X.push(Z.shape),j.push(Z),H.push(g)}}catch(t){u={error:t}}finally{try{K&&!K.done&&(c=q.return)&&c.call(q)}finally{if(u)throw u.error}}return[j,H,X]},e.prototype.buildNodeConversionMap=function(t){var n,r,i,a={};try{for(var o=h(this.layers),s=o.next();!s.done;s=o.next()){var u=s.value;i=u instanceof e?1:0;for(var c=0;c<u.inboundNodes.length;c++){var l=e.nodeKey(u,c);this.containerNodes.has(l)&&(a[l]=i,i+=1)}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a},e.prototype.getLayer=function(t,e){var n,r;if(null!=e)return this.findLayer(e);if(null==t)throw new g("Provide either a layer name or layer index");if("number"==typeof t)return this.findLayer(t);try{for(var i=h(this.layers),a=i.next();!a.done;a=i.next()){var o=a.value;if(o.name===t)return o}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}throw new g("No such layer: ".concat(t))},e.prototype.findLayer=function(t){if(this.layers.length<=t)throw new g("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]},e.prototype.calculateLosses=function(){var t=this;return a.tidy((function(){var n,r,i=[];try{for(var a=h(t.layers),o=a.next();!o.done;o=a.next())for(var s=o.value,u=0;u<s.inboundNodes.length;++u){var c=e.nodeKey(s,u);t.containerNodes.has(c)&&i.push.apply(i,f([],p(s.calculateLosses()),!1))}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}))},e.prototype.getConfig=function(){var t,n,r={name:this.name},i=this.buildNodeConversionMap(this.layers),a=[];try{for(var o=h(this.layers),s=o.next();!s.done;s=o.next()){for(var u=(S=s.value).getClassName(),c=S.getConfig(),l=[],p=0;p<S.inboundNodes.length;p++){var f=S.inboundNodes[p],d=e.nodeKey(S,p),m={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),m=f.callArgs}catch(t){console.warn("Layer ".concat(S.name," was passed ")+"non-serializable keyword arguments: "+"".concat(f.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),m={}}if(f.inboundLayers.length>0){for(var g=[],v=0;v<f.inboundLayers.length;v++){var y=f.inboundLayers[v],b=f.nodeIndices[v],x=f.tensorIndices[v];null==(E=i[e.nodeKey(y,b)])&&(E=0),g.push([y.name,E,x,m])}l.push(g)}}}var w={};w.name=S.name,w.className=u,w.config=c,w.inboundNodes=l,a.push(w)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}r.layers=a;var _=[];for(v=0;v<this.inputLayers.length;v++){var S=this.inputLayers[v];b=this.inputLayersNodeIndices[v],d=e.nodeKey(S,b),this.containerNodes.has(d)&&(null==(E=i[d])&&(E=0),x=this.inputLayersTensorIndices[v],_.push([S.name,E,x]))}r.inputLayers=_;var T=[];for(v=0;v<this.outputLayers.length;v++){var E;if(S=this.outputLayers[v],b=this.outputLayersNodeIndices[v],d=e.nodeKey(S,b),this.containerNodes.has(d))null==(E=i[d])&&(E=0),x=this.outputLayersTensorIndices[v],T.push([S.name,E,x])}return r.outputLayers=T,r},e.fromConfig=function(t,e,n,r){var i,a,o,s,u,c,l,p,f,d;void 0===r&&(r=!1);var m={},v={};function y(t,e){t.name in v?v[t.name].push(e):v[t.name]=[e]}function b(t,e){var n,r,i,a=[];try{for(var o=h(e),s=o.next();!s.done;s=o.next()){var u=s.value,c=u[0],l=u[1],p=u[2];if(i=null==u[3]?{}:u[3],!(c in m))return void y(t,e);var f=m[c];if(f.inboundNodes.length<=l)return void y(t,e);var d=f.inboundNodes[l];a.push(d.outputTensors[p])}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}a.length>0&&t.apply(S(a),i)}function x(t){var n=t.name,i=ku(t,null!=e.customObjects?e.customObjects:{});i.setFastWeightInitDuringBuild(r),m[n]=i,t.inboundNodes.forEach((function(t){if(!(t instanceof Array))throw new g("Corrupted configuration, expected array for nodeData: ".concat(t));y(i,t)}))}var _=e.name,T=e.layers;try{for(var E=h(T),k=E.next();!k.done;k=E.next())x(N=k.value)}catch(t){i={error:t}}finally{try{k&&!k.done&&(a=E.return)&&a.call(E)}finally{if(i)throw i.error}}for(;!D(v);)try{for(var I=(o=void 0,h(T)),A=I.next();!A.done;A=I.next()){var N=A.value;if((X=m[N.name]).name in v){var C=v[X.name];delete v[X.name];try{for(var R=(u=void 0,h(C)),O=R.next();!O.done;O=R.next())b(X,O.value)}catch(t){u={error:t}}finally{try{O&&!O.done&&(c=R.return)&&c.call(R)}finally{if(u)throw u.error}}}}}catch(t){o={error:t}}finally{try{A&&!A.done&&(s=I.return)&&s.call(I)}finally{if(o)throw o.error}}var M=[],F=[],P=e.inputLayers;try{for(var L=h(P),B=L.next();!B.done;B=L.next()){var z=(N=B.value)[0],U=N[1],G=N[2];w(z in m);var W=(X=m[z]).inboundNodes[U].outputTensors;M.push(W[G])}}catch(t){l={error:t}}finally{try{B&&!B.done&&(p=L.return)&&p.call(L)}finally{if(l)throw l.error}}var V=e.outputLayers;try{for(var j=h(V),H=j.next();!H.done;H=j.next()){var X;z=(N=H.value)[0],U=N[1],G=N[2],w(z in m),W=(X=m[z]).inboundNodes[U].outputTensors,F.push(W[G])}}catch(t){f={error:t}}finally{try{H&&!H.done&&(d=j.return)&&d.call(j)}finally{if(f)throw f.error}}return new t({inputs:M,outputs:F,name:_})},Object.defineProperty(e.prototype,"stateful",{get:function(){var t,e;if(this._stateful)throw new g("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");try{for(var n=h(this.layers),r=n.next();!r.done;r=n.next())if(r.value.stateful)return!0}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return!1},enumerable:!1,configurable:!0}),e.prototype.resetStates=function(){var t=this;a.tidy((function(){t.layers.forEach((function(t){t.stateful&&t.resetStates()}))}))},e}(ue);function ic(t,e){return function(t,e,n){var r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return null}));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(t.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){var i=[];return e.forEach((function(e){e in t?i.push(t[e]):i.push(null)})),i}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(e," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(t)))}(t,e,"classWeight")}function ac(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o,s,u,c;return l(this,(function(l){switch(l.label){case 0:if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");return null==n?[3,2]:(i=a.tidy((function(){if(1===t.shape.length)return a.clone(t);if(2===t.shape.length){if(t.shape[1]>1)return a.argMax(t,1);if(1===t.shape[1])return a.reshape(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),u=(s=Array).from,[4,i.data()]);case 1:return o=u.apply(s,[l.sent()]),a.dispose(i),c=[],o.forEach((function(t){if(null==n[t])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(t," exists in the data but not in ")+"classWeight");c.push(n[t])})),[2,a.tensor1d(c,"float32")];case 2:return[2,null]}}))}))}function oc(t,e){return a.mul(t,e)}function sc(t,e){var n,r,i=e;n=i.xs,r=i.ys,o.util.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e)}));var a=uc("input",t.inputNames,n),s=uc("output",t.outputNames,r),u=a[0].shape[0];o.util.assert(a.length===t.inputs.length,(function(){return"LayersModel has ".concat(t.inputs.length," inputs, but the dataset ")+"provides ".concat(a.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(t.inputNames),")")})),o.util.assert(s.length===t.outputs.length,(function(){return"LayersModel has ".concat(t.outputs.length," outputs, but the dataset ")+"provides ".concat(s.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(t.outputNames),")")}));for(var c=function(e){o.util.assert(a[e].shape[0]===u,(function(){return"Batch size mismatch: input "+"".concat(t.inputNames[e]," has ").concat(a[e].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(t.inputNames[0],".")}))},l=0;l<a.length;l++)c(l);for(var h=function(e){o.util.assert(s[e].shape[0]===u,(function(){return"Batch size mismatch: output "+"".concat(t.outputNames[e]," has ").concat(s[e].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(t.inputNames[0],".")}))},p=0;p<s.length;p++)h(p);return{xs:a,ys:s}}function uc(t,e,n){var r,i;if(n instanceof o.Tensor)return[n];if(Array.isArray(n))return o.util.assert(n.length===e.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(e.length," to match the ").concat(t," keys ").concat(e,".")})),n;var a=[];try{for(var s=h(e),u=s.next();!u.done;u=s.next()){var c=u.value;if(null==n[c])throw new g("The feature data generated by the dataset lacks the required "+"".concat(t," key '").concat(c,"'."));a.push(n[c])}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a}function cc(t,e,n){return c(this,void 0,void 0,(function(){var r,i,a,s,u,c,h,p,f,d,m,g,y,b,x,w,_,S,E,k,I,A,N,C,R,O,D,M,F,P,L,B,z,U;return l(this,(function(l){switch(l.label){case 0:if(r=null!=n.batchesPerEpoch,o.util.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),o.util.assert(null!=n,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),o.util.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs)})),o.util.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch)})),o.util.assert(null==n.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,l.label=1;case 1:return l.trys.push([1,,26,27]),i=null!=n.validationData,a=void 0,s=void 0,i&&(lc(n.validationData)?o.util.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches)})):(u=function(t){if(3===t.length)throw new v("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData),a=u.xs,s=u.ys)),c=t.makeTrainFunction(),h=t.getDedupedMetricsNames(),void 0,p=i?h.slice().concat(h.map((function(t){return"val_"+t}))):h.slice(),f=Su(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,m=Eu(f,d,n.epochs,null,null,function(t,e){var n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,i,p),g=m.callbackList,y=m.history,g.setModel(t),t.history=y,[4,g.onTrainBegin()];case 2:return l.sent(),t.stopTraining_=!1,b=null==n.initialEpoch?0:n.initialEpoch,[4,e.iterator()];case 3:x=l.sent(),l.label=4;case 4:return b<n.epochs?(w={},[4,g.onEpochBegin(b)]):[3,23];case 5:return l.sent(),_=0,S=0,r?[3,7]:[4,e.iterator()];case 6:x=l.sent(),l.label=7;case 7:return!r||_<n.batchesPerEpoch?[4,x.next()]:[3,21];case 8:return E=l.sent(),r&&E.done?(console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(_," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),[3,21]):null==E.value?[3,15]:(k=sc(t,E.value),I=k.xs,A=k.ys,(N={}).batch=S,N.size=I[0].shape[0],[4,g.onBatchBegin(S,N)]);case 9:if(l.sent(),C=[],null==n.classWeight)return[3,13];R=ic(n.classWeight,t.outputNames),U=0,l.label=10;case 10:return U<R.length?(D=(O=C).push,[4,ac(A[U],null,R[U])]):[3,13];case 11:D.apply(O,[l.sent()]),l.label=12;case 12:return++U,[3,10];case 13:for(M=I.concat(A).concat(C),F=c(M),o.dispose(M),U=0;U<h.length;++U)P=h[U],L=F[U],N[P]=L,o.keep(L);return[4,g.onBatchEnd(S,N)];case 14:l.sent(),vu(N),S++,_++,l.label=15;case 15:return(r?_>=n.batchesPerEpoch:E.done)?i?(B=void 0,lc(n.validationData)?(z=T,[4,t.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return B=z.apply(void 0,[l.sent()]),[3,18];case 17:B=T(t.evaluate(a,s,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0})),l.label=18;case 18:for(U=0;U<t.metricsNames.length;++U)w["val_".concat(t.metricsNames[U])]=B[U];l.label=19;case 19:return[3,21];case 20:return t.stopTraining_?[3,21]:[3,7];case 21:return[4,g.onEpochEnd(b,w)];case 22:return l.sent(),b++,t.stopTraining_?[3,23]:[3,4];case 23:return[4,g.onTrainEnd()];case 24:return l.sent(),[4,t.history.syncData()];case 25:return l.sent(),[2,t.history];case 26:return t.isTraining=!1,[7];case 27:return[2]}}))}))}function lc(t){return"function"==typeof t.iterator}function hc(t,e,n){return c(this,void 0,void 0,(function(){var r,i,s,u,c,h,p,f,d,m;return l(this,(function(g){switch(g.label){case 0:if(r=null!=(n=n||{}).batches,i=t.testFunction,s=[],n.verbose>0)throw new v("Verbose mode is not implemented yet.");return o.util.assert(!r||n.batches>0&&Number.isInteger(n.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches))})),"function"!=typeof e.next?[3,1]:(c=e,[3,3]);case 1:return[4,e.iterator()];case 2:c=g.sent(),g.label=3;case 3:u=c,h=0,p=0,f=function(){var e;return l(this,(function(c){switch(c.label){case 0:return[4,u.next()];case 1:return e=c.sent(),s=o.tidy((function(){if(e.value){var n=sc(t,e.value),r=n.xs,u=n.ys,c=r.concat(u),l=o.tidy((function(){return i(c)}));if(o.dispose(c),0===p)for(var f=0;f<l.length;++f)s.push(a.scalar(0));var d=c[0].shape[0],m=function(t){var e=l[t],n=s[t];s[t]=o.tidy((function(){return o.add(s[t],o.mul(d,e))})),p>0&&o.dispose(n)};for(f=0;f<l.length;++f)m(f);o.dispose(l),h+=d,++p}return s})),e.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}}))},g.label=4;case 4:return!r||p<n.batches?[5,f()]:[3,6];case 5:return"break"===g.sent()?[3,6]:[3,4];case 6:for(d=0;d<s.length;++d)m=s[d],s[d]=o.div(s[d],h),o.dispose(m);return[2,S(s)]}}))}))}function pc(t){o.util.assert(t>0&&Number.isInteger(t),(function(){return"batchSize is required to be a positive integer, but got ".concat(t)}))}function fc(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((function(t){return pt(t,e,n-e)})):pt(t,e,n-e)}function dc(t,e){return o.tidy((function(){return null==t?null:Array.isArray(t)?t.map((function(t){return dc(t,e)})):xt(t,"int32"===e.dtype?e:o.cast(e,"int32"))}))}function mc(t,e){for(var n=[],r=0,i=null;r<t;)(i=r+e)>=t&&(i=t),n.push([r,i]),r=i;return n}function gc(t){var e=[];t instanceof a.Tensor&&(t=[t]);for(var n=0;n<t.length;++n){var r=t[n];if(1===r.rank)e.push(ht(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function vc(t,e){if(null!=t){var n=[];if(e instanceof a.Tensor)n.push(e.id);else if(Array.isArray(e))e.forEach((function(t){return n.push(t.id)}));else if(null!=e)for(var r in e){var i=e[r];n.push(i.id)}var o=[];if(t instanceof a.Tensor)-1===n.indexOf(t.id)&&o.push(t);else if(Array.isArray(t))t.forEach((function(t){-1===n.indexOf(t.id)&&o.push(t)}));else if(null!=t)for(var r in t){var s=t[r];-1===n.indexOf(s.id)&&o.push(s)}o.forEach((function(t){t.isDisposed||t.dispose()}))}}function yc(t){return Array.isArray(t)}function bc(t){return!function(t){return t instanceof a.Tensor}(t)&&!yc(t)}function xc(t,e,n,r,i){var a,o,s;if(void 0===r&&(r=!0),void 0===i&&(i=""),null==e||0===e.length){if(null!=t){var u=!1;if(yc(t)&&t.length>0)u=!0;else if(bc(t)){for(var c in t)if(t.hasOwnProperty(c)){u=!0;break}}else u=!0;if(u)throw new g("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(t))}return[]}if(null==t)return e.map((function(t){return null}));if(bc(t)){s=[];try{for(var l=h(e),p=l.next();!p.done;p=l.next()){var f=p.value;if(null==t[f])throw new g('No data provided for "'.concat(f,'". Need data for each key in: ')+"".concat(e));s.push(t[f])}}catch(t){a={error:t}}finally{try{p&&!p.done&&(o=l.return)&&o.call(l)}finally{if(a)throw a.error}}}else if(yc(t)){if(t.length!==e.length)throw new g("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(t));s=t}else{if(e.length>1)throw new g("The model ".concat(i," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(t.shape));s=[t]}if(s=gc(s),null!=n)for(var d=0;d<e.length;++d)if(null!=n[d]){var m=s[d];if(m.shape.length!==n[d].length)throw new g("Error when checking ".concat(i,": expected ").concat(e[d]," ")+"to have ".concat(n[d].length," dimension(s). but got array with ")+"shape ".concat(m.shape));for(var v=0;v<n[d].length;++v)if(0!==v||r){var y=m.shape[v],b=n[d][v];if(null!=b&&b>=0&&y!==b)throw new g("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[d].slice(1,n[d].length),"] ")+"(i.e.,tensor shape [*,".concat(n[d].slice(1,n[d].length),"])")+" but the ".concat(i," received an input with ").concat(m.shape[0])+" examples, each with shape [".concat(m.shape.slice(1,m.shape.length),"]")+" (tensor shape [".concat(m.shape,"])"))}}return s}function wc(t,e,n,r,i){var a;if(void 0===r&&(r=!0),void 0===i&&(i=""),Array.isArray(t)){if(t.length!==e.length)throw new g("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(t.length," Tensors(s)."));a=t}else{if(e.length>1)throw new g("The model expects ".concat(e.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(t.shape),"."));a=[t]}if(null!=n)for(var o=0;o<e.length;++o)if(null!=n[o]){var s=a[o];if(s.shape.length!==n[o].length)throw new g("Error when checking ".concat(i,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||r){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new g("Error when checking ".concat(i,": expected ")+"".concat(e[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var _c=function(t){function e(e){var n=t.call(this,e)||this;return n.isTraining=!1,n}return u(e,t),e.prototype.summary=function(t,e,n){if(void 0===n&&(n=console.log),!this.built)throw new g("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,r){void 0===r&&(r=console.log);var i,a=function(t){var e,n,r,i,a,o,s=!0,u=[],c=[];for(var l in t.nodesByDepth)u.push(t.nodesByDepth[l]);try{for(var d=h(u),m=d.next();!m.done;m=d.next()){var g=m.value;if(g.length>1||1===g.length&&g[0].inboundLayers.length>1){s=!1;break}c.push.apply(c,f([],p(g),!1))}}catch(t){e={error:t}}finally{try{m&&!m.done&&(n=d.return)&&n.call(d)}finally{if(e)throw e.error}}if(s)try{for(var v=h(t.layers),y=v.next();!y.done;y=v.next()){var b=y.value,x=!1;try{for(var w=(a=void 0,h(b.inboundNodes)),_=w.next();!_.done;_=w.next()){var S=_.value;if(-1!==c.indexOf(S)){if(x){s=!1;break}x=!0}}}catch(t){a={error:t}}finally{try{_&&!_.done&&(o=w.return)&&o.call(w)}finally{if(a)throw a.error}}if(!s)break}}catch(t){r={error:t}}finally{try{y&&!y.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}return s}(t),o=["Layer (type)","Input Shape","Output shape","Param #"];if(a?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((function(t){return Math.floor(e*t)}))),!a)for(var s in o.push("Receives inputs"),i=[],t.nodesByDepth)i.push.apply(i,f([],p(t.nodesByDepth[s]),!1));r("_".repeat(e)),Zu(o,n,r),r("=".repeat(e));for(var u=t.layers,c=0;c<u.length;++c)a?$u(u[c],n,r):Ju(u[c],n,i,r),r((c===u.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();var l=function(t){return null!=t.collectedTrainableWeights?Jt(t.collectedTrainableWeights):Jt(t.trainableWeights)}(t),d=Jt(t.nonTrainableWeights);r("Total params: ".concat(l+d)),r("Trainable params: ".concat(l)),r("Non-trainable params: ".concat(d)),r("_".repeat(e))}(this,t,e,n)},e.prototype.compile=function(t){var e,n,r=this;if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){var e={Adagrad:function(){return a.train.adagrad(.01)},Adadelta:function(){return a.train.adadelta(1,.95,ct())},Adam:function(){return a.train.adam(.001,.9,.999,ct())},Adamax:function(){return a.train.adamax(.002,.9,.999,ct(),0)},RMSProp:function(){return a.train.rmsprop(.001,.9,0,ct())},SGD:function(){return a.train.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new g("Unknown Optimizer ".concat(t))}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof a.Optimizer))throw new g("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new g("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(t.loss,"."));var o=t.loss;i=o.map((function(t){return Pu(t)}))}else{var s=Pu(t.loss);this.outputs.forEach((function(t){i.push(s)}))}else{for(var u in t.loss=t.loss,t.loss)if(-1===this.outputNames.indexOf(u))throw new g('Unknown entry in loss dictionary: "'.concat(u,'". ')+"Only expected the following keys: ".concat(this.outputNames));try{for(var c=h(this.outputNames),l=c.next();!l.done;l=c.next())u=l.value,null==t.loss[u]&&console.warn('Output "'.concat(u,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(u," during training")),i.push(Pu(t.loss[u]))}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var p=0;p<this.outputs.length;++p){var f=this.internalOutputShapes[p];u=this.outputNames[p],this.feedOutputNames.push(u),this.feedOutputShapes.push(f),this.feedLossFns.push(this.lossFunctions[p])}var d=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Q("loss",(function(){for(var t=0;t<r.outputs.length;++t)if(-1===d.indexOf(t)){var e=r.lossFunctions[t];r.outputs.length>1&&(r.metricsTensors.push([e,t]),r.metricsNames.push(r.outputNames[t]+"_loss"))}}));var m=function(t,e){var n,r,i;if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return[]}));if("string"==typeof t||"function"==typeof t)i=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(t));i=t}if(Array.isArray(i))return e.map((function(t){return i}));var a=[];try{for(var o=h(e),s=o.next();!s.done;s=o.next()){var u=s.value,c=i.hasOwnProperty(u)?i[u]:[];Array.isArray(c)||(c=[c]),a.push(c)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}(t.metrics,this.outputNames);Q("metric",(function(){for(var t=function(t){if(-1!==d.indexOf(t))return"continue";!function(e){var n,i,a,o,s,u=function(e){if("string"==typeof e&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(e)){var n=r.internalOutputShapes[t];1===n[n.length-1]||r.lossFunctions[t]===Du?-1!==["accuracy","acc"].indexOf(e)?o=Lu:-1!==["crossentropy","ce"].indexOf(e)&&(o=Gu):r.lossFunctions[t]===Ou?-1!==["accuracy","acc"].indexOf(e)?o=Wu:-1!==["crossentropy","ce"].indexOf(e)&&(o=ju):-1!==["accuracy","acc"].indexOf(e)?o=Bu:-1!==["crossentropy","ce"].indexOf(e)&&(o=Vu);var i=void 0;-1!==["accuracy","acc"].indexOf(e)?i="acc":-1!==["crossentropy","ce"].indexOf(e)&&(i="ce"),s=o,a=""+i}else{var u=function(t){if("string"==typeof t&&t in Hu)return Hu[t];if("string"!=typeof t&&null!=t)return t;throw new g("Unknown metric ".concat(t))}(e);s=u,a=""+Xu(e)}var c;Q(a,(function(){c=s})),function(t,e,n){r.outputNames.length>1&&(e=r.outputNames[t]+"_"+e),r.metricsNames.push(e),r.metricsTensors.push([n,t])}(t,a,c)};try{for(var c=(n=void 0,h(e)),l=c.next();!l.done;l=c.next())u(l.value)}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}(m[t])},e=0;e<r.outputs.length;++e)t(e)})),this.collectedTrainableWeights=this.trainableWeights},e.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},e.prototype.evaluate=function(t,e,n){void 0===n&&(n={});var r=null==n.batchSize?32:n.batchSize;pc(r);var i=this.standardizeUserDataXY(t,e,!0,r);try{var a=i[0].concat(i[1]);this.makeTestFunction();var o=this.testFunction;return S(this.testLoop(o,a,r,n.verbose,n.steps))}finally{vc(i[0],t),vc(i[1],e)}},e.prototype.evaluateDataset=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(n){return this.makeTestFunction(),[2,hc(this,t,e)]}))}))},e.prototype.checkNumSamples=function(t,e,n,r){var i;if(void 0===r&&(r="steps"),null!=n){if(i=null,null!=e)throw new g("If ".concat(r," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(e))}else{if(null==t)throw new g("Either the input data should have a defined shape, or "+"".concat(r," shoud be specified."));i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i},e.prototype.execute=function(t,e){var n,r;if(Array.isArray(e)&&0===e.length)throw new g("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(e),o=i?e:[e],s=this.retrieveSymbolicTensors(o),u=new pe;if(t instanceof a.Tensor&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new g("The number of inputs provided (".concat(t.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var c=0;c<this.inputs.length;++c)u.add(this.inputs[c],t[c])}else try{for(var l=h(this.inputs),p=l.next();!p.done;p=l.next()){var f=p.value,d=t[f.name];if(null==d)throw new g("No value is provided for the model's input ".concat(f.name));u.add(f,d)}}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}var m=me(s,u);return i?m:m[0]},e.prototype.retrieveSymbolicTensors=function(t){var e,n,r=x(null,t.length),i=t.length;try{for(var a=h(this.layers),o=a.next();!o.done;o=a.next()){for(var s=o.value,u=Array.isArray(s.output)?s.output:[s.output],c=u.map((function(t){return t.name})),l=0;l<t.length;++l){var p=c.indexOf(t[l]);if(-1!==p&&(r[l]=u[p],i--),0===i)break}if(0===i)break}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}if(i>0){var f=[];throw r.forEach((function(e,n){null==e&&f.push(t[n])})),new g("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(f)))}return r},e.prototype.predictLoop=function(t,e,n){var r=this;return void 0===e&&(e=32),void 0===n&&(n=!1),o.tidy((function(){var i=r.checkNumSamples(t);if(n)throw new v("Verbose predictLoop() is not implemented yet.");for(var a=mc(i,e),s=r.outputs.map((function(t){return[]})),u=function(e){o.tidy((function(){var n=a[e][0],i=a[e][1],o=fc(t,n,i),s=[];if(Array.isArray(o))for(var u=0;u<o.length;++u)s.push({key:r.inputs[u],value:o[u]});else s.push({key:r.inputs[0],value:o});var c=new pe(s);return me(r.outputs,c)})).forEach((function(t,e){return s[e].push(t)}))},c=0;c<a.length;++c)u(c);return S(s.map((function(t){return o.concat(t,0)})))}))},e.prototype.predict=function(t,e){void 0===e&&(e={});var n=gc(t);wc(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==e.batchSize?32:e.batchSize;return pc(r),this.predictLoop(n,r)}finally{vc(n,t)}},e.prototype.predictOnBatch=function(t){wc(t,this.inputNames,this.feedInputShapes,!0);var e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)},e.prototype.standardizeUserDataXY=function(t,e,n,r){if(null==this.optimizer_)throw new m("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var i=[],o=0;o<this.feedOutputShapes.length;++o){var s=this.feedOutputShapes[o];this.feedLossFns[o]===Ou?i.push(s.slice(0,s.length-1).concat([1])):i.push(s)}if(function(t,e){var n=O(t.map((function(t){return t.shape[0]})));n.sort();var r=O(e.map((function(t){return t.shape[0]})));if(r.sort(),n.length>1)throw new g("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(t){return t.shape})))));if(r.length>1)throw new g("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(t){return t.shape})))));if(n.length>0&&r.length>0&&!a.util.arraysEqual(n,r))throw new g("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(r[0]," target ")+"sample(s).")}(t=xc(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=xc(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){for(var r=[Au,Du,Ru],i=0;i<t.length;++i){var a=t[i],o=e[i],s=n[i];if(null!=o){if(o===Ru&&1===a.shape[a.shape.length-1])throw new g("You are passing a target array of shape ".concat(a.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=a.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var h=u[l],p=c[l];if(null!=p&&h!==p)throw new g("A target Tensor with shape ".concat(a.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!=0)throw new g("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(r,". Found: ").concat(t[0].shape[0]," sample(s)."));return[t,e]},e.prototype.standardizeUserData=function(t,e,n,r,i,a){return void 0===i&&(i=!0),c(this,void 0,void 0,(function(){var o,s,u,c,h,f,d,m;return l(this,(function(l){switch(l.label){case 0:if(o=p(this.standardizeUserDataXY(t,e,i,a),2),s=o[0],u=o[1],null!=n)throw new Error("sample weight is not supported yet.");if(c=null,null==r)return[3,4];h=ic(r,this.outputNames),c=[],f=0,l.label=1;case 1:return f<h.length?(m=(d=c).push,[4,ac(u[f],null,h[f])]):[3,4];case 2:m.apply(d,[l.sent()]),l.label=3;case 3:return++f,[3,1];case 4:return[2,[s,u,c]]}}))}))},e.prototype.testLoop=function(t,e,n,r,i){var s=this;return void 0===r&&(r=0),o.tidy((function(){var u=s.checkNumSamples(e,n,i,"steps"),c=[];if(r>0)throw new v("Verbose mode is not implemented yet.");if(null!=i)throw new v("steps mode in testLoop() is not implemented yet");for(var l=mc(u,n),h=a.tensor1d(ut(0,u)),p=0;p<l.length;++p){var f=l[p][0],d=l[p][1],m=pt(h,f,d-f),g=dc(e,m),y=t(g);if(0===p)for(var b=0;b<y.length;++b)c.push(a.scalar(0));for(b=0;b<y.length;++b){var x=y[b];c[b]=o.add(c[b],o.mul(d-f,x))}}for(b=0;b<c.length;++b)c[b]=o.div(c[b],u);return c}))},e.prototype.getDedupedMetricsNames=function(){for(var t=this.metricsNames,e=[],n=0;n<t.length;++n){var r=t[n],i=r;if(_(t,r)>1){var a=_(t.slice(0,n),r);i+="_".concat(a)}e.push(i)}return e},e.prototype.makeTrainFunction=function(){var t=this;return function(e){var n=[],r=e.slice(0,t.inputs.length),i=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),a=e.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),s=[],u=t.collectedTrainableWeights.map((function(t){return t.read()}));return[t.optimizer_.minimize((function(){for(var e=[],u=0;u<t.inputs.length;++u)e.push({key:t.inputs[u],value:r[u]});var c,l=new pe(e),h=me(t.outputs,l,{training:!0});for(u=0;u<t.lossFunctions.length;++u){var p=(0,t.lossFunctions[u])(i[u],h[u]);null!=a[u]&&(p=oc(p,a[u]));var f=o.mean(p);n.push(f),c=0===u?p:o.add(c,p)}for(u=0;u<t.metricsTensors.length;++u){var d=void 0;if(t.outputs.length>1&&u<t.outputs.length)d=n[u];else{var m=t.metricsTensors[u][0],g=t.metricsTensors[u][1];d=o.mean(m(i[g],h[g]))}o.keep(d),s.push(d)}return c=o.mean(c),t.calculateLosses().forEach((function(t){c=o.add(c,t)})),c}),!0,u)].concat(s)}},e.prototype.makeTestFunction=function(){var t=this;this.testFunction=function(e){return o.tidy((function(){for(var n,r=[],i=e.slice(0,t.inputs.length),a=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),s=[],u=0;u<t.inputs.length;++u)s.push({key:t.inputs[u],value:i[u]});var c=new pe(s),l=me(t.outputs,c);for(u=0;u<t.lossFunctions.length;++u){var h=t.lossFunctions[u],p=o.mean(h(a[u],l[u]));n=0===u?p:o.add(n,p),r.push(n)}for(u=0;u<t.metricsTensors.length;++u){var f=t.metricsTensors[u][0],d=t.metricsTensors[u][1],m=o.mean(f(a[d],l[d]));r.push(m)}return r}))}},e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),c(this,void 0,void 0,(function(){var r,i,a,s,u,c,h,p,f,d,m,y,b,x,w,_,S,T,E,k,I,A;return l(this,(function(l){switch(l.label){case 0:if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0,l.label=1;case 1:return l.trys.push([1,,7,8]),pc(d=null==n.batchSize?32:n.batchSize),[4,this.standardizeUserData(t,e,n.sampleWeight,n.classWeight,!1,d)];case 2:if(m=l.sent(),r=m[0],i=m[1],f=m[2],y=!1,b=void 0,!(null!=n.validationData&&n.validationData.length>0))return[3,4];if(y=!0,2!==n.validationData.length)throw 3===n.validationData.length?new v("validationData including sample weights is not supported yet."):new g("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(n.validationData," is invalid."));return u=n.validationData[0],c=n.validationData[1],[4,this.standardizeUserData(u,c,null,null,!0,d)];case 3:return x=l.sent(),h=x[0],p=x[1],b=h.concat(p),[3,5];case 4:null!=n.validationSplit&&n.validationSplit>0&&n.validationSplit<1?(y=!0,w=Math.floor(r[0].shape[0]*(1-n.validationSplit)),_=r[0].shape[0],h=fc(r,w,_),a=r,r=fc(r,0,w),p=fc(i,w,_),s=i,i=fc(i,0,w),b=h.concat(p)):null!=n.validationSteps&&(y=!0),l.label=5;case 5:return S=r.concat(i).concat(f),this.checkTrainableWeightsConsistency(),T=this.makeTrainFunction(),E=this.getDedupedMetricsNames(),k=void 0,I=void 0,y?(this.makeTestFunction(),k=this.testFunction,I=E.slice().concat(E.map((function(t){return"val_"+t})))):(k=null,b=[],I=E.slice()),A=Su(n.callbacks,n.yieldEvery),[4,this.fitLoop(T,S,E,d,n.epochs,n.verbose,A,k,b,n.shuffle,I,n.initialEpoch,null,null)];case 6:return[2,l.sent()];case 7:return this.isTraining=!1,vc(r,t),vc(i,e),vc(a,t),vc(s,e),vc(h,u),vc(p,c),null!=f&&o.dispose(f),[7];case 8:return[2]}}))}))},e.prototype.fitLoop=function(t,e,n,r,i,s,u,h,p,f,d,m,y,b){return c(this,void 0,void 0,(function(){var c,x,w,_,S,T,E,k,I,A=this;return l(this,(function(N){switch(N.label){case 0:if(null==r&&(r=32),null==i&&(i=1),null==f&&(f=!0),null==m&&(m=0),c=!1,null!=h&&null!=p&&(c=!0),null!=b&&(c=!0,null==y))throw new g("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return null!=(x=this.checkNumSamples(e,r,y,"steps_per_epoch"))&&(w=ut(0,x)),null==s&&(s=1),_=Eu(u,s,i,m,x,y,r,c,d),S=_.callbackList,T=_.history,S.setModel(this),this.history=T,[4,S.onTrainBegin()];case 1:N.sent(),this.stopTraining_=!1,E=function(i){var s,u,d,m,g;return l(this,(function(b){switch(b.label){case 0:return[4,S.onEpochBegin(i)];case 1:if(b.sent(),s={},null==y)return[3,2];throw new v("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===f)throw new v("batch shuffling is not implemneted yet");f&&a.util.shuffle(w),u=a.tensor1d(w),d=mc(x,r),m=function(i){var a;return l(this,(function(l){switch(l.label){case 0:return a={},[4,S.onBatchBegin(i,a)];case 1:return l.sent(),o.tidy((function(){var l=d[i][0],f=d[i][1],m=pt(u,l,f-l);a.batch=i,a.size=f-l;for(var g=dc(e,m),v=t(g),y=0;y<n.length;++y){var b=n[y],x=v[y];a[b]=x,o.keep(x)}if(i===d.length-1&&c){var w=A.testLoop(h,p,r);for(y=0;y<n.length;++y)b=n[y],x=w[y],o.keep(x),s["val_"+b]=x}})),[4,S.onBatchEnd(i,a)];case 2:return l.sent(),vu(a),k.stopTraining_?[2,"break"]:[2]}}))},g=0,b.label=3;case 3:return g<d.length?[5,m(g)]:[3,6];case 4:if("break"===b.sent())return[3,6];b.label=5;case 5:return++g,[3,3];case 6:u.dispose(),b.label=7;case 7:return[4,S.onEpochEnd(i,s)];case 8:return b.sent(),k.stopTraining_?[2,"break"]:[2]}}))},k=this,I=m,N.label=2;case 2:return I<i?[5,E(I)]:[3,5];case 3:if("break"===N.sent())return[3,5];N.label=4;case 4:return++I,[3,2];case 5:return[4,S.onTrainEnd()];case 6:return N.sent(),[4,this.history.syncData()];case 7:return N.sent(),[2,this.history]}}))}))},e.prototype.fitDataset=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(n){return[2,cc(this,t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,a,s,u,c,p,f,d,m,g;return l(this,(function(l){switch(l.label){case 0:return[4,this.standardizeUserData(t,e)];case 1:n=l.sent(),r=n[0],i=n[1],a=this.makeTrainFunction(),s=a(r.concat(i)),u=[],l.label=2;case 2:l.trys.push([2,7,8,9]),c=h(s),p=c.next(),l.label=3;case 3:return p.done?[3,6]:[4,p.value.data()];case 4:f=l.sent(),u.push(f[0]),l.label=5;case 5:return p=c.next(),[3,3];case 6:return[3,9];case 7:return d=l.sent(),m={error:d},[3,9];case 8:try{p&&!p.done&&(g=c.return)&&g.call(c)}finally{if(m)throw m.error}return[7];case 9:return o.dispose(s),vc(n[0],t),vc(n[1],e),[2,S(u)]}}))}))},e.prototype.getNamedWeights=function(t){for(var e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n),a=0;a<r.length;++a)n&&!r[a].trainable||e.push({name:r[a].originalName,tensor:i[a]});return e},Object.defineProperty(e.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(t){this.stopTraining_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=t.prototype.dispose.call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var n=o.memory().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-o.memory().numTensors}return e},e.prototype.getLossIdentifiers=function(){var t,e,n,r,i;if("string"==typeof this.loss)i=E(this.loss);else if(Array.isArray(this.loss)){try{for(var a=h(this.loss),o=a.next();!o.done;o=a.next())if("string"!=typeof o.value)throw new Error("Serialization of non-string loss is not supported.")}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}i=this.loss.map((function(t){return E(t)}))}else{var s=Object.keys(this.loss);i={};var u=this.loss;try{for(var c=h(s),l=c.next();!l.done;l=c.next()){var p=l.value;if("string"!=typeof u[p])throw new Error("Serialization of non-string loss is not supported.");i[p]=E(u[p])}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}return i},e.prototype.getMetricIdentifiers=function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[E(Xu(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(t){return E(Xu(t))}));var t={};for(var e in this.metrics)t[e]=E(Xu(this.metrics[e]));return t},e.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},e.prototype.loadTrainingConfig=function(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var e,n,r=ku(tc(t.optimizer_config));if("string"==typeof t.loss)e=k(t.loss);else if(Array.isArray(t.loss))e=t.loss.map((function(t){return k(t)}));else if(null!=t.loss)for(var i in e={},t.loss)e[i]=k(t.loss[i]);if(Array.isArray(t.metrics))n=t.metrics.map((function(t){return k(t)}));else if(null!=t.metrics)for(var i in n={},t.metrics)n[i]=k(t.metrics[i]);this.compile({loss:e,metrics:n,optimizer:r})},e.prototype.save=function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,h,d,m,v;return l(this,(function(l){switch(l.label){case 0:if("string"==typeof t){if(0===(n=a.io.getSaveHandlers(t)).length)throw new g("Cannot find any save handlers for URL '".concat(t,"'"));if(n.length>1)throw new g("Found more than one (".concat(n.length,") save handlers for ")+"URL '".concat(t,"'"));t=n[0]}if(null==t.save)throw new g("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,a.io.encodeWeights(this.getNamedWeights(e))];case 1:return r=l.sent(),i=this.toJSON(null,!1),o={modelTopology:i,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(nc),convertedBy:null},null!=e&&e.includeOptimizer&&null!=this.optimizer?(o.trainingConfig=this.getTrainingConfig(),s="optimizer",m=(d=a.io).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,m.apply(d,[l.sent(),s])];case 3:u=l.sent(),c=u.data,h=u.specs,(v=r.specs).push.apply(v,f([],p(h),!1)),r.data=a.io.concatenateArrayBuffers([r.data,c]),l.label=4;case 4:return null!=this.userDefinedMetadata&&(Ku(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=r.data,o.weightSpecs=r.specs,[2,t.save(o)]}}))}))},e.prototype.setUserDefinedMetadata=function(t){Ku(t,this.name),this.userDefinedMetadata=t},e.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},e}(rc);_c.className="Model",a.serialization.registerClass(_c);var Sc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(_c);function Tc(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,s,u,c,h,p,f;return l(this,(function(l){switch(l.label){case 0:if(null==n&&(n={}),null==t.load)throw new g("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,t.load()];case 1:if(r=l.sent(),null!=(i=r.modelTopology).model_config&&(i=i.model_config),o=null==n.strict||n.strict,s=null!=r.weightData&&null!=r.weightSpecs&&o,u=ku(tc(i),e,s),null!=(c=r.trainingConfig)&&u.loadTrainingConfig(c),null!=r.userDefinedMetadata&&u.setUserDefinedMetadata(r.userDefinedMetadata),null==r.weightData)return[3,4];if(null==r.weightSpecs)throw new g("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return h=function(t,e){var n=a.io.decodeWeights(t,e),r={},i=[];return e.forEach((function(t){"optimizer"===t.group?i.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]})),{modelWeights:r,optimizerWeights:i}}(r.weightData,r.weightSpecs),p=h.modelWeights,f=h.optimizerWeights,u.loadWeights(p,o),null!=u.optimizer&&f.length>0?[4,u.optimizer.setWeights(f)]:[3,3];case 2:l.sent(),l.label=3;case 3:a.dispose(p),a.dispose(f.map((function(t){return t.tensor}))),l.label=4;case 4:return[2,u]}}))}))}Sc.className="Functional",a.serialization.registerClass(Sc);var Ec=function(t){function e(e){var n,r,i=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},i.trainable=!0,i.built=!1,i.name=null!=e.name?e.name:W("sequential_"),null!=e.layers)try{for(var a=h(e.layers),o=a.next();!o.done;o=a.next()){var s=o.value;i.add(s)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}return u(e,t),e.prototype.checkShape=function(t){if(t.inboundNodes[0].outputTensors[0].shape.some((function(t){return t<0})))throw new g("Negative dimension size caused by adding layer "+"".concat(t.name," with input shape [")+"".concat(t.inboundNodes[0].inputTensors[0].shape,"]"))},e.prototype.add=function(t){var n,r=t instanceof e||t instanceof _c;if(r){if(1!==(n=t).outputs.length)throw new g("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new g("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new g("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var i=he({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(r)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new g("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(t.name," ")+"which has ".concat(t.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new g("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=ce(this.outputs[0])}this.inboundNodes=[],new oe({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:x(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(t){return t.shape})),outputShapes:this.outputs[0].shape})}else{var a=t.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,e){return null==this.model&&this.build(),this.model.call(t,e)},e.prototype.build=function(t){if($t(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new _c({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.countParams=function(){return this.built||this.build(),t.prototype.countParams.call(this)},e.prototype.summary=function(e,n,r){void 0===r&&(r=console.log),this.built||this.build(),t.prototype.summary.call(this,e,n,r)},e.prototype.setWeights=function(t){null==this.model&&this.build(),this.model.setWeights(t)},e.prototype.evaluate=function(t,e,n){if(void 0===n&&(n={}),!this.built)throw new m("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)},e.prototype.evaluateDataset=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(n){if(!this.built)throw new m("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(t,e)]}))}))},e.prototype.predict=function(t,e){return void 0===e&&(e={}),null==this.model&&this.build(),this.model.predict(t,e)},e.prototype.predictOnBatch=function(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(e.prototype,"optimizer",{get:function(){return null==this.model?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t},enumerable:!1,configurable:!0}),e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),c(this,void 0,void 0,(function(){return l(this,(function(r){if(!this.built)throw new m("The model needs to be compiled before being used.");return[2,this.model.fit(t,e,n)]}))}))},e.prototype.fitDataset=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(n){if(!this.built)throw new m("The model needs to be compiled before being used.");return[2,this.model.fitDataset(t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return c(this,void 0,void 0,(function(){return l(this,(function(n){return[2,this.model.trainOnBatch(t,e)]}))}))},e.fromConfig=function(t,n,r,i){var o,s,u;void 0===i&&(i=!1);var c={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new g("Legacy serialization format not supported yet.");u=n}else a.util.assert(null!=n.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),u=n.layers,delete n.layers,c=n;var l=new t(c);if(!(l instanceof e))throw new v("Sequential.fromConfig called on non-Sequential input: ".concat(l));try{for(var p=h(u),f=p.next();!f.done;f=p.next()){var d=ku(f.value,void 0,i);i&&d.setFastWeightInitDuringBuild(!0),l.add(d)}}catch(t){o={error:t}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}return l},Object.defineProperty(e.prototype,"stopTraining",{get:function(){if(null==this.model)throw new g("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(t){if(null==this.model)throw new g("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},enumerable:!1,configurable:!0}),e.prototype.getConfig=function(){var t,e,n=[];try{for(var r=h(this.layers),i=r.next();!i.done;i=r.next()){var a=i.value,o={};o.className=a.getClassName(),o.config=a.getConfig(),n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return{name:this.name,layers:n}},e}(_c);function kc(t){return he(t)}Ec.className="Sequential",a.serialization.registerClass(Ec);var Ic=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.getConfig=function(){return{}},e}(a.serialization.Serializable),Ac=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=1),function(t,e){if(void 0===e&&(e=1),1!==e)throw new v("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return o.elu(t)}(t,e)},e}(Ic);Ac.className="elu",a.serialization.registerClass(Ac);var Nc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return o.selu(t)},e}(Ic);Nc.className="selu",a.serialization.registerClass(Nc);var Cc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return o.relu(t)},e}(Ic);Cc.className="relu",a.serialization.registerClass(Cc);var Rc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return a.tidy((function(){return o.minimum(6,o.relu(t))}))},e}(Ic);Rc.className="relu6",a.serialization.registerClass(Rc);var Oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return t},e}(Ic);Oc.className="linear",a.serialization.registerClass(Oc);var Dc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return o.sigmoid(t)},e}(Ic);Dc.className="sigmoid",a.serialization.registerClass(Dc);var Mc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return function(t){return a.tidy((function(){var e=o.add(.5,o.mul(.2,t));return o.clipByValue(e,0,1)}))}(t)},e}(Ic);Mc.className="hardSigmoid",a.serialization.registerClass(Mc);var Fc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return o.softplus(t)},e}(Ic);Fc.className="softplus",a.serialization.registerClass(Fc);var Pc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return function(t){return a.tidy((function(){return o.div(t,o.add(o.abs(t),1))}))}(t)},e}(Ic);Pc.className="softsign",a.serialization.registerClass(Pc);var Lc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return o.tanh(t)},e}(Ic);Lc.className="tanh",a.serialization.registerClass(Lc);var Bc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),o.softmax(t,e)},e}(Ic);Bc.className="softmax",a.serialization.registerClass(Bc);var zc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),o.logSoftmax(t,e)},e}(Ic);zc.className="logSoftmax",a.serialization.registerClass(zc);var Uc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=1),a.tidy((function(){return o.mul(o.sigmoid(o.mul(t,e)),t)}))},e}(Ic);Uc.className="swish",a.serialization.registerClass(Uc);var Gc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t){return a.tidy((function(){return o.mul(t,o.tanh(o.softplus(t)))}))},e}(Ic);function Wc(t){return t.getClassName()}function Vc(t,e){return void 0===e&&(e={}),C(t,a.serialization.SerializationMap.getMap().classNameMap,e,"activation")}function jc(t){var e;return null==t?Vc(e={className:"linear",config:{}}):"string"==typeof t?((e={}).className=t,e.config={},Vc(e)):t instanceof Ic?t:Vc(t)}function Hc(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(t))}Gc.className="mish",a.serialization.registerClass(Gc);var Xc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(a.serialization.Serializable),qc=function(t){function e(e){var n=t.call(this)||this;return Hc(e),n.l1=null==e||null==e.l1?.01:e.l1,n.l2=null==e||null==e.l2?.01:e.l2,n.hasL1=0!==n.l1,n.hasL2=0!==n.l2,n}return u(e,t),e.prototype.apply=function(t){var e=this;return a.tidy((function(){var n=a.zeros([1]);return e.hasL1&&(n=a.add(n,a.sum(o.mul(e.l1,a.abs(t))))),e.hasL2&&(n=a.add(n,a.sum(o.mul(e.l2,wt(t))))),o.reshape(n,[])}))},e.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},e.fromConfig=function(t,e){return new t({l1:e.l1,l2:e.l2})},e}(Xc);qc.className="L1L2",a.serialization.registerClass(qc);var Kc={l1l2:"L1L2"};function Yc(t){return A(t)}function Zc(t,e){return void 0===e&&(e={}),C(t,a.serialization.SerializationMap.getMap().classNameMap,e,"regularizer")}function $c(t){return null==t?null:"string"==typeof t?Zc({className:t in Kc?Kc[t]:t,config:{}}):t instanceof Xc?t:Zc(t)}var Jc=function(t){function e(e){var n=t.call(this,e??{})||this;return n.supportsMasking=!0,null!=e&&(n.maxValue=e.maxValue),n}return u(e,t),e.prototype.call=function(t,e){t=Zt(t);var n=a.relu(t);return null!=this.maxValue&&(n=a.clipByValue(n,0,this.maxValue)),n},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={maxValue:this.maxValue},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Jc.className="ReLU",a.serialization.registerClass(Jc);var Qc=function(t){function e(e){var n=t.call(this,e??{})||this;return n.DEFAULT_ALPHA=.3,null==e&&(e={}),n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return u(e,t),e.prototype.call=function(t,e){var n=Zt(t);return a.leakyRelu(n,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Qc.className="LeakyReLU",a.serialization.registerClass(Qc);var tl=function(t){function e(e){var n=t.call(this,e??{})||this;if(n.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),n.supportsMasking=!0,n.alphaInitializer=qt(e.alphaInitializer||n.DEFAULT_ALPHA_INITIALIZER),n.alphaRegularizer=$c(e.alphaRegularizer),n.alphaConstraint=pu(e.alphaConstraint),null==e.sharedAxes)n.sharedAxes=null;else if(Array.isArray(e.sharedAxes))n.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new g("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));n.sharedAxes=[e.sharedAxes]}return n}return u(e,t),e.prototype.build=function(t){var e,n,r=(t=$t(t)).slice(1);if(null!=this.sharedAxes)try{for(var i=h(this.sharedAxes),a=i.next();!a.done;a=i.next())r[(s=a.value)-1]=1}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var o={};if(null!=this.sharedAxes)for(var s=1;s<t.length;++s)o[s]=t[s];this.inputSpec=[new re({ndim:t.length,axes:o})],this.built=!0},e.prototype.call=function(t,e){return t=Zt(t),a.prelu(t,this.alpha.read())},e.prototype.getConfig=function(){var e={alphaInitializer:Xt(this.alphaInitializer),alphaRegularizer:Yc(this.alphaRegularizer),alphaConstraint:lu(this.alphaConstraint),sharedAxes:this.sharedAxes},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);tl.className="PReLU",a.serialization.registerClass(tl);var el=function(t){function e(e){var n=t.call(this,e??{})||this;if(n.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==n.DEFAULT_ALPHA)throw new v("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return u(e,t),e.prototype.call=function(t,e){var n=Zt(t);return a.elu(n)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);el.className="ELU",a.serialization.registerClass(el);var nl=function(t){function e(e){var n=t.call(this,e??{})||this;return n.DEFAULT_THETA=1,null==e&&(e={}),n.theta=null==e.theta?n.DEFAULT_THETA:e.theta,n}return u(e,t),e.prototype.call=function(t,e){var n=Zt(t);return a.mul(n,a.cast(a.greater(n,this.theta),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={theta:this.theta},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);nl.className="ThresholdedReLU",a.serialization.registerClass(nl);var rl=function(t){function e(e){var n=t.call(this,e??{})||this;return n.DEFAULT_AXIS=1,null==e&&(e={}),n.softmax=(new Bc).apply,n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n}return u(e,t),e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var r=Zt(t),i=e.mask;if(null!=i){var o=a.mul(a.sub(a.ones(r.shape),a.cast(i,r.dtype)),a.scalar(-1e9));r=a.add(r,o)}return n.axis instanceof Array?n.axis.length>1?a.exp(a.sub(r,a.logSumExp(r,n.axis,!0))):n.softmax(r,n.axis[0]):n.softmax(r,n.axis)}))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);function il(t,e,n){if("number"==typeof t)return x(t,e);if(t.length!==e)throw new g("The ".concat(n," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(t.length," elements."));for(var r=0;r<e;++r){var i=t[r];if((a=i)!==parseInt(a.toString(),10))throw new g("The ".concat(n," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(t)," including a")+" non-integer number ".concat(i))}return t;var a}function al(t,e,n,r,i){return void 0===i&&(i=1),null==t?t:(a="same"===n?t:t-(e+(e-1)*(i-1))+1,Math.floor((a+r-1)/r));var a}function ol(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+st([n-e,0]);else{if("same"!==r)throw new g("Unsupport padding mode: ".concat(r,"."));t*=e}return t}function sl(t,e){return a.tidy((function(){return Y(e),"channelsFirst"===e?o.transpose(t,[0,2,3,1]):t}))}function ul(t,e){return a.tidy((function(){return Y(e),"channelsFirst"===e?o.transpose(t,[0,2,3,4,1]):t}))}function cl(t,e,n,r,i,s,u,c){return void 0===r&&(r=[1,1]),void 0===i&&(i="valid"),void 0===c&&(c=null),a.tidy((function(){if(null==s&&(s="channelsLast"),Y(s),3!==t.rank&&4!==t.rank)throw new g("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));if(3!==e.rank&&4!==e.rank)throw new g("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));var a=sl(t,s);if("causal"===i)throw new v("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return a=o.fused.conv2d({x:a,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:u,dataFormat:"NHWC",bias:n,activation:c}),"channelsFirst"===s&&(a=o.transpose(a,[0,3,1,2])),a}))}rl.className="Softmax",a.serialization.registerClass(rl);var ll=function(t){function e(n,r){var i=t.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(r),i.rank=n,P(i.rank,"rank"),1!==i.rank&&2!==i.rank&&3!==i.rank)throw new v("Convolution layer for rank other than 1, 2, or 3 (".concat(i.rank,") is ")+"not implemented yet.");if(i.kernelSize=il(r.kernelSize,n,"kernelSize"),i.strides=il(null==r.strides?1:r.strides,n,"strides"),i.padding=null==r.padding?"valid":r.padding,Z(i.padding),i.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,Y(i.dataFormat),i.activation=jc(r.activation),i.useBias=null==r.useBias||r.useBias,i.biasInitializer=qt(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=pu(r.biasConstraint),i.biasRegularizer=$c(r.biasRegularizer),i.activityRegularizer=$c(r.activityRegularizer),i.dilationRate=il(null==r.dilationRate?1:r.dilationRate,n,"dilationRate"),1===i.rank&&Array.isArray(i.dilationRate)&&1!==i.dilationRate.length)throw new g("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(i.dilationRate)));if(2===i.rank){if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate];else if(2!==i.dilationRate.length)throw new g("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(i.dilationRate)))}else if(3===i.rank)if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(3!==i.dilationRate.length)throw new g("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(i.dilationRate)));return i}return u(e,t),e.verifyArgs=function(t){if(w("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!F(t.kernelSize,"number",1,3))throw new g("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(t.kernelSize),"."))},e.prototype.getConfig=function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Wc(this.activation),useBias:this.useBias,biasInitializer:Xt(this.biasInitializer),biasRegularizer:Yc(this.biasRegularizer),activityRegularizer:Yc(this.activityRegularizer),biasConstraint:lu(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue),hl=function(t){function e(n,r){var i=t.call(this,n,r)||this;return i.kernel=null,e.verifyArgs(r),i.filters=r.filters,P(i.filters,"filters"),i.kernelInitializer=qt(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=pu(r.kernelConstraint),i.kernelRegularizer=$c(r.kernelRegularizer),i}return u(e,t),e.prototype.build=function(t){var e;t=$t(t);var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new g("The channel dimension of the input should be defined. "+"Found ".concat(t[n]));var r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(e={},e[n]=r,e)}],this.built=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e;t=Zt(t);var r,i,s,u,c,l,h,p=null==n.bias?null:n.bias.read(),f=B(n.activation.getClassName());if(null!=f&&2===n.rank)e=cl(t,n.kernel.read(),p,n.strides,n.padding,n.dataFormat,n.dilationRate,f);else{if(1===n.rank)r=t,i=n.kernel.read(),s=p,u=n.strides[0],c=n.padding,l=n.dataFormat,h=n.dilationRate[0],void 0===u&&(u=1),void 0===c&&(c="valid"),void 0===h&&(h=1),e=a.tidy((function(){if(null==l&&(l="channelsLast"),Y(l),3!==r.shape.length)throw new g("The input of a conv1dWithBias operation should be 3, but is "+"".concat(r.shape.length," instead."));if(3!==i.shape.length)throw new g("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(i.shape.length," instead"));if(null!=s&&1!==s.shape.length)throw new g("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(i.shape.length," instead"));if("channelsFirst"===l&&(r=o.transpose(r,[0,2,1])),"causal"===c)throw new v("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var t=o.conv1d(r,i,u,"same"===c?"same":"valid","NWC",h);return null!=s&&(t=St(t,s)),t}));else if(2===n.rank)e=cl(t,n.kernel.read(),p,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new v("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r,i,s,u){return void 0===r&&(r=[1,1,1]),void 0===i&&(i="valid"),a.tidy((function(){if(null==s&&(s="channelsLast"),Y(s),4!==t.rank&&5!==t.rank)throw new g("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(t.rank,"."));if(4!==e.rank&&5!==e.rank)throw new g("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(t.rank,"."));var a=ul(t,s);if("causal"===i)throw new v("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=o.conv3d(a,e,r,"same"===i?"same":"valid","NDHWC",u),null!=n&&(a=St(a,n)),"channelsFirst"===s&&(a=o.transpose(a,[0,4,1,2,3])),a}))}(t,n.kernel.read(),p,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(e=n.activation.apply(e))}return e}))},e.prototype.computeOutputShape=function(t){t=$t(t);for(var e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2),r=0;r<n.length;++r){var i=al(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(i)}var a=[t[0]];return"channelsLast"===this.dataFormat?(a=a.concat(e)).push(this.filters):(a.push(this.filters),a=a.concat(e)),a},e.prototype.getConfig=function(){var e={filters:this.filters,kernelInitializer:Xt(this.kernelInitializer),kernelRegularizer:Yc(this.kernelRegularizer),kernelConstraint:lu(this.kernelConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.verifyArgs=function(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new g("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(t.filters)))},e}(ll),pl=function(t){function e(n){var r=t.call(this,2,n)||this;return e.verifyArgs(n),r}return u(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!F(t.kernelSize,"number",1,2))throw new g("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(t.kernelSize),"."))},e}(hl);pl.className="Conv2D",a.serialization.registerClass(pl);var fl=function(t){function e(n){var r=t.call(this,3,n)||this;return e.verifyArgs(n),r}return u(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new g("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(t.kernelSize),"."))},e}(hl);fl.className="Conv3D",a.serialization.registerClass(fl);var dl=function(t){function e(e){var n=t.call(this,e)||this;if(n.inputSpec=[new re({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new g("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(n.padding));return n}return u(e,t),e.prototype.build=function(t){var e;if(4!==(t=$t(t)).length)throw new g("Input should have rank 4; Received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new g("The channel dimension of the inputs should be defined. Found `None`.");var r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new re({ndim:4,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return o.tidy((function(){var e=Zt(t);if(4!==e.shape.length)throw new g("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));var r,i,a=e.shape,s=a[0];"channelsFirst"===n.dataFormat?(r=2,i=3):(r=1,i=2);var u=a[r],c=a[i],l=n.kernelSize[0],h=n.kernelSize[1],p=n.strides[0],f=n.strides[1],d=[s,ol(u,p,l,n.padding),ol(c,f,h,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(e=o.transpose(e,[0,2,3,1]));var m=o.conv2dTranspose(e,n.kernel.read(),d,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(m=o.transpose(m,[0,3,1,2])),null!=n.bias&&(m=St(m,n.bias.read(),n.dataFormat)),null!=n.activation&&(m=n.activation.apply(m)),m}))},e.prototype.computeOutputShape=function(t){var e,n,r,i=(t=$t(t)).slice();"channelsFirst"===this.dataFormat?(e=1,n=2,r=3):(e=3,n=1,r=2);var a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return i[e]=this.filters,i[n]=ol(i[n],s,a,this.padding),i[r]=ol(i[r],u,o,this.padding),i},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},e}(pl);dl.className="Conv2DTranspose",a.serialization.registerClass(dl);var ml=function(t){function e(e){var n=t.call(this,e)||this;if(n.inputSpec=[new re({ndim:5})],"same"!==n.padding&&"valid"!==n.padding)throw new g("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(n.padding));return n}return u(e,t),e.prototype.build=function(t){var e;if(5!==(t=$t(t)).length)throw new g("Input should have rank 5; Received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new g("The channel dimension of the inputs should be defined. Found `None`.");var r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new re({ndim:5,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return o.tidy((function(){var e=Zt(t);if(5!==e.shape.length)throw new g("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));var r,i,a,s=e.shape,u=s[0];"channelsFirst"===n.dataFormat?(a=2,r=3,i=4):(a=1,r=2,i=3);var c=s[a],l=s[r],h=s[i],p=n.kernelSize[0],f=n.kernelSize[1],d=n.kernelSize[2],m=n.strides[0],v=n.strides[1],y=n.strides[2],b=[u,ol(c,m,p,n.padding),ol(l,v,f,n.padding),ol(h,y,d,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(e=o.transpose(e,[0,2,3,4,1]));var x=o.conv3dTranspose(e,n.kernel.read(),b,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(x=o.transpose(x,[0,4,1,2,3])),null!==n.bias&&(x=St(x,n.bias.read(),n.dataFormat)),null!==n.activation&&(x=n.activation.apply(x)),x}))},e.prototype.computeOutputShape=function(t){var e,n,r,i,a=(t=$t(t)).slice();"channelsFirst"===this.dataFormat?(e=1,n=2,r=3,i=4):(e=4,n=1,r=2,i=3);var o=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],l=this.strides[1],h=this.strides[2];return a[e]=this.filters,a[n]=ol(a[n],c,o,this.padding),a[r]=ol(a[r],l,s,this.padding),a[i]=ol(a[i],h,u,this.padding),a},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},e}(fl);ml.className="Conv3DTranspose",a.serialization.registerClass(ml);var gl=function(t){function e(e,n){var r=t.call(this,e,n)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==n.filters)throw new g("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=n.kernelInitializer||null!=n.kernelRegularizer||null!=n.kernelConstraint)throw new g("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=n.padding&&"same"!==n.padding&&"valid"!==n.padding)throw new g("SeparableConv".concat(r.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(n.padding)));return r.depthMultiplier=null==n.depthMultiplier?1:n.depthMultiplier,r.depthwiseInitializer=qt(n.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=$c(n.depthwiseRegularizer),r.depthwiseConstraint=pu(n.depthwiseConstraint),r.pointwiseInitializer=qt(n.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=$c(n.pointwiseRegularizer),r.pointwiseConstraint=pu(n.pointwiseConstraint),r}return u(e,t),e.prototype.build=function(t){var e;if((t=$t(t)).length<this.rank+2)throw new g("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(t)));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n]||t[n]<0)throw new g("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(t[n])));for(var r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),a=[],o=0;o<this.rank;++o)a.push(1);a.push(r*this.depthMultiplier,this.filters);var s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new re({ndim:this.rank+2,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e;if(t=Zt(t),1===n.rank)throw new v("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(t=o.transpose(t,[0,2,3,1])),e=o.separableConv2d(t,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(e=St(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),"channelsFirst"===n.dataFormat&&(e=o.transpose(e,[0,3,1,2])),e}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Xt(this.depthwiseInitializer),e.pointwiseInitializer=Xt(this.pointwiseInitializer),e.depthwiseRegularizer=Yc(this.depthwiseRegularizer),e.pointwiseRegularizer=Yc(this.pointwiseRegularizer),e.depthwiseConstraint=lu(this.depthwiseConstraint),e.pointwiseConstraint=lu(this.pointwiseConstraint),e},e}(hl);gl.className="SeparableConv";var vl=function(t){function e(e){return t.call(this,2,e)||this}return u(e,t),e}(gl);vl.className="SeparableConv2D",a.serialization.registerClass(vl);var yl=function(t){function e(n){var r=t.call(this,1,n)||this;return e.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return u(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!F(t.kernelSize,"number",1,1))throw new g("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(t.kernelSize),"."))},e}(hl);yl.className="Conv1D",a.serialization.registerClass(yl);var bl=function(t){function e(e){var n=t.call(this,e)||this;return"number"==typeof e.cropping?n.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?n.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:n.cropping=e.cropping,n.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,n.inputSpec=[{ndim:4}],n}return u(e,t),e.prototype.computeOutputShape=function(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){if(t=Zt(t),"channelsLast"===n.dataFormat){var e=dt(t,n.cropping[0][0],t.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return dt(e,n.cropping[1][0],t.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}return e=dt(t,n.cropping[0][0],t.shape[2]-n.cropping[0][0]-n.cropping[0][1],3),dt(e,n.cropping[1][0],t.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))},e.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);bl.className="Cropping2D",a.serialization.registerClass(bl);var xl=function(t){function e(e){var n,r=t.call(this,e)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Y(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,n=r.interpolation,M(j,"InterpolationFormat",n),r}return u(e,t),e.prototype.computeOutputShape=function(t){if("channelsFirst"===this.dataFormat){var e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}return e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2],[t[0],e,n,t[3]]},e.prototype.call=function(t,e){var n=this;return o.tidy((function(){var e=Zt(t),r=e.shape;if("channelsFirst"===n.dataFormat){e=o.transpose(e,[0,2,3,1]);var i=n.size[0]*r[2],a=n.size[1]*r[3],s="nearest"===n.interpolation?o.image.resizeNearestNeighbor(e,[i,a]):o.image.resizeBilinear(e,[i,a]);return o.transpose(s,[0,3,1,2])}return i=n.size[0]*r[1],a=n.size[1]*r[2],"nearest"===n.interpolation?o.image.resizeNearestNeighbor(e,[i,a]):o.image.resizeBilinear(e,[i,a])}))},e.prototype.getConfig=function(){var e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);xl.className="UpSampling2D",a.serialization.registerClass(xl);var wl=function(t){function e(e){var n=t.call(this,2,e)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,n.depthwiseInitializer=qt(e.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=pu(e.depthwiseConstraint),n.depthwiseRegularizer=$c(e.depthwiseRegularizer),n}return u(e,t),e.prototype.build=function(t){if((t=$t(t)).length<4)throw new g("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(t),"."));var e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new g("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(t[e],")."));var n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){t=Zt(t);var e,r,i,s,u,c=(e=t,r=n.depthwiseKernel.read(),i=n.strides,s=n.padding,u=n.dataFormat,void 0===i&&(i=[1,1]),void 0===s&&(s="valid"),a.tidy((function(){null==u&&(u="channelsLast"),Y(u);var t=sl(e,u);if(4!==e.rank)throw new g("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==r.rank)throw new g("depthwiseKernel is required to be 4-D, but is instead "+"".concat(r.rank,"-D"));return t=o.depthwiseConv2d(t,r,i,"same"===s?"same":"valid","NHWC",null),"channelsFirst"===u&&(t=o.transpose(t,[0,3,1,2])),t})));return n.useBias&&(c=St(c,n.bias.read(),n.dataFormat)),null!=n.activation&&(c=n.activation.apply(c)),c}))},e.prototype.computeOutputShape=function(t){t=$t(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=al(e,this.kernelSize[0],this.padding,this.strides[0]),a=al(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,i,a]:[t[0],i,a,r]},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Xt(this.depthwiseInitializer),e.depthwiseRegularizer=Yc(this.depthwiseRegularizer),e.depthwiseConstraint=lu(this.depthwiseRegularizer),e},e}(ll);function _l(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new g("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function Sl(t,e,n,r,i,a,s,u){return void 0===r&&(r=!1),void 0===s&&(s=!1),void 0===u&&(u=!1),o.tidy((function(){var c=e.shape.length;if(c<3)throw new g("Input should be at least 3D, but is ".concat(c,"D."));var l=[1,0].concat(ut(2,c));if(e=o.transpose(e,l),null!=a)throw new v("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=o.cast(o.cast(i,"bool"),"float32")).rank===c-1&&(i=o.expandDims(i,-1)),i=o.transpose(i,l)),r&&(e=o.reverse(e,0),null!=i&&(i=o.reverse(i,0)));var h,p,f=[],d=n,m=e.shape[0],y=o.unstack(e);null!=i&&(p=o.unstack(i));for(var b,x=function(e){var n=y[e],r=o.tidy((function(){return t(n,d)}));if(null==i)h=r[0],d=r[1];else{var a=o.tidy((function(){var t=p[e],n=o.sub(o.onesLike(t),t);return{output:o.add(o.mul(r[0],t),o.mul(d[0],n)),newStates:d.map((function(e,i){return o.add(o.mul(r[1][i],t),o.mul(e,n))}))}}));h=a.output,d=a.newStates}u&&f.push(h)},w=0;w<m;++w)x(w);return u&&(b=o.stack(f,1)),[h,b,d]}))}wl.className="DepthwiseConv2D",a.serialization.registerClass(wl);var Tl=function(t){function e(e){var n,r=t.call(this,e)||this;if(null==e.cell)throw new g("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(e.cell)?new Ol({cells:e.cell}):e.cell).stateSize)throw new g("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new re({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return u(e,t),e.prototype.getStates=function(){return null==this.states_?ut(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(t){return null})):this.states_},e.prototype.setStates=function(t){this.states_=t},e.prototype.computeOutputShape=function(t){var e,n;Kt(t)&&(t=t[0]);var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,a=r[0];if(i=this.returnSequences?[t[0],t[1],a]:[t[0],a],this.returnState){var o=[];try{for(var s=h(r),u=s.next();!u.done;u=s.next()){var c=u.value;o.push([t[0],c])}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return[i].concat(o)}return i},e.prototype.computeMask=function(t,e){var n=this;return o.tidy((function(){Array.isArray(e)&&(e=e[0]);var t=n.returnSequences?e:null;if(n.returnState){var r=n.states.map((function(t){return null}));return[t].concat(r)}return t}))},Object.defineProperty(e.prototype,"states",{get:function(){if(null==this.states_){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[],n=0;n<t;++n)e.push(null);return e}return this.states_},set:function(t){this.states_=t},enumerable:!1,configurable:!0}),e.prototype.build=function(t){if(null!=this.numConstants)throw new v("Constants support is not implemented in RNN yet.");Kt(t)&&(t=t[0]);var e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new re({shape:f([e,null],p(n),!1)});var r,i=[t[0]].concat(t.slice(2));if(this.cell.build(i),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!a.util.arraysEqual(this.stateSpec.map((function(t){return t.shape[t.shape.length-1]})),r))throw new g("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(t){return new re({shape:[null,t]})}));this.stateful&&this.resetStates()},e.prototype.resetStates=function(t,e){var n=this;void 0===e&&(e=!1),a.tidy((function(){if(!n.stateful)throw new d("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape[0];if(null==r)throw new g("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.states_)Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(t){return o.zeros([r,t])})):n.states_=[o.zeros([r,n.cell.stateSize])];else if(null==t)o.dispose(n.states_),null!=n.keptStates&&(o.dispose(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(t){return o.zeros([r,t])})):n.states_[0]=o.zeros([r,n.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==n.states_.length)throw new g("Layer ".concat(n.name," expects ").concat(n.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));!0===e?n.keptStates.push(n.states_.slice()):o.dispose(n.states_);for(var i=0;i<n.states_.length;++i){var s=t[i],u=Array.isArray(n.cell.stateSize)?n.cell.stateSize[i]:n.cell.stateSize,c=[r,u];if(!a.util.arraysEqual(s.shape,c))throw new g("State ".concat(i," is incompatible with layer ").concat(n.name,": ")+"expected shape=".concat(c,", received shape=").concat(s.shape));n.states_[i]=s}}n.states_=n.states_.map((function(t){return o.keep(t.clone())}))}))},e.prototype.apply=function(e,n){var r,i,a=null==n?null:n.initialState,o=null==n?null:n.constants;null==n&&(n={});var s=_l(e,a,o,this.numConstants);e=s.inputs,a=s.initialState,o=s.constants;var u=[],c=[];if(null!=a){n.initialState=a,u=u.concat(a),this.stateSpec=[];try{for(var l=h(a),p=l.next();!p.done;p=l.next()){var f=p.value;this.stateSpec.push(new re({shape:f.shape}))}}catch(t){r={error:t}}finally{try{p&&!p.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}c=c.concat(this.stateSpec)}if(null!=o&&(n.constants=o,u=u.concat(o),this.numConstants=o.length),u[0]instanceof ie){var d=[e].concat(u),m=this.inputSpec.concat(c),g=this.inputSpec;this.inputSpec=m;var v=t.prototype.apply.call(this,d,n);return this.inputSpec=g,v}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var r=null==e?null:e.mask,i=null==e?null:e.training,a=null==e?null:e.initialState;t=Zt(t),null==a&&(a=n.stateful?n.states_:n.getInitialState(t));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(a.length!==o)throw new g("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(a.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:i},u=Sl((function(t,e){var r=n.cell.call([t].concat(e),s);return[r[0],r.slice(1)]}),t,a,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],h=u[2];n.stateful&&n.resetStates(h,i);var p=n.returnSequences?l:c;return n.returnState?[p].concat(h):p}))},e.prototype.getInitialState=function(t){var e=this;return a.tidy((function(){var n=o.zeros(t.shape);return n=ht(n=o.sum(n,[1,2])),Array.isArray(e.cell.stateSize)?e.cell.stateSize.map((function(t){return t>1?vt(n,[1,t]):n})):e.cell.stateSize>1?[vt(n,[1,e.cell.stateSize])]:[n]}))},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!1,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var n=t.prototype.getConfig.call(this),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(r.numConstants=this.numConstants);var i=this.cell.getConfig();return this.getClassName()===e.className&&(r.cell={className:this.cell.getClassName(),config:i}),Object.assign(Object.assign(Object.assign({},i),n),r)},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=ku(e.cell,n);return new t(Object.assign(e,{cell:r}))},e}(ue);Tl.className="RNN",a.serialization.registerClass(Tl);var El=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(ue),kl=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,P(n.units,"units"),n.activation=jc(null==e.activation?n.DEFAULT_ACTIVATION:e.activation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=qt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=qt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=qt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=$c(e.kernelRegularizer),n.recurrentRegularizer=$c(e.recurrentRegularizer),n.biasRegularizer=$c(e.biasRegularizer),n.kernelConstraint=pu(e.kernelConstraint),n.recurrentConstraint=pu(e.recurrentConstraint),n.biasConstraint=pu(e.biasConstraint),n.dropout=ot([1,st([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=ot([1,st([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.dropoutFunc=e.dropoutFunc,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return u(e,t),e.prototype.build=function(t){t=$t(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){if(2!==t.length)throw new g("SimpleRNNCell expects 2 input Tensors, got ".concat(t.length,"."));var r=t[1];t=t[0];var i,a=null!=e.training&&e.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dl({ones:function(){return o.onesLike(t)},rate:n.dropout,training:a,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dl({ones:function(){return o.onesLike(r)},rate:n.recurrentDropout,training:a,dropoutFunc:n.dropoutFunc}));var s=n.dropoutMask,u=n.recurrentDropoutMask;i=bt(null!=s?o.mul(t,s):t,n.kernel.read()),null!=n.bias&&(i=St(i,n.bias.read())),null!=u&&(r=o.mul(r,u));var c=o.add(i,bt(r,n.recurrentKernel.read()));return null!=n.activation&&(c=n.activation.apply(c)),[c,c]}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={units:this.units,activation:Wc(this.activation),useBias:this.useBias,kernelInitializer:Xt(this.kernelInitializer),recurrentInitializer:Xt(this.recurrentInitializer),biasInitializer:Xt(this.biasInitializer),kernelRegularizer:Yc(this.kernelRegularizer),recurrentRegularizer:Yc(this.recurrentRegularizer),biasRegularizer:Yc(this.biasRegularizer),activityRegularizer:Yc(this.activityRegularizer),kernelConstraint:lu(this.kernelConstraint),recurrentConstraint:lu(this.recurrentConstraint),biasConstraint:lu(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)},e}(El);kl.className="SimpleRNNCell",a.serialization.registerClass(kl);var Il=function(t){function e(e){return e.cell=new kl(e),t.call(this,e)||this}return u(e,t),e.prototype.call=function(e,n){var r=this;return a.tidy((function(){null!=r.cell.dropoutMask&&(o.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(o.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var i=null==n?null:n.mask,a=null==n?null:n.training,s=null==n?null:n.initialState;return t.prototype.call.call(r,e,{mask:i,training:a,initialState:s})}))},e.fromConfig=function(t,e){return new t(e)},e}(Tl);Il.className="SimpleRNN",a.serialization.registerClass(Il);var Al=function(t){function e(e){var n=t.call(this,e)||this;if(n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new g("GRUCell does not support reset_after parameter set to true.");return n.units=e.units,P(n.units,"units"),n.activation=jc(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=jc(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=qt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=qt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=qt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=$c(e.kernelRegularizer),n.recurrentRegularizer=$c(e.recurrentRegularizer),n.biasRegularizer=$c(e.biasRegularizer),n.kernelConstraint=pu(e.kernelConstraint),n.recurrentConstraint=pu(e.recurrentConstraint),n.biasConstraint=pu(e.biasConstraint),n.dropout=ot([1,st([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=ot([1,st([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.dropoutFunc=e.dropoutFunc,n.implementation=e.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return u(e,t),e.prototype.build=function(t){var e=(t=$t(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){if(2!==t.length)throw new g("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));var r=null!=e.training&&e.training,i=t[1];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dl({ones:function(){return o.onesLike(t)},rate:n.dropout,training:r,count:3,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dl({ones:function(){return o.onesLike(i)},rate:n.recurrentDropout,training:r,count:3,dropoutFunc:n.dropoutFunc}));var a,s,u,c=n.dropoutMask,l=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=o.mul(t,c[0]));var h=bt(t,n.kernel.read());n.useBias&&(h=St(h,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(i=o.mul(i,l[0]));var f=n.recurrentKernel.read(),d=p(o.split(f,[2*n.units,n.units],f.rank-1),2),m=d[0],v=d[1],y=bt(i,m),b=p(o.split(h,3,h.rank-1),3),x=b[0],w=b[1],_=b[2],S=p(o.split(y,2,y.rank-1),2),T=S[0],E=S[1];a=n.recurrentActivation.apply(o.add(x,T)),s=n.recurrentActivation.apply(o.add(w,E));var k=bt(o.mul(s,i),v);u=n.activation.apply(o.add(_,k));var I=o.add(o.mul(a,i),o.mul(o.add(1,o.neg(a)),u));return[I,I]}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={units:this.units,activation:Wc(this.activation),recurrentActivation:Wc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Xt(this.kernelInitializer),recurrentInitializer:Xt(this.recurrentInitializer),biasInitializer:Xt(this.biasInitializer),kernelRegularizer:Yc(this.kernelRegularizer),recurrentRegularizer:Yc(this.recurrentRegularizer),biasRegularizer:Yc(this.biasRegularizer),activityRegularizer:Yc(this.activityRegularizer),kernelConstraint:lu(this.kernelConstraint),recurrentConstraint:lu(this.recurrentConstraint),biasConstraint:lu(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)},e}(El);Al.className="GRUCell",a.serialization.registerClass(Al);var Nl=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Al(e),t.call(this,e)||this}return u(e,t),e.prototype.call=function(e,n){var r=this;return a.tidy((function(){null!=r.cell.dropoutMask&&(o.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(o.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var i=null==n?null:n.mask,a=null==n?null:n.training,s=null==n?null:n.initialState;return t.prototype.call.call(r,e,{mask:i,training:a,initialState:s})}))},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e}(Tl);Nl.className="GRU",a.serialization.registerClass(Nl);var Cl=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,P(n.units,"units"),n.activation=jc(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=jc(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=qt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=qt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=qt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=e.unitForgetBias,n.kernelRegularizer=$c(e.kernelRegularizer),n.recurrentRegularizer=$c(e.recurrentRegularizer),n.biasRegularizer=$c(e.biasRegularizer),n.kernelConstraint=pu(e.kernelConstraint),n.recurrentConstraint=pu(e.recurrentConstraint),n.biasConstraint=pu(e.biasConstraint),n.dropout=ot([1,st([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=ot([1,st([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.dropoutFunc=e.dropoutFunc,n.implementation=e.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return u(e,t),e.prototype.build=function(t){var e,n,r=(t=$t(t))[t.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var i=this.biasInitializer,a=this.units;n=new(e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){var n=i.apply([a]),r=(new Ct).apply([a]),o=i.apply([2*a]);return gt(gt(n,r),o)},e}(At),e.className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var r=null!=e.training&&e.training;if(3!==t.length)throw new g("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));var i=t[1],a=t[2];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dl({ones:function(){return o.onesLike(t)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dl({ones:function(){return o.onesLike(i)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var s,u,c,l,h=n.dropoutMask,f=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=o.mul(t,h[0]));var d=bt(t,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(i=o.mul(i,f[0])),d=o.add(d,bt(i,n.recurrentKernel.read())),n.useBias&&(d=St(d,n.bias.read()));var m=p(o.split(d,4,d.rank-1),4),v=m[0],y=m[1],b=m[2],x=m[3];s=n.recurrentActivation.apply(v),u=n.recurrentActivation.apply(y),c=o.add(o.mul(u,a),o.mul(s,n.activation.apply(b))),l=n.recurrentActivation.apply(x);var w=o.mul(l,n.activation.apply(c));return[w,w,c]}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={units:this.units,activation:Wc(this.activation),recurrentActivation:Wc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Xt(this.kernelInitializer),recurrentInitializer:Xt(this.recurrentInitializer),biasInitializer:Xt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Yc(this.kernelRegularizer),recurrentRegularizer:Yc(this.recurrentRegularizer),biasRegularizer:Yc(this.biasRegularizer),activityRegularizer:Yc(this.activityRegularizer),kernelConstraint:lu(this.kernelConstraint),recurrentConstraint:lu(this.recurrentConstraint),biasConstraint:lu(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)},e}(El);Cl.className="LSTMCell",a.serialization.registerClass(Cl);var Rl=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Cl(e),t.call(this,e)||this}return u(e,t),e.prototype.call=function(e,n){var r=this;return a.tidy((function(){null!=r.cell.dropoutMask&&(o.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(o.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var i=null==n?null:n.mask,a=null==n?null:n.training,s=null==n?null:n.initialState;return t.prototype.call.call(r,e,{mask:i,training:a,initialState:s})}))},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e}(Tl);Rl.className="LSTM",a.serialization.registerClass(Rl);var Ol=function(t){function e(e){var n=t.call(this,e)||this;return n.cells=e.cells,n}return u(e,t),Object.defineProperty(e.prototype,"stateSize",{get:function(){var t,e,n=[];try{for(var r=h(this.cells.slice().reverse()),i=r.next();!i.done;i=r.next()){var a=i.value;Array.isArray(a.stateSize)?n.push.apply(n,f([],p(a.stateSize),!1)):n.push(a.stateSize)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var r,i,a,o,s=t.slice(1),u=[];try{for(var c=h(n.cells.slice().reverse()),l=c.next();!l.done;l=c.next()){var d=l.value;Array.isArray(d.stateSize)?u.push(s.splice(0,d.stateSize.length)):u.push(s.splice(0,1))}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}u.reverse();for(var m,g=[],v=0;v<n.cells.length;++v)d=n.cells[v],s=u[v],m=0===v?[t[0]].concat(s):[m[0]].concat(s),m=d.call(m,e),g.push(m.slice(1));s=[];try{for(var y=h(g.slice().reverse()),b=y.next();!b.done;b=y.next()){var x=b.value;s.push.apply(s,f([],p(x),!1))}}catch(t){a={error:t}}finally{try{b&&!b.done&&(o=y.return)&&o.call(y)}finally{if(a)throw a.error}}return[m[0]].concat(s)}))},e.prototype.build=function(t){var e;Kt(t)&&(t=t[0]),this.cells.forEach((function(n,r){Q("RNNCell_".concat(r),(function(){n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={cells:this.cells.map((function(t){return{className:t.getClassName(),config:t.getConfig()}}))};return Object.assign(Object.assign({},e),n)},e.fromConfig=function(t,e,n){var r,i;void 0===n&&(n={});var a=[];try{for(var o=h(e.cells),s=o.next();!s.done;s=o.next()){var u=s.value;a.push(ku(u,n))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return new t({cells:a})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){var t,e;if(!this.trainable)return[];var n=[];try{for(var r=h(this.cells),i=r.next();!i.done;i=r.next()){var a=i.value;n.push.apply(n,f([],p(a.trainableWeights),!1))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){var t,e,n,r,i=[];try{for(var a=h(this.cells),o=a.next();!o.done;o=a.next()){var s=o.value;i.push.apply(i,f([],p(s.nonTrainableWeights),!1))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}if(!this.trainable){var u=[];try{for(var c=h(this.cells),l=c.next();!l.done;l=c.next())s=l.value,u.push.apply(u,f([],p(s.trainableWeights),!1))}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u.concat(i)}return i},enumerable:!1,configurable:!0}),e.prototype.getWeights=function(){var t,e,n=[];try{for(var r=h(this.cells),i=r.next();!i.done;i=r.next()){var a=i.value;n.push.apply(n,f([],p(a.weights),!1))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return ee(n)},e.prototype.setWeights=function(t){var e,n,r=[];try{for(var i=h(this.cells),a=i.next();!a.done;a=i.next())for(var o=a.value,s=o.weights.length,u=t.splice(s),c=0;c<o.weights.length;++c)r.push([o.weights[c],u[c]])}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}ne(r)},e}(El);function Dl(t){var e=t.ones,n=t.rate,r=t.training,i=void 0!==r&&r,a=t.count,s=void 0===a?1:a,u=t.dropoutFunc,c=function(){return null!=u?u(e(),n):Tt(e(),n)},l=function(){return Et(c,e,i)};return!s||s<=1?o.keep(l().clone()):Array(s).fill(void 0).map(l).map((function(t){return o.keep(t.clone())}))}Ol.className="StackedRNNCells",a.serialization.registerClass(Ol);!function(t){u((function(){return null!==t&&t.apply(this,arguments)||this}),t)}(El);var Ml=function(t){function e(e){var n=this;if(e.unroll)throw new v("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new v("It is not possible at the moment to stack convolutional cells.");return(n=t.call(this,e)||this).inputSpec=[new re({ndim:5})],n}return u(e,t),e.prototype.call=function(e,n){var r=this;return o.tidy((function(){if(null!=r.cell.dropoutMask&&(o.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(o.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),n&&n.constants)throw new g("ConvRNN2D cell does not support constants");var i=null==n?null:n.mask,a=null==n?null:n.training,s=null==n?null:n.initialState;return t.prototype.call.call(r,e,{mask:i,training:a,initialState:s})}))},e.prototype.computeOutputShape=function(t){var e=this.computeSingleOutputShape(t);return this.returnSequences||(e=f([e[0]],p(e.slice(2)),!1)),this.returnState&&(e=f([e],p(Array(2).fill(f([t[0]],p(e.slice(-3)),!1))),!1)),e},e.prototype.getInitialState=function(t){var e=this;return o.tidy((function(){var n=e.cell.stateSize,r=t.shape,i=e.computeSingleOutputShape(r),a=f([i[0]],p(i.slice(2)),!1),s=o.zeros(a);return Array.isArray(n)?Array(n.length).fill(s):[s]}))},e.prototype.resetStates=function(t,e){var n=this;void 0===e&&(e=!1),o.tidy((function(){if(!n.stateful)throw new d("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape,i=n.computeSingleOutputShape(r),s=f([i[0]],p(i.slice(2)),!1);if(null==r[0])throw new g("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.getStates())Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(){return o.zeros(s)})):n.states_=[o.zeros(s)];else if(null==t)o.dispose(n.states_),null!=n.keptStates&&(o.dispose(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(){return o.zeros(s)})):n.states_[0]=o.zeros(s);else{if(Array.isArray(t)||(t=[t]),t.length!==n.states_.length)throw new g("Layer ".concat(n.name," expects ").concat(n.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));e?n.keptStates.push(n.states_.slice()):o.dispose(n.states_);for(var u=0;u<n.states_.length;++u){var c=t[u],l=s;if(!a.util.arraysEqual(c.shape,l))throw new g("State ".concat(u," is incompatible with layer ").concat(n.name,": ")+"expected shape=".concat(l,", received shape=").concat(c.shape));n.states_[u]=c}}n.states_=n.states_.map((function(t){return o.keep(t.clone())}))}))},e.prototype.computeSingleOutputShape=function(t){var e=this.cell,n=e.dataFormat,r=e.filters,i=e.kernelSize,a=e.padding,o=e.strides,s=e.dilationRate,u="channelsFirst"===n,c=t[u?3:2],l=t[u?4:3],h=al(c,i[0],a,o[0],s[0]),d=al(l,i[1],a,o[1],s[1]);return f(f([],p(t.slice(0,2)),!1),p(u?[r,h,d]:[h,d,r]),!1)},e}(Tl);Ml.className="ConvRNN2D";var Fl=function(t){function e(e){var n=this,r=e.filters,i=e.kernelSize,a=e.strides,o=e.padding,s=e.dataFormat,u=e.dilationRate;return(n=t.call(this,Object.assign(Object.assign({},e),{units:r}))||this).filters=r,P(n.filters,"filters"),n.kernelSize=il(i,2,"kernelSize"),n.kernelSize.forEach((function(t){return P(t,"kernelSize")})),n.strides=il(a||1,2,"strides"),n.strides.forEach((function(t){return P(t,"strides")})),n.padding=o||"valid",Z(n.padding),n.dataFormat=s||"channelsLast",Y(n.dataFormat),n.dilationRate=il(u||1,2,"dilationRate"),n.dilationRate.forEach((function(t){return P(t,"dilationRate")})),n}return u(e,t),e.prototype.build=function(t){var e;t=$t(t);var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new g("The channel dimension of the input should be defined. "+"Found ".concat(t[n]));var r=t[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var a=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var s=void 0;if(this.unitForgetBias){var c=this.biasInitializer,l=this.filters;s=new(e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.apply=function(t,e){return mt([c.apply([l]),o.ones([l]),c.apply([2*l])])},e}(At),e.className="CustomInit",e)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,s,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0},e.prototype.call=function(t,e){var n=this;return o.tidy((function(){if(3!==t.length)throw new g("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));var r=e.training||!1,i=t[0],a=t[1],s=t[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dl({ones:function(){return o.onesLike(i)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var u=n.dropoutMask,c=function(t,e,n){return e&&e[n]?o.mul(e[n],t):t},l=c(i,u,0),h=c(i,u,1),f=c(i,u,2),d=c(i,u,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dl({ones:function(){return o.onesLike(a)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var m=n.recurrentDropoutMask,v=c(a,m,0),y=c(a,m,1),b=c(a,m,2),x=c(a,m,3),w=p(o.split(n.kernel.read(),4,3),4),_=w[0],S=w[1],T=w[2],E=w[3],k=p(n.useBias?o.split(n.bias.read(),4):[null,null,null,null],4),I=k[0],A=k[1],N=k[2],C=k[3];l=n.inputConv(l,_,I,n.padding),h=n.inputConv(h,S,A,n.padding),f=n.inputConv(f,T,N,n.padding),d=n.inputConv(d,E,C,n.padding);var R=p(o.split(n.recurrentKernel.read(),4,3),4),O=R[0],D=R[1],M=R[2],F=R[3];v=n.recurrentConv(v,O),y=n.recurrentConv(y,D),b=n.recurrentConv(b,M),x=n.recurrentConv(x,F);var P=n.recurrentActivation.apply(o.add(l,v)),L=n.recurrentActivation.apply(o.add(h,y)),B=o.add(o.mul(L,s),o.mul(P,n.activation.apply(o.add(f,b)))),z=o.mul(n.recurrentActivation.apply(o.add(d,x)),n.activation.apply(B));return[z,z,B]}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);e.units;var n=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)},e.prototype.inputConv=function(t,e,n,r){var i=o.conv2d(t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?St(i,n,this.dataFormat):i},e.prototype.recurrentConv=function(t,e){return o.conv2d(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")},e}(Cl);Fl.className="ConvLSTM2DCell",o.serialization.registerClass(Fl);var Pl=function(t){function e(e){var n=new Fl(e);return t.call(this,Object.assign(Object.assign({},e),{cell:n}))||this}return u(e,t),e.fromConfig=function(t,e){return new t(e)},e}(Ml);Pl.className="ConvLSTM2D",o.serialization.registerClass(Pl);var Ll=function(t){function e(e){var n=t.call(this,e)||this;return n.rate=Math.max(Math.min(e.rate,1),0),n.noiseShape=e.noiseShape,n.seed=e.seed,n.supportsMasking=!0,n}return u(e,t),e.prototype.getNoiseShape=function(t){if(null==this.noiseShape)return this.noiseShape;for(var e=t.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t);if(0<n.rate&&n.rate<1){var i=null!=e.training&&e.training,a=n.getNoiseShape(r);return Et((function(){return Tt(r,n.rate,a,n.seed)}),(function(){return r}),i)}return t}))},e.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.dispose=function(){return t.prototype.dispose.call(this)},e}(ue);Ll.className="Dropout",a.serialization.registerClass(Ll);var Bl=function(t){function e(e){var n=t.call(this,e)||this;return n.inputSpec=[{ndim:3}],n}return u(e,t),e.prototype.getNoiseShape=function(t){var e=t.shape;return[e[0],1,e[2]]},e}(Ll);Bl.className="SpatialDropout1D",a.serialization.registerClass(Bl);var zl=function(t){function e(e){var n=t.call(this,e)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=[r,e.inputDim]}return n.units=e.units,P(n.units,"units"),n.activation=jc(e.activation),null!=e.useBias&&(n.useBias=e.useBias),n.kernelInitializer=qt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=qt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=pu(e.kernelConstraint),n.biasConstraint=pu(e.biasConstraint),n.kernelRegularizer=$c(e.kernelRegularizer),n.biasRegularizer=$c(e.biasRegularizer),n.activityRegularizer=$c(e.activityRegularizer),n.supportsMasking=!0,n.inputSpec=[{minNDim:2}],n}return u(e,t),e.prototype.build=function(t){var e,n=(t=$t(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(e={},e[-1]=n,e)}],this.built=!0},e.prototype.computeOutputShape=function(t){var e=(t=$t(t)).slice();return e[e.length-1]=this.units,e},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r,i=Zt(t),a=B(n.activation.getClassName());return null!=a?r=bt(i,n.kernel.read(),a,n.bias?n.bias.read():null):(r=bt(i,n.kernel.read()),null!=n.bias&&(r=St(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))},e.prototype.getConfig=function(){var e={units:this.units,activation:Wc(this.activation),useBias:this.useBias,kernelInitializer:Xt(this.kernelInitializer),biasInitializer:Xt(this.biasInitializer),kernelRegularizer:Yc(this.kernelRegularizer),biasRegularizer:Yc(this.biasRegularizer),activityRegularizer:Yc(this.activityRegularizer),kernelConstraint:lu(this.kernelConstraint),biasConstraint:lu(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);zl.className="Dense",a.serialization.registerClass(zl);var Ul=function(t){function e(e){var n=this;return e=e||{},(n=t.call(this,e)||this).inputSpec=[{minNDim:3}],n.dataFormat=e.dataFormat,n}return u(e,t),e.prototype.computeOutputShape=function(t){var e,n;t=$t(t);try{for(var r=h(t.slice(1)),i=r.next();!i.done;i=r.next())if(null==i.value)throw new g('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(t.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return[t[0],at(t,1)]},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var i=[0],s=2;s<r.rank;++s)i.push(s);i.push(1),r=a.transpose(r,i)}return function(t){if(t.rank<=1)throw new g("batchFlatten requires a minimum rank of 2. Got rank: ".concat(t.rank,"."));var e=[t.shape[0],at(t.shape,1)];return o.reshape(t,e)}(r)}))},e.prototype.getConfig=function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Ul.className="Flatten",a.serialization.registerClass(Ul);var Gl=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.activation=jc(e.activation),n}return u(e,t),e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t);return n.activation.apply(r)}))},e.prototype.getConfig=function(){var e={activation:Wc(this.activation)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Gl.className="Activation",a.serialization.registerClass(Gl);var Wl=function(t){function e(e){var n=t.call(this,e)||this;return n.n=e.n,n.inputSpec=[{ndim:2}],n}return u(e,t),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){return t=Zt(t),e=t,r=n.n,a.tidy((function(){if(2!==e.shape.length)throw new g("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return vt(ht(e,1),[1,r,1])}));var e,r}))},e.prototype.getConfig=function(){var e={n:this.n},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Wl.className="RepeatVector",a.serialization.registerClass(Wl);var Vl=function(t){function e(e){var n=t.call(this,e)||this;n.targetShape=e.targetShape;for(var r=0;r<n.targetShape.length;++r)n.isUnknown(n.targetShape[r])&&(n.targetShape[r]=null);return n}return u(e,t),e.prototype.isUnknown=function(t){return t<0||null==t},e.prototype.fixUnknownDimension=function(t,e){for(var n="Total size of new array must be unchanged.",r=e.slice(),i=1,a=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==a)throw new g("Can only specifiy one unknown dimension.");a=o}else i*=s}var u=at(t);if(null!==a){if(0===i||u%i!=0)throw new g(n);r[a]=u/i}else if(u!==i)throw new g(n);return r},e.prototype.computeOutputShape=function(t){for(var e=!1,n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t),i=r.shape,o=i.slice(0,1).concat(n.fixUnknownDimension(i.slice(1),n.targetShape));return a.reshape(r,o)}))},e.prototype.getConfig=function(){var e={targetShape:this.targetShape},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Vl.className="Reshape",a.serialization.registerClass(Vl);var jl=function(t){function e(e){var n=t.call(this,e)||this;if(null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var r=ut(1,e.dims.length+1);if(!a.util.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=e.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new re({ndim:n.dims.length+1})],n}return u(e,t),e.prototype.computeOutputShape=function(t){var e=(t=$t(t)).slice();return this.dims.forEach((function(n,r){e[r+1]=t[n]})),e},e.prototype.call=function(t,e){return a.transpose(Zt(t),this.dimsIncludingBatch)},e.prototype.getConfig=function(){var e={dims:this.dims},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);jl.className="Permute",a.serialization.registerClass(jl);var Hl=function(t){function e(e){var n=t.call(this,e??{})||this;return n.supportsMasking=!0,n.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,n}return u(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={maskValue:this.maskValue};return Object.assign(n,e),n},e.prototype.computeMask=function(t,e){var n=Zt(t);return a.any(a.notEqual(n,this.maskValue),-1)},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t),i=a.any(a.notEqual(r,n.maskValue),-1,!0);return a.mul(r,a.cast(i,r.dtype))}))},e}(ue);Hl.className="Masking",a.serialization.registerClass(Hl);var Xl=function(t){function e(e){var n=t.call(this,e)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var r=null;null!=e.batchSize&&(r=e.batchSize),null==e.inputLength?n.batchInputShape=[r,null]:n.batchInputShape=[r].concat(T(e.inputLength))}return n.inputDim=e.inputDim,P(n.inputDim,"inputDim"),n.outputDim=e.outputDim,P(n.outputDim,"outputDim"),n.embeddingsInitializer=qt(e.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=$c(e.embeddingsRegularizer),n.activityRegularizer=$c(e.activityRegularizer),n.embeddingsConstraint=pu(e.embeddingsConstraint),n.maskZero=e.maskZero,n.supportsMasking=e.maskZero,n.inputLength=e.inputLength,n}return u(e,t),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.warnOnIncompatibleInputShape=function(t){},e.prototype.computeMask=function(t,e){var n=this;return a.tidy((function(){return n.maskZero?(t=Zt(t),a.notEqual(t,a.zerosLike(t))):null}))},e.prototype.computeOutputShape=function(t){if(t=$t(t),null==this.inputLength)return f(f([],p(t),!1),[this.outputDim],!1);var e=T(this.inputLength);if(e.length!==t.length-1)throw new g('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));for(var n=0,r=0;r<e.length;++r){var i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new g('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));null==i&&(e[n]=a),n++}return f(f([t[0]],p(e),!1),[this.outputDim],!1)},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t);"int32"!==r.dtype&&(r=lt(r,"int32"));var i=xt(n.embeddings.read(),a.reshape(r,[r.size]));return a.reshape(i,$t(n.computeOutputShape(r.shape)))}))},e.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Xt(this.embeddingsInitializer),embeddingsRegularizer:Yc(this.embeddingsRegularizer),activityRegularizer:Yc(this.activityRegularizer),embeddingsConstraint:lu(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Xl.className="Embedding",a.serialization.registerClass(Xl);var ql=function(t){function e(e){var n=t.call(this,e||{})||this;return n.supportsMasking=!0,n}return u(e,t),e.prototype.mergeFunction=function(t){throw new v},e.prototype.computeElementwiseOpOutputShape=function(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;for(var n=t.slice(0,t.length-e.length),r=0;r<e.length;++r){var i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new g("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n},e.prototype.build=function(t){var e,n;if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[$t(t)]),t.length<2)throw new g("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(t.length," input(s)."));var r=[];try{for(var i=h(t),a=i.next();!a.done;a=i.next())null!=(u=a.value)&&null!==u[0]&&r.push(u[0])}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}if((r=O(r)).length>1)throw new g("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(t),"."));for(var o=null==t[0]?null:t[0].slice(1),s=1;s<t.length;++s){var u=null==t[s]?null:t[s].slice(1);o=this.computeElementwiseOpOutputShape(o,u)}var c=t.map((function(t){return t.length}));-1===t.indexOf(null)&&1===O(c).length?this.reshapeRequired=!1:this.reshapeRequired=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e,r,i,a;if(n.reshapeRequired){var s=[],u=t.map((function(t){return t.rank}));if(-1===u.indexOf(null)){var c=st(u);try{for(var l=h(t),p=l.next();!p.done;p=l.next()){for(var f=(y=p.value).rank,d=0;d<c-f;++d)y=ht(y,1);s.push(y)}}catch(t){e={error:t}}finally{try{p&&!p.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}return n.mergeFunction(s)}var m=!1;try{for(var g=h(t),v=g.next();!v.done;v=g.next()){var y;if(null==(f=(y=v.value).rank)){var b=y.shape,x=b[0],w=b.slice(1).concat([x]),_=o.reshape(y,[x].concat(at(b.slice(1))));_=o.transpose(_,[1,0]),_=o.reshape(_,w),s.push(_),m=!0}else if(f>1){var S=ut(1,f).concat([0]);s.push(o.transpose(y,S)),m=!0}else s.push(y)}}catch(t){i={error:t}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}var T=n.mergeFunction(s),E=T.rank;if(m)if(null==E){var k=T.shape;w=[x=k[k.length-1]].concat(k.slice(0,k.length-1)),T=o.reshape(o.transpose(o.reshape(T,[-1,x]),[1,0]),w)}else E>1&&(S=[E-1].concat(ut(0,E-1)),T=o.transpose(T,S));return T}return n.mergeFunction(t)}))},e.prototype.computeOutputShape=function(t){var e,n,r;r=null==t[0]?null:t[0].slice(1);for(var i=1;i<t.length;++i){var a=null==t[i]?null:t[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}var o=[];try{for(var s=h(t),u=s.next();!u.done;u=s.next())null!=(a=u.value)&&null!==a[0]&&o.push(a[0])}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return 1===(o=O(o)).length?o.concat(r):[null].concat(r)},e.prototype.computeMask=function(t,e){return o.tidy((function(){if(null==e)return null;if(!Array.isArray(e))throw new g("`mask` should be an Array");if(!Array.isArray(t))throw new g("`inputs` should be an Array");if(e.length!==t.length)throw new g("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(t.length," vs ").concat(e.length,")"));if(e.every((function(t){return null==t})))return null;for(var n=(e=e.map((function(t){return null==t?t:o.expandDims(t,0)})))[0],r=1;r<e.length-1;++r)n=o.logicalAnd(n,e[r]);return n}))},e}(ue),Kl=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.mergeFunction=function(t){return a.tidy((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=o.add(e,t[n]);return e}))},e}(ql);Kl.className="Add",a.serialization.registerClass(Kl);var Yl=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.mergeFunction=function(t){return a.tidy((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=o.mul(e,t[n]);return e}))},e}(ql);Yl.className="Multiply",a.serialization.registerClass(Yl);var Zl=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.mergeFunction=function(t){return a.tidy((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=o.add(e,t[n]);return o.mul(1/t.length,e)}))},e}(ql);Zl.className="Average",a.serialization.registerClass(Zl);var $l=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.mergeFunction=function(t){return a.tidy((function(){for(var e=t[0],n=1;n<t.length;++n)e=o.maximum(e,t[n]);return e}))},e}(ql);$l.className="Maximum",a.serialization.registerClass($l);var Jl=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.mergeFunction=function(t){return a.tidy((function(){for(var e=t[0],n=1;n<t.length;++n)e=o.minimum(e,t[n]);return e}))},e}(ql);Jl.className="Minimum",a.serialization.registerClass(Jl);var Ql=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_AXIS=-1,null==e&&(e={}),n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return u(e,t),e.prototype.build=function(t){var e,n,r,i;if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new g("A `Concatenate` layer should be called on a list of at least 2 inputs");var o=!0;try{for(var s=h(t),u=s.next();!u.done;u=s.next())if(null!=(v=u.value)){o=!1;break}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}if(!o){for(var c=[],l=0;l<t.length;++l){var p=t[l].slice();p.splice(this.axis,1);var f=!1;try{for(var d=(r=void 0,h(c)),m=d.next();!m.done;m=d.next()){var v=m.value;if(a.util.arraysEqual(v,p)){f=!0;break}}}catch(t){r={error:t}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}f||c.push(p)}if(c.length>1)throw new g("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){var e=this;return a.tidy((function(){return mt(t,e.axis)}))},e.prototype.computeOutputShape=function(t){var e,n;if(!Array.isArray(t)||!Array.isArray(t[0]))throw new g("A `Concatenate` layer should be called on a list of inputs.");var r=t,i=r[0].slice(),a=this.axis<0?i.length+this.axis:this.axis;try{for(var o=h(r.slice(1)),s=o.next();!s.done;s=o.next()){var u=s.value;if(null==i[a]||null==u[a]){i[a]=null;break}i[a]+=u[a]}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i},e.prototype.computeMask=function(t,e){var n=this;if(null==e)return null;if(!Array.isArray(e))throw new g("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new g("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new g("Mismatch in the length of mask (".concat(e.length,") ")+"and the legnth of inputs (".concat(t.length,")"));return o.tidy((function(){var r=!0;if(e.forEach((function(t){null==t||(r=!1)})),r)return null;for(var i=[],a=0;a<t.length;++a)null==e[a]?i.push(o.cast(o.onesLike(t[a]),"bool")):e[a].rank<t[a].rank?i.push(o.expandDims(e[a],-1)):i.push(e[a]);var s=o.concat(i,n.axis);return o.all(s,-1,!1)}))},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ql);function th(t,e){for(;t<0;)t+=e;return t}Ql.className="Concatenate",a.serialization.registerClass(Ql);var eh=function(t){function e(e){var n=t.call(this,e)||this;return n.axes=e.axes,n.normalize=null!=e.normalize&&e.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return u(e,t),e.prototype.build=function(t){o.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0],n=t[1];if(e.length>3||n.length>3)throw new v("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new g("Dimension incompatibility: "+"".concat(e[r[0]]," !== ").concat(n[r[1]]))},e.prototype.mergeFunction=function(t){if(2!==t.length)throw new g("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(t.length," input(s)."));var e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map((function(e,n){return th(e,t[n].shape.length)})):[th(this.axes,n.shape.length),th(this.axes,r.shape.length)],this.normalize&&(n=Iu(n,e[0]),r=Iu(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new v("batchDot is not implemented for tensors of 4D or higher rank yet");if(o.util.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(t.shape.length)})),o.util.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length)})),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new v("batchDot is not implemented for complex64-type Tensors yet.");var r=t.shape.length,i=e.shape.length;null==n&&(n=[r-1,i-2]);var a=n;return o.tidy((function(){var n,s;if(r>i){n=r-i;for(var u=[],c=0;c<n;++c)u.push(1);e=o.reshape(e,e.shape.concat(u))}else if(i>r){for(n=i-r,u=[],c=0;c<n;++c)u.push(1);t=o.reshape(t,t.shape.concat(u))}else n=0;if(2===t.shape.length&&2===e.shape.length)s=a[0]===a[1]?o.sum(o.mul(t,e),a[0]):o.sum(o.mul(o.transpose(t,[1,0]),e),a[1]);else{var l=a[0]!==t.shape.length-1,h=a[1]===e.shape.length-1;s=o.matMul(t,e,l,h)}if(n>0){var p,f=[];for(c=p=r>i?r+i-3:r-1;c<p+n;++c)f.push(c);s=o.squeeze(s,f)}return 1===s.shape.length&&(s=o.expandDims(s,1)),s}))}(n,r,e)},e.prototype.interpretAxes=function(t,e){return Array.isArray(this.axes)?this.axes:[th(this.axes,t.length),th(this.axes,e.length)]},e.prototype.computeOutputShape=function(t){o.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new v("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var i=e.concat(n);return 1===i.length&&i.push(1),i},e.prototype.computeMask=function(t,e){return null},e.prototype.getConfig=function(){var e={axes:this.axes,normalize:this.normalize},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ql);eh.className="Dot",a.serialization.registerClass(eh);var nh=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.stddev=e.stddev,n}return u(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={stddev:this.stddev};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t);return Et((function(){return a.add(yt(r.shape,0,n.stddev),r)}),(function(){return r}),e.training||!1)}))},e}(ue);nh.className="GaussianNoise",a.serialization.registerClass(nh);var rh=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n}return u(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e);var r=Zt(t);return n.rate>0&&n.rate<1?Et((function(){var t=Math.sqrt(n.rate/(1-n.rate));return a.mul(r,yt(r.shape,1,t))}),(function(){return r}),e.training||!1):r}))},e}(ue);rh.className="GaussianDropout",a.serialization.registerClass(rh);var ih=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n.noiseShape=e.noiseShape,n}return u(e,t),e.prototype._getNoiseShape=function(t){return this.noiseShape||Zt(t).shape},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(t);return Et((function(){var e=Zt(t),i=-1.7580993408473766,o=a.greaterEqual(a.randomUniform(r),n.rate);o=lt(o,"float32");var s=Math.pow((1-n.rate)*(1+n.rate*Math.pow(i,2)),-.5),u=-s*i*n.rate,c=a.add(a.mul(e,o),a.mul(a.add(o,-1),i));return a.add(a.mul(c,s),u)}),(function(){return Zt(t)}),e.training||!1)}return t}))},e}(ue);function ah(t,e,n,r,i,a){var s;if(void 0===a&&(a=.001),2===t.rank)s=o.batchNorm2d(t,e,n,r,i,a);else if(3===t.rank)s=o.batchNorm3d(t,e,n,r,i,a);else{if(4!==t.rank)throw new v("batchNormalization is not implemented for array of rank ".concat(t.rank," ")+"yet");s=o.batchNorm4d(t,e,n,r,i,a)}return s}function oh(t,e,n,r,i){return void 0===i&&(i=.001),a.util.arraysEqual(r.slice().sort(),ut(0,t.rank-1))?function(t,e,n,r,i){return void 0===i&&(i=.001),a.tidy((function(){var a=o.moments(t,r),s=a.mean,u=a.variance;return[ah(t,s,u,n,e,i),s,u]}))}(t,e,n,r,i):function(t,e,n,r,i){return void 0===i&&(i=.001),a.tidy((function(){var s,u,c=o.moments(t,r),l=c.mean,p=c.variance,f=[];try{for(var d=h(ut(0,t.rank)),m=d.next();!m.done;m=d.next()){var g=m.value;-1!==r.indexOf(g)?f.push(1):f.push(t.shape[g])}}catch(t){s={error:t}}finally{try{m&&!m.done&&(u=d.return)&&u.call(d)}finally{if(s)throw s.error}}var v=a.reshape(l,f),y=a.reshape(p,f),b=null==e?null:a.reshape(e,f),x=null==n?null:a.reshape(n,f);return[ah(t,v,y,x,b,i),l,p]}))}(t,e,n,r,i)}ih.className="AlphaDropout",a.serialization.registerClass(ih);var sh=function(t){function e(e){var n=this;return null==e&&(e={}),(n=t.call(this,e)||this).supportsMasking=!0,n.axis=null==e.axis?-1:e.axis,n.momentum=null==e.momentum?.99:e.momentum,n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=qt(e.betaInitializer||"zeros"),n.gammaInitializer=qt(e.gammaInitializer||"ones"),n.movingMeanInitializer=qt(e.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=qt(e.movingVarianceInitializer||"ones"),n.betaConstraint=pu(e.betaConstraint),n.gammaConstraint=pu(e.gammaConstraint),n.betaRegularizer=$c(e.betaRegularizer),n.gammaRegularizer=$c(e.gammaRegularizer),n}return u(e,t),e.prototype.build=function(t){var e;t=$t(t);var n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(null==r)throw new g("Axis ".concat(n," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(t),"."));this.inputSpec=[new re({ndim:t.length,axes:(e={},e[n]=r,e)})];var i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var r=null!=e.training&&e.training,i=Zt(t),s=i.shape,u=s.length,c=ut(0,u),l=n.axis>=0?n.axis:n.axis+u;c.splice(l,1);var h=x(1,u);h[l]=s[l];var f=c.slice();f.sort();var d=!a.util.arraysEqual(f,ut(0,u).slice(0,u-1));if(!r)return function(){if(d){var t=a.reshape(n.movingMean.read(),h),e=a.reshape(n.movingVariance.read(),h),r=n.center?a.reshape(n.beta.read(),h):null,o=n.scale?a.reshape(n.gamma.read(),h):null;return ah(i,t,e,r,o,n.epsilon)}return ah(i,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var m=p(oh(i,n.gamma.read(),n.beta.read(),c,n.epsilon),3),g=m[0],v=m[1],y=m[2],b=function(t,e,n){o.tidy((function(){var r=1-n,i=t.read(),a=o.mul(o.sub(i,e),r);t.write(o.sub(i,a))}))};return b(n.movingMean,v,n.momentum),b(n.movingVariance,y,n.momentum),g}))},e.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Xt(this.betaInitializer),gammaInitializer:Xt(this.gammaInitializer),movingMeanInitializer:Xt(this.movingMeanInitializer),movingVarianceInitializer:Xt(this.movingVarianceInitializer),betaRegularizer:Yc(this.betaRegularizer),gammaRegularizer:Yc(this.gammaRegularizer),betaConstraint:lu(this.betaConstraint),gammaConstraint:lu(this.gammaConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);sh.className="BatchNormalization",a.serialization.registerClass(sh);var uh=function(t){function e(e){var n,r,i=this;if(null==e&&(e={}),(i=t.call(this,e)||this).axis=null==e.axis?-1:e.axis,"number"==typeof i.axis){if(!Number.isInteger(i.axis))throw new Error("Expected axis to be an integer, but received ".concat(i.axis))}else{if(!Array.isArray(i.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(i.axis)));try{for(var a=h(i.axis),o=a.next();!o.done;o=a.next()){var s=o.value;if(!Number.isInteger(s))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(i.axis)))}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}return i.epsilon=null==e.epsilon?.001:e.epsilon,i.center=null==e.center||e.center,i.scale=null==e.scale||e.scale,i.betaInitializer=qt(e.betaInitializer||"zeros"),i.gammaInitializer=qt(e.gammaInitializer||"ones"),i.betaRegularizer=$c(e.betaRegularizer),i.gammaRegularizer=$c(e.gammaRegularizer),i.supportsMasking=!0,i}return u(e,t),e.prototype.build=function(t){var e,n,r=(t=$t(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);try{for(var a=h(this.axis),o=a.next();!o.done;o=a.next()){var s=o.value;if(s<0||s>=r)throw new Error("Invalid axis: ".concat(s))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}if(this.axis.length!==O(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var u=this.axis.map((function(e){return t[e]}));this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},e.prototype.call=function(t,e){var n=this,r=Zt(t),i=r.shape,s=i.length;return a.tidy((function(){var t,e,u=a.moments(r,n.axis,!0),c=u.mean,l=u.variance,p=x(1,s);try{for(var f=h(n.axis),d=f.next();!d.done;d=f.next()){var m=d.value;p[m]=i[m]}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}for(var g=function(t){return null!=t&&t.shape.length!==s?o.reshape(t,p):t},v=n.scale?g(n.gamma.read()):null,y=n.center?g(n.beta.read()):null,b=[],w=[],_=0;_<s;++_)-1!==n.axis.indexOf(_)?(b.push(i[_]),w.push(1)):(b.push(1),w.push(i[_]));return c=o.tile(c,b),l=o.tile(l,b),null!=v&&(v=o.tile(v,w)),null!=y&&(y=o.tile(y,w)),ah(r,c,l,y,v,n.epsilon)}))},e.prototype.getConfig=function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Xt(this.betaInitializer),gammaInitializer:Xt(this.gammaInitializer),betaRegularizer:Yc(this.betaRegularizer),gammaRegularizer:Yc(this.gammaRegularizer)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);uh.className="LayerNormalization",a.serialization.registerClass(uh);var ch=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)n.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new g("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var r=void 0,i=void 0;if("number"==typeof e.padding[0])r=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new g("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(r=e.padding[0],2!==e.padding[1].length)throw new g("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}n.padding=[r,i]}return n.inputSpec=[new re({ndim:4})],n}return u(e,t),e.prototype.computeOutputShape=function(t){var e,n;return t=$t(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){return e=Zt(t),r=n.padding,i=n.dataFormat,a.tidy((function(){if(4!==e.rank)throw new g("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new g("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==i&&(i="channelsLast"),"channelsLast"!==i&&"channelsFirst"!==i)throw new g("Unknown data format: ".concat(i,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var t;return t="channelsFirst"===i?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],o.pad(e,t)}));var e,r,i}))},e.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);function lh(t,e,n,r,i,s){return a.tidy((function(){var a;Y(i),$(s),Z(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),t=sl(t,i);var u="same"===r?"same":"valid";return a="max"===s?o.maxPool(t,e,n,u):o.avgPool(t,e,n,u),"channelsFirst"===i&&(a=o.transpose(a,[0,3,1,2])),a}))}function hh(t,e,n,r,i,s){return a.tidy((function(){var a;Y(i),$(s),Z(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),t=ul(t,i);var u="same"===r?"same":"valid";return a="max"===s?o.maxPool3d(t,e,n,u):o.avgPool3d(t,e,n,u),"channelsFirst"===i&&(a=o.transpose(a,[0,4,1,2,3])),a}))}ch.className="ZeroPadding2D",a.serialization.registerClass(ch);var ph=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=2),n=t.call(this,e)||this,"number"==typeof e.poolSize)n.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new g("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));n.poolSize=e.poolSize}if(P(n.poolSize,"poolSize"),null==e.strides)n.strides=n.poolSize;else if("number"==typeof e.strides)n.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new g("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));n.strides=e.strides}return P(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,Z(n.padding),n.inputSpec=[new re({ndim:3})],n}return u(e,t),e.prototype.computeOutputShape=function(t){var e=al((t=$t(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){n.invokeCallHook(t,e),t=ht(Zt(t),2);var r=n.poolingFunction(Zt(t),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return o.squeeze(r,[2])}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue),fh=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),lh(t,e,n,r,i,"max")},e}(ph);fh.className="MaxPooling1D",a.serialization.registerClass(fh);var dh=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),lh(t,e,n,r,i,"avg")},e}(ph);dh.className="AveragePooling1D",a.serialization.registerClass(dh);var mh=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new g("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));n.strides=e.strides}else n.strides=[e.strides,e.strides];return P(n.poolSize,"poolSize"),P(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Y(n.dataFormat),Z(n.padding),n.inputSpec=[new re({ndim:4})],n}return u(e,t),e.prototype.computeOutputShape=function(t){t=$t(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=al(e,this.poolSize[0],this.padding,this.strides[0]),n=al(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){return n.invokeCallHook(t,e),n.poolingFunction(Zt(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue),gh=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),lh(t,e,n,r,i,"max")},e}(mh);gh.className="MaxPooling2D",a.serialization.registerClass(gh);var vh=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),lh(t,e,n,r,i,"avg")},e}(mh);vh.className="AveragePooling2D",a.serialization.registerClass(vh);var yh=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new g("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));n.strides=e.strides}else n.strides=[e.strides,e.strides,e.strides];return P(n.poolSize,"poolSize"),P(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Y(n.dataFormat),Z(n.padding),n.inputSpec=[new re({ndim:5})],n}return u(e,t),e.prototype.computeOutputShape=function(t){t=$t(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=al(e,this.poolSize[0],this.padding,this.strides[0]),n=al(n,this.poolSize[1],this.padding,this.strides[1]),r=al(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){return n.invokeCallHook(t,e),n.poolingFunction(Zt(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue),bh=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),hh(t,e,n,r,i,"max")},e}(yh);bh.className="MaxPooling3D",a.serialization.registerClass(bh);var xh=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),hh(t,e,n,r,i,"avg")},e}(yh);xh.className="AveragePooling3D",a.serialization.registerClass(xh);var wh=function(t){function e(e){var n=t.call(this,e)||this;return n.inputSpec=[new re({ndim:3})],n}return u(e,t),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,e){throw new v},e}(ue),_h=function(t){function e(e){return t.call(this,e||{})||this}return u(e,t),e.prototype.call=function(t,e){return a.tidy((function(){var e=Zt(t);return o.mean(e,1)}))},e}(wh);_h.className="GlobalAveragePooling1D",a.serialization.registerClass(_h);var Sh=function(t){function e(e){return t.call(this,e||{})||this}return u(e,t),e.prototype.call=function(t,e){return a.tidy((function(){var e=Zt(t);return o.max(e,1)}))},e}(wh);Sh.className="GlobalMaxPooling1D",a.serialization.registerClass(Sh);var Th=function(t){function e(e){var n=t.call(this,e)||this;return n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Y(n.dataFormat),n.inputSpec=[new re({ndim:4})],n}return u(e,t),e.prototype.computeOutputShape=function(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,e){throw new v},e.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue),Eh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e=Zt(t);return"channelsLast"===n.dataFormat?o.mean(e,[1,2]):o.mean(e,[2,3])}))},e}(Th);Eh.className="GlobalAveragePooling2D",a.serialization.registerClass(Eh);var kh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e=Zt(t);return"channelsLast"===n.dataFormat?o.max(e,[1,2]):o.max(e,[2,3])}))},e}(Th);kh.className="GlobalMaxPooling2D",a.serialization.registerClass(kh);var Ih=function(t){function e(e){var n=t.call(this,e)||this;return n.layer=e.layer,n}return u(e,t),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(t){null!=this.layer&&(this.layer.trainable=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!1,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=ku(e.layer,n);delete e.layer;var i={layer:r};return Object.assign(i,e),new t(i)},e}(ue),Ah=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n}return u(e,t),e.prototype.build=function(e){if((e=$t(e)).length<3)throw new g("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),t.prototype.build.call(this,e)},e.prototype.computeOutputShape=function(t){var e=[(t=$t(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){return Sl((function(t,r){return[Zt(n.layer.call(t,e)),[]]}),t=Zt(t),[],!1,null,null,!1,!0)[1]}))},e}(Ih);Ah.className="TimeDistributed",a.serialization.registerClass(Ah);var Nh=function(t){function e(e){var n=t.call(this,e)||this,r=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=r,n.forwardLayer=ku(i),r.goBackwards=!0!==r.goBackwards;var a,o={};if(o.className=e.layer.getClassName(),o.config=r,n.backwardLayer=ku(o),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,a=n.mergeMode,M(q,"BidirectionalMergeMode",a),e.weights)throw new v("weights support is not implemented for Bidirectional layer yet.");return n._stateful=e.layer.stateful,n.returnSequences=e.layer.returnSequences,n.returnState=e.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=e.layer.inputSpec,n.numConstants=null,n}return u(e,t),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)},enumerable:!1,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))},e.prototype.computeOutputShape=function(t){var e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),this.returnState?(r=i.slice(1),e=i[0]):e=i[0],"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):S(n)},e.prototype.apply=function(e,n){var r,i,a=null==n?null:n.initialState,o=null==n?null:n.constants;null==n&&(n={});var s=_l(e,a,o,this.numConstants);if(e=s.inputs,a=s.initialState,o=s.constants,Array.isArray(e)&&(a=e.slice(1),e=e[0]),(null==a||0===a.length)&&null==o)return t.prototype.apply.call(this,e,n);var u=[],c=[];if(null!=a){var l=a.length;if(l%2>0)throw new g("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=a,u.push.apply(u,f([],p(a),!1));var d=a.map((function(t){return new re({shape:t.shape})}));this.forwardLayer.stateSpec=d.slice(0,l/2),this.backwardLayer.stateSpec=d.slice(l/2),c.push.apply(c,f([],p(d),!1))}if(null!=o)throw new v("Support for constants in Bidirectional layers is not implemented yet.");var m=u[0]instanceof ie;try{for(var y=h(u),b=y.next();!b.done;b=y.next())if(b.value instanceof ie!==m)throw new g("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}catch(t){r={error:t}}finally{try{b&&!b.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}if(m){var x=[e].concat(u),w=this.inputSpec.concat(c),_=this.inputSpec;this.inputSpec=w;var S=t.prototype.apply.call(this,x,n);return this.inputSpec=_,S}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var r,i,a,s,u=e.initialState;if(null==u)r=n.forwardLayer.call(t,e),i=n.backwardLayer.call(t,e);else{var c=u.slice(0,u.length/2),l=u.slice(u.length/2);r=n.forwardLayer.call(t,Object.assign(e,{initialState:c})),i=n.backwardLayer.call(t,Object.assign(e,{initialState:l}))}return n.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),n.returnSequences&&(i=o.reverse(i,1)),"concat"===n.mergeMode?s=mt([r,i]):"sum"===n.mergeMode?s=o.add(r,i):"ave"===n.mergeMode?s=o.mul(.5,o.add(r,i)):"mul"===n.mergeMode?s=o.mul(r,i):null==n.mergeMode&&(s=[r,i]),n.returnState?null==n.mergeMode?s.concat(a):[s].concat(a):s}))},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var e=this;Q(this.forwardLayer.name,(function(){e.forwardLayer.build(t)})),Q(this.backwardLayer.name,(function(){e.backwardLayer.build(t)})),this.built=!0},e.prototype.computeMask=function(t,e){var n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(t){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!1,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.fromConfig=function(t,e){var n=ku(e.layer);if(delete e.layer,null!=e.numConstants)throw new v("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=e;return r.layer=n,new t(r)},e}(Ih);Nh.className="Bidirectional",a.serialization.registerClass(Nh);var Ch=function(t){function e(e){var n=t.call(this,e)||this;return n.scale=e.scale,e.offset?n.offset=e.offset:n.offset=0,n}return u(e,t),e.prototype.getConfig=function(){var e={scale:this.scale,offset:this.offset},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){return"float32"!==(t=Zt(t)).dtype&&(t=lt(t,"float32")),a.add(a.mul(t,n.scale),n.offset)}))},e}(ue);Ch.className="Rescaling",a.serialization.registerClass(Ch);var Rh=a.image.resizeBilinear,Oh=a.image.cropAndResize,Dh=function(t){function e(e){var n=t.call(this,e)||this;return n.height=e.height,n.width=e.width,n}return u(e,t),e.prototype.centerCrop=function(t,e,n,r,i,o,s,u){return a.tidy((function(){var c,l=!1,h=[e/o,n/s,(r+e)/o,(i+n)/s],p=[];3===t.rank?(l=!0,c=a.stack([t])):c=t;for(var f=0;f<c.shape[0];f++)p.push(h);var d=a.tensor(p,[p.length,4]),m=a.range(0,p.length,1,"int32"),g=Oh(c,d,m,[r,i],"nearest");return lt(l?Zt(a.unstack(g)):g,u)}))},e.prototype.upsize=function(t,e,n,r){return a.tidy((function(){return lt(Rh(t,[e,n]),r)}))},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e=Zt(t),r=e.dtype,i=e.shape,a=i[i.length-3],o=i[i.length-2],s=0;a!==n.height&&(s=Math.floor((a-n.height)/2));var u=0;return o!==n.width&&0===(u=Math.floor((o-n.width)/2))&&(u=1),s>=0&&u>=0?n.centerCrop(e,s,u,n.height,n.width,a,o,r):n.upsize(t,n.height,n.width,r)}))},e.prototype.getConfig=function(){var e={height:this.height,width:this.width},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.computeOutputShape=function(t){var e=(t=$t(t)).length-3,n=t.length-2;return t[e]=this.height,t[n]=this.width,t},e}(ue);Dh.className="CenterCrop",a.serialization.registerClass(Dh);var Mh=function(t){function e(e){var n=t.call(this,e)||this;return n.numTokens=e.numTokens,e.outputMode?n.outputMode=e.outputMode:n.outputMode="multiHot",n}return u(e,t),e.prototype.getConfig=function(){var e={numTokens:this.numTokens,outputMode:this.outputMode},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.computeOutputShape=function(t){return null==(t=$t(t))?[this.numTokens]:"oneHot"===this.outputMode&&1!==t[t.length-1]?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var r;if("int32"!==(t=Zt(t)).dtype&&(t=lt(t,"int32")),void 0!==e.countWeights){if("count"!==n.outputMode)throw new g("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(e.countWeights));r=Zt(e.countWeights)}var i=a.max(t),o=a.min(t),s=a.greater(n.numTokens,i).bufferSync().get(0),u=a.greaterEqual(o,0).bufferSync().get(0);if(!s||!u)throw new g("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(n.numTokens));return function(t,e,n,r){var i=Zt(t);if("int32"!==i.dtype&&(i=lt(i,"int32")),"int"===e)return i;var o=i.shape;if(0===i.rank&&(i=a.expandDims(i,-1)),"oneHot"===e&&1!==i.shape[i.shape.length-1]&&(i=a.expandDims(i,-1)),i.rank>2)throw new g("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(e," and input shape ").concat(o)+" which would result in output rank ".concat(i.rank,"."));var s,u=["multiHot","oneHot"].includes(e),c=i;if(s=void 0!==r&&"count"===e?a.denseBincount(c,r,n,u):a.denseBincount(c,[],n,u),"tfIdf"!==e)return s;if(r)return a.mul(s,r);throw new g("When outputMode is 'tfIdf', weights must be provided.")}(t,n.outputMode,n.numTokens,r)}))},e}(ue);Mh.className="CategoryEncoding",a.serialization.registerClass(Mh);var Fh=new Set(["bilinear","nearest"]),Ph=function(t){function e(e){var n=t.call(this,e)||this;if(n.height=e.height,n.width=e.width,e.interpolation){if(!Fh.has(e.interpolation))throw new g("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));n.interpolation=e.interpolation}else n.interpolation="bilinear";return n.cropToAspectRatio=Boolean(e.cropToAspectRatio),n}return u(e,t),e.prototype.computeOutputShape=function(t){var e=(t=$t(t))[2];return[this.height,this.width,e]},e.prototype.getConfig=function(){var e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e=[n.height,n.width];if("bilinear"===n.interpolation)return a.image.resizeBilinear(t,e,!n.cropToAspectRatio);if("nearest"===n.interpolation)return a.image.resizeNearestNeighbor(t,e,!n.cropToAspectRatio);throw new Error("Interpolation is ".concat(n.interpolation," but only ").concat(f([],p(Fh),!1)," are supported"))}))},e}(ue);Ph.className="Resizing",a.serialization.registerClass(Ph);var Lh=function(){function t(t){this.seed=t}return t.prototype.next=function(){if(void 0!==this.seed)return this.seed++},t}();Lh.className="RandomSeed";var Bh=function(t){function e(e){var n=t.call(this,e)||this;return n.randomGenerator=new Lh(e.seed),n}return u(e,t),e.prototype.getConfig=function(){var e={seed:this.randomGenerator.seed},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(ue);Bh.className="BaseRandomLayer";var zh=new Set(["bilinear","nearest"]),Uh=function(t){function e(e){var n=t.call(this,e)||this,r=e.factor,i=e.interpolation,a=void 0===i?"bilinear":i;if(n.factor=r,Array.isArray(n.factor)&&2===n.factor.length)n.widthLower=n.factor[0],n.widthUpper=n.factor[1];else{if(Array.isArray(n.factor)||!(n.factor>0))throw new g("Invalid factor: ".concat(n.factor,". Must be positive number or tuple of 2 numbers"));n.widthLower=-n.factor,n.widthUpper=n.factor}if(n.widthLower<-1||n.widthUpper<-1)throw new g("factor must have values larger than -1. Got: ".concat(n.factor));if(n.widthUpper<n.widthLower)throw new g("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(n.widthUpper,".\n        Got lower bound: ").concat(n.widthLower,"\n      "));if(a){if(!zh.has(a))throw new g("Invalid interpolation parameter: ".concat(a," is not implemented"));n.interpolation=a}return n}return u(e,t),e.prototype.getConfig=function(){var e={factor:this.factor,interpolation:this.interpolation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.computeOutputShape=function(t){var e=(t=$t(t))[2];return[this.imgHeight,-1,e]},e.prototype.call=function(t,e){var n=this;return a.tidy((function(){var e=Zt(t);n.imgHeight=e.shape[e.shape.length-3];var r=e.shape[e.shape.length-2];n.widthFactor=a.randomUniform([1],1+n.widthLower,1+n.widthUpper,"float32",n.randomGenerator.next());var i=n.widthFactor.dataSync()[0]*r;i=Math.round(i);var o=[n.imgHeight,i];switch(n.interpolation){case"bilinear":return a.image.resizeBilinear(t,o);case"nearest":return a.image.resizeNearestNeighbor(t,o);default:throw new Error("Interpolation is ".concat(n.interpolation,"\n          but only ").concat(f([],p(zh),!1)," are supported"))}}))},e}(Bh);function Gh(t){return new dh(t)}function Wh(t){return new vh(t)}function Vh(t){return new xh(t)}function jh(t){return new Sh(t)}function Hh(t){return new kh(t)}function Xh(t){return new fh(t)}function qh(t){return new gh(t)}Uh.className="RandomWidth",a.serialization.registerClass(Uh);var Kh={__proto__:null,Layer:ue,RNN:Tl,RNNCell:El,activation:function(t){return new Gl(t)},add:function(t){return new Kl(t)},alphaDropout:function(t){return new ih(t)},average:function(t){return new Zl(t)},averagePooling1d:Gh,averagePooling2d:Wh,averagePooling3d:Vh,avgPool1d:function(t){return Gh(t)},avgPool2d:function(t){return Wh(t)},avgPool3d:function(t){return Vh(t)},avgPooling1d:function(t){return Gh(t)},avgPooling2d:function(t){return Wh(t)},avgPooling3d:function(t){return Vh(t)},batchNormalization:function(t){return new sh(t)},bidirectional:function(t){return new Nh(t)},categoryEncoding:function(t){return new Mh(t)},centerCrop:function(t){return new Dh(t)},concatenate:function(t){return new Ql(t)},conv1d:function(t){return new yl(t)},conv2d:function(t){return new pl(t)},conv2dTranspose:function(t){return new dl(t)},conv3d:function(t){return new fl(t)},conv3dTranspose:function(t){return new ml(t)},convLstm2d:function(t){return new Pl(t)},convLstm2dCell:function(t){return new Fl(t)},cropping2D:function(t){return new bl(t)},dense:function(t){return new zl(t)},depthwiseConv2d:function(t){return new wl(t)},dot:function(t){return new eh(t)},dropout:function(t){return new Ll(t)},elu:function(t){return new el(t)},embedding:function(t){return new Xl(t)},flatten:function(t){return new Ul(t)},gaussianDropout:function(t){return new rh(t)},gaussianNoise:function(t){return new nh(t)},globalAveragePooling1d:function(t){return new _h(t)},globalAveragePooling2d:function(t){return new Eh(t)},globalMaxPool1d:jh,globalMaxPool2d:Hh,globalMaxPooling1d:jh,globalMaxPooling2d:Hh,gru:function(t){return new Nl(t)},gruCell:function(t){return new Al(t)},input:kc,inputLayer:function(t){return new le(t)},layerNormalization:function(t){return new uh(t)},leakyReLU:function(t){return new Qc(t)},lstm:function(t){return new Rl(t)},lstmCell:function(t){return new Cl(t)},masking:function(t){return new Hl(t)},maxPool1d:Xh,maxPool2d:qh,maxPooling1d:Xh,maxPooling2d:qh,maxPooling3d:function(t){return new bh(t)},maximum:function(t){return new $l(t)},minimum:function(t){return new Jl(t)},multiply:function(t){return new Yl(t)},permute:function(t){return new jl(t)},prelu:function(t){return new tl(t)},randomWidth:function(t){return new Uh(t)},reLU:function(t){return new Jc(t)},repeatVector:function(t){return new Wl(t)},rescaling:function(t){return new Ch(t)},reshape:function(t){return new Vl(t)},resizing:function(t){return new Ph(t)},rnn:function(t){return new Tl(t)},separableConv2d:function(t){return new vl(t)},simpleRNN:function(t){return new Il(t)},simpleRNNCell:function(t){return new kl(t)},softmax:function(t){return new rl(t)},spatialDropout1d:function(t){return new Bl(t)},stackedRNNCells:function(t){return new Ol(t)},thresholdedReLU:function(t){return new nl(t)},timeDistributed:function(t){return new Ah(t)},upSampling2d:function(t){return new xl(t)},zeroPadding2d:function(t){return new ch(t)}},Yh={__proto__:null,MAPE:function(t,e){return Cu(t,e)},MSE:function(t,e){return Au(t,e)},binaryAccuracy:function(t,e){return Lu(t,e)},binaryCrossentropy:function(t,e){return Gu(t,e)},categoricalAccuracy:function(t,e){return Bu(t,e)},categoricalCrossentropy:function(t,e){return Vu(t,e)},cosineProximity:function(t,e){return Mu(t,e)},mape:function(t,e){return Cu(t,e)},meanAbsoluteError:function(t,e){return Nu(t,e)},meanAbsolutePercentageError:function(t,e){return Cu(t,e)},meanSquaredError:function(t,e){return Au(t,e)},mse:function(t,e){return Au(t,e)},precision:function(t,e){return Uu(t,e)},recall:function(t,e){return function(t,e){return a.tidy((function(){var n=zu(t,e),r=function(t,e){return a.tidy((function(){return o.cast(o.sum(o.logicalAnd(o.equal(t,1),o.equal(e,0))),"float32")}))}(t,e),i=o.add(n,r);return o.cast(o.where(o.greater(i,0),o.div(n,i),0),"float32")}))}(t,e)},sparseCategoricalAccuracy:function(t,e){return Wu(t,e)}},Zh={__proto__:null,modelFromJSON:function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,p,f,d;return l(this,(function(l){switch(l.label){case 0:return"modelTopology"in t||(t={modelTopology:t}),null!=(n=t.modelTopology).model_config&&(n=n.model_config),r=tc(n),i=ku(r,e),null==t.weightsManifest?[3,2]:[4,a.io.loadWeights(t.weightsManifest,t.pathPrefix,i.weights.map((function(t){return t.originalName})))];case 1:o=l.sent(),s={};try{for(u=h(i.weights),c=u.next();!c.done;c=u.next())p=c.value,s[p.originalName]=o[p.originalName]}catch(t){f={error:t}}finally{try{c&&!c.done&&(d=u.return)&&d.call(u)}finally{if(f)throw f.error}}i.loadWeights(s),a.dispose(o),l.label=2;case 2:return[2,i]}}))}))}},$h={__proto__:null,l1:function(t){return Hc(e=t),new qc({l1:null!=e?e.l1:null,l2:0});var e},l1l2:function(t){return new qc(t)},l2:function(t){return Hc(e=t),new qc({l2:null!=e?e.l2:null,l1:0});var e}},Jh=function(t){function e(){var e=t.apply(this,f([],p(arguments),!1))||this;return e.model=null,e}return u(e,t),e.prototype.setModel=function(t){if(!(t instanceof _c))throw new Error("model must be a LayersModel, not some other Container");this.model=t},e}(yu);function Qh(t,e){return t<e}function tp(t,e){return t>e}var ep=function(t){function e(e){var n=t.call(this)||this;if(null==e&&(e={}),e.restoreBestWeights)throw new v("restoreBestWeights = True is not implemented in EarlyStopping yet.");return n.monitor=e.monitor||"val_loss",n.minDelta=Math.abs(e.minDelta||0),n.patience=e.patience||0,n.verbose=e.verbose||0,n.mode=e.mode||"auto",n.baseline=e.baseline,-1===["auto","min","max"].indexOf(n.mode)&&(console.warn("EarlyStopping mode '".concat(n.mode,"' is invalid. ")+"Falling back to mode 'auto'."),n.mode="auto"),"min"===n.mode?n.monitorFunc=Qh:"max"===n.mode||-1!==n.monitor.indexOf("acc")?n.monitorFunc=tp:n.monitorFunc=Qh,n.monitorFunc===Qh&&(n.minDelta*=-1),n}return u(e,t),e.prototype.onTrainBegin=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){return this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===Qh?1/0:-1/0,[2]}))}))},e.prototype.onEpochEnd=function(t,e){return c(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return[4,gu(e)];case 1:return r.sent(),null==(n=this.getMonitorValue(e))||(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0))),[2]}}))}))},e.prototype.onTrainEnd=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(t){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch ".concat(this.stoppedEpoch,": early stopping.")),[2]}))}))},e.prototype.getMonitorValue=function(t){null==t&&(t={});var e=t[this.monitor];return null==e&&console.warn("Metric for EarlyStopping ".concat(this.monitor," is not available. ")+"Available metrics are: ".concat(Object.keys(t))),e},e}(Jh),np={earlyStopping:function(t){return new ep(t)}};n.Callback=Jh,n.CallbackList=bu,n.CustomCallback=_u,n.EarlyStopping=ep,n.History=wu,n.InputSpec=re,n.LayerVariable=te,n.LayersModel=_c,n.RNN=Tl,n.Sequential=Ec,n.SymbolicTensor=ie,n.callbacks=np,n.constraints=du,n.initializers=mu,n.input=kc,n.layers=Kh,n.loadLayersModel=function(t,e){return c(this,void 0,void 0,(function(){var n;return l(this,(function(r){if(null==e&&(e={}),"string"==typeof t){if(0===(n=a.io.getLoadHandlers(t,e)).length)n.push(a.io.browserHTTPRequest(t,e));else if(n.length>1)throw new g("Found more than one (".concat(n.length,") load handlers for ")+"URL '".concat(t,"'"));t=n[0]}return[2,Tc(t,void 0,e)]}))}))},n.metrics=Yh,n.model=function(t){return new _c(t)},n.models=Zh,n.registerCallbackConstructor=function(t,e){Tu.registerCallbackConstructor(t,e)},n.regularizers=$h,n.sequential=function(t){return new Ec(t)},n.version_layers=nc}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],t("timers").setImmediate)},{"@tensorflow/tfjs-core":7,_process:16,buffer:13,timers:25}],10:[function(t,e,n){(function(e,r,i,a,o,s,u,c){(function(){"use strict";var a=t("@tensorflow/tfjs-core"),o=t("long"),s=t("@tensorflow/tfjs-layers"),u=t("@tensorflow/tfjs-converter"),c=t("@tensorflow/tfjs-data"),l=t("@tensorflow/tfjs-backend-cpu"),h=t("@tensorflow/tfjs-backend-webgl");function p(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,e}var f=p(o),d=p(c);const m="Acos",g="Acosh",v="Add",y="ArgMax",b="ArgMin",x="Asin",w="Asinh",_="Atan",S="Atanh",T="Atan2",E="AvgPool",k="BatchMatMul",I="BatchToSpaceND",A="Cast",N="Ceil",C="ClipByValue",R="ComplexAbs",O="Concat",D="Conv2D",M="Conv2DBackpropInput",F="Cosh",P="Cumsum",L="DepthwiseConv2dNative",B="Dilation2D",z="RealDiv",U="ExpandDims",G="Expm1",W="Floor",V="FloorDiv",j="FusedBatchNorm",H="GatherV2",X="GreaterEqual",q="Identity",K="IsFinite",Y="IsInf",Z="IsNan",$="LeakyRelu",J="Log1p",Q="Maximum",tt="MaxPool",et="Mean",nt="Minimum",rt="MirrorPad",it="Multiply",at="OnesLike",ot="OneHot",st="Pack",ut="PadV2",ct="Prelu",lt="Prod",ht="Reciprocal",pt="Relu",ft="Reshape",dt="ResizeNearestNeighbor",mt="ResizeBilinear",gt="Relu6",vt="Reverse",yt="Round",bt="Rsqrt",xt="Select",wt="Selu",_t="Slice",St="Sinh",Tt="Sign",Et="Sigmoid",kt="Softplus",It="Sqrt",At="SpaceToBatchND",Nt="SplitV",Ct="Softmax",Rt="SquaredDifference",Ot="Tanh",Dt="Tile",Mt="Transpose",Ft="Unpack",Pt="UnsortedSegmentSum",Lt="ZerosLike",Bt="Step";class zt{refCount(t){return Ut("refCount")}incRef(t){return Ut("incRef")}timerAvailable(){return!0}time(t){return Ut("time")}read(t){return Ut("read")}readSync(t){return Ut("readSync")}readToGPU(t,e){return Ut("readToGPU")}numDataIds(){return Ut("numDataIds")}disposeData(t,e){return Ut("disposeData")}write(t,e,n){return Ut("write")}move(t,e,n,r,i){return Ut("move")}createTensorFromGPUData(t,e,n){return Ut("createTensorFromGPUData")}memory(){return Ut("memory")}floatPrecision(){return Ut("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Ut("dispose")}}function Ut(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function Gt(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function Wt(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Vt(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function jt(t){return t%1==0}function Ht(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Xt(t,e){const n=e.length;return Gt((t=null==t?e.map(((t,e)=>e)):[].concat(t)).every((t=>t>=-n&&t<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`)),Gt(t.every((t=>jt(t))),(()=>`All values in axis param must be integers but got axis ${t}`)),t.map((t=>t<0?n+t:t))}function qt(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error(`Unknown dtype ${t}`)}function Kt(t){return"string"==typeof t||t instanceof String}function Yt(t){return Array.isArray(t)?Yt(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":function(t){return"number"==typeof t}(t)?"float32":Kt(t)?"string":function(t){return"boolean"==typeof t}(t)?"bool":"float32"}function Zt(t){return!!(t&&t.constructor&&t.call&&t.apply)}function $t(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function Jt(t,e,n,r=!1){const i=new Array;if(1===e.length){const a=e[0]*(r?2:1);for(let e=0;e<a;e++)i[e]=n[t+e]}else{const a=e[0],o=e.slice(1),s=o.reduce(((t,e)=>t*e))*(r?2:1);for(let e=0;e<a;e++)i[e]=Jt(t+e*s,o,n,r)}return i}function Qt(t,e,n=!1){if(0===t.length)return e[0];const r=t.reduce(((t,e)=>t*e))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return Jt(0,t,e,n)}function te(t,e){const n=ee(t,e);for(let t=0;t<n.length;t++)n[t]=1;return n}function ee(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function ne(t){t.forEach((e=>{Gt(Number.isInteger(e)&&e>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`))}))}function re(t){return t&&t.then&&"function"==typeof t.then}const ie="tfjsflags";class ae{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=oe,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(re(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);ie in t&&t[ie].split(",").forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){const n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:""+ +n===n?+n:e}(0,n)}))}}function oe(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((t,...n)=>(function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")))),e}function se(){return ce}let ue,ce=null;function le(){if(null==ue){let t;if("undefined"!=typeof window)t=window;else if(void 0!==r)t=r;else if(void 0!==e)t=e;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}ue=t}return ue}function he(t,e){const n=function(){const t=le();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}function pe(...t){se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(...t)}const fe=he("kernelRegistry",(()=>new Map)),de=he("gradRegistry",(()=>new Map));function me(t,e){const n=function(t,e){return`${e}_${t}`}(t,e);return fe.get(n)}function ge(t){return de.get(t)}function ve(t){const e=fe.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[a,o]=i,[s]=a.split("_");s===t&&n.push(o)}return n}function ye(t){const{kernelName:e}=t;de.has(e)&&se().getBool("DEBUG")&&pe(`Overriding the gradient for '${e}'`),de.set(e,t)}const be=f.default||f;function xe(t){return be.fromString(t,!0,16)}function we(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ee(t)),se().getBool("DEBUG")&&function(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error(`Unknown data type ${e}`)}function _e(){return se().platform.now()}function Se(t,e="utf-8"){return e=e||"utf-8",se().platform.decode(t,e)}function Te(t){return null!=se().platform.isTypedArray?se().platform.isTypedArray(t):function(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}(t)}function Ee(t,e=[],n=!1){if(null==e&&(e=[]),"boolean"==typeof t||"number"==typeof t||"string"==typeof t||re(t)||null==t||Te(t)&&n)e.push(t);else if(Array.isArray(t)||Te(t))for(let r=0;r<t.length;++r)Ee(t[r],e,n);else{let r=-1;for(const e of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(e)&&(r=Math.max(r,Number(e)));for(let i=0;i<=r;i++)Ee(t[i],e,n)}return e}xe("c3a5c85c97cb3127"),xe("b492b66fbe98f273"),xe("9ae16a3b2f90404f");class ke{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new Ae)}profileKernel(t,e,n){let r;const i=()=>{r=n()};let a;const o=_e();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const t of r)t.dataSync();a=Promise.resolve({kernelMs:_e()-o})}if(se().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let e=0;e<r.length;e++){const n=r[e];n.data().then((e=>{Ie(e,n.dtype,t)}))}return{kernelName:t,outputs:r,inputs:e,timeMs:a.then((t=>t.kernelMs)),extraInfo:a.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:i,extraInfo:a}=t;n.forEach((t=>{Promise.all([t.data(),r,a]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],i,n[2])}))}))}}function Ie(t,e,n){if("float32"!==e)return!1;for(let e=0;e<t.length;e++){const r=t[e];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class Ae{logKernelProfile(t,e,n,r,i,a){const o="number"==typeof r?Ht(`${r}ms`,9):r.error,s=Ht(t,25),u=e.rank,c=e.size,l=Ht(e.shape.toString(),14);let h="";for(const t in i){const n=i[t];if(null!=n){const r=n.shape||e.shape,i=r.length;h+=`${t}: ${i}D ${i>0?r:""} `}}console.log(`%c${s}\t%c${o}\t%c${u}D ${l}\t%c${c}\t%c${h}\t%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}const Ne=20,Ce=3,Re=7;function Oe(t,e,n,r){const i=$t(e),a=function(t,e,n,r){const i=Wt(e),a=r[r.length-1],o=new Array(a).fill(0),s=e.length,u="complex64"===n?Pe(t):t;if(s>1)for(let t=0;t<i/a;t++){const e=t*a;for(let t=0;t<a;t++)o[t]=Math.max(o[t],De(u[e+t],0,n).length)}return o}(t,e,n,i),o=e.length,s=Fe(t,e,n,i,a),u=["Tensor"];return r&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${o}`),u.push(`  shape: [${e}]`),u.push("  values:")),u.push(s.map((t=>"    "+t)).join("\n")),u.join("\n")}function De(t,e,n){let r;return r=Array.isArray(t)?`${parseFloat(t[0].toFixed(Re))} + ${parseFloat(t[1].toFixed(Re))}j`:Kt(t)?`'${t}'`:"bool"===n?Me(t):parseFloat(t.toFixed(Re)).toString(),Ht(r,e)}function Me(t){return 0===t?"false":"true"}function Fe(t,e,n,r,i,a=!0){const o="complex64"===n?2:1,s=e[0],u=e.length;if(0===u)return"complex64"===n?[De(Pe(t)[0],0,n)]:"bool"===n?[Me(t[0])]:[t[0].toString()];if(1===u){if(s>Ne){const e=Ce*o;let r=Array.from(t.slice(0,e)),a=Array.from(t.slice((s-Ce)*o,s*o));return"complex64"===n&&(r=Pe(r),a=Pe(a)),["["+r.map(((t,e)=>De(t,i[e],n))).join(", ")+", ..., "+a.map(((t,e)=>De(t,i[s-Ce+e],n))).join(", ")+"]"]}return["["+("complex64"===n?Pe(t):Array.from(t)).map(((t,e)=>De(t,i[e],n))).join(", ")+"]"]}const c=e.slice(1),l=r.slice(1),h=r[0]*o,p=[];if(s>Ne){for(let e=0;e<Ce;e++){const r=e*h,a=r+h;p.push(...Fe(t.slice(r,a),c,n,l,i,!1))}p.push("...");for(let e=s-Ce;e<s;e++){const r=e*h,a=r+h;p.push(...Fe(t.slice(r,a),c,n,l,i,e===s-1))}}else for(let e=0;e<s;e++){const r=e*h,a=r+h;p.push(...Fe(t.slice(r,a),c,n,l,i,e===s-1))}const f=2===u?",":"";p[0]="["+(s>0?p[0]+f:"");for(let t=1;t<p.length-1;t++)p[t]=" "+p[t]+f;let d=",\n";for(let t=2;t<u;t++)d+="\n";return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":d),p}function Pe(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}let Le=null,Be=null,ze=null;class Ue{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Wt(t),this.strides=$t(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Be.buffer(this.shape,this.dtype,t)}bufferSync(){return Be.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Qt(this.shape,t,"complex64"===this.dtype)}arraySync(){return Qt(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=Le().read(this.dataId);if("string"===this.dtype){const e=await t;try{return e.map((t=>Se(t)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Le().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Le().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>Se(t)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Le().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Le().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Be.print(this,t)}clone(){return this.throwIfDisposed(),Be.clone(this)}toString(t=!1){return Oe(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Be.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),Le().makeVariable(this,t,e,n)}}function Ge(){return he("Tensor",(()=>Ue))}Object.defineProperty(Ue,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),Ge();class We extends Ue{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Vt(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Le().disposeTensor(this),this.dataId=t.dataId,Le().incRef(this,null)}dispose(){Le().disposeVariable(this),this.isDisposedInternal=!0}}var Ve,je,He,Xe,qe;Object.defineProperty(We,Symbol.hasInstance,{value:t=>t instanceof Ue&&null!=t.assign&&t.assign instanceof Function}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(Ve||(Ve={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(je||(je={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(He||(He={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Xe||(Xe={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(qe||(qe={}));const Ke={float32:Xe,int32:je,bool:He,complex64:qe};function Ye(t){return null!=t&&"object"==typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function Ze(t){return"undefined"!=typeof GPUBuffer&&null!=t&&"object"==typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}function $e(t,e){if(t.dtype===e.dtype)return[t,e];const n=function(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Ke[t][e]}(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Je(t){const e=[];return Qe(t,e,new Set),e}function Qe(t,e,n){if(null==t)return;if(t instanceof Ue)return void e.push(t);if(r=t,!Array.isArray(r)&&"object"!=typeof r)return;var r;const i=t;for(const t in i){const r=i[t];n.has(r)||(n.add(r),Qe(r,e,n))}}function tn(t){return null!=t.kernelName}class en{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((t=>t.name))))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class nn{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new en}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(pe(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new ke(this.backendInstance),!0}setupRegisteredKernels(){ve(this.backendName).forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){ve(t).forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(!n||n instanceof zt||"function"!=typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then((n=>!(e<this.pendingBackendInitId||(this.registry[t]=n,this.pendingBackendInit=null,0)))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,pe(`Initialization of backend ${t} failed`),pe(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(e){return pe(`Initialization of backend ${t} failed`),pe(e.stack||e.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),a=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(t){throw e(),t}}nextTensorId(){return nn.nextTensorId++}nextVariableId(){return nn.nextVariableId++}clone(t){const e=rn.runKernel(q,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(t=>({x:()=>{const e={x:t};return rn.runKernel(A,e,{dtype:"float32"})}})),[],{}),e}runKernel(t,e,n){if(null==this.backendName&&this.backend,null==me(t,this.backendName))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach((t=>{i+="complex64"===t.dtype?3:1}));const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;let o,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const u=tn(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(tn(t)){const{kernelName:e,inputs:i,attrs:a}=t;null==this.backendName&&this.backend;const u=me(e,this.backendName);Gt(null!=u,(()=>`Cannot find registered kernel '${e}' for backend '${this.backendName}'`)),o=()=>{const t=this.backend.numDataIds();s=u.kernelFunc({inputs:i,attrs:a,backend:this.backend});const o=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,o);const c=o.map((t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t)));if(r){const t=this.getTensorsForGradient(e,i,c);n=this.saveTensorsForBackwardMode(t)}return c}}else{const{forwardFunc:e}=t,i=t=>{r&&(n=t.map((t=>this.keep(this.clone(t)))))};o=()=>{const t=this.backend.numDataIds();s=this.tidy((()=>e(this.backend,i)));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,t,n),n}}const{inputs:c,attrs:l}=t,h=tn(t)?null:t.backwardsFunc;let p;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(p=this.profiler.profileKernel(u,c,(()=>o())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),e=p.outputs):e=o()})),r&&this.addTapeNode(u,c,e,h,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map((t=>null!=c[t]?c[t].shape:null)),outputShapes:e.map((t=>t.shape)),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(s)?e:e[0]}saveTensorsForBackwardMode(t){return t.map((t=>this.keep(this.clone(t))))}getTensorsForGradient(t,e,n){const r=ge(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(Gt(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),a=Object.keys(e).map((t=>e[t]))):a=t.map((t=>e[t]));const o=n.filter(((t,e)=>i[e]));return a.concat(o)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=t;"string"===n&&Kt(t[0])&&(i=t.map((t=>function(t,e="utf-8"){return e=e||"utf-8",se().platform.encode(t,e)}(t))));const a=r.write(i,e,n),o=new Ue(e,n,a,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const t=this.state.tensorInfo.get(a),e=function(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,r){const i={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:i}=t,a=new Ue(r,i,n,this.nextTensorId());return this.trackTensor(a,e),a}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const i=new We(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*qt(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof We||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*qt(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const t of this.state.activeProfile.kernels)t.kernelTimeMs=await t.kernelTimeMs,t.extraInfo=await t.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},s=ge(t);null!=s&&(r=s.gradFunc),null!=r&&(o.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],r=ee(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t})),r(t.length>1?t:t[0],i,a))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Je(t),n=new Set(e.map((t=>t.id)));for(let t=0;t<this.state.activeScope.track.length;t++){const e=this.state.activeScope.track[t];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==r.id||this.track(t)}))}gradients(t,e,n,r=!1){if(Gt(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));Gt(i instanceof Ue,(()=>"The result y returned by f() must be a tensor."));const a=function(t,e,n){const r={},i={};for(let t=0;t<e.length;t++)r[e[t].id]=!0;for(let n=0;n<t.length;n++){const a=t[n],o=a.inputs;for(const t in o){const n=o[t];let s=!1;for(let t=0;t<e.length;t++)if(r[n.id]){a.outputs.forEach((t=>r[t.id]=!0)),s=!0,i[a.id]=!0;break}if(s)break}}const a={};a[n.id]=!0;const o={};for(let e=t.length-1;e>=0;e--){const n=t[e],r=n.inputs;for(let t=0;t<n.outputs.length;t++)if(a[n.outputs[t].id]){for(const t in r)a[r[t].id]=!0,o[n.id]=!0;break}}const s=[];for(let e=0;e<t.length;e++){const n=t[e];if(i[n.id]&&o[n.id]){const t={};for(const e in n.inputs){const i=n.inputs[e];r[i.id]&&(t[e]=i)}const e=Object.assign({},n);e.inputs=t,e.outputs=n.outputs,s.push(e)}}return s}(this.state.activeTape,e,i);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[i.id]=n??function(t){const e=te(Wt(t),"float32");return rn.makeTensor(e,t,"float32")}(i.shape),function(t,e,n,r){for(let i=e.length-1;i>=0;i--){const a=e[i],o=[];if(a.outputs.forEach((e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const s=a.gradient(o);for(const e in a.inputs){if(!(e in s))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(s)}.`);const i=n((()=>s[e]()));if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${i.dtype}'`);const o=a.inputs[e];if(!Vt(i.shape,o.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${e}' has shape '${i.shape}', which does not match the shape of the input '${o.shape}'`);if(null==t[o.id])t[o.id]=i;else{const e=t[o.id];t[o.id]=r(e,i),e.dispose()}}}}(t,a,(t=>this.tidy(t)),an);const r=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(t){return Gt(Zt(t),(()=>"The f passed in customGrad(f) must be a function.")),(...e)=>{let n;Gt(e.every((t=>t instanceof Ue)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const r={};return e.forEach(((t,e)=>{r[e]=t})),this.runKernelFunc({forwardFunc:(r,i)=>(n=t(...e,i),Gt(n.value instanceof Ue,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),Gt(Zt(n.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),n.value),backwardsFunc:(t,r)=>{const i=n.gradFunc(t,r),a=Array.isArray(i)?i:[i];Gt(a.length===e.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),Gt(a.every((t=>t instanceof Ue)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return a.forEach(((t,e)=>{o[e]=()=>t})),o},inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}async time(t){const e=_e(),n=await this.backend.time(t);return n.wallMs=_e()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new en;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}nn.nextTensorId=0,nn.nextVariableId=0;const rn=function(){const t=le();if(null==t._tfengine){const e=new ae(t);t._tfengine=new nn(e)}var e;return e=t._tfengine.ENV,ce=e,Le=()=>t._tfengine,t._tfengine}();function an(t,e){const n={a:t,b:e};return rn.runKernel(v,n)}function on(t,e){let n=t;if(Te(t))return"string"===e?[]:[t.length];if(Ye(t)){const e=t.channels||"RGBA";return[t.height,t.width*e.length]}if(Ze(t))return[t.buffer.size/(null==e?4:qt(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Te(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&se().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&sn(t,r,[]),r}function sn(t,e,n){if(n=n||[],!Array.isArray(t)&&!Te(t))return void Gt(0===e.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`));Gt(e.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`)),Gt(t.length===e[0],(()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`));const r=e.slice(1);for(let e=0;e<t.length;++e)sn(t[e],r,n.concat(e))}function un(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function cn(t,e,n,r="numeric"){if(t instanceof Ge())return un(r,t.dtype,e,n),t;let i=Yt(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),un(r,i,e,n),null==t||!Te(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){const r=null==t?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const a=on(t,i);Te(t)||Array.isArray(t)||(t=[t]);const o="string"!==i?we(t,i):Ee(t,[],!0);return rn.makeTensor(o,a,i)}function ln(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map(((t,i)=>cn(t,`${e}[${i}]`,n,r)))}function hn(t){const e=Object.keys(t);if(1!==e.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const i=(...t)=>{rn.startScope(n);try{const e=r(...t);return re(e)&&console.error("Cannot return a Promise inside of tidy."),rn.endScope(e),e}catch(t){throw rn.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}const pn=hn({cast_:function(t,e){const n=cn(t,"x","cast");if(!function(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:e};return rn.runKernel(A,r,i)}}),fn=hn({mul_:function(t,e){let n=cn(t,"a","mul"),r=cn(e,"b","mul");[n,r]=$e(n,r);const i={a:n,b:r};return rn.runKernel(it,i)}}),dn=hn({step_:function(t,e=0){const n={x:cn(t,"x","step")},r={alpha:e};return rn.runKernel(Bt,n,r)}}),mn={kernelName:"Abs",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(t,dn(pn(n,"float32"),-1))}}},gn=hn({floorDiv_:function(t,e){let n=cn(t,"a","floorDiv"),r=cn(e,"b","floorDiv");[n,r]=$e(n,r);const i={a:n,b:r};return rn.runKernel(V,i)}}),vn=hn({div_:function(t,e){let n=cn(t,"a","div"),r=cn(e,"b","div");if([n,r]=$e(n,r),"int32"===n.dtype&&"int32"===r.dtype)return gn(n,r);const i={a:n,b:r};return rn.runKernel(z,i,{})}}),yn=hn({neg_:function(t){const e={x:cn(t,"x","neg")};return rn.runKernel("Neg",e)}});function bn(t,e){if((Te(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Te(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return function(t,e,n,r){if(null==r)r=Yt(t);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Ze(t)||Ye(t)){if("float32"!==r&&"int32"!==r)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return rn.backend.createTensorFromGPUData(t,e||n,r)}if(!Te(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){ne(e);const t=Wt(e),r=Wt(n);Gt(t===r,(()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${r}`));for(let t=0;t<n.length;++t){const r=n[t],i=t!==n.length-1||r!==Wt(e.slice(t));Gt(n[t]===e[t]||!i,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `))}}return Te(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?we(t,r):Ee(t,[],!0),rn.makeTensor(t,e,r)}(t,[],[],e)}const xn=hn({sqrt_:function(t){const e={x:cn(t,"x","sqrt","float32")};return rn.runKernel(It,e)}}),wn=hn({square_:function(t){const e=cn(t,"x","square");return rn.runKernel("Square",{x:e},{})}}),_n=hn({sub_:function(t,e){let n=cn(t,"a","sub"),r=cn(e,"b","sub");[n,r]=$e(n,r);const i={a:n,b:r};return rn.runKernel("Sub",i)}}),Sn={kernelName:m,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=wn(pn(n,"float32")),r=xn(_n(bn(1),e));return yn(vn(t,r))}}}},Tn={kernelName:g,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=xn(_n(wn(pn(n,"float32")),1));return vn(t,e)}}}};function En(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function kn(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let i=0;i<n;i++){let a=t[t.length-i-1];null==a&&(a=1);let o=e[e.length-i-1];if(null==o&&(o=1),1===a)r[n-i-1]=o;else if(1===o)r[n-i-1]=a;else{if(a!==o)throw Error(`Operands could not be broadcast together with shapes ${t} and ${e}.`);r[n-i-1]=a}}return r}const In=hn({reshape_:function(t,e){const n={x:cn(t,"x","reshape","string_or_numeric")},r={shape:e};return rn.runKernel(ft,n,r)}}),An=hn({sum_:function(t,e=null,n=!1){let r=cn(t,"x","sum");"bool"===r.dtype&&(r=pn(r,"int32"));const i={x:r},a={axis:e,keepDims:n};return rn.runKernel("Sum",i,a)}}),Nn={kernelName:v,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=kn(n.shape,r.shape);return{a:()=>{let e=t;const r=En(n.shape,i);return r.length>0&&(e=An(e,r)),In(e,n.shape)},b:()=>{let e=t;const n=En(r.shape,i);return n.length>0&&(e=An(e,n)),In(e,r.shape)}}}},Cn={kernelName:"AddN",saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach(((e,r)=>{n[r]=()=>t.clone()})),n}},Rn=hn({zerosLike_:function(t){const e={x:cn(t,"x","zerosLike")};return rn.runKernel(Lt,e)}}),On={kernelName:y,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Rn(n)}}},Dn={kernelName:b,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Rn(n)}}},Mn={kernelName:x,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,xn(_n(bn(1),wn(pn(n,"float32")))))}}},Fn=hn({add_:function(t,e){let n=cn(t,"a","add"),r=cn(e,"b","add");[n,r]=$e(n,r);const i={a:n,b:r};return rn.runKernel(v,i)}}),Pn={kernelName:w,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=xn(Fn(bn(1),wn(pn(n,"float32"))));return vn(t,e)}}}},Ln={kernelName:T,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=kn(n.shape,r.shape);return{a:()=>{const e=Fn(wn(n),wn(r));let a=fn(t,vn(r,e));const o=En(n.shape,i);return o.length>0&&(a=An(a,o)),In(a,n.shape)},b:()=>{const e=Fn(wn(n),wn(r));let a=yn(fn(t,vn(n,e)));const o=En(r.shape,i);return o.length>0&&(a=An(a,o)),In(a,r.shape)}}}},Bn={kernelName:_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,Fn(wn(pn(n,"float32")),1))}}},zn={kernelName:S,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,_n(bn(1),wn(pn(n,"float32"))))}}};function Un(t,e,n,r,i,a,o="channelsLast"){const[s,u]=Gn(e);let c;if("channelsLast"===o)c=[s,u,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);c=[s,u,t[1],t[1]]}return function(t,e,n,r,i,a,o=!1,s="channelsLast"){let[u,c,l,h]=[-1,-1,-1,-1];if("channelsLast"===s)[u,c,l,h]=t;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[u,h,c,l]=t}const[p,f,,d]=e,[m,g]=Gn(n),[v,y]=Gn(r),b=Wn(p,v),x=Wn(f,y),{padInfo:w,outHeight:_,outWidth:S}=function(t,e,n,r,i,a,o,s,u){let c,l,h;if("number"==typeof t){c={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,i){null==r&&(r=function(t,e,n,r=1){const i=Wn(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}(t,e,n));const a=t[0],o=t[1];return[Vn((a-e+2*r)/n+1,i),Vn((o-e+2*r)/n+1,i)]}([e,n],a,r,t,s);l=i[0],h=i[1]}else if("same"===t){l=Math.ceil(e/r),h=Math.ceil(n/i);const t=Math.max(0,(l-1)*r+a-e),s=Math.max(0,(h-1)*i+o-n),u=Math.floor(t/2),p=t-u,f=Math.floor(s/2);c={top:u,bottom:p,left:f,right:s-f,type:"SAME"}}else if("valid"===t)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-a+1)/r),h=Math.ceil((n-o+1)/i);else{if("object"!=typeof t)throw Error(`Unknown padding parameter: ${t}`);{const p="channelsLast"===u?t[1][0]:t[2][0],f="channelsLast"===u?t[1][1]:t[2][1],d="channelsLast"===u?t[2][0]:t[3][0],m="channelsLast"===u?t[2][1]:t[3][1];c={top:p,bottom:f,left:d,right:m,type:0===p&&0===f&&0===d&&0===m?"VALID":"EXPLICIT"},l=Vn((e-a+p+f)/r+1,s),h=Vn((n-o+d+m)/i+1,s)}}return{padInfo:c,outHeight:l,outWidth:h}}(i,c,l,m,g,b,x,a,s),T=o?d*h:d;let E;return"channelsFirst"===s?E=[u,T,_,S]:"channelsLast"===s&&(E=[u,_,S,T]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:h,outHeight:_,outWidth:S,outChannels:T,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:p,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:v,dilationWidth:y,inShape:t,outShape:E,filterShape:e}}(t,c,n,r,i,a,!1,o)}function Gn(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function Wn(t,e){return e<=1?t:t+(t-1)*(e-1)}function Vn(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function jn(t){const[e,n,r]=Gn(t);return 1===e&&1===n&&1===r}function Hn(t,e){return jn(t)||jn(e)}function Xn(t){return Gn(t).every((t=>t>0))}function qn(t,e,n){if(null!=n){if("string"==typeof e)throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if("number"==typeof e)Gt(jt(e),(()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`));else{if("object"!=typeof e)throw Error(`Error in ${t}: Unknown padding parameter: ${e}`);e.forEach((e=>{e.forEach((e=>{Gt(jt(e),(()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`))}))}))}}}const Kn=hn({avgPool3dGrad_:function(t,e,n,r,i,a){const o=cn(t,"dy","avgPool3dGrad"),s=cn(e,"input","avgPool3dGrad");let u=o,c=s,l=!1;4===s.rank&&(l=!0,u=In(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=In(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Gt(5===u.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`)),Gt(5===c.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`)),qn("avgPool3dGrad",i,a);const h={dy:u,input:c},p={filterSize:n,strides:r,pad:i,dimRoundingMode:a},f=rn.runKernel("AvgPool3DGrad",h,p);return l?In(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),Yn={kernelName:"AvgPool3D",inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:s}=n;return{x:()=>Kn(t,r,i,a,o,s)}}},Zn=hn({avgPoolGrad_:function(t,e,n,r,i){const a=cn(t,"dy","avgPoolGrad"),o=cn(e,"input","avgPoolGrad");Gt(o.rank===a.rank,(()=>`Rank of input (${o.rank}) does not match rank of dy (${a.rank})`));let s=o,u=a,c=!1;3===o.rank&&(c=!0,s=In(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=In(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Gt(4===u.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`)),Gt(4===s.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${s.rank}.`));const l={dy:u,input:s},h={filterSize:n,strides:r,pad:i},p=rn.runKernel("AvgPoolGrad",l,h);return c?In(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),$n={kernelName:E,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,pad:o}=n;return{x:()=>Zn(t,r,i,a,o)}}},Jn=hn({matMul_:function(t,e,n=!1,r=!1){let i=cn(t,"a","matMul"),a=cn(e,"b","matMul");[i,a]=$e(i,a);const o={a:i,b:a},s={transposeA:n,transposeB:r};return rn.runKernel(k,o,s)}}),Qn={kernelName:k,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,i]=e,{transposeA:a,transposeB:o}=n;return a||o?!a&&o?{a:()=>Jn(t,i,!1,!1),b:()=>Jn(t,r,!0,!1)}:a&&!o?{a:()=>Jn(i,t,!1,!0),b:()=>Jn(r,t,!1,!1)}:{a:()=>Jn(i,t,!0,!0),b:()=>Jn(t,r,!0,!0)}:{a:()=>Jn(t,i,!1,!0),b:()=>Jn(r,t,!0,!1)}}},tr=hn({spaceToBatchND_:function(t,e,n){const r=cn(t,"x","spaceToBatchND");Gt(r.rank>=1+e.length,(()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`)),Gt(n.length===e.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`)),Gt(r.shape.reduce(((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t),!0),(()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`));const i={x:r},a={blockShape:e,paddings:n};return rn.runKernel(At,i,a)}}),er={kernelName:I,gradFunc:(t,e,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>tr(t,r,i)}}},nr={kernelName:"BroadcastTo",gradFunc:(t,e,n)=>{const r=n,i=r.inputShape,a=r.shape,o=Array.from(a);for(let t=i.length-1;t>=0;t--)if(i[t]===a[t])o[t]=1;else if(1!==i[t])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);const s=[];for(let t=0;t<o.length;t++)o[t]>1&&s.push(t);return{x:()=>An(t,s,!0)}}},rr={kernelName:A,gradFunc:t=>({x:()=>t.clone()})},ir={kernelName:N,gradFunc:t=>({x:()=>Rn(t)})},ar=hn({greaterEqual_:function(t,e){let n=cn(t,"a","greaterEqual","string_or_numeric"),r=cn(e,"b","greaterEqual","string_or_numeric");[n,r]=$e(n,r),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel(X,i)}}),or=hn({lessEqual_:function(t,e){let n=cn(t,"a","lessEqual","string_or_numeric"),r=cn(e,"b","lessEqual","string_or_numeric");[n,r]=$e(n,r),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel("LessEqual",i)}}),sr=hn({logicalAnd_:function(t,e){const n=cn(t,"a","logicalAnd","bool"),r=cn(e,"b","logicalAnd","bool");kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel("LogicalAnd",i)}}),ur=hn({clone_:function(t){const e={x:cn(t,"x","clone","string_or_numeric")};return rn.runKernel(q,e)}}),cr=hn({broadcastTo_:function(t,e){let n=cn(t,"broadcastTo","x");const r=n.shape;if(ne(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=In(n,t)}const i=n.shape,a=Array.from(e);for(let t=e.length-1;t>=0;t--)if(i[t]===e[t])a[t]=1;else if(1!==n.shape[t])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(0===a.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0)).length)return ur(n);const o={x:n},s={reps:a};return rn.runKernel(Dt,o,s)}}),lr=hn({where_:function(t,e,n){const r=cn(e,"a","where"),i=cn(n,"b","where"),a=cn(t,"condition","where","bool"),o=kn(kn(a.shape,r.shape),i.shape),s={condition:cr(a,o),t:cr(r,o),e:cr(i,o)};return rn.runKernel(xt,s)}}),hr={kernelName:C,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>lr(sr(ar(r,i),or(r,a)),t,Rn(t))}}},pr={kernelName:R,inputsToSave:["x"],gradFunc:mn.gradFunc},fr=hn({split_:function(t,e,n=0){const r={x:cn(t,"x","split")},i={numOrSizeSplits:e,axis:n};return rn.runKernel(Nt,r,i)}}),dr={kernelName:O,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map((t=>t.shape)),{axis:i}=n,a=Xt(i,e[0].shape)[0],o=r.map((t=>t[a]));return fr(t,o,a).map((t=>()=>t))}},mr=hn({conv2DBackpropFilter_:function(t,e,n,r,i,a="NHWC",o){let s=t;3===t.rank&&(s=In(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;3===u.rank&&(u=In(e,[1,e.shape[0],e.shape[1],e.shape[2]])),Gt(4===s.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${s.shape}.`)),Gt(4===u.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`)),Gt(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const c="NHWC"===a?s.shape[3]:s.shape[1],l="NHWC"===a?u.shape[3]:u.shape[1];Gt(c===n[2],(()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`)),Gt(l===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${n[3]}).`)),qn("conv2dDerFilter",i,o);const h={x:s,dy:u},p={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,filterShape:n};return rn.runKernel("Conv2DBackpropFilter",h,p)}}),gr=hn({conv2DBackpropInput_:function(t,e,n,r,i,a="NHWC",o){Gt(t.length===e.rank,(()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`));let s=t,u=e,c=!1;3===e.rank&&(c=!0,u=In(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),Gt(4===s.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${s.length}.`)),Gt(4===u.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`)),Gt(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const l="NHWC"===a?s[3]:s[1],h="NHWC"===a?u.shape[3]:u.shape[1];Gt(l===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[2]}.`)),Gt(h===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`)),qn("conv2dDerInput",i,o);const p={dy:u,filter:n},f={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,inputShape:s},d=rn.runKernel(M,p,f);return c?In(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),vr={kernelName:D,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{dilations:a,strides:o,pad:s,dataFormat:u}=n;return Gt(jn(a),(()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`)),{x:()=>gr(r.shape,t,i,o,s,u),filter:()=>mr(r,t,i.shape,o,s,u)}}},yr=hn({conv2d_:function(t,e,n,r,i="NHWC",a=[1,1],o){const s=cn(t,"x","conv2d","float32"),u=cn(e,"filter","conv2d","float32");let c=s,l=!1;3===s.rank&&(l=!0,c=In(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Gt(4===c.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`)),Gt(4===u.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`)),qn("conv2d",r,o);const h="NHWC"===i?c.shape[3]:c.shape[1];Gt(h===u.shape[2],(()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${u.shape[2]}.`)),Gt(Hn(n,a),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`)),Gt(Xn(a),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),Gt(Xn(n),(()=>"Error in conv2D: Strides should be larger than 0."));const p={x:c,filter:u},f={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},d=rn.runKernel(D,p,f);return l?In(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),br={kernelName:M,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{strides:a,pad:o,dataFormat:s,dimRoundingMode:u}=n;return{dy:()=>yr(t,i,a,o,s,1,u),filter:()=>mr(t,r,i.shape,a,o,s,u)}}},xr=hn({conv3DBackpropFilter_:function(t,e,n,r,i){let a=t;4===t.rank&&(a=In(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=In(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),Gt(5===a.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`)),Gt(5===o.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`)),Gt(5===n.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`)),Gt(a.shape[4]===n[3],(()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`)),Gt(o.shape[4]===n[4],(()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`));const s={x:a,dy:o},u={strides:r,pad:i,filterShape:n};return rn.runKernel("Conv3DBackpropFilterV2",s,u)}}),wr=hn({conv3DBackpropInput_:function(t,e,n,r,i){Gt(t.length===e.rank,(()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`));let a=t,o=e,s=!1;4===e.rank&&(s=!0,o=In(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);const u=a[4],c=o.shape[4];Gt(5===a.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`)),Gt(5===o.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`)),Gt(5===n.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`)),Gt(u===n.shape[3],(()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`)),Gt(c===n.shape[4],(()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`));const l={dy:o,filter:n},h={pad:i,strides:r,inputShape:a},p=rn.runKernel("Conv3DBackpropInputV2",l,h);return s?In(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),_r={kernelName:"Conv3D",inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a}=n;Gt(jn(r),(()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`));const[o,s]=e;return{x:()=>wr(o.shape,t,s,i,a),filter:()=>xr(o,t,s.shape,i,a)}}},Sr=hn({sin_:function(t){const e={x:cn(t,"x","sin","float32")};return rn.runKernel("Sin",e)}}),Tr={kernelName:"Cos",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(yn(Sr(pn(n,"float32"))),t)}}},Er=hn({sinh_:function(t){const e={x:cn(t,"x","sinh")};return rn.runKernel(St,e)}}),kr={kernelName:F,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(Er(pn(n,"float32")),t)}}};function Ir(t,e){return function(t,e,n){const r=t.length+e.length,i=[];let a=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}(t,e.map((t=>1)),e)}function Ar(t,e){if(function(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((t=>n.push(t))),n}function Nr(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}const Cr=hn({cumsum_:function(t,e=0,n=!1,r=!1){const i={x:cn(t,"x","cumsum")},a={axis:e,exclusive:n,reverse:r};return rn.runKernel(P,i,a)}});function Rr(t){Je(t).forEach((t=>t.dispose()))}ze=function(t){se().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};const Or=hn({complex_:function(t,e){const n=cn(t,"real","complex"),r=cn(e,"imag","complex");!function(t,e,n=""){Gt(Vt(t,e),(()=>n+` Shapes ${t} and ${e} must match`))}(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return rn.runKernel("Complex",i)}}),Dr=hn({imag_:function(t){const e={input:cn(t,"input","imag")};return rn.runKernel("Imag",e)}}),Mr=hn({real_:function(t){const e={input:cn(t,"input","real")};return rn.runKernel("Real",e)}}),Fr=hn({transpose_:function(t,e,n){const r=cn(t,"x","transpose");if(null==e&&(e=r.shape.map(((t,e)=>e)).reverse()),Gt(r.rank===e.length,(()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`)),e.forEach((t=>{Gt(t>=0&&t<r.rank,(()=>"All entries in 'perm' must be between 0 and "+(r.rank-1)+` but got ${e}`))})),r.rank<=1)return r.clone();const i={x:r},a={perm:e};return"complex64"===r.dtype?function(t,e){return rn.tidy(t,e)}((()=>{let t=Mr(r),e=Dr(r);return t=rn.runKernel(Mt,{x:t},a),e=rn.runKernel(Mt,{x:e},a),n&&(e=yn(e)),Or(t,e)})):rn.runKernel(Mt,i,a)}}),Pr={kernelName:P,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i,exclusive:a,reverse:o}=n;return{x:()=>{const e=Ar([i],r.rank);let n=Cr(t,i,a,!o);return null!=e&&(n=Fr(n,e)),n}}}},Lr=hn({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,i,a=[1,1],o){let s=t;3===t.rank&&(s=In(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;3===u.rank&&(u=In(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:s,dy:u},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,filterShape:n};return rn.runKernel("DepthwiseConv2dNativeBackpropFilter",c,l)}}),Br=hn({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,i,a=[1,1],o){let s=e,u=!1;3===e.rank&&(u=!0,s=In(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:s,filter:n},l={strides:r,pad:i,dimRoundingMode:o,dilations:a,inputShape:t},h=rn.runKernel("DepthwiseConv2dNativeBackpropInput",c,l);return u?In(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),zr={kernelName:L,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a,dimRoundingMode:o}=n,s=r??[1,1];Gt(jn(s),(()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`));const[u,c]=e;return Gt(4===u.rank,(()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`)),Gt(4===c.rank,(()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`)),Gt(u.shape[3]===c.shape[2],(()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`)),Gt(Hn(i,s),(()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${s}'.`)),qn("depthwiseConv2d",a,o),{x:()=>Br(u.shape,t,c,i,a,s,o),filter:()=>Lr(u,t,c.shape,i,a,s,o)}}},Ur={kernelName:B,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,a={x:r,filter:i,dy:t},o={x:r,filter:i,dy:t};return{x:()=>rn.runKernel("Dilation2DBackpropInput",a,n),filter:()=>rn.runKernel("Dilation2DBackpropFilter",o,n)}}},Gr={kernelName:"Elu",outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>rn.runKernel("EluGrad",r)}}},Wr=hn({exp_:function(t){const e={x:cn(t,"x","exp")};return rn.runKernel("Exp",e)}}),Vr={kernelName:"Erf",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=fn(Wr(yn(wn(n))),2/Math.sqrt(Math.PI));return{x:()=>fn(t,r)}}},jr={kernelName:"Exp",outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(t,n)}}},Hr={kernelName:U,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>In(t,n.shape)}}},Xr={kernelName:G,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(t,Wr(n))}}},qr={kernelName:W,gradFunc:t=>({x:()=>Rn(t)})},Kr={kernelName:V,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=kn(n.shape,r.shape);return{a:()=>{const e=vn(t,pn(r,"float32")),a=En(n.shape,i);return a.length>0?In(An(e,a),n.shape):e},b:()=>{let e=fn(t,pn(n,"float32"));const a=En(r.shape,i);a.length>0&&(e=In(An(e,a),r.shape));const o=wn(r);return yn(vn(e,pn(o,"float32")))}}}},Yr=hn({rsqrt_:function(t){const e={x:cn(t,"x","rsqrt","float32")};return rn.runKernel(bt,e)}}),Zr=hn({tile_:function(t,e){const n=cn(t,"x","tile","string_or_numeric");Gt(n.rank===e.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`));const r={x:n},i={reps:e};return rn.runKernel(Dt,r,i)}}),$r={kernelName:j,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[i,a,o,s]=e,u=s??bn(1),c=En(a.shape,i.shape),l=[];if(1===a.rank){for(let t=0;t<i.shape.length-1;++t)l.push(i.shape[t]);l.push(1)}const h=_n(i,a),p=fn(t,u),f=Yr(Fn(o,bn(r))),d=fn(fn(fn(f,f),f),bn(-.5));return{x:()=>1===a.rank?In(fn(fn(t,Zr(In(f,[1,1,1,a.shape[0]]),l)),u),i.shape):In(fn(fn(t,f),u),i.shape),mean:()=>{let t=fn(fn(f,bn(-1)),p);return 1===a.rank&&(t=An(t,c)),In(t,a.shape)},variance:()=>{let t=fn(fn(d,h),p);return 1===a.rank&&(t=An(t,c)),In(t,a.shape)},scale:()=>{const e=fn(h,f);let n=fn(t,e);return 1===a.rank&&(n=An(n,c)),In(n,a.shape)},offset:()=>{let e=t;return 1===a.rank&&(e=An(e,c)),In(e,a.shape)}}}},Jr=hn({stack_:function(t,e=0){const n=ln(t,"tensors","stack","string_or_numeric");Gt(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&Gt(e<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,i={axis:e};return rn.runKernel(st,r,i)}}),Qr=hn({unsortedSegmentSum_:function(t,e,n){const r=cn(t,"x","unsortedSegmentSum"),i=cn(e,"segmentIds","unsortedSegmentSum","int32");Gt(jt(n),(()=>"numSegments must be of dtype int"));const a={x:r,segmentIds:i},o={numSegments:n};return rn.runKernel(Pt,a,o)}}),ti={kernelName:H,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,i]=e,{axis:a,batchDims:o}=n,s=Xt(a,r.shape)[0],u=(t,e,n)=>()=>{const r=t.shape,i=e.size,o=r.slice(0,s),u=o.length,c=r.slice(a,r.length).slice(1),l=c.length,h=ei(0,u),p=ei(u+1,u+1+l),f=ni([o,[i],c]),d=In(n,f),m=In(e,[i]),g=ni([[u],h,p]),v=Fr(d,g);let y=Qr(v,m,t.shape[s]);const b=Nr(g);return y=Fr(y,b),y};if(1===o){const e=r.shape[0],n=r.split(e,0);return{x:()=>Jr(n.map(((e,n)=>u(e,i.slice(n,1),t.slice(n,1))()))).reshape(r.shape),indices:()=>i}}return{x:u(r,i,t),indices:()=>i}}};function ei(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function ni(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}const ri={kernelName:X,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Rn(n),b:()=>Rn(r)}}},ii={kernelName:q,gradFunc:t=>({x:()=>pn(t,"float32")})},ai={kernelName:K,gradFunc:t=>({x:()=>Rn(t)})},oi={kernelName:Y,gradFunc:t=>({x:()=>Rn(t)})},si={kernelName:Z,gradFunc:t=>({x:()=>Rn(t)})},ui=hn({greater_:function(t,e){let n=cn(t,"a","greater","string_or_numeric"),r=cn(e,"b","greater","string_or_numeric");[n,r]=$e(n,r),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel("Greater",i)}}),ci={kernelName:$,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:i}=n,a=ui(r,0);return{x:()=>lr(a,t,fn(t,i))}}},li={kernelName:J,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,Fn(n,1))}}},hi={kernelName:"Log",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,pn(n,"float32"))}}},pi={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;return{logits:()=>{const e=Wr(r);return _n(t,fn(An(t,i,!0),e))}}}},fi=hn({localResponseNormalizationBackprop_:function(t,e,n,r=5,i=1,a=1,o=.5){const s={x:t,y:e,dy:n},u={depthRadius:r,bias:i,alpha:a,beta:o};return rn.runKernel("LRNGrad",s,u)}}),di={kernelName:"LRN",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{depthRadius:a,bias:o,alpha:s,beta:u}=n;return{x:()=>fi(r,i,t,a,o,s,u)}}},mi=hn({equal_:function(t,e){let n=cn(t,"a","equal","string_or_numeric"),r=cn(e,"b","equal","string_or_numeric");[n,r]=$e(n,r),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel("Equal",i)}});function gi(t,e,n,r){return e.rank<n.rank&&(e=In(e,Ir(e.shape,r))),t.rank<n.rank&&(t=In(t,Ir(t.shape,r))),{x:()=>fn(t,pn(mi(n,e),t.dtype))}}const vi={kernelName:"Max",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:i}=r,a=e[0],o=gi(t,e[1],a,Xt(i,a.shape));return{x:()=>o.x()}}},yi=hn({less_:function(t,e){let n=cn(t,"a","less","string_or_numeric"),r=cn(e,"b","less","string_or_numeric");[n,r]=$e(n,r),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel("Less",i)}}),bi={kernelName:Q,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>fn(t,pn(ar(n,r),"float32")),b:()=>fn(t,pn(yi(n,r),"float32"))}}},xi=hn({maxPool3dGrad_:function(t,e,n,r,i,a,o){const s=cn(t,"dy","maxPool3dGrad"),u=cn(e,"input","maxPool3dGrad"),c=cn(n,"output","maxPool3dGrad");let l=s,h=u,p=c,f=!1;4===u.rank&&(f=!0,l=In(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),h=In(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=In(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),Gt(5===l.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`)),Gt(5===h.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`)),Gt(5===p.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`)),qn("maxPool3dGrad",a,o);const d={dy:l,input:h,output:p},m={filterSize:r,strides:i,pad:a,dimRoundingMode:o},g=rn.runKernel("MaxPool3DGrad",d,m);return f?In(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),wi={kernelName:"MaxPool3D",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:o,pad:s,dimRoundingMode:u}=n;return{x:()=>xi(t,r,i,a,o,s,u)}}},_i=hn({maxPoolGrad_:function(t,e,n,r,i,a,o){const s=cn(t,"dy","maxPoolGrad"),u=cn(e,"input","maxPoolGrad"),c=cn(n,"output","maxPoolGrad");Gt(u.rank===s.rank,(()=>`Rank of input (${u.rank}) does not match rank of dy (${s.rank})`)),Gt(4===s.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${s.rank}.`)),Gt(4===u.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`)),qn("maxPoolGrad",a,o);const l={dy:s,input:u,output:c},h={filterSize:r,strides:i,pad:a,dimRoundingMode:o};return rn.runKernel("MaxPoolGrad",l,h)}}),Si={kernelName:tt,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:o,pad:s}=n;return{x:()=>_i(t,r,i,a,o,s)}}};function Ti(t,e="float32"){if(ne(t),"complex64"===e){const e=Ti(t,"float32"),n=Ti(t,"float32");return Or(e,n)}const n=ee(Wt(t),e);return rn.makeTensor(n,t,e)}function Ei(t,e="float32"){if(ne(t),"complex64"===e){const e=Ei(t,"float32"),n=Ti(t,"float32");return Or(e,n)}const n=te(Wt(t),e);return rn.makeTensor(n,t,e)}const ki={kernelName:et,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n,a=Xt(i,r.shape),o=Wt(function(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((e=>t[e]))]}(r.shape,a)[1]);return{x:()=>{const e=r.shape.slice();a.forEach((t=>{e[t]=1}));const n=In(t,e);return vn(fn(n,Ei(r.shape,"float32")),o)}}}},Ii={kernelName:"Min",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:i}=r,[a,o]=e,s=gi(t,o,a,Xt(i,a.shape));return{x:()=>s.x()}}},Ai={kernelName:nt,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>fn(t,pn(or(n,r),"float32")),b:()=>fn(t,pn(ui(n,r),"float32"))}}},Ni=hn({slice_:function(t,e,n){const r=cn(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const i={x:r},a={begin:e,size:n};return rn.runKernel(_t,i,a)}}),Ci={kernelName:rt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map((t=>t[0]));return{x:()=>Ni(t,a,r.shape)}}},Ri=hn({floor_:function(t){const e={x:cn(t,"x","floor","float32")};return rn.runKernel(W,e)}}),Oi={kernelName:"Mod",inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=kn(n.shape,r.shape);return{a:()=>{const e=En(n.shape,i);return e.length>0?In(An(t,e),n.shape):t},b:()=>{const e=fn(t,yn(Ri(vn(n,r)))),a=En(r.shape,i);return a.length>0?In(An(e,a),r.shape):e}}}},Di={kernelName:it,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=kn(n.shape,r.shape);return{a:()=>{const e=fn(t,pn(r,"float32")),a=En(n.shape,i);return a.length>0?In(An(e,a),n.shape):e},b:()=>{const e=fn(t,pn(n,"float32")),a=En(r.shape,i);return a.length>0?In(An(e,a),r.shape):e}}}},Mi={kernelName:"Neg",gradFunc:t=>({x:()=>yn(t)})},Fi={kernelName:ot,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Ti(n.shape,"float32")}}},Pi={kernelName:at,gradFunc:t=>({x:()=>Rn(t)})},Li=hn({unstack_:function(t,e=0){const n=cn(t,"x","unstack","string_or_numeric");Gt(e>=-n.shape.length&&e<n.shape.length,(()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`));const r={value:n},i={axis:e};return rn.runKernel(Ft,r,i)}}),Bi={kernelName:st,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return Li(t,r).map((t=>()=>t))}},zi={kernelName:ut,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map((t=>t[0]));return{x:()=>Ni(t,a,r.shape)}}},Ui=hn({log_:function(t){const e={x:cn(t,"x","log","float32")};return rn.runKernel("Log",e)}}),Gi=hn({pow_:function(t,e){let n=cn(t,"base","pow"),r=cn(e,"exp","pow");[n,r]=$e(n,r);const i={a:n,b:r};return rn.runKernel("Pow",i)}}),Wi={kernelName:"Pow",inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,i]=e,a=n,o=r,s=kn(a.shape,o.shape);return{a:()=>{const e=pn(o,"float32");let n=fn(t,fn(e,Gi(a,_n(e,bn(1)))));const r=En(a.shape,s);return r.length>0&&(n=An(n,r)),In(n,a.shape)},b:()=>{const e=ui(a,0),n=lr(e,Ui(a),Rn(a));let r=fn(t,fn(i,n));const u=En(o.shape,s);return u.length>0&&(r=An(r,u)),In(r,o.shape)}}}},Vi={kernelName:ct,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,i=ui(n,0);return{x:()=>lr(i,t,fn(t,r)),alpha:()=>{let e=lr(i,Rn(t),fn(t,n));const a=En(r.shape,t.shape);return a.length>0&&(e=An(e,a)),In(e,r.shape)}}}};const ji=se();ji.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),ji.registerFlag("IS_BROWSER",(()=>"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope)),ji.registerFlag("IS_NODE",(()=>void 0!==e&&void 0!==e.versions&&void 0!==e.versions.node)),ji.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),ji.registerFlag("IS_SAFARI",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),ji.registerFlag("PROD",(()=>!1)),ji.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>ji.getBool("DEBUG"))),ji.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),ji.registerFlag("IS_TEST",(()=>!1)),ji.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>ji.getBool("DEBUG"))),ji.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),ji.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),ji.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));class Hi{static join(t){return new Hi(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,null==t)return;if(t instanceof Array||(t=[t]),0===(t=t.map((t=>Te(t)?t.buffer:t))).length)return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let n=0;n<t.length;n++){const r=t[n];n!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=e+r.byteLength;this.shards.push({buffer:r,start:e,end:i}),e=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,e=this.byteLength){if(0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),(e=Math.min(this.byteLength,e))<=t)return new ArrayBuffer(0);const n=this.findShardForByte(t);if(-1===n)throw new Error(`Could not find start shard for byte ${t}`);const r=new ArrayBuffer(e-t),i=new Uint8Array(r);let a=0;for(let r=n;r<this.shards.length;r++){const n=this.shards[r],o=t+a-n.start,s=a,u=Math.min(e,n.end)-n.start,c=new Uint8Array(n.buffer,o,u-o);if(i.set(c,s),a+=c.length,e<n.end)break}return r}findShardForByte(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(e){return t<e.start?-1:t>=e.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(t,e){let n=0,r=t.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,a=e(t[i]);if(0===a)return i;a<0?r=i:n=i+1}return-1}(this.shards,e);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}const Xi=void 0!==i&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function qi(t){return Xi?i.byteLength(t,"utf8"):new Blob([t]).size}function Ki(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(n.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}async function Yi(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),function(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(r.initializerSignature=t.initializerSignature),r}(t,n,r)}function Zi(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:qi(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:qi(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:new Hi(t.weightData).byteLength}}function $i(t){const e=[];for(const n of t)e.push(...n.weights);return e}class Ji{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Ji.instance&&(Ji.instance=new Ji),Ji.instance}static registerSaveRouter(t){Ji.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Ji.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Ji.getHandlers(t,"save")}static getLoadHandlers(t,e){return Ji.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[];return("load"===e?Ji.getInstance().loadRouters:Ji.getInstance().saveRouters).forEach((e=>{const i=e(t,n);null!==i&&r.push(i)})),r}}const Qi="models_store",ta="model_info_store";class ea{constructor(t){if(this.indexedDB=function(){if(!se().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>function(t){const e=t.result;e.createObjectStore(Qi,{keyPath:"modelPath"}),e.createObjectStore(ta,{keyPath:"modelPath"})}(r),r.onsuccess=()=>{const i=r.result;if(null==e){const e=i.transaction(Qi,"readonly"),r=e.objectStore(Qi).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(r.result.modelArtifacts)},r.onerror=t=>(i.close(),n(r.error)),e.oncomplete=()=>i.close()}else{e.weightData=Hi.join(e.weightData);const r=Zi(e),a=i.transaction(ta,"readwrite");let o,s,u=a.objectStore(ta);try{o=u.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(t){return n(t)}o.onsuccess=()=>{s=i.transaction(Qi,"readwrite");const o=s.objectStore(Qi);let c;try{c=o.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r})}catch(t){return n(t)}c.onsuccess=()=>t({modelArtifactsInfo:r}),c.onerror=t=>{u=a.objectStore(ta);const e=u.delete(this.modelPath);e.onsuccess=()=>(i.close(),n(c.error)),e.onerror=t=>(i.close(),n(c.error))}},o.onerror=t=>(i.close(),n(o.error)),a.oncomplete=()=>{null==s?i.close():s.oncomplete=()=>i.close()}}},r.onerror=t=>n(r.error)}))}}ea.URL_SCHEME="indexeddb://";const na=t=>{return se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ea.URL_SCHEME)?(e=t.slice(ea.URL_SCHEME.length),new ea(e)):null;var e};Ji.registerSaveRouter(na),Ji.registerLoadRouter(na);const ra="/",ia="tensorflowjs_models",aa="info",oa="model_topology",sa="weight_specs",ua="weight_data",ca="model_metadata";class la{constructor(t){if(!se().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=function(t){return{info:[ia,t,aa].join(ra),topology:[ia,t,oa].join(ra),weightSpecs:[ia,t,sa].join(ra),weightData:[ia,t,ua].join(ra),modelMetadata:[ia,t,ca].join(ra)}}(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Zi(t),a=Hi.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(Xi)return i.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let t=0,r=e.length;t<r;t++)n+=String.fromCharCode(e[t]);return btoa(n)}(a));const o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch(t){throw function(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const t=JSON.parse(a);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(e.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=function(t){if(Xi){const e=i.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let t=0;t<e.length;++t)n.set([e.charCodeAt(t)],t);return n.buffer}(o),e}}la.URL_SCHEME="localstorage://";const ha=t=>{return se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(la.URL_SCHEME)?(e=t.slice(la.URL_SCHEME.length),new la(e)):null;var e};function pa(t){return new Promise((t=>setTimeout(t))).then(t)}Ji.registerSaveRouter(ha),Ji.registerLoadRouter(ha);class fa{constructor(t){if(!se().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(fa.URL_SCHEME)&&(t=t.slice(fa.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=Hi.join(t.weightData),n=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const e=Ki(t,[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(e)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=r,await pa((()=>i.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=n,await pa((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:Zi(t)}}}}function da(t,e,n,r){!function(t){Gt(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}(t),function(t,e){Gt(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${t}`)),Gt(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${e}`)),Gt(e>=t,(()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction ${e}`))}(n=n??0,r=r??1);let i=0;return Promise.all(t.map((a=>(a.then((a=>{const o=n+ ++i/t.length*(r-n);return e(o),a})),a))))}async function ma(t,e){null==e&&(e={});const n=null==e.fetchFunc?se().platform.fetch:e.fetchFunc,r=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),i=(null==e.onProgress?await Promise.all(r):await da(r,e.onProgress,0,.5)).map((t=>t.arrayBuffer()));return null==e.onProgress?await Promise.all(i):await da(i,e.onProgress,.5,1)}fa.URL_SCHEME="downloads://",Ji.registerSaveRouter((t=>se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(fa.URL_SCHEME)?function(t="model"){return new fa(t)}(t.slice(fa.URL_SCHEME.length)):null));class ga{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(Gt("function"==typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=se().platform.fetch,Gt(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&Gt(2===t.length,(()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`)),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=Ki(t,[{paths:["./model.weights.bin"],weights:t.weightSpecs}]);if(e.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=t.weightData){const n=Hi.join(t.weightData);e.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,e);if(r.ok)return{modelArtifactsInfo:Zi(t),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let e;try{e=await t.json()}catch(t){let e=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return e}async load(){return this.loadOptions.streamWeights?this.loadStream():Yi(await this.loadModelJSON(),(t=>this.loadWeights(t)))}async loadStream(){const t=await this.loadModelJSON(),e=await this.getWeightUrls(t.weightsManifest),n=$i(t.weightsManifest);return Object.assign(Object.assign({},t),{weightSpecs:n,getWeightStream:()=>function(t,e){var n;const r=null==e.fetchFunc?se().platform.fetch:e.fetchFunc;let i,a=0;return null===(n=e.onProgress)||void 0===n||n.call(e,0),new ReadableStream({pull:async n=>{for(var o;a<t.length;){if(!i){const n=(await r(t[a],e.requestInit,{isBinary:!0})).body;i=n.getReader()}const{done:s,value:u}=await i.read();if(!s)return void n.enqueue(u);a++,i=void 0,null===(o=e.onProgress)||void 0===o||o.call(e,a/t.length)}n.close()}})}(e,this.loadOptions)})}async getWeightUrls(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),i=this.weightPathPrefix||n,a=[],o=[];for(const e of t)for(const t of e.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(t)):a.push(i+t+r);return this.weightUrlConverter&&a.push(...await Promise.all(o)),a}async loadWeights(t){const e=await this.getWeightUrls(t);return[$i(t),await ma(e,this.loadOptions)]}}function va(t){return null!=t.match(ga.URL_SCHEME_REGEX)}ga.URL_SCHEME_REGEX=/^https?:\/\//;const ya=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>va(t))):va(t),n)return function(t,e){return new ga(t,e)}(t,e)}return null};Ji.registerSaveRouter(ya),Ji.registerLoadRouter(ya);const ba=hn({oneHot_:function(t,e,n=1,r=0,i="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:cn(t,"indices","oneHot","int32")},o={dtype:i,depth:e,onValue:n,offValue:r};return rn.runKernel(ot,a,o)}});function xa(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===e.size)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(0===t.size)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}!function(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(t.length<r+(n.rank-i))throw new Error(a+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != "+(i+t.length-r));for(let t=0;t<i;++t)if(n.shape[t]!==e.shape[t])throw new Error(a+` updates.shape[${t}] (${n.shape[t]}) != indices.shape[${t}] (${e.shape[t]}).`);for(let e=0;e<n.rank-i;++e)if(n.shape[e+i]!==t[e+r])throw new Error(a+` updates.shape[${e+i}] (${n.shape[e+i]}) != shape[${e+i}] (${t[e+i]})`)}(n,e,t)}new Map,new Map;class wa{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}const _a=hn({abs_:function(t){const e=cn(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return rn.runKernel(R,t)}{const t={x:e};return rn.runKernel("Abs",t)}}}),Sa=hn({acos_:function(t){const e={x:cn(t,"x","acos")};return rn.runKernel(m,e)}}),Ta=hn({acosh_:function(t){const e={x:cn(t,"x","acosh")};return rn.runKernel(g,e)}}),Ea=hn({all_:function(t,e=null,n=!1){const r={x:cn(t,"x","all","bool")},i={axis:e,keepDims:n};return rn.runKernel("All",r,i)}}),ka=hn({any_:function(t,e=null,n=!1){const r={x:cn(t,"x","any","bool")},i={axis:e,keepDims:n};return rn.runKernel("Any",r,i)}}),Ia=hn({argMax_:function(t,e=0){const n={x:cn(t,"x","argMax")},r={axis:e};return rn.runKernel(y,n,r)}}),Aa=hn({argMin_:function(t,e=0){const n={x:cn(t,"x","argMin")},r={axis:e};return rn.runKernel(b,n,r)}}),Na=hn({asin_:function(t){const e={x:cn(t,"x","asin")};return rn.runKernel(x,e)}}),Ca=hn({asinh_:function(t){const e={x:cn(t,"x","asinh")};return rn.runKernel(w,e)}}),Ra=hn({atan_:function(t){const e={x:cn(t,"x","atan")};return rn.runKernel(_,e)}}),Oa=hn({atan2_:function(t,e){let n=cn(t,"a","atan2"),r=cn(e,"b","atan2");[n,r]=$e(n,r);const i={a:n,b:r};return rn.runKernel(T,i)}}),Da=hn({atanh_:function(t){const e={x:cn(t,"x","atanh")};return rn.runKernel(S,e)}}),Ma=hn({avgPool_:function(t,e,n,r,i){const a=cn(t,"x","avgPool","float32");Gt(Hn(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let o=a,s=!1;3===a.rank&&(s=!0,o=In(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Gt(4===o.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`)),qn("avgPool",r,i);const u={x:o},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i};let l=rn.runKernel(E,u,c);return l=pn(l,a.dtype),s?In(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),Fa=hn({concat_:function(t,e=0){Gt(t.length>=1,(()=>"Pass at least one tensor to concat"));const n=ln(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)})),1===n.length)return ur(n[0]);const r=n,i={axis:e};return rn.runKernel(O,r,i)}}),Pa=hn({sigmoid_:function(t){const e={x:cn(t,"x","sigmoid","float32")};return rn.runKernel(Et,e)}}),La=hn({tanh_:function(t){const e={x:cn(t,"x","tanh","float32")};return rn.runKernel(Ot,e)}}),Ba=hn({batchToSpaceND_:function(t,e,n){const r=cn(t,"x","batchToSpaceND"),i=e.reduce(((t,e)=>t*e));Gt(r.rank>=1+e.length,(()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`)),Gt(n.length===e.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`)),Gt(r.shape[0]%i==0,(()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${i}`));const a={x:r},o={blockShape:e,crops:n};return rn.runKernel(I,a,o)}}),za=hn({batchNorm_:function(t,e,n,r,i,a){null==a&&(a=.001);const o=cn(t,"x","batchNorm"),s=cn(e,"mean","batchNorm"),u=cn(n,"variance","batchNorm");let c,l;null!=i&&(c=cn(i,"scale","batchNorm")),null!=r&&(l=cn(r,"offset","batchNorm")),Gt(s.rank===u.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),Gt(null==l||s.rank===l.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),Gt(null==c||s.rank===c.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const h={x:function(t){let e;return e=0===t.rank||1===t.rank?In(t,[1,1,1,t.size]):2===t.rank?In(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?In(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(o),scale:c,offset:l,mean:s,variance:u},p={varianceEpsilon:a},f=rn.runKernel(j,h,p);return In(f,o.shape)}}),Ua=hn({ceil_:function(t){const e={x:cn(t,"x","ceil","float32")};return rn.runKernel(N,e)}});const Ga=hn({clipByValue_:function(t,e,n){const r=cn(t,"x","clipByValue");if(Gt(e<=n,(()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`)),e===n)return function(t,e,n){ne(t);const r={shape:t,value:e,dtype:n=n||Yt(e)};return rn.runKernel("Fill",{},r)}(r.shape,e,r.dtype);const i={x:r},a={clipValueMin:e,clipValueMax:n};return rn.runKernel(C,i,a)}}),Wa=hn({conv1d_:function(t,e,n,r,i="NWC",a=1,o){const s=cn(t,"x","conv1d"),u=cn(e,"filter","conv1d");let c=s,l=!1;2===s.rank&&(l=!0,c=In(s,[1,s.shape[0],s.shape[1]])),Gt(3===c.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`)),Gt(3===u.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`)),qn("conv1d",r,o),Gt(c.shape[2]===u.shape[1],(()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${u.shape[1]}.`)),Gt(Hn(n,a),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`)),Gt(Xn(a),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),Gt(Xn(n),(()=>"Error in conv1D: Stride should be larger than 0.")),Gt("NWC"===i,(()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`));const h=In(u,[1,u.shape[0],u.shape[1],u.shape[2]]),p=In(c,[c.shape[0],1,c.shape[1],c.shape[2]]),f=yr(p,h,[1,n],r,"NHWC",[1,a],o);return In(f,l?[f.shape[2],f.shape[3]]:[f.shape[0],f.shape[2],f.shape[3]])}}),Va=hn({conv2dTranspose_:function(t,e,n,r,i,a){const o=cn(t,"x","conv2dTranspose"),s=cn(e,"filter","conv2dTranspose");return gr(n,o,s,r,i,"NHWC",a)}}),ja=hn({cos_:function(t){const e={x:cn(t,"x","cos","float32")};return rn.runKernel("Cos",e)}}),Ha=hn({cosh_:function(t){const e={x:cn(t,"x","cosh","float32")};return rn.runKernel(F,e)}}),Xa=hn({cumprod_:function(t,e=0,n=!1,r=!1){const i={x:cn(t,"x","cumprod")},a={axis:e,exclusive:n,reverse:r};return rn.runKernel("Cumprod",i,a)}}),qa=hn({depthToSpace_:function(t,e,n="NHWC"){const r=cn(t,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];Gt(e>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`)),Gt(i*e>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${e}  for depthToSpace with input shape\n    ${r.shape}`)),Gt(a*e>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${e} for depthToSpace with input shape\n        ${r.shape}`)),Gt(o%(e*e)==0,(()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`));const s={x:r},u={blockSize:e,dataFormat:n};return rn.runKernel("DepthToSpace",s,u)}}),Ka=hn({depthwiseConv2d_:function(t,e,n,r,i="NHWC",a=[1,1],o){const s=cn(t,"x","depthwiseConv2d","float32"),u=cn(e,"filter","depthwiseConv2d","float32");let c=s,l=!1;3===s.rank&&(l=!0,c=In(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Gt(4===c.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`)),Gt(4===u.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`));const h="NHWC"===i?c.shape[3]:c.shape[1];Gt(h===u.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${u.shape[2]}.`)),qn("depthwiseConv2d",r,o);const p={x:c,filter:u},f={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},d=rn.runKernel(L,p,f);return l?In(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Ya=hn({dilation2d_:function(t,e,n,r,i=[1,1],a="NHWC"){const o=cn(t,"x","dilation2d"),s=cn(e,"filter","dilation2d");Gt(3===o.rank||4===o.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`)),Gt(3===s.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${s.rank}.`)),Gt("NHWC"===a,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`));let u=o,c=!1;3===o.rank&&(u=In(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),Gt(u.shape[3]===s.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${s.shape[2]}`));const l={x:u,filter:s},h={strides:n,pad:r,dilations:i},p=rn.runKernel(B,l,h);return c?In(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Za=hn({divNoNan_:function(t,e){let n=cn(t,"a","div"),r=cn(e,"b","div");[n,r]=$e(n,r);const i=vn(n,r),a=Rn(i),o=mi(r,a);return lr(o,a,i)}}),$a=hn({dot_:function(t,e){const n=cn(t,"t1","dot"),r=cn(e,"t2","dot");Gt(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`));const i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(Gt(i===a,(()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`)),1===n.rank&&1===r.rank){const t=In(n,[1,-1]),e=In(r,[-1,1]),i=Jn(t,e);return In(i,[])}if(1===n.rank&&2===r.rank){const t=In(n,[1,-1]),e=In(r,[r.shape[0],r.shape[1]]),i=Jn(t,e);return In(i,[i.size])}if(2===n.rank&&1===r.rank){const t=In(r,[-1,1]),e=Jn(n,t);return In(e,[e.size])}{const t=In(r,[r.shape[0],r.shape[1]]);return Jn(n,t)}}}),Ja=hn({elu_:function(t){const e={x:cn(t,"x","elu","float32")};return rn.runKernel("Elu",e)}}),Qa=hn({erf_:function(t){let e=cn(t,"x","erf");Gt("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=pn(e,"float32"));const n={x:e};return rn.runKernel("Erf",n)}}),to=hn({max_:function(t,e=null,n=!1){const r={x:cn(t,"x","max")},i={reductionIndices:e,keepDims:n};return rn.runKernel("Max",r,i)}}),eo=hn({min_:function(t,e=null,n=!1){const r={x:cn(t,"x","min")},i={axis:e,keepDims:n};return rn.runKernel("Min",r,i)}});function no(t,e,n=null){if(0===t.rank)return _a(t);if(1!==t.rank&&null===n)return no(In(t,[-1]),e,n);if(1===t.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===e)return An(_a(t),n);if(e===1/0)return to(_a(t),n);if(e===-1/0)return eo(_a(t),n);if("euclidean"===e||2===e)return xn(An(Gi(_a(t),bn(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&2===n.length){if(1===e)return to(An(_a(t),n[0]),n[1]-1);if(e===1/0)return to(An(_a(t),n[1]),n[0]);if(e===-1/0)return eo(An(_a(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return xn(An(wn(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const ro=hn({norm_:function(t,e="euclidean",n=null,r=!1){const i=no(t=cn(t,"x","norm"),e,n);let a=i.shape;if(r){const e=Xt(n,t.shape);a=Ir(i.shape,e)}return In(i,a)}}),io=hn({euclideanNorm_:function(t,e=null,n=!1){return ro(t,"euclidean",e,n)}}),ao=hn({expandDims_:function(t,e=0){const n=cn(t,"x","expandDims","string_or_numeric");Gt(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},i={dim:e};return rn.runKernel(U,r,i)}}),oo=hn({expm1_:function(t){const e={x:cn(t,"x","expm1")};return rn.runKernel(G,e)}}),so=hn({gather_:function(t,e,n=0,r=0){const i={x:cn(t,"x","gather"),indices:cn(e,"indices","gather","int32")},a={axis:n,batchDims:r};return rn.runKernel(H,i,a)}}),uo=hn({isFinite_:function(t){const e={x:cn(t,"x","isFinite")};return rn.runKernel(K,e)}}),co=hn({isInf_:function(t){const e={x:cn(t,"x","isInf")};return rn.runKernel(Y,e)}}),lo=hn({isNaN_:function(t){const e={x:cn(t,"x","isNaN")};return rn.runKernel(Z,e)}}),ho=hn({leakyRelu_:function(t,e=.2){const n={x:cn(t,"x","leakyRelu")},r={alpha:e};return rn.runKernel($,n,r)}}),po=hn({localResponseNormalization_:function(t,e=5,n=1,r=1,i=.5){const a=cn(t,"x","localResponseNormalization");Gt(4===a.rank||3===a.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${a.rank}.`)),Gt(jt(e),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`));let o=a,s=!1;3===a.rank&&(s=!0,o=In(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const u={x:o},c={depthRadius:e,bias:n,alpha:r,beta:i},l=rn.runKernel("LRN",u,c);return s?In(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),fo=hn({log1p_:function(t){const e={x:cn(t,"x","log1p")};return rn.runKernel(J,e)}});function mo(t){return rn.customGrad(t)}const go=hn({softplus_:function(t){const e={x:cn(t,"x","softplus")};return rn.runKernel(kt,e)}}),vo=hn({logSigmoid_:function(t){const e=cn(t,"x","logSigmoid");return mo((t=>({value:yn(go(yn(t))),gradFunc:e=>fn(e,Pa(yn(t)))})))(e)}}),yo=hn({logSoftmax_:function(t,e=-1){const n=cn(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);const r=mo(((t,n)=>{const r=to(t,e,!0),i=_n(t,r),a=_n(pn(i,"float32"),Ui(An(Wr(i),e,!0)));return n([a]),{value:a,gradFunc:(t,n)=>{const[r]=n,i=Wr(r);return _n(t,fn(An(t,e,!0),i))}}}));return r(n)}}),bo=hn({logSumExp_:function(t,e=null,n=!1){const r=cn(t,"x","logSumExp"),i=Xt(e,r.shape),a=to(r,i,!0),o=_n(r,a),s=Wr(o),u=An(s,i),c=Ui(u),l=Fn(In(a,c.shape),c);if(n){const t=Ir(l.shape,i);return In(l,t)}return l}}),xo=hn({logicalNot_:function(t){const e={x:cn(t,"x","logicalNot","bool")};return rn.runKernel("LogicalNot",e)}}),wo=hn({logicalOr_:function(t,e){const n=cn(t,"a","logicalOr","bool"),r=cn(e,"b","logicalOr","bool");kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel("LogicalOr",i)}}),_o=hn({logicalXor_:function(t,e){const n=cn(t,"a","logicalXor","bool"),r=cn(e,"b","logicalXor","bool");return kn(n.shape,r.shape),sr(wo(t,e),xo(sr(t,e)))}}),So=hn({maxPool_:function(t,e,n,r,i){const a=cn(t,"x","maxPool");let o=a,s=!1;3===a.rank&&(s=!0,o=In(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Gt(4===o.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`)),Gt(Hn(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),qn("maxPool",r,i);const u={x:o},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i},l=rn.runKernel(tt,u,c);return s?In(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),To=hn({maximum_:function(t,e){let n=cn(t,"a","maximum"),r=cn(e,"b","maximum");[n,r]=$e(n,r),"bool"===n.dtype&&(n=pn(n,"int32"),r=pn(r,"int32")),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel(Q,i)}}),Eo=hn({mean_:function(t,e=null,n=!1){const r={x:cn(t,"x","mean")},i={axis:e,keepDims:n};return rn.runKernel(et,r,i)}}),ko=hn({minimum_:function(t,e){let n=cn(t,"a","minimum"),r=cn(e,"b","minimum");[n,r]=$e(n,r),"bool"===n.dtype&&(n=pn(n,"int32"),r=pn(r,"int32")),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel(nt,i)}}),Io=hn({mirrorPad_:function(t,e,n){Gt("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const r=cn(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Gt(e.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`));const i="reflect"===n?1:0;for(let t=0;t<r.rank;t++)Gt(2===e[t].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),Gt(e[t][0]>=0&&e[t][0]<=r.shape[t]-i&&e[t][1]>=0&&e[t][1]<=r.shape[t]-i,(()=>`Padding in dimension ${t} cannot be greater than or equal to ${r.shape[t]-i} or less than 0 for input of shape ${r.shape}`));const a={paddings:e,mode:n},o={x:r};return rn.runKernel(rt,o,a)}}),Ao=hn({mod_:function(t,e){let n=cn(t,"a","mod"),r=cn(e,"b","mod");[n,r]=$e(n,r);const i={a:n,b:r};return rn.runKernel("Mod",i)}}),No=hn({notEqual_:function(t,e){let n=cn(t,"a","notEqual","string_or_numeric"),r=cn(e,"b","notEqual","string_or_numeric");[n,r]=$e(n,r),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel("NotEqual",i)}}),Co=hn({onesLike_:function(t){const e={x:cn(t,"x","onesLike")};return rn.runKernel(at,e)}}),Ro=hn({pad_:function(t,e,n=0){const r=cn(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:e,constantValue:n},a={x:r};return rn.runKernel(ut,a,i)}}),Oo=hn({pool_:function(t,e,n,r,i,a,o){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");const s=cn(t,"x","maxPool");let u=s,c=!1;3===s.rank&&(c=!0,u=In(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Gt(Hn(a,i),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`));const l=Un(u.shape,e,a,i,r),h=[l.dilationHeight,l.dilationWidth];let p;p="same"===r?function(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))).map((t=>t-1)),r=n.map((t=>Math.floor(t/2))),i=n.map(((t,e)=>t-r[e]));return n.map(((t,e)=>[r[e],i[e]]))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];const f=1===h[0]&&1===h[1],[d,m]=function(t,e,n){const r=n.map((t=>t[0])),i=n.map((t=>t[1])),a=t.concat(r,i),o=e.map(((t,e)=>(t-a[e]%t)%t)),s=i.map(((t,e)=>t+o[e]));return[e.map(((t,e)=>[r[e],s[e]])),e.map(((t,e)=>[0,o[e]]))]}([l.inHeight,l.inWidth],h,p),g=f?r:"valid",v=f?u:tr(u,h,d),y=("avg"===n?()=>Ma(v,e,a,g,o):()=>So(v,e,a,g,o))(),b=f?y:Ba(y,h,m);return c?In(b,[b.shape[1],b.shape[2],b.shape[3]]):b}}),Do=hn({prelu_:function(t,e){const n={x:cn(t,"x","prelu"),alpha:cn(e,"alpha","prelu")};return rn.runKernel(ct,n)}}),Mo=hn({prod_:function(t,e=null,n=!1){let r=cn(t,"x","prod");"bool"===r.dtype&&(r=pn(r,"int32"));const i={x:r},a={axis:e,keepDims:n};return rn.runKernel(lt,i,a)}});var Fo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{},Po={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197;return function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var i=new n(t),a=e&&e.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)}(Po);var Lo=Po.exports,Bo={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)}(Bo);var zo=Bo.exports,Uo={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)}(Uo);var Go=Uo.exports,Wo={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.x&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)}(Wo);var Vo=Wo.exports,jo={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.X&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)}(jo);var Ho=jo.exports,Xo={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)}(Xo);var qo=Xo.exports,Ko={exports:{}};!function(e){!function(n,r,i){var a,o=256,s="random",u=i.pow(o,6),c=i.pow(2,52),l=2*c,h=o-1;function p(t,e,h){var p=[],y=g(m((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(r)]:t??function(){try{var t;return a&&(t=a.randomBytes)?t=t(o):(t=new Uint8Array(o),(n.crypto||n.msCrypto).getRandomValues(t)),v(t)}catch(t){var e=n.navigator,i=e&&e.plugins;return[+new Date,n,i,n.screen,v(r)]}}(),3),p),b=new f(p),x=function(){for(var t=b.g(6),e=u,n=0;t<c;)t=(t+n)*o,e*=o,n=b.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,g(v(b.S),r),(e.pass||h||function(t,e,n,r){return r&&(r.S&&d(r,b),t.state=function(){return d(b,{})}),n?(i[s]=t,e):t})(x,y,"global"in e?e.global:this==i,e.state)}function f(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=h&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*o+s[h&(s[i]=s[a=h&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(o)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(m(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function g(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(g(i.random(),r),e.exports){e.exports=p;try{a=t("crypto")}catch(t){}}else i["seed"+s]=p}("undefined"!=typeof self?self:Fo,[],Math)}(Ko);var Yo=Lo,Zo=zo,$o=Go,Jo=Vo,Qo=Ho,ts=qo,es=Ko.exports;es.alea=Yo,es.xor128=Zo,es.xorwow=$o,es.xorshift7=Jo,es.xor4096=Qo,es.tychei=ts;const ns=hn({reciprocal_:function(t){const e={x:cn(t,"x","reciprocal")};return rn.runKernel(ht,e)}}),rs=hn({relu_:function(t){const e={x:cn(t,"x","relu")};return rn.runKernel(pt,e)}}),is=hn({relu6_:function(t){const e={x:cn(t,"x","relu6")};return rn.runKernel(gt,e)}}),as=hn({reverse_:function(t,e){const n={x:cn(t,"x","reverse")},r={dims:e};return rn.runKernel(vt,n,r)}}),os=hn({round_:function(t){const e={x:cn(t,"x","round")};return rn.runKernel(yt,e)}}),ss=hn({selu_:function(t){const e={x:cn(t,"x","selu")};return rn.runKernel(wt,e)}}),us=hn({separableConv2d_:function(t,e,n,r,i,a=[1,1],o="NHWC"){const s=cn(t,"x","separableConv2d"),u=cn(e,"depthwiseFilter","separableConv2d"),c=cn(n,"pointwiseFilter","separableConv2d");let l=s,h=!1;if(3===s.rank&&(h=!0,l=In(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Gt(4===l.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${l.rank}.`)),Gt(4===u.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`)),Gt(4===c.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`)),Gt(1===c.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`)),Gt(1===c.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`));const p=u.shape[2],f=u.shape[3];Gt(c.shape[2]===p*f,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*f}, but got ${c.shape[2]}.`));const d=Ka(l,u,r,i,o,a),m=yr(d,c,1,"valid",o);return h?In(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),cs=hn({sign_:function(t){const e={x:cn(t,"x","sign")};return rn.runKernel(Tt,e)}}),ls=hn({softmax_:function(t,e=-1){const n=cn(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},i={dim:e};return rn.runKernel(Ct,r,i)}}),hs=hn({fft_:function(t){Gt("complex64"===t.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`));const e={input:t};return rn.runKernel("FFT",e)}}),ps=hn({ifft_:function(t){Gt("complex64"===t.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`));const e={input:t};return rn.runKernel("IFFT",e)}}),fs=hn({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const i=In(t,[n,e]);r=ps(i)}else{const i=[n,2*(e-1)],a=In(Mr(t),[n,e]),o=In(Dr(t),[n,e]),s=as(Ni(a,[0,1],[n,e-2]),1),u=fn(as(Ni(o,[0,1],[n,e-2]),1),bn(-1)),c=Fa([a,s],1),l=Fa([o,u],1),h=In(Or(c,l),[i[0],i[1]]);r=ps(h)}if(r=Mr(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=In(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}}),ds=hn({rfft_:function(t,e){Gt("float32"===t.dtype,(()=>`The dtype for rfft() must be real value but got ${t.dtype}`));let n=t.shape[t.shape.length-1];const r=t.size/n;let i;if(null!=e&&e<n){const r=t.shape.map((t=>0)),a=t.shape.map((t=>t));a[t.shape.length-1]=e,i=Ni(t,r,a),n=e}else if(null!=e&&e>n){const r=t.shape.map((t=>t));r[t.shape.length-1]=e-n,i=Fa([t,Ti(r)],t.shape.length-1),n=e}else i=t;const a=Rn(i),o=In(Or(i,a),[r,n]),s=hs(o),u=Math.floor(n/2)+1,c=Mr(s),l=Dr(s),h=fr(c,[u,n-u],c.shape.length-1),p=fr(l,[u,n-u],l.shape.length-1),f=i.shape.slice();return f[i.shape.length-1]=u,In(Or(h[0],p[0]),f)}}),ms=hn({squaredDifference_:function(t,e){let n=cn(t,"a","squaredDifference"),r=cn(e,"b","squaredDifference");[n,r]=$e(n,r),kn(n.shape,r.shape);const i={a:n,b:r};return rn.runKernel(Rt,i,{})}}),gs=hn({squeeze_:function(t,e){const n=cn(t,"x","squeeze","string_or_numeric");return In(n,function(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:Xt(e,t).sort();let o=0;for(let e=0;e<t.length;++e){if(null!=a){if(a[o]===e&&1!==t[e])throw new Error(`Can't squeeze axis ${e} since its dim '${t[e]}' is not 1`);(null==a[o]||a[o]>e)&&1===t[e]&&(n.push(t[e]),r.push(e)),a[o]<=e&&o++}1!==t[e]&&(n.push(t[e]),r.push(e))}return{newShape:n,keptDims:r}}(n.shape,e).newShape)}}),vs=hn({stridedSlice_:function(t,e,n,r,i=0,a=0,o=0,s=0,u=0){const c={x:cn(t,"x","stridedSlice","string_or_numeric")},l={begin:e,end:n,strides:r,beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return rn.runKernel("StridedSlice",c,l)}}),ys=hn({tan_:function(t){const e={x:cn(t,"x","tan","float32")};return rn.runKernel("Tan",e)}});hn({tensorScatterUpdate_:function(t,e,n){const r=cn(t,"tensor","tensorScatterupdate"),i=cn(e,"indices","tensorScatterupdate","int32"),a=cn(n,"updates","tensorScatterupdate");if(xa(a,i,r.shape),r.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${a.dtype}.`);const o={tensor:r,indices:i,updates:a};return rn.runKernel("TensorScatterUpdate",o,{})}});const bs=hn({topk_:function(t,e=1,n=!0){const r=cn(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${e}`);const a={x:r},o={k:e,sorted:n},[s,u]=rn.runKernel("TopK",a,o);return{values:s,indices:u}}}),xs=hn({unique_:function(t,e=0){const n=cn(t,"x","unique","string_or_numeric");Gt(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},i={axis:e},[a,o]=rn.runKernel("Unique",r,i);return{values:a,indices:o}}}),ws=hn({resizeBilinear_:function(t,e,n=!1,r=!1){const i=cn(t,"images","resizeBilinear");Gt(3===i.rank||4===i.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`)),Gt(2===e.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`)),Gt(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let a=i,o=!1;3===i.rank&&(o=!0,a=In(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,s={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=rn.runKernel(mt,s,u);return o?In(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),_s=hn({resizeNearestNeighbor_:function(t,e,n=!1,r=!1){const i=cn(t,"images","resizeNearestNeighbor");Gt(3===i.rank||4===i.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`)),Gt(2===e.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`)),Gt("float32"===i.dtype||"int32"===i.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),Gt(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let a=i,o=!1;3===i.rank&&(o=!0,a=In(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,s={images:a},u={alignCorners:n,halfPixelCenters:r,size:e},c=rn.runKernel(dt,s,u);return o?In(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var Ss,Ts;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Ss||(Ss={}));Object.defineProperty(class extends wa{minimize(t,e=!1,n){const{value:r,grads:i}=this.computeGradients(t,n);if(null!=n){const t=n.map((t=>({name:t.name,tensor:i[t.name]})));this.applyGradients(t)}else this.applyGradients(i);return Rr(i),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return function(t,e){Gt(Zt(t),(()=>"The f passed in variableGrads(f) must be a function")),Gt(null==e||Array.isArray(e)&&e.every((t=>t instanceof We)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=e;if(!n){e=[];for(const t in rn.registeredVariables)e.push(rn.registeredVariables[t])}const r=n?e.filter((t=>!t.trainable)):null,i=e.length;e=e.filter((t=>t.trainable)),Gt(e.length>0,(()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`));const{value:a,grads:o}=rn.gradients(t,e,null,!0);Gt(o.some((t=>null!=t)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),Gt(0===a.rank,(()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`));const s={};return e.forEach(((t,e)=>{null!=o[e]&&(s[t.name]=o[e])})),null!=r&&r.forEach((t=>s[t.name]=null)),{value:a,grads:s}}(t,e)}dispose(){null!=this.iterations_&&Rr(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:bn(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}},Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}),"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(Ts||(Ts={}));const Es={kernelName:At,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>Ba(t,r,i)}}},ks={kernelName:Nt,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>Fa(t,r)}}},Is=[mn,Sn,Tn,Nn,Cn,On,Dn,Mn,Pn,Ln,Bn,zn,Yn,$n,Qn,er,nr,rr,ir,hr,pr,dr,br,vr,_r,Tr,kr,Pr,zr,Ur,{kernelName:z,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=kn(n.shape,r.shape);return{a:()=>{const e=vn(t,pn(r,"float32")),a=En(n.shape,i);return a.length>0?In(An(e,a),n.shape):e},b:()=>{let e=fn(t,pn(n,"float32"));const a=En(r.shape,i);a.length>0&&(e=In(An(e,a),r.shape));const o=wn(r);return yn(vn(e,pn(o,"float32")))}}}},Gr,Vr,jr,Hr,Xr,Kr,qr,$r,ti,ri,ii,ai,oi,si,ci,li,hi,pi,di,vi,vi,bi,wi,Si,ki,Ii,Ai,Ci,Oi,Di,Mi,Fi,Pi,Bi,zi,zi,Wi,Vi,{kernelName:lt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;let a=[];return a=null==i?r.shape.map(((t,e)=>e)):"number"==typeof i?[i]:i,{x:()=>function(t,e,n){const r=t.shape.length,i=r-n.length,a=Ar(n,r);let o=t;null!=a&&(o=Fr(t,a));const s=o.shape.slice(),u=s.splice(r-n.length,n.length).reduce(((t,e)=>t*e),1);s.push(u);let c=function(t,e,n){const r=t.shape.slice();r[n]=1;const i=In(e,r),a=Xa(t,n,!0,!1),o=Xa(t,n,!0,!0),s=fn(a,o);return fn(i,s)}(o.reshape(s),e,i);if(c=c.reshape(o.shape),null!=a){const t=Nr(a);c=Fr(c,t)}return c}(r,t,a)}}},{kernelName:ht,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,yn(wn(n)))}}},{kernelName:gt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=fn(or(n,6),dn(n));return{x:()=>fn(t,pn(r,"float32"))}}},{kernelName:pt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(t,pn(dn(n),"float32"))}}},{kernelName:ft,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>In(t,n.shape)}}},{kernelName:mt,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>rn.runKernel("ResizeBilinearGrad",i,n)}}},{kernelName:dt,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>rn.runKernel("ResizeNearestNeighborGrad",i,n)}}},{kernelName:vt,gradFunc:(t,e,n)=>{const{dims:r}=n,i=Xt(r,t.shape);return{x:()=>as(t,i)}}},{kernelName:yt,gradFunc:t=>({x:()=>Rn(t)})},{kernelName:bt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yn(vn(t,fn(Gi(n,1.5),2)))}}},{kernelName:xt,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>pn(Rn(n),"float32"),t:()=>fn(t,pn(n,t.dtype)),e:()=>fn(t,pn(xo(n),t.dtype))}}},{kernelName:wt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=ui(n,bn(0)),r=bn(1.7580993408473768),i=bn(1.0507009873554805),a=fn(t,i),o=fn(fn(t,r),Wr(pn(n,"float32")));return lr(e,a,o)}}}},{kernelName:Et,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(t,fn(n,_n(bn(1),n)))}}},{kernelName:Tt,gradFunc:t=>({x:()=>Rn(t)})},{kernelName:"Sin",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(ja(pn(n,"float32")),t)}}},{kernelName:St,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(Ha(pn(n,"float32")),t)}}},{kernelName:_t,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:i,size:a}=n,o=r.shape,[s,u]=function(t,e,n){let r;const i=t.shape.length;let a;return r="number"==typeof e?[e,...new Array(i-1).fill(0)]:e.length<i?e.concat(new Array(i-e.length).fill(0)):e.slice(),r.forEach((t=>{Gt(-1!==t,(()=>"slice() does not support negative begin indexing."))})),a=null==n?new Array(i).fill(-1):"number"==typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,a=a.map(((e,n)=>e>=0?e:(Gt(-1===e,(()=>`Negative size values should be exactly -1 but got ${e} for the slice() size at index ${n}.`)),t.shape[n]-r[n]))),[r,a]}(r,i,a),c=[];for(let e=0;e<t.rank;e++)c.push([s[e],o[e]-s[e]-u[e]]);return{x:()=>Ro(t,c)}}},{kernelName:Ct,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:i}=n,a=fn(t,r);return{logits:()=>_n(a,fn(An(a,[i],!0),r))}}},{kernelName:kt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(t,Pa(n))}}},Es,Es,ks,ks,{kernelName:It,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,fn(xn(pn(n,"float32")),2))}}},{kernelName:Rt,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=bn(2);return{a:()=>fn(t,fn(i,_n(n,r))),b:()=>fn(t,fn(i,_n(r,n)))}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(t,fn(pn(n,"float32"),2))}}},{kernelName:Bt,gradFunc:t=>({x:()=>Rn(t)})},{kernelName:"Sub",inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=kn(n.shape,r.shape);return{a:()=>{let e=t;const r=En(n.shape,i);return r.length>0&&(e=An(e,r)),In(e,n.shape)},b:()=>{let e=t;const n=En(r.shape,i);return n.length>0&&(e=An(e,n)),In(yn(e),r.shape)}}}},{kernelName:"Sum",inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,i=r.shape.slice(),{axis:a}=n;Xt(a,r.shape).forEach((t=>{i[t]=1}));const o=In(t,i),s=fn(o,Ei(r.shape,"float32"));return{x:()=>s}}},{kernelName:"Tan",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn(t,wn(ja(n)))}}},{kernelName:Ot,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>fn(_n(bn(1),wn(n)),t)}}},{kernelName:Dt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:i}=n;return{x:()=>{let e=Rn(r);if(1===r.rank)for(let n=0;n<i[0];++n)e=Fn(e,Ni(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)e=Fn(e,Ni(t,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)e=Fn(e,Ni(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)for(let s=0;s<i[3];++s)e=Fn(e,Ni(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:Mt,gradFunc:(t,e,n)=>{const r=n,{perm:i}=r,a=Nr(i);return{x:()=>Fr(t,a)}}},{kernelName:Ft,gradFunc:(t,e,n)=>{const r=n,{axis:i}=r;return{value:()=>Jr(t,i)}}},{kernelName:Pt,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=To(e,Rn(e)),r=so(t,n);let i=ar(e,bn(0,"int32"));const a=r.rank-i.rank;for(let t=0;t<a;++t)i=ao(i,t+1);i=sr(i,Ei(r.shape,"bool"));const o=Rn(r);return lr(i,r,o)}(t,n)}}},{kernelName:Lt,gradFunc:t=>({x:()=>Rn(t)})}];for(const t of Is)ye(t);Ge().prototype.abs=function(){return this.throwIfDisposed(),_a(this)},Ge().prototype.acos=function(){return this.throwIfDisposed(),Sa(this)},Ge().prototype.acosh=function(){return this.throwIfDisposed(),Ta(this)},Ge().prototype.add=function(t){return this.throwIfDisposed(),Fn(this,t)},Ge().prototype.all=function(t,e){return this.throwIfDisposed(),Ea(this,t,e)},Ge().prototype.any=function(t,e){return this.throwIfDisposed(),ka(this,t,e)},Ge().prototype.argMax=function(t){return this.throwIfDisposed(),Ia(this,t)},Ge().prototype.argMin=function(t){return this.throwIfDisposed(),Aa(this,t)},Ge().prototype.asScalar=function(){return this.throwIfDisposed(),Gt(1===this.size,(()=>"The array must have only 1 element.")),In(this,[])},Ge().prototype.asType=function(t){return this.throwIfDisposed(),pn(this,t)},Ge().prototype.as1D=function(){return this.throwIfDisposed(),In(this,[this.size])},Ge().prototype.as2D=function(t,e){return this.throwIfDisposed(),In(this,[t,e])},Ge().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),In(this,[t,e,n])},Ge().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),In(this,[t,e,n,r])},Ge().prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),In(this,[t,e,n,r,i])},Ge().prototype.asin=function(){return this.throwIfDisposed(),Na(this)},Ge().prototype.asinh=function(){return this.throwIfDisposed(),Ca(this)},Ge().prototype.atan=function(){return this.throwIfDisposed(),Ra(this)},Ge().prototype.atan2=function(t){return this.throwIfDisposed(),Oa(this,t)},Ge().prototype.atanh=function(){return this.throwIfDisposed(),Da(this)},Ge().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),Ma(this,t,e,n,r)},Ge().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Ba(this,t,e)},Ge().prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),za(this,t,e,n,r,i)},Ge().prototype.broadcastTo=function(t){return this.throwIfDisposed(),cr(this,t)},Ge().prototype.cast=function(t){return this.throwIfDisposed(),pn(this,t)},Ge().prototype.ceil=function(){return this.throwIfDisposed(),Ua(this)},Ge().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Ga(this,t,e)},Ge().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Ue&&(t=[t]),Fa([this,...t],e)},Ge().prototype.conv1d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Wa(this,t,e,n,r,i,a)},Ge().prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),Va(this,t,e,n,r,i)},Ge().prototype.conv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),yr(this,t,e,n,r,i,a)},Ge().prototype.cos=function(){return this.throwIfDisposed(),ja(this)},Ge().prototype.cosh=function(){return this.throwIfDisposed(),Ha(this)},Ge().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Xa(this,t,e,n)},Ge().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Cr(this,t,e,n)},Ge().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),qa(this,t,e)},Ge().prototype.depthwiseConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Ka(this,t,e,n,r,i,a)},Ge().prototype.dilation2d=function(t,e,n,r,i){return this.throwIfDisposed(),Ya(this,t,e,n,r,i)},Ge().prototype.divNoNan=function(t){return this.throwIfDisposed(),Za(this,t)},Ge().prototype.div=function(t){return this.throwIfDisposed(),vn(this,t)},Ge().prototype.dot=function(t){return this.throwIfDisposed(),$a(this,t)},Ge().prototype.elu=function(){return this.throwIfDisposed(),Ja(this)},Ge().prototype.equal=function(t){return this.throwIfDisposed(),mi(this,t)},Ge().prototype.erf=function(){return this.throwIfDisposed(),Qa(this)},Ge().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),io(this,t,e)},Ge().prototype.exp=function(){return this.throwIfDisposed(),Wr(this)},Ge().prototype.expandDims=function(t){return this.throwIfDisposed(),ao(this,t)},Ge().prototype.expm1=function(){return this.throwIfDisposed(),oo(this)},Ge().prototype.fft=function(){return this.throwIfDisposed(),hs(this)},Ge().prototype.flatten=function(){return this.throwIfDisposed(),In(this,[this.size])},Ge().prototype.floor=function(){return this.throwIfDisposed(),Ri(this)},Ge().prototype.floorDiv=function(t){return this.throwIfDisposed(),gn(this,t)},Ge().prototype.gather=function(t,e,n){return this.throwIfDisposed(),so(this,t,e,n)},Ge().prototype.greaterEqual=function(t){return this.throwIfDisposed(),ar(this,t)},Ge().prototype.greater=function(t){return this.throwIfDisposed(),ui(this,t)},Ge().prototype.ifft=function(){return this.throwIfDisposed(),ps(this)},Ge().prototype.irfft=function(){return this.throwIfDisposed(),fs(this)},Ge().prototype.isFinite=function(){return this.throwIfDisposed(),uo(this)},Ge().prototype.isInf=function(){return this.throwIfDisposed(),co(this)},Ge().prototype.isNaN=function(){return this.throwIfDisposed(),lo(this)},Ge().prototype.leakyRelu=function(t){return this.throwIfDisposed(),ho(this,t)},Ge().prototype.lessEqual=function(t){return this.throwIfDisposed(),or(this,t)},Ge().prototype.less=function(t){return this.throwIfDisposed(),yi(this,t)},Ge().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),po(this,t,e,n,r)},Ge().prototype.logSigmoid=function(){return this.throwIfDisposed(),vo(this)},Ge().prototype.logSoftmax=function(t){return this.throwIfDisposed(),yo(this,t)},Ge().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),bo(this,t,e)},Ge().prototype.log=function(){return this.throwIfDisposed(),Ui(this)},Ge().prototype.log1p=function(){return this.throwIfDisposed(),fo(this)},Ge().prototype.logicalAnd=function(t){return this.throwIfDisposed(),sr(this,t)},Ge().prototype.logicalNot=function(){return this.throwIfDisposed(),xo(this)},Ge().prototype.logicalOr=function(t){return this.throwIfDisposed(),wo(this,t)},Ge().prototype.logicalXor=function(t){return this.throwIfDisposed(),_o(this,t)},Ge().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Jn(this,t,e,n)},Ge().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),So(this,t,e,n,r)},Ge().prototype.max=function(t,e){return this.throwIfDisposed(),to(this,t,e)},Ge().prototype.maximum=function(t){return this.throwIfDisposed(),To(this,t)},Ge().prototype.mean=function(t,e){return this.throwIfDisposed(),Eo(this,t,e)},Ge().prototype.min=function(t,e){return this.throwIfDisposed(),eo(this,t,e)},Ge().prototype.minimum=function(t){return this.throwIfDisposed(),ko(this,t)},Ge().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Io(this,t,e)},Ge().prototype.mod=function(t){return this.throwIfDisposed(),Ao(this,t)},Ge().prototype.mul=function(t){return this.throwIfDisposed(),fn(this,t)},Ge().prototype.neg=function(){return this.throwIfDisposed(),yn(this)},Ge().prototype.norm=function(t,e,n){return this.throwIfDisposed(),ro(this,t,e,n)},Ge().prototype.notEqual=function(t){return this.throwIfDisposed(),No(this,t)},Ge().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),ba(this,t,e,n)},Ge().prototype.onesLike=function(){return this.throwIfDisposed(),Co(this)},Ge().prototype.pad=function(t,e){return this.throwIfDisposed(),Ro(this,t,e)},Ge().prototype.pool=function(t,e,n,r,i,a){return this.throwIfDisposed(),Oo(this,t,e,n,r,i,a)},Ge().prototype.pow=function(t){return this.throwIfDisposed(),Gi(this,t)},Ge().prototype.prelu=function(t){return this.throwIfDisposed(),Do(this,t)},Ge().prototype.prod=function(t,e){return this.throwIfDisposed(),Mo(this,t,e)},Ge().prototype.reciprocal=function(){return this.throwIfDisposed(),ns(this)},Ge().prototype.relu=function(){return this.throwIfDisposed(),rs(this)},Ge().prototype.relu6=function(){return this.throwIfDisposed(),is(this)},Ge().prototype.reshapeAs=function(t){return this.throwIfDisposed(),In(this,t.shape)},Ge().prototype.reshape=function(t){return this.throwIfDisposed(),In(this,t)},Ge().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),ws(this,t,e,n)},Ge().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),_s(this,t,e,n)},Ge().prototype.reverse=function(t){return this.throwIfDisposed(),as(this,t)},Ge().prototype.rfft=function(){return this.throwIfDisposed(),ds(this)},Ge().prototype.round=function(){return this.throwIfDisposed(),os(this)},Ge().prototype.rsqrt=function(){return this.throwIfDisposed(),Yr(this)},Ge().prototype.selu=function(){return this.throwIfDisposed(),ss(this)},Ge().prototype.separableConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),us(this,t,e,n,r,i,a)},Ge().prototype.sigmoid=function(){return this.throwIfDisposed(),Pa(this)},Ge().prototype.sign=function(){return this.throwIfDisposed(),cs(this)},Ge().prototype.sin=function(){return this.throwIfDisposed(),Sr(this)},Ge().prototype.sinh=function(){return this.throwIfDisposed(),Er(this)},Ge().prototype.slice=function(t,e){return this.throwIfDisposed(),Ni(this,t,e)},Ge().prototype.softmax=function(t){return this.throwIfDisposed(),ls(this,t)},Ge().prototype.softplus=function(){return this.throwIfDisposed(),go(this)},Ge().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),tr(this,t,e)},Ge().prototype.split=function(t,e){return this.throwIfDisposed(),fr(this,t,e)},Ge().prototype.sqrt=function(){return this.throwIfDisposed(),xn(this)},Ge().prototype.square=function(){return this.throwIfDisposed(),wn(this)},Ge().prototype.squaredDifference=function(t){return this.throwIfDisposed(),ms(this,t)},Ge().prototype.squeeze=function(t){return this.throwIfDisposed(),gs(this,t)},Ge().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Ue?[this,t]:[this,...t];return Jr(n,e)},Ge().prototype.step=function(t){return this.throwIfDisposed(),dn(this,t)},Ge().prototype.stridedSlice=function(t,e,n,r,i,a,o,s){return this.throwIfDisposed(),vs(this,t,e,n,r,i,a,o,s)},Ge().prototype.sub=function(t){return this.throwIfDisposed(),_n(this,t)},Ge().prototype.sum=function(t,e){return this.throwIfDisposed(),An(this,t,e)},Ge().prototype.tan=function(){return this.throwIfDisposed(),ys(this)},Ge().prototype.tanh=function(){return this.throwIfDisposed(),La(this)},Ge().prototype.tile=function(t){return this.throwIfDisposed(),Zr(this,t)},Ge().prototype.toBool=function(){return this.throwIfDisposed(),pn(this,"bool")},Ge().prototype.toFloat=function(){return this.throwIfDisposed(),pn(this,"float32")},Ge().prototype.toInt=function(){return this.throwIfDisposed(),pn(this,"int32")},Ge().prototype.topk=function(t,e){return this.throwIfDisposed(),bs(this,t,e)},Ge().prototype.transpose=function(t){return this.throwIfDisposed(),Fr(this,t)},Ge().prototype.unique=function(t){return this.throwIfDisposed(),xs(this,t)},Ge().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Qr(this,t,e)},Ge().prototype.unstack=function(t){return this.throwIfDisposed(),Li(this,t)},Ge().prototype.where=function(t,e){return this.throwIfDisposed(),lr(t,this,e)},Ge().prototype.zerosLike=function(){return this.throwIfDisposed(),Rn(this)};var As={"tfjs-core":a.version_core,"tfjs-backend-cpu":l.version_cpu,"tfjs-backend-webgl":h.version_webgl,"tfjs-data":c.version_data,"tfjs-layers":s.version_layers,"tfjs-converter":u.version_converter,tfjs:"4.17.0"};n.data=d,n.version=As,Object.keys(a).forEach((function(t){"default"===t||n.hasOwnProperty(t)||Object.defineProperty(n,t,{enumerable:!0,get:function(){return a[t]}})})),Object.keys(s).forEach((function(t){"default"===t||n.hasOwnProperty(t)||Object.defineProperty(n,t,{enumerable:!0,get:function(){return s[t]}})})),Object.keys(u).forEach((function(t){"default"===t||n.hasOwnProperty(t)||Object.defineProperty(n,t,{enumerable:!0,get:function(){return u[t]}})})),Object.keys(l).forEach((function(t){"default"===t||n.hasOwnProperty(t)||Object.defineProperty(n,t,{enumerable:!0,get:function(){return l[t]}})})),Object.keys(h).forEach((function(t){"default"===t||n.hasOwnProperty(t)||Object.defineProperty(n,t,{enumerable:!0,get:function(){return h[t]}})}))}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],t("timers").setImmediate)},{"@tensorflow/tfjs-backend-cpu":4,"@tensorflow/tfjs-backend-webgl":5,"@tensorflow/tfjs-converter":6,"@tensorflow/tfjs-core":7,"@tensorflow/tfjs-data":8,"@tensorflow/tfjs-layers":9,_process:16,buffer:13,crypto:12,long:15,timers:25}],11:[function(t,e,n){"use strict";n.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},n.toByteArray=function(t){for(var e,n=u(t),r=n[0],o=n[1],s=new a(function(t,e,n){return 3*(e+n)/4-n}(0,r,o)),c=0,l=o>0?r-4:r,h=0;h<l;h+=4)e=i[t.charCodeAt(h)]<<18|i[t.charCodeAt(h+1)]<<12|i[t.charCodeAt(h+2)]<<6|i[t.charCodeAt(h+3)],s[c++]=e>>16&255,s[c++]=e>>8&255,s[c++]=255&e;return 2===o&&(e=i[t.charCodeAt(h)]<<2|i[t.charCodeAt(h+1)]>>4,s[c++]=255&e),1===o&&(e=i[t.charCodeAt(h)]<<10|i[t.charCodeAt(h+1)]<<4|i[t.charCodeAt(h+2)]>>2,s[c++]=e>>8&255,s[c++]=255&e),s},n.fromByteArray=function(t){for(var e,n=t.length,i=n%3,a=[],o=16383,s=0,u=n-i;s<u;s+=o)a.push(c(t,s,s+o>u?u:s+o));return 1===i?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var i,a,o=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],12:[function(t,e,n){},{}],13:[function(t,e,n){(function(e){(function(){"use strict";var e=t("base64-js"),r=t("ieee754");n.Buffer=o,n.SlowBuffer=function(t){return+t!=t&&(t=0),o.alloc(+t)},n.INSPECT_MAX_BYTES=50;var i=2147483647;function a(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=o.prototype,e}function o(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return c(t)}return s(t,e,n)}function s(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|p(t,e),r=a(n),i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}(t,e);if(ArrayBuffer.isView(t))return l(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(U(t,ArrayBuffer)||t&&U(t.buffer,ArrayBuffer))return function(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n)).__proto__=o.prototype,r}(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return o.from(r,e,n);var i=function(t){if(o.isBuffer(t)){var e=0|h(t.length),n=a(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||G(t.length)?a(0):l(t):"Buffer"===t.type&&Array.isArray(t.data)?l(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function c(t){return u(t),a(t<0?0:0|h(t))}function l(t){for(var e=t.length<0?0:0|h(t.length),n=a(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function h(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function p(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||U(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(t).length;default:if(i)return r?-1:L(t).length;e=(""+e).toLowerCase(),i=!0}}function f(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return k(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function d(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),G(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,i){var a,o=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var l=-1;for(a=n;a<s;a++)if(c(t,a)===c(e,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var h=!0,p=0;p<u;p++)if(c(t,a+p)!==c(e,p)){h=!1;break}if(h)return a}return-1}function v(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(G(s))return o;t[n+o]=s}return o}function y(t,e,n,r){return z(L(e,t.length-n),t,n,r)}function b(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return b(t,e,n,r)}function w(t,e,n,r){return z(B(e),t,n,r)}function _(t,e,n,r){return z(function(t,e){for(var n,r,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)r=(n=t.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function S(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function T(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a,o,s,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(a=t[i+1]))&&(u=(31&c)<<6|63&a)>127&&(l=u);break;case 3:a=t[i+1],o=t[i+2],128==(192&a)&&128==(192&o)&&(u=(15&c)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:a=t[i+1],o=t[i+2],s=t[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=E)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=E));return n}(r)}n.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(t,e,n){return s(t,e,n)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},o.allocUnsafe=function(t){return c(t)},o.allocUnsafeSlow=function(t){return c(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(U(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),U(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=o.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(U(a,Uint8Array)&&(a=o.from(a)),!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?T(this,0,t):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},o.prototype.compare=function(t,e,n,r,i){if(U(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),u=Math.min(a,s),c=this.slice(r,i),l=t.slice(e,n),h=0;h<u;++h)if(c[h]!==l[h]){a=c[h],s=l[h];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},o.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},o.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return y(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return w(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function k(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function A(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=e;a<n;++a)i+=P(t[a]);return i}function N(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function C(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,n,r,i,a){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function O(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(t,e,n,i,a){return e=+e,n>>>=0,a||O(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function M(t,e,n,i,a){return e=+e,n>>>=0,a||O(t,0,n,8),r.write(t,e,n,i,52,8),n+8}o.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return r.__proto__=o.prototype,r},o.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||C(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},o.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||C(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},o.prototype.readUInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||C(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||C(t,e,this.length);for(var r=e,i=1,a=this[t+--r];r>0&&(i*=256);)a+=this[t+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},o.prototype.readInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||C(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){t>>>=0,e||C(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||R(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},o.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||R(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},o.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<n&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o|0)-s&255;return e+n},o.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o|0)-s&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,n){return D(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return D(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return M(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return M(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,r){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var a=i-1;a>=0;--a)t[a+e]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return i},o.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var s=o.isBuffer(t)?t:o.from(t,r),u=s.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(a=0;a<n-e;++a)this[a+e]=s[a%u]}return this};var F=/[^+/0-9A-Za-z-_]/g;function P(t){return t<16?"0"+t.toString(16):t.toString(16)}function L(t,e){var n;e=e||1/0;for(var r=t.length,i=null,a=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function B(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function U(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function G(t){return t!=t}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":11,buffer:13,ieee754:14}],14:[function(t,e,n){n.read=function(t,e,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,a=f&(1<<-l)-1,f>>=-l,l+=s;l>0;a=256*a+t[e+h],h+=p,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+t[e+h],h+=p,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=c}return(f?-1:1)*o*Math.pow(2,a-r)},n.write=function(t,e,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+h>=1?p/u:p*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(s=0,o=l):o+h>=1?(s=(e*u-1)*Math.pow(2,i),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[n+f]=255&s,f+=d,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;t[n+f]=255&o,f+=d,o/=256,c-=8);t[n+f-d]|=128*m}},{}],15:[function(t,e,n){e.exports=i;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function i(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function a(t){return!0===(t&&t.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=a;var o={},s={};function u(t,e){var n,r,i;return e?(i=0<=(t>>>=0)&&t<256)&&(r=s[t])?r:(n=l(t,(0|t)<0?-1:0,!0),i&&(s[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(r=o[t])?r:(n=l(t,t<0?-1:0,!1),i&&(o[t]=n),n)}function c(t,e){if(isNaN(t))return e?b:y;if(e){if(t<0)return b;if(t>=m)return T}else{if(t<=-g)return E;if(t+1>=g)return S}return t<0?c(-t,e).neg():l(t%d|0,t/d|0,e)}function l(t,e,n){return new i(t,e,n)}i.fromInt=u,i.fromNumber=c,i.fromBits=l;var h=Math.pow;function p(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return y;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return p(t.substring(1),e,n).neg();for(var i=c(h(n,8)),a=y,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),u=parseInt(t.substring(o,o+s),n);if(s<8){var l=c(h(n,s));a=a.mul(l).add(c(u))}else a=(a=a.mul(i)).add(c(u))}return a.unsigned=e,a}function f(t,e){return"number"==typeof t?c(t,e):"string"==typeof t?p(t,e):l(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}i.fromString=p,i.fromValue=f;var d=4294967296,m=d*d,g=m/2,v=u(1<<24),y=u(0);i.ZERO=y;var b=u(0,!0);i.UZERO=b;var x=u(1);i.ONE=x;var w=u(1,!0);i.UONE=w;var _=u(-1);i.NEG_ONE=_;var S=l(-1,2147483647,!1);i.MAX_VALUE=S;var T=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=T;var E=l(0,-2147483648,!1);i.MIN_VALUE=E;var k=i.prototype;k.toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},k.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(E)){var e=c(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=c(h(t,6),this.unsigned),a=this,o="";;){var s=a.div(i),u=(a.sub(s.mul(i)).toInt()>>>0).toString(t);if((a=s).isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},k.isZero=function(){return 0===this.high&&0===this.low},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return!(1&~this.low)},k.isEven=function(){return!(1&this.low)},k.equals=function(t){return a(t)||(t=f(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},k.eq=k.equals,k.notEquals=function(t){return!this.eq(t)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(t){return this.comp(t)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(t){return this.comp(t)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(t){return this.comp(t)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(t){return this.comp(t)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(t){if(a(t)||(t=f(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(x)},k.neg=k.negate,k.add=function(t){a(t)||(t=f(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=t.high>>>16,s=65535&t.high,u=t.low>>>16,c=0,h=0,p=0,d=0;return p+=(d+=i+(65535&t.low))>>>16,h+=(p+=r+u)>>>16,c+=(h+=n+s)>>>16,c+=e+o,l((p&=65535)<<16|(d&=65535),(c&=65535)<<16|(h&=65535),this.unsigned)},k.subtract=function(t){return a(t)||(t=f(t)),this.add(t.neg())},k.sub=k.subtract,k.multiply=function(t){if(this.isZero())return y;if(a(t)||(t=f(t)),r)return l(r.mul(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned);if(t.isZero())return y;if(this.eq(E))return t.isOdd()?E:y;if(t.eq(E))return this.isOdd()?E:y;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(v)&&t.lt(v))return c(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=t.high>>>16,u=65535&t.high,h=t.low>>>16,p=65535&t.low,d=0,m=0,g=0,b=0;return g+=(b+=o*p)>>>16,m+=(g+=i*p)>>>16,g&=65535,m+=(g+=o*h)>>>16,d+=(m+=n*p)>>>16,m&=65535,d+=(m+=i*h)>>>16,m&=65535,d+=(m+=o*u)>>>16,d+=e*p+n*h+i*u+o*s,l((g&=65535)<<16|(b&=65535),(d&=65535)<<16|(m&=65535),this.unsigned)},k.mul=k.multiply,k.divide=function(t){if(a(t)||(t=f(t)),t.isZero())throw Error("division by zero");var e,n,i;if(r)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?l((this.unsigned?r.div_u:r.div_s)(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:y;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return b;if(t.gt(this.shru(1)))return w;i=b}else{if(this.eq(E))return t.eq(x)||t.eq(_)?E:t.eq(E)?x:(e=this.shr(1).div(t).shl(1)).eq(y)?t.isNegative()?x:_:(n=this.sub(t.mul(e)),i=e.add(n.div(t)));if(t.eq(E))return this.unsigned?b:y;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=y}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(e)/Math.LN2),s=o<=48?1:h(2,o-48),u=c(e),p=u.mul(t);p.isNegative()||p.gt(n);)p=(u=c(e-=s,this.unsigned)).mul(t);u.isZero()&&(u=x),i=i.add(u),n=n.sub(p)}return i},k.div=k.divide,k.modulo=function(t){return a(t)||(t=f(t)),r?l((this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return l(~this.low,~this.high,this.unsigned)},k.and=function(t){return a(t)||(t=f(t)),l(this.low&t.low,this.high&t.high,this.unsigned)},k.or=function(t){return a(t)||(t=f(t)),l(this.low|t.low,this.high|t.high,this.unsigned)},k.xor=function(t){return a(t)||(t=f(t)),l(this.low^t.low,this.high^t.high,this.unsigned)},k.shiftLeft=function(t){return a(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):l(0,this.low<<t-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(t){return a(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):l(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(t){if(a(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?l(this.low>>>t|e<<32-t,e>>>t,this.unsigned):l(32===t?e:e>>>t-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},k.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},k.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},i.fromBytes=function(t,e,n){return n?i.fromBytesLE(t,e):i.fromBytesBE(t,e)},i.fromBytesLE=function(t,e){return new i(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},i.fromBytesBE=function(t,e){return new i(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},{}],16:[function(t,e,n){var r,i,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var c,l=[],h=!1,p=-1;function f(){h&&c&&(h=!1,c.length?l=c.concat(l):p=-1,l.length&&d())}function d(){if(!h){var t=u(f);h=!0;for(var e=l.length;e;){for(c=l,l=[];++p<e;)c&&c[p].run();p=-1,e=l.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function g(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new m(t,e)),1!==l.length||h||u(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(t){return[]},a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],17:[function(t,e,n){var r=t("./lib/alea"),i=t("./lib/xor128"),a=t("./lib/xorwow"),o=t("./lib/xorshift7"),s=t("./lib/xor4096"),u=t("./lib/tychei"),c=t("./seedrandom");c.alea=r,c.xor128=i,c.xorwow=a,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},{"./lib/alea":18,"./lib/tychei":19,"./lib/xor128":20,"./lib/xor4096":21,"./lib/xorshift7":22,"./lib/xorwow":23,"./seedrandom":24}],18:[function(t,e,n){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197;return function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var i=new n(t),a=e&&e.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,"object"==typeof e&&e)},{}],19:[function(t,e,n){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,"object"==typeof e&&e)},{}],20:[function(t,e,n){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,"object"==typeof e&&e)},{}],21:[function(t,e,n){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.X&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,"object"==typeof e&&e)},{}],22:[function(t,e,n){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&(a.x&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,"object"==typeof e&&e)},{}],23:[function(t,e,n){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var i=new n(t),a=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=i.next,o.quick=o,a&&("object"==typeof a&&r(a,i),o.state=function(){return r(i,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,"object"==typeof e&&e)},{}],24:[function(t,e,n){!function(n,r,i){var a,o=256,s="random",u=i.pow(o,6),c=i.pow(2,52),l=2*c,h=o-1;function p(t,e,h){var p=[],y=g(m((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(r)]:t??function(){try{var t;return a&&(t=a.randomBytes)?t=t(o):(t=new Uint8Array(o),(n.crypto||n.msCrypto).getRandomValues(t)),v(t)}catch(t){var e=n.navigator,i=e&&e.plugins;return[+new Date,n,i,n.screen,v(r)]}}(),3),p),b=new f(p),x=function(){for(var t=b.g(6),e=u,n=0;t<c;)t=(t+n)*o,e*=o,n=b.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,g(v(b.S),r),(e.pass||h||function(t,e,n,r){return r&&(r.S&&d(r,b),t.state=function(){return d(b,{})}),n?(i[s]=t,e):t})(x,y,"global"in e?e.global:this==i,e.state)}function f(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=h&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*o+s[h&(s[i]=s[a=h&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(o)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(m(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function g(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(g(i.random(),r),"object"==typeof e&&e.exports){e.exports=p;try{a=t("crypto")}catch(t){}}else i["seed"+s]=p}("undefined"!=typeof self?self:this,[],Math)},{crypto:12}],25:[function(t,e,n){(function(e,r){(function(){var i=t("process/browser.js").nextTick,a=Function.prototype.apply,o=Array.prototype.slice,s={},u=0;function c(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new c(a.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new c(a.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n.setImmediate="function"==typeof e?e:function(t){var e=u++,r=!(arguments.length<2)&&o.call(arguments,1);return s[e]=!0,i((function(){s[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))})),e},n.clearImmediate="function"==typeof r?r:function(t){delete s[t]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":16,timers:25}]},{},[3])(3)})),function(){"use strict";var t,e,n="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,i=n||r||Function("return this")(),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=a&&"object"==typeof module&&module&&!module.nodeType&&module,s=i.QRCode;function u(t,e,n){if(this.mode=l.MODE_8BIT_BYTE,this.data=t,this.parsedData=[],e){for(var r=0,i=this.data.length;r<i;r++){var a=[],o=this.data.charCodeAt(r);a[0]=o,this.parsedData.push(a)}this.parsedData=Array.prototype.concat.apply([],this.parsedData)}else this.parsedData=function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}(t);this.parsedData=Array.prototype.concat.apply([],this.parsedData),n||this.parsedData.length==this.data.length||(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function c(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}u.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},c.prototype={addData:function(t,e,n){var r=new u(t,e,n);this.dataList.push(r),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e][0]},getEye:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);var n=this.modules[t][e];if(n[1]){var r="P"+n[1]+"_"+n[2];return"A"==n[2]&&(r="A"+n[1]),{isDark:n[0],type:r}}return null},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[n][r]=[]}this.setupPositionProbePattern(0,0,"TL"),this.setupPositionProbePattern(this.moduleCount-7,0,"BL"),this.setupPositionProbePattern(0,this.moduleCount-7,"TR"),this.setupPositionAdjustPattern("A"),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=c.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e,n){for(var r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(0<=r&&r<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=i&&i<=4?(this.modules[t+r][e+i][0]=!0,this.modules[t+r][e+i][2]=n,this.modules[t+r][e+i][1]=-0==r||-0==i||6==r||6==i?"O":"I"):this.modules[t+r][e+i][0]=!1)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var r=x.getLostPoint(this);(0==n||t>r)&&(t=r,e=n)}return e},createMovieClip:function(t,e,n){var r=t.createEmptyMovieClip(e,n);this.make();for(var i=0;i<this.modules.length;i++)for(var a=1*i,o=0;o<this.modules[i].length;o++){var s=1*o;this.modules[i][o][0]&&(r.beginFill(0,100),r.moveTo(s,a),r.lineTo(s+1,a),r.lineTo(s+1,a+1),r.lineTo(s,a+1),r.endFill())}return r},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6][0]&&(this.modules[t][6][0]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e][0]&&(this.modules[6][e][0]=e%2==0)},setupPositionAdjustPattern:function(t){for(var e=x.getPatternPosition(this.typeNumber),n=0;n<e.length;n++)for(var r=0;r<e.length;r++){var i=e[n],a=e[r];if(null==this.modules[i][a][0])for(var o=-2;o<=2;o++)for(var s=-2;s<=2;s++)-2==o||2==o||-2==s||2==s||0==o&&0==s?(this.modules[i+o][a+s][0]=!0,this.modules[i+o][a+s][2]=t,this.modules[i+o][a+s][1]=-2==o||-2==s||2==o||2==s?"O":"I"):this.modules[i+o][a+s][0]=!1}},setupTypeNumber:function(t){for(var e=x.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var r=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3][0]=r}for(n=0;n<18;n++){r=!t&&1==(e>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)][0]=r}},setupTypeInfo:function(t,e){for(var n=this.errorCorrectLevel<<3|e,r=x.getBCHTypeInfo(n),i=0;i<15;i++){var a=!t&&1==(r>>i&1);i<6?this.modules[i][8][0]=a:i<8?this.modules[i+1][8][0]=a:this.modules[this.moduleCount-15+i][8][0]=a}for(i=0;i<15;i++){a=!t&&1==(r>>i&1);i<8?this.modules[8][this.moduleCount-i-1][0]=a:i<9?this.modules[8][15-i-1+1][0]=a:this.modules[8][15-i-1][0]=a}this.modules[this.moduleCount-8][8][0]=!t},mapData:function(t,e){for(var n=-1,r=this.moduleCount-1,i=7,a=0,o=this.moduleCount-1;o>0;o-=2)for(6==o&&o--;;){for(var s=0;s<2;s++)if(null==this.modules[r][o-s][0]){var u=!1;a<t.length&&(u=1==(t[a]>>>i&1)),x.getMask(e,r,o-s)&&(u=!u),this.modules[r][o-s][0]=u,-1==--i&&(a++,i=7)}if((r+=n)<0||this.moduleCount<=r){r-=n,n=-n;break}}}},c.PAD0=236,c.PAD1=17,c.createData=function(t,e,n){for(var r=T.getRSBlocks(t,e),i=new E,a=0;a<n.length;a++){var o=n[a];i.put(o.mode,4),i.put(o.getLength(),x.getLengthInBits(o.mode,t)),o.write(i)}var s=0;for(a=0;a<r.length;a++)s+=r[a].dataCount;if(i.getLengthInBits()>8*s)throw new Error("code length overflow. ("+i.getLengthInBits()+">"+8*s+")");for(i.getLengthInBits()+4<=8*s&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=8*s||(i.put(c.PAD0,8),i.getLengthInBits()>=8*s));)i.put(c.PAD1,8);return c.createBytes(i,r)},c.createBytes=function(t,e){for(var n=0,r=0,i=0,a=new Array(e.length),o=new Array(e.length),s=0;s<e.length;s++){var u=e[s].dataCount,c=e[s].totalCount-u;r=Math.max(r,u),i=Math.max(i,c),a[s]=new Array(u);for(var l=0;l<a[s].length;l++)a[s][l]=255&t.buffer[l+n];n+=u;var h=x.getErrorCorrectPolynomial(c),p=new S(a[s],h.getLength()-1).mod(h);o[s]=new Array(h.getLength()-1);for(l=0;l<o[s].length;l++){var f=l+p.getLength()-o[s].length;o[s][l]=f>=0?p.get(f):0}}var d=0;for(l=0;l<e.length;l++)d+=e[l].totalCount;var m=new Array(d),g=0;for(l=0;l<r;l++)for(s=0;s<e.length;s++)l<a[s].length&&(m[g++]=a[s][l]);for(l=0;l<i;l++)for(s=0;s<e.length;s++)l<o[s].length&&(m[g++]=o[s][l]);return m};for(var l={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},h={L:1,M:0,Q:3,H:2},p=0,f=1,d=2,m=3,g=4,v=5,y=6,b=7,x={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;x.getBCHDigit(e)-x.getBCHDigit(x.G15)>=0;)e^=x.G15<<x.getBCHDigit(e)-x.getBCHDigit(x.G15);return(t<<10|e)^x.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;x.getBCHDigit(e)-x.getBCHDigit(x.G18)>=0;)e^=x.G18<<x.getBCHDigit(e)-x.getBCHDigit(x.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return x.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case p:return(e+n)%2==0;case f:return e%2==0;case d:return n%3==0;case m:return(e+n)%3==0;case g:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case v:return e*n%2+e*n%3==0;case y:return(e*n%2+e*n%3)%2==0;case b:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new S([1],0),n=0;n<t;n++)e=e.multiply(new S([1,w.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case l.MODE_NUMBER:return 10;case l.MODE_ALPHA_NUM:return 9;case l.MODE_8BIT_BYTE:case l.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case l.MODE_NUMBER:return 12;case l.MODE_ALPHA_NUM:return 11;case l.MODE_8BIT_BYTE:return 16;case l.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case l.MODE_NUMBER:return 14;case l.MODE_ALPHA_NUM:return 13;case l.MODE_8BIT_BYTE:return 16;case l.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r++)for(var i=0;i<e;i++){for(var a=0,o=t.isDark(r,i),s=-1;s<=1;s++)if(!(r+s<0||e<=r+s))for(var u=-1;u<=1;u++)i+u<0||e<=i+u||0==s&&0==u||o==t.isDark(r+s,i+u)&&a++;a>5&&(n+=3+a-5)}for(r=0;r<e-1;r++)for(i=0;i<e-1;i++){var c=0;t.isDark(r,i)&&c++,t.isDark(r+1,i)&&c++,t.isDark(r,i+1)&&c++,t.isDark(r+1,i+1)&&c++,0!=c&&4!=c||(n+=3)}for(r=0;r<e;r++)for(i=0;i<e-6;i++)t.isDark(r,i)&&!t.isDark(r,i+1)&&t.isDark(r,i+2)&&t.isDark(r,i+3)&&t.isDark(r,i+4)&&!t.isDark(r,i+5)&&t.isDark(r,i+6)&&(n+=40);for(i=0;i<e;i++)for(r=0;r<e-6;r++)t.isDark(r,i)&&!t.isDark(r+1,i)&&t.isDark(r+2,i)&&t.isDark(r+3,i)&&t.isDark(r+4,i)&&!t.isDark(r+5,i)&&t.isDark(r+6,i)&&(n+=40);var l=0;for(i=0;i<e;i++)for(r=0;r<e;r++)t.isDark(r,i)&&l++;return n+=10*(Math.abs(100*l/e/e-50)/5)}},w={glog:function(t){if(t<1)throw new Error("glog("+t+")");return w.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return w.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},_=0;_<8;_++)w.EXP_TABLE[_]=1<<_;for(_=8;_<256;_++)w.EXP_TABLE[_]=w.EXP_TABLE[_-4]^w.EXP_TABLE[_-5]^w.EXP_TABLE[_-6]^w.EXP_TABLE[_-8];for(_=0;_<255;_++)w.LOG_TABLE[w.EXP_TABLE[_]]=_;function S(e,n){if(e.length==t)throw new Error(e.length+"/"+n);for(var r=0;r<e.length&&0==e[r];)r++;this.num=new Array(e.length-r+n);for(var i=0;i<e.length-r;i++)this.num[i]=e[i+r]}function T(t,e){this.totalCount=t,this.dataCount=e}function E(){this.buffer=[],this.length=0}S.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var r=0;r<t.getLength();r++)e[n+r]^=w.gexp(w.glog(this.get(n))+w.glog(t.get(r)));return new S(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=w.glog(this.get(0))-w.glog(t.get(0)),n=new Array(this.getLength()),r=0;r<this.getLength();r++)n[r]=this.get(r);for(r=0;r<t.getLength();r++)n[r]^=w.gexp(w.glog(t.get(r))+e);return new S(n,0).mod(t)}},T.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],T.getRSBlocks=function(e,n){var r=T.getRsBlockTable(e,n);if(r==t)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+n);for(var i=r.length/3,a=[],o=0;o<i;o++)for(var s=r[3*o+0],u=r[3*o+1],c=r[3*o+2],l=0;l<s;l++)a.push(new T(u,c));return a},T.getRsBlockTable=function(e,n){switch(n){case h.L:return T.RS_BLOCK_TABLE[4*(e-1)+0];case h.M:return T.RS_BLOCK_TABLE[4*(e-1)+1];case h.Q:return T.RS_BLOCK_TABLE[4*(e-1)+2];case h.H:return T.RS_BLOCK_TABLE[4*(e-1)+3];default:return t}},E.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var k=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function I(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var n=e.toString().match(/android ([0-9]\.[0-9])/i);n&&n[1]&&(t=parseFloat(n[1]))}return t}var A="undefined"==typeof CanvasRenderingContext2D?function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){var e=this._htOption,n=this._el,r=t.getModuleCount(),i=e.width/r,a=e.height/r;i<=1&&(i=1),a<=1&&(a=1);var o=i*r,s=a*r;e.heightWithTitle=s+e.titleHeight,e.realHeight=e.heightWithTitle+2*e.quietZone,e.realWidth=o+2*e.quietZone;var u=[],c="",l=Math.round(i*e.dotScale),h=Math.round(a*e.dotScale);l<4&&(l=4,h=4);var p=e.colorDark,f=e.colorLight;if(e.backgroundImage){e.autoColor?(e.colorDark="rgba(0, 0, 0, .6);filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#99000000', EndColorStr='#99000000');",e.colorLight="rgba(255, 255, 255, .7);filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#B2FFFFFF', EndColorStr='#B2FFFFFF');"):e.colorLight="rgba(0,0,0,0)";var d='<div style="display:inline-block; z-index:-10;position:absolute;"><img src="'+e.backgroundImage+'" width="'+(e.width+2*e.quietZone)+'" height="'+e.realHeight+'" style="opacity:'+e.backgroundImageAlpha+";filter:alpha(opacity="+100*e.backgroundImageAlpha+'); "/></div>';u.push(d)}if(e.quietZone&&(c="display:inline-block; width:"+(e.width+2*e.quietZone)+"px; height:"+(e.width+2*e.quietZone)+"px;background:"+e.quietZoneColor+"; text-align:center;"),u.push('<div style="font-size:0;'+c+'">'),u.push('<table  style="font-size:0;border:0;border-collapse:collapse; margin-top:'+e.quietZone+'px;" border="0" cellspacing="0" cellspadding="0" align="center" valign="middle">'),u.push('<tr height="'+e.titleHeight+'" align="center"><td style="border:0;border-collapse:collapse;margin:0;padding:0" colspan="'+r+'">'),e.title){var m=e.titleColor,g=e.titleFont;u.push('<div style="width:100%;margin-top:'+e.titleTop+"px;color:"+m+";font:"+g+";background:"+e.titleBackgroundColor+'">'+e.title+"</div>")}e.subTitle&&u.push('<div style="width:100%;margin-top:'+(e.subTitleTop-e.titleTop)+"px;color:"+e.subTitleColor+"; font:"+e.subTitleFont+'">'+e.subTitle+"</div>"),u.push("</td></tr>");for(var v=0;v<r;v++){u.push('<tr style="border:0; padding:0; margin:0;" height="7">');for(var y=0;y<r;y++){var b=t.isDark(v,y),x=t.getEye(v,y);if(x){b=x.isDark;var w=x.type,_=e[w]||e[w.substring(0,2)]||p;u.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+a+'px;"><span style="width:'+i+"px;height:"+a+"px;background-color:"+(b?_:f)+';display:inline-block"></span></td>')}else{var S=e.colorDark;6==v?(S=e.timing_H||e.timing||p,u.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+a+"px;background-color:"+(b?S:f)+';"></td>')):6==y?(S=e.timing_V||e.timing||p,u.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+a+"px;background-color:"+(b?S:f)+';"></td>')):u.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+a+'px;"><div style="display:inline-block;width:'+l+"px;height:"+h+"px;background-color:"+(b?S:e.colorLight)+';"></div></td>')}}u.push("</tr>")}if(u.push("</table>"),u.push("</div>"),e.logo){var T=new Image;null!=e.crossOrigin&&(T.crossOrigin=e.crossOrigin),T.src=e.logo;var E=e.width/3.5,k=e.height/3.5;E!=k&&(E=k),e.logoWidth&&(E=e.logoWidth),e.logoHeight&&(k=e.logoHeight);var I="position:relative; z-index:1;display:table-cell;top:-"+(e.height/2+k/2+e.quietZone)+"px;text-align:center; width:"+E+"px; height:"+k+"px;line-height:"+E+"px; vertical-align: middle;";e.logoBackgroundTransparent||(I+="background:"+e.logoBackgroundColor),u.push('<div style="'+I+'"><img  src="'+e.logo+'"  style="max-width: '+E+"px; max-height: "+k+'px;" /> <div style=" display: none; width:1px;margin-left: -1px;"></div></div>')}e.onRenderingStart&&e.onRenderingStart(e),n.innerHTML=u.join("");var A=n.childNodes[0],N=(e.width-A.offsetWidth)/2,C=(e.heightWithTitle-A.offsetHeight)/2;N>0&&C>0&&(A.style.margin=C+"px "+N+"px"),this._htOption.onRenderingEnd&&this._htOption.onRenderingEnd(this._htOption,null)},t.prototype.clear=function(){this._el.innerHTML=""},t}():function(){function t(){if("svg"==this._htOption.drawer){var t=this._oContext.getSerializedSvg(!0);this.dataURL=t,this._el.innerHTML=t}else try{var e=this._elCanvas.toDataURL("image/png");this.dataURL=e}catch(t){console.error(t)}this._htOption.onRenderingEnd&&(this.dataURL||console.error("Can not get base64 data, please check: 1. Published the page and image to the server 2. The image request support CORS 3. Configured `crossOrigin:'anonymous'` option"),this._htOption.onRenderingEnd(this._htOption,this.dataURL))}if(i._android&&i._android<=2.1){var e=1/window.devicePixelRatio,n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,r,i,a,o,s,u,c,l){if("nodeName"in t&&/img/i.test(t.nodeName))for(var h=arguments.length-1;h>=1;h--)arguments[h]=arguments[h]*e;else void 0===c&&(arguments[1]*=e,arguments[2]*=e,arguments[3]*=e,arguments[4]*=e);n.apply(this,arguments)}}function r(t,e){var n=this;if(n._fFail=e,n._fSuccess=t,null===n._bSupportDataURI){var r=document.createElement("img"),i=function(){n._bSupportDataURI=!1,n._fFail&&n._fFail.call(n)};r.onabort=i,r.onerror=i,r.onload=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)},r.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="}else!0===n._bSupportDataURI&&n._fSuccess?n._fSuccess.call(n):!1===n._bSupportDataURI&&n._fFail&&n._fFail.call(n)}var a=function(t,e){this._bIsPainted=!1,this._android=I(),this._el=t,this._htOption=e,"svg"==this._htOption.drawer?(this._oContext={},this._elCanvas={}):(this._elCanvas=document.createElement("canvas"),this._el.appendChild(this._elCanvas),this._oContext=this._elCanvas.getContext("2d")),this._bSupportDataURI=null,this.dataURL=null};return a.prototype.draw=function(t){var e=this._htOption,n=t.getModuleCount(),r=e.width/n,i=e.height/n;r<=1&&(r=1),i<=1&&(i=1);var a=r*n,o=i*n;e.heightWithTitle=o+e.titleHeight,e.realHeight=e.heightWithTitle+2*e.quietZone,e.realWidth=a+2*e.quietZone,this._elCanvas.width=e.realWidth,this._elCanvas.height=e.realHeight,"canvas"!=e.drawer&&(this._oContext=new C2S(this._elCanvas.width,this._elCanvas.height)),this.clear();var s=this._oContext;s.lineWidth=0,s.fillStyle=e.colorLight,s.fillRect(0,0,this._elCanvas.width,this._elCanvas.height),s.clearRect(e.quietZone,e.quietZone,e.width,e.titleHeight);var u=this;function c(){e.quietZone>0&&e.quietZoneColor&&(s.lineWidth=0,s.fillStyle=e.quietZoneColor,s.fillRect(0,0,u._elCanvas.width,e.quietZone),s.fillRect(0,e.quietZone,e.quietZone,u._elCanvas.height-2*e.quietZone),s.fillRect(u._elCanvas.width-e.quietZone,e.quietZone,e.quietZone,u._elCanvas.height-2*e.quietZone),s.fillRect(0,u._elCanvas.height-e.quietZone,u._elCanvas.width,e.quietZone))}if(e.backgroundImage){var l=new Image;l.onload=function(){s.globalAlpha=1,s.globalAlpha=e.backgroundImageAlpha;var n=s.imageSmoothingQuality,r=s.imageSmoothingEnabled;s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",(e.title||e.subTitle)&&e.titleHeight?s.drawImage(l,e.quietZone,e.quietZone+e.titleHeight,e.width,e.height):s.drawImage(l,0,0,e.realWidth,e.realHeight),s.imageSmoothingEnabled=r,s.imageSmoothingQuality=n,s.globalAlpha=1,h.call(u,t)},null!=e.crossOrigin&&(l.crossOrigin=e.crossOrigin),l.originalSrc=e.backgroundImage,l.src=e.backgroundImage}else h.call(u,t);function h(t){e.onRenderingStart&&e.onRenderingStart(e);for(var a=0;a<n;a++)for(var o=0;o<n;o++){var u,l,h=o*r+e.quietZone,p=a*i+e.quietZone,f=t.isDark(a,o),d=t.getEye(a,o),m=e.dotScale;s.lineWidth=0,d?(u=e[d.type]||e[d.type.substring(0,2)]||e.colorDark,l=e.colorLight):e.backgroundImage?(l="rgba(0,0,0,0)",6==a?e.autoColor?(u=e.timing_H||e.timing||e.autoColorDark,l=e.autoColorLight):u=e.timing_H||e.timing||e.colorDark:6==o?e.autoColor?(u=e.timing_V||e.timing||e.autoColorDark,l=e.autoColorLight):u=e.timing_V||e.timing||e.colorDark:e.autoColor?(u=e.autoColorDark,l=e.autoColorLight):u=e.colorDark):(u=6==a?e.timing_H||e.timing||e.colorDark:6==o&&(e.timing_V||e.timing)||e.colorDark,l=e.colorLight),s.strokeStyle=f?u:l,s.fillStyle=f?u:l,d?(m="AO"==d.type?e.dotScaleAO:"AI"==d.type?e.dotScaleAI:1,e.backgroundImage&&e.autoColor?(u=("AO"==d.type?e.AI:e.AO)||e.autoColorDark,l=e.autoColorLight):u=("AO"==d.type?e.AI:e.AO)||u,f=d.isDark,s.fillRect(Math.ceil(h+r*(1-m)/2),Math.ceil(e.titleHeight+p+i*(1-m)/2),Math.ceil(r*m),Math.ceil(i*m))):6==a?(m=e.dotScaleTiming_H,s.fillRect(Math.ceil(h+r*(1-m)/2),Math.ceil(e.titleHeight+p+i*(1-m)/2),Math.ceil(r*m),Math.ceil(i*m))):6==o?(m=e.dotScaleTiming_V,s.fillRect(Math.ceil(h+r*(1-m)/2),Math.ceil(e.titleHeight+p+i*(1-m)/2),Math.ceil(r*m),Math.ceil(i*m))):(e.backgroundImage,s.fillRect(Math.ceil(h+r*(1-m)/2),Math.ceil(e.titleHeight+p+i*(1-m)/2),Math.ceil(r*m),Math.ceil(i*m))),1==e.dotScale||d||(s.strokeStyle=e.colorLight)}if(e.title&&(s.fillStyle=e.titleBackgroundColor,s.fillRect(e.quietZone,e.quietZone,e.width,e.titleHeight),s.font=e.titleFont,s.fillStyle=e.titleColor,s.textAlign="center",s.fillText(e.title,this._elCanvas.width/2,+e.quietZone+e.titleTop)),e.subTitle&&(s.font=e.subTitleFont,s.fillStyle=e.subTitleColor,s.fillText(e.subTitle,this._elCanvas.width/2,+e.quietZone+e.subTitleTop)),e.logo){var g=new Image,v=this;g.onload=function(){!function(t){var n,r,i=Math.round(e.width/3.5),a=Math.round(e.height/3.5);i!==a&&(i=a),e.logoMaxWidth?i=Math.round(e.logoMaxWidth):e.logoWidth&&(i=Math.round(e.logoWidth)),e.logoMaxHeight?a=Math.round(e.logoMaxHeight):e.logoHeight&&(a=Math.round(e.logoHeight)),void 0===t.naturalWidth?(n=t.width,r=t.height):(n=t.naturalWidth,r=t.naturalHeight),(e.logoMaxWidth||e.logoMaxHeight)&&(e.logoMaxWidth&&n<=i&&(i=n),e.logoMaxHeight&&r<=a&&(a=r),n<=i&&r<=a&&(i=n,a=r));var o=(e.realWidth-i)/2,u=(e.realHeight-a)/2,l=Math.min(i/n,a/r),h=n*l,p=r*l;(e.logoMaxWidth||e.logoMaxHeight)&&(i=h,a=p,o=(e.realWidth-i)/2,u=(e.realHeight-a)/2),e.logoBackgroundTransparent||(s.fillStyle=e.logoBackgroundColor,s.fillRect(o,u,i,a));var f=s.imageSmoothingQuality,d=s.imageSmoothingEnabled;s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",s.drawImage(t,o+(i-h)/2,u+(a-p)/2,h,p),s.imageSmoothingEnabled=d,s.imageSmoothingQuality=f,c(),v._bIsPainted=!0,v.makeImage()}(g)},g.onerror=function(t){console.error(t)},null!=e.crossOrigin&&(g.crossOrigin=e.crossOrigin),g.originalSrc=e.logo,g.src=e.logo}else c(),this._bIsPainted=!0,this.makeImage()}},a.prototype.makeImage=function(){this._bIsPainted&&r.call(this,t)},a.prototype.isPainted=function(){return this._bIsPainted},a.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},a.prototype.remove=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1,this._el.innerHTML=""},a.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},a}();function N(t,e){for(var n=e.correctLevel,r=1,i=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length}(t),a=0,o=k.length;a<o;a++){var s=0;switch(n){case h.L:s=k[a][0];break;case h.M:s=k[a][1];break;case h.Q:s=k[a][2];break;case h.H:s=k[a][3]}if(i<=s)break;r++}if(r>k.length)throw new Error("Too long data. the CorrectLevel."+["M","L","H","Q"][n]+" limit length is "+s);return 0!=e.version&&(r<=e.version?(r=e.version,e.runVersion=r):(console.warn("QR Code version "+e.version+" too small, run version use "+r),e.runVersion=r)),r}e=function(e,n){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:h.H,dotScale:1,dotScaleTiming:1,dotScaleTiming_H:t,dotScaleTiming_V:t,dotScaleA:1,dotScaleAO:t,dotScaleAI:t,quietZone:0,quietZoneColor:"rgba(0,0,0,0)",title:"",titleFont:"normal normal bold 16px Arial",titleColor:"#000000",titleBackgroundColor:"#ffffff",titleHeight:0,titleTop:30,subTitle:"",subTitleFont:"normal normal normal 14px Arial",subTitleColor:"#4F4F4F",subTitleTop:60,logo:t,logoWidth:t,logoHeight:t,logoMaxWidth:t,logoMaxHeight:t,logoBackgroundColor:"#ffffff",logoBackgroundTransparent:!1,PO:t,PI:t,PO_TL:t,PI_TL:t,PO_TR:t,PI_TR:t,PO_BL:t,PI_BL:t,AO:t,AI:t,timing:t,timing_H:t,timing_V:t,backgroundImage:t,backgroundImageAlpha:1,autoColor:!1,autoColorDark:"rgba(0, 0, 0, .6)",autoColorLight:"rgba(255, 255, 255, .7)",onRenderingStart:t,onRenderingEnd:t,version:0,tooltip:!1,binary:!1,drawer:"canvas",crossOrigin:null,utf8WithoutBOM:!0},"string"==typeof n&&(n={text:n}),n)for(var r in n)this._htOption[r]=n[r];this._htOption.title||this._htOption.subTitle||(this._htOption.titleHeight=0),(this._htOption.version<0||this._htOption.version>40)&&(console.warn("QR Code version '"+this._htOption.version+"' is invalidate, reset to 0"),this._htOption.version=0),(this._htOption.dotScale<0||this._htOption.dotScale>1)&&(console.warn(this._htOption.dotScale+" , is invalidate, dotScale must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScale=1),(this._htOption.dotScaleTiming<0||this._htOption.dotScaleTiming>1)&&(console.warn(this._htOption.dotScaleTiming+" , is invalidate, dotScaleTiming must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleTiming=1),this._htOption.dotScaleTiming_H?(this._htOption.dotScaleTiming_H<0||this._htOption.dotScaleTiming_H>1)&&(console.warn(this._htOption.dotScaleTiming_H+" , is invalidate, dotScaleTiming_H must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleTiming_H=1):this._htOption.dotScaleTiming_H=this._htOption.dotScaleTiming,this._htOption.dotScaleTiming_V?(this._htOption.dotScaleTiming_V<0||this._htOption.dotScaleTiming_V>1)&&(console.warn(this._htOption.dotScaleTiming_V+" , is invalidate, dotScaleTiming_V must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleTiming_V=1):this._htOption.dotScaleTiming_V=this._htOption.dotScaleTiming,(this._htOption.dotScaleA<0||this._htOption.dotScaleA>1)&&(console.warn(this._htOption.dotScaleA+" , is invalidate, dotScaleA must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleA=1),this._htOption.dotScaleAO?(this._htOption.dotScaleAO<0||this._htOption.dotScaleAO>1)&&(console.warn(this._htOption.dotScaleAO+" , is invalidate, dotScaleAO must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleAO=1):this._htOption.dotScaleAO=this._htOption.dotScaleA,this._htOption.dotScaleAI?(this._htOption.dotScaleAI<0||this._htOption.dotScaleAI>1)&&(console.warn(this._htOption.dotScaleAI+" , is invalidate, dotScaleAI must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleAI=1):this._htOption.dotScaleAI=this._htOption.dotScaleA,(this._htOption.backgroundImageAlpha<0||this._htOption.backgroundImageAlpha>1)&&(console.warn(this._htOption.backgroundImageAlpha+" , is invalidate, backgroundImageAlpha must between 0 and 1, now reset to 1. "),this._htOption.backgroundImageAlpha=1),this._htOption.quietZone||(this._htOption.quietZone=0),this._htOption.titleHeight||(this._htOption.titleHeight=0),this._htOption.width=Math.round(this._htOption.width),this._htOption.height=Math.round(this._htOption.height),this._htOption.quietZone=Math.round(this._htOption.quietZone),this._htOption.titleHeight=Math.round(this._htOption.titleHeight),"string"==typeof e&&(e=document.getElementById(e)),(!this._htOption.drawer||"svg"!=this._htOption.drawer&&"canvas"!=this._htOption.drawer)&&(this._htOption.drawer="canvas"),this._android=I(),this._el=e,this._oQRCode=null,this._htOption._element=e;var i={};for(var r in this._htOption)i[r]=this._htOption[r];this._oDrawing=new A(this._el,i),this._htOption.text&&this.makeCode(this._htOption.text)},e.prototype.makeCode=function(t){this._oQRCode=new c(N(t,this._htOption),this._htOption.correctLevel),this._oQRCode.addData(t,this._htOption.binary,this._htOption.utf8WithoutBOM),this._oQRCode.make(),this._htOption.tooltip&&(this._el.title=t),this._oDrawing.draw(this._oQRCode)},e.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},e.prototype.clear=function(){this._oDrawing.remove()},e.prototype.resize=function(t,e){this._oDrawing._htOption.width=t,this._oDrawing._htOption.height=e,this._oDrawing.draw(this._oQRCode)},e.prototype.download=function(t){var e=this._oDrawing.dataURL,n=document.createElement("a");if("svg"==this._htOption.drawer){t+=".svg";var r=new Blob([e],{type:"text/plain"});if(navigator.msSaveBlob)navigator.msSaveBlob(r,t);else{n.download=t;var i=new FileReader;i.onload=function(){n.href=i.result,n.click()},i.readAsDataURL(r)}}else if(t+=".png",navigator.msSaveBlob){function o(t){var e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),i=new Uint8Array(r);for(_=0;_<e.length;_++)i[_]=e.charCodeAt(_);return new Blob([r],{type:n})}var a=o(e);navigator.msSaveBlob(a,t)}else n.download=t,n.href=e,n.click()},e.prototype.noConflict=function(){return i.QRCode===this&&(i.QRCode=s),e},e.CorrectLevel=h,"function"==typeof define&&(define.amd||define.cmd)?define([],(function(){return e})):o?((o.exports=e).QRCode=e,a.QRCode=e):i.QRCode=e}.call(this);
var _={version:"1.2.2",countdown:!1,novault:!1,noceriad:!1,norichpresence:!1,noreplaydispute:!1,supporter_specialthanks_goal:200,xp_multiplier:1,catalog:{supporter:{price:5,price_bulk:4,price_gift:4,price_gift_bulk:4,bulk_after:3,normal_price:5,normal_price_bulk:4,normal_price_gift:4,normal_price_gift_bulk:4,normal_bulk_after:3}},league_mm_roundtime_min:15,league_mm_roundtime_max:30,league_additional_settings:{},league_season:{current:"2",prev:"1",next:null,next_at:null,ranked:!0},zenith_duoisfree:!1,zenith_additional_settings:{TEMP_zenith_grace:"[0, 3.8, 3.0, 2.3, 1.7, 1.2, 0.8, 0.5, 0.5, 0.5, 0.2]"},domain:"tetr.io",domain_hash:"1959335040e9c59951888df167dd7904dfe201e6",ch_domain:"ch.tetr.io",mode:"production",commit:{id:"b0c6164c",time:1724710271e3},branch:"master",serverCycle:"46746cdc757c",build:{id:"cea6789b297a",time:1724710293028},sentry_enabled:!0},c={boardappear:[0,1598.9795918367347],zenith_levelup_b:[3e3,2071.428571428571],combo_2_power:[7e3,1000.045351473922],mission:[1e4,5999.773242630386],mmstart:[17e3,2500.3628117913836],combo_4_power:[21e3,1000.1133786848086],s:[24e3,1e3],clearquad:[26e3,2001.1791383219943],combo_7:[3e4,999.977324263039],speed_tick_whirl:[32e3,971.859410430838],speed_up_2:[34e3,3218.7528344671177],allclear:[39e3,2800.2721088435364],failure:[43e3,3099.795918367349],hold:[48e3,399.79591836734585],social_close_minor:[5e4,193.99092970521536],social_online:[52e3,958.2766439909278],b2bcharge_distance_1:[54e3,931.224489795916],combo_16:[56e3,1e3],t:[58e3,1e3],clutch:[6e4,340.9070294784584],level10:[62e3,5e3],detonate2:[68e3,199.31972789115093],thunder6:[7e4,5e3],staffspam:[76e3,168.82086167800026],rsg:[78e3,899.7505668934309],protected_medium:[8e4,394.671201814063],mission_free:[82e3,3400.0000000000055],speed_tick_3:[87e3,49.274376417230314],combo_9:[89e3,1e3],card_tone_volatile:[91e3,845.7823129251665],damage_alert:[93e3,1500],zenith_start:[96e3,2696.4172335600833],combo_12_power:[1e5,1e3],damage_large:[102e3,1200.0000000000027],i:[105e3,1e3],pause_start:[107e3,998.8662131519277],ratingraise:[109e3,2200.0000000000027],boardlock_clear:[113e3,1987.7777777777794],impact:[116e3,1200.0000000000027],boardlock:[119e3,1997.3242630385498],combo_3:[122e3,1e3],pause_continue:[124e3,993.061224489793],garbagewindup_4:[126e3,1820.72562358276],card_tone_expert:[129e3,1008.8208616780037],protected_large:[132e3,913.3333333333269],combo_6_power:[134e3,1e3],garbagewindup_1:[136e3,1280.2267573696042],ranklower:[139e3,3300.0000000000114],b2bcharge_blast_3:[144e3,2559.206349206363],ribbon_on:[148e3,714.8299319727869],combo_14:[15e4,1e3],b2bcharge_1:[152e3,898.1405895691523],spinend:[154e3,799.56916099772],rsg_go:[156e3,2900.090702947836],offset:[16e4,400.0000000000057],card_tone_doublehole:[162e3,845.7823129251665],social_notify_major:[164e3,535.0566893424116],maintenance:[166e3,1099.591836734703],harddrop:[169e3,399.6825396825443],zenith_levelup_ahalfsharp:[171e3,2071.4285714285834],level100:[175e3,5e3],spin:[181e3,2000.0907029478583],combo_13_power:[185e3,1e3],gameover:[187e3,3500],userleave:[192e3,299.5918367346917],combo_15_power:[194e3,1e3],menuback:[196e3,599.9319727891077],protected_small:[198e3,725.351473922899],menuclick:[2e5,1099.977324263051],counter:[203e3,1e3],garbagewindup_2:[205e3,1456.9387755101957],zenith_split_cleared:[208e3,2691.9727891156526],se_vol_blip:[212e3,543.4920634920672],achievement_1:[214e3,3644.013605442183],zenith_levelup_a:[219e3,2071.4285714285834],combo_9_power:[223e3,1e3],speed_tick_2:[225e3,50.022675736954625],social_notify_minor:[227e3,308.6167800453552],undo:[229e3,1847.1201814058986],notify:[232e3,200.4081632653083],losestock:[234e3,1500.0226757369717],victory:[237e3,7499.7505668934255],clearline:[246e3,1100.0453514739092],warning:[249e3,1200.1587301587335],menuconfirm:[252e3,2699.9999999999886],combo_13:[256e3,1e3],zenith_speedrun_start:[258e3,1981.4739229024667],combo_10_power:[261e3,1e3],combo_1_power:[263e3,997.9365079365152],piece_change:[265e3,2020.5442176870747],combo_2:[269e3,1e3],card_tone_invisible:[271e3,764.2630385487337],shatter:[273e3,3e3],card_tone_duo:[277e3,927.3015873015993],detonate1:[279e3,100.45351473922892],userjoin:[281e3,699.591836734669],speed_tick_1:[283e3,40.544217687056516],achievement_2:[285e3,3127.188208616758],zenith_levelup_c:[29e4,2071.428571428555],supporter:[294e3,4090.2947845805215],b2bcharge_distance_2:[3e5,864.5578231292461],combo_10:[302e3,1e3],l:[304e3,1e3],hyperalert:[306e3,1699.6598639455556],garbagerise:[309e3,1199.1383219954628],card_tone_gravity:[312e3,845.7823129251665],cutin_superlobby:[314e3,7036.031746031767],countdown4:[323e3,1e3],combo_5_power:[325e3,999.88662131517],combo_11_power:[327e3,1e3],combo_8_power:[329e3,1e3],finessefault:[331e3,699.9999999999886],btb_break:[333e3,1e3],rotate:[335e3,199.68253968255567],social_invite:[337e3,2110.4081632653333],queue_change:[341e3,294.0589569161034],garbage_out_large:[343e3,1e3],boardlock_clink:[345e3,988.7755102041069],combobreak:[347e3,900.3628117914104],boardlock_revive:[349e3,3705.1700680272006],card_slide_1:[354e3,272.3129251700698],j:[356e3,1e3],garbage_in_large:[358e3,1199.9999999999886],combo_6:[361e3,1e3],social_close:[363e3,387.95918367344484],combo_14_power:[365e3,1e3],mission_versus:[367e3,4899.999999999977],b2bcharge_blast_1:[373e3,1744.058956916092],zenith_speedrun_end:[376e3,1992.8117913832466],finish:[379e3,2697.278911564638],garbagewindup_3:[383e3,1636.1678004535065],speed_down:[386e3,2852.67573696143],social_offline:[39e4,1000.3854875283196],menuhit2:[393e3,1200.4081632653083],no:[396e3,188.1859410430593],zenith_levelup_fsharp:[398e3,2071.428571428555],combo_5:[402e3,1e3],btb_3:[404e3,1e3],purchase_start:[406e3,819.3877551020137],zenith_levelup_e:[408e3,2071.428571428555],detonated:[412e3,2701.020408163288],target:[416e3,299.97732426301127],pause_retry:[418e3,994.3083900226952],worldrecord:[42e4,3701.4965986394373],countdown1:[425e3,1e3],elim:[427e3,500],menuhover:[429e3,200.1814058957052],timer2:[431e3,399.2970521541679],move:[433e3,199.8639455782154],b2bcharge_blast_2:[435e3,1724.5351473923165],card_slide_2:[438e3,290.1814058956802],ribbon_tap:[44e4,758.6621315192588],countdown5:[442e3,1e3],b2bcharge_4:[444e3,1354.3310657596521],damage_medium:[447e3,1e3],thunder1:[449e3,3300.0000000000114],social_open_minor:[454e3,218.23129251703222],matchintro:[456e3,16500],btb_1:[474e3,1e3],level1:[476e3,5e3],pause_exit:[482e3,1155.1247165533027],combo_3_power:[485e3,1e3],o:[487e3,1e3],levelup:[489e3,1400.6349206349],ribbon_off:[492e3,587.5736961451139],redo:[494e3,1926.2358276644136],b2bcharge_3:[497e3,743.8095238095457],clearbtb:[499e3,1799.727891156465],map_change:[502e3,2116.5532879818443],wound_repel:[506e3,963.8775510204027],timer1:[508e3,498.73015873015447],thunder3:[51e4,3e3],card_slide_4:[514e3,290.18140589573704],speed_tick_4:[516e3,49.8866213151814],card_tone_messy:[518e3,845.7823129251665],combo_7_power:[52e4,1e3],countdown3:[522e3,1e3],social_open:[524e3,436.46258503406443],bombdetonate:[526e3,7051.06575963714],combo_1:[535e3,992.7891156462465],softdrop:[537e3,99.90929705213603],menutap:[539e3,99.65986394558968],personalbest:[541e3,3498.8662131519277],level500:[546e3,5e3],hit:[552e3,300.13605442172775],speed_up_4:[554e3,8147.324263038513],combo_12:[564e3,1e3],rankraise:[566e3,9200.022675736931],wound:[577e3,759.365079365125],garbagesmash:[579e3,2100.4081632653424],card_slide_3:[583e3,290.18140589573704],b2bcharge_distance_3:[585e3,1228.2086167800799],showscore:[588e3,4599.9546485260225],party_ready:[594e3,1604.5578231291984],achievement_3:[597e3,3364.3764172335295],b2bcharge_danger:[602e3,1958.7301587301909],clearspin:[605e3,2599.569160997703],card_select:[609e3,1843.7414965986818],b2bcharge_start:[612e3,1988.7528344671637],boardlock_fail:[615e3,997.5736961450821],garbage_in_medium:[617e3,1200.0000000000455],exchange:[62e4,700.4081632652515],scoreslide_in:[622e3,499.9092970521133],mission_league:[624e3,11199.818594104272],garbage_in_small:[637e3,700.0000000000455],garbage_out_small:[639e3,1000.0680272108866],applause:[642e3,7401.020408163276],social_dm:[651e3,183.9455782312598],thunder5:[653e3,5e3],combo_4:[659e3,1e3],topout:[661e3,4600.136054421796],speed_up_1:[667e3,2933.0385487528474],sidehit:[671e3,297.8004535146965],menuhit3:[673e3,1199.501133786839],damage_small:[676e3,799.9999999999545],speed_up_3:[678e3,3178.571428571445],staffsilence:[683e3,272.1541950113533],ratinglower:[685e3,2700.0000000000455],btb_2:[689e3,1e3],staffwarning:[691e3,469.5464852608211],scoreslide_out:[693e3,899.863945578204],b2bcharge_blast_4:[695e3,3689.7959183673947],ribbon:[7e5,241.24716553285452],card_tone_allspin:[702e3,845.7823129251665],combo_8:[704e3,1000.0226757370001],card_tone_nohold:[707e3,764.2630385487337],fire:[709e3,9906.757369614525],floor:[72e4,501.0884353741858],garbage_out_medium:[722e3,1e3],combo_11:[724e3,1e3],thunder2:[726e3,4600.000000000023],thunder4:[732e3,3e3],countdown2:[736e3,1e3],z:[738e3,1e3],combo_16_power:[74e4,2e3],zenith_split_missed:[743e3,2691.9727891156526],menuhit1:[747e3,1200.068027210932],death:[75e4,600.0000000000227],warp:[752e3,10531.29251700682],combo_15:[764e3,1e3],go:[766e3,2900.226757369637],b2bcharge_2:[77e4,977.1882086167807]};
let l=!0,p=!0;window.XDBG_LOG=[],window.XDBG_PUSHLOG=e=>{window.XDBG_LOG.push([Date.now(),`${(new Date).toISOString()} ${e}`]),window.XDBG_LOG=window.XDBG_LOG.filter((e=>e[0]>=Date.now()-6e4))},window.XDBG_COMMITLOG=()=>{if(document.body.classList.contains("sigliatrip_idiot"))return;const e=window.XDBG_LOG.filter((e=>e[0]>=Date.now()-6e4));e.unshift([0,`Document is ${document.visibilityState}`]),e.unshift([0,document.getElementById("devbuildid").textContent.replace(/\t/g,"").replace(/\n/g," | ")]),window.XDBG_LOG=[],fetch("https://kagari.network/write.php",{method:"POST",mode:"cors",cache:"no-cache",body:e.map((e=>e[1])).join("\n")})},window.XDBG_COMMIT_TIMEOUT=null,window.XDBG_CONSIDER_COMMITLOG=()=>{window.XDBG_COMMIT_TIMEOUT||(window.XDBG_COMMIT_TIMEOUT=setTimeout((()=>{window.XDBG_COMMITLOG(),window.XDBG_COMMIT_TIMEOUT=null}),5e3))},window.addEventListener("error",(e=>{e.lineno>10||e.filename&&(e.filename.includes("extension")||e.filename.includes("tetrio-plus"))||(window.XDBG_PUSHLOG(`${e.message} at ${e.filename}:${e.lineno},${e.colno}\n\t${e?.stack??"(no stack trace)"}`),window.XDBG_CONSIDER_COMMITLOG())}));const d={};d.ParticleManager=class extends a.Container{constructor(){super(),this.containers=new Map,this.graveyards=new Map,this.spawners=new Set,a.Ticker.shared.add(this.progress,this),this._rsz=()=>{this._handleResize()},window.addEventListener("resize",this._rsz,!1)}destroy(){a.Ticker.shared.remove(this),window.removeEventListener("resize",this._rsz,!1),super.destroy()}_handleResize(){for(const[,e]of this.containers)e._destroyed||(e.contextWidth=void 0,e.contextHeight=void 0)}progress(e){e<=1.03&&e>=.97&&(e=1),this.progressParticles(e),this.progressSpawners(e)}progressParticles(e){for(const[,t]of this.containers)if(!t._destroyed)for(const n of t.children)n.progress(e)}progressSpawners(e){for(const t of this.spawners)t.progress(e)&&this.spawners.delete(t)}getOrCreateContainer(e,t){let n=this.containers.get(e);return n||(n=new d.ParticleContainer(2048,{vertices:t.needsVertices,position:!0,rotation:t.needsRotation,uvs:!1,tint:!0},16384,!1),n.blendMode=t.blendmode,n.interactive=!1,this.addChild(n),this.containers.set(e,n),this.graveyards.set(e,[]),n)}getZombie(e){const t=this.graveyards.get(e);return t?t.shift():null}spawnInternal(e){const t=`${e.texture}:${e.blendmode}:${e.needsVertices}:${e.needsRotation}`;e.containerName=t;const n=this.getOrCreateContainer(t,e),s=this.getZombie(t),i=s||new d.Particle(e,this);s&&s.init(e),e.addinback?n.addChildAt(i,0):n.addChild(i)}graveyard(e,t){const n=this.graveyards.get(e.options.containerName);for(n.push(e);n.length>t;)n.pop().destroy()}spawnOne(e){this.spawnInternal(d.ParseSimpleParticleOptions(e))}spawnBurst(e,t){let n=t.amount;if(n<1&&(n=Math.random()<=n?1:0),n){if("disc"===t.shape&&(t.shape="disk"),void 0!==t.radius){const e=2*t.radius;t.width=e,t.height=e}void 0===t.thickness&&(t.thickness=0);for(let s=0;s<n;s++){let n=t.x,s=t.y;if("rectangle"===t.shape)n+=(Math.random()-.5)*t.width,s+=(Math.random()-.5)*t.height;else if("box"===t.shape){const e=Math.random()<.5,i=!e;n+=(e?Math.random()-.5<0?-.5:.5:Math.random()-.5)*t.width+(Math.random()-.5)*t.thickness,s+=(i?Math.random()-.5<0?-.5:.5:Math.random()-.5)*t.height+(Math.random()-.5)*t.thickness}else if("line"===t.shape){const e=Math.random();n+=e*(t.linePointB[0]-t.linePointA[0])+t.linePointA[0]+(Math.random()-.5)*t.thickness,s+=e*(t.linePointB[1]-t.linePointA[1])+t.linePointA[1]+(Math.random()-.5)*t.thickness}else if("disk"===t.shape){const e=a.PI_2*Math.random();n+=Math.random()*(t.width/2)*Math.sin(e),s+=Math.random()*(t.height/2)*Math.cos(e)}else if("circle"===t.shape){const e=a.PI_2*Math.random();n+=(t.width/2+(Math.random()-.5)*t.thickness)*Math.sin(e),s+=(t.height/2+(Math.random()-.5)*t.thickness)*Math.cos(e)}e.x=n,e.y=s,void 0!==t.directionOverride&&(e.direction=Math.atan2(s-t.y,n-t.x)*a.RAD_TO_DEG+t.directionOverride+90),void 0!==t.angleOverride&&(e.angle=Math.atan2(s-t.y,n-t.x)*a.RAD_TO_DEG+t.angleOverride+90),this.spawnOne(e)}}}createSpawner(e,t){const n=new d.Spawner(this,e,t);return this.spawners.add(n),n}},d.ParticleContainer=class extends a.Container{render(e){this.contextWidth||(this.contextWidth=e.width,this.contextHeight=e.height),super.render(e)}},d.Spawner=class extends a.Container{constructor(e,t,n){super(),this.particleOptions=t,this.options=n,this.manager=e,this.lifetime=0,this.totalLifetime=n.lifetime,this.x=this.options.x,this.y=this.options.y,this.amount=this.options.amount/60}progressLifetime(e){if(-1===this.totalLifetime)return!1;if(1===e){if(this.lifetime+=1/60,this.lifetime>=this.totalLifetime)return this.destroy(),!0}else if(this.lifetime+=e/60,this.lifetime>=this.totalLifetime)return this.destroy(),!0;return!1}spawn(e){this.options.amount=this.amount*e;const t=new a.Point;this.getGlobalPosition(t,!!this.canSkipGlobalTransform),this.options.x=t.x,this.options.y=t.y,this.canSkipGlobalTransform=!0,this.manager.spawnBurst(this.particleOptions,this.options)}progress(e){return!!this._destroyed||(!!this.progressLifetime(e)||void this.spawn(e))}},d.Particle=class extends a.Sprite{constructor(e,t){super(d.TextureCache.GetTexture(e.texture)),this.manager=t,this.contextWidth=0,this.contextHeight=0,this.init(e)}init(e){this.graveyarded=!1,this.options=e,this.lifetime=0,this.x=e.x,this.y=e.y,this.hasDynamicAlpha=e.alpha.inc||e.alphamultiplier.inc,this.hasDynamicScale=e.scale.inc||e.scalemultiplier.inc,this.hasDynamicXYSpeed=e.xspeed.inc||e.yspeed.inc||e.xflurry.inc||e.yflurry.inc,this.hasXYSpeed=e.xspeed.start||e.yspeed.start||e.xspeed.inc||e.yspeed.inc||e.xflurry.start||e.yflurry.start||e.xflurry.inc||e.yflurry.inc,this.hasDynamicAngle=e.angle.inc||e.anglespeed.inc||e.anglespeed.start,this.hasDynamicSpeed=e.speed.inc||e.direction.inc,this.hasSpeed=e.speed.inc||e.speed.start,this.hasDynamicFlurry=e.flurryfrequency.inc||e.flurryamplitude.inc,this.hasDynamicFlicker=e.flickerfrequency.inc||e.flickeramplitude.inc,this.hasDynamicAlphaOrFlicker=e.alpha.inc||e.alphamultiplier.inc||e.flickeramplitude.inc||e.flickeramplitude.start,this.hasDynamicTint=e.tint.r.inc||e.tint.g.inc||e.tint.b.inc,this.alpha=e.alpha.start*Math.min(1,e.alphamultiplier.start),this.alphamultiplier=e.alphamultiplier.start,this.truealpha=e.alpha.start,this.xspeed=e.xspeed.start,this.yspeed=e.yspeed.start,this.angle=e.angle.start,this.anglespeed=e.anglespeed.start,this.scale.set(e.scale.start*Math.min(1,e.scalemultiplier.start)),this.scalemultiplier=e.scalemultiplier.start,this.truescale=e.scale.start,this.direction=e.direction.start,this.speed=e.speed.start,this.flurryfrequency=e.flurryfrequency.start,this.flurryamplitude=e.flurryamplitude.start,this.xflurry=e.xflurry.start,this.yflurry=e.yflurry.start,this.flickerfrequency=e.flickerfrequency.start,this.flickeramplitude=e.flickeramplitude.start,this.explodedTintR=e.tint.r.start,this.explodedTintG=e.tint.g.start,this.explodedTintB=e.tint.b.start,this.explodedTintRinc=e.tint.r.inc,this.explodedTintGinc=e.tint.g.inc,this.explodedTintBinc=e.tint.b.inc,this.tint=d.Utils.PackRGB(this.explodedTintR,this.explodedTintG,this.explodedTintB),this.totalLifetime=e.lifetime,this.alphaInc=e.alpha.inc,this.alphaMultiplierInc=e.alphamultiplier.inc,this.scaleInc=e.scale.inc,this.scaleMultiplierInc=e.scalemultiplier.inc,this.xSpeedInc=e.xspeed.inc,this.ySpeedInc=e.yspeed.inc,this.xFlurryInc=e.xflurry.inc,this.yFlurryInc=e.yflurry.inc,this.angleInc=e.angle.inc,this.angleSpeedInc=e.anglespeed.inc,this.speedInc=e.speed.inc,this.directionInc=e.direction.inc,this.flurryFrequencyInc=e.flurryfrequency.inc,this.flurryAmplitudeInc=e.flurryamplitude.inc,this.flickerFrequencyInc=e.flickerfrequency.inc,this.flickerAmplitudeInc=e.flickeramplitude.inc,this.doWrap=e.wrap,this.blendMode=e.blendmode}graveyard(){void 0!==this.manager?(this.manager.graveyard(this,this.parent.children.length),this.graveyarded=!0,this.parent&&(this.parent.removeChild(this),this.parent=null)):this.destroy()}progressLifetime(e){if(1===e){if(this.lifetime+=1/60,this.lifetime>=this.totalLifetime)return this.graveyard(),!0}else if(this.lifetime+=e/60,this.lifetime>=this.totalLifetime)return this.graveyard(),!0;return!1}progressAlpha(e){if(this.hasDynamicAlphaOrFlicker)if(1===e){if(this.truealpha+=this.alphaInc,this.alphamultiplier+=this.alphaMultiplierInc,this.hasDynamicAlphaOrFlicker){let e=this.truealpha*Math.min(1,this.alphamultiplier);this.flickeramplitude&&(e=Math.max(0,Math.min(1,this.truealpha+Math.sin(this.lifetime*this.flickerfrequency)*this.flickeramplitude))),this.alpha=e}}else if(this.truealpha+=this.alphaInc*e,this.alphamultiplier+=this.alphaMultiplierInc*e,this.hasDynamicAlphaOrFlicker){let e=this.truealpha*Math.min(1,this.alphamultiplier);this.flickeramplitude&&(e=Math.max(0,Math.min(1,this.truealpha+Math.sin(this.lifetime*this.flickerfrequency)*this.flickeramplitude))),this.alpha=e}}progressScale(e){if(this.hasDynamicScale)if(1===e){this.truescale+=this.scaleInc,this.scalemultiplier+=this.scaleMultiplierInc;let e=this.truescale;this.scalemultiplier<1&&(e*=this.scalemultiplier),this.scale.set(e)}else{this.truescale+=this.scaleInc*e,this.scalemultiplier+=this.scaleMultiplierInc*e;let t=this.truescale;this.scalemultiplier<1&&(t*=this.scalemultiplier),this.scale.set(t)}}progressXYSpeed(e){if(this.hasXYSpeed)if(1===e){this.hasDynamicXYSpeed&&(this.xspeed+=this.xSpeedInc,this.yspeed+=this.ySpeedInc,this.xflurry+=this.xFlurryInc,this.yflurry+=this.yFlurryInc);let e=this.xspeed+(2*Math.random()-1)*this.xflurry,t=this.yspeed+(2*Math.random()-1)*this.yflurry;this.x+=e/60,this.y+=t/60}else{this.hasDynamicXYSpeed&&(this.xspeed+=this.xSpeedInc*e,this.yspeed+=this.ySpeedInc*e,this.xflurry+=this.xFlurryInc*e,this.yflurry+=this.yFlurryInc*e);let t=this.xspeed+(2*Math.random()-1)*this.xflurry,n=this.yspeed+(2*Math.random()-1)*this.yflurry;this.x+=t/60*e,this.y+=n/60*e}}progressAngle(e){this.hasDynamicAngle&&(1===e?(this.angle+=this.angleInc,this.anglespeed+=this.angleSpeedInc,this.angle+=this.anglespeed/60):(this.angle+=this.angleInc*e,this.anglespeed+=this.angleSpeedInc*e,this.angle+=this.anglespeed/60*e))}progressSpeed(e){if(1===e){if(this.hasDynamicSpeed&&(this.speed+=this.speedInc,this.direction+=this.directionInc),this.hasSpeed){let e=this.direction;this.flurryamplitude&&(e+=Math.sin(this.lifetime*this.flurryfrequency)*this.flurryamplitude);const t=e*-a.DEG_TO_RAD;this.x+=Math.sin(Math.PI+t)*(this.speed/60),this.y+=Math.cos(Math.PI+t)*(this.speed/60)}}else if(this.hasDynamicSpeed&&(this.speed+=this.speedInc*e,this.direction+=this.directionInc*e),this.hasSpeed){let t=this.direction;this.flurryamplitude&&(t+=Math.sin(this.lifetime*this.flurryfrequency)*this.flurryamplitude);const n=t*-a.DEG_TO_RAD;this.x+=Math.sin(Math.PI+n)*(this.speed/60)*e,this.y+=Math.cos(Math.PI+n)*(this.speed/60)*e}}progressFlurry(e){this.hasDynamicFlurry&&(1===e?(this.flurryfrequency+=this.flurryFrequencyInc,this.flurryamplitude+=this.flurryAmplitudeInc):(this.flurryfrequency+=this.flurryFrequencyInc*e,this.flurryamplitude+=this.flurryAmplitudeInc*e))}progressFlicker(e){this.hasDynamicFlicker&&(1===e?(this.flickerfrequency+=this.flickerFrequencyInc,this.flickeramplitude+=this.flickerAmplitudeInc):(this.flickerfrequency+=this.flickerFrequencyInc*e,this.flickeramplitude+=this.flickerAmplitudeInc*e))}progressTint(e){this.hasDynamicTint&&(1===e?(this.explodedTintR+=this.explodedTintRinc,this.explodedTintG+=this.explodedTintGinc,this.explodedTintB+=this.explodedTintBinc,this.tint=d.Utils.PackRGB(this.explodedTintR,this.explodedTintG,this.explodedTintB)):(this.explodedTintR+=this.explodedTintRinc*e,this.explodedTintG+=this.explodedTintGinc*e,this.explodedTintB+=this.explodedTintBinc*e,this.tint=d.Utils.PackRGB(this.explodedTintR,this.explodedTintG,this.explodedTintB)))}progressWrap(e){if(!this.doWrap)return;this.contextWidth||(this.contextWidth=this.parent.contextWidth,this.contextHeight=this.parent.contextHeight);const t=Math.max(this.texture.width,this.texture.height)*this.scale.x*1.5,n=this.contextWidth||window.innerWidth,s=this.contextHeight||window.innerHeight;this.x>n+t&&(this.x-=n+2*t),this.x<-t&&(this.x+=n+2*t),this.y>s+t&&(this.y-=s+2*t),this.y<-t&&(this.y+=s+2*t)}progress(e){this.progressLifetime(e)||(this.progressAlpha(e),this.progressScale(e),this.progressXYSpeed(e),this.progressAngle(e),this.progressSpeed(e),this.progressFlurry(e),this.progressFlicker(e),this.progressTint(e),this.progressWrap(e))}_render(e){this.contextWidth||(this.contextWidth=e.width,this.contextHeight=e.height),super._render(e)}},d.ParseSimpleParticleOptions=function(e){const t=["x","y","lifetime"],n=["texture","blendmode","wrap","addinback"],s=["alpha","alphamultiplier","scale","scalemultiplier","angle","xspeed","yspeed","anglespeed","direction","speed","flurryfrequency","flurryamplitude","xflurry","yflurry","flickerfrequency","flickeramplitude"],i=["tint"],o={alpha:1,scale:1,scalemultiplier:1,alphamultiplier:1},r={x:0,y:0,lifetime:1,blendmode:a.BLEND_MODES.NORMAL,addinback:!1};for(const n of t)Array.isArray(e[n])?r[n]=e[n][0]+Math.random()*(e[n][1]-e[n][0]):void 0!==e[n]&&(r[n]=e[n]);for(const t of n)Array.isArray(e[t])?r[t]=e[t][Math.floor(Math.random()*e[t].length)]:void 0!==e[t]&&(r[t]=e[t]);for(const t of s)r[t]=d.ParseProgression(e[t]||o[t],r);for(const t of i){const n=d.SplitTints(e[t]);r[t]={r:d.ParseProgression(n.r,r),g:d.ParseProgression(n.g,r),b:d.ParseProgression(n.b,r)}}return e.angleParaxial&&(r.angle.start+=90*Math.floor(4*Math.random())),r.needsVertices=1!==r.scale.start||0!==r.scale.inc||1!==r.scalemultiplier.start||0!==r.scalemultiplier.inc,r.needsRotation=0!==r.angle.start||0!==r.angle.inc||0!==r.anglespeed.start||0!==r.anglespeed.inc,r},d.SplitTints=function(e){if(void 0===e)return{r:255,g:255,b:255};if("number"==typeof e)return{r:e>>16,g:e>>8&255,b:255&e};if(Array.isArray(e))return{r:[e[0]>>16,e[1]>>16],g:[e[0]>>8&255,e[1]>>8&255],b:[255&e[0],255&e[1]]};let t,n,s;return Array.isArray(e.from)?(t=[e.from[0]>>16,e.from[1]>>16],n=[e.from[0]>>8&255,e.from[1]>>8&255],s=[255&e.from[0],255&e.from[1]]):Array.isArray(e.start)?(t=[e.start[0]>>16,e.start[1]>>16],n=[e.start[0]>>8&255,e.start[1]>>8&255],s=[255&e.start[0],255&e.start[1]]):"number"==typeof e.from?(t=e.from>>16,n=e.from>>8&255,s=255&e.from):"number"==typeof e.start&&(t=e.start>>16,n=e.start>>8&255,s=255&e.start),void 0!==e.to?Array.isArray(e.to)?{r:{from:t,to:[e.to[0]>>16,e.to[1]>>16]},g:{from:n,to:[e.to[0]>>8&255,e.to[1]>>8&255]},b:{from:s,to:[255&e.to[0],255&e.to[1]]}}:{r:{from:t,to:e.to>>16},g:{from:n,to:e.to>>8&255},b:{from:s,to:255&e.to}}:void 0!==e.inc?Array.isArray(e.inc)?{r:{from:t,inc:[e.inc[0]>>16,e.inc[1]>>16]},g:{from:n,inc:[e.inc[0]>>8&255,e.inc[1]>>8&255]},b:{from:s,inc:[255&e.inc[0],255&e.inc[1]]}}:{r:{from:t,inc:e.inc>>16},g:{from:n,inc:e.inc>>8&255},b:{from:s,inc:255&e.inc}}:{r:255,g:255,b:255}},d.ParseProgression=function(e,t){if(void 0===e)return{start:0,inc:0};if("number"==typeof e)return{start:e,inc:0};if(Array.isArray(e))return{start:e[0]+Math.random()*(e[1]-e[0]),inc:0};let n=0;void 0!==e.from?n="number"==typeof e.from?e.from:e.from[0]+Math.random()*(e.from[1]-e.from[0]):void 0!==e.start&&(n="number"==typeof e.start?e.start:e.start[0]+Math.random()*(e.start[1]-e.start[0]));let s=0;if(void 0!==e.inc)s="number"==typeof e.inc?e.inc:e.inc[0]+Math.random()*(e.inc[1]-e.inc[0]);else if(void 0!==e.to)if("number"==typeof e.to)s=(e.to-n)/(60*t.lifetime);else{s=(e.to[0]+Math.random()*(e.to[1]-e.to[0])-n)/(60*t.lifetime)}return{start:n,inc:s}},d.TextureCache=(()=>{const e=new Map;return{GetTexture:function(t){if(e.has(t))return e.get(t);const n=a.Texture.from(t);return n.defaultAnchor.set(.5,.5),e.set(t,n),n}}})(),d.Utils={PackRGB:function(e,t,n){return Math.min(255,Math.max(0,Math.round(e)))<<16|Math.min(255,Math.max(0,Math.round(t)))<<8|Math.min(255,Math.max(0,Math.round(n)))}};const h=(()=>{const e=new Set;return a.Ticker.shared.add((function(t){for(const n of e)n._destroyed||n.progress(t)}),this),{add:function(t){e.add(t)},remove:function(t){e.delete(t)}}})();h.Beam=class extends a.SimpleRope{constructor(e){"string"==typeof e.texture&&(e.texture=a.Texture.from(e.texture));const t=e.scale||1,n=[],s=[],i=[];if("path"===e.mode||"connect"===e.mode)for(let i=0;i<e.path.length;i++)n.push(e.path[i].x/t),s.push(e.path[i].y/t);else"follow"===e.mode&&(n.push(e.followPoint.x),s.push(e.followPoint.y));for(let t=0;t<(e.vertices||100);t++)i.push(new a.Point(n[0],s[0]));super(e.texture,i,e.repeatTexture?1:0),this.options={vertices:100,length:20,duration:1,tint:16777215,blendMode:a.BLEND_MODES.NORMAL,alpha:1,scale:1,smoothVertices:!0,smoothPath:!1,repeatTexture:!1,reverse:!1,jitter:0,...e},this.points=i,this.pathX=n,this.pathY=s,this.pathLength=n.length,this.historyX=[],this.historyY=[],this.mustInitializeHistory=!0,this.leader=new a.Point(n[0],s[0]),this.leaderObject=null,this.age=0,this.tint=this.options.tint,this.blendMode=this.options.blendMode,this.alpha=this.options.alpha,this.realAlpha=this.options.alpha,this.scale.set(this.options.scale),this.hasHit=!1,"string"==typeof this.options.leader?(this.leaderObject=a.Sprite.from(this.options.leader),this.leaderObject.anchor.set(.5,.5)):this.options.leader&&(this.leaderObject=this.options.leader),this.leaderObject&&(this.leaderObject.position.set(this.leader.x,this.leader.y),this.leaderObject.blendMode=this.options.blendMode,this.leaderObject.tint=this.options.tint,this.leaderObject.x=this.leader.x,this.leaderObject.y=this.leader.y,this.addChild(this.leaderObject)),h.add(this)}destroy(){h.remove(this),super.destroy()}hit(){if(this.options.onHit){let e=new a.Point(this.leader.x*this.scale.x,this.leader.y*this.scale.y);this.leaderObject&&(e=this.leaderObject.getGlobalPosition(void 0,!0)),this.options.onHit(this,e)}}die(){if(this.options.onDie){let e=new a.Point(this.leader.x*this.scale.x,this.leader.y*this.scale.y);this.leaderObject&&(e=this.leaderObject.getGlobalPosition(void 0,!0)),this.options.onDie(this,e)}this.destroy()}progressLeaderPath(e){let t=this.age/this.options.duration/60*(this.pathLength-1);t>=this.pathLength-1&&(this.alpha-=this.realAlpha/this.historyX.length,this.hasHit||(this.hasHit=!0,this.hit()),this.alpha<=0&&this.die()),this.hasHit||(this.options.pathBezier&&(t=this.options.pathBezier(Math.max(0,Math.min(1,t/(this.pathLength-1))))*(this.pathLength-1)),this.options.smoothPath?(this.leader.x=h.Utils.CubicInterpolation(this.pathX,t),this.leader.y=h.Utils.CubicInterpolation(this.pathY,t)):(this.leader.x=h.Utils.LinearInterpolation(this.pathX,t),this.leader.y=h.Utils.LinearInterpolation(this.pathY,t)))}progressLeaderFollow(e){this.leader.set(this.options.followPoint.x/this.options.scale,this.options.followPoint.y/this.options.scale)}progressLeaderConnect(e){this.age>=60*this.options.duration&&this.die()}progressLeader(e){switch(this.options.mode){case"path":return this.progressLeaderPath(e);case"follow":return this.progressLeaderFollow(e);case"connect":return this.progressLeaderConnect(e)}}progressLeaderObject(e){this.leaderObject&&!this.leaderObject._destroyed&&(this.leaderObject.x=this.leader.x,this.leaderObject.y=this.leader.y)}progressHistory(e){if(this.mustInitializeHistory){for(let t=0;t<this.options.length/e;t++)this.historyX.push(this.pathX[0]),this.historyY.push(this.pathY[0]);this.mustInitializeHistory=!1}this.historyX.push(this.leader.x),this.historyY.push(this.leader.y),this.historyX.shift(),this.historyY.shift()}progressPoints(e){const t=this.options.reverse?1:0,n=this.options.reverse?-1:1;let s=this.historyX,i=this.historyY,o=0;"connect"===this.options.mode&&(s=this.pathX,i=this.pathY,o=-1);const a=this.options.smoothVertices?h.Utils.CubicInterpolation:h.Utils.LinearInterpolation;for(let e=0;e<this.options.vertices;e++){let r=0,l=0;this.options.jitter&&(r=(Math.random()-.5)*this.options.jitter,l=(Math.random()-.5)*this.options.jitter),this.points[e].set(r+a(s,(t+e/this.options.vertices*n)*(s.length+o)),l+a(i,(t+e/this.options.vertices*n)*(i.length+o)))}}progress(e){this.age+=e,this.progressLeader(e),this.progressLeaderObject(e),this.progressHistory(e),this.progressPoints(e)}},h.Utils=(()=>{function e(e,t){return t[Math.min(Math.max(e,0),t.length-1)]}function t(t,n,s){return n*(e(t+1,s)-e(t-1,s))/2}return{CubicInterpolation:function(n,s,i=1){const o=Math.floor(s),a=[t(o,i,n),t(o+1,i,n)],r=[e(o,n),e(o+1,n)],l=(s-=o)*s,c=s*l;return(2*c-3*l+1)*r[0]+(c-2*l+s)*a[0]+(-2*c+3*l)*r[1]+(c-l)*a[1]},LinearInterpolation:function(t,n){const s=e(Math.floor(n),t);return s+n%1*(e(Math.floor(n)+1,t)-s)}}})();const m=(()=>{const e=[];let t,n=!1,s=!1;function i(){n||s||(s=!0,nsfwjs.load("/res/ml/").then((s=>{t=s,n=!0,e.forEach((e=>{e()}))})))}return{request:function(s=()=>{}){return new Promise(((o,a)=>{i();const r=document.createElement("input");r.type="file",r.setAttribute("accept",".png,.jpg,.jpeg,.gif,image/gif,image/png,image/jpg,image/jpeg"),r.onchange=r=>{s();const l=document.createElement("img"),c=r.target.files[0];if(c.size>=2097152)return void a("sorry, that file's too large!");const p=new FileReader;p.readAsDataURL(c),p.onload=()=>{var s;l.src=p.result,s=()=>{setTimeout((()=>{try{t.classify(l).then((e=>{let t=0;["Porn","Sexy","Hentai"].includes(e[0].className)?t=2:e.forEach((e=>{["Porn","Sexy","Hentai"].includes(e.className)&&(e.probability>=.4?t=Math.max(t,2):e.probability>=.1&&(t=Math.max(t,1)))})),o({safetyLevel:t,image:c,predictions:e})})).catch((()=>{o({safetyLevel:1,image:c,predictions:[]})}))}catch(e){o({safetyLevel:1,image:c,predictions:[]})}}),100)},i(),n?s():e.push(s)}},r.click()}))}}})(),g={};n.addExtension({type:1,read:e=>null===e?{success:!0}:{success:!0,...e}}),n.addExtension({type:2,read:e=>null===e?{success:!1}:{success:!1,error:e}}),g.Text=class extends a.Container{constructor(e,t){super(),this._text=e.toString()||" ",this._options={font:null,rasterize:!1,fontSize:42,alpha:1,tint:16777215,weight:500,sharpness:.85,letterSpacing:0,lineSpacing:0,blendMode:a.BLEND_MODES.NORMAL,align:"left",anchor:[0,0],outlineWeight:900,outlineAlpha:0,outlineTint:0,fillAlpha:1,misalignment:0,misalignmentSeed:Math.floor(1e6*Math.random()),invert:0,shadows:[],useProjection:!1,projection:[[0,0],[1,0],[0,1],[1,1]],...t},this._textMustRegenerate=!1,this._textDirty=!1,this._meshes=new Map,this._shadowMeshes=new Map,this._options.anchor=new a.ObservablePoint((()=>{this._textDirty=!0}),this,...this._options.anchor);for(let e=0;e<4;e++)this._options.projection[e]=new a.ObservablePoint((()=>{this._textDirty=!0}),this,...this._options.projection[e]);if(this._options.overrides=new g.CharacterOverrideMap((()=>{this._textDirty=!0})),this.alpha=void 0===this._options.alpha?1:this._options.alpha,!this.font)throw new Error("Could not create Text: config.font must be set");this.regenerateText()}declareType(e=!1){if("bitmap"===this.font.type)return"bitmap";if(this._options.rasterize){if(!e)return"rasterized";for(const e of this.declareAllMasters())this.font.fontTextures.has(`p0.rasterized.${e}`)||this.font.rasterize(e,((e,t,n)=>{for(const[,s]of this._meshes)s.tt_mesh_id==n&&100*Math.round(s.weight/100)==t&&(s.texture=e);for(const[,s]of this._shadowMeshes)s.tt_mesh_id.toString().split("_")[0]==n&&100*Math.round(s.weight/100)==t&&(s.texture=e)}));return"rasterized"}return"sdf"}declareMaster(){return"bitmap"!==this.font.type&&this._options.rasterize?100*Math.round(this._options.weight/100):"master"}declareAllMasters(){const e=new Set;if(e.add(100*Math.round(this._options.weight/100)),"bitmap"===this.font.type||!this._options.rasterize)return e;for(const t of this._options.shadows)e.add(100*Math.round(t.weight/100));return e}createMesh(e,t,n){const s=new g.TextMesh(this.declareType(!0),this.font.fontTextures.get(`p${e}.${this.declareType()}.${this.declareMaster()}`)||a.Texture.EMPTY,n?t:g.Geometrize(t),this);return s.tint=this._options.tint,s.weight=this._options.weight,s.sharpness=this._options.sharpness,s.fontSize=this._options.fontSize,s.blendMode=this._options.blendMode,s.invert=this._options.invert,s.outlineWeight=this._options.outlineWeight,s.outlineAlpha=this._options.outlineAlpha,s.outlineTint=this._options.outlineTint,s.fillAlpha=this._options.fillAlpha,s.tt_mesh_id=e,this._meshes.set(e,s),this.addChild(s),s}createShadowMesh(e,t,n,s,i){const o=new g.TextMesh(this.declareType(!0),this.font.fontTextures.get(`p${e}.${this.declareType()}.${this.declareMaster()}`)||a.Texture.EMPTY,n?t:g.Geometrize(t),this);return o.tint=s.tint,o.weight=s.weight,o.sharpness=void 0===s.sharpness?this._options.sharpness:s.sharpness,o.fontSize=this._options.fontSize,o.blendMode=void 0===s.blendMode?this._options.blendMode:s.blendMode,o.invert=void 0===s.invert?this._options.invert:s.invert,o.tt_mesh_id=`${e}_s${i}`,o.position.x+=s.x||0,o.position.y+=s.y||0,o.alpha=void 0===s.alpha?1:s.alpha,o.scale.set(void 0===s.scale?1:s.scale),o.rotation=s.rotation||0,this._shadowMeshes.set(`${e}_s${i}`,o),this.addChild(o),o}regenerateText(){this.removeChildren(),this._meshes.clear(),this._shadowMeshes.clear();const e=new Map,t="sdf"===this.declareType()?1:this._options.fontSize/this.font.fontData.info.size,n=g.LayoutText(this._text,this._options,this.font,t);let s=0;for(const t of this._options.shadows){for(const[i,o]of n){let n=null;e.has(i)?n=e.get(i):(n=g.Geometrize(o),e.set(i,n)),this.createShadowMesh(i,n,!0,t,s)}s++}for(const[t,s]of n){let n=null;e.has(t)?n=e.get(t):(n=g.Geometrize(s),e.set(t,n)),this.createMesh(t,n,!0)}this._textMustRegenerate=!1,this._textDirty=!1}updateText(){const e="sdf"===this.declareType()?1:this._options.fontSize/this.font.fontData.info.size,t=g.LayoutText(this._text,this._options,this.font,e),n=[];for(const[e,s]of t){const t=this._meshes.get(e);t?t.updateGeometry(s.vertices,s.uvs,s.indices):this.createMesh(e,s),n.push(e)}for(const[e,t]of this._meshes)n.includes(e)||t.destroy();for(const[e,t]of this._shadowMeshes)t.forceUploadGeometry();this._textDirty=!1}_render(e){this._textMustRegenerate&&this.regenerateText(),this._textDirty&&this.updateText(),super._render(e)}get font(){return this._options.font}get text(){return this._text}set text(e){e=e.toString()||" ",this._text!==e&&(this._text=e,this._textDirty=!0,this._options._cache=null)}get align(){return this._options.align}set align(e){this._options.align!==e&&(this._options.align=e,this._textDirty=!0,this._options._cache=null)}get anchor(){return this._options.anchor}get tint(){return this._options.tint}set tint(e){if(this._options.tint!==e){this._options.tint=e;for(const[,t]of this._meshes)t.tint=e}}get blendMode(){return this._options.blendMode}set blendMode(e){if(this._options.blendMode!==e){this._options.blendMode=e;for(const[,t]of this._meshes)t.blendMode=e}}get weight(){return this._options.weight}set weight(e){if(this._options.weight!==e){this._options.weight=e;for(const[,t]of this._meshes)t.weight=e,"rasterized"===this.declareType(!0)&&(t.texture=this.font.fontTextures.get(`p${t.tt_mesh_id.toString().split("_")[0]}.${this.declareType()}.${this.declareMaster()}`)||a.Texture.EMPTY)}}get sharpness(){return this._options.sharpness}set sharpness(e){if(this._options.sharpness!==e){this._options.sharpness=e;for(const[,t]of this._meshes)t.sharpness=e}}get invert(){return this._options.invert}set invert(e){if(this._options.invert!==e){this._options.invert=e;for(const[,t]of this._meshes)t.invert=e}}get fontSize(){return this._options.fontSize}set fontSize(e){if(this._options.fontSize!==e){this._options.fontSize=e;for(const[,t]of this._meshes)t.fontSize=e;for(const[,t]of this._shadowMeshes)t.fontSize=e;"sdf"!==this.declareType()&&(this._textDirty=!0,this._options._cache=null)}}get letterSpacing(){return this._options.letterSpacing}set letterSpacing(e){this._options.letterSpacing!==e&&(this._options.letterSpacing=e,this._textDirty=!0,this._options._cache=null)}get lineSpacing(){return this._options.lineSpacing}set lineSpacing(e){this._options.lineSpacing!==e&&(this._options.lineSpacing=e,this._textDirty=!0,this._options._cache=null)}get outlineWeight(){return this._options.outlineWeight}set outlineWeight(e){if(this._options.outlineWeight!==e){this._options.outlineWeight=e;for(const[,t]of this._meshes)t.outlineWeight=e}}get outlineAlpha(){return this._options.outlineAlpha}set outlineAlpha(e){if(this._options.outlineAlpha!==e){this._options.outlineAlpha=e;for(const[,t]of this._meshes)t.outlineAlpha=e}}get fillAlpha(){return this._options.fillAlpha}set fillAlpha(e){if(this._options.fillAlpha!==e){this._options.fillAlpha=e;for(const[,t]of this._meshes)t.fillAlpha=e}}get outlineTint(){return this._options.outlineTint}set outlineTint(e){if(this._options.outlineTint!==e){this._options.outlineTint=e;for(const[,t]of this._meshes)t.outlineTint=e}}get misalignment(){return this._options.misalignment}set misalignment(e){this._options.misalignment!==e&&(this._options.misalignment=e,this._textDirty=!0)}get misalignmentSeed(){return this._options.misalignmentSeed}set misalignmentSeed(e){this._options.misalignmentSeed!==e&&(this._options.misalignmentSeed=e,this._textDirty=!0)}get shadows(){return this._options.shadows}set shadows(e){this._options.shadows!==e&&(this._options.shadows=e,this._textMustRegenerate=!0)}get useProjection(){return this._options.useProjection}set useProjection(e){this._options.useProjection!==e&&(this._options.useProjection=e,this._textDirty=!0)}get projection(){return this._options.projection}get overrides(){return this._options.overrides}get meshes(){return this._meshes}get shadowMeshes(){return this._shadowMeshes}findShadowMeshes(e){const t=new Map;for(const[n,s]of this._shadowMeshes)n.endsWith(`_s${e}`)&&t.set(n,s);return t}setMustRegenerate(){this._textMustRegenerate=!0}setTextDirty(){this._textDirty=!0}},g.TextMesh=class extends a.Mesh{constructor(e,t,n,s){let i;i="sdf"===e?new a.Shader(g.Shader,{uSampler:t,uAlpha:1,uTint:a.utils.hex2rgb(16777215),uWeight:.5,uSharpness:.15,uScale:1,uOutlineWeight:.1,uOutlineAlpha:0,uFillAlpha:1,uOutlineTint:a.utils.hex2rgb(0),uInvert:0}):new a.MeshMaterial(t),super(n,i),this._type=e,this._parent=s,this._texture=t,this._styleDirty=!1,this._alpha=1,this._lastWorldAlpha=1,this._tint=16777215,this._weight=500,this._sharpness=.85,this._fontSize=52,this._outlineWeight=900,this._outlineAlpha=0,this._fillAlpha=1,this._outlineTint=0,this._invert=!1}updateStyle(){if("sdf"===this._type){this.shader.uniforms.uAlpha=this.worldAlpha,this.shader.uniforms.uTint=a.utils.hex2rgb(this.tint);const e=this.fontSize/this._parent.font.fontData.info.size,t=Math.min(1,Math.max(0,this.invert?this.weight/1e3:1-this.weight/1e3)),n=Math.min(1,Math.max(0,1-this.outlineWeight/1e3)),s=Math.min((1-this.sharpness)/e,t,this.outlineAlpha>0?n:1);this.shader.uniforms.uWeight=t,this.shader.uniforms.uSharpness=s,this.shader.uniforms.uScale=e,this.shader.uniforms.uOutlineAlpha=this.outlineAlpha,this.shader.uniforms.uOutlineTint=a.utils.hex2rgb(this.outlineTint),this.shader.uniforms.uOutlineWeight=n,this.shader.uniforms.uFillAlpha=this.fillAlpha,this.shader.uniforms.uInvert=this.invert}else this.shader.alpha=this.worldAlpha,this.shader.tint=this.tint;this._styleDirty=!1}_renderDefault(e){this.worldAlpha!==this._lastWorldAlpha&&(this._styleDirty=!0),this._styleDirty&&this.updateStyle(),super._renderDefault(e)}_render(e){this.worldAlpha!==this._lastWorldAlpha&&(this._styleDirty=!0),this._styleDirty&&this.updateStyle(),super._render(e)}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,"sdf"===this._type?this.shader.uniforms.uSampler=this._texture:this.shader.texture=this._texture)}get alpha(){return this._alpha}set alpha(e){this._alpha!==e&&(this._alpha=e,this._styleDirty=!0)}get tint(){return this._tint}set tint(e){this._tint!==e&&(this._tint=e,this._styleDirty=!0)}get weight(){return this._weight}set weight(e){this._weight!==e&&(this._weight=e,this._styleDirty=!0)}get sharpness(){return this._sharpness}set sharpness(e){this._sharpness!==e&&(this._sharpness=e,this._styleDirty=!0)}get invert(){return this._invert}set invert(e){this._invert!==e&&(this._invert=e,this._styleDirty=!0)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this._styleDirty=!0)}get outlineWeight(){return this._outlineWeight}set outlineWeight(e){this._outlineWeight!==e&&(this._outlineWeight=e,this._styleDirty=!0)}get outlineAlpha(){return this._outlineAlpha}set outlineAlpha(e){this._outlineAlpha!==e&&(this._outlineAlpha=e,this._styleDirty=!0)}get fillAlpha(){return this._fillAlpha}set fillAlpha(e){this._fillAlpha!==e&&(this._fillAlpha=e,this._styleDirty=!0)}get outlineTint(){return this._outlineTint}set outlineTint(e){this._outlineTint!==e&&(this._outlineTint=e,this._styleDirty=!0)}updateGeometry(e,t,n){if(e){const t=this.geometry.getBuffer("aVertexPosition").data,n=t.buffer;if(e.length*Float32Array.BYTES_PER_ELEMENT>n.byteLength){const t=new ArrayBuffer((e.length+16)*Float32Array.BYTES_PER_ELEMENT),n=new Float32Array(t,0,e.length);n.set(e),this.geometry.getBuffer("aVertexPosition").update(n)}else if(e.length===t.length)t.set(e),this.geometry.getBuffer("aVertexPosition").update();else{const t=new Float32Array(n,0,e.length);t.set(e),this.geometry.getBuffer("aVertexPosition").update(t)}}if(t){const e=this.geometry.getBuffer("aTextureCoord").data,n=e.buffer;if(t.length*Float32Array.BYTES_PER_ELEMENT>n.byteLength){const e=new ArrayBuffer((t.length+16)*Float32Array.BYTES_PER_ELEMENT),n=new Float32Array(e,0,t.length);n.set(t),this.geometry.getBuffer("aTextureCoord").update(n)}else if(t.length===e.length)e.set(t),this.geometry.getBuffer("aTextureCoord").update();else{const e=new Float32Array(n,0,t.length);e.set(t),this.geometry.getBuffer("aTextureCoord").update(e)}}if(n){const e=this.geometry.getIndex().data,t=e.buffer;if(n.length*Uint16Array.BYTES_PER_ELEMENT>t.byteLength){const e=new ArrayBuffer((n.length+16)*Uint16Array.BYTES_PER_ELEMENT),t=new Uint16Array(e,0,n.length);t.set(n),this.geometry.getIndex().update(t)}else if(n.length===e.length);else if(n.length>e.length){const e=new Uint16Array(t,0,n.length);e.set(n),this.geometry.getIndex().update(e)}else{const e=new Uint16Array(t,0,n.length);this.geometry.getIndex().update(e)}}this.forceUploadGeometry()}forceUploadGeometry(){if("bitmap"===this._type||"rasterized"===this._type){const e=this.transform,t=this.parent,n=this.worldAlpha;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,this.getBounds(),this.parent=t,this.transform=e,this.worldAlpha=n}}},g.Font=function(e){const t={fnt:null,type:null,rasterizeRenderer:null,rasterizeSize:2048,onload:()=>{},...e};let n={};const s=new Map,i=new Map;if(!t.fnt)throw new Error("Could not create Font: options.fnt must be set");if(!t.type)throw new Error("Could not create Font: options.type must be set");function o(e,r,l,c,p=!1){if(!t.rasterizeRenderer)throw new Error("Could not rasterize Font: options.rasterizeRenderer must be set");if(!t.rasterizeSize)throw new Error("Could not rasterize Font: options.rasterizeSize must be set");if(s.get(`p${l}.rasterized.${r}`))return void c(s.get(`p${l}.rasterized.${r}`),r,l);if(i.has(`p${l}.rasterized.${r}`)){if(c&&i.get(`p${l}.rasterized.${r}`).push(c),!p)return}else c&&i.set(`p${l}.rasterized.${r}`,[c]);if(!e.baseTexture.valid)return void e.baseTexture.once("loaded",(()=>{o(e,r,l,void 0,!0)}));const d=a.RenderTexture.create(t.rasterizeSize,t.rasterizeSize),h=new a.Geometry;h.addAttribute("aVertexPosition",[0,0,t.rasterizeSize,0,0,t.rasterizeSize,t.rasterizeSize,t.rasterizeSize],2),h.addAttribute("aTextureCoord",[0,0,1,0,0,1,1,1],2),h.addIndex([0,1,2,1,3,2]);const u=Math.min(1,Math.max(0,1-r/1e3)),_=Math.min(.15/(t.rasterizeSize/n.common.scaleW),u),m=new a.Shader(g.Shader,{uSampler:e,uAlpha:1,uTint:a.utils.hex2rgb(16777215),uWeight:u,uSharpness:_,uScale:1,uOutlineWeight:.1,uOutlineAlpha:0,uFillAlpha:1,uOutlineTint:a.utils.hex2rgb(0),uInvert:0}),f=new a.Mesh(h,m);if(t.rasterizeRenderer.render(f,{renderTexture:d}),s.set(`p${l}.rasterized.${r}`,d),i.has(`p${l}.rasterized.${r}`)){for(const e of i.get(`p${l}.rasterized.${r}`))e(d,r,l);i.delete(`p${l}.rasterized.${r}`)}}return g.Utils.rawXhr(t.fnt).then((e=>{Object.assign(n,g.ParseFont(e));for(const[e,i]of n.pages){const n=a.Texture.from(`${g.Utils.getPathFromURL(t.fnt)}${i.file}`);s.set(`p${e}.${t.type}.master`,n)}t.onload()})).catch((e=>{throw e})),{type:t.type,fontData:n,fontTextures:s,rasterize:function(e,t){for(const[i,a]of n.pages)o(s.get(`p${i}.sdf.master`),e,i,t)},setRasterizeRenderer:function(e){t.rasterizeRenderer=e}}},g.ParseFont=function(e){const t={info:{},common:{},pages:new Map,chars:new Map,kernings:new Map},n=e.split(/\r?\n/);for(let e of n){if(e=e.trim(),!e)continue;const n=e.split(" ")[0];e=e.substring(n.length+1);const s=/([a-zA-Z]+)=(".*?"|\S*?)(?:\s|$)/g,i={};let o;for(;o=s.exec(e);){const e=o[1];let s=o[2];switch(s=s.startsWith('"')?s.substring(1,s.length-1):s.includes(",")?s.split(",").map((e=>parseFloat(e))):parseFloat(s),n){case"info":t.info[e]=s;break;case"common":t.common[e]=s;break;default:i[e]=s}}switch(n){case"page":t.pages.set(i.id,i);break;case"char":t.chars.set(String.fromCharCode(i.id),i);break;case"kerning":t.kernings.set(`${String.fromCharCode(i.first)}${String.fromCharCode(i.second)}`,i)}}return t},g.LayoutText=function(e,t,n,s=1){let i=new Map;const o=n.fontData,a=[],r=[],l=[],c=[];let p=0,d=0;const h=new g.Utils.PRNG(t.misalignmentSeed||0),u=Array.isArray(t.misalignment);if(t._cache)i=g.CopyGeometry(t._cache);else{if("left"!==t.align||0!==t.anchor.x){let n=0,s=0,i=0,h=null,u=1,_=!1;for(const l of e){if(_){switch(l){case"t":case"c":case"b":break;default:u=g.Constants.modifierMapping[l]||1,_=!1}continue}if("\n"===l){a[i]=n-t.letterSpacing,r[i]=s,n=0,s=0,h=null,i++;continue}if("\f"===l){_=!0;continue}let e=o.chars.get(l);if(e||(e=o.chars.get(String.fromCharCode(0))),e){if(h){let e=o.kernings.get(`${h}${l}`);e&&(n+=e.amount*u)}n+=(e.xadvance+t.letterSpacing)*u,s++,h=l}}a[i]=n-t.letterSpacing*u,r[i]=s;const m=Math.max(...a);switch(t.align){case"center":for(const e of a)l.push((m-e)/2);break;case"right":for(const e of a)l.push(m-e);break;case"justify":for(const e of a)c.push((m-e)/Math.max(1,r.shift()-1))}p=-1*m*t.anchor.x,d=o.common.lineHeight*a.length*-1*t.anchor.y}else 0!==t.anchor.y&&(d=o.common.lineHeight*e.split("\n").length*-1*t.anchor.y);let n=0,h=0,u=0,_=null,m=1,f=!1,b="bottom";for(const a of e){if(f){switch(a){case"t":b="top";break;case"c":b="center";break;case"b":b="bottom";break;default:m=g.Constants.modifierMapping[a]||1,f=!1}continue}if("\n"===a){n=0,h+=o.common.lineHeight+t.lineSpacing,_=null,u++;continue}if("\f"===a){f=!0;continue}let e=o.chars.get(a);if(e||(e=o.chars.get(String.fromCharCode(0))),!e)continue;if(_){let e=o.kernings.get(`${_}${a}`);e&&(n+=e.amount*m)}i.has(e.page)||i.set(e.page,{i:0,vertices:[],uvs:[],indices:[]});const r=i.get(e.page);let C=((l[u]||0)+p)/m,x=d/m;1!==m&&("bottom"===b?x+=(o.common.base-m*o.common.base)/m:"center"===b&&(x+=(o.common.base-m*o.common.base)/m/2)),r.vertices.push((n+(e.xoffset+C)*m)*s,(h+(e.yoffset+x)*m)*s,(n+(e.xoffset+e.width+C)*m)*s,(h+(e.yoffset+x)*m)*s,(n+(e.xoffset+C)*m)*s,(h+(e.yoffset+e.height+x)*m)*s,(n+(e.xoffset+e.width+C)*m)*s,(h+(e.yoffset+e.height+x)*m)*s),r.uvs.push(e.x/o.common.scaleW,e.y/o.common.scaleH,(e.x+e.width)/o.common.scaleW,e.y/o.common.scaleH,e.x/o.common.scaleW,(e.y+e.height)/o.common.scaleH,(e.x+e.width)/o.common.scaleW,(e.y+e.height)/o.common.scaleH),r.indices.push(0+4*r.i,1+4*r.i,2+4*r.i,1+4*r.i,3+4*r.i,2+4*r.i),n+=(e.xadvance+t.letterSpacing)*m+(c[u]||0),r.i++,_=a}t._cache=g.CopyGeometry(i)}let _=0;for(const[,e]of i)for(let n=0;n<e.vertices.length;n+=8){const i=e.vertices[n+2]-e.vertices[n+0],o=e.vertices[n+5]-e.vertices[n+1];let a=t.overrides.get(_).theta,r=t.overrides.get(_).x,l=t.overrides.get(_).y,c=t.overrides.get(_).scale,p=t.overrides.get(_).useProjection,d=t.overrides.get(_).projection;(u||0!==t.misalignment)&&(r+=(u?t.misalignment[0]:t.misalignment)*(2*h.nextFloat()-1),l+=(u?t.misalignment[1]:t.misalignment)*(2*h.nextFloat()-1),u&&0===t.misalignment[2]||(a+=(u?t.misalignment[2]:t.misalignment)*(2*h.nextFloat()-1))),p&&(e.vertices[n+0]+=i*d[0].x,e.vertices[n+1]+=o*d[0].y,e.vertices[n+2]+=i*(d[1].x-1),e.vertices[n+3]+=o*d[1].y,e.vertices[n+4]+=i*d[2].x,e.vertices[n+5]+=o*(d[2].y-1),e.vertices[n+6]+=i*(d[3].x-1),e.vertices[n+7]+=o*(d[3].y-1)),1!==c&&(e.vertices[n+0]+=i/-2*c-i/-2,e.vertices[n+1]+=o/-2*c-o/-2,e.vertices[n+2]+=i/2*c-i/2,e.vertices[n+3]+=o/-2*c-o/-2,e.vertices[n+4]+=i/-2*c-i/-2,e.vertices[n+5]+=o/2*c-o/2,e.vertices[n+6]+=i/2*c-i/2,e.vertices[n+7]+=o/2*c-o/2),0!==a&&(e.vertices[n+0]+=i/-2*Math.cos(a)-o/-2*Math.sin(a)-i/-2,e.vertices[n+1]+=i/-2*Math.sin(a)+o/-2*Math.cos(a)-o/-2,e.vertices[n+2]+=i/2*Math.cos(a)-o/-2*Math.sin(a)-i/2,e.vertices[n+3]+=i/2*Math.sin(a)+o/-2*Math.cos(a)-o/-2,e.vertices[n+4]+=i/-2*Math.cos(a)-o/2*Math.sin(a)-i/-2,e.vertices[n+5]+=i/-2*Math.sin(a)+o/2*Math.cos(a)-o/2,e.vertices[n+6]+=i/2*Math.cos(a)-o/2*Math.sin(a)-i/2,e.vertices[n+7]+=i/2*Math.sin(a)+o/2*Math.cos(a)-o/2),0===r&&0===l||(e.vertices[n+0]+=s*r,e.vertices[n+1]+=s*l,e.vertices[n+2]+=s*r,e.vertices[n+3]+=s*l,e.vertices[n+4]+=s*r,e.vertices[n+5]+=s*l,e.vertices[n+6]+=s*r,e.vertices[n+7]+=s*l),_++}if(t.useProjection){let e=0,n=0;for(const[,t]of i)e=Math.max(e,t.vertices.reduce(((e,t,n)=>Math.max(e,n%2==0?t:0)),0)),n=Math.max(n,t.vertices.reduce(((e,t,n)=>Math.max(e,n%2==1?t:0)),0));const s=t.projection;for(const[,t]of i)for(let i=0;i<t.vertices.length;i+=2){let o=t.vertices[i]/e,a=t.vertices[i+1]/n;const r=s[0].x+(s[1].x-s[0].x)*o,l=s[0].y+(s[2].y-s[0].y)*a,c=l+(s[1].y+(s[3].y-s[1].y)*a-l)*o;t.vertices[i]=(r+(s[2].x+(s[3].x-s[2].x)*o-r)*a)*e,t.vertices[i+1]=c*n}}return i},g.CharacterOverrideMap=class extends Map{constructor(e,...t){super(...t),this._onchange=e}get(e){return super.has(e)||super.set(e,new g.CharacterOverride(this._onchange)),super.get(e)}set(e,t){const n=super.set(e,t);return this._onchange(),n}},g.CharacterOverride=class{constructor(e){this._onchange=e,this._x=0,this._y=0,this._theta=0,this._scale=1,this._useProjection=!1,this._projection=[[0,0],[1,0],[0,1],[1,1]];for(let e=0;e<4;e++)this._projection[e]=new a.ObservablePoint((()=>{this._onchange()}),this,...this._projection[e])}get x(){return this._x}set x(e){this._x=e,this._onchange()}get y(){return this._y}set y(e){this._y=e,this._onchange()}get theta(){return this._theta}set theta(e){this._theta=e,this._onchange()}get scale(){return this._scale}set scale(e){this._scale=e,this._onchange()}get useProjection(){return this._useProjection}set useProjection(e){this._useProjection=!!e,this._onchange()}get projection(){return this._projection}},g.CopyGeometry=function(e){const t=new Map;for(const[n,s]of e)t.set(n,{i:s.i,vertices:[...s.vertices],uvs:[...s.uvs],indices:[...s.indices]});return t},g.Geometrize=function(e){const t=new a.Geometry;return t.addAttribute("aVertexPosition",e.vertices,2),t.addAttribute("aTextureCoord",e.uvs,2),t.addIndex(e.indices),t},g.Constants={modifierMapping:{1:.2,2:.4,3:.6,4:.8,5:1,6:1.25,7:1.5,8:1.75,9:2}},g.Utils={rawXhr:function(e){return new Promise(((t,n)=>{const s=new XMLHttpRequest;s.open("GET",e,!0),s.onload=()=>{4===s.readyState&&t(s.responseText)},s.onerror=()=>{n(new Error("Could not create Font: could not download .fnt file"))},s.send()}))},getPathFromURL:function(e){return e.includes("/")?`${e.split("/").slice(0,-1).join("/")}/`:""},PRNG:function(e){let t=parseInt(e)%2147483647;return t<=0&&(t+=2147483646),{next:function(){return t=16807*t%2147483647},nextFloat:function(e,t){return(this.next()-1)/2147483646},shuffleArray:function(e){let t,n=e.length;if(0==n)return e;for(;--n;)t=Math.floor(this.nextFloat()*(n+1)),[e[n],e[t]]=[e[t],e[n]];return e},getCurrentSeed:function(){return t}}}},g.ShaderSources={vertex:"\n\t    attribute vec2 aVertexPosition;\n\t\tattribute vec2 aTextureCoord;\n\n\t\tuniform mat3 translationMatrix;\n\t\tuniform mat3 projectionMatrix;\n\t\tuniform float uScale;\n\n\t\tvarying vec2 vTextureCoord;\n\n\t\tvoid main(void)\n\t\t{\n\t\t    vTextureCoord = aTextureCoord;\n\t\t    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition * uScale, 1.0)).xy, 0.0, 1.0);\n\t\t}",fragment:"\n\t\tuniform sampler2D uSampler;\n\t\tuniform vec3 uTint;\n\t\tuniform float uAlpha;\n\t\tuniform float uWeight;\n\t\tuniform vec3 uOutlineTint;\n\t\tuniform float uOutlineAlpha;\n\t\tuniform float uFillAlpha;\n\t\tuniform float uOutlineWeight;\n\t\tuniform float uSharpness;\n\t\tuniform float uInvert;\n\n\t    varying vec2 vTextureCoord;\n\n\t\tvoid main(void)\n\t\t{\n\t\t\tvec4 color;\n\t\t\tfloat dist = texture2D(uSampler, vTextureCoord).a;\n\t\t\tdist = mix(dist, 1.0 - dist, uInvert);\n\n\t\t\tfloat innerAlpha = smoothstep(uWeight - uSharpness, uWeight + uSharpness, dist);\n\n\t\t\tif (uOutlineAlpha > 0.0) {\n\t\t\t\tfloat outerAlpha = smoothstep(uOutlineWeight - uSharpness, uOutlineWeight + uSharpness, dist) * uOutlineAlpha;\n\t\t\t\tvec4 outerColor = vec4(uOutlineTint, 1.0) * outerAlpha;\n\t\t\t\tvec4 innerColor = vec4(uTint, 1.0) * uFillAlpha;\n\t\t\t\tgl_FragColor = mix(outerColor, innerColor, innerAlpha) * uAlpha;\n\t\t\t} else {\n\t\t\t\tgl_FragColor = vec4(uTint, 1.0) * (innerAlpha) * uAlpha;\n\t\t\t}\n\t\t}"},g.Shader=new a.Program(g.ShaderSources.vertex,g.ShaderSources.fragment,"THEORYTYPE");const f=function(e,t){try{const i=a.Texture.from(e.img||"./kagari.png");let o,r,l,c=new a.Application({width:640,height:320,view:e.view,antialias:!1,backgroundAlpha:0,powerPreference:"high-performance",forceFXAA:!1});function n(){o=new a.Container,l=new a.Container,r=new a.ParticleContainer(void 0,{vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!0},void 0,!0),r.blendMode=a.BLEND_MODES.SCREEN,c.stage.addChild(o),c.stage.addChild(r),c.stage.addChild(l)}function s(){o.destroy(),r.destroy(),l.destroy()}n();const p=Date.now();let d="Unknown";const h=c.renderer.context.webGLVersion,u=c.renderer.gl.getExtension("WEBGL_debug_renderer_info");u&&(d=c.renderer.gl.getParameter(u.UNMASKED_RENDERER_WEBGL)||"Unknown");const _=[];let m=0,f=0,b=0,C=[];c.ticker.add((u=>{if(b++,!(b<=0)){if(1!==b&&u>=(e.cutoff||1.5)*(b%2!=0?1:4)){if(f+=u/(e.cutoff||1.5),f>=(e.fails||4)){_.push(m);let i=--e.maxcount<=0;if(!i&&e.smartstop&&_.length>=(e.mincount||1)&&_.length>=2){const e=_[_.length-1]/_[_.length-2];e>=.8&&e<=1.25&&(i=!0)}if(i){c.ticker.stop(),s(),c.destroy(!1,!0);const e=_.reduce((function(e,t){return Math.max(e,t)}));let n=0,i=0;_.forEach((t=>{let s=Math.pow(t,1.5)/Math.pow(e,1.5);n+=s,i+=t*s})),t({success:!0,feecof:Math.floor(i/n),detail:_,webglver:h,cores:navigator.hardwareConcurrency||0,memory:navigator.deviceMemory||0,renderer:d,duration:Date.now()-p})}else s(),n(),m=0,C=[],f=0,b=-3;return}}else b%2!=0&&(f=Math.max(0,f-2));if(m+=50*b/Math.max(1,u)*(e.speed||1),b%2==1){const t=2*b*(e.speed||1);for(let e=0;e<t;e++){const e=new a.Sprite(i);e.position.set(640*Math.random(),320*Math.random()),e.angle=360*Math.random(),o.addChild(e)}const n=5*b*(e.speed||1);for(let e=0;e<n;e++){const e=new a.Sprite(i);e.scale.set(.2),e.position.set(640*Math.random(),320*Math.random()),e.tint=16777215*Math.random(),r.addChild(e)}const s=.05*b*(e.speed||1);for(let t=0;t<s;t++){const n=new g.Text("KAGARI 00000",{font:e.font,fontSize:16,tint:16777215*Math.random()});n.position.set(640*Math.random(),320*Math.random()),n.angle=360*Math.random(),l.addChild(n),t%3==0&&C.push(n)}for(const e of C)e.text="KAGARI "+Math.floor(1e5*Math.random()).toString().padStart(5,"0")}}}))}catch(x){console.error(x),t({success:!1})}},b={};function C(e){const t=Object.prototype.toString.call(e);return C.cached[t]?C.cached[t]:C.cached[t]=t.substring(8,t.length-1).toLowerCase()}b.ClippableSprite=class extends a.Sprite{_clipTop=0;_clipBottom=1;calculateVertices(){if(0===this._clipTop&&1===this._clipBottom)return void super.calculateVertices();const e=this._textureID!==this._texture._updateID,t=this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID;super.calculateVertices(),e&&this._updateUVs(),t&&this._updateVertices()}_updateUVs(){if(!this.uvs)return;this.uvs=this.uvs.slice();const e=this.uvs[5]-this.uvs[1];this.uvs[5]=this.uvs[1]+this._clipBottom*e,this.uvs[1]=this.uvs[1]+this._clipTop*e,this.uvs[3]=this.uvs[1],this.uvs[7]=this.uvs[5]}_updateVertices(){if(!this.vertexData)return;const e=this.vertexData[6]-this.vertexData[0],t=this.vertexData[7]-this.vertexData[1];this.vertexData[0]+=e*this._clipTop,this.vertexData[1]+=t*this._clipTop,this.vertexData[2]+=e*this._clipTop,this.vertexData[3]+=t*this._clipTop,this.vertexData[4]-=e*(1-this._clipBottom),this.vertexData[5]-=t*(1-this._clipBottom),this.vertexData[6]-=e*(1-this._clipBottom),this.vertexData[7]-=t*(1-this._clipBottom)}get clipTop(){return this._clipTop}set clipTop(e){e=Math.min(1,Math.max(0,e)),this._clipTop!==e&&(this._clipTop=e,this._transformID=-1,this._textureID=-1)}get clipBottom(){return this._clipBottom}set clipBottom(e){e=Math.min(1,Math.max(0,e)),this._clipBottom!==e&&(this._clipBottom=e,this._transformID=-1,this._textureID=-1)}},b.Soil=class extends a.Container{_els=new Map;_layout;_textures;_y=0;_listeners={};_hasUnloadedTextures=!0;_size="2x";_layerKeys=null;_textureKeys=null;constructor(e,t,n=0,s="2x",i={}){super(),this._layout=e,this._textures=t,this._y=n,this._listeners=i,this._size=s,this._layerKeys=Object.keys(this._layout.layers),this._textureKeys=Object.keys(this._textures);for(const e of this._layerKeys){const t=this._layout.layers[e],n=new a.Container;n.x=t.x,n._pl_ready=!1,n.renderable=!1,this.addChild(n),this._els.set(`l${e}`,n)}this._setPosition(this._y)}_setPosition(e){for(const t of this._layerKeys){const n=this._layout.layers[t],s=this._els.get(`l${t}`);s.y=n.s*(e-n.at)-n.y,s.renderable=s.y>-this._layout.margins.top&&s.y-n.h<this._layout.margins.btm,s.renderable&&(s._pl_ready||this._createLayer(t),this._updateLayer(t,e))}for(const t of this._textureKeys)this._textures[t][2]<=e&&!this._els.has(`t${t}`)&&this._provisionTexture(t)}_provisionTexture(e){const t=a.Texture.from(this._textures[e][0]);t.defaultAnchor.set(0,1),t._pl_scale={"4x":1,"2x":2,"1x":4,hx:8}[this._size],this._els.set(`t${e}`,t);const n=()=>{if(!this._hasUnloadedTextures)return;let e=!0;for(const t of this._layerKeys){const n=this._els.get(`l${t}`);if(n.renderable){for(const t of n.children)if(t.renderable&&!t.texture.baseTexture.valid){e=!1;break}if(!e)break}}e&&(this._hasUnloadedTextures=!1,this._listeners.loaded?.())};return t.baseTexture.valid?n():t.baseTexture.on("loaded",n),t}_createLayer(e){const t=this._layout.layers[e],n=this._els.get(`l${e}`);for(const e of t.panels[this._size]){const t=this._els.get(`t${e[0]}`)??this._provisionTexture(e[0]),s=new b.ClippableSprite(t);s.position.set(e[1],-e[2]),s.scale.set(t._pl_scale),s.renderable=!1,s._pl_texsize=this._textures[e[0]][1],n.addChild(s)}n._pl_ready=!0}_updateLayer(e,t){const n=this._layout.layers[e],s=this._els.get(`l${e}`);let i=null,o=null;n.masks?.top&&(i=n.masks.top.s*(t-n.masks.top.at)-n.masks.top.y-s.y),n.masks?.btm&&(o=n.masks.btm.s*(t-n.masks.btm.at)-n.masks.btm.y-s.y);for(const e of s.children){const t=s.y+e.y;e.renderable=t>-this._layout.margins.top&&t-e._pl_texsize<this._layout.margins.btm,e.renderable&&null!==i&&(e.clipTop=(i-(e.y-e._pl_texsize))/e._pl_texsize),e.renderable&&null!==o&&(e.clipBottom=(o-(e.y-e._pl_texsize))/e._pl_texsize),!e.renderable||this._hasUnloadedTextures||e.texture.baseTexture.valid||(this._hasUnloadedTextures=!0,this._listeners.loading?.())}}get y(){return this._y}set y(e){e!==this._y&&(this._y=e,this._setPosition(this._y))}},C.cached={};class x{constructor(e){this._seed=e%2147483647,this._seed<=0&&(this._seed+=2147483646,this._seed=this._seed||1)}get seed(){return this._seed}next(){return this._seed=16807*this._seed%2147483647}nextFloat(){return(this.next()-1)/2147483646}shuffleArray(e){let t,n=e.length;if(0==n)return e;for(;--n;)t=Math.floor(this.nextFloat()*(n+1)),[e[n],e[t]]=[e[t],e[n]];return e}}const A=19,y=11,v=new Map,B=function(e,t={}){const n={W:10,H:20,B:20,T:40,Wh:5,Hh:10,get id(){return this.gsm.setoptions.gameid}};n.gsm=new G(n),n.cm=new D(n),n.c=new E(n),n.elm=new R(n),n.iom=new V(n,t.socket),n.esm=new P(n,e,t.replay),n.bm=new I(n),n.fm=new W(n),n.im=new K(n),n.gem=new U(n),n.hm=new q(n),n.sdm=new re(n),n.pm=new te(n),n.lm=new Y(n),n.otm=new ee(n),n.stm=new ce(n),n.ctm=new O(n),n.pbm=new ne(n),n.ssm=new ae(n),n.dsm=new H(n),n.znm=new _e(n),n.svm=new pe(n),n.rbm=new se(n),n.gom=new j(n),n.bam=new T(n),n.lcm=new Q(n),n.atm=new z(n),n.wfm=new ue(n),n.fim=new $(n),n.spm=new oe(n),n.sfx=new ie(n),n.gpm=new X(n),n.fxm=new N(n),n.mam=new J(n),n.bhm=new M(n),n.siom=new le(n),n.stam=new ge(n),n.um=new he(n),n.tm=new de(n),n.mm=new Z(n),n.zthm=new me(n),n.am=new F(n);const s={get id(){return n.id},get options(){return n.gsm.setoptions},get replay(){return n.iom.replay},get source(){return n.esm},get fire(){return n.gsm.fire},createGameHolder:function(e){n.hm.SetDisplayMode(e),n.hm.CreateHolder(),fs(!1)},getPos:function(){return n.iom.IsHeadless()?{pos:{x:(window.innerWidth+200)*Math.random()-100,y:window.innerHeight/2-As(400)+Math.random()*As(800)},scale:.2,isFallback:!0}:{pos:wl(n.hm.H.stackobj,As(Ol.x*n.Wh),As(Ol.x*n.Hh),n.hm.H.holderstate.cos),scale:n.hm.S()}},getPosTransformed:function(){return{pos:Bl(n.hm.H.stackobj,As(Ol.x*n.Wh),As(Ol.x*n.Hh)),scale:n.hm.S()}},getDisplayMode:function(){return n.hm.H.displaymode},getGameTime:function(){return n.lm.GetGameTime()},getFrame:function(){return n.esm.frame},getReplayFrame:function(){return n.iom.replay.frame},getStrategy:function(){return n.gsm.diyusi},getTargets:function(){return n.tm.GetTargets()},getEnemies:function(){return n.gsm.enemies},getOwner:function(){return n.gsm.setoptions.username},getDuoOptions:function(){return{enabled:!!n.gsm.setoptions.zenith_duo,ally:{id:n.gsm.setoptions.zenith_ally?.[0],username:n.gsm.setoptions.zenith_ally?.[1]}}},getHolderData:function(){return n.hm.H},updateDuoSide:function(e,t=!1){const s=t&&n.hm.H.duoSideLock!==e;n.hm.H.duoSideLock=e,s&&n.hm.CreateHolder()},getLastAttacker:function(){return n.gsm.killer.gameid},isHeadless:function(){return n.iom.IsHeadless()},isStarted:function(){return n.gsm.started},isPlaying:()=>n.gsm.playing,flushCanvases:function(){n.c.IsServer()||n.hm.CreateHolder()},bindRollingReplay:function(e){n.iom.replay.BindRollingTarget(e)},setGame:function(e,t){n.stam.SetConstants(t),n.stam.SetOptions(e),n.iom.replay.SetOptions(n.stam.gameOptions),n.esm.gameid=n.gsm.setoptions.gameid},setManualTarget(e){n.esm.Push("manual_target",e)},setStrategy(e){n.esm.Push("strategy",e)},setHeadless(e){n.iom.SetHeadless(e)},setSynced(e){n.iom.synced=e},getTargetAllowed:()=>n.tm.IsEnabled(),startGame:function(){return n.stam.StartGame()},spectateGame:function(){return n.stam.SpectateGame()},export:function(){return n.siom.Export()},end:function(e="drop"){n.gom.GameOver(e,!0)},endNow:function(){n.gom.GameOver("dropnow",!0)},endLose:function(e=!1){e&&n.atm.TakeAllDamage(!0),n.gom.GameOver("topout",!0)},endWin:function(){n.gom.GameOver("winner",!0)},endClear:function(){n.gom.GameOver("clear",!0)},queueEnd:function(e,t=!1,s=void 0,i=void 0){if(n.gsm.endqueued)return;n.gsm.endqueued=!0;let o=!1;const a=()=>{o||(o=!0,t&&n.atm.TakeAllDamage(!0),void 0!==s&&(n.gsm.fire=s),void 0!==i&&(n.gsm.killer=i),n.gom.GameOver(e,!0))};if(!n.iom.IsScoped())return void a();let r=!1;const l=()=>{0!==n.esm.AmountToCatchUp()?(r=!1,n.wfm.WaitFramesUnsafe(1,(()=>{l()}))):r?a():(r=!0,setTimeout(l,200))};l(),setTimeout(a,1e3)},destroy:function(){n.esm.Destroy(),n.gom.Destroy()},behead:function(){n.hm.Behead()},fadeOutAndBehead:function(e){n.hm.FadeOutAndBehead(e)},rehead:function(e=!1){n.hm.Rehead(e)},doFrame:function(){n.c.IsServer()&&n.lm.DoFrame()},doAllFrames(){if(!n.c.IsServer())return;const e=n.esm.replay.GetEndEventFrame()??0;for(let t=0;n.gsm.playing&&t<=e+1;t++)n.lm.DoFrame()},advanceFrames:function(e,t){n.lm.AdvanceFrames(e,t),t&&!n.c.IsServer()&&n.pbm.ForceUpdateGarbageBar("impending")},playbackSpeed:function(e){if(void 0===e)return n.lm.H.playbackSpeed;n.lm.H.playbackSpeed=e},location:function(e,t,s,i=!1){n.hm.H.holderstate.ox=e,n.hm.H.holderstate.oy=t,n.hm.H.holderstate.os=s,i&&(n.hm.H.holderstate.cox=e,n.hm.H.holderstate.coy=t,n.hm.H.holderstate.cos=s,n.hm.H.holderneedsrepull=!0)},playZoomInto:function(e){return n.stam.PlayZoomInto(e)},isSynced:function(){return n.iom.synced},isScoped:function(){return n.iom.scoped},changeDisplayMode:function(e){n.hm.H.displaymode!==e&&(n.hm.SetDisplayMode(e),n.hm.CreateHolder(),n.lm.H.diter=n.lm.H.cheekystep-1)},emit:function(...e){n.elm.emit(...e)},on:function(...e){n.elm.on(...e)},once:function(...e){n.elm.once(...e)},remove:function(...e){n.elm.remove(...e)},exportListeners:function(){return n.elm.Export()},importListeners:function(e){return n.elm.Import(e)},tamper:function(e=["t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t"]){n.gsm.bag=e},setTargeted:function(e){n.tm.SetTargeted(!!e)},setEnemy:function(e){n.tm.SetEnemy(!!e)},setB2BDistance:function(e){n.tm.SetB2BDistance(e)},highest:function(){return n.bm.HighestLine()},garbagestats:function(){return{garbagereceived:n.gsm.garbagereceived}},displayOffDef:function(e,t,s,i,o=!1){e&&n.hm.H.board.fx("popup_offence").create(e,{x:s,y:i,evasive:o}),t&&n.hm.H.board.fx("popup_defense").create(t,{x:s,y:i,evasive:o})},updatePlacement:function(e){n.mam.SetPlacement(e)},loadZenConfig:function(){n.znm.LoadZenConfig()},pullZenConfig:function(){n.znm.UpdateFromZenConfig()},fetchZenConfig:function(){return n.znm.GetZenConfig()},levelZen:function(){n.znm.ZenLevelup()},awaitFrame:function(e){return new Promise((t=>{if(n.esm.frame>=e)return t();n.wfm.WaitFramesUnsafe(Math.max(1,e-n.esm.frame),t)}))},ejectState:function(){return n.siom.EjectState()},overlayState:function(e){n.siom.OverlayState(e)},injectState:function(e){n.siom.InjectState(e),n.esm.Seek(e.frame),n.iom.replay?.Seek(e.frame)},ejectBoardState:function(){return n.siom.EjectBoardState()},injectBoardState:function(e){n.siom.InjectBoardState(e)},requestState:function(){n.iom.RequestState()},getBoard:function(){return n.hm.H.board},getHolder:function(){return n.hm.H.holder},doCustomEvent:function(e,t){n.gem.DoCustomEvents({type:e,data:t})},recolorForAltitude:function(e){return n.zthm.RecolorForAltitude(e)},duoSetPrompts:function(e,t){return n.zthm.VisualSetPrompts(e,t)},duoSetPromptProgress:function(e){return n.zthm.VisualSetPromptProgress(e)},isAllyIncapacitated:function(){return n.gsm.zenith.allyincapacitated},getAchievements:function(){return n.rbm.GetAchievements()},getZenithAltitude:function(){return n.gsm.stats.zenith.altitude},setZenithAltitude:function(e){n.iom.synced||(n.gsm.stats.zenith.altitude=e)},getZenithSpeedrunState:function(){return{state:n.gsm.stats.zenith.speedrun?10===n.gsm.stats.zenith.floor?"win":"on":"off",splits:n.gsm.stats.zenith.splits,time:n.lm.GetGameTime(),floor:n.gsm.stats.zenith.floor,progress:(n.gsm.stats.zenith.altitude-me.FloorDistance[n.gsm.stats.zenith.floor-1])/(me.FloorDistance[n.gsm.stats.zenith.floor]-me.FloorDistance[n.gsm.stats.zenith.floor-1])}},setZenithRhythmBlast:function(e){n.hm.H.rhythmBlast=e},getState:function(){return n.gsm}};return n.parent=s,s};class w{constructor(e){this.self=e}get S(){return this.self.gsm}get W(){return this.S.setoptions.boardwidth}get H(){return this.S.setoptions.boardheight}get B(){return this.S.setoptions.boardbuffer}get T(){return this.B+this.H}get Wh(){return this.W/2}get Hh(){return this.H/2}get sfx(){return this.self.sfx}get id(){return this.S.setoptions.gameid}get socket(){return this.self.iom.socket}get options(){return this.S.setoptions}OnClient(e){this.self.c.OnClient(e)}IsServer(...e){return this.self.c.IsServer(...e)}emit(...e){return this.self.elm.emit(...e)}}const L={minotypes:["z","l","o","s","i","j","t"],minocolors:["z","l","o","s","i","j","t","g","d","gb","gbd"],tetrominoes:{i1:{matrix:{w:1,h:1,dx:0,dy:1,data:[[[0,0,255]],[[0,0,255]],[[0,0,255]],[[0,0,255]]]},preview:{w:1,h:1,data:[[0,0,255]]},disallow_kick:!0},i2:{matrix:{w:2,h:2,dx:0,dy:1,data:[[[0,0,199],[1,0,124]],[[1,0,241],[1,1,31]],[[1,1,124],[0,1,199]],[[0,1,31],[0,0,241]]]},preview:{w:2,h:1,data:[[0,0,199],[1,0,124]]},kickset_special:"i2"},i3:{matrix:{w:3,h:3,dx:1,dy:1,data:[[[0,1,199],[1,1,68],[2,1,124]],[[1,0,241],[1,1,17],[1,2,31]],[[2,1,124],[1,1,68],[0,1,199]],[[1,2,31],[1,1,17],[1,0,241]]]},preview:{w:3,h:1,data:[[0,0,199],[1,0,68],[2,0,124]]},kickset_special:"i3"},l3:{matrix:{w:2,h:2,dx:0,dy:1,data:[[[0,0,241],[0,1,39],[1,1,124]],[[1,0,124],[0,0,201],[0,1,31]],[[1,1,31],[1,0,114],[0,0,199]],[[0,1,199],[1,1,156],[1,0,241]]]},preview:{w:2,h:2,data:[[0,0,241],[0,1,39],[1,1,124]]},kickset_special:"l3"},i5:{matrix:{w:5,h:5,dx:2,dy:2,data:[[[0,2,199],[1,2,68],[2,2,68],[3,2,68],[4,2,124]],[[2,0,241],[2,1,17],[2,2,17],[2,3,17],[2,4,31]],[[4,2,124],[3,2,68],[2,2,68],[1,2,68],[0,2,199]],[[2,4,31],[2,3,17],[2,2,17],[2,1,17],[2,0,241]]]},preview:{w:5,h:1,data:[[0,0,199],[1,0,68],[2,0,68],[3,0,68],[4,0,124]]},kickset_special:"i5"},z:{matrix:{w:3,h:3,dx:1,dy:1,data:[[[0,0,199],[1,0,114],[1,1,39],[2,1,124]],[[2,0,241],[2,1,156],[1,1,201],[1,2,31]],[[2,2,124],[1,2,39],[1,1,114],[0,1,199]],[[0,2,31],[0,1,201],[1,1,156],[1,0,241]]]},preview:{w:3,h:2,data:[[0,0,199],[1,0,114],[1,1,39],[2,1,124]]}},l:{matrix:{w:3,h:3,dx:1,dy:1,data:[[[2,0,241],[0,1,199],[1,1,68],[2,1,156]],[[2,2,124],[1,0,241],[1,1,17],[1,2,39]],[[0,2,31],[2,1,124],[1,1,68],[0,1,201]],[[0,0,199],[1,2,31],[1,1,17],[1,0,114]]]},preview:{w:3,h:2,data:[[2,0,241],[0,1,199],[1,1,68],[2,1,156]]}},o:{matrix:{w:2,h:2,dx:0,dy:1,data:[[[0,0,193],[1,0,112],[0,1,7],[1,1,28]],[[1,0,112],[1,1,28],[0,0,193],[0,1,7]],[[1,1,28],[0,1,7],[1,0,112],[0,0,193]],[[0,1,7],[0,0,193],[1,1,28],[1,0,112]]]},preview:{w:2,h:2,data:[[0,0,193],[1,0,112],[0,1,7],[1,1,28]]},disallow_kick:!0},s:{matrix:{w:3,h:3,dx:1,dy:1,data:[[[1,0,201],[2,0,124],[0,1,199],[1,1,156]],[[2,1,114],[2,2,31],[1,0,241],[1,1,39]],[[1,2,156],[0,2,199],[2,1,124],[1,1,201]],[[0,1,39],[0,0,241],[1,2,31],[1,1,114]]]},preview:{w:3,h:2,data:[[1,0,201],[2,0,124],[0,1,199],[1,1,156]]}},i:{matrix:{w:4,h:4,dx:1,dy:1,data:[[[0,1,199],[1,1,68],[2,1,68],[3,1,124]],[[2,0,241],[2,1,17],[2,2,17],[2,3,31]],[[3,2,124],[2,2,68],[1,2,68],[0,2,199]],[[1,3,31],[1,2,17],[1,1,17],[1,0,241]]]},preview:{w:4,h:1,data:[[0,0,199],[1,0,68],[2,0,68],[3,0,124]]},kickset_special:"i"},j:{matrix:{w:3,h:3,dx:1,dy:1,data:[[[0,0,241],[0,1,39],[1,1,68],[2,1,124]],[[2,0,124],[1,0,201],[1,1,17],[1,2,31]],[[2,2,31],[2,1,114],[1,1,68],[0,1,199]],[[0,2,199],[1,2,156],[1,1,17],[1,0,241]]]},preview:{w:3,h:2,data:[[0,0,241],[0,1,39],[1,1,68],[2,1,124]]}},t:{matrix:{w:3,h:3,dx:1,dy:1,data:[[[1,0,241],[0,1,199],[1,1,164],[2,1,124]],[[2,1,124],[1,0,241],[1,1,41],[1,2,31]],[[1,2,31],[2,1,124],[1,1,74],[0,1,199]],[[0,1,199],[1,2,31],[1,1,146],[1,0,241]]]},preview:{w:3,h:2,data:[[1,0,241],[0,1,199],[1,1,164],[2,1,124]]}},oo:{matrix:{w:4,h:4,dx:1,dy:1,data:[[[0,1,193],[1,1,64],[2,1,64],[3,1,112],[0,2,7],[1,2,4],[2,2,4],[3,2,28]],[[2,0,112],[2,1,16],[2,2,16],[2,3,28],[1,0,193],[1,1,1],[1,2,1],[1,3,7]],[[3,2,28],[2,2,68],[1,2,68],[0,2,7],[3,1,112],[2,1,64],[1,1,64],[0,1,193]],[[1,3,7],[1,2,1],[1,1,1],[1,0,193],[2,3,28],[2,2,16],[2,1,16],[2,0,112]]]},preview:{w:4,h:2,data:[[0,0,193],[1,0,64],[2,0,64],[3,0,112],[0,1,7],[1,1,4],[2,1,4],[3,1,28]]},kickset_special:"oo",weight:1}},tetrominoes_color:{i1:"i",i2:"i",i3:"i",l3:"j",i5:"i",z:"z",l:"l",o:"o",s:"s",i:"i",j:"j",t:"t",oo:"o",g:"g",d:"d",gb:"gb",gbd:"gbd"},spinbonuses_rules:{none:{},stupid:{types:["i1","i2","i3","l3","i5","z","l","o","s","i","j","t","oo"],types_mini:["t"]},all:{types:["i1","i2","i3","l3","i5","z","l","o","s","i","j","t","oo"],types_mini:["t"]},"all-mini":{types:["i1","i2","i3","l3","i5","z","l","o","s","i","j","t","oo"],types_mini:["t"]},handheld:{types:["t","s","z","l","j"],types_mini:["t"]},"T-spins":{types:["t"],types_mini:["t"]}},kicksets:{SRS:{kicks:{"01":[[-1,0],[-1,-1],[0,2],[-1,2]],10:[[1,0],[1,1],[0,-2],[1,-2]],12:[[1,0],[1,1],[0,-2],[1,-2]],21:[[-1,0],[-1,-1],[0,2],[-1,2]],23:[[1,0],[1,-1],[0,2],[1,2]],32:[[-1,0],[-1,1],[0,-2],[-1,-2]],30:[[-1,0],[-1,1],[0,-2],[-1,-2]],"03":[[1,0],[1,-1],[0,2],[1,2]],"02":[[0,-1],[1,-1],[-1,-1],[1,0],[-1,0]],13:[[1,0],[1,-2],[1,-1],[0,-2],[0,-1]],20:[[0,1],[-1,1],[1,1],[-1,0],[1,0]],31:[[-1,0],[-1,-2],[-1,-1],[0,-2],[0,-1]]},i_kicks:{"01":[[-2,0],[1,0],[-2,1],[1,-2]],10:[[2,0],[-1,0],[2,-1],[-1,2]],12:[[-1,0],[2,0],[-1,-2],[2,1]],21:[[1,0],[-2,0],[1,2],[-2,-1]],23:[[2,0],[-1,0],[2,-1],[-1,2]],32:[[-2,0],[1,0],[-2,1],[1,-2]],30:[[1,0],[-2,0],[1,2],[-2,-1]],"03":[[-1,0],[2,0],[-1,-2],[2,1]],"02":[],13:[],20:[],31:[]},i2_kicks:{"01":[[0,-1],[-1,0],[-1,-1]],10:[[0,1],[1,0],[1,1]],12:[[1,0],[0,-1],[1,0]],21:[[-1,0],[0,1],[-1,0]],23:[[0,1],[1,0],[1,-1]],32:[[0,-1],[-1,0],[-1,1]],30:[[-1,0],[0,1],[-1,2]],"03":[[1,0],[0,-1],[1,-2]],"02":[],13:[],20:[],31:[]},i3_kicks:{"01":[[1,0],[-1,0],[0,1],[0,-1]],10:[[-1,0],[1,0],[0,-1],[0,1]],12:[[1,0],[-1,0],[0,-2],[0,2]],21:[[-1,0],[1,0],[0,2],[0,-2]],23:[[-1,0],[1,0],[0,1],[0,-1]],32:[[1,0],[-1,0],[0,-1],[0,1]],30:[[-1,0],[1,0],[0,0],[0,0]],"03":[[1,0],[-1,0],[0,0],[0,0]],"02":[],13:[],20:[],31:[]},l3_kicks:{"01":[[-1,0],[1,0]],10:[[1,0],[-1,0]],12:[[0,-1],[0,1]],21:[[0,1],[0,-1]],23:[[1,0],[-1,0]],32:[[-1,0],[1,0]],30:[[0,1],[0,-1]],"03":[[0,-1],[0,1]],"02":[],13:[],20:[],31:[]},i5_kicks:{"01":[[-2,0],[2,0],[-2,1],[2,-2]],10:[[2,0],[-2,0],[2,-1],[-2,2]],12:[[-2,0],[2,0],[-2,-2],[2,1]],21:[[2,0],[-2,0],[2,2],[-2,-1]],23:[[2,0],[-2,0],[2,-1],[-2,2]],32:[[-2,0],[2,0],[-2,1],[2,-2]],30:[[2,0],[-2,0],[2,2],[-2,-1]],"03":[[-2,0],[2,0],[-2,-2],[2,1]],"02":[],13:[],20:[],31:[]},oo_kicks:{"01":[[0,-1],[-1,-1],[0,1],[-1,1],[1,0],[1,-1],[1,1]],10:[[1,0],[0,-1],[1,1],[1,-1],[-1,0],[-1,-1],[-1,1]],12:[[-1,0],[0,-1],[-1,1],[-1,-1],[1,0],[1,-1],[1,1]],21:[[0,-1],[1,-1],[0,1],[1,1],[-1,0],[-1,-1],[-1,1]],23:[[0,-1],[-1,-1],[0,1],[-1,1],[1,0],[1,-1],[1,1]],32:[[1,0],[0,-1],[1,1],[1,-1],[-1,0],[-1,-1],[-1,1]],30:[[-1,0],[0,-1],[-1,1],[-1,-1],[1,0],[1,-1],[1,1]],"03":[[0,-1],[1,-1],[0,1],[1,1],[-1,0],[-1,-1],[-1,1]],"02":[[0,-1]],13:[[1,0]],20:[[0,1]],31:[[-1,0]]},additional_offsets:{},spawn_rotation:{},color_overrides:{},preview_overrides:{}},"SRS+":{kicks:{"01":[[-1,0],[-1,-1],[0,2],[-1,2]],10:[[1,0],[1,1],[0,-2],[1,-2]],12:[[1,0],[1,1],[0,-2],[1,-2]],21:[[-1,0],[-1,-1],[0,2],[-1,2]],23:[[1,0],[1,-1],[0,2],[1,2]],32:[[-1,0],[-1,1],[0,-2],[-1,-2]],30:[[-1,0],[-1,1],[0,-2],[-1,-2]],"03":[[1,0],[1,-1],[0,2],[1,2]],"02":[[0,-1],[1,-1],[-1,-1],[1,0],[-1,0]],13:[[1,0],[1,-2],[1,-1],[0,-2],[0,-1]],20:[[0,1],[-1,1],[1,1],[-1,0],[1,0]],31:[[-1,0],[-1,-2],[-1,-1],[0,-2],[0,-1]]},i_kicks:{"01":[[1,0],[-2,0],[-2,1],[1,-2]],10:[[-1,0],[2,0],[-1,2],[2,-1]],12:[[-1,0],[2,0],[-1,-2],[2,1]],21:[[-2,0],[1,0],[-2,-1],[1,2]],23:[[2,0],[-1,0],[2,-1],[-1,2]],32:[[1,0],[-2,0],[1,-2],[-2,1]],30:[[1,0],[-2,0],[1,2],[-2,-1]],"03":[[-1,0],[2,0],[2,1],[-1,-2]],"02":[[0,-1]],13:[[1,0]],20:[[0,1]],31:[[-1,0]]},i2_kicks:{"01":[[0,-1],[-1,0],[-1,-1]],10:[[0,1],[1,0],[1,1]],12:[[1,0],[0,-1],[1,0]],21:[[-1,0],[0,1],[-1,0]],23:[[0,1],[1,0],[1,-1]],32:[[0,-1],[-1,0],[-1,1]],30:[[-1,0],[0,1],[-1,2]],"03":[[1,0],[0,-1],[1,-2]],"02":[],13:[],20:[],31:[]},i3_kicks:{"01":[[1,0],[-1,0],[0,1],[0,-1]],10:[[-1,0],[1,0],[0,-1],[0,1]],12:[[1,0],[-1,0],[0,-2],[0,2]],21:[[-1,0],[1,0],[0,2],[0,-2]],23:[[-1,0],[1,0],[0,1],[0,-1]],32:[[1,0],[-1,0],[0,-1],[0,1]],30:[[-1,0],[1,0],[0,0],[0,0]],"03":[[1,0],[-1,0],[0,0],[0,0]],"02":[],13:[],20:[],31:[]},l3_kicks:{"01":[[-1,0],[1,0]],10:[[1,0],[-1,0]],12:[[0,-1],[0,1]],21:[[0,1],[0,-1]],23:[[1,0],[-1,0]],32:[[-1,0],[1,0]],30:[[0,1],[0,-1]],"03":[[0,-1],[0,1]],"02":[],13:[],20:[],31:[]},i5_kicks:{"01":[[-2,0],[2,0],[-2,1],[2,-2]],10:[[2,0],[-2,0],[2,-1],[-2,2]],12:[[-2,0],[2,0],[-2,-2],[2,1]],21:[[2,0],[-2,0],[2,2],[-2,-1]],23:[[2,0],[-2,0],[2,-1],[-2,2]],32:[[-2,0],[2,0],[-2,1],[2,-2]],30:[[2,0],[-2,0],[2,2],[-2,-1]],"03":[[-2,0],[2,0],[-2,-2],[2,1]],"02":[],13:[],20:[],31:[]},oo_kicks:{"01":[[0,-1],[-1,-1],[0,1],[-1,1],[1,0],[1,-1],[1,1]],10:[[1,0],[0,-1],[1,1],[1,-1],[-1,0],[-1,-1],[-1,1]],12:[[-1,0],[0,-1],[-1,1],[-1,-1],[1,0],[1,-1],[1,1]],21:[[0,-1],[1,-1],[0,1],[1,1],[-1,0],[-1,-1],[-1,1]],23:[[0,-1],[-1,-1],[0,1],[-1,1],[1,0],[1,-1],[1,1]],32:[[1,0],[0,-1],[1,1],[1,-1],[-1,0],[-1,-1],[-1,1]],30:[[-1,0],[0,-1],[-1,1],[-1,-1],[1,0],[1,-1],[1,1]],"03":[[0,-1],[1,-1],[0,1],[1,1],[-1,0],[-1,-1],[-1,1]],"02":[[0,-1]],13:[[1,0]],20:[[0,1]],31:[[-1,0]]},additional_offsets:{},spawn_rotation:{},color_overrides:{},preview_overrides:{}},"SRS-X":{kicks:{"01":[[-1,0],[-1,-1],[0,2],[-1,2]],10:[[1,0],[1,1],[0,-2],[1,-2]],12:[[1,0],[1,1],[0,-2],[1,-2]],21:[[-1,0],[-1,-1],[0,2],[-1,2]],23:[[1,0],[1,-1],[0,2],[1,2]],32:[[-1,0],[-1,1],[0,-2],[-1,-2]],30:[[-1,0],[-1,1],[0,-2],[-1,-2]],"03":[[1,0],[1,-1],[0,2],[1,2]],"02":[[1,0],[2,0],[1,1],[2,1],[-1,0],[-2,0],[-1,1],[-2,1],[0,-1],[3,0],[-3,0]],13:[[0,1],[0,2],[-1,1],[-1,2],[0,-1],[0,-2],[-1,-1],[-1,-2],[1,0],[0,3],[0,-3]],20:[[-1,0],[-2,0],[-1,-1],[-2,-1],[1,0],[2,0],[1,-1],[2,-1],[0,1],[-3,0],[3,0]],31:[[0,1],[0,2],[1,1],[1,2],[0,-1],[0,-2],[1,-1],[1,-2],[-1,0],[0,3],[0,-3]]},i_kicks:{"01":[[-2,0],[1,0],[-2,1],[1,-2]],10:[[2,0],[-1,0],[2,-1],[-1,2]],12:[[-1,0],[2,0],[-1,-2],[2,1]],21:[[1,0],[-2,0],[1,2],[-2,-1]],23:[[2,0],[-1,0],[2,-1],[-1,2]],32:[[-2,0],[1,0],[-2,1],[1,-2]],30:[[1,0],[-2,0],[1,2],[-2,-1]],"03":[[-1,0],[2,0],[-1,-2],[2,1]],"02":[[-1,0],[-2,0],[1,0],[2,0],[0,1]],13:[[0,1],[0,2],[0,-1],[0,-2],[-1,0]],20:[[1,0],[2,0],[-1,0],[-2,0],[0,-1]],31:[[0,1],[0,2],[0,-1],[0,-2],[1,0]]},i2_kicks:{"01":[[0,-1],[-1,0],[-1,-1]],10:[[0,1],[1,0],[1,1]],12:[[1,0],[0,-1],[1,0]],21:[[-1,0],[0,1],[-1,0]],23:[[0,1],[1,0],[1,-1]],32:[[0,-1],[-1,0],[-1,1]],30:[[-1,0],[0,1],[-1,2]],"03":[[1,0],[0,-1],[1,-2]],"02":[[-1,0],[-2,0],[1,0],[2,0],[0,1]],13:[[0,1],[0,2],[0,-1],[0,-2],[-1,0]],20:[[1,0],[2,0],[-1,0],[-2,0],[0,-1]],31:[[0,1],[0,2],[0,-1],[0,-2],[1,0]]},i3_kicks:{"01":[[1,0],[-1,0],[0,1],[0,-1]],10:[[-1,0],[1,0],[0,-1],[0,1]],12:[[1,0],[-1,0],[0,-2],[0,2]],21:[[-1,0],[1,0],[0,2],[0,-2]],23:[[-1,0],[1,0],[0,1],[0,-1]],32:[[1,0],[-1,0],[0,-1],[0,1]],30:[[-1,0],[1,0],[0,0],[0,0]],"03":[[1,0],[-1,0],[0,0],[0,0]],"02":[[1,0],[2,0],[1,1],[2,1],[-1,0],[-2,0],[-1,1],[-2,1],[0,-1],[3,0],[-3,0]],13:[[0,1],[0,2],[-1,1],[-1,2],[0,-1],[0,-2],[-1,-1],[-1,-2],[1,0],[0,3],[0,-3]],20:[[-1,0],[-2,0],[-1,-1],[-2,-1],[1,0],[2,0],[1,-1],[2,-1],[0,1],[-3,0],[3,0]],31:[[0,1],[0,2],[1,1],[1,2],[0,-1],[0,-2],[1,-1],[1,-2],[-1,0],[0,3],[0,-3]]},l3_kicks:{"01":[[-1,0],[1,0]],10:[[1,0],[-1,0]],12:[[0,-1],[0,1]],21:[[0,1],[0,-1]],23:[[1,0],[-1,0]],32:[[-1,0],[1,0]],30:[[0,1],[0,-1]],"03":[[0,-1],[0,1]],"02":[[1,0],[2,0],[1,1],[2,1],[-1,0],[-2,0],[-1,1],[-2,1],[0,-1],[3,0],[-3,0]],13:[[0,1],[0,2],[-1,1],[-1,2],[0,-1],[0,-2],[-1,-1],[-1,-2],[1,0],[0,3],[0,-3]],20:[[-1,0],[-2,0],[-1,-1],[-2,-1],[1,0],[2,0],[1,-1],[2,-1],[0,1],[-3,0],[3,0]],31:[[0,1],[0,2],[1,1],[1,2],[0,-1],[0,-2],[1,-1],[1,-2],[-1,0],[0,3],[0,-3]]},i5_kicks:{"01":[[-2,0],[2,0],[-2,1],[2,-2]],10:[[2,0],[-2,0],[2,-1],[-2,2]],12:[[-2,0],[2,0],[-2,-2],[2,1]],21:[[2,0],[-2,0],[2,2],[-2,-1]],23:[[2,0],[-2,0],[2,-1],[-2,2]],32:[[-2,0],[2,0],[-2,1],[2,-2]],30:[[2,0],[-2,0],[2,2],[-2,-1]],"03":[[-2,0],[2,0],[-2,-2],[2,1]],"02":[[1,0],[2,0],[1,1],[2,1],[-1,0],[-2,0],[-1,1],[-2,1],[0,-1],[3,0],[-3,0]],13:[[0,1],[0,2],[-1,1],[-1,2],[0,-1],[0,-2],[-1,-1],[-1,-2],[1,0],[0,3],[0,-3]],20:[[-1,0],[-2,0],[-1,-1],[-2,-1],[1,0],[2,0],[1,-1],[2,-1],[0,1],[-3,0],[3,0]],31:[[0,1],[0,2],[1,1],[1,2],[0,-1],[0,-2],[1,-1],[1,-2],[-1,0],[0,3],[0,-3]]},oo_kicks:{"01":[[0,-1],[-1,-1],[0,1],[-1,1],[1,0],[1,-1],[1,1]],10:[[1,0],[0,-1],[1,1],[1,-1],[-1,0],[-1,-1],[-1,1]],12:[[-1,0],[0,-1],[-1,1],[-1,-1],[1,0],[1,-1],[1,1]],21:[[0,-1],[1,-1],[0,1],[1,1],[-1,0],[-1,-1],[-1,1]],23:[[0,-1],[-1,-1],[0,1],[-1,1],[1,0],[1,-1],[1,1]],32:[[1,0],[0,-1],[1,1],[1,-1],[-1,0],[-1,-1],[-1,1]],30:[[-1,0],[0,-1],[-1,1],[-1,-1],[1,0],[1,-1],[1,1]],"03":[[0,-1],[1,-1],[0,1],[1,1],[-1,0],[-1,-1],[-1,1]],"02":[[0,-1]],13:[[1,0]],20:[[0,1]],31:[[-1,0]]},additional_offsets:{},spawn_rotation:{},color_overrides:{},preview_overrides:{}},"TETRA-X":{kicks:{"01":[[0,1],[-1,0],[1,0],[-1,1],[1,1],[0,-1],[-1,-1],[1,-1]],10:[[0,1],[1,0],[-1,0],[1,1],[-1,1],[0,-1],[1,-1],[-1,-1]],12:[[0,1],[-1,0],[1,0],[-1,1],[1,1],[0,-1],[-1,-1],[1,-1]],21:[[0,1],[1,0],[-1,0],[1,1],[-1,1],[0,-1],[1,-1],[-1,-1]],23:[[0,1],[-1,0],[1,0],[-1,1],[1,1],[0,-1],[-1,-1],[1,-1]],32:[[0,1],[1,0],[-1,0],[1,1],[-1,1],[0,-1],[1,-1],[-1,-1]],30:[[0,1],[-1,0],[1,0],[-1,1],[1,1],[0,-1],[-1,-1],[1,-1]],"03":[[0,1],[1,0],[-1,0],[1,1],[-1,1],[0,-1],[1,-1],[-1,-1]],"02":[[0,1],[0,-1],[-1,0],[1,0]],13:[[0,1],[0,-1],[-1,0],[1,0]],20:[[0,1],[0,-1],[-1,0],[1,0]],31:[[0,1],[0,-1],[-1,0],[1,0]]},i_kicks:{"01":[[0,-1],[0,-2],[0,1],[1,-1],[-1,-1],[1,-2],[-1,-2]],10:[[0,-1],[0,-2],[0,1],[-1,0],[1,0],[2,0]],12:[[0,-1],[0,-2],[0,1],[-1,0],[1,0],[2,0]],21:[[0,1],[0,2],[0,-1],[-1,1],[1,1],[-1,2],[1,2]],23:[[0,1],[0,2],[0,-1],[1,1],[-1,1],[1,2],[-1,2]],32:[[0,-1],[0,-2],[0,1],[1,0],[-1,0],[-2,0]],30:[[0,-1],[0,-2],[0,1],[1,0],[-1,0],[-2,0]],"03":[[0,-1],[0,-2],[0,1],[-1,-1],[1,-1],[-1,-2],[1,-2]],"02":[[0,-1],[0,1]],13:[[0,-1],[0,1]],20:[[0,-1],[0,1]],31:[[0,-1],[0,1]]},additional_offsets:{},spawn_rotation:{},color_overrides:{i1:"l",i2:"l",i3:"l",l3:"o",i5:"l",l:"o",o:"s",s:"i",i:"l",oo:"s"},preview_overrides:{}},NRS:{kicks:{"01":[],10:[],12:[],21:[],23:[],32:[],30:[],"03":[],"02":[],13:[],20:[],31:[]},additional_offsets:{z:[[1,1],[1,0],[1,0],[2,0]],l:[[1,0],[1,0],[1,0],[1,0]],o:[[0,0],[0,0],[0,0],[0,0]],s:[[1,1],[1,0],[1,0],[2,0]],i:[[0,1],[0,0],[0,0],[1,0]],j:[[1,0],[1,0],[1,0],[1,0]],t:[[1,0],[1,0],[1,0],[1,0]]},spawn_rotation:{z:0,l:2,o:0,s:0,i:0,j:2,t:2},color_overrides:{},preview_overrides:{l:[[0,0,201],[1,0,68],[2,0,124],[0,1,31]],j:[[0,0,199],[1,0,68],[2,0,114],[2,1,31]],t:[[0,0,199],[1,0,74],[2,0,124],[1,1,31]]}},ARS:{kicks:{"01":[[1,0],[-1,0]],10:[[1,0],[-1,0]],12:[[1,0],[-1,0]],21:[[1,0],[-1,0]],23:[[1,0],[-1,0]],32:[[1,0],[-1,0]],30:[[1,0],[-1,0]],"03":[[1,0],[-1,0]],"02":[[1,0],[-1,0]],13:[[1,0],[-1,0]],20:[[1,0],[-1,0]],31:[[1,0],[-1,0]]},i_kicks:{"01":[],10:[],12:[],21:[],23:[],32:[],30:[],"03":[],"02":[],13:[],20:[],31:[]},additional_offsets:{i1:[[0,0],[0,0],[0,0],[0,0]],z:[[0,1],[0,0],[0,0],[1,0]],l:[[0,1],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],s:[[0,1],[-1,0],[0,0],[0,0]],i:[[0,0],[0,0],[0,-1],[1,0]],j:[[0,1],[0,0],[0,0],[0,0]],t:[[0,1],[0,0],[0,0],[0,0]]},spawn_rotation:{z:0,l:2,o:0,s:0,i:0,j:2,t:2},color_overrides:{i1:"z",i2:"z",i3:"z",i5:"z",z:"s",s:"t",i:"z",t:"i"},preview_overrides:{l:[[0,0,201],[1,0,68],[2,0,124],[0,1,31]],j:[[0,0,199],[1,0,68],[2,0,114],[2,1,31]],t:[[0,0,199],[1,0,74],[2,0,124],[1,1,31]]},center_column:{pieces:["l","j","t"],rules:[[-1,-1],[0,-1],[1,-1],[-1,0],[0,0],[1,0],[-1,1],[0,1],[1,1]]}},ASC:{kicks:{"01":[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],10:[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],12:[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],21:[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],23:[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],32:[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],30:[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],"03":[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],"02":[],13:[],20:[],31:[]},i_kicks:{"01":[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],10:[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],12:[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],21:[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],23:[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],32:[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],30:[[-1,0],[0,1],[-1,1],[0,2],[-1,2],[-2,0],[-2,1],[-2,2],[1,0],[1,1],[0,-1],[-1,-1],[-2,-1],[1,2],[2,0],[0,-2],[-1,-2],[-2,-2],[2,1],[2,2],[1,-1]],"03":[[1,0],[0,1],[1,1],[0,2],[1,2],[2,0],[2,1],[2,2],[-1,0],[-1,1],[0,-1],[1,-1],[2,-1],[-1,2],[-2,0],[0,-2],[1,-2],[2,-2],[-2,1],[-2,2],[-1,-1]],"02":[],13:[],20:[],31:[]},allow_o_kick:!0,additional_offsets:{i1:[[0,0],[0,0],[0,0],[0,0]],z:[[0,0],[0,0],[0,0],[0,0]],l:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,1],[-1,1],[-1,0]],s:[[0,0],[0,0],[0,0],[0,0]],i:[[0,0],[0,-1],[1,-1],[1,0]],j:[[0,0],[0,0],[0,0],[0,0]],t:[[0,0],[0,0],[0,0],[0,0]]},color_overrides:{},spawn_rotation:{},preview_overrides:{}},none:{kicks:{"01":[],10:[],12:[],21:[],23:[],32:[],30:[],"03":[],"02":[],13:[],20:[],31:[]},additional_offsets:{},color_overrides:{},spawn_rotation:{},preview_overrides:{}}},cornerTable:{z:[[[-2,-1],[1,-1],[2,0],[-1,0]],[[0,-1],[1,-2],[0,2],[1,1]],[[-2,0],[1,0],[2,1],[-1,1]],[[-1,-1],[0,-2],[0,1],[-1,2]]],l:[[[-1,-1],[0,-1],[1,1],[-1,1]],[[-1,-1],[1,-1],[1,0],[-1,1]],[[-1,-1],[1,-1],[1,1],[0,1]],[[-1,0],[1,-1],[1,1],[-1,1]]],s:[[[-1,-1],[2,-1],[1,0],[-2,0]],[[0,-2],[1,-1],[1,2],[0,1]],[[-1,0],[2,0],[1,1],[-2,1]],[[-1,-2],[0,-1],[-1,1],[0,2]]],j:[[[0,-1],[1,-1],[1,1],[-1,1]],[[-1,-1],[1,0],[1,1],[-1,1]],[[-1,-1],[1,-1],[0,1],[-1,1]],[[-1,-1],[1,-1],[1,1],[-1,0]]],t:[[[-1,-1,3,0],[1,-1,0,1],[1,1,1,2],[-1,1,2,3]],[[-1,-1,3,0],[1,-1,0,1],[1,1,1,2],[-1,1,2,3]],[[-1,-1,3,0],[1,-1,0,1],[1,1,1,2],[-1,1,2,3]],[[-1,-1,3,0],[1,-1,0,1],[1,1,1,2],[-1,1,2,3]]]},scoring:{SINGLE:100,DOUBLE:300,TRIPLE:500,QUAD:800,PENTA:1200,TSPIN_MINI:100,TSPIN:400,TSPIN_MINI_SINGLE:200,TSPIN_SINGLE:800,TSPIN_MINI_DOUBLE:400,TSPIN_DOUBLE:1200,TSPIN_MINI_TRIPLE:800,TSPIN_TRIPLE:1600,TSPIN_MINI_QUAD:1600,TSPIN_QUAD:2600,TSPIN_PENTA:3200,BACKTOBACK_MULTIPLIER:1.5,COMBO:50,ALL_CLEAR:3500,SOFTDROP:1,HARDDROP:2},garbage:{SINGLE:0,DOUBLE:1,TRIPLE:2,QUAD:4,PENTA:5,TSPIN_MINI:0,TSPIN:0,TSPIN_MINI_SINGLE:0,TSPIN_SINGLE:2,TSPIN_MINI_DOUBLE:1,TSPIN_DOUBLE:4,TSPIN_MINI_TRIPLE:2,TSPIN_TRIPLE:6,TSPIN_MINI_QUAD:4,TSPIN_QUAD:10,TSPIN_PENTA:12,BACKTOBACK_BONUS:1,BACKTOBACK_BONUS_LOG:.8,COMBO_MINIFIER:1,COMBO_MINIFIER_LOG:1.25,COMBO_BONUS:.25,ALL_CLEAR:10,combotable:{none:[0],"classic guideline":[0,1,1,2,2,3,3,4,4,4,5],"modern guideline":[0,1,1,2,2,2,3,3,3,3,3,3,4]}},finesse:{z:{0:[9,9,1,2,1,0,1,2,2,1,9],1:[9,2,2,2,1,1,2,3,2,2,9],2:[9,9,1,2,1,0,1,2,2,1,9],3:[9,9,2,2,2,1,1,2,3,2,2]},l:{0:[9,9,1,2,1,0,1,2,2,1,9],1:[9,2,2,3,2,1,2,3,3,2,9],2:[9,9,3,4,3,2,3,4,4,3,9],3:[9,9,2,3,2,1,2,3,3,2,2]},o:{0:[9,1,2,2,1,0,1,2,2,1,9],1:[9,1,2,2,1,0,1,2,2,1,9],2:[9,1,2,2,1,0,1,2,2,1,9],3:[9,1,2,2,1,0,1,2,2,1,9]},s:{0:[9,9,1,2,1,0,1,2,2,1,9],1:[9,2,2,2,1,1,2,3,2,2,9],2:[9,9,1,2,1,0,1,2,2,1,9],3:[9,9,2,2,2,1,1,2,3,2,2]},i:{0:[9,9,1,2,1,0,1,2,1,9,9],1:[2,2,2,2,1,1,2,2,2,2,9],2:[9,9,1,2,1,0,1,2,1,9,9],3:[9,2,2,2,2,1,1,2,2,2,2]},j:{0:[9,9,1,2,1,0,1,2,2,1,9],1:[9,2,2,3,2,1,2,3,3,2,9],2:[9,9,3,4,3,2,3,4,4,3,9],3:[9,9,2,3,2,1,2,3,3,2,2]},t:{0:[9,9,1,2,1,0,1,2,2,1,9],1:[9,2,2,3,2,1,2,3,3,2,9],2:[9,9,3,4,3,2,3,4,4,3,9],3:[9,9,2,3,2,1,2,3,3,2,2]}},zenithRevivePrompts:[["F","combo",3,"Perform a 3-Combo",2,[]],["F","double",2,"Clear 2 Doubles",2,[]],["F","quad",1,"Clear a Quad",1,[]],["F","lines",6,"Clear 6 Lines",1,[]],["F","odouble",1,"Clear a Double\nusing an O-Piece",3,[]],["F","garbageclear",4,"Clear 4 Garbage Lines",2,[]],["F","szdouble",1,"Clear a Double\nusing an S or Z-Piece",3,[]],["F","ljtriple",1,"Clear a Triple\nusing an L or J-Piece",3,[]],["E","tspinmini",1,"Perform a T-Spin Mini",1,[]],["E","tspinsingle",1,"Clear a T-Spin Single",2,[]],["E","tspindouble",1,"Clear a T-Spin Double",2,[]],["E","szspin",1,"Clear an S/Z-Spin",1,[]],["E","ljspin",1,"Clear an L/J-Spin",1,[]],["E","combo",5,"Perform a 5-Combo",2,[]],["E","iflat",2,"Clear 2 Lines using\nhorizontal I-Pieces",3,[]],["E","tank",4,"Tank 4 Garbage Lines",2,[]],["E","cancel",4,"Cancel 4 Garbage Lines",2,[]],["D","double",4,"Clear 4 Doubles",2,[]],["D","spam",3,"Place 3 pieces in a row\nwithout moving or rotating",4,[]],["D","noclear",14,"Place 14 pieces in a row\nwithout clearing any lines",4,[]],["D","send",6,"Send 6 Lines",1,[]],["D","pieces",20,"Place 20 pieces",2,[]],["D","szdouble",2,"Clear 2 Doubles\nusing S or Z-Pieces",3,[]],["D","ljtriple",2,"Clear 2 Triples\nusing L or J-Pieces",3,[]],["D","ispinclear",1,"Clear an I-Spin",1,[]],["D","upperhalfquad",1,"Clear a Quad in the\nupper half of the board",4,[]],["C","tspintriple",1,"Clear a T-Spin Triple",2,[]],["C","nohold",25,"Place 25 pieces in a row\nwithout using Hold",4,["nohold"]],["C","triple",3,"Clear 3 Triples",2,[]],["C","b2b",4,"Reach B2B x4",1,[]],["C","quadbuckets",2,"Clear a Quad in\n2 different columns",3,[]],["C","holdconsecutive",12,"Use Hold on\n12 pieces in a row",3,["nohold"]],["C","softdrop",10,"Place 10 pieces without\nreleasing Soft Drop",4,[]],["C","top3rows",3,"Have part of your stack in\nthe top 3 rows for 3 seconds",4,[]],["C","linesnoti",10,"Clear 10 Lines without\nclearing with T or I-pieces",4,[]],["C","szspintriple",1,"Clear an S/Z-Spin Triple",2,[]],["C","odoubleconsecutive",2,"Clear 2 Doubles consecutively\nusing two O-Pieces",4,[]],["C","tspinminiclear",4,"Clear 4 T-Spin Minis",2,[]],["B","oclear",6,"Clear 6 Lines\nusing O-Pieces",3,[]],["B","spinbuckets",3,"Clear Spin-Clears\nwith 3 different pieces",3,[]],["B","quad",4,"Clear 4 Quads",1,[]],["B","spam",5,"Place 5 pieces in a row\nwithout moving or rotating",4,[]],["B","send",18,"Send 18 Lines",1,[]],["B","ljspintriple",1,"Clear an L/J-Spin Triple",2,[]],["B","quadconsecutive",2,"Clear 2 Quads in a row",2,[]],["B","singlesonly",8,"Clear 8 Singles without doing\nother clears or using Hold",4,[]],["B","nogarbage",4,"Have no Garbage Lines on\nyour board for 4 seconds",4,[]],["B","rotate",100,"Rotate 100 times",2,[]],["B","nocancel",8,"Don't cancel any\ngarbage for 8 seconds",3,[]],["A","combo",7,"Perform a 7-Combo",2,[]],["A","ispindouble",1,"Clear an I-Spin Double",2,[]],["A","szspinconsecutive",2,"Clear two S/Z-Spin\nDoubles consecutively",3,[]],["A","ljspinconsecutive",2,"Clear two L/J-Spin\nDoubles consecutively",3,[]],["A","colorclear",1,"Perform a Color Clear",2,[]],["A","lines",40,"Clear 40 Lines",1,[]]],zenithReviveDecks:[[0,0,0,0,0,0],[1,0,0,0,0,0],[2,0,0,0,0,0],[3,0,0,0,0,0],[2,1,0,0,0,0],[1,2,0,0,0,0],[0,3,0,0,0,0],[0,2,1,0,0,0],[0,1,2,0,0,0],[0,0,3,0,0,0],[0,0,2,1,0,0],[0,0,1,2,0,0],[0,0,0,3,0,0],[0,0,0,2,1,0],[0,0,0,1,2,0],[0,0,0,0,3,0],[0,0,0,0,2,1],[0,0,0,0,1,2],[0,0,0,0,0,3]],majorShoutStyles:{globalbest:()=>{Ur.play("confetti",{gui:!0,count:30})},personalbest:()=>{Ur.play("confetti",{gui:!0,count:15,hue:[30,60]})},lg_victory:()=>{setTimeout((()=>{Ur.play("confetti",{gui:!1,count:15,hue:[30,60]})}),1250)}},globalShoutStyles:{},gameModes:{"40l":{version:A,gameid:"X-PASSTHRU",seed_random:!1,anchorseed:!0,seed:"X-PASSTHRU",allow180:!0,g:.02,objective_type:"lines",objective_count:40,handling:"X-PASSTHRU",countdown:"X-PASSTHRU",countdown_interval:"X-PASSTHRU",precountdown:"X-PASSTHRU",prestart:"X-PASSTHRU",mission:"X-PASSTHRU",zoominto:"X-PASSTHRU",bgmnoreset:"X-PASSTHRU",slot_counter1:"X-PASSTHRU",slot_counter2:"X-PASSTHRU",slot_counter3:"X-PASSTHRU",slot_counter4:"X-PASSTHRU",slot_counter5:"X-PASSTHRU",slot_bar2:"progress",can_retry:!0,nolockout:!0,pro:"X-PASSTHRU",pro_alert:"X-PASSTHRU",pro_retry:"X-PASSTHRU",stride:"X-PASSTHRU",no_szo:"X-PASSTHRU",fromretry:"X-PASSTHRU"},blitz:{version:A,gameid:"X-PASSTHRU",seed_random:!1,anchorseed:!0,seed:"X-PASSTHRU",allow180:!0,objective_type:"timed",objective_time:12e4,levels:!0,levelspeed:.42,levelgbase:.65,gravitymay20g:!1,handling:"X-PASSTHRU",countdown:"X-PASSTHRU",countdown_interval:"X-PASSTHRU",precountdown:"X-PASSTHRU",prestart:"X-PASSTHRU",mission:"X-PASSTHRU",zoominto:"X-PASSTHRU",bgmnoreset:"X-PASSTHRU",slot_counter1:"X-PASSTHRU",slot_counter2:"X-PASSTHRU",slot_counter3:"X-PASSTHRU",slot_counter4:"X-PASSTHRU",slot_counter5:"X-PASSTHRU",slot_bar2:"progress",can_retry:!0,nolockout:!0,pro:"X-PASSTHRU",pro_alert:"X-PASSTHRU",pro_retry:"X-PASSTHRU",stride:"X-PASSTHRU",no_szo:"X-PASSTHRU",fromretry:"X-PASSTHRU"}},Strings:{cleartypes:["NONE","SINGLE","DOUBLE","TRIPLE","QUAD","PENTA","HEXA","HEPTA","OCTA","ENNEA","DECA","HENDECA","DODECA","TRIADECA","TESSARADECA","PENTEDECA","HEXADECA","HEPTADECA","OCTADECA","ENNEADECA","EICOSA","KAGARIS"],tspins:{mini:"\fc3MINI\f5 %%PIECE%%-spin",normal:"%%PIECE%%-spin"},extra:{btb:"back-to-back",btb_short:"BACK-TO-BACK",clear:"ALL\nCLEAR",colorclear:"COLOR\nCLEAR",zenlevel:"LEVEL\nCOMPLETE"},longTypeNames:{"40l":"40 LINES",blitz:"BLITZ","5mblast":"5,000,000 BLAST",zen:"ZEN",custom:"CUSTOM GAME",league:"TETRA LEAGUE",zenith:"QUICK PLAY",zenithex:"EXPERT QUICK PLAY"},gameMissions:{"40l":"CLEAR 40 LINES!",blitz:"TWO-MINUTE BLITZ","5mblast":"5,000,000 BLAST!",zen:"ZEN","40 LINES":"CLEAR 40 LINES!",BLITZ:"TWO-MINUTE BLITZ","5,000,000 BLAST":"5,000,000 BLAST!",ZEN:"ZEN"},zenithMods:{invisible:"Invisible",messy:"Messier Garbage",volatile:"Volatile Garbage",nohold:"No Hold",doublehole:"Double Hole Garbage",allspin:"All-Spin",gravity:"Gravity",expert:"Expert Mode",duo:"Duo"},zenithModsShort:{invisible:"IN",messy:"MS",volatile:"VL",nohold:"NH",doublehole:"DH",allspin:"AS",gravity:"GV",expert:"EX",duo:"2P"}}};class k{static SLOWEST_PROVISION_SPEED=0;static FASTEST_PROVISION_SPEED=1;static JUMP_PROVISION_SPEED=2;static PROVISION_SPEED_LOOKUP={zero:{[k.SLOWEST_PROVISION_SPEED]:15,[k.FASTEST_PROVISION_SPEED]:2,[k.JUMP_PROVISION_SPEED]:4},low:{[k.SLOWEST_PROVISION_SPEED]:15,[k.FASTEST_PROVISION_SPEED]:6,[k.JUMP_PROVISION_SPEED]:8},medium:{[k.SLOWEST_PROVISION_SPEED]:50,[k.FASTEST_PROVISION_SPEED]:6,[k.JUMP_PROVISION_SPEED]:15},high:{[k.SLOWEST_PROVISION_SPEED]:50,[k.FASTEST_PROVISION_SPEED]:15,[k.JUMP_PROVISION_SPEED]:30},xhigh:{[k.SLOWEST_PROVISION_SPEED]:50,[k.FASTEST_PROVISION_SPEED]:50,[k.JUMP_PROVISION_SPEED]:50}};static StripBloat(e){const t=[];for(const n of e.events)"full"!==n.type&&("start"===n.type?n.data={}:"end"===n.type&&(n.data={reason:n.data.gameoverreason}),t.push(n));return e.events=t,e}static FormatOptions(e,t,n=t.username){switch(t=Gt(t),e){case"multi":t.display_replay=!0,t.countdown_interval=1e3,t.countdown_count=3,t.precountdown=500,t.prestart=1e3,t.mission="",t.zoominto="slow";break;default:t.countdown_interval=1e3,t.precountdown=5e3,t.prestart=1e3,t.mission=L.Strings.gameMissions[e]??"",t.zoominto="slow",void 0!==it&&(t.pro=!!it.gameoptions[`pro_${e}`],t.pro_alert=!!it.gameoptions[`pro_${e}_alert`],t.pro_retry=!!it.gameoptions[`pro_${e}_retry`],t.slot_counter1=it.gameoptions[`slot_${e}_counter1`]||t.slot_counter1||"",t.slot_counter2=it.gameoptions[`slot_${e}_counter2`]||t.slot_counter2||"",t.slot_counter3=it.gameoptions[`slot_${e}_counter3`]||t.slot_counter3||"",t.slot_counter4=it.gameoptions[`slot_${e}_counter4`]||t.slot_counter4||"",t.slot_counter5=it.gameoptions[`slot_${e}_counter5`]||t.slot_counter5||"");case"custom":t.song="shiroi-hyoutan",t.username=n??"",t.display_replay=!0,t.display_username=!0}return t}constructor({frames:e=0,events:t=[],options:n=null,results:s={}}={}){this.frame=e,this.events=t,this.options=n,this.results=s,this.eventsBuffer=[],this._eventsFrame=new Map,this._rollingTarget=null,this._flushNextFrame=!1,this._endEvent=null,this._fullEvents=new Map,this.provisioned=0,this.provisionSpeed=k.JUMP_PROVISION_SPEED,this.latencyMode="medium",this._RebuildIndex()}get _SlowestSpeed(){return k.PROVISION_SPEED_LOOKUP[this.latencyMode][k.SLOWEST_PROVISION_SPEED]}get _FastestSpeed(){return k.PROVISION_SPEED_LOOKUP[this.latencyMode][k.FASTEST_PROVISION_SPEED]}get _JumpSpeed(){return k.PROVISION_SPEED_LOOKUP[this.latencyMode][k.JUMP_PROVISION_SPEED]}_RebuildIndex(){this._eventsFrame.clear();for(const e of this.events){const t=e.frame;"end"===e.type?this._endEvent=e:"full"===e.type&&this._fullEvents.set(t,e),this._eventsFrame.has(t)?this._eventsFrame.get(t).push(e):this._eventsFrame.set(t,[e])}}AdvanceFrame(){this.provisioned++,(!Ut()&&this.provisioned>=this.provisionSpeed||this._flushNextFrame)&&this.Flush(),this.frame++}GetEventCount(){return this.events.length}GetEndEvent(){return this._endEvent}GetFullEvents(){return this._fullEvents}GetEndEventFrame(){return this._endEvent?.frame??null}GetEventsAtFrame(e){return this._eventsFrame.has(e)?this._eventsFrame.get(e):[]}PushEvent(e,t){const n={frame:this.frame,type:e,data:Gt(t)};"full"===e||Ut()||(this.provisionSpeed=Math.max(this._SlowestSpeed,Math.min(this._JumpSpeed,this.provisionSpeed-.25))),"full"===e?this._fullEvents.set(n.frame,n):"end"===e&&(this.results.aggregatestats=t.aggregatestats,this.results.stats=t.stats,this.results.gameoverreason=t.gameoverreason,this._endEvent=n),this.events.push(n),this._rollingTarget&&(this.eventsBuffer.push(n),"end"===e&&this.Flush()),this._eventsFrame.has(this.frame)?this._eventsFrame.get(this.frame).push(n):this._eventsFrame.set(this.frame,[n])}SetOptions(e){this.options=Gt(e),this.options.seed_random=!1}SetLatencyMode(e){this.latencyMode=e,this.provisionSpeed=this._JumpSpeed}BindRollingTarget(e){this._rollingTarget=e}Seek(e){this.frame=e}Flush(e=!1){if(!this._rollingTarget)return;this.provisioned=0,e||(this.provisionSpeed=Math.min(this._SlowestSpeed,this.provisionSpeed+1));const{options:{gameid:t},frame:n}=this,s=Gt(this.eventsBuffer);"function"==typeof this._rollingTarget?this._rollingTarget({gameid:t,frames:s,provisioned:n}):this._rollingTarget.send("game.replay",new He(t,n,s)),this.eventsBuffer.length=0,this._flushNextFrame=!1}FlushNextFrame(){this._flushNextFrame=!0}Preprocess(e="unknown",t){const n=new B("replay",{replay:this}),s=k.FormatOptions(e,this.options,t),i={gamemode:e,options:s,frames:0,piece:[],localPPS:[],localSPP:[],vs:[],finesseFault:[],choke:[],states:[],climbSpeed:[],chapter:[[0,"1","FLOOR 1"]]},o=[],a=[],r=[];let l=0,c=0,p=1;e="zenithex"===e?"zenith":e,n.on("frame",(t=>{const s=n.getState();if(t%30==0&&i.vs.push([t,(s.stats.garbage.attack+s.stats.garbage.cleared)/Math.max(1,s.stats.piecesplaced)*(s.stats.piecesplaced/Math.max(1,t/60))*100]),"zenith"===e){t%60==0&&i.climbSpeed.push([t,s.stats.zenith.rank]);const e=s.stats.zenith.floor||1;s.stats.zenith.floor!==p&&(i.chapter.push([t,`${e}`,`FLOOR ${e}`]),p=e)}})),n.on("piece",(()=>{const e=n.getState(),t=n.getFrame();!i.piece.includes(t)&&i.piece.push(t),o.push(t),o.length>10&&o.shift();i.localPPS.push([t,t?600/(t-o[0]):0]);const s=e.stats.score-c;c=e.stats.score,a.push(s/e.stats.level),a.length>30&&a.shift();const p=a.reduce(((e,t)=>e+t),0);if(i.localSPP.push([t,p/a.length]),e.stats.finesse.faults!==l&&(l=e.stats.finesse.faults,i.finesseFault.push(t)),r.length>11){const e=i.piece[i.piece.length-2],n=(r[r.length-1]-r[r.length-10])/10,s=t-e;if(s>3*n)return void i.choke.push([e+n,s+n])}r.includes(t)||r.push(t)})),n.setGame(s),n.setHeadless(!0),n.startGame();const d=this.GetEndEventFrame();for(let e=0;n.isPlaying()&&e<=d;e++)if(n.doFrame(),e%300==0){const e=n.ejectState();e.started=!0,i.states.push(e)}if(i.frames=d,i.localPPS.length>7)for(let e=0;e<7;e++)i.localPPS[e][1]=i.localPPS[7][1];return i}Import(e){this.frame=e.frames,this.events=e.events,this.options=e.options,this.results=e.results,this._RebuildIndex()}Export(){return{frames:this.frame,events:this.events,options:this.options,results:this.results}}}class S{static _VERSION_FORMAT=1;static get VERSION_FORMAT(){return this._VERSION_FORMAT}static _Upgrade(e={}){if(e.version>=A)return e;const t={infinitemovement:"infinite_movement",infinitestock:"infinite_stock",gbase:"levelgbase",gspeed:"levelgspeed",latencypreference:"latencymode",x_resulttype:"objective_result"};for(const[n,s]of Object.entries(t))n in e&&(e[s]=e[n],delete e[n]);e=this._UpgradeDisplayData(e);const n={gameid:"integer",garbagephase:"integer",garbageattackcap:"integer",garbageabsolutecap:"integer",mission:"string",slot_counter1:"string",slot_counter2:"string",slot_counter3:"string",slot_counter4:"string",slot_counter5:"string",slot_bar1:"string",slot_bar2:"string",username:"string",zoominto:"undefined",spinbonuses:"default",physical:"delete",presets:"delete",constants_overrides:"delete"};for(const[t,s]of Object.entries(n))if(t in e)switch(s){case"integer":e[t]=0|e[t];break;case"string":e[t]=e[t]??"";break;case"undefined":if(e[t])continue;delete e[t];break;case"delete":delete e[t]}else"default"===s&&(e[t]=ge.OptionsList.spinbonuses.default);return"objective"in e&&(e.objective_type=e.objective.type||"none",e.objective_count=e.objective.count||0,e.objective_time=e.objective.time||0,delete e.objective),"ghostskin"in e&&("minoskin"in e?e.minoskin.ghost=e.ghostskin:e.minoskin={...ge.OptionsList.minoskin.default,ghost:e.ghostskin},delete e.ghostskin),e}static _UpgradeDisplayData(e){const t={display_score:{slot:"slot_counter5",counter:"score"},display_stopwatch:{slot:"slot_counter1",counter:"stopwatch"},display_timer:{slot:"slot_counter1",counter:"timer"},display_lines:{slot:"slot_counter2",counter:"lines"},display_level:{slot:"slot_counter3",counter:"level"},display_pieces:{slot:"slot_counter3",counter:"pieces"},display_keys:{slot:"slot_counter4",counter:"keys"},display_finesse:{slot:"slot_counter5",counter:"finesse"},display_finesse_l:{slot:"slot_counter4",counter:"finesse_l"},display_attack:{slot:"slot_counter2",counter:"attack"},display_vs:{slot:"slot_counter5",counter:"vs"},display_placement:{slot:"slot_counter5",counter:"placement"},display_kills:{slot:"slot_counter1",counter:"kills"}},n={};for(const[s,{slot:i,counter:o}]of Object.entries(t))e[s]&&(n[i]=o,delete e[s]);for(const[t,s]of Object.entries(n))e[t]||(e[t]=s);return e.display_impending&&(e.slot_bar1="impending",delete e.display_impending),e.display_progress&&(e.slot_bar2="progress",delete e.display_progress),e}static Update(e){for(;e.version!==this.VERSION_FORMAT;)switch(e.version){case null:case void 0:{const t={};t.id=e.shortid,t.ts=e.ts,t.gamemode=e.ismulti?"league":e.endcontext.gametype??e.gametype,t.replay=e.data??e.replay,t.version=0,t.users=e.ismulti?[{id:e.endcontext[0]._id,username:e.endcontext[0].username,avatar_revision:0,banner_revision:0,flags:0,country:null},{id:e.endcontext[1]._id,username:e.endcontext[1].username,avatar_revision:0,banner_revision:0,flags:0,country:null}]:[{id:e.user._id,username:e.user.username,avatar_revision:0,banner_revision:0,flags:0,country:null}],e=t;break}case 0:{const t=e.replay;if(e.version=1,"league"===e.gamemode)throw new Error("Updating multiplayer files are currently not supported!");e.replay={frames:t.frames,events:[],results:{}};for(const n of t.events)"full"!==n.type||e.replay.options?("end"===n.type&&(e.replay.results.aggregatestats=n.data.export.aggregatestats,e.replay.results.stats=n.data.export.stats,e.replay.results.gameoverreason=n.data.export.gameoverreason,n.data={reason:n.data.export.gameoverreason}),e.replay.events.push(n)):e.replay.options=Gt(n.data.options)}}if(!Ut()&&"league"!==e.gamemode){e.replay.options=this._Upgrade(e.replay.options);if(e.replay.options.version<19){const t=Gt(e.replay.options),n=new k(e.replay),s=new B("replay",{replay:n});t.noreplay=!1,t.seed_random=!1,s.setGame(t),s.setHeadless(!0),s.startGame(),s.doAllFrames(),e.replay=k.StripBloat(s.replay.Export())}}return e}constructor(e={}){if(!new.target)throw new SyntaxError("ReplayFile must be called with new");this.id=e.id??e.shortid??null,this.gamemode=e.gamemode??null,this.ts=e.ts??new Date,this.users=e.users??[{}],this.replay=e.replay??null,this.version=e.version??S.VERSION_FORMAT}}class F extends w{_actorId=0;_visualActors=new Map;CreateActor(e,t,n,s,i){const o="a"+ ++this._actorId;return this.S.actors[o]={id:o,type:e,x:t,y:Math.ceil(n),anchor:s,data:i},this.self.c.IsServer()||this.self.hm.IsTinyMode()||(this._visualActors.has(o)&&this._visualActors.get(o).delete(),this._visualActors.set(o,this.self.hm.H.board.af(e).create({},this.S.actors[o],!0))),o}CountActorsOfType(e){let t=0;for(const n of Object.keys(this.S.actors))this.S.actors[n].type===e&&t++;return t}DestroyActor(e){delete this.S.actors[e],this.self.c.IsServer()||this.self.hm.IsTinyMode()||!this._visualActors.has(e)||(this._visualActors.get(e).delete(),this._visualActors.delete(e))}DestroyAllActors(e){for(const e of Object.keys(this.S.actors))this.DestroyActor(e)}PullActors(e){if(!this.self.hm.IsTinyMode()&&!this.self.c.IsServer())for(const t of this._visualActors.values())t.progress(e)}ClearVisualActors(){for(const e of this._visualActors.values())e.delete();this._visualActors.clear()}RedrawActors(){if(this.ClearVisualActors(),!this.self.hm.IsTinyMode()&&!this.self.c.IsServer())for(const e of Object.keys(this.S.actors))this._visualActors.set(e,this.self.hm.H.board.af(this.S.actors[e].type).create({},this.S.actors[e],!1))}ProgressActors(){for(const e of Object.keys(this.S.actors))this.ProgressActor(this.S.actors[e])}ActionActor(e,...t){this.self.hm.IsTinyMode()||this.self.c.IsServer()||this._visualActors.get(e)?.action(...t)}ProgressActor(e){switch(e.type){case"wound_timer":{let t=!1;switch(e.data.type){case"time":if("INF"===e.data.time)break;e.data.time--,t=e.data.time<=0;break;case"clears":if("INF"===e.data.amt)break;t=e.data.amt<=0}if(t){for(let t=0;t<this.W;t++)this.S.board[e.y][t]=t===e.x?null:"gb";this.self.hm.H.stackdirty=!0,this.self.hm.H.fallingdirty=!0,this.self.bm.ClearIsLegalAtPosMemo(),this.self.sfx.Play("wound_repel"),this.DestroyActor(e.id)}break}}}RemoveRow(e){for(const t of Object.keys(this.S.actors)){const n=this.S.actors[t];if("stack"===n.anchor)n.y<e?n.y++:n.y===e&&this.DestroyActor(t)}}AddRow(e){for(const t of Object.keys(this.S.actors)){const n=this.S.actors[t];if("stack"===n.anchor)n.y<e&&n.y--}}}const z=function(e){"use strict";const t=e.gsm;function n(e){for(const n of t.impendingdamage)if(n.id===e)return n;return null}function s(){const e=Math.min(t.setoptions.garbagecapmax,t.setoptions.garbagecap);return Math.floor(e)}function i(e){let t="medium";return e<3&&(t="small"),e>5&&(t="large"),t}function o(e=!1){let n=0;for(const s of t.impendingdamage)s.shielded||(!e||s.active&&"spawn"===s.status)&&(n=n+=s.amt);return n}function a(){if(0!==t.setoptions.garbagefavor)return function(){const n=[];let s=-1;for(let n=e.T-1;n>=0;n--){let i=-1,o=!1;for(let s=0;s<e.W;s++)-1===i&&null===t.board[n][s]&&(i=s),"gb"===t.board[n][s]&&(o=!0);if(-1!==i){o&&(s=i);break}}e:for(let i=0;i<e.W;i++){for(let o=0;o<e.T;o++)if(null!==t.board[o][i]){const a=e.T-o,r=-1===s?0:Math.abs(i-s);n.push([i,a+5*r+.1*t.rngex.nextFloat()]);continue e}n.push([i,.1*t.rngex.nextFloat()])}n.sort(((e,t)=>t[1]-e[1]));let i=0;for(let e=0;e<n.length;e++){let s=Math.max(0,10+t.setoptions.garbagefavor+e*((20-2*(10+t.setoptions.garbagefavor))/9));t.setoptions.messiness_nosame&&t.lastcolumn===n[e][0]&&(s=0),n[e][2]=i+s,i+=s}const o=t.rngex.nextFloat()*i;for(let e=0;e<n.length;e++)if(0!==n[e][2]&&o<=n[e][2])return t.lastcolumn=n[e][0],t.lastcolumn;return 0}();let n=0;return t.setoptions.messiness_nosame&&null!==t.lastcolumn?(n=Math.floor(t.rngex.nextFloat()*(e.bm.ColumnWidth()-1)),n>=t.lastcolumn&&n++):n=Math.floor(t.rngex.nextFloat()*e.bm.ColumnWidth()),t.lastcolumn=n,n}function r(n){if(!t.setoptions.hasgarbage)return;if(n<1)return;t.lastoffensive.offence+=n,t.stats.garbage.sent+=n,t.stats.garbage.sent_nomult+=Math.floor(n/t.setoptions.garbagemultiplier),e.zthm.AwardLines(n,!0),e.zthm.IncrementPrompt("send",n);const s=i(n);e.sfx.Play(`garbage_out_${s}`,2);for(const s of e.tm.GetTargets()){const i=++t.interactionid;if(["zero","consistent"].includes(t.setoptions.passthrough)&&(t.garbageacknowledgements.outgoing[s]||(t.garbageacknowledgements.outgoing[s]=[]),t.garbageacknowledgements.outgoing[s].push({iid:i,amt:n})),e.c.IsServer()){let o=n;const a=t.setoptions.zenith?4:1/0;for(;o>0;){const n=Math.min(o,a);e.elm.emit("interaction",{iid:i,type:"garbage",amt:n,ackiid:t.garbageacknowledgements.incoming[s]??0,x:t.lastoffensive.x,y:t.lastoffensive.y,zthalt:t.setoptions.zenith?t.stats.zenith.altitude:void 0},[s]),o-=n}}else u(n,s)}}function l(e,n){t.garbageacknowledgements.incoming[n]=Math.max(e.iid,t.garbageacknowledgements.incoming[n]??0);let s=e.amt;if(t.garbageacknowledgements.outgoing[n]){const i=[];for(const o of t.garbageacknowledgements.outgoing[n]){if(o.iid<=e.ackiid)continue;const t=Math.min(o.amt,s);o.amt-=t,s-=t,o.amt>0&&i.push(o)}t.garbageacknowledgements.outgoing[n]=i}return s}function c(e){switch(t.setoptions.roundmode){case"down":return Math.floor(e);case"rng":{const n=Math.floor(e);if(n===e)return e;const s=e-n;return n+(t.rngex.nextFloat()<s?1:0)}}return 0}function p(n){const s=n.gameid,o=n.cid;if("consistent"===t.setoptions.passthrough&&s)n.amt=l(n,s);else if(null!=o&&(n=function(e){for(const n of t.impendingdamage)if(n.cid===e)return n;return null}(o),!n))return;if(null===o&&(t.lastatktime=e.esm.frame,e.zthm.AwardHasBeenAttacked(n.amt)),t.zenith.incapacitated||n.amt<=0)return;const a=i(n.amt);if(!e.c.IsServer()&&e.iom.IsLocal()){const i=wl(e.hm.H.stackobj,As(Ol.x*(e.Wh+e.Wh*(Math.random()-.5))),As(Ol.x*(e.Hh+e.Hh*(Math.random()-.5))),e.hm.S());let r=null;null!=s&&(e.sfx.Play(`garbage_in_${a}`),r=e.elm.emit("garbage",s)),null==r&&(r={pos:wl(e.hm.H.stackobj,As(Ol.x*e.Wh),As(-10*Ol.x),e.hm.S()),scale:e.hm.S()});const l=el.create({pointA:[r.pos.x+r.scale*As(Ol.x*(n.x-(e.Wh-.5))),r.pos.y+r.scale*As(Ol.x*(n.y-(e.Hh+e.B-.5)))],pointB:[i.x,i.y],duration:t.setoptions.garbagespeed/(e.lm.H.playbackSpeed||1)/60,intensity:n.amt,layer:"front"});o&&l&&function(e,n){for(const s of t.impendingdamage)if(s.cid===e)return s.beam=n}(o,l)}t.killer.gameid=s??0,t.killer.username=n.username,t.garbagereceived+=n.amt,t.stats.garbage.received+=n.amt,t.notyetreceivedattacks++,e.wfm.WaitFrames(t.setoptions.garbagespeed,"incoming-attack-hit",{gid:n.id})}function d(n){let s=n.amt;const i=[];for(t.garbageid--;i.length<4&&s;){const e=Math.min(t.setoptions.zenith_volatile?8:4,s);s-=e,i.push({...n,amt:e,id:++t.garbageid})}const o=120+30*i.length;t.windupwaituntil>e.esm.frame?(e.wfm.WaitFrames(t.windupwaituntil-e.esm.frame,"start-explode-attack",i),t.windupwaituntil+=o):(h(i),t.windupwaituntil=e.esm.frame+o)}function h(t){for(let n=0;n<t.length;n++)e.wfm.WaitFrames(60+30*n,"process-exploded-attack",t[n]);e.c.OnClient((()=>{e.sfx.Play(`garbagewindup_${Math.max(1,Math.min(4,t.length))}`),e.hm.H.board.el("garbagewindupicon").create(Math.max(1,Math.min(4,t.length)))}))}function u(n,s){if(e.c.IsServer())return;if(("low"===it.video.graphics||"minimal"===it.video.graphics)&&e.hm.IsTinyMode()||0===e.lm.H.soundSkipRate)return;const i=e.elm.emit("garbage",s);if(null==i)return;const o=wl(e.hm.H.stackobj,As(Ol.x*t.lastoffensive.x),As(Ol.x*(t.lastoffensive.y-20)),e.hm.S());el.create({pointA:[o.x,o.y],pointB:[i.pos.x+(Math.random()-.5)*(i.scale*As(Ol.x*e.Wh)),i.pos.y+(Math.random()-.5)*(i.scale*As(Ol.x*e.Hh))],duration:t.setoptions.garbagespeed/(e.lm.H.playbackSpeed||1)/60,intensity:n*e.hm.H.holderstate.cos,layer:e.hm.IsFullMode()?"front":"sub"}),e.wfm.WaitFrames(t.setoptions.garbagespeed/(e.lm.H.playbackSpeed||1),"outgoing-attack-hit",{})}function _(s=t.impendingdamage[0]?.id){if(!s)return;const o=n(s);if(o){switch(o.status){case"sleeping":o.queued?o===t.impendingdamage[0]&&(o.delay>=1?(o.status="caution",e.wfm.WaitFrames(o.delay,"process-garbage-status",{id:o.id})):o.status="spawn"):(o.status="caution",e.wfm.WaitFrames(o.delay,"process-garbage-status",{id:o.id}));break;case"caution":o.firstcycle&&(o.status="danger"),e.wfm.WaitFrames(o.delay,"process-garbage-status",{id:o.id});break;case"danger":o.status="spawn"}o.firstcycle=!0,"spawn"===o.status&&e.c.OnClient((()=>{const t=i(o.amt);e.gpm.Vibrate(si[`damage_${t}`.toUpperCase()]),e.sfx.Play(`damage_${t}`),e.hm.H.holderstate.dw+=Math.min(40,1.25*o.amt)*e.lm.H.lastdT})),e.c.OnClient((()=>e.pbm.UpdateGarbageBar("impending")))}}return{GetGarbageCap:s,GetGarbageAbsoluteCap:function(){return t.setoptions.garbageabsolutecap},GetPendingGarbageCount:o,AddPendingGarbage:function(n){const s=n.gameid??null;let i=n.amt;if("zero"===t.setoptions.passthrough&&s&&(i=l(n,s)),t.setoptions.zenith){const e=t.stats.zenith.altitude,s=n.zthalt;if(s<e&&(i*=1+.004*(e-s)**2/(e+s)),t.setoptions.zenith_duo&&t.zenith.allyincapacitated&&(i*=1.5),i*=Math.min(2,1+t.cancelstreak*(t.setoptions.zenith_volatile?.0075:.015)),t.setoptions.zenith_duo&&(t.stats.zenith.totalbonus||t.zenith.bonusfromally)){const e=t.stats.zenith.totalbonus/(t.stats.zenith.totalbonus+t.zenith.bonusfromally);e<=.2&&(i*=e-.2+.75)}t.stats.zenith.targetinggrace>8&&(i*=1-.05*(t.stats.zenith.targetinggrace-8))}if(i=c(i*t.setoptions.receivemultiplier),t.setoptions.garbageabsolutecap){const e=t.impendingdamage.reduce(((e,t)=>e+t.amt),0);t.setoptions.garbageabsolutecap<=e?n.shielded=!0:i+e>t.setoptions.garbageabsolutecap&&(i=t.setoptions.garbageabsolutecap-e)}if(t.zenith.incapacitated||i<=0)return void(i&&(t.lastatktime=e.esm.frame,e.zthm.AwardHasBeenAttacked(i)));const o=++t.garbageid,a=n.cid??null,r=n.iid??null,h=n.ackiid??null,u=n.type,_=n.active??null==a,m=n.column,g=n.username||null,f=n.shielded,b=n.delay??t.setoptions.garbagephase,C=n.queued??t.setoptions.garbagequeue,x=n.size??t.setoptions.garbageholesize,[A,y]=[n.x,n.y];let v="spawn";(C||b>=1)&&(v=b>=1?"caution":"spawn",t.impendingdamage.length>0&&C&&(v="sleeping"));const B={id:o,cid:a,iid:r,ackiid:h,gameid:s,username:g,type:u,active:_,status:v,shielded:f,delay:b,queued:C,amt:i,x:A,y,size:x,column:m};if(t.setoptions.zenith&&i>=(t.setoptions.zenith_volatile?16:8))return d(B);t.impendingdamage.push(B),e.c.OnClient((()=>e.pbm.UpdateGarbageBar("impending"))),null==a?p(B):(t.lastatktime=e.esm.frame,e.zthm.AwardHasBeenAttacked(i))},FightLines:function(n){if(!t.setoptions.hasgarbage)return;t.stats.garbage.attack+=n;const s=!!t.impendingdamage.length;s&&e.sfx.Play("offset",.65,.2);let i=0;"defensive"===t.setoptions.garbagetargetbonus&&(i+=c(t.garbagebonus*t.setoptions.garbagemultiplier)),(t.setoptions.zenith_volatile||t.setoptions.zenith_duo)&&(i+=n),t.stats.piecesplaced<t.setoptions.openerphase&&o()>=t.stats.garbage.sent&&(i+=n);let a=0;for(;(n>0||i>0)&&t.impendingdamage.length;){if(t.impendingdamage[0].amt--,!t.impendingdamage[0].amt){t.impendingdamage.shift().queued&&_()}n?n--:i--,a++}t.lastoffensive.defense+=a,a&&(t.setoptions.zenith_expert||e.zthm.AwardLines(.5*a,!1),e.zthm.IncrementPrompt("cancel",a),e.zthm.NixPrompt("nocancel"),t.zenith.lastcancel=e.esm.frame,t.cancelstreak+=a),n>0&&(s&&e.sfx.Play("counter",.65,.2),"consistent"===t.setoptions.passthrough&&t.notyetreceivedattacks>0&&e.sfx.Play("exchange",1,.2),r(n)),s&&!e.c.IsServer()&&(e.pbm.UpdateGarbageBar("impending"),a&&e.pbm.FlashGarbageBar("impending",Math.min(e.H,a)))},Offence:r,IncomingAttack:p,IncomingAttackHit:function(s){const o=n(s);if(o){if(t.setoptions.shielded||o.shielded)return t.impendingdamage=t.impendingdamage.filter((e=>e.id!==s)),e.c.OnClient((()=>{const n=i(o.amt);if(e.sfx.Play(`protected_${n}`),e.pbm.UpdateGarbageBar("impending"),o.amt){const n=t.impendingdamage.reduce(((e,t)=>e+t.amt),0);e.pbm.FlashGarbageBar("impending",Math.min(e.H,o.amt),n)}}));e.c.OnClient((()=>e.sfx.Play("impact"))),t.notyetreceivedattacks--,o.active=!0,_(o.id)}},OutgoingAttack:u,OutgoingAttackHit:function(){e.sfx.Play("impact")},ExplodeAttack:d,StartExplodeAttack:h,ProcessExplodedAttack:function(n){t.impendingdamage.push(n),e.c.OnClient((()=>e.pbm.UpdateGarbageBar("impending"))),p(n)},ProcessGarbageStatus:_,TakeAllDamage:function(n=!1){if(t.setoptions.shielded||!t.setoptions.hasgarbage)return;if(t.garbagearelockeduntil>e.esm.frame)return;let i=!0;const o=n?400:s();let r=!1,l=!1,c=0;t.setoptions.messiness_timeout&&e.esm.frame>=t.lasttanktime+t.setoptions.messiness_timeout&&a(),t.lasttanktime=e.esm.frame,t.cancelstreak=0;let p=t.setoptions.messiness_change,d=t.setoptions.messiness_inner;t.setoptions.zenith&&!t.setoptions.zenith_messy&&(p=Math.max(0,p-.0375*t.stats.zenith.targetinggrace),d=Math.max(0,d-.015*t.stats.zenith.targetinggrace));const h=[];for(let e=t.impendingdamage.length-1;e>=0;e--){const n=t.impendingdamage[e];n.active&&"spawn"===n.status||(h.unshift(n),t.impendingdamage.splice(e,1))}for(let n=0;n<o&&0!==t.impendingdamage.length;n++){const s=t.impendingdamage[0];s.amt--,t.lastreceivedcount++;let h=t.lastcolumn;null!=s.column?h=s.column:(null===h||t.rngex.nextFloat()<d)&&(h=a());const u=s.size,_=(i?64:0)|(s.amt<=0||n>=o-1?4:0);switch(e.hm.H.holderstate.ds+=(n>=40?0:2)*e.lm.H.lastdT,r=!0,t.setoptions.garbageentry){case"delayed":e.wfm.WaitFrames(t.setoptions.garbageare*(n+1),"push-garbage-line",{column:h,size:u,edges:_});break;case"continuous":{const s=t.setoptions.garbageare*(n+1);t.garbagearelockeduntil=e.esm.frame+s,e.wfm.WaitFrames(s,"push-garbage-line",{column:h,size:u,edges:_});break}default:c++,e.bm.AreWeToppedYet(),e.bm.PushLine({column:h,size:u,edges:_})}i=!1,s.amt||(t.impendingdamage.shift(),l=!0,i=!0,t.rngex.nextFloat()<p&&a())}t.impendingdamage.push(...h),l&&t.impendingdamage[0]?.queued&&_(),r&&!e.c.IsServer()&&(e.gpm.Vibrate(si.GARBAGERISE),e.sfx.Play("garbagerise"),e.pbm.UpdateGarbageBar("impending")),e.zthm.IncrementPrompt("tank",c)},AnnounceOffensive:function(){if(t.lastoffensive.offence&&(t.spike.count>=10&&e.fim.AddFire(5),t.lastoffensive.offence>=10&&e.fim.AddFire(3*t.lastoffensive.offence)),t.setoptions.usezenconfig&&t.lastoffensive.offence>0&&e.znm.UpdateGarbageOffense(t.lastoffensive.offence),t.lastoffensive.offence&&(t.spike.count+=t.lastoffensive.offence,t.spike.count_nomult+=Math.floor(t.lastoffensive.offence/t.setoptions.garbagemultiplier),t.spike.count>t.stats.garbage.maxspike&&(t.stats.garbage.maxspike=t.spike.count),t.spike.count_nomult>t.stats.garbage.maxspike_nomult&&(t.stats.garbage.maxspike_nomult=t.spike.count_nomult),t.spike.timer=60),!e.c.IsServer()&&"minimal"!==it.video.graphics&&(t.lastoffensive.defense&&e.hm.H.board.fx("popup_defense").create(t.lastoffensive.defense,{x:t.lastoffensive.x,y:t.lastoffensive.y,evasive:e.iom.IsLocal()}),t.lastoffensive.offence)){if(e.hm.IsFullMode()&&t.spike.count>=10&&0!==e.lm.H.soundSkipRate){const n=Bl(e.hm.H.holder,As(Ol.x)*e.Wh,As(Ol.x)*e.Hh);Ur.play("spike_flair",{x:n.x,y:n.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()});const s=Bl(e.hm.H.stackobj,As(Ol.x*t.lastoffensive.x),As(Ol.x*(t.lastoffensive.y-e.B)));Kr(s.x,s.y,1+Math.min(t.spike.count-10,22.5)/2.5),t.lastoffensive.offence>=4&&e.sfx.Play(`thunder${Math.floor(6*Math.random())+1}`,1,!0)}e.hm.H.board.fx("popup_offence").create(t.spike.count,{x:t.lastoffensive.x,y:t.lastoffensive.y,evasive:e.iom.IsLocal()})}},AutoRound:c}};class T extends w{static BagList=["total mayhem","classic","pairs","14-bag","7+1-bag","7+2-bag","7+x-bag","7-bag+oo","7+1-lone-bag","14+1-lone-bag","7+2-lone-bag","14+2-lone-bag","7-bag"];GetLonelyPieces(){const e=this.self.cm.constants.minotypes,t=Object.keys(this.self.cm.constants.tetrominoes).filter((t=>!e.includes(t)));return t.length?t:e}PopulateBag(){const e=this.self.cm.constants.minotypes,t=this.S;let n=[];switch(t.setoptions.bagtype){case"total mayhem":for(let s=0;s<7;s++)n.push(e[Math.floor(t.rng.nextFloat()*e.length)]);break;case"classic":for(let s=0;s<7;s++){let s=Math.floor(t.rng.nextFloat()*(e.length+1));(s===t.lastGenerated||s>=e.length)&&(s=Math.floor(t.rng.nextFloat()*e.length)),t.lastGenerated=s,n.push(e[s])}break;case"pairs":{const s=[...e];t.rng.shuffleArray(s),n=[s[0],s[0],s[0],s[1],s[1],s[1]],t.rng.shuffleArray(n);break}case"14-bag":n=[...e,...e],t.rng.shuffleArray(n);break;case"7+1-bag":n=[...e,e[Math.floor(t.rng.nextFloat()*e.length)]],t.rng.shuffleArray(n);break;case"7+2-bag":n=[...e,e[Math.floor(t.rng.nextFloat()*e.length)],e[Math.floor(t.rng.nextFloat()*e.length)]],t.rng.shuffleArray(n);break;case"7+x-bag":{const s=[3,2,1,1][t.bagid]??0;t.bagex.length<s&&(t.bagex=[...e],t.rng.shuffleArray(t.bagex)),n=[...e,...t.bagex.splice(0,s)],t.rng.shuffleArray(n);break}case"7-bag+oo":{const s=[...e],i=[...e.map((e=>"o"===e?"oo":e))];t.rng.shuffleArray(s),t.rng.shuffleArray(i),n=[...s,...i];break}case"7+1-lone-bag":{const s=this.GetLonelyPieces();n=[...e,s[Math.floor(t.rng.nextFloat()*s.length)]],t.rng.shuffleArray(n);break}case"14+1-lone-bag":{const s=this.GetLonelyPieces();n=[...e,...e,s[Math.floor(t.rng.nextFloat()*s.length)]],t.rng.shuffleArray(n);break}case"7+2-lone-bag":{const s=this.GetLonelyPieces();n=[...e,s[Math.floor(t.rng.nextFloat()*s.length)],s[Math.floor(t.rng.nextFloat()*s.length)]],t.rng.shuffleArray(n);break}case"14+2-lone-bag":{const s=this.GetLonelyPieces();n=[...e,...e,s[Math.floor(t.rng.nextFloat()*s.length)],s[Math.floor(t.rng.nextFloat()*s.length)]],t.rng.shuffleArray(n);break}default:n=[...e],t.rng.shuffleArray(n)}t.bag.push(...n),t.bagid++}PullFromBag(){for(;this.S.bag.length<14;)this.PopulateBag();return this.S.bag.shift()}}const I=function(e){"use strict";const t=e.gsm;function n(){const n=[],s=[];for(let t=0;t<e.T;t++){const t=[],i=[];for(let n=0;n<e.W;n++)t.push(null),i.push(255);n.push(t),s.push(i)}t.board=n,t.boardedges=s,t.quadcolumns=new Array(e.W).fill(0)}const s=[];function i(t,n,i,a){const r=10+Math.ceil(i)*(2*e.W)+n;if(r in s){const e=s[r]>>2*a&3;if(1===e)return!0;if(2===e)return!1}const l=e.cm.constants.tetrominoes[t];if(!l)return!1;const c=l.matrix.data[a],{dx:p,dy:d}=l.matrix,h=c.length;let u=!0;for(let e=0;e<h;e++){if(o(n+(c[e][0]-p),i+(c[e][1]-d))){u=!1;break}}return s[r]|=(u?1:2)<<2*a,u}function o(n,s){return n<0||n>=e.W||(s<0||s>=e.T||(s=Math.ceil(s),void 0===t.board[s]||null!==t.board[s][n]))}function a(){return t.board[0].every((e=>null!==e))}function r(){for(let n=0;n<e.T;n++)if(t.board[n].some((e=>null!==e)))return n;return e.T}function l(){for(let n=0;n<e.T;n++)if(t.board[n].some((e=>"gbd"===e)))return n;return e.T}function c(){for(let n=0;n<e.T;n++)if(t.board[n].every((e=>"gbd"===e)))return n;return e.T}function p(n,s,i,o,a=!1){const r=e.cm.constants.tetrominoes[n].matrix,l=e.cm.GetPieceColor(n);let c=0;for(let n=0;n<r.data[o].length;n++){const p=r.data[o][n][0]-r.dx,d=r.data[o][n][1]-r.dy,h=r.data[o][n][2]??255;if(c=Math.max(Math.ceil(i)+d,c),t.board[Math.ceil(i)+d][s+p]=l,t.boardedges[Math.ceil(i)+d][s+p]=h,e.c.OnClient((()=>{e.hm.H.stackmud.push([Math.ceil(i)+d,s+p,l,h])})),a&&t.setoptions.usebombs){let n=0;for(let o=Math.ceil(i)+d+1;o<e.T&&"gbd"===t.board[o]?.[s+p];o++)t.board[o][s+p]="gb",n++,e.c.OnClient((()=>{if(e.hm.IsFullMode()&&("high"===it.video.graphics||"ultra"===it.video.graphics)){const n=Bl(e.hm.H.stackobj,(s+p)*As(Ol.x)+As(Ol.x/2),(o-e.B)*As(Ol.x)+As(Ol.x/2)),i=Gl.getColor(t.setoptions.minoskin[l]||t.setoptions.minoskin.other,l);Ur.play("mino_explode",{x:n.x,y:n.y,s:e.hm.S(),color:i})}}));n&&e.c.OnClient((()=>{e.gpm.Vibrate(si.DAMAGE_LARGE),e.sfx.Play("bombdetonate"),e.hm.H.holderstate.ds+=20*n*e.lm.H.lastdT,e.hm.H.stackdirty=!0}))}}return c<e.B}function d(t,n,s,i){const o=e.cm.constants.tetrominoes[t].matrix,a=[],r=[];let l=0;for(let e=0;e<o.data[i].length;e++){const t=o.data[i][e][0]-o.dx,c=o.data[i][e][1]-o.dy;l=Math.max(Math.ceil(s)+c,l),a.push(`${Math.ceil(s)+c}x${n+t}`),r.push([Math.ceil(s)+c,n+t])}return{besty:l,shadowTiles:a,shadowTilesArr:r}}return{Resize:function(){const t=e.gsm.setoptions,[n,s,i]=[t.boardwidth,t.boardheight,t.boardbuffer];e.W=n,e.H=s,e.B=i,e.T=s+i,e.Wh=n/2,e.Hh=s/2},ColumnWidth:function(){return Math.max(0,e.W-(t.setoptions.garbageholesize-1))},GetFullLines:function(){const n=[];for(let s=0;s<e.T;s++)t.board[s].every((e=>null!==e&&"gbd"!==e))&&n.push(s);return n},SetupBoard:n,LoadMap:function(s){try{const n=(s=s.replace(/[\s\n\r]/g,"").toLowerCase()).split("?");s=n[0];const i=Object.keys(e.cm.constants.tetrominoes),o=n[1]?.split(",").filter((e=>i.includes(e)));if(t.hold=n?.[2]||null,i.includes(t.hold)||(t.hold=null),s.length%e.W!=0)return;for(t.bag.unshift.apply(t.bag,o??[]);t.bag.length<7;)e.bam.PopulateBag();const a=e.T-s.length/e.W;for(let n=0;n<s.length;n++){const i=a+Math.floor(n/e.W);let o=s[n];"_"===o&&(o=null),"#"===o&&(o="gb"),"@"===o&&(o="gbd"),t.board[i][n%e.W]=o}}catch{n(),t.hold=null,t.bag=[]}},BoardToMap:function(){let n="";for(let s=0;s<e.T;s++)for(let i=0;i<e.W;i++){const e=t.board[s][i];n+=null===e?"_":"gb"===e?"#":"gbd"===e?"@":e}const s=[];return t.started&&t.falling.type&&s.push(t.falling.type),s.push(...t.bag.slice(0,5)),s.length&&(n+=`?${s.toString()}`),n+=""+(t.hold?`?${t.hold}`:""),n},IsLegalAtPos:i,ClearIsLegalAtPosMemo:function(){s.length=0},ClearEdges:function(){const n=[];for(let t=0;t<e.T;t++){const t=[];for(let n=0;n<e.W;n++)t.push(255);n.push(t)}t.boardedges=n},IsOccupied:o,IsOccupiedInv:function(n,s){if(!(Math.round(n)<0||Math.round(n)>=e.W||Math.round(s)<0||Math.round(s)>=e.T||void 0===t.board[Math.round(s)]))return null!==t.board[Math.round(s)][Math.round(n)]},IsFull:a,IsEmpty:function(){return t.board.every((e=>e.every((e=>null===e))))},IsEmptyWithPerma:function(){return t.board.every((e=>e.every((e=>[null,"gbd"].includes(e)))))},IsEmptyWithUnclearable:function(){return t.board.every((e=>e.every((e=>[null,"gbd"].includes(e)))||e.every((e=>["gb","gbd"].includes(e)))))},IsUncolored:function(){return t.board.every((e=>e.every((e=>[null,"gb","gbd"].includes(e)))))},HighestLine:r,HighestLineOfUnclearables:l,HighestLineOfPerma:c,CountGarbageLines:function(){let n=0;for(let s=0;s<e.T;s++)t.board[s].some((e=>["gb","gbd"].includes(e)))&&n++;return n},CountGarbageLinesNoPerma:function(){let n=0;for(let s=0;s<e.T;s++)t.board[s].some((e=>"gb"===e))&&n++;return n},PushActiveToStack:function(){return p(t.falling.type,t.falling.x,t.falling.y,t.falling.r,!0)},PushTetrominoToStack:p,GetTilesAndNextYForPiece:d,PieceMayLockHere:function(n,s,i,o){const a=d(n,s,i,o);if(a.besty<e.B&&!t.setoptions.nolockout)return!1;const r=e.atm.GetPendingGarbageCount(!0),l=Math.min(r,e.atm.GetGarbageCap()),c=t.bag[0],p=e.cm.GetPieceOffset(c),h=e.cm.GetPieceSpawnRotation(c),u=d(c,Math.floor(e.W/2)-1+p[h][0],e.B-2.04+p[h][1]+l,h);let _=!1;return a.shadowTiles.forEach((e=>{u.shadowTiles.includes(e)&&(_=!0)})),u.shadowTilesArr.forEach((n=>{(n[0]>=e.T||null!==t.board[n[0]][n[1]])&&(_=!0)})),!_},RemoveLinesFromStack:function(n,s="line_burst"){const i=[...t.board],o=[...t.boardedges];n.sort(((e,t)=>t-e));for(let e=0;e<n.length;e++){if(o[n[e]-1])for(let t=0;t<o[n[e]-1].length;t++)o[n[e]-1][t]|=4;if(o[n[e]+1])for(let t=0;t<o[n[e]+1].length;t++)o[n[e]+1][t]|=64}for(let t=0;t<n.length;t++)i.splice(n[t],1),o.splice(n[t],1),e.c.OnClient((()=>{e.fxm.ExplodeLine(n[t],s)}));for(let t=n.length-1;t>=0;t--)e.am.RemoveRow(n[t]);for(;i.length<e.T;){const t=[],n=[];for(let s=0;s<e.W;s++)t.push(null),n.push(255);i.unshift(t),o.unshift(n)}t.board=i,t.boardedges=o,e.hm.H.stackdirty=!0},PushLine:function(n){let{column:s=0,size:i=t.setoptions.garbageholesize,edges:o=68,position:p="aboveUnclearable",pos:d="gb",neg:h=null,actor_pos:u,actor_neg:_,actor_pos_data:m,actor_neg_data:g,actor_pos_anchor:f="stack",actor_neg_anchor:b="stack"}=n;if(a())return!1;const C=[...t.board],x=[...t.boardedges],A=[],y=[];let v;if(Array.isArray(s))v=new Set(s);else if(v=function(t,n){const s=new Set([t]);for(let i=1,o=0;i<n;i++)o=t+(o+1)>=e.W?-1:Math.sign(o)>=0?o+1:o-1,s.add(t+o);return s}(s,i),t.setoptions.zenith_doublehole&&t.rngex.nextFloat()<.5){let n=Math.floor(t.rngex.nextFloat()*(e.bm.ColumnWidth()-1));n>=s&&n++,v.add(n)}for(let n=0;n<e.W;n++){let s=d,i=o;v.has(n)?(s=t.setoptions.usebombs?"gbd":h,i=255):((v.has(n+1)||n===e.W-1)&&(i|=16),(v.has(n-1)||0===n)&&(i|=1)),A.push(s),y.push(i)}t.setoptions.usebombs&&"aboveUnclearable"===p&&(p="abovePerma");let B=0;switch(p){case"aboveStack":B=r();break;case"aboveUnclearable":B=l();break;case"abovePerma":B=c();break;default:B=e.T}if(C.shift(),x.shift(),C.splice(B-1,0,A),x.splice(B-1,0,y),e.am.AddRow(B),u||_)for(let t=0;t<e.W;t++)_&&v.has(t)&&e.am.CreateActor(_,t,B-1,b,g),u&&!v.has(t)&&e.am.CreateActor(u,t,B-1,f,m);return t.board=C,t.boardedges=x,t.lastwasattack=!0,e.hm.H.stackdirty=!0,!0},PushUpFallingIfNeeded:function(){if(!t.pause&&!e.fm.IsSleep()&&!i(t.falling.type,t.falling.x,t.falling.y,t.falling.r)){if(!i(t.falling.type,t.falling.x,t.falling.y-1,t.falling.r))return void e.stm.LoseStockOrGameOver(e.gsm.setoptions.topoutisclear?"topout_clear":"garbagesmash");t.falling.y-=1,e.hm.H.fallingdirty=!0}},CheckStackAgainstMap:function(n){if((n=n.replace(/[\s\n\r]/g,"")).length%e.W!=0)return!1;const s=e.T-n.length/e.W;for(let i=0;i<n.length;i++){const o=s+Math.floor(i/e.W),a=i%e.W,r=n[i];if(!t.board[o])return!1;if("*"!==r){if("_"===r&&null!==t.board[o][a])return!1;if("_"!==r&&null===t.board[o][a])return!1}}return!0},AreWeToppedYet:function(){return!!a()&&(e.stm.LoseStockOrGameOver(t.setoptions.topoutisclear?"topout_clear":"garbagesmash"),!0)},DestroyBoard:function(){t.impendingdamage=[];for(let n=0;n<e.T;n++)for(let s=0;s<e.W;s++)null!==t.board[n][s]&&(e.c.OnClient((()=>{if(e.hm.IsFullMode()&&("high"===it.video.graphics||"ultra"===it.video.graphics)){const i=Bl(e.hm.H.stackobj,s*As(Ol.x)+As(Ol.x/2),(n-e.B)*As(Ol.x)+As(Ol.x/2)),o=t.board[n][s],a=Gl.getColor(t.setoptions.minoskin[o]||t.setoptions.minoskin.other,o);Ur.play("mino_dust",{x:i.x,y:i.y,s:e.hm.S(),color:a})}})),t.board[n][s]=null);e.am.DestroyAllActors(),e.c.OnClient((()=>{e.hm.H.stackdirty=!0,e.pbm.UpdateGarbageBar("impending")}))},BlackoutBoard:function(){t.impendingdamage=[];for(let n=0;n<e.T;n++)for(let s=0;s<e.W;s++)null!==t.board[n][s]&&(t.board[n][s]=t.rngex.nextFloat()<.5?"gb":"gbd",e.c.OnClient((()=>{if(e.hm.IsFullMode()&&("high"===it.video.graphics||"ultra"===it.video.graphics)){const i=Bl(e.hm.H.stackobj,s*As(Ol.x)+As(Ol.x/2),(n-e.B)*As(Ol.x)+As(Ol.x/2)),o=t.board[n][s],a=Gl.getColor(t.setoptions.minoskin[o]||t.setoptions.minoskin.other,o);Ur.play("mino_dust",{x:i.x,y:i.y,s:e.hm.S(),color:a})}})));e.am.DestroyAllActors(),e.c.OnClient((()=>{e.hm.H.stackdirty=!0,e.pbm.UpdateGarbageBar("impending")}))}}},M=function(e){"use strict";const t=e.gsm;return{IsInactive:function(n,s,i=!1){if(t.falling.x>=n-2&&t.falling.x<=n+2&&(t.falling.y>=s-2&&t.falling.y<=s+2||e.sdm.H.lastLegal>=s-2&&e.sdm.H.lastLegal<=s+2))return!1;const o=e.bm.IsOccupiedInv(n,s);return i?[[n-2,s-2],[n-1,s-2],[n+0,s-2],[n+1,s-2],[n+2,s-2],[n-2,s-1],[n-1,s-1],[n+0,s-1],[n+1,s-1],[n+2,s-1],[n-2,s+0],[n-1,s+0],[n+1,s+0],[n+2,s+0],[n-2,s+1],[n-1,s+1],[n+0,s+1],[n+1,s+1],[n+2,s+1],[n-2,s+2],[n-1,s+2],[n+0,s+2],[n+1,s+2],[n+2,s+2]].every((t=>{const n=e.bm.IsOccupiedInv(t[0],t[1]);return n===o||void 0===n})):[[n-1,s-1],[n+0,s-1],[n+1,s-1],[n-1,s+0],[n+1,s+0],[n-1,s+1],[n+0,s+1],[n+1,s+1]].every((t=>{const n=e.bm.IsOccupiedInv(t[0],t[1]);return n===o||void 0===n}))}}},E=function(e){"use strict";return{OnClient:function(t){e.iom.IsHeadless()||$t(t)},OnServer:function(t){e.iom.IsHeadless()?t():Nt(t)},IsServer:function(t=!1){return!(t||!e.iom.IsHeadless())||Ut()}}};class D extends w{_constants={};constructor(e){super(e),this._constants_overrides={}}get constants(){return this._constants}get overrides(){return this._constants_overrides}get kickset(){return this._constants.kickset??this._constants.kicksets[this.options.kickset]??this._constants.kicksets["SRS+"]}GetPieceColor(e){return this.kickset.color_overrides[e]??this._constants.tetrominoes_color[e]}GetPieceKickset(e){const t=this._constants.tetrominoes[e];let n=this.kickset;return t.kickset_override&&t.kickset_override in this._constants.kicksets&&(n=this._constants.kicksets[t.kickset_override]),!(t.disallow_kick&&!n.allow_o_kick)&&(t.kickset_special?n[`${t.kickset_special}_kicks`]??n.kicks:n.kicks)}GetPieceOffset(e){return this.kickset.additional_offsets[e]??Array(4).fill([0,0])}GetPieceSpawnRotation(e){return this.kickset.spawn_rotation[e]??0}SetConstantsOverrides(e){for(const[t,n]of Object.entries(e))this._constants_overrides[t]=n}Reload(){0===Object.keys(this._constants_overrides).length?this._constants=L:(this._constants=Gt(L),Object.assign(this._constants,this._constants_overrides))}}const O=function(e){"use strict";const t=e.gsm;return{UpdateCounter:function(n,s){for(let i=1;i<=5;i++)t.setoptions[`slot_counter${i}`]===n&&e.hm.H.board.el(`counter${i}`).update(s)},UpdateCounterTitle:function(n,s){for(let i=1;i<=5;i++)t.setoptions[`slot_counter${i}`]===n&&e.hm.H.board.el(`counter${i}`).update(void 0,void 0,s)},UpdateCounterSubtitle:function(n,s){for(let i=1;i<=5;i++)t.setoptions[`slot_counter${i}`]===n&&e.hm.H.board.el(`counter${i}`).update(void 0,s)}}};class H extends w{static DisplayCounters={timer:"time",stopwatch:"time",level:"level",lines:"lines",allclears:"all clears",hold:"hold",pieces:"pieces",pieces_duo:"pieces",finesse_l:"finesse",finesse:"finesse",keys:"inputs",score:"score",spp:"score",garbage:"garbage",attack:"attack",attack_duo:"attack",vs:"VS score",kills:"KO's",kills_duo:"KO's",placement:"placement"};static DisplayCountersList=Object.keys(this.DisplayCounters);constructor(e){super(e),this.frozen=!1}IsFrozen(){return this.frozen}StartStopwatch(){this.S.time.start=performance.now(),this.S.time.zero=!1}DisplayCounts(){if(!this.IsServer()&&!this.S.destroyed){for(const[e,t]of this.self.stam.GetSlotCounters())this.self.hm.H.board.el(`counter${e}`).update(void 0,void 0,H.DisplayCounters[t]);(this.options.b2bchaining||this.options.b2bcharging)&&this.S.stats.btb>1&&this.self.hm.H.board.el("b2b").create(this.S.stats.btb-1)}}UpdateCounts(){if(this.IsServer())return;if(this.S.destroyed)return;if(this.IsFrozen())return;const e=this.options,t=this.S.stats,n=this.self.atm.GetPendingGarbageCount();if(this.self.pbm.UpdateBar("impending",n/this.H),this.self.pbm.UpdateGarbageBar("impending"),this.self.pbm.UpdateBarTicker("impending","garbagecap",this.self.atm.GetGarbageCap()/this.H),this.self.pbm.UpdateBarTicker("impending","garbageabsolutecap",this.self.atm.GetGarbageAbsoluteCap()/this.H),e.zenlevels?this.self.pbm.UpdateBar("progress",t.zenprogress):e.levels&&!e.absolute_lines?this.self.pbm.UpdateBar("progress",t.level_lines/t.level_lines_needed):"lines"===e.objective_type?this.self.pbm.UpdateBar("progress",t.lines/e.objective_count):"garbage"===e.objective_type&&this.self.pbm.UpdateBar("progress",t.garbage.cleared/e.objective_count),!this.self.hm.IsFullMode())return;this.self.esm.frame%60==0&&(bl=!0),e.display_zen&&this.self.hm.H.board.el("zen").update(t.score,t.zenlevel),e.levels&&!e.absolute_lines?this.self.ctm.UpdateCounter("lines",`${t.level_lines}\f3/${t.level_lines_needed}`):"lines"===e.objective_type?(this.self.ctm.UpdateCounter("lines",`${t.lines}\f3/${e.objective_count}`),e.pro&&(this.self.hm.H.board.el("backer").update(`${Math.max(0,e.objective_count-t.lines)}`),this.self.hm.H.board.el("stackhint").update(Math.max(0,e.objective_count-t.lines)))):this.self.ctm.UpdateCounter("lines",t.lines);let s=t.level;if(e.masterlevels&&t.level>20&&(s="M"+(t.level-20)),this.UpdateVSStats(),"garbage"===e.objective_type?(this.self.ctm.UpdateCounter("garbage",`${t.garbage.cleared}\f3/${e.objective_count}`),e.pro&&(this.self.hm.H.board.el("backer").update(`${Math.max(0,e.objective_count-t.garbage.cleared)}`),this.self.hm.H.board.el("stackhint").update(Math.max(0,e.objective_count-t.garbage.cleared)))):this.self.ctm.UpdateCounter("garbage",t.garbage.cleared),this.self.ctm.UpdateCounter("level",s),this.self.ctm.UpdateCounter("score",t.score.toLocaleString("en-US")),this.self.ctm.UpdateCounter("kills",t.kills),this.self.ctm.UpdateCounter("placement",`\f3#\f5${this.S.placement}`),this.self.ctm.UpdateCounter("keys",`${t.inputs}\f3, ${(t.inputs/Math.max(1,t.piecesplaced)).toFixed(2)}/P`),this.self.ctm.UpdateCounter("spp",`${t.score.toLocaleString("en-US")}\f3, ${Math.round(t.score/Math.max(1,t.piecesplaced)).toLocaleString("en-US")}/P`),this.self.ctm.UpdateCounter("finesse",`${t.finesse.combo}\f3, ${(t.finesse.perfectpieces/Math.max(1,t.piecesplaced)*100).toFixed(2)}%`),this.self.ctm.UpdateCounterSubtitle("finesse",`${t.finesse.faults} fault${1===t.finesse.faults?"":"s"}`),this.self.ctm.UpdateCounter("finesse_l",`${t.finesse.combo}\f3, ${(t.finesse.perfectpieces/Math.max(1,t.piecesplaced)*100).toFixed(2)}%,${t.finesse.faults}F`),this.self.ctm.UpdateCounter("hold",`${t.holds}\f3, ${(t.holds/Math.max(1,t.piecesplaced)*100).toFixed(2)}%`),this.self.ctm.UpdateCounter("allclears",t.clears.allclear),e.zenith_duo&&this.self.zthm.duoOtherSideGame){const e=this.self.zthm.duoOtherSideGame.getState();this.self.ctm.UpdateCounter("kills_duo",t.kills+e.stats.kills)}}UpdateTimers(){if(this.S.time.locked)return;const e=this.S.time,t=this.options,n=e.zero?0:(this.self.esm.frame-e.frameoffset)/60*1e3,s=Math.max(0,(t.objective_time||0)-n);let i=Bt(n);parseInt(i.m)>=60&&(i.m=`${Math.floor(parseInt(i.m)/60)}:${(parseInt(i.m)%60).toString().padStart(2,"0")}`),this.self.ctm.UpdateCounter("stopwatch",it.video.lowrescounters||"minimal"===it.video.graphics?`${i.m}:${i.s}`:`${i.m}:${i.s}\f3.${i.ms}`),i=Bt(s),this.self.ctm.UpdateCounter("timer",it.video.lowrescounters||"minimal"===it.video.graphics?`${i.m}:${i.s}`:`${i.m}:${i.s}\f3.${i.ms}`);const o=Bt(1e3*Math.ceil(s/1e3));"timed"===t.objective_type&&t.pro&&(o.m>=10||"minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&"0"===o.m&&o.s<=10?this.self.hm.H.board.el("backer").update(""):this.self.hm.H.board.el("backer").update(`${"0"===o.m?"":o.m}:${o.s}`))}UpdateVSStats(){if(this.S.time.locked)return;const e=this.S.stats,t=this.self.esm.frame-this.S.time.frameoffset,n=t/60||1,s=t/3600||1,i=(e.garbage.attack+e.garbage.cleared)/Math.max(1,e.piecesplaced)*(e.piecesplaced/n)*100;if(this.self.ctm.UpdateCounter("pieces",it.video.lowrescounters||"minimal"===it.video.graphics?`${e.piecesplaced}\f3, ${(e.piecesplaced/n).toFixed(1)}/S`:`${e.piecesplaced}\f3, ${(e.piecesplaced/n).toFixed(2)}/S`),this.self.ctm.UpdateCounter("attack",it.video.lowrescounters||"minimal"===it.video.graphics?`${e.garbage.attack}\f3, ${Math.round(e.garbage.attack/s)}/M`:`${e.garbage.attack}\f3, ${(e.garbage.attack/s).toFixed(2)}/M`),this.self.ctm.UpdateCounter("vs",it.video.lowrescounters||"minimal"===it.video.graphics?`${Math.floor(i)}`:`${Math.floor(i)}\f3.${Math.floor(100*(i-Math.floor(i))).toString().padStart(2,"0")}`),this.options.zenith_duo&&this.self.zthm.duoOtherSideGame){const t=this.self.zthm.duoOtherSideGame.getState();this.self.ctm.UpdateCounter("pieces_duo",it.video.lowrescounters||"minimal"===it.video.graphics?`${e.piecesplaced+t.stats.piecesplaced}\f3, ${((e.piecesplaced+t.stats.piecesplaced)/n).toFixed(1)}/S`:`${e.piecesplaced+t.stats.piecesplaced}\f3, ${((e.piecesplaced+t.stats.piecesplaced)/n).toFixed(2)}/S`),this.self.ctm.UpdateCounter("attack_duo",it.video.lowrescounters||"minimal"===it.video.graphics?`${e.garbage.attack+t.stats.garbage.attack}\f3, ${Math.round((e.garbage.attack+t.stats.garbage.attack)/s)}/M`:`${e.garbage.attack+t.stats.garbage.attack}\f3, ${((e.garbage.attack+t.stats.garbage.attack)/s).toFixed(2)}/M`),this.self.ctm.UpdateCounter("kills_duo",e.kills+t.stats.kills)}}FinalizeTimer(e){let t=Bt(e);this.self.ctm.UpdateCounter("stopwatch",it.video.lowrescounters||"minimal"===it.video.graphics?`${t.m}:${t.s}`:`${t.m}:${t.s}\f3.${t.ms}`),t=Bt(0),this.self.ctm.UpdateCounter("timer",it.video.lowrescounters||"minimal"===it.video.graphics?`${t.m}:${t.s}`:`${t.m}:${t.s}\f3.${t.ms}`)}}class P extends w{static _EVENTKEYS=["keydown","gpdown","keyup","gpup"];static _KEYBINDS=new Set(["moveLeft","moveRight","rotate180","rotateCCW","rotateCW","softDrop","hardDrop","hold","retry","exit"]);constructor(e,t,n=null){super(e),this._type=t,this._gameid=null,this._replay=n,this._binds=new Map,this._keys=new Set,this._listeners=new Map,this._events=[],this._frame=0,this._frameLength=1e3/60,this._frameDiffs=[],this._lastFrameTime=0,this._lastProvision=15,this._provision=0,this._Setup()}get replay(){return this._replay}get frame(){return this._frame}get gameid(){return this._gameid}set gameid(e){this._gameid=e}_Setup(){switch(this._type){case"keyboard":for(const[e,t]of P._EVENTKEYS.entries()){const n=(e>=2?this._RawKeyUp:this._RawKeyDown).bind(this);this._binds.set(t,n),document.addEventListener(t,n)}if(this.socket){const e=e=>this.Push("ige",...e.iges);this._binds.set("ige",e),this.socket.SetFasterPing(!0),this.socket.on("game.replay.ige",e)}break;case"socket":{const e=this._OnReplayData.bind(this);this._binds.set("replay",e),this.socket.on("game.replay",e);break}}}_OnReplayData(e){this._gameid===e.gameid&&(this._events.push.apply(this._events,e.frames),this._lastProvision=e.provisioned-this._provision,this._provision=e.provisioned,e.frames.some((e=>"end"===e.type))&&this._provision++)}_RawKeyDown(e){if(e.repeat&&!(e.shiftKey||e.ctrlKey||e.altKey))return;if(document.body.classList.contains("chatfocus")||$i>=1)return;if(!e.detail&&e.target.closest("#zen_panel_content"))return;const t=Ct(e);if(this._keys.has(t))return;this._keys.add(t);let n=0;if(this._lastFrameTime){const t=Math.min(performance.now(),e.timeStamp)-this._lastFrameTime,s=Math.floor(t/this._frameLength*10);n=Math.max(0,s/10)}if(e.ctrlKey)switch(e.key){case"z":case"Z":case"y":case"Y":return this._events.push({frame:this._frame+Math.floor(n),type:"keydown",data:{key:"z"===e.key.toLowerCase()?"undo":"redo",subframe:10*n%10/10}}),e.preventDefault()}for(const[s,i]of Object.entries(at))i.includes(t)&&P._KEYBINDS.has(s)&&(this._events.push({frame:this._frame+Math.floor(n),type:"keydown",data:{key:s,subframe:10*n%10/10}}),"retry"===s?this.self.gom.Retry():"exit"===s&&this.self.gom.Forfeit(),e.detail||e.preventDefault())}_RawKeyUp(e){if(document.body.classList.contains("chatfocus")||$i>=1)return;if(!e.detail&&e.target.closest("#zen_panel_content"))return;const t=Ct(e);if(!this._keys.has(t))return;let n=0;if(this._lastFrameTime){const t=Math.min(performance.now(),e.timeStamp)-this._lastFrameTime,s=Math.floor(t/this._frameLength*10);n=Math.max(0,s/10)}this._keys.delete(t);for(const[s,i]of Object.entries(at))i.includes(t)&&P._KEYBINDS.has(s)&&(this._events.push({frame:this._frame+Math.floor(n),type:"keyup",data:{key:s,subframe:10*n%10/10}}),e.detail||e.preventDefault())}GetBehindness(){return!!this.IsSocketLike()&&(this._provision-this._frame)/this._lastProvision}IsReplay(){return"replay"===this._type}IsSocket(){return"socket"===this._type}IsKeyboard(){return"keyboard"===this._type}IsPipe(){return"pipe"===this._type}IsSocketLike(){return"socket"===this._type||"pipe"===this._type}IsFinished(){return!!this.IsReplay()&&this._frame>this._replay.frame}IsNextFrameReady(){return!this.IsSocketLike()||this._provision>this._frame}IsFallingBehind(){return!!this.IsSocketLike()&&this._provision>this._frame+60}_gameIDContext=0;get gameIDContext(){return this.IsReplay()?this._gameIDContext?this._gameIDContext:(this._gameIDContext=Wo,Wo):0}Start(){if(this.IsSocketLike())return;const e=new Set,t=[];for(const n of this._events)"keydown"!==n.type?"keyup"!==n.type?t.push(n):e.delete(n.data.key):e.add(n.data.key);for(const n of e)t.push({frame:this._frame,type:"keydown",data:{key:n,hoisted:!0,subframe:0}});this._events=t}AdvanceFrame(){if(this._frame++,!this.IsKeyboard())return;if(this._events.length)return this._lastFrameTime+=this._frameLength;const e=performance.now(),t=e-this._lastFrameTime;t>=1e3/90&&t<=40&&(this._frameDiffs.push(t),this._frameDiffs.length>10&&(this._frameDiffs.shift(),this._frameLength=this._frameDiffs.reduce(((e,t)=>e+t))/10)),this._lastFrameTime=e}AmountToCatchUp(){return this.IsReplay()?this._replay.frame-this._frame:this.IsSocketLike()?this._provision-this._frame:0}Emit(e){this._listeners.get(e.type)?.forEach((t=>t(e)))}On(e,t){const n=this._listeners.get(e);if(!n)return this._listeners.set(e,[t]);n.push(t)}Pull(){switch(this._type){case"replay":this._replay.GetEventsAtFrame(this._frame).forEach(this.Emit.bind(this));break;case"keyboard":case"socket":case"pipe":{const e=[];for(const t of this._events)t.frame!==this._frame?e.push(t):this.Emit(t);this._events=e;break}}}Push(e,...t){for(const n of t)this._events.push({frame:this._frame,type:e,data:n})}Pipe(e){e.gameid=this._gameid,this._OnReplayData(e)}Seek(e){this._frame=e,this._events.length=0,this._provision=15}Destroy(){if(this._listeners.clear(),this.IsKeyboard())for(const e of P._EVENTKEYS.values())document.removeEventListener(e,this._binds.get(e));this._binds.has("ige")&&this.socket?.off("game.replay.ige",this._binds.get("ige")),this._binds.has("replay")&&this.socket?.off("game.replay",this._binds.get("replay"))}}const R=function(e){"use strict";const t=e.gsm;let n=new Map;const s=["interaction","action"];return{emit:function(i,...o){const a=n.get(i);if(a){for(let e=a.length-1;e>=0;--e){const t=a[e].cb(...o);if(a[e].once&&a.splice(e,1),void 0!==t)return t}!t.setoptions.noreplay&&s.includes(i)&&e.iom.replay.FlushNextFrame()}},on:function(t,s,i,o=!1){let a=n.get(t);a||(a=[],n.set(t,a)),"function"==typeof s&&(o=i,i=s,s=void 0),a.unshift({id:s,cb:i.bind(e.parent),orig_cb:i,once:o})},once:function(...e){this.on(...e,!0)},remove:function(e,t){if(!e)return void n.clear();if(!t)return void n.set(e,[]);const s=n.get(e);s&&n.set(e,s.filter((e=>e.id!==t)))},Export:function(){return n},Import:function(t){n=t;for(const t of n.values())for(const n of t)n.cb=n.orig_cb.bind(e.parent)}}};class W extends w{static init(){this.ROTATION_LEFT=1,this.ROTATION_RIGHT=2,this.ROTATION_180=4,this.ROTATION_SPIN=8,this.ROTATION_MINI=16,this.ROTATION_SPIN_ALL=32,this.ROTATION_ALL=this.ROTATION_LEFT|this.ROTATION_RIGHT|this.ROTATION_180|this.ROTATION_SPIN|this.ROTATION_MINI|this.ROTATION_SPIN_ALL,this.STATE_WALL=64,this.STATE_SLEEP=128,this.STATE_FLOOR=256,this.STATE_NODRAW=512,this.STATE_ALL=this.STATE_WALL|this.STATE_SLEEP|this.STATE_FLOOR|this.STATE_NODRAW,this.ACTION_IHS=1024,this.ACTION_FORCELOCK=2048,this.ACTION_SOFTDROP=4096,this.FLAGS_COUNT=13}get piece(){return this.S.falling}get pieceObj(){return this.self.hm.H.fallingobj}GetEffectiveGravity(){return this.S.glock<=0?this.S.g:this.S.glock<=180?(1-this.S.glock/180)**2*this.S.g:0}HasHitWall(){return!!(this.piece.flags&W.STATE_WALL)}HasRotated(){return!!(this.piece.flags&(W.ROTATION_LEFT|W.ROTATION_RIGHT))}HasRotated180(){return!!(this.piece.flags&W.ROTATION_180)}IsSpin(){return!!(this.piece.flags&W.ROTATION_SPIN)}IsSpinMini(){return!(~this.piece.flags&(W.ROTATION_SPIN|W.ROTATION_MINI))}IsSpinAll(){return!!(this.piece.flags&W.ROTATION_SPIN_ALL)}IsSleep(){return!!(this.piece.flags&W.STATE_SLEEP)}IsFloored(){return!!(this.piece.flags&W.STATE_FLOOR)}IsVisible(){return!(this.piece.flags&W.STATE_NODRAW)}IsSoftdropped(){return!!(this.piece.flags&W.ACTION_SOFTDROP)}Is20G(){const e=this.options.version;if(e<17)throw new Error("The 20G check should not be called before TETR.IO engine version 17. Report this to the programmers.");const t=this.options.boardheight,n=this.GetEffectiveGravity()>=t,s=!(e>=18)||this.S.setoptions.gravitymay20g;if(this.S.inputSoftdrop){const i=!(e>=18)||this.S.handling.may20g||n&&s;return(41===this.S.handling.sdf||this.GetEffectiveGravity()*this.S.handling.sdf>=t)&&i}return n&&s}IsForcedToLock(){return!!(this.piece.flags&W.ACTION_FORCELOCK)}ShouldLock(){return!this.options.infinite_movement&&this.piece.lockresets>=this.options.lockresets}ShouldFallFaster(){if(this.options.infinite_movement)return!1;return this.piece.rotresets>this.options.lockresets+15}ClearFlags(e){this.piece.flags&=~e}_ClampRotation(e){let t=this.piece.r+e;return t>3?t=t-this.piece.r>=2?t-4:0:t<0&&(t=3),t}_InternalLocking(e=1-this.S.subframe){return this.piece.locking+=this.options.version>=15?e:1,this.IsFloored()||(this.piece.flags|=W.STATE_FLOOR,this.sfx.Play("hit")),this.piece.locking>this.options.locktime||(!!this.IsForcedToLock()||this.ShouldLock())}_InternalFall(e){const t=this.piece,{type:n,x:s,y:i,r:o}=t;let a=Math.round(1e6*(i+e))/1e6;a%1==0&&(a+=1e-6);let r=i+1;if(r%1==0&&(r-=2e-6),!this.self.bm.IsLegalAtPos(n,s,a,o)||!this.self.bm.IsLegalAtPos(n,s,r,o))return!1;const{hy:l,y:c}=t;return l<a&&(t.hy=Math.ceil(a)),t.y=a,t.flags&=~W.STATE_FLOOR,this.OnClient((()=>{Math.ceil(a)!==Math.ceil(c)&&(this.self.hm.H.fallingdirty=!0)})),(a>l||this.options.infinite_movement)&&(t.lockresets=0,t.rotresets=0),!0}_InternalFinesse(){const{type:e,keys:t,x:n,r:s}=this.piece,i=this.self.cm.constants.finesse[e];let o=Math.max(0,i?t-(i[s.toString()][n+1]||0):0);return this.IsSoftdropped()&&(o=0),this.S.stats.finesse.faults+=o,this.S.stats.finesse.combo++,o>0?(this.S.stats.finesse.combo=0,!1):(this.S.stats.finesse.perfectpieces++,!0)}_InternalLockout(e){if(this.options.nolockout)return;if(!e||!1!==this.options.clutch)return this.self.stm.LoseStockOrGameOver(this.options.topoutisclear?"topout_clear":"topout");if(this.IsServer())return;const t=it.video;t.siren&&(this.sfx.Play("clutch"),"minimal"!==t.graphics&&"off"!==t.actiontext&&"some"!==t.actiontext&&this.self.hm.H.board.fx("clutch").create("CLUTCH"))}_InternalDCD(){if(!this.HasHitWall()||!this.S.handling.dcd)return;const e=this.S;e.lShift.das=Math.min(e.lShift.das,e.handling.das-e.handling.dcd),e.lShift.arr=e.handling.arr,e.rShift.das=Math.min(e.rShift.das,e.handling.das-e.handling.dcd),e.rShift.arr=e.handling.arr}_InternalRotate(e,t,n,s,{index:i=0,kx:o=0,ky:a=0}={}){const r=this.piece;s>=2&&(s=n>r.r?1:-1,r.flags|=W.ROTATION_180),r.x=e,r.y=t,r.r=n,r.flags|=1===s?W.ROTATION_RIGHT:W.ROTATION_LEFT,r.flags&=~(W.ROTATION_SPIN|W.ROTATION_MINI|W.ROTATION_SPIN_ALL),r.kick=i,r.lockresets<31&&r.lockresets++,r.rotresets<63&&r.rotresets++;const l=this.self.rbm.IsTSpin();if(l?r.flags|=W.ROTATION_SPIN|("mini"===l&&W.ROTATION_MINI):this.options.zenith_duo&&(r.flags|=this.self.rbm.IsTSpin("all")&&W.ROTATION_SPIN_ALL),this.self.hm.H.fallingdirty=!0,this.S.totalRotations++,this.sfx.Play("rotate"),this.self.zthm.IncrementPrompt("rotate"),this._InternalDCD(),this.ShouldLock()||(r.locking=0),!this.IsServer()&&l&&(this.sfx.Play("spin"),this.self.gpm.Vibrate(si.SPIN),this.self.hm.H.holderstate.dr+=s/4*this.self.lm.H.lastdT,this.self.hm.IsFullMode())){const i={direction:1===s?"right":"left",kx:o,ky:a};this.HasRotated180()&&(i.direction=n%2==0?"vertical":"horizontal"),this.self.fxm.EffectAtTetromino("piece_spin",i,this.pieceObj,r.type,e,t,n)}}Fall(e=1-this.S.subframe){if(this.piece.safelock>0&&this.piece.safelock--,this.S.pause)return;if(this.IsSleep())return;const t=this.options,n=t.version,{type:s,x:i,y:o,r:a}=this.piece;let r=this.GetEffectiveGravity()*e;this.S.glock>0&&(this.S.glock-=e,this.S.glock<0&&(this.S.glock=0)),this.S.inputSoftdrop&&(this.S.handling.sdf==(n>=15?41:21)?r=(n>=15?400:20)*e:(r*=this.S.handling.sdf,r=Math.max(r,n>=13?.05*this.S.handling.sdf:.42))),this.ShouldLock()&&!this.self.bm.IsLegalAtPos(s,i,o+1,a)&&(r=20,this.piece.flags|=W.ACTION_FORCELOCK),this.ShouldFallFaster()&&(r+=.5*e*(this.piece.rotresets-(t.lockresets+15)));for(let t=r;t>0;t-=Math.min(1,t)){const{y:n}=this.piece;if(!this._InternalFall(Math.min(1,t)))return void(this._InternalLocking(e)&&(this.S.handling.safelock&&(this.piece.safelock=7),this.Lock()));Math.ceil(n)!==Math.ceil(this.piece.y)&&(this.piece.flags&=~W.ROTATION_ALL,this.S.inputSoftdrop&&(this.S.stats.score+=this.self.cm.constants.scoring.SOFTDROP,this.options.zenlevels&&(this.S.stats.zenprogress+=this.self.znm.ScoreToZenProgress(this.self.cm.constants.scoring.SOFTDROP,this.S.stats.zenlevel)),this.sfx.Play("softdrop")))}}Harddrop(){if(!this.S.pause&&!this.IsSleep())for(this.OnClient((()=>{this.self.gpm.Vibrate(si.HARDDROP),this.sfx.Play("harddrop")}));;){if(!this._InternalFall(1))return this.OnClient((()=>{if(!this.self.hm.IsFullMode())return;if(0===this.self.lm.H.soundSkipRate)return;const{type:e,x:t,y:n,r:s}=this.piece;Ur.play("bgsplash",{direction:180,amt:5}),this.self.fxm.EffectAtTetrominoEdge("harddrop_edge",{},this.pieceObj,e,t,n,s)})),this._InternalLocking(1),this.Lock();this.S.stats.score+=this.self.cm.constants.scoring.HARDDROP,this.options.zenlevels&&(this.S.stats.zenprogress+=this.self.znm.ScoreToZenProgress(this.self.cm.constants.scoring.HARDDROP,this.S.stats.zenlevel)),this.OnClient((()=>{if(!this.self.hm.IsFullMode())return;const{type:e,x:t,y:n,r:s}=this.piece;this.self.fxm.EffectAtTetromino("harddrop_trail",{},this.pieceObj,e,t,n,s)}))}}Rotate(e){if(this.IsSleep())return this.piece.irs=this._ClampRotation(e);const t=this.piece,n=this.self.cm.kickset,[s,i]=[t.r,this._ClampRotation(e)],o=`${s}${i}`,{x:a,y:r,type:l}=t,c=this.self.cm.GetPieceOffset(l),[p,d]=c[s],[h,u]=c[i],[_,m]=[h-p,u-d],[g,f]=[a+_,r+m];if(this.self.bm.IsLegalAtPos(l,g,f,i))return this._InternalRotate(g,f,i,e);const b=this.self.cm.GetPieceKickset(l);if(!b)return;let C=b[o];this.options.version<17&&"ARS"===this.options.kickset&&(C=n.kicks[o]);e:for(const[t,[s,o]]of C.entries()){const c=a+s+_;let h=Math.floor(r)+.1+o+m;if(!this.options.infinite_movement&&this.S.totalRotations>this.options.lockresets+15&&(h=r+o+m),this.self.bm.IsLegalAtPos(l,c,h,i)){if(n.center_column?.pieces.includes(l))for(const[e,t]of n.center_column.rules)if(this.self.bm.IsOccupied(a-p+e,r-d+t)){if(0===e)continue e;break}return this._InternalRotate(c,h,i,e,{index:t,kx:s,ky:o})}}}Hold(){if(this.IsSleep())return this.piece.flags|=W.ACTION_IHS;if(this.S.holdlocked||!1===this.options.display_hold)return;const e=this.piece.type;this.Next(this.S.hold),this.sfx.Play("hold"),this.self.zthm.IncrementPrompt("hold"),this.self.zthm.IncrementPrompt("holdconsecutive"),this.self.zthm.NixPrompt("singlesonly"),this.self.zthm.NixPrompt("nohold"),this.S.hold=e,this.S.holdlocked=!this.options.infinite_hold,this.S.stats.holds++,this.self.hm.H.holddirty=!0}Lock(){const{type:e}=this.piece;this.emit("lock",this.piece),this.piece.flags|=W.STATE_SLEEP,this.S.stats.piecesplaced++,this.self.zthm.IncrementPrompt("pieces"),this.self.zthm.IncrementPrompt("nohold"),this.S.setoptions.zenith_duo&&0===this.S.falling.keys&&this.S.falling.x===Math.ceil(this.W/2)-1+this.self.cm.GetPieceOffset(this.S.falling.type)[this.S.falling.r][0]?this.self.zthm.IncrementPrompt("spam"):this.self.zthm.NixPrompt("spam"),this.S.inputSoftdrop&&this.self.zthm.IncrementPrompt("softdrop"),this.S.lastpiecetime=this.self.esm.frame,this.self.zthm.NixPrompt("idle"),this.OnClient((()=>{const t=this.self.cm.constants.tetrominoes[e].weight;this.sfx.Play("floor"),this.self.hm.H.holderstate.dy+=2*this.self.lm.H.lastdT,t&&(this.sfx.Play("impact",.4*t),this.sfx.Play(`thunder${Math.floor(6*Math.random())+1}`,.1*t),this.self.hm.H.holderstate.dy+=4*t*this.self.lm.H.lastdT,this.self.hm.H.holderstate.ds+=2*t*this.self.lm.H.lastdT,this.self.hm.H.holderstate.dj+=2*t*this.self.lm.H.lastdT)}));const t=this.self.bm.PushActiveToStack(),n=this.self.lcm.ClearLines();let s=n?this.options.lineclear_are:this.options.are;if("delayed"===this.options.garbageentry&&(s=Math.max(s,this.S.lastreceivedcount*this.options.garbageare)),this._InternalFinesse()||this.OnClient((()=>{this.self.hm.IsFullMode()&&this.self.iom.IsLocal()&&(this.options.pro_alert&&(this.sfx.Play("finessefault"),this.self.hm.H.holderstate.ds+=1.5*this.self.lm.H.lastdT),this.options.can_retry&&this.options.pro_retry&&(this.self.hm.H.holderstate.ds+=50*this.self.lm.H.lastdT,this.self.gom.GameOver("retry",!0),this.sfx.Play("detonate2")))})),t&&this._InternalLockout(n),this.options.zenlevels){if(this.S.stats.combo<=2&&this.S.stats.zenprogress>=1&&(this.self.hm.H.fallingdirty=!0,this.self.znm.ZenLevelup()))return;this.self.znm.UpdateZenGravity()}if(s)return this.self.hm.H.fallingdirty=!0,this.self.wfm.WaitFrames(s,"are",{});this.Next()}Next(e){if(this.S.pause)return;this.self.bm.ClearIsLegalAtPosMemo(),this._InternalDCD();const t=e??this.self.bam.PullFromBag(),n=this.piece,s=this.self.cm.GetPieceSpawnRotation(t),[i,o]=this.self.cm.GetPieceOffset(t)[s],[a,r]=[Math.ceil(this.W/2)-1+i,this.B-2.04+o];n.type=t,n.x=a,n.y=r,n.r=s,n.hy=this.B-2,n.flags&=~(W.ROTATION_ALL|W.STATE_ALL|W.ACTION_FORCELOCK|W.ACTION_SOFTDROP),n.keys=0,n.locking=0,n.rotresets=0,n.lockresets=0,this.S.totalRotations=0,this.S.holdlocked=!1,this.self.hm.H.fallingdirty=!0,this.self.hm.H.nextdirty=!0,this.self.hm.H.holddirty=!0,this.self.iom.IsLocal()&&void 0===e&&!1!==this.options.display_next&&this.sfx.Play(this.S.bag[0]),this.self.bm.IsLegalAtPos(t,a,r,s)?this.S.lastwasattack=!1:this.self.stm.LoseStockOrGameOver(this.options.topoutisclear?"topout_clear":this.S.lastwasattack?"garbagesmash":"topout"),n.flags&W.ACTION_IHS&&(n.flags^=W.ACTION_IHS,this.Hold()),0!==n.irs&&(this.Rotate((s+n.irs)%4),n.irs=0),void 0===e&&this.emit("piece",n),this.self.svm.UpdateLoop(),0===this.S.stats.combo&&this.self.svm.UpdateCheeseLayer(),this.options.version>=17&&this.Is20G()&&this.SlamToFloor()}SlamToFloor(){let e=!1;for(;this._InternalFall(1);)this.S.inputSoftdrop&&(this.S.stats.score+=this.self.cm.constants.scoring.SOFTDROP,this.options.zenlevels&&(this.S.stats.zenprogress+=this.self.znm.ScoreToZenProgress(this.self.cm.constants.scoring.SOFTDROP,this.S.stats.zenlevel)),e=!0);e&&this.sfx.Play("softdrop")}SetSleep(e){this.piece.flags=this.piece.flags&~W.STATE_SLEEP|e<<Math.log2(W.STATE_SLEEP)}}W.init();const $=function(e){"use strict";const t=e.gsm;return{LowerFire:function(){t.fireGrace>0?t.fireGrace--:t.fire=Math.max(0,t.fire-5/60)},AddFire:function(n){if(!t.setoptions.display_fire)return;const s=t.fire>=500;t.fire=Math.min(700,t.fire+n),t.fire>=500&&!s&&(e.hm.IsFullMode()&&!e.c.IsServer()&&"minimal"!==it.video.graphics&&!1!==it.video.fire&&(e.sfx.Play("fire"),e.hm.H.board.el("username").action("startfire")),t.fireGrace=300,t.fire=Math.min(700,t.fire+14))},PullFire:function(n=1){e.c.IsServer()||(t.fire!==t.fireAppr&&("minimal"===it.video.graphics||e.hm.IsTinyMode()?t.fireAppr=t.fire:(t.fireAppr=t.fire+(t.fireAppr-t.fire)*Math.pow(.9,n),Math.abs(t.fireAppr-t.fire)<.01&&(t.fireAppr=t.fire))),"minimal"!==it.video.graphics&&!1!==it.video.fire&&(e.hm.H.board.el("username").update(t.fireAppr),t.fireAppr>=500&&t.playing&&e.hm.H.board.el("username").action("continuefire")))}}},N=function(e){"use strict";const t=e.gsm;return{ExplodeLine:function(n,s="line_burst"){e.c.IsServer()||"low"!==it.video.graphics&&"minimal"!==it.video.graphics&&e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate&&e.hm.IsFullMode()&&(Ur.play("bgsplash",{direction:90,amt:5}),Ur.play("bgsplash",{direction:270,amt:5}),function(n,s,i){if(e.c.IsServer())return;if("low"===it.video.graphics||"minimal"===it.video.graphics||e.hm.IsTinyMode()||0===e.lm.H.soundSkipRate)return;for(let o=0;o<e.W;o++){const a=Bl(e.hm.H.stackobj,o*As(Ol.x)+As(Ol.x/2),(i-e.B)*As(Ol.x)+As(Ol.x/2)),r=t.board[i][o];let l=Gl.getColor(t.setoptions.minoskin[r]||t.setoptions.minoskin.other,r),c=n;"line_burst"===n&&"bob"===t.board[i][o]&&(c="line_bubble",l=61695),Ur.play(c,{x:a.x,y:a.y,s:e.hm.S(),color:l,...s})}}(s,{},n))},EffectAtTetromino:function(n,s,i,o,a,r,l){if(e.c.IsServer())return;if("low"===it.video.graphics||"minimal"===it.video.graphics||0===e.lm.H.soundSkipRate)return;const c=e.cm.constants.tetrominoes[o],p=e.cm.GetPieceColor(o),d=Gl.getColor(t.setoptions.minoskin[p]||t.setoptions.minoskin.other,p);for(let t=0;t<c.matrix.data[l].length;t++){const o=c.matrix.data[l][t][1]-c.matrix.dy,p=Bl(i,(a+(c.matrix.data[l][t][0]-c.matrix.dx))*As(Ol.x)+As(Ol.x/2),(Math.ceil(r)+o-e.B)*As(Ol.x)+As(Ol.x/2));Ur.play(n,{x:p.x,y:p.y,color:d,...s})}},EffectAtTetrominoEdge:function(n,s,i,o,a,r,l){if(e.c.IsServer())return;if("low"===it.video.graphics||"minimal"===it.video.graphics||0===e.lm.H.soundSkipRate)return;const c=e.cm.constants.tetrominoes[o],p=e.cm.GetPieceColor(o),d=Gl.getColor(t.setoptions.minoskin[p]||t.setoptions.minoskin.other,p);for(let t=0;t<c.matrix.data[l].length;t++){const o=c.matrix.data[l][t][0]-c.matrix.dx,p=c.matrix.data[l][t][1]-c.matrix.dy;if(e.bm.IsOccupied(a+o,Math.ceil(r)+p+1)){const t=Bl(i,(a+o)*As(Ol.x)+As(Ol.x/2),(Math.ceil(r)+p-e.B)*As(Ol.x)+As(Ol.x));Ur.play(n,{x:t.x,y:t.y,color:d,...s})}}}}};class U extends w{constructor(e){super(e),this._seenIGEs=new Set,this._defIGEs=new Set(["interaction_confirm","kev","targeted"]),this.self.esm.On("ige",this.HandleIGE.bind(this)),this.self.esm.On("strategy",this.HandleStrategies.bind(this)),this.self.esm.On("manual_target",this.HandleManualTarget.bind(this))}_PushReplay(e,t){this.options.noreplay||this.self.iom.replay.PushEvent(e,t)}_IsDeferrable(e){if(this.IsServer())return!1;if(!this.self.iom.IsLocal())return!1;const{type:t,data:{gameid:n,frame:s}}=e;if(!this._defIGEs.has(t))return!1;if(null==s)return!1;if(null==n)return!1;const i=v.get(n+this.self.esm.gameIDContext);if(!i?.isScoped())return!1;const o=i.getFrame(),a=this.self.esm.frame-o;return!(!a||a>200)}HandleIGE({data:e}){if(this._seenIGEs.has(e.id))return;if(this._seenIGEs.add(e.id),!this._IsDeferrable(e))return this._IGEAction(e);const t=v.get(e.data.gameid+this.self.esm.gameIDContext);Promise.race([new Promise((e=>setTimeout(e,4e3))),t.awaitFrame(e.data.frame)]).then((()=>this._IGEAction(e)))}_IGEAction(e){this._PushReplay("ige",e);const t=e.data;switch(e.type){case"interaction":return"garbage"===t.type?this.self.atm.AddPendingGarbage(t):void 0;case"interaction_confirm":switch(t.type){case"garbage":return this.self.atm.IncomingAttack(t);case"zenith.climb_pts":return this.self.zthm.GiveClimbPts(t.amt,!0);case"zenith.bonus":return this.self.zthm.GiveBonus(t.amt,!0);case"zenith.incapacitated":return this.self.zthm.IncapacitateOther();case"zenith.revive":return this.self.zthm.ReviveSelf();default:return}case"target":return this.self.tm.SetTargets(t.targets);case"targeted":return t.value?this.self.tm.AddEnemy(t.gameid):this.self.tm.RemoveEnemy(t.gameid);case"allow_targeting":return this.self.tm.SetEnabled(t.value);case"kev":this.self.tm.RemovePlayer(t.victim.gameid),t.killer.gameid===this.id&&(this.self.fim.AddFire(150+t.fire/700*200),this.S.stats.kills++,this.options.zenith&&this.self.zthm.AwardKill());break;case"custom":return this.DoCustomEvents(e.data)}}HandleStrategies(e){this._PushReplay("strategy",e.data),this.self.tm.SetStrategy(e.data)}HandleManualTarget(e){this._PushReplay("manual_target",e.data),this.self.tm.SetStrategy(4,e.data)}ClearSeenIGEs(){return this._seenIGEs.clear()}_IsSamePiece(e,t){const n=e.matrix,s=t.matrix,i=n.data[0],o=s.data[0];switch(!1){case n.w===s.w:case n.h===s.h:case n.dx===s.dx:case n.dy===s.dy:case i.length===o.length:case i.every(((e,t)=>o[t][0]===e[0]&&o[t][1]===e[1])):return!1}return!0}DoCustomEvents(e){const t=e.data,n=this.S;switch(e.type){case"garbage":{const e=t.column??Math.floor(n.rngex.nextFloat()*this.self.bm.ColumnWidth()),s={type:"garbage",amt:t.amt,delay:t.delay,queued:t.queued,size:t.size,username:t.username,column:e};"impending"!==n.setoptions.slot_bar1&&(n.setoptions.slot_bar1="impending",this.self.hm.CreateHolder()),this.self.atm.AddPendingGarbage(s);break}case"map":this.self.bm.DestroyBoard(),this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.ClearEdges(),t.w===this.W&&t.h===this.H||(n.setoptions.boardwidth=t.w,n.setoptions.boardheight=t.h,n.setoptions.boardbuffer=t.h,this.self.bm.Resize(),this.self.bm.SetupBoard(),this.self.hm.CreateHolder()),this.self.bm.LoadMap(t.map),this.self.fm.SetSleep(!0),this.self.hm.H.fallingdirty=!0,this.self.wfm.WaitFrames(60,"are",{}),this.OnClient((()=>this.self.hm.H.holderstate.ds+=25*this.self.lm.H.lastdT)),this.sfx.Play("map_change");break;case"queue":{const e=Object.keys(this.self.cm.constants.tetrominoes),s=t.queue.filter((t=>e.includes(t)));if(!s.length)return;n.bag[t.start?"unshift":"push"].apply(n.bag,s),this.self.hm.H.nextdirty=!0,t.start&&this.sfx.Play("queue_change",.5,.33);break}case"piece":{const e=Object.keys(this.self.cm.constants.tetrominoes),s=t.piece;if(!e.includes(s))return;n.bag.unshift(n.falling.type),n.bag.unshift(s),this.self.fm.SetSleep(!0),this.self.hm.H.fallingdirty=!0,this.self.wfm.WaitFrames(60,"are",{}),this.OnClient((()=>this.self.hm.H.holderstate.ds+=25*this.self.lm.H.lastdT)),this.sfx.Play("piece_change");break}case"lines":{const e=t.action,s=t.column??Math.floor(n.rngex.nextFloat()*this.self.bm.ColumnWidth()),i=t.perma,o=t.size,a=t.slow??0,r=t.effect,l=i?this.T:this.self.bm.HighestLineOfPerma();let c=Math.min(t.amt,l);switch(e){case"add":{let e=!0,t=!1;for(let n=1;c>0;c--,n++){t=c<=0;const r=(e?64:0)|(t?4:0);a>=1&&!i?this.self.wfm.WaitFrames(a*(n+1),"push-garbage-line",{column:s,size:o,edges:r}):(this.self.bm.PushLine(i?{column:[],pos:"gbd",position:"bottom"}:{column:s,size:o,edges:r}),this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),e=!1}break}default:{const e=[];for(let t=c;t;t--)e.push(l-t);this.self.bm.RemoveLinesFromStack(e,r),this.self.bm.ClearIsLegalAtPosMemo(),this.self.hm.H.fallingdirty=!0,this.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.sfx.Play("garbagerise")}));break}}break}case"boardsize":{const[e,s]=[t.w,t.h];this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.DestroyBoard(),n.setoptions.boardwidth=e,n.setoptions.boardheight=s,n.setoptions.boardbuffer=s,this.self.bm.Resize(),this.self.bm.SetupBoard(),this.self.hm.CreateHolder(),n.bag.unshift(n.falling.type),this.self.fm.SetSleep(!0),this.self.hm.H.fallingdirty=!0,this.self.wfm.WaitFrames(30,"are",{}),this.OnClient((()=>this.self.hm.H.holderstate.ds+=25*this.self.lm.H.lastdT)),this.sfx.Play("map_change");break}case"boardresize":{const[e,s]=[t.w,t.h];this.self.bm.ClearIsLegalAtPosMemo(),n.setoptions.boardwidth=e,n.setoptions.boardheight=s,n.setoptions.boardbuffer=s,this.self.bm.Resize();for(let e=n.board.length-this.T;e>0;e-=2)n.board.splice(n.board.length/2,1),n.board.shift(),n.boardedges.splice(n.boardedges.length/2,1),n.boardedges.shift();for(let e=n.board.length;e<this.T;e+=2)n.board.splice(n.board.length/2,0,new Array(this.W).fill(null)),n.board.unshift(new Array(this.W).fill(null)),n.boardedges.splice(n.board.length/2,0,new Array(this.W).fill(255)),n.boardedges.unshift(new Array(this.W).fill(255));for(const e of n.board){e.length=this.W;for(const[t,n]of e.entries())void 0===n&&(e[t]=null)}this.self.hm.CreateHolder(),this.self.hm.H.fallingdirty=!0;break}case"holderstate":for(const[e,n]of Object.entries(t.options))this.self.hm.H.holderstate[e]=n;break;case"setoptions":{let e=!1;for(const[s,i]of Object.entries(t.options))switch(n.setoptions[s]=i,s){case"g":n.g=i;break;case"shielded":i&&(n.impendingdamage=[],this.OnClient((()=>this.self.pbm.UpdateGarbageBar("impending"))));break;case"display_impending":n.setoptions.slot_bar1=i?"impending":"",e=!0;break;case"display_progress":n.setoptions.slot_bar2=i?"progress":"",e=!0;break;case"inverted":n.rShift.held=!1,n.rShift.das=0,n.lShift.held=!1,n.lShift.das=0;break;case"stock":n.stock=i,e=!0;break;case"username":n.setoptions.display_username=!0,e=!0;break;case"nextcount":case"display_hold":case"display_next":e=!0}e&&this.self.hm.CreateHolder();break}case"constants":this.self.cm.SetConstantsOverrides(t.options),this.self.cm.Reload();break;case"tetrominoes":{const e={...this.self.cm.constants.tetrominoes},s=t.tetrominoes,i=t.minotypes,o=t.tetrominoes_color,a=n.falling.type,r=n.bag.filter((e=>e in s));let l=!1;this.self.cm.SetConstantsOverrides({minotypes:i,tetrominoes:s,tetrominoes_color:o}),this.self.cm.Reload(),this.self.bm.ClearIsLegalAtPosMemo(),this.self.hm.H.nextdirty=!0,this.self.hm.H.holddirty=!0,n.hold in s||(n.hold=null),n.bag.length!==r.length&&(n.bag=r),a in s?this._IsSamePiece(s[a],e[a])||(n.bag.unshift(n.falling.type),l=!0):l=!0,l&&(n.falling.flags|=W.STATE_NODRAW,this.self.fm.SetSleep(!0),this.self.hm.H.fallingdirty=!0,this.self.wfm.WaitFrames(30,"are",{}),this.OnClient((()=>this.self.hm.H.holderstate.ds+=25*this.self.lm.H.lastdT)),this.sfx.Play("piece_change"));break}}}}const G=function(e){"use strict";return{otherstates:{lastpiece:null,undo:[],redo:[]},setoptions:{},handling:{},subframe:0,started:!1,countdown_started:!1,playing:!0,pause:!0,destroyed:!1,successful:!1,endqueued:!1,waitingframes:[],unsafewaitingframes:[],garbagearelockeduntil:0,gameoverreason:null,g:.25,glock:0,board:[],boardedges:[],bag:[],bagex:[],bagid:0,hold:null,holdlocked:!1,actors:{},rng:null,rngex:null,lastGenerated:null,falling:{type:"i",x:0,y:0,r:0,hy:0,irs:0,kick:0,keys:0,flags:0,safelock:0,locking:0,lockresets:0,rotresets:0},totalRotations:0,lShift:{held:!1,arr:0,das:0,dir:-1},rShift:{held:!1,arr:0,das:0,dir:1},lastshift:-1,inputSoftdrop:!1,time:{start:0,zero:!0,locked:!1,prev:0,frameoffset:0},lastpiecetime:0,stats:{lines:0,level_lines:0,level_lines_needed:1,inputs:0,holds:0,score:0,zenlevel:1,zenprogress:0,level:0,combo:0,topcombo:0,combopower:0,btb:0,topbtb:0,btbpower:0,tspins:0,piecesplaced:0,clears:{singles:0,doubles:0,triples:0,quads:0,pentas:0,realtspins:0,minitspins:0,minitspinsingles:0,tspinsingles:0,minitspindoubles:0,tspindoubles:0,minitspintriples:0,tspintriples:0,minitspinquads:0,tspinquads:0,tspinpentas:0,allclear:0},garbage:{sent:0,sent_nomult:0,maxspike:0,maxspike_nomult:0,received:0,attack:0,cleared:0},kills:0,finesse:{combo:0,faults:0,perfectpieces:0},zenith:{altitude:0,rank:1,peakrank:1,avgrankpts:0,floor:0,targetingfactor:3,targetinggrace:0,totalbonus:0,revives:0,revivesTotal:0,speedrun:!1,speedrun_seen:!1,splits:[0,0,0,0,0,0,0,0,0]}},zenith:{climb_pts:0,rank_locked_until:-1,last_rank_change_was_promote:!1,promotion_fatigue:0,bonusremaining:0,incapacitated:!1,allyincapacitated:!1,reviveprompts:[],promptstarttime:0,quadbuckets:[],spinbuckets:[],lastclear:null,lastclearwasdupe:!1,isDanger:!1,top3rowsince:null,nogarbagesince:null,lastcancel:0,bonusfromally:0,highestrevive:0},stock:0,quadcolumns:[],diyusi:0,enemies:[],targets:[],laststrategychange:0,interactionid:0,killer:{gameid:0,type:"sizzle"},impendingdamage:[],garbageid:0,windupwaituntil:0,lastwasattack:!1,lastreceivedcount:0,garbagereceived:0,garbagebonus:0,lastoffensive:{x:0,y:0,offence:0,defense:0},lastcolumn:null,lastatktime:0,lasttanktime:0,cancelstreak:0,cheesespawned:0,notyetreceivedattacks:0,garbageacknowledgements:{outgoing:{},incoming:{}},spike:{count:0,count_nomult:0,timer:0},placement:1,fire:0,fireAppr:0,fireGrace:0,escAllowed:!0,esc:!1,esciter:0,retryAllowed:!0,retry:!1,retryiter:0,hyperRetryAllowed:!0,hyperForfeitAllowed:!0}},X=function(e){"use strict";return{Vibrate:function(t){e.c.IsServer()||e.iom.IsLocal()&&si.pulse(...t)}}},j=function(e){"use strict";const t=e.gsm;function n(n,o=!1){if((!t.pause||o)&&t.playing){if(e.fm.SetSleep(!0),t.playing=!1,t.escAllowed=!1,t.retryAllowed=!1,t.gameoverreason=n,t.stats.finaltime=e.lm.GetGameTime(),t.setoptions.noreplay||e.iom.replay.PushEvent("end",e.siom.Export()),e.c.IsServer()){switch(n){case"disconnect":case"topout":case"garbagesmash":case"forfeit":e.elm.emit("fail",n,t.killer,t.fire);break;case"clear":case"topout_clear":case"winner":e.elm.emit("finish",e.lm.GetGameTime())}return e.elm.emit("stop",n),void i()}switch(t.setoptions.zenlevels&&(Rs.saveZen({map:e.bm.BoardToMap(),level:t.stats.zenlevel,progress:t.stats.zenprogress,score:t.stats.score},800),t.setoptions.usezenconfig&&xt("zen_panel").classList.add("hidden")),e.hm.H.fallingobj.visible=!1,e.dsm.UpdateCounts(),e.iom.IsLocal()&&"forfeit"!==n&&xt("forfeit").classList.add("hidden"),e.iom.IsLocal()&&"retry"!==n&&xt("retry").classList.add("hidden"),e.lm.H.stopgame=!0,e.iom.IsLocal()&&!t.setoptions.display_replay&&(document.body.classList.remove("ingame_phys"),!Or()&&it.notifications.suppress&&on()),e.rbm.AwardSecrets(),t.setoptions.zenith&&e.iom.IsLocal()&&["topout","garbagesmash"].includes(n)&&(n="zenith"),n){case"topout":if(t.setoptions.hasgarbage&&e.iom.IsOnline()&&e.atm.TakeAllDamage(!0),e.gpm.Vibrate(si.TOPOUT),e.sfx.Play("topout"),e.mm.Stop(.2),e.hm.H.holderstate.ds+=50*e.lm.H.lastdT,e.hm.IsFullMode()&&(Ur.play("bgsplashdanger",{direction:0,amt:50}),Ur.play("bgcircle",{color:16720384,amt:300,speed:300})),!1!==it.video.siren&&e.hm.IsFullMode()){const t=Bl(e.hm.H.stackobj,As(Ol.x*e.Wh),As(Ol.x*e.Hh));Ur.play("death_flair",{x:t.x,y:t.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()})}t.killer.type="sizzle",e.elm.emit("fail",n,t.killer,t.fire),setTimeout((()=>{e.pm.H.siren=!1,e.hm.H.pullingholder=!1;const t=Math.sign(Math.random()-.5);El.animate(e.hm.H.holder,{0:{y:"inherit",rotation:0},1:{y:As(800)+window.innerHeight,rotation:.3*t}},1,s(.37,.06,.75,.56))}),250),setTimeout((()=>{i()}),1250);break;case"garbagesmash":{if(t.setoptions.hasgarbage&&e.iom.IsOnline()&&e.atm.TakeAllDamage(!0),e.sfx.Play("topout"),e.gpm.Vibrate(si.GARBAGESMASH),e.sfx.Play("garbagesmash"),e.mm.Stop(.2),e.hm.H.holderstate.ds+=100*e.lm.H.lastdT,e.hm.IsFullMode()&&(Ur.play("bgsplashdanger",{direction:0,amt:50}),Ur.play("bgcircle",{color:16720384,amt:300,speed:300})),!1!==it.video.siren&&e.hm.IsFullMode()){const t=Bl(e.hm.H.stackobj,As(Ol.x*e.Wh),As(Ol.x*e.Hh));Ur.play("death_flair",{x:t.x,y:t.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()})}t.killer.type="spark";let o=e.T-e.bm.HighestLine();o+=e.atm.GetPendingGarbageCount(),o>=e.T&&(t.killer.type="spike"),e.elm.emit("fail",n,t.killer,t.fire),setTimeout((()=>{e.pm.H.siren=!1,e.hm.H.pullingholder=!1;const t=Math.sign(Math.random()-.5);El.animate(e.hm.H.holder,{0:{y:"inherit",rotation:0},1:{y:As(800)+window.innerHeight,rotation:.3*t}},1,s(.37,.06,.75,.56))}),250),setTimeout((()=>{i()}),1250);break}case"zenith":{if(t.setoptions.hasgarbage&&e.iom.IsOnline()&&e.atm.TakeAllDamage(!0),e.sfx.Play("topout"),e.gpm.Vibrate(si.GARBAGESMASH),e.sfx.Play("garbagesmash"),e.mm.Stop(.2),e.hm.H.holderstate.ds+=100*e.lm.H.lastdT,e.hm.H.holderstate.dw+=15*e.lm.H.lastdT,e.hm.H.holderstate.dj+=20*e.lm.H.lastdT,e.hm.IsFullMode()&&(Ur.play("bgsplashdanger",{direction:0,amt:50}),Ur.play("bgcircle",{color:16720384,amt:300,speed:300}),e.ssm.GlobalShout("gameover","GAME OVER")),!1!==it.video.siren&&e.hm.IsFullMode()){const t=Bl(e.hm.H.stackobj,As(Ol.x*e.Wh),As(Ol.x*e.Hh));Ur.play("death_flair",{x:t.x,y:t.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()})}t.killer.type="spark";let o=e.T-e.bm.HighestLine();o+=e.atm.GetPendingGarbageCount(),o>=e.T&&(t.killer.type="spike"),e.elm.emit("fail",n,t.killer,t.fire),setTimeout((()=>{El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit"},1:{"scale.x":.6,"scale.y":.6}},1.5,s(.12,.51,.67,.86))}),250),setTimeout((()=>{e.hm.H.pullingholder=!1,e.pm.H.siren=!1;const t=Math.sign(Math.random()-.5);El.animate(e.hm.H.holder,{0:{y:"inherit",rotation:0},1:{y:As(800)+window.innerHeight,rotation:.3*t}},1,s(.37,.06,.75,.56))}),750),setTimeout((()=>{i()}),1750);break}case"clear":{e.sfx.Play("finish"),e.mm.Stop(.2),e.pm.H.siren=!1,e.hm.H.pullingholder=!1,t.time.locked=!0,e.gpm.Vibrate(si.CLEAR),El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:1},1:{"scale.x":5,"scale.y":5,alpha:0}},5,s(.1,.16,.94,.06)),e.hm.IsFullMode()&&(Ur.play("bgcircle",{amt:300,speed:300}),e.ssm.GlobalShout("finish","FINISH"));const n=e.lm.GetGameTime();e.elm.emit("finish",n),e.dsm.FinalizeTimer(n),setTimeout((()=>{i()}),1e4);break}case"topout_clear":e.gpm.Vibrate(si.TOPOUT),e.sfx.Play("gameover"),e.mm.Stop(.2),e.hm.H.holderstate.ds+=100*e.lm.H.lastdT,e.hm.IsFullMode()&&(Ur.play("bgsplashdanger",{direction:0,amt:50}),Ur.play("bgcircle",{color:16720384,amt:300,speed:300}),e.ssm.GlobalShout("gameover","GAME OVER")),setTimeout((()=>{e.pm.H.siren=!1,e.hm.H.pullingholder=!1,t.time.locked=!0,El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:1},1:{"scale.x":.5,"scale.y":.5,alpha:0}},5,s(.1,.16,.94,.06));const n=e.lm.GetGameTime();e.elm.emit("finish",n),e.dsm.FinalizeTimer(n)}),250),setTimeout((()=>{i()}),1e4);break;case"winner":e.sfx.Play("finish"),e.mm.Stop(.2),e.pm.H.siren=!1,e.hm.H.pullingholder=!1,t.time.locked=!0,e.gpm.Vibrate(si.CLEAR),El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:1},1:{"scale.x":2,"scale.y":2,alpha:0}},3,s(.1,.16,.94,.06)),e.hm.IsFullMode()&&Ur.play("bgcircle",{amt:300,speed:300}),e.elm.emit("finish",e.lm.GetGameTime()),setTimeout((()=>{i()}),3500);break;case"forfeit":e.mm.Stop(.2),e.pm.H.siren=!1,e.hm.H.pullingholder=!1,El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:1},1:{"scale.x":0,"scale.y":0,alpha:.5}},1,s(.22,.09,.84,.23)),xt("forfeit").classList.add("hidden"),e.elm.emit("quit",n),setTimeout((()=>{Ur.play("bgcircle",{radius:10}),e.sfx.Play("detonated")}),1e3),setTimeout((()=>{i()}),5e3);break;case"retry":e.pm.H.siren=!1,e.hm.H.pullingholder=!1,El.animate(e.hm.H.holder,{0:{"scale.x":"inherit"},1:{"scale.x":0}},t.setoptions.stride?.05:.25,s(.36,.01,.75,.3)),xt("retry").classList.add("hidden"),setTimeout((()=>{i()}),t.setoptions.stride?50:1e3),t.setoptions.bgmnoreset||e.mm.Stop(.2),setTimeout((()=>{t.setoptions.fromretry||(t.setoptions.countdown_interval*=.75),pi=new B("keyboard"),pi.importListeners(e.elm.Export()),pi.setGame({...e.stam.gameOptions,precountdown:500,prestart:0,mission:"",zoominto:"fast",fromretry:!0,...e.stam.gameOptions.bgmnoreset&&e.mm.H.songWasPlayed?{song:"none"}:{}}),pi.createGameHolder(e.hm.H.displaymode),pi.startGame()}),t.setoptions.stride?50:250),Rs.reportAbortedGame();break;case"drop":e.mm.Stop(.2),e.pm.H.siren=!1,e.hm.H.pullingholder=!1,e.elm.emit("quit",n),El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:1},1:{"scale.x":0,"scale.y":0,alpha:.5}},.5,s(.36,.01,.75,.3)),setTimeout((()=>{Ur.play("bgcircle",{radius:10}),e.sfx.Play("detonated")}),500),setTimeout((()=>{i()}),550);break;case"dropnow":return e.mm.Stop(.2),e.pm.H.siren=!1,e.hm.H.pullingholder=!1,El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:1},1:{"scale.x":0,"scale.y":0,alpha:.5}},.5,s(.36,.01,.75,.3)),setTimeout((()=>{Ur.play("bgcircle",{radius:10}),e.sfx.Play("detonated")}),500),setTimeout((()=>{i()}),550),void e.elm.emit("stop",n);case"disconnect":e.mm.Stop(.2),e.pm.H.siren=!1,e.hm.H.pullingholder=!1,e.elm.emit("fail",n,t.killer,t.fire),El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:"inherit"},1:{"scale.x":2,"scale.y":0,alpha:0}},.25,s(.09,.73,.23,.9)),setTimeout((()=>{i()}),300);break;default:i()}e.elm.emit("end",n),e.elm.emit("stop",n)}}function i(){e.esm.Destroy(),e.c.IsServer()||(v.delete(t.setoptions.gameid+e.esm.gameIDContext),e.iom.SetScoped(!1),e.hm.H.holder&&!e.hm.H.holder._destroyed&&e.hm.H.holder.destroy(),t.destroyed=!0,e.lm.H.stopdraw=!0,e.lm.H.stopgame=!0,e.iom.IsLocal()&&(nl.opacity(1),nl.scale(1)),e.otm.EndOverText())}return{GameOver:n,Retry:function(){e.iom.IsLocal()&&t.setoptions.can_retry&&(t.setoptions.retryisclear||t.hyperRetryAllowed&&(n("retry",!0),e.sfx.Play("detonate2"),t.hyperRetryAllowed=!1))},Forfeit:function(){e.iom.IsLocal()&&t.setoptions.can_retry&&t.hyperForfeitAllowed&&(n("forfeit",!0),e.sfx.Play("detonate2"),t.hyperForfeitAllowed=!1)},Destroy:i}},q=function(e){"use strict";const t=e.gsm,n={holder:null,displaymode:"none",board:null,leftside:null,rightside:null,stackobj:null,stackmud:[],stackdirty:!0,fallingobj:null,fallingdirty:!0,nextobj:null,nextdirty:!0,holdobj:null,holddirty:!0,tintables:[],fgtintables:[],hybridtintables:[],pullingholder:!0,holderneedsrepull:!1,holderstate:{x:0,y:0,r:0,s:0,w:0,j:0,br:0,dx:0,dy:0,dr:0,ds:0,dw:0,dj:0,ox:0,oy:0,os:1,cox:0,coy:0,cos:1,btr:255,btg:255,btb:255,tr:255,tg:255,tb:255,ctr:255,ctg:255,ctb:255,fgtr:0,fgtg:0,fgtb:0,fgctr:0,fgctg:0,fgctb:0,asf:1},duoSideLock:null,duoIsRight:!1,rhythmBlast:0},i=n.holderstate;function o(){return"full"===n.displaymode}function r(){return"tiny"===n.displaymode}let l=null,c=null,p=null,d=null;function h(e,t,s,i,o){n.holder&&!n.holder._destroyed&&(s=s/360*2*Math.PI,(e!==l||o)&&(l=e,n.holder.x=As(800)+e),(t!==c||o)&&(c=t,n.holder.y=As(400)+t),(s!==p||o)&&(p=s,n.holder.rotation=s),(i!==d||o)&&(d=i,n.holder.scale.set(i),n.holder.zIndex=n.duoIsRight?n.holderstate.os+1e-6:n.holderstate.os))}function u(e,t,n){return e<<16|t<<8|n}function _(s=!1,o=1){if(e.c.IsServer())return;if(e.lm.H.lastdTs.push(o),e.lm.H.lastdTs.length>10&&e.lm.H.lastdTs.shift(),e.lm.H.lastdT=e.lm.H.lastdTs.reduce(((e,t)=>e+t))/e.lm.H.lastdTs.length,n.holderneedsrepull=!1,!n.pullingholder)return;if("minimal"===it.video.graphics){i.cox=i.ox,i.coy=i.oy,i.cos=i.os;const e=400*i.coy,t=i.cos*i.asf;return void h(As(800*i.cox),As(e),i.br,t,s)}if(r()){i.cox=i.ox+(i.cox-i.ox)*Math.pow(.9,o),i.coy=i.oy+(i.coy-i.oy)*Math.pow(.9,o),i.cos=i.os+(i.cos-i.os)*Math.pow(.9,o),Math.abs(i.cox-i.ox)<("minimal"!==it.video.graphics?.001:1)&&(i.cox=i.ox),Math.abs(i.coy-i.oy)<("minimal"!==it.video.graphics?.001:1)&&(i.coy=i.oy),Math.abs(i.cos-i.os)<.01&&(i.cos=i.os);const e=400*i.coy,a=i.cos*i.asf;h(As(800*i.cox),As(e),i.br,a,s);const r=u(Math.round(i.ctr),Math.round(i.ctg),Math.round(i.ctb)),l=u(Math.round(i.fgctr),Math.round(i.fgctg),Math.round(i.fgctb));n.tintables.forEach((e=>{e.destroyed||e.tint!=r&&(e.tint=r)})),n.fgtintables.forEach((e=>{e.destroyed||e.tint!=l&&(e.tint=l)}));const c=t.setoptions.display_fire&&t.fire>=500?l:r;n.hybridtintables.forEach((e=>{e.destroyed||(e.tint=c)})),i.dx=0,i.dy=0,i.dr=0,i.ds=0,i.dw=0,i.dj=0;const p=255===i.tr&&255===i.tg&&255===i.tb;return i.ctr=p?i.btr:i.tr,i.ctg=p?i.btg:i.tg,i.ctb=p?i.btb:i.tb,i.fgctr=i.fgtr,i.fgctg=i.fgtg,void(i.fgctb=i.fgtb)}const a=Math.pow(.55+.2*it.video.bounciness,o),l=Math.pow(.82+.08*it.video.bounciness,o),c=Math.pow(.55+.2*it.video.shakiness,o),p=Math.pow(.35+.5*it.video.shakiness,o),d=Math.pow(.35+.5*it.video.shakiness,o);i.x*=a,i.y*=a,i.r+=(i.br-i.r)*(1-l),i.s*=c,i.w*=p,i.j*=d,i.x+=i.dx,i.y+=i.dy,i.r+=i.dr,i.s+=i.ds,i.w+=i.dw,i.j+=i.dj,i.dx*=a,i.dy*=a,i.dr*=l,i.ds*=c,i.dw*=p,i.dj*=d;let _=Math.random()*i.s-i.s/2+Math.sin((e.esm?.frame??0)/1.5*Math.max(1,(i.w+120)/150))*Math.min(30,i.w),m=Math.random()*i.s-i.s/2+Math.sin((e.esm?.frame??0)/1.5*Math.max(1,(i.j+120)/150))*Math.min(30,i.j);if(t.setoptions.zenith_duo&&e.zthm.duoOtherSideGame){const t=e.zthm.duoOtherSideGame.getHolderData().holderstate;_=Math.random()*(i.s+t.s)-(i.s+t.s)/2+Math.sin((e.esm?.frame??0)/1.5*Math.max(1,(i.w+t.w+120)/150))*Math.min(30,i.w+t.w),m=Math.random()*(i.s+t.s)-(i.s+t.s)/2+Math.sin((e.esm?.frame??0)/1.5*Math.max(1,(i.j+t.j+120)/150))*Math.min(30,i.j+t.j)}0!=it.video.bounciness&&0!==e.lm.H.soundSkipRate||(i.x=0,i.y=0,i.r=i.br,i.s=0),0!=it.video.shakiness&&0!==e.lm.H.soundSkipRate||(_=0,m=0),!1!==it.video.spin&&0!==e.lm.H.soundSkipRate||(i.r=i.br),i.cox=i.ox+(i.cox-i.ox)*Math.pow(.9,o),i.coy=i.oy+(i.coy-i.oy)*Math.pow(.9,o),i.cos=i.os+(i.cos-i.os)*Math.pow(.9,o);const g=800*i.cox,f=400*i.coy,b=i.cos*i.asf;if(t.setoptions.zenith_duo&&e.zthm.duoOtherSideGame){const t=e.zthm.duoOtherSideGame.getHolderData().holderstate;h(As(g)+Math.round(As(i.x+t.x+_)*i.cos),As(f)+Math.round(As(i.y+t.y+m)*i.cos),i.r+t.r,b,s)}else h(As(g)+Math.round(As(i.x+_)*i.cos),As(f)+Math.round(As(i.y+m)*i.cos),i.r,b,s);const C=255===i.tr&&255===i.tg&&255===i.tb,x=C?i.btr:i.tr,A=C?i.btg:i.tg,y=C?i.btb:i.tb;i.ctr=x+(i.ctr-x)*Math.pow(.9,o),i.ctg=A+(i.ctg-A)*Math.pow(.9,o),i.ctb=y+(i.ctb-y)*Math.pow(.9,o),i.fgctr=i.fgtr+(i.fgctr-i.fgtr)*Math.pow(.9,o),i.fgctg=i.fgtg+(i.fgctg-i.fgtg)*Math.pow(.9,o),i.fgctb=i.fgtb+(i.fgctb-i.fgtb)*Math.pow(.9,o);let v=u(Math.round(Math.min(255,i.ctr+24*n.rhythmBlast**2)),Math.round(Math.min(255,i.ctg+24*n.rhythmBlast**2)),Math.round(Math.min(255,i.ctb+24*n.rhythmBlast**2))),B=u(Math.round(i.fgctr),Math.round(i.fgctg),Math.round(i.fgctb));if(t.stats.zenith.speedrun&&n.board.el("grid").update(n.rhythmBlast**2),t.setoptions.zenith_duo&&e.zthm.duoOtherSideGame){const t=e.zthm.duoOtherSideGame.getHolderData().holderstate;v=u(Math.round(Math.min(i.ctr,t.ctr)),Math.round(Math.min(i.ctg,t.ctg)),Math.round(Math.min(i.ctb,t.ctb))),B=u(Math.round(Math.min(i.fgctr,t.fgctr)),Math.round(Math.min(i.fgctg,t.fgctg)),Math.round(Math.min(i.fgctb,t.fgctb)))}n.tintables.forEach((e=>{e.destroyed||(e.tint=v)})),n.fgtintables.forEach((e=>{e.destroyed||(e.tint=B)}));const w=t.setoptions.display_fire&&t.fire>=500?B:v;n.hybridtintables.forEach((e=>{e.destroyed||(e.tint=w)}))}function m(t="full"){if(n.displaymode!==t)switch(n.displaymode=t,t){case"full":case"small":e.iom.SetScoped(!0);break;default:e.iom.SetScoped(!1)}}function g(){if(e.c.IsServer())return;if(!t.playing)return;if(0===Object.keys(t.setoptions).length)return;if(e.iom.IsHeadless())return;let s=!1;n.holder&&(s=n.holder.visible,n.holder.destroy(),n.holder=null,n.leftside=null,n.rightside=null,e.pm.H.alerting=!1),e.otm.EndOverText(),n.tintables=[],n.fgtintables=[],n.stackdirty=!0,n.fallingdirty=!0,n.nextdirty=!0,n.holddirty=!0;const[l,c]=[e.W,e.H],[p,d]=[l/10,c/20];i.asf=p>d?12/l:20/c;let h=t.setoptions.boardskin;t.setoptions.zenith_duo&&(n.duoSideLock?(h+=`_duo${n.duoSideLock}`,n.duoIsRight="right"===n.duoSideLock):(h+="_duo"+(t.setoptions.username===mn.username()?"left":"right"),n.duoIsRight=t.setoptions.username!==mn.username())),n.board=new oc[h].ns.Board(e),n.holder=new a.Container,n.holder.position.set(As(800),As(400)),n.holder.pivot.set(As(Ol.x*e.Wh),As(Ol.x*e.Hh)),n.holder.visible=s,n.holder.sortableChildren=!0,(o()?ul:_l).addChild(n.holder),n.leftside=new a.Container,n.leftside.zIndex=1,n.holder.addChild(n.leftside),n.rightside=new a.Container,n.rightside.zIndex=1,n.holder.addChild(n.rightside),n.board.el("boardsides").create(),r()&&(n.holder.interactive=!0,n.holder.interactiveChildren=!1,n.holder.on("click",(()=>e.elm.emit("click"))),n.holder.on("mouseover",e.otm.CreateOverText),n.holder.on("mousemove",e.otm.MoveOverText),n.holder.on("mouseout",e.otm.EndOverText));const u=n.board.el("background").create();u.interactive=!0,u.on("click",(()=>e.elm.emit("click"))),"full"!==n.displaymode&&(u.on("mouseover",e.otm.CreateOverText),u.on("mousemove",e.otm.MoveOverText),u.on("mouseout",e.otm.EndOverText)),n.board.el("grid").create(),n.stackobj=n.board.el("stack").create(),n.board.el("stock").create(),n.fallingobj=n.board.el("falling").create(),n.board.el("border").create(),n.board.el("bar1").create(),n.board.el("bar2").create(),n.board.el("replaytag").create(),n.nextobj=n.board.el("next").create(),n.holdobj=n.board.el("hold").create(),n.board.el("zenithmods").create(),n.board.el("backer").create(),n.board.el("zen").create(),n.board.el("counter1").create(),n.board.el("counter2").create(),n.board.el("counter3").create(),n.board.el("counter4").create(),n.board.el("counter5").create(),n.board.el("username").create(),n.board.el("zenithrank").create(),n.board.el("zenithprompts").create(),n.board.el("zenithpromptsself").create(),e.tm.SetTargeted(),e.tm.SetEnemy(),e.dsm.DisplayCounts(),_(!0),e.pbm.UpdateGarbageBar("impending"),e.am.RedrawActors(),r()&&"low"!==it.video.caching&&(n.holder.cacheAsBitmap=!0),"full"===n.displaymode&&(bl=!0)}function f(){e.c.IsServer()||(e.hm.H.holder&&!e.hm.H.holder._destroyed&&e.hm.H.holder.destroy(),e.iom.SetScoped(!1),e.iom.SetHeadless(!0),e.lm.H.stopdraw=!0,e.lm.H.stopgame=!0,e.iom.IsLocal()&&(nl.opacity(1),nl.scale(1)),e.otm.EndOverText())}let b=null;return{H:n,IsFullMode:o,IsSmallMode:function(){return"small"===n.displaymode},IsTinyMode:r,SetHolderTransformData:h,TripletToSingle:u,PullHolder:_,SetDisplayMode:m,CreateHolder:g,Restate:function(){(t.setoptions.b2bchaining||t.setoptions.b2bcharging)&&t.stats.btb>1?n.board.el("b2b").update("set",t.stats.btb-1):n.board.el("b2b").delete()},Behead:f,Rehead:function(t=!1){e.c.IsServer()&&(e.iom.SetHeadless(!1),m("tiny"),g(),fs(!1),e.lm.H.ticksdraw||a.Ticker.shared.add(e.lm.DrawLoop),e.lm.H.ticksgame||a.Ticker.shared.add(e.lm.GameLoop),e.lm.H.stopdraw=!1,e.lm.H.stopgame=!1,e.lm.H.ticksdraw=!0,e.lm.H.ticksgame=!0,e.dsm.DisplayCounts(),n.holder.visible=!0,t&&El.animate(n.holder,{0:{alpha:0},1:{alpha:1}},1,s(0,0,1,1)),b&&(clearTimeout(b),b=null))},FadeOutAndBehead:function(t){e.iom.SetHeadless(!0),El.animate(n.holder,{0:{"scale.x":"inherit","scale.y":"inherit",alpha:1},1:{"scale.x":0,"scale.y":0,alpha:0}},t/1e3,s(0,0,1,1)),b=setTimeout((()=>{b=null,f()}),t)},S:()=>n.holderstate.cos*n.holderstate.asf}};class K extends w{constructor(e){super(e),this.self.esm.On("keydown",this._KeyDown.bind(this)),this.self.esm.On("keyup",this._KeyUp.bind(this)),this.forfeitHidden=!0,this.retryHidden=!0}_KeyDown({data:e}){const t=this.S;if(this._ProcessSubframe(e.subframe),t.setoptions.noreplay||this.self.iom.replay.PushEvent("keydown",e),t.setoptions.inverted)switch(e.key){case"moveLeft":e.key="moveRight";break;case"moveRight":e.key="moveLeft"}switch(e.key){case"moveLeft":return t.stats.inputs++,t.falling.keys++,this._ActivateShift(t.lShift,e.hoisted),this._InternalShift()&&this.sfx.Play("move");case"moveRight":return t.stats.inputs++,t.falling.keys++,this._ActivateShift(t.rShift,e.hoisted),this._InternalShift()&&this.sfx.Play("move");case"softDrop":return t.stats.inputs++,void(t.inputSoftdrop=!0);case"exit":return t.esciter=0,void(t.esc=!0);case"retry":return t.retryiter=0,void(t.retry=!0);case"undo":return this.self.um.Undo();case"redo":return this.self.um.Redo()}if(!t.pause)switch(e.key){case"rotateCCW":t.stats.inputs++,this._ProcessRotate(-1);break;case"rotateCW":t.stats.inputs++,this._ProcessRotate(1);break;case"rotate180":if(!t.setoptions.allow180)return;t.stats.inputs++,this._ProcessRotate(2);break;case"hardDrop":if(!1===t.setoptions.allow_harddrop||0!==t.falling.safelock)return;return t.stats.inputs++,this.self.fm.Harddrop();case"hold":return t.stats.inputs++,this.self.fm.Hold()}}_KeyUp({data:e}){const t=this.S;if(this._ProcessSubframe(e.subframe),t.setoptions.noreplay||this.self.iom.replay.PushEvent("keyup",e),t.setoptions.inverted)switch(e.key){case"moveLeft":e.key="moveRight";break;case"moveRight":e.key="moveLeft"}switch(e.key){case"moveLeft":t.lShift.held=!1,t.lShift.das=0,t.lastshift=t.rShift.held?t.rShift.dir:t.lastshift,t.handling.cancel&&(t.rShift.arr=t.handling.arr,t.rShift.das=0);break;case"moveRight":t.rShift.held=!1,t.rShift.das=0,t.lastshift=t.lShift.held?t.lShift.dir:t.lastshift,t.handling.cancel&&(t.lShift.arr=t.handling.arr,t.lShift.das=0);break;case"softDrop":t.falling.flags|=W.ACTION_SOFTDROP,t.inputSoftdrop=!1,this.self.zthm.NixPrompt("softdrop");break;case"exit":t.esciter=0,t.esc=!1;break;case"retry":t.retryiter=0,t.retry=!1}}_ActivateShift(e,t){const n=this.S;e.held=!0,e.das=t?n.handling.das-n.handling.dcd:0,e.arr=n.setoptions.version>=12?n.handling.arr:e.arr,n.lastshift=e.dir}_ProcessRotate(e){return this.S.falling.keys+=e>=2?2:1,this.self.fm.Rotate(e)}_ProcessSubframe(e){if(e<=this.S.subframe)return;const t=e-this.S.subframe;this.ProcessAllShift(t),this.self.fm.Fall(t),this.S.subframe=e}_InternalShift(){const e=this.S.falling;if(!this.self.fm.IsSleep()&&!this.S.pause)return this.self.bm.IsLegalAtPos(e.type,e.x+this.S.lastshift,e.y,e.r)?(e.x=e.x+this.S.lastshift,e.lockresets<31&&e.lockresets++,this.self.fm.ClearFlags(W.ROTATION_ALL|W.STATE_WALL),this.self.hm.H.fallingdirty=!0,this.options.version>=17&&this.self.fm.Is20G()&&this.self.fm.SlamToFloor(),this.self.fm.ShouldLock()||(e.locking=0),this.self.bm.IsLegalAtPos(e.type,e.x+this.S.lastshift,e.y,e.r)||this.sfx.Play("sidehit"),!0):(this.S.falling.flags|=W.STATE_WALL,!1)}_ProcessShift(e,t){const n=this.S;if(!e.held||n.lastshift!==e.dir)return;const s=Math.max(0,t-Math.max(0,n.handling.das-e.das));if(e.das=Math.min(e.das+t,n.handling.das),e.das<n.handling.das)return;if(this.self.fm.IsSleep()||n.pause)return;if(e.arr+=n.setoptions.version>=15?s:t,e.arr<n.handling.arr)return;const i=0===n.handling.arr?this.W:Math.floor(e.arr/n.handling.arr);e.arr-=n.handling.arr*i;for(let e=0;e<i;e++)this._InternalShift()&&0===e&&this.sfx.Play("move"),this.self.fm.HasHitWall()&&this.OnClient((t=>{Math.max(1,10*it.video.bounciness-10)>e&&(this.self.hm.H.holderstate.dx+=.5*this.self.lm.H.lastdT*n.lastshift)}))}_HandleRetryClear(){const e=this.S;e.setoptions.can_undo&&this.self.um.Save(),e.retry=!1,e.retryiter=0,e.hold=null,e.bag=[],e.stats.lines=0,e.stats.inputs=0,e.stats.piecesplaced=0,e.stats.garbage.sent=0,e.stats.garbage.attack=0,e.stats.garbage.cleared=0,e.stats.combo=0,e.stats.combopower=0,e.stats.btbpower=0,e.stats.btb=0,e.stats.finesse.combo=0,e.stats.finesse.faults=0,e.stats.finesse.perfectpieces=0,e.time.frameoffset=this.self.esm.frame,this.self.bm.DestroyBoard(),this.self.bam.PopulateBag(),this.self.fm.Next(),this.OnClient((()=>{this.self.hm.H.board.el("b2b").delete(),this.self.gpm.Vibrate(si.CLEAR),this.self.hm.H.holderstate.ds+=50*this.self.lm.H.lastdT,this.sfx.Play("shatter")}))}ProcessAllShift(e=1-this.S.subframe){for(const t of[this.S.lShift,this.S.rShift])this._ProcessShift(t,e)}ProcessInterrupts(){const e=this.S;if(e.esc&&e.escAllowed&&this.self.iom.IsLocal()){const t=e.esciter++;let n=e.setoptions.forfeit_time||60;e.setoptions.stride&&(n/=3),this.OnClient((()=>{xt("forfeit").style.height=1.5+t/20+"em",xt("forfeit").style.lineHeight=1.7+t/20+"em",xt("forfeit").style.boxShadow=`0px 0px ${8+t/3}px #F00`,xt("forfeit").style.filter=`brightness(${1+Math.max(0,(t-n+5)/5)})`,xt("forfeit").classList.remove("hidden")})),this.forfeitHidden=!1,t>n?(this.self.gom.GameOver("forfeit",!0),this.sfx.Play("detonate2")):t%20==0&&this.sfx.Play("detonate1")}else this.forfeitHidden||(this.OnClient((()=>{xt("forfeit").classList.add("hidden")})),this.forfeitHidden=!0);if(e.retry&&e.retryAllowed&&e.setoptions.can_retry){if(e.setoptions.stride&&!e.setoptions.usezenconfig)if(e.setoptions.retryisclear)this._HandleRetryClear();else if(!this.IsServer()&&this.self.iom.IsLocal())return this.self.gom.GameOver("retry",!0),void this.sfx.Play("detonate2");if(this.IsServer()||!this.self.iom.IsLocal())return;const t=e.retryiter++;xt("retry").style.height=1.5+t/20+"em",xt("retry").style.lineHeight=1.7+t/20+"em",xt("retry").style.boxShadow=`0px 0px ${8+t/3}px #FA0`,xt("retry").style.filter=`brightness(${1+Math.max(0,(t-15+5)/5)})`,xt("retry").classList.remove("hidden"),this.retryHidden=!1,t>15?(e.setoptions.retryisclear?this._HandleRetryClear():this.self.gom.GameOver("retry",!0),this.sfx.Play("detonate2")):t%5==0&&this.sfx.Play("detonate1")}else this.IsServer()||!this.self.iom.IsLocal()||this.retryHidden||(xt("retry").classList.add("hidden"),this.retryHidden=!0)}}class V extends w{constructor(e,t){super(e),this._socket=t,this._replay=new k,this._scoped=!0,this._synced=!0,this._headless=!1,this._timeoutID=null}get socket(){return this._socket}get replay(){return this._replay}get scoped(){return this._scoped}set scoped(e){this._scoped=e}get synced(){return this._synced}set synced(e){this._synced=e}IsLocal(){return this.self.esm.IsKeyboard()}IsOnline(){return this.self.esm.IsSocket()}IsReplay(){return this.self.esm.IsReplay()}IsMultiplayer(){return null!==this.id}IsScoped(){return this._scoped}IsSynced(){return!!this.IsLocal()||this._scoped&&this._synced}IsHeadless(){return this._headless}SetHeadless(e){this._headless=e}SetScoped(e){if(this.IsOnline())return e?void(this.IsSynced()||(this.scoped=!0,clearTimeout(this._timeoutID),this._timeoutID=setTimeout((()=>{this.IsScoped()&&this.SendToServer("game.scope.start",this.id)}),300))):(this.IsSynced()&&this.SendToServer("game.scope.end",this.id),this.scoped=!1,this.synced=!1,clearTimeout(this._timeoutID),this.self.wfm.ExecuteUnsafeWaitingFrames(!0))}async RequestState(){this.IsSynced()||(await Ot(1e3),this.S.destroyed||this.self.hm.IsTinyMode()||this.SendToServer("game.scope.start",this.id))}SendToServer(e,t){if(!this._socket)throw new ReferenceError("Attempted to use socket on a singleplayer session");return this._socket.send(e,t)}}const Q=function(e){"use strict";const t=e.gsm;function n(n,s=!1,i=1){if(s)t.stats.level=i,t.g=Math.min(Number.MAX_SAFE_INTEGER-1,1/60/Math.pow(Math.max(1e-9,t.setoptions.levelgbase-(t.stats.level-1)*t.setoptions.levelgspeed),t.stats.level-1)),t.stats.level_lines=0,t.stats.level_lines_needed=t.setoptions.levelstatic?t.setoptions.levelstaticspeed:Math.ceil(t.stats.level*t.setoptions.levelspeed*5),t.setoptions.masterlevels&&t.stats.level>20&&(t.setoptions.locktime=30-Math.min(25,t.stats.level-20)),t.setoptions.masterlevels&&t.stats.level>45&&(t.setoptions.lockresets=15-Math.min(10,t.stats.level-45));else if(t.stats.level_lines+=n,t.stats.level_lines>=t.stats.level_lines_needed){for(;t.stats.level_lines>=t.stats.level_lines_needed;)t.stats.level_lines-=t.stats.level_lines_needed,t.stats.level++,t.g=Math.min(Number.MAX_SAFE_INTEGER-1,1/60/Math.pow(Math.max(1e-9,t.setoptions.levelgbase-(t.stats.level-1)*t.setoptions.levelgspeed),t.stats.level-1)),t.stats.level_lines_needed=t.setoptions.levelstatic?t.setoptions.levelstaticspeed:Math.ceil(t.stats.level*t.setoptions.levelspeed*5),t.setoptions.masterlevels&&t.stats.level>20&&(t.setoptions.locktime=30-Math.min(25,t.stats.level-20)),t.setoptions.masterlevels&&t.stats.level>45&&(t.setoptions.lockresets=15-Math.min(10,t.stats.level-45));e.c.OnClient((()=>{e.sfx.Play("levelup");let n=t.stats.level;t.setoptions.masterlevels&&t.stats.level>20&&(n="M"+(t.stats.level-20)),"minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&e.hm.H.board.fx("levelup").create(n),e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate&&Ur.play("bgcircle"),t.setoptions.levels&&!t.setoptions.absolute_lines&&e.pbm.BlastBar("progress")}))}}function s(n){let s=0;for(let e=0;e<n.length;e++)t.board[n[e]].some((e=>"gb"===e||"gbd"===e))&&s++;t.stats.garbage.cleared+=s,e.zthm.IncrementPrompt("garbageclear",s)}function i(s,i){let o=0;t.stats.lines+=s,t.setoptions.levels&&n(s),i&&(o+=t.setoptions.allclear_b2b);const a=e.fm.IsSpin(),r=e.fm.IsSpinMini(),l=a||"t"!==t.falling.type&&r;if((s||a)&&t.setoptions.zenith_allspin){const n=`${s}:${a?t.falling.type:"-"}:${(r?"Mini":"Spin")||"none"}`;if(t.zenith.lastclearwasdupe=t.zenith.lastclear===n,t.zenith.lastclear=n,t.zenith.lastclearwasdupe)e.bm.PushLine({column:[Math.floor(t.rngex.nextFloat()*e.bm.ColumnWidth())],position:"abovePerma",pos:"gbd",neg:"gb",actor_neg:"wound_timer",actor_neg_data:{type:"clears",amt:5+t.stats.zenith.floor}}),e.c.OnClient((()=>{e.gpm.Vibrate(si.GARBAGERISE),e.sfx.Play("garbagerise"),e.sfx.Play("wound"),e.hm.H.holderstate.ds+=5*e.lm.H.lastdT}));else if(s)for(const n of Object.keys(t.actors))"wound_timer"===t.actors[n].type&&"clears"===t.actors[n].data.type&&(t.actors[n].data.amt--,e.am.ActionActor(n,t.actors[n].data.amt<=0?"clear":"good"));e.c.OnClient((()=>{e.hm.H.board.fx("clear").delete(),e.hm.H.board.fx("tspin").delete()}))}if(s){"none"!==t.setoptions.combotable&&(t.stats.combo++,t.stats.topcombo=Math.max(t.stats.combo,t.stats.topcombo),e.zthm.BumpPrompt("combo",t.stats.combo-1)),!e.c.IsServer()&&t.stats.combo>1&&e.hm.H.board.fx("combo").create(t.stats.combo-1+" \fc3COMBO"),s>=4?(o++,e.c.OnClient((()=>{t.stats.btb?(e.gpm.Vibrate(si.CLEARB2B),e.sfx.Play("clearbtb")):(e.gpm.Vibrate(si.CLEARQUAD),e.sfx.Play("clearquad"))}))):a?(o++,e.c.OnClient((()=>{e.gpm.Vibrate(si.CLEARSPIN),e.sfx.Play("clearspin")}))):e.c.OnClient((()=>{e.gpm.Vibrate(si.CLEARLINE),e.sfx.Play("clearline")})),e.hm.H.holderstate.dy+=8*s*e.lm.H.lastdT,!e.c.IsServer()&&s>=1&&e.hm.H.board.fx("clear").create(e.cm.constants.Strings.cleartypes[s]||e.cm.constants.Strings.cleartypes[21]),e.zthm.IncrementPrompt("lines",s),"o"===t.falling.type&&e.zthm.IncrementPrompt("oclear",s),e.zthm.NixPrompt("noclear"),"t"===t.falling.type||"i"===t.falling.type?e.zthm.NixPrompt("linesnoti"):e.zthm.IncrementPrompt("linesnoti",s),t.setoptions.zenith_expert||e.zthm.AwardLines(Math.min(2,s),!1);if(!(t.setoptions.allclear_dupes||i&&o===t.setoptions.allclear_b2b)&&i?o-=t.setoptions.allclear_b2b:t.setoptions.allclear_charges&&i&&(o=Math.max(o,t.setoptions.b2bcharge_at+1-t.stats.btb)),o>0)t.stats.btb+=o,t.stats.topbtb=Math.max(t.stats.btb,t.stats.topbtb),e.zthm.BumpPrompt("b2b",t.stats.btb-1),e.c.OnClient((()=>{e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate&&Ur.play("bgcircle"),t.stats.btb>1&&(t.setoptions.b2bchaining||t.setoptions.b2bcharging||e.hm.H.board.fx("also").create(`${e.cm.constants.Strings.extra.btb}${t.stats.btb>2?" \fc3X\f5"+(t.stats.btb-1):""}`))}));else{if(!e.c.IsServer()&&t.setoptions.b2bcharging)switch(e.hm.H.board.el("b2b").update(t.stats.btb>t.setoptions.b2bcharge_at?"down_send":"down",0),!0){case t.stats.btb>=t.setoptions.b2bcharge_at+20:e.sfx.Play("b2bcharge_blast_4");break;case t.stats.btb>=t.setoptions.b2bcharge_at+8:e.sfx.Play("b2bcharge_blast_3");break;case t.stats.btb>=t.setoptions.b2bcharge_at+4:e.sfx.Play("b2bcharge_blast_2");break;case t.stats.btb>t.setoptions.b2bcharge_at:e.sfx.Play("b2bcharge_blast_1")}else!e.c.IsServer()&&t.setoptions.b2bchaining&&e.hm.H.board.el("b2b").update(t.stats.btb>2?"down_large":"down",0);if(t.setoptions.b2bcharging&&t.stats.btb>t.setoptions.b2bcharge_at){const n=Math.floor((t.stats.btb-t.setoptions.b2bcharge_at+t.setoptions.b2bcharge_base)*t.setoptions.garbagemultiplier),s=[Math.round(n/3),Math.round(n/3),n-2*Math.round(n/3)];for(const t of s)t&&e.atm.FightLines(t);e.c.OnClient((()=>{if(e.hm.IsFullMode()){const t=Bl(e.hm.H.stackobj,0,0);Ur.play("b2bcharge_release",{x:t.x,y:t.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()})}}))}t.stats.btb=0,e.zthm.NixPrompt("b2b"),t.setoptions.b2bchaining&&t.stats.btbpower>=2&&e.sfx.Play("btb_break")}!l||"s"!==t.falling.type&&"z"!==t.falling.type||e.zthm.IncrementPrompt("szspin"),!l||"l"!==t.falling.type&&"j"!==t.falling.type||e.zthm.IncrementPrompt("ljspin"),t.setoptions.zenith_duo&&l&&(t.zenith.spinbuckets.includes(t.falling.type)||(t.zenith.spinbuckets.push(t.falling.type),e.zthm.IncrementPrompt("spinbuckets"))),e.zthm[1===s?"IncrementPrompt":"NixPrompt"]("singlesonly")}else t.stats.combo>3&&e.sfx.Play("combobreak"),t.stats.combo=0,t.stats.combopower=0,e.zthm.NixPrompt("combo"),e.zthm.IncrementPrompt("noclear");e.zthm[2!==s||!l||"s"!==t.falling.type&&"z"!==t.falling.type?"NixPrompt":"IncrementPrompt"]("szspinconsecutive"),e.zthm[2!==s||!l||"l"!==t.falling.type&&"j"!==t.falling.type?"NixPrompt":"IncrementPrompt"]("ljspinconsecutive"),e.zthm[2===s&&"o"===t.falling.type?"IncrementPrompt":"NixPrompt"]("odoubleconsecutive"),e.zthm[2===s&&"z"===t.falling.type?"IncrementPrompt":"NixPrompt"]("zdoubleconsecutive"),e.zthm[2===s&&"s"===t.falling.type?"IncrementPrompt":"NixPrompt"]("sdoubleconsecutive"),e.zthm[2===s&&["s","z"].includes(t.falling.type)?"IncrementPrompt":"NixPrompt"]("szdoubleconsecutive"),e.zthm[3===s&&"j"===t.falling.type?"IncrementPrompt":"NixPrompt"]("jtripleconsecutive"),e.zthm[3===s&&"l"===t.falling.type?"IncrementPrompt":"NixPrompt"]("ltripleconsecutive"),e.zthm[3===s&&["l","j"].includes(t.falling.type)?"IncrementPrompt":"NixPrompt"]("ljtripleconsecutive"),e.zthm[4===s?"IncrementPrompt":"NixPrompt"]("quadconsecutive"),t.holdlocked||e.zthm.NixPrompt("holdconsecutive"),a&&(e.c.OnClient((()=>{if(e.sfx.Play("spinend"),e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate){const n=e.cm.GetPieceColor(t.falling.type),s=Gl.getColor(t.setoptions.minoskin[n]||t.setoptions.minoskin.other,n),i=e.cm.constants.Strings.tspins[r?"mini":"normal"].replace("%%PIECE%%",t.falling.type.toUpperCase());e.hm.H.board.fx("tspin").create(i,{color:s})}})),t.stats.tspins++,r&&"t"===t.falling.type&&(e.zthm.IncrementPrompt("tspinmini"),s&&e.zthm.IncrementPrompt("tspinminiclear"))),"i"===t.falling.type&&s&&l&&e.zthm.IncrementPrompt("ispinclear");let c=0,p=0;switch(s){case 0:r?(c=e.cm.constants.scoring.TSPIN_MINI,p=e.cm.constants.garbage.TSPIN_MINI,t.stats.clears.minitspins++):a&&(c=e.cm.constants.scoring.TSPIN,p=e.cm.constants.garbage.TSPIN,t.stats.clears.realtspins++);break;case 1:r?(c=e.cm.constants.scoring.TSPIN_MINI_SINGLE,p=e.cm.constants.garbage.TSPIN_MINI_SINGLE,t.stats.clears.minitspinsingles++):a?(c=e.cm.constants.scoring.TSPIN_SINGLE,p=e.cm.constants.garbage.TSPIN_SINGLE,t.stats.clears.tspinsingles++,e.zthm.IncrementPrompt("tspinsingle")):(c=e.cm.constants.scoring.SINGLE,p=e.cm.constants.garbage.SINGLE,t.stats.clears.singles++,t.setoptions.zenith&&!t.setoptions.zenith_expert&&1===t.stats.combo&&p++),"i"===t.falling.type&&t.falling.r%2==0&&e.zthm.IncrementPrompt("iflat");break;case 2:r?(c=e.cm.constants.scoring.TSPIN_MINI_DOUBLE,p=e.cm.constants.garbage.TSPIN_MINI_DOUBLE,t.stats.clears.minitspindoubles++):a?(c=e.cm.constants.scoring.TSPIN_DOUBLE,p=e.cm.constants.garbage.TSPIN_DOUBLE,t.stats.clears.tspindoubles++,e.zthm.IncrementPrompt("tspindouble")):(c=e.cm.constants.scoring.DOUBLE,p=e.cm.constants.garbage.DOUBLE,t.stats.clears.doubles++),e.zthm.IncrementPrompt("double"),"o"===t.falling.type&&e.zthm.IncrementPrompt("odouble"),"z"===t.falling.type&&(e.zthm.IncrementPrompt("zdouble"),e.zthm.IncrementPrompt("szdouble")),"s"===t.falling.type&&(e.zthm.IncrementPrompt("sdouble"),e.zthm.IncrementPrompt("szdouble")),l&&"i"===t.falling.type&&e.zthm.IncrementPrompt("ispindouble");break;case 3:r?(c=e.cm.constants.scoring.TSPIN_MINI_TRIPLE,p=e.cm.constants.garbage.TSPIN_MINI_TRIPLE,t.stats.clears.minitspintriples++):a?(c=e.cm.constants.scoring.TSPIN_TRIPLE,p=e.cm.constants.garbage.TSPIN_TRIPLE,t.stats.clears.tspintriples++,e.zthm.IncrementPrompt("tspintriple")):(c=e.cm.constants.scoring.TRIPLE,p=e.cm.constants.garbage.TRIPLE,t.stats.clears.triples++),e.zthm.IncrementPrompt("triple"),"j"===t.falling.type&&(e.zthm.IncrementPrompt("jtriple"),e.zthm.IncrementPrompt("ljtriple")),"l"===t.falling.type&&(e.zthm.IncrementPrompt("ltriple"),e.zthm.IncrementPrompt("ljtriple")),!l||"l"!==t.falling.type&&"j"!==t.falling.type||e.zthm.IncrementPrompt("ljspintriple"),!l||"s"!==t.falling.type&&"z"!==t.falling.type||e.zthm.IncrementPrompt("szspintriple");break;case 4:{r?(c=e.cm.constants.scoring.TSPIN_MINI_QUAD,p=e.cm.constants.garbage.TSPIN_MINI_QUAD,t.stats.clears.minitspinquads++):a?(c=e.cm.constants.scoring.TSPIN_QUAD,p=e.cm.constants.garbage.TSPIN_QUAD,t.stats.clears.tspinquads++):(c=e.cm.constants.scoring.QUAD,p=e.cm.constants.garbage.QUAD,t.stats.clears.quads++),e.zthm.IncrementPrompt("quad");const n=t.falling.x+(1===t.falling.r?1:0);if(void 0!==t.quadcolumns[n]&&t.quadcolumns[n]++,t.setoptions.zenith_duo){const s=Math.floor(t.falling.y)+2;t.zenith.quadbuckets.includes(n)||(t.zenith.quadbuckets.push(n),e.zthm.IncrementPrompt("quadbuckets")),s<e.T-e.Hh&&e.zthm.IncrementPrompt("upperhalfquad")}break}case 5:a?(c=e.cm.constants.scoring.TSPIN_PENTA,p=e.cm.constants.garbage.TSPIN_PENTA,t.stats.clears.tspinpentas++):(c=e.cm.constants.scoring.PENTA,p=e.cm.constants.garbage.PENTA,t.stats.clears.pentas++);break;default:{const t=s-5;a?(c=e.cm.constants.scoring.TSPIN_PENTA+600*t,p=e.cm.constants.garbage.TSPIN_PENTA+2*t):(c=e.cm.constants.scoring.PENTA+400*t,p=e.cm.constants.garbage.PENTA+t);break}}a&&"handheld"===t.setoptions.spinbonuses&&"t"!==t.falling.type&&(p/=2);const d=t.setoptions.allclear_b2b_sends||!(t.setoptions.allclear_b2b===o&&i);if(s&&t.stats.btb>1){if(d&&(c*=e.cm.constants.scoring.BACKTOBACK_MULTIPLIER),t.setoptions.b2bcharging&&e.c.OnClient((()=>{const n=t.stats.btb-o>t.setoptions.b2bcharge_at,s=t.stats.btb>t.setoptions.b2bcharge_at;switch(e.hm.H.board.el("b2b").update(s&&!n?"up_charged":"up",t.stats.btb-1),s&&!n&&e.sfx.Play("b2bcharge_start"),!0){case t.stats.btb>t.setoptions.b2bcharge_at+20:e.sfx.Play("b2bcharge_4");break;case t.stats.btb>t.setoptions.b2bcharge_at+8:e.sfx.Play("b2bcharge_3");break;case t.stats.btb>t.setoptions.b2bcharge_at+4:e.sfx.Play("b2bcharge_2");break;case t.stats.btb>t.setoptions.b2bcharge_at:e.sfx.Play("b2bcharge_1")}if(t.stats.btb>4)switch(!0){case e.tm.b2bdistance>=19:setTimeout((()=>e.sfx.Play("b2bcharge_distance_3")),50);break;case e.tm.b2bdistance>=11:setTimeout((()=>e.sfx.Play("b2bcharge_distance_2")),50);break;case e.tm.b2bdistance>=7:setTimeout((()=>e.sfx.Play("b2bcharge_distance_1")),50)}if(t.stats.btb>t.setoptions.b2bcharge_at&&e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate){const i=Bl(e.hm.H.stackobj,0,0);Ur.play("b2bcharge_flair",{x:i.x,y:i.y,w:e.W*e.hm.S(),h:e.H*e.hm.S(),start:s&&!n,amt:t.stats.btb-1})}})),t.setoptions.b2bchaining){const n=e.cm.constants.garbage.BACKTOBACK_BONUS*(Math.floor(1+Math.log1p((t.stats.btb-1)*e.cm.constants.garbage.BACKTOBACK_BONUS_LOG))+(t.stats.btb-1==1?0:(1+Math.log1p((t.stats.btb-1)*e.cm.constants.garbage.BACKTOBACK_BONUS_LOG)%1)/3));if(d&&(p+=n),Math.floor(n)>=2&&e.fim.AddFire(20*Math.floor(n-1)-10),e.c.OnClient((()=>{Math.floor(n)>t.stats.btbpower&&Math.floor(n)>=2?e.hm.H.board.el("b2b").update("up_large",t.stats.btb-1):e.hm.H.board.el("b2b").update("up",t.stats.btb-1)})),Math.floor(n)>t.stats.btbpower&&(t.stats.btbpower=Math.min(Math.floor(n),255),e.c.OnClient((()=>{2===t.stats.btbpower?e.sfx.Play("btb_1"):3===t.stats.btbpower?e.sfx.Play("btb_2",1.25):t.stats.btbpower>=4&&e.sfx.Play("btb_3",1.5)}))),!e.c.IsServer()&&t.stats.btbpower>=3&&e.hm.IsFullMode()){const t=Bl(e.hm.H.stackobj,0,0);Ur.play("b2b_flair",{x:t.x,y:t.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()})}}else if(d){let n=1;t.setoptions.b2bextras&&(4===s||s>=2&&a)&&(n=2),p+=e.cm.constants.garbage.BACKTOBACK_BONUS*n}}else s&&t.stats.btb<=1&&(t.stats.btbpower=0);if(t.stats.combo>1)if(c+=e.cm.constants.scoring.COMBO*(t.stats.combo-1),"multiplier"===t.setoptions.combotable)p*=1+e.cm.constants.garbage.COMBO_BONUS*(t.stats.combo-1),t.stats.combo>2&&(p=Math.max(Math.log1p(e.cm.constants.garbage.COMBO_MINIFIER*(t.stats.combo-1)*e.cm.constants.garbage.COMBO_MINIFIER_LOG),p));else{const n=e.cm.constants.garbage.combotable[t.setoptions.combotable]||[0];p+=n[Math.max(0,Math.min(t.stats.combo-2,n.length-1))]}if(s&&"none"!==t.setoptions.garbagetargetbonus){let e=0;switch(t.enemies.length){case 0:case 1:break;case 2:e+=1;break;case 3:e+=3;break;case 4:e+=5;break;case 5:e+=7;break;default:e+=9}"offensive"===t.setoptions.garbagetargetbonus?p+=e:t.garbagebonus=e*t.setoptions.garbagemultiplier}let h=e.atm.AutoRound(p*t.setoptions.garbagemultiplier);switch(t.setoptions.garbageattackcap&&(h=Math.floor(Math.min(t.setoptions.garbageattackcap,h))),t.stats.combo>2&&(t.stats.combopower=Math.min(Math.max(t.stats.combopower,h),7)),c*=t.stats.level,t.stats.score+=c,t.setoptions.zenlevels&&(t.stats.zenprogress+=e.znm.ScoreToZenProgress(c,t.stats.zenlevel)),s&&t.stats.combo>1&&e.sfx.Play(`combo_${Math.min(16,t.stats.combo-1)}${t.stats.combopower>=7?"_power":""}`,t.stats.combopower>=7?h>=7?2.2:1.75:1),s&&t.stats.combo>1&&t.stats.combopower>=7&&e.fim.AddFire(5),t.setoptions.b2bcharging&&e.elm.emit("b2bstate",t.stats.btb),t.setoptions.garbageblocking){case"combo blocking":return s&&e.atm.FightLines(h),s>0;case"limited blocking":return s&&e.atm.FightLines(h),!1;case"none":return t.stats.garbage.attack+=h,e.atm.Offence(h),!1}}function o(n){n&&(e.c.OnClient((()=>{e.sfx.Play("allclear"),e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate&&("minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&e.hm.H.board.fx("allclear").create(e.cm.constants.Strings.extra.clear),Ur.play("bgcircle"))})),t.stats.score+=e.cm.constants.scoring.ALL_CLEAR*t.stats.level,t.setoptions.zenlevels&&(t.stats.zenprogress+=e.znm.ScoreToZenProgress(e.cm.constants.scoring.ALL_CLEAR*t.stats.level,t.stats.zenlevel)),t.stats.clears.allclear++,e.atm.FightLines(e.atm.AutoRound(t.setoptions.allclear_garbage*t.setoptions.garbagemultiplier))),t.setoptions.zenith_duo&&e.bm.IsUncolored()&&e.zthm.IncrementPrompt("colorclear")&&e.c.OnClient((()=>{e.sfx.Play("allclear"),e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate&&("minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&e.hm.H.board.fx("allclear").create(e.cm.constants.Strings.extra.colorclear),Ur.play("bgcircle"))}))}return{ClearLines:function(){const n=e.bm.GetFullLines();t.lastoffensive.x=t.falling.x,t.lastoffensive.y=Math.round(n.length?n[Math.round((n.length-1)/2)]:t.falling.y),t.lastoffensive.offence=0,t.lastoffensive.defense=0,t.lastreceivedcount=0,s(n),n.length&&e.bm.RemoveLinesFromStack(n);const a=!1!==t.setoptions.allclears&&(t.setoptions.zenith?e.bm.IsEmptyWithUnclearable():e.bm.IsEmptyWithPerma()),r=i(n.length,a);return!1!==t.setoptions.allclears&&o(a),r||e.atm.TakeAllDamage(),e.atm.AnnounceOffensive(),n.length},LevelLines:n,AnnounceDownstack:s,AnnounceLines:i,AnnounceClear:o}},Y=function(e){"use strict";const t=e.gsm,n={playbackSpeed:1,soundSkipRate:1,stopgame:!1,stopdraw:!1,ticksgame:!1,ticksdraw:!1,lastdT:1,lastdTs:[],diter:0,cheekystep:Math.floor(60+60*Math.random())},s=1/60;let i=0,o=!0,r=0,l=null;let c=0;function p(){if(e.iom.IsSynced()&&!e.esm.IsFinished()&&e.esm.IsNextFrameReady()&&!e.elm.emit("frame",e.esm.frame,0===n.soundSkipRate)){if(t.subframe=0,e.esm.Pull(),e.esm.AdvanceFrame(),e.im.ProcessAllShift(),e.fm.Fall(),e.im.ProcessInterrupts(),e.wfm.ExecuteWaitingFrames(),e.wfm.ExecuteUnsafeWaitingFrames(),e.rbm.CheckObjectiveCleared(),e.spm.LowerSpikeClock(),t.setoptions.display_fire&&e.fim.LowerFire(),t.setoptions.gincrease&&e.esm.frame>t.setoptions.gmargin&&(t.g+=t.setoptions.gincrease/60),t.setoptions.garbageincrease&&e.esm.frame>t.setoptions.garbagemargin&&(t.setoptions.garbagemultiplier+=t.setoptions.garbageincrease/60),t.setoptions.garbagecapincrease&&(t.setoptions.garbagecap+=t.setoptions.garbagecapincrease/60),e.svm.UpdateLoop(),e.tm.Loop(),e.am.ProgressActors(),e.zthm.Loop(),!t.setoptions.noreplay){e.iom.replay.AdvanceFrame();const n=e.iom.replay.frame-t.setoptions.fulloffset;0!==n&&n%t.setoptions.fullinterval!=0||e.iom.replay.PushEvent("full",e.siom.Snapshot())}if(e.esm.IsFallingBehind()&&++c<=1200){const t=e.esm.AmountToCatchUp();n.soundSkipRate=Math.max(0,n.soundSkipRate/1.25),n.soundSkipRate<=1e-6&&(n.soundSkipRate=0),p(),n.soundSkipRate=1,!e.c.IsServer()&&!e.hm.IsTinyMode()&&t>90&&ha("loss")}if(e.esm.GetBehindness()>=1.25){const t=Math.max(Math.floor(8-(e.esm.GetBehindness()-1.25)),0)+2;e.esm.frame%t==0&&p()}c=0}}function d(n){e.c.IsServer()||(e.hm.H.stackdirty&&(vl(e.hm.H.stackobj),e.sdm.DrawStack(),e.hm.H.stackdirty=!1,e.hm.H.stackmud=[],e.hm.IsFullMode()&&(bl=!0)),e.hm.H.stackmud.length&&(e.sdm.DrawStackMud(),e.hm.H.stackmud=[],e.hm.IsFullMode()&&(bl=!0)),"minimal"===it.video.graphics||!1===it.video.siren||t.setoptions.nosiren||e.pm.WarningSiren(n),e.hm.H.fallingdirty&&!e.hm.IsTinyMode()&&(vl(e.hm.H.fallingobj),e.sdm.DrawFalling(),e.hm.H.fallingdirty=!1,e.hm.IsFullMode()&&(bl=!0)),e.hm.IsTinyMode()||e.sdm.DrawFallingOpacity(),e.hm.IsTinyMode()||(e.dsm.UpdateCounts(),e.dsm.UpdateTimers()),"minimal"===it.video.graphics||!1===it.video.siren||t.setoptions.nosiren||e.pm.HyperTopoutWarningExtremePlus(n),e.hm.PullHolder(!1,n),t.setoptions.display_fire&&e.fim.PullFire(n),e.hm.H.nextdirty&&!e.hm.IsTinyMode()&&(e.sdm.DrawNext(),e.hm.H.nextdirty=!1,e.hm.IsFullMode()&&(bl=!0)),e.hm.H.holddirty&&!e.hm.IsTinyMode()&&(e.sdm.DrawHold(),e.hm.H.holddirty=!1,e.hm.IsFullMode()&&(bl=!0)),!e.stm.H.stockExploding||!e.hm.IsFullMode()||"high"!==it.video.graphics&&"ultra"!==it.video.graphics||t.setoptions.infinite_stock||e.stm.ExplodingStock(n),t.setoptions.zenith_invisible&&!e.hm.IsTinyMode()&&e.sdm.ZenithAlpha(n),e.hm.IsTinyMode()||(e.hm.H.board.progress(n),e.am.PullActors(n)))}return{H:n,GetGameTime:function(){return 1e3*(e.esm.frame+t.subframe)/60},GameLoop:function c(){if(e.c.IsServer(!0))return;if(n.stopgame)return n.stopgame=!1,a.Ticker.shared.remove(c),void(n.ticksgame=!1);if(e.c.IsServer())return;if(!t.started)return;null===l&&(l=performance.now());const d=performance.now();r+=Math.min(5,(d-l)/1e3);let h=-2;for(;r>=s;){for(r-=s,h++,i+=n.playbackSpeed;i>=1;)i--,p();o&&(o=!1,r=0)}e.iom.IsLocal()&&Lo.addGameM(Math.max(0,h)),l=d},DoFrame:function(){e.c.IsServer()&&p()},DrawLoop:function t(s){if(!e.c.IsServer(!0))return n.stopdraw?(n.stopdraw=!1,a.Ticker.shared.remove(t),void(n.ticksdraw=!1)):void(e.c.IsServer()||(e.hm.IsTinyMode()?Math.round(e.hm.H.holderstate.ox*("minimal"!==it.video.graphics?100:1))==Math.round(e.hm.H.holderstate.cox*("minimal"!==it.video.graphics?100:1))&&Math.round(e.hm.H.holderstate.oy*("minimal"!==it.video.graphics?100:1))==Math.round(e.hm.H.holderstate.coy*("minimal"!==it.video.graphics?100:1))&&Math.round(100*e.hm.H.holderstate.os)==Math.round(100*e.hm.H.holderstate.cos)?(n.diter+=s,n.diter>=n.cheekystep?(n.diter-=n.cheekystep,"low"!==it.video.caching&&(e.hm.H.holder.cacheAsBitmap=!1),d(),"low"!==it.video.caching&&(e.hm.H.holder.cacheAsBitmap=!0)):e.hm.H.holderneedsrepull&&e.hm.PullHolder(s)):e.hm.PullHolder(s):d(s)))},AdvanceFrames:function(t,s){s&&(n.soundSkipRate=0);for(let e=0;e<t;e++)p();s&&(n.soundSkipRate=1,e.hm.H.holderstate.x=0,e.hm.H.holderstate.y=0,e.hm.H.holderstate.r=0,e.hm.H.holderstate.s=0,e.hm.H.holderstate.w=0,e.hm.H.holderstate.dx=0,e.hm.H.holderstate.dy=0,e.hm.H.holderstate.dr=0,e.hm.H.holderstate.ds=0,e.hm.H.holderstate.dw=0,e.elm.emit("frame",e.esm.frame,!1))},Update:p,Render:d}},J=function(e){"use strict";let t=0,n=1/0;return{SetPlacement:function(s){e.gsm.placement=s,e.c.IsServer()||(t=Math.max(t,s),"minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&(t>=150&&n>100&&s<=100&&e.hm.H.board.fx("timeleft").create("100 \fc3PLAYERS LEFT"),t>=60&&n>30&&s<=30&&e.hm.H.board.fx("timeleft").create("30 \fc3PLAYERS LEFT"),t>=30&&n>10&&s<=10&&e.hm.H.board.fx("timeleft").create("10 \fc3PLAYERS LEFT")),n=Math.min(n,s))}}},Z=function(e){"use strict";const t=e.gsm,n={songWasPlayed:!1};return{H:n,Start(s=t.setoptions.song){e.c.IsServer()||"none"!==s&&(e.iom.IsOnline()||e.iom.IsReplay()||t.started||(na.PlayBgmSmoothlyWithRandom(s),n.songWasPlayed=!0))},Stop(n){e.c.IsServer()||e.iom.IsOnline()||e.iom.IsReplay()||t.setoptions.neverstopbgm||na.FadeOutBgm(n)}}},ee=function(e){"use strict";const t=e.gsm;let n=null;return{CreateOverText:function(e){if(!t.setoptions.display_username)return;if(document.body.classList.contains("idlemouse"))return;n&&(n.bg.destroy(),n.fg.destroy());const i=new a.Graphics;i.beginFill(0,.75),i.drawRect(0,0,As(10*Ol.x+4),As(26)),i.endFill(),i.position.set(e.data.global.x-As(5*Ol.x+2),e.data.global.y+32),Gr.addChild(i);const o=new g.Text(t.setoptions.username.toUpperCase(),{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(19),weight:600,tint:14540253,anchor:[.5,0]});o.position.set(e.data.global.x,e.data.global.y+32+As(5)),Gr.addChild(o),El.animate(i,{0:{alpha:0,"pivot.y":32},.1:{alpha:1,"pivot.y":0},.75:{alpha:1,"pivot.y":0},1:{alpha:0,"pivot.y":0}},5,s(0,.34,.86,.46)),El.animate(o,{0:{alpha:0,"pivot.y":32},.1:{alpha:1,"pivot.y":0},.75:{alpha:1,"pivot.y":0},1:{alpha:0,"pivot.y":0}},5,s(0,.34,.86,.46),(()=>{n.bg.destroy(),n.fg.destroy(),n=null})),n={bg:i,fg:o}},MoveOverText:function(e){n&&(n.bg.position.set(e.data.global.x-As(5*Ol.x+2),e.data.global.y+32),n.fg.position.set(e.data.global.x,e.data.global.y+32+As(5)))},EndOverText:function(){n&&(n.bg.destroy(),n.fg.destroy(),n=null)}}},te=function(e){"use strict";const t=e.gsm,n={siren:!0,sireniter:0,panicking:!1,alerting:!1,sirenAlwaysGood:!1};let s=!1,i=null,o=0;return{H:n,WarningSiren:function(s){if(e.c.IsServer())return;if(t.destroyed)return;if(!n.siren)return;let i=e.bm.HighestLine();const o=e.atm.GetPendingGarbageCount(!0);if(i=Math.max(0,i-Math.min(e.atm.GetGarbageCap(),o)),(i>e.B-1||!o||n.sirenAlwaysGood)&&n.alerting&&(e.hm.H.board.el("garbagedangericon").delete(),n.alerting=!1),i>e.B+2||n.sirenAlwaysGood)return void(n.panicking&&(e.hm.H.holderstate.tr=255,e.hm.H.holderstate.tg=255,e.hm.H.holderstate.tb=255,e.hm.H.holderstate.fgtr=0,e.hm.H.holderstate.fgtg=0,e.hm.H.holderstate.fgtb=0,n.panicking=!1,e.hm.H.board.el("skyline").delete(),e.iom.IsLocal()&&(nl.opacity(1),nl.scale(1))));if(n.panicking||(e.hm.H.holderstate.tr=255,e.hm.H.holderstate.tg=51,e.hm.H.holderstate.tb=0,e.hm.H.holderstate.fgtr=255,e.hm.H.holderstate.fgtg=255,e.hm.H.holderstate.fgtb=255,n.panicking=!0,e.hm.H.board.el("skyline").create(),e.iom.IsLocal()&&(nl.opacity(.5),nl.scale(1.01))),!e.hm.IsFullMode()||0===e.lm.H.soundSkipRate)return;if(!n.alerting&&i<=e.B-1&&o&&(e.hm.H.board.el("garbagedangericon").create(),n.alerting=!0,e.sfx.Play("damage_alert",1,.33)),e.hm.H.board.el("skyline").update(),n.sireniter+=s,0===Math.floor(n.sireniter/Math.max(50,100-15*(e.B+2-i))))return;n.sireniter-=Math.max(50,100-15*(e.B+2-i)),e.sfx.Play("warning",1,.33);const a=Bl(e.hm.H.stackobj,As(Ol.x)*e.Wh,As(Ol.x)*e.Hh);Ur.play("danger_flair",{x:a.x,y:a.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()}),Ur.play("bgsplashdanger",{direction:0,amt:e.B+6-i})},HyperTopoutWarningExtremePlus:function(a){if(!t.pause&&e.hm.IsFullMode()&&n.panicking&&e.fm.IsVisible()&&(o+=a,!(o<1))){if(o--,!e.bm.PieceMayLockHere(t.falling.type,t.falling.x,e.sdm.H.lastLegal,t.falling.r)){const t=Bl(e.hm.H.stackobj,0,0);return Ur.play("danger_smoke",{x:t.x,y:t.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()}),void(s||(e.iom.IsLocal()&&(nl.opacity(.25),nl.scale(1.03)),s=!0,i=e.sfx.Play("hyperalert",1,.33)))}s&&(e.iom.IsLocal()&&(nl.opacity(n.panicking?.5:1),nl.scale(n.panicking?1.01:1)),s=!1,i&&e.sfx.Stop(i))}}}},ne=function(e){"use strict";const t=e.gsm,n={leftBarCount:0,rightBarCount:0,seenGarbageIDs:new Set};function s(s){for(let i=1;i<=2;i++){if(t.setoptions[`slot_bar${i}`]!==s)continue;const o=new Set,a=`bar${i}`;for(const s of t.impendingdamage){let t=s.type;t+=s.active||"spawn"!==s.status?`_${s.status}`:"_inactive",e.hm.H.board.el(a).update("upsert",{id:s.id,size:s.amt/e.H,style:t}),n.seenGarbageIDs.delete(s.id),o.add(s.id)}for(const t of n.seenGarbageIDs)e.hm.H.board.el(a).update("upsert",{id:t,size:0});n.seenGarbageIDs=o}}function i(n,s,i=0){for(let o=1;o<=2;o++)t.setoptions[`slot_bar${o}`]===n&&e.hm.H.board.el(`bar${o}`).action("flash",{size:s/e.H,pos:i})}return{H:n,UpdateBar:function(n,s){for(let i=1;i<=2;i++)t.setoptions[`slot_bar${i}`]===n&&e.hm.H.board.el(`bar${i}`).update("simple",s)},UpdateBarTicker:function(n,s,i){for(let o=1;o<=2;o++)t.setoptions[`slot_bar${o}`]===n&&e.hm.H.board.el(`bar${o}`).update("ticker",{id:s,value:i})},BlastBar:function(t){i(t,e.H)},UpdateGarbageBar:s,ResetGarbageBar:function(n){for(let s=1;s<=2;s++)t.setoptions[`slot_bar${s}`]===n&&e.hm.H.board.el(`bar${s}`).update("clear");s(n)},FlashGarbageBar:i,ForceUpdateGarbageBar:function(n){for(let s=1;s<=2;s++)t.setoptions[`slot_bar${s}`]===n&&e.hm.H.board.el(`bar${s}`).action("forceupdate")}}},se=function(e){"use strict";const t=e.gsm;function n(n){const s=e.cm.constants.tetrominoes[n],i=e.cm.constants.spinbonuses_rules[t.setoptions.spinbonuses];return s?.spinbonus_override?s.spinbonus_override?.mini:i?.types_mini?.includes(n)}function s(){if(e.bm.IsLegalAtPos(t.falling.type,t.falling.x,t.falling.y+1,t.falling.r))return!1;if(!e.fm.HasRotated())return!1;let s=0,i=0;for(let n=0;n<4;n++){const o=e.cm.constants.cornerTable[t.falling.type]?.[t.falling.r];if(!o)break;e.bm.IsOccupied(t.falling.x+o[n][0],t.falling.y+o[n][1])&&(s++,t.falling.r!==o[n][2]&&t.falling.r!==o[n][3]||i++)}if(s<3)return!1;let o="normal";return n(t.falling.type)&&2!==i&&(o="mini"),3===t.falling.kick&&(o="normal"),o}const i="#*********_##########_##########_##########_##########_##########_##########_##########_##########_##########_########_########_########_########_########_########_########_########_########_#########";function o(){return!(t.setoptions.map||t.setoptions.can_undo||!t.setoptions.seed_random)&&e.bm.CheckStackAgainstMap(i)}return{IsTSpin:function(i){const o=i??function(n){const s=e.cm.constants.tetrominoes[n],i=e.cm.constants.spinbonuses_rules[t.setoptions.spinbonuses];return s?.spinbonus_override?s.spinbonus_override?.rule??"none":i?.types?.includes(n)?t.setoptions.spinbonuses:"none"}(t.falling.type);switch(o){case"stupid":return!e.bm.IsLegalAtPos(t.falling.type,t.falling.x,t.falling.y+1,t.falling.r)&&"normal";case"all":case"all-mini":return n(t.falling.type)?s():!e.bm.IsLegalAtPos(t.falling.type,t.falling.x-1,t.falling.y,t.falling.r)&&!e.bm.IsLegalAtPos(t.falling.type,t.falling.x+1,t.falling.y,t.falling.r)&&!e.bm.IsLegalAtPos(t.falling.type,t.falling.x,t.falling.y-1,t.falling.r)&&!e.bm.IsLegalAtPos(t.falling.type,t.falling.x,t.falling.y+1,t.falling.r)&&("all-mini"===o?"mini":"normal");case"handheld":case"T-spins":return s();default:return!1}},CheckObjectiveCleared:function(){if(t.playing&&t.setoptions.objective_type)switch(t.setoptions.objective_type){case"lines":return void(t.stats.lines>=t.setoptions.objective_count&&(t.successful=!0,e.gom.GameOver("clear"),e.c.IsServer()||e.pbm.BlastBar("progress")));case"garbage":return void(t.stats.garbage.cleared>=t.setoptions.objective_count&&(t.successful=!0,e.gom.GameOver("clear"),e.c.IsServer()||e.pbm.BlastBar("progress")));case"timed":{const n=e.esm.frame*(1e3/60),s=Math.ceil(Math.max(0,t.setoptions.objective_time-n)/1e3);e.c.IsServer()||s===t.time.prev||t.time.locked||("minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&(60===s&&e.hm.H.board.fx("timeleft").create("60\f3S LEFT"),30===s&&e.hm.H.board.fx("timeleft").create("30\f3S LEFT")),s>3&&s<=10?(e.iom.IsLocal()&&e.sfx.Play("timer1"),"minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&e.hm.H.board.fx("countdown").create(s)):s<=3&&s>0&&(e.iom.IsLocal()&&e.sfx.Play("timer2"),"minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&e.hm.H.board.fx("countdown").create(s))),t.time.prev=s,n>=t.setoptions.objective_time&&(t.successful=!0,e.gom.GameOver("clear"))}}},CheckSecretGrade:o,AwardSecrets:function(){e.iom.IsLocal()&&o()&&(e.sfx.Play("allclear"),Kt({msg:"you did a thing!",color:"#FFAE00",icon:"achievement"}),gn.post("/api/users/award",{type:"secretgrade"}))},GetAchievements:function(){return{oneeight:10===t.quadcolumns[1]||10===t.quadcolumns[8],mrboardwide:t.quadcolumns.every((e=>1===e)),zenithduotoprevive:t.zenith.highestrevive}}}};class ie extends w{static tetrominoes=new Set(["o","l","j","z","s","t","i"]);static attacks=new Set(["garbage_out_small","garbage_in_small","garbage_out_medium","garbage_in_medium","garbage_out_large","garbage_in_large","counter","offset","damage_small","damage_medium","damage_large","impact","damage_alert"]);static importantSfx=new Set(["thunder1","thunder2","thunder3","thunder4","thunder5","thunder6","allclear","clearbtb","clearquad","clearspin","clearline"]);constructor(e){super(e)}Play(e,t=1,n=1){if(this.self.c.IsServer())return;if(0===this.self.lm.H.soundSkipRate)return;if(this.options.nosound)return;if(this.self.iom.IsOnline()&&("minimal"===it.video.graphics||!1===it.volume.others))return;if(this.self.hm.IsTinyMode())return;if(ie.tetrominoes.has(e)&&!1===it.volume.next)return;if(ie.attacks.has(e)&&("minimal"===it.video.graphics||!1===it.volume.attacks))return;const s=ie.importantSfx.has(e);!this.self.iom.IsLocal()&&this.self.hm.IsSmallMode()&&(t=n,t*=s?.2:.05),s||(t*=this.self.lm.H.soundSkipRate);const i=this.self.hm.H.holderstate.cos*t,o=Math.max(-1,Math.min(1,this.self.hm.H.holderstate.cox*(void 0===it.volume.stereo?.5:it.volume.stereo)));return na.PlaySe(e,i,o)}Stop(e){return na.StopSe(e)}}const oe=function(e){"use strict";const t=e.gsm;return{LowerSpikeClock:function(){0!==t.spike.timer&&(t.spike.timer--,0===t.spike.timer&&(t.spike.count=0,t.spike.count_nomult=0))}}},ae=function(e){"use strict";return{GlobalShout:function(t,n,s){if(e.c.IsServer())return;if(!e.hm.IsFullMode())return;if(!e.iom.IsLocal()&&!s)return;const i=document.createElement("div");i.className=`ns shout ${t}`,i.textContent=n,document.getElementsByClassName("globalshouts")[0].appendChild(i),setTimeout((()=>{i.remove()}),5e3),"ultra"===it.video.graphics&&pl&&e.cm.constants.globalShoutStyles[t]&&e.cm.constants.globalShoutStyles[t]()}}},re=function(e){"use strict";const t=e.gsm,n={lastLegal:e.T-5};function s(...t){return e.hm.IsTinyMode()?Gl.generatePlaceholder(...t):Gl.generate(...t)}function i(...t){return e.hm.IsTinyMode()?jl.generatePlaceholder(...t):jl.generate(...t)}let o=0;function a(n,o,a,r,l,c=!1,p=!1,d=!1){if(e.c.IsServer())return;const h=e.cm.constants.tetrominoes[o],u=e.cm.GetPieceColor(o),_=t.setoptions.minoskin[u]||t.setoptions.minoskin.other,m=c?p?"x":"g":`${d?"s_":""}${u}`,g=c?i:s;for(let s=0;s<h.matrix.data[l].length;s++){const i=h.matrix.data[l][s][0]-h.matrix.dx,o=h.matrix.data[l][s][1]-h.matrix.dy,d=g(c?t.setoptions.minoskin.ghost:_,m,h.matrix.data[l][s][2]??255);d.position.set((a+i)*As(Ol.x),(Math.ceil(r)+o-e.B)*As(Ol.x)),c&&!p&&(d.alpha=void 0===it.video.shadowopacity?.15:it.video.shadowopacity,it.video.colorshadow&&(d.tint=Gl.getColor(_,u))),n.addChild(d)}}function r(n,i,o,a,r=!1,l=1){if(e.c.IsServer())return;let c=e.cm.constants.tetrominoes[i].preview.data;e.cm.kickset.preview_overrides[i]&&(c=e.cm.kickset.preview_overrides[i]);const p=e.cm.GetPieceColor(i),d=t.setoptions.minoskin[p]||t.setoptions.minoskin.other,h=r?"d":p;for(let e=0;e<c.length;e++){const t=c[e][0],i=c[e][1],r=s(d,h,c[e][2]??255,l);r.position.set(o+t*As(Ol.x*l)-("ultra"===it.video.graphics?1:0),a+i*As(Ol.x*l)-("ultra"===it.video.graphics?1:0)),n.addChild(r)}}return{H:n,DrawStack:function(){if(!e.c.IsServer())for(let n=e.hm.IsTinyMode()?e.B:0;n<e.T;n++)for(let i=0;i<e.W;i++){const o=t.board[n][i];if(null!==o){const a=s(t.setoptions.minoskin[o]||t.setoptions.minoskin.other,o,t.boardedges[n][i]);a.__mino=o,a.position.set(i*As(Ol.x),(n-e.B)*As(Ol.x)),e.hm.H.stackobj.addChild(a)}}},DrawStackMud:function(){if(!e.c.IsServer())for(const n of e.hm.H.stackmud){if(null===n)return;if(n[0]<(e.hm.IsTinyMode()?e.B:0))return;if(null===n[2])return;const i=n[2],o=t.setoptions.minoskin[i]||t.setoptions.minoskin.other,a=s(o,i,n[3]);if(a.__mino=i,a.__at=e.esm.frame,a.position.set(n[1]*As(Ol.x),(n[0]-e.B)*As(Ol.x)),e.hm.H.stackobj.addChild(a),e.hm.IsFullMode()&&!["minimal","low"].includes(it.video.graphics)){const e=Gl.generateFlash(o);e&&a.addChild(e)}}},ZenithAlpha:function(n){if(e.c.IsServer()||!e.hm.H.stackobj)return;const s=(e.esm.frame+o)/60%5;let i=0;i=s<.15?s/.15:1-Math.min(1,Math.max(0,1*(s-.35)));for(const n of e.hm.H.stackobj.children){if(!n.__mino)continue;let o=Math.min(1,i+Math.max(0,1-(e.esm.frame-(n.__at??0))/10));"minimal"===it.video.graphics&&(o=s<1?1:0),!t.pause&&t.playing||(o=1),t.setoptions.display_replay&&(o=.4+.6*o),n.alpha="gb"===n.__mino||"gbd"===n.__mino?.7+.3*o:o}o=(o+n)%1},DrawFalling:function(){if(e.c.IsServer())return;if(t.pause||e.fm.IsSleep())return;if(!e.fm.IsVisible())return;let s=t.falling.y;for(;;){if(!e.bm.IsLegalAtPos(t.falling.type,t.falling.x,s+1,t.falling.r)){!1!==t.setoptions.display_shadow&&a(e.hm.H.fallingobj,t.falling.type,t.falling.x,s,t.falling.r,!0);break}s++}n.lastLegal=s,a(e.hm.H.fallingobj,t.falling.type,t.falling.x,t.falling.y,t.falling.r,!1,!1,!0);const i=t.bag[0],o=e.cm.GetPieceOffset(i),r=e.cm.GetPieceSpawnRotation(i);e.hm.IsFullMode()&&!1!==t.setoptions.display_next&&e.pm.H.panicking&&a(e.hm.H.fallingobj,t.bag[0],Math.floor(e.W/2)-1+o[r][0],e.B-2.04+o[r][1],r,!0,!0)},DrawFallingOpacity:function(){if(e.c.IsServer())return;const n=e.hm.H.fallingobj.alpha;t.pause||e.fm.IsSleep()||"minimal"===it.video.graphics?e.hm.H.fallingobj.alpha=1:(e.hm.H.fallingobj.alpha=1-t.falling.locking/t.setoptions.locktime/2,n!==e.hm.H.fallingobj.alpha&&e.hm.IsFullMode()&&(bl=!0))},DrawNext:function(){if(!e.c.IsServer())for(let n=0;n<t.setoptions.nextcount;n++){if(!t.bag[n])return;if(!e.hm.H.nextobj||!e.hm.H.nextobj[n])return;vl(e.hm.H.nextobj[n]);const s=e.cm.constants.tetrominoes[t.bag[n]],[i,o]=[s.preview.w,s.preview.h];let a=1;(i>4||o>2)&&(a=i>o?3/i:2/o),r(e.hm.H.nextobj[n],t.bag[n],i*As(Ol.x*a)/-2,o*As(Ol.x*a)/-2,!1,a)}},DrawHold:function(){if(e.c.IsServer())return;if(!e.hm.H.holdobj)return;if(vl(e.hm.H.holdobj),null===t.hold)return;const n=e.cm.constants.tetrominoes[t.hold],[s,i]=[n.preview.w,n.preview.h];let o=1;(s>4||i>2)&&(o=s>i?3/s:2/i),r(e.hm.H.holdobj,t.hold,s*As(Ol.x*o)/-2,i*As(Ol.x*o)/-2,t.holdlocked&&!1!==it.video.holdlocked,o)},RenderTetromino:a,RenderTetrominoPreview:r}},le=function(e){"use strict";const t=e.gsm,n={inputSoftdrop:!0,lShift:!0,rShift:!0,lastshift:!0,targets:!0,enemies:!0,source:!0,replay:!0,aggregatestats:!0};function s(){return{game:{board:t.board,bag:t.bag,hold:{piece:t.hold,locked:t.holdlocked},g:t.g,controlling:{lShift:t.lShift,rShift:t.rShift,lastshift:t.lastshift,inputSoftdrop:t.inputSoftdrop},falling:t.falling,handling:t.handling,playing:t.playing},stats:t.stats,diyusi:t.diyusi}}return{Snapshot:s,Export:function(){const n=Math.max(1,e.esm.frame/60),i=(t.stats.garbage.attack+t.stats.garbage.cleared)/Math.max(1,t.stats.piecesplaced);return{successful:t.successful,gameoverreason:t.gameoverreason,options:{...t.setoptions},killer:t.killer,aggregatestats:{apm:(t.stats.garbage.attack||0)/(e.esm.frame/3600||1),pps:(t.stats.piecesplaced||0)/(e.esm.frame/60||1),vsscore:i*(t.stats.piecesplaced/n)*100},...s()}},EjectState:function(){return Gt({game:{...t,unsafewaitingframes:[],started:!0,countdown_started:!0,rng:t.rng?.seed,rngex:t.rngex?.seed},frame:e.esm.frame,overrides:e.cm.overrides})},OverlayState:function(s){if(!t.setoptions.can_undo)return;const i=s.game,o=s.overrides;e.wfm.ExecuteUnsafeWaitingFrames(!0),i.rng=new x(i.rng),i.rngex=new x(i.rngex||0);for(const[e,s]of Object.entries(i))"function"!=typeof t[e]&&(n[e]||("actors"!==e?"object"!=typeof t[e]||null===t[e]||Array.isArray(t[e])?t[e]=s:Object.assign(t[e],s):t[e]=s));e.cm.SetConstantsOverrides(o),e.cm.Reload(),e.hm.H.stackdirty=!0,e.hm.H.fallingdirty=!0,e.hm.H.nextdirty=!0,e.hm.H.holddirty=!0,e.dsm.frozen=!1,e.stm.H.stockExploding=!1,e.bm.ClearIsLegalAtPosMemo(),e.gem.ClearSeenIGEs(),e.lm.H.lastdT=1,e.lm.H.lastdTs=[],e.pbm.H.seenGarbageIDs=new Set,e.zthm.duoOtherSideGame=null,e.c.OnClient((()=>{e.zthm.ClearBonusDisplay(),e.pbm.ResetGarbageBar("impending"),e.am.RedrawActors(),e.hm.Restate()}))},EjectOverlayState:function(){return Gt({game:{...t,otherstates:void 0,unsafewaitingframes:[],rng:t.rng?.seed,rngex:t.rngex?.seed,started:!0,countdown_started:!0},overrides:e.cm.overrides})},InjectState:function(n){if(e.iom.IsOnline()&&e.iom.IsSynced())return;const s=n.game,i=n.overrides;e.wfm.ExecuteUnsafeWaitingFrames(!0),s.rng=new x(s.rng),s.rngex=new x(s.rngex||0);const[o,a,r,l]=[t.setoptions.boardwidth,t.setoptions.boardheight,t.setoptions.boardskin,JSON.stringify(t.setoptions.minoskin)];for(const[e,n]of Object.entries(s))"function"!=typeof t[e]&&("actors"!==e?"object"!=typeof t[e]||null===t[e]||Array.isArray(t[e])?t[e]=n:Object.assign(t[e],n):t[e]=n);e.cm.SetConstantsOverrides(i),e.cm.Reload(),e.hm.H.stackdirty=!0,e.hm.H.fallingdirty=!0,e.hm.H.nextdirty=!0,e.hm.H.holddirty=!0,e.dsm.frozen=!1,e.stm.H.stockExploding=!1,e.bm.ClearIsLegalAtPosMemo(),e.gem.ClearSeenIGEs(),e.iom.synced=!0,e.lm.H.lastdT=1,e.lm.H.lastdTs=[],e.pbm.H.seenGarbageIDs=new Set,e.zthm.duoOtherSideGame=null,e.c.OnClient((()=>{e.pbm.ResetGarbageBar("impending"),e.zthm.ClearBonusDisplay(),e.am.RedrawActors(),e.hm.Restate();const[n,s,i,c]=[t.setoptions.boardwidth,t.setoptions.boardheight,t.setoptions.boardskin,JSON.stringify(t.setoptions.minoskin)];o===n&&a===s&&r===i&&l===c||e.hm.CreateHolder()}))},EjectBoardState:function(){return{b:t.board.filter((e=>!e.every((e=>null===e)))),f:t.fire,g:t.garbagereceived,w:e.W,h:e.H}},InjectBoardState:function(n){if(e.iom.IsSynced())return;t.fire=n.f,t.garbagereceived=n.g;const[s,i]=[t.setoptions.boardwidth,t.setoptions.boardheight],[o,a]=[n.w,n.h];s!==o||i!==a?(t.setoptions.boardwidth=o,t.setoptions.boardheight=a,t.setoptions.boardbuffer=a,e.hm.CreateHolder()):e.hm.H.stackdirty=!0;const r=[],l=[];for(let t=0;t<e.T;t++){const s=[];for(let t=0;t<e.W;t++)s.push(255);if(l.push(s),e.T-t<=n.b.length){r.push(n.b[t-(e.T-n.b.length)]);continue}const i=[];for(let t=0;t<e.W;t++)i.push(null);r.push(i)}t.board=r,t.boardedges=l}}},ce=function(e){"use strict";const t=e.gsm,n={stockExploding:!1};return{H:n,ExplodingStock:function(t){e.c.IsServer()||e.hm.H.board.el("stock").action("fire",{frame:e.esm.frame,dT:t})},LoseStockOrGameOver:function(s){if(!t.pause)return t.setoptions.zenith_duo?e.zthm.IncapacitateSelf(s):void(t.stock<=0&&!t.setoptions.infinite_stock?e.gom.GameOver(s):(t.pause=!0,e.fm.SetSleep(!0),e.hm.H.fallingdirty=!0,e.wfm.WaitFrames(1,"freeze-counters",{}),e.rbm.AwardSecrets(),e.c.OnClient((()=>{if(e.gpm.Vibrate(si.TOPOUT),n.stockExploding=!0,e.sfx.Play("losestock"),e.hm.H.holderstate.ds+=100*e.lm.H.lastdT,e.hm.IsFullMode()&&(Ur.play("bgsplashdanger",{direction:0,amt:50}),Ur.play("bgcircle",{color:16720384,amt:300,speed:300})),!1!==it.video.siren&&e.hm.IsFullMode()){const t=Bl(e.hm.H.stackobj,As(Ol.x*e.Wh),As(Ol.x*e.Hh));Ur.play("death_flair",{x:t.x,y:t.y,w:e.W*e.hm.S(),h:e.H*e.hm.S()})}})),e.wfm.WaitFrames(90,"revive-from-stock-loss",{})))},ReviveFromStockLoss:function(){t.setoptions.infinite_stock||t.stock--,t.pause=!1,e.dsm.frozen=!1,e.bm.DestroyBoard(),t.setoptions.zenlevels&&(t.stats.lines=0,t.stats.inputs=0,t.stats.piecesplaced=0,t.stats.garbage.sent=0,t.stats.garbage.attack=0,t.stats.garbage.cleared=0,t.stats.combo=0,t.stats.combopower=0,t.stats.btbpower=0,t.stats.btb=0,t.stats.finesse.combo=0,t.stats.finesse.faults=0,t.stats.finesse.perfectpieces=0,t.time.frameoffset=e.esm.frame,(t.setoptions.b2bchaining||t.setoptions.b2bcharging)&&e.hm.H.board.el("b2b").delete()),e.fm.Next(),e.c.OnClient((()=>{e.gpm.Vibrate(si.CLEAR),t.setoptions.infinite_stock||e.hm.H.board.el("stock").action("drop"),n.stockExploding=!1,e.hm.H.holderstate.ds+=50*e.lm.H.lastdT,e.sfx.Play("shatter")}))}}},pe=function(e){"use strict";const t=e.gsm;function n(){for(let n=0;n<100;n++){const n=Math.floor(t.rngex.nextFloat()*e.bm.ColumnWidth());if(t.lastcolumn!==n){t.lastcolumn=n;break}}}function s(s=!1){if("layer"!==t.setoptions.survivalmode)return;const i=t.board.reduce(((e,t)=>e+(0|t.some((e=>"gb"===e)))),0),o=Math.min(e.H,Math.max(0,Math.floor(s?t.setoptions.survival_layer_min:t.setoptions.survival_layer_amt))),a=t.setoptions.survival_cap>0?t.setoptions.survival_cap:1/0;if(i<o&&t.cheesespawned<a){e.c.OnClient((()=>{e.gpm.Vibrate(si.GARBAGERISE),e.sfx.Play("garbagerise")}));for(let s=0;s<o-i&&((null===t.lastcolumn||100*t.rngex.nextFloat()<=t.setoptions.survival_messiness)&&n(),e.hm.H.holderstate.ds+=2*e.lm.H.lastdT,e.bm.PushLine({column:t.lastcolumn}),e.bm.ClearIsLegalAtPosMemo(),e.bm.PushUpFallingIfNeeded(),e.hm.H.fallingdirty=!0,!(++t.cheesespawned>=a));s++);}else if(i>o&&!s){e.c.OnClient((()=>{e.gpm.Vibrate(si.GARBAGERISE),e.sfx.Play("garbagerise")}));const n=[];for(let e=0;e<i-o;e++)n.push(t.board.length-1-e);e.hm.H.holderstate.ds+=2*e.lm.H.lastdT,e.bm.ClearIsLegalAtPosMemo(),e.bm.RemoveLinesFromStack(n),e.bm.PushUpFallingIfNeeded(),e.hm.H.fallingdirty=!0}}return{UpdateLoop:function(){if("none"!==t.setoptions.survivalmode)switch(t.setoptions.survivalmode){case"layer":s(!!t.setoptions.survival_layer_non);break;case"timer":!function(){if(t.pause||e.fm.IsSleep())return;if(t.setoptions.survival_cap>0&&t.cheesespawned>=t.setoptions.survival_cap)return;e.esm.frame%t.setoptions.survival_timer_itv==0&&(e.bm.IsFull()&&e.stm.LoseStockOrGameOver("garbagesmash"),(null===t.lastcolumn||100*t.rngex.nextFloat()<=t.setoptions.survival_messiness)&&n(),e.hm.H.fallingdirty=!0,e.hm.H.holderstate.ds+=2*e.lm.H.lastdT,e.c.OnClient((()=>{e.gpm.Vibrate(si.GARBAGERISE),e.sfx.Play("garbagerise")})),e.bm.PushLine({column:t.lastcolumn}),e.bm.ClearIsLegalAtPosMemo(),e.bm.PushUpFallingIfNeeded(),t.cheesespawned++)}()}},UpdateCheeseLayer:s}};class de extends w{static EVEN=0;static ELIMINATION=1;static RANDOM=2;static PAYBACK=3;static MANUAL=4;constructor(e){super(e),this.enabled=!0,this.targeted=!1,this.enemy=!1,this.interval=0,this.b2bdistance=0}GetTargets(){return this.S.targets}SetTargets(e){const t=[];for(const n of this.S.targets)e.includes(n)?t.push(n):this.self.elm.emit("target",n,!1);for(const n of e)t.includes(n)||this.self.elm.emit("target",n,!0);this.S.targets=[...e],this.S.targets.length||this.UpdateStrategy()}SetTargeted(e=this.targeted){this.targeted=e,this.self.iom.IsHeadless()||this.self.hm.H.board.el("targeticon")[e?"create":"delete"]()}SetEnemy(e=this.enemy){this.enemy=e,this.self.iom.IsHeadless()||this.self.hm.H.board.el("enemyicon")[e?"create":"delete"]()}IsEnabled(){return this.enabled}SetEnabled(e){this.enabled=e,this.self.elm.emit("allow_target",e)}IsEven(){return this.S.diyusi===de.EVEN}IsElimination(){return this.S.diyusi===de.ELIMINATION}IsRandom(){return this.S.diyusi===de.RANDOM}IsPayback(){return this.S.diyusi===de.PAYBACK}IsManual(){return this.S.diyusi>=de.MANUAL}AddEnemy(e){this.S.enemies.includes(e)||(this.S.enemies.push(e),this.self.elm.emit("enemy",e,!0)),this.IsPayback()&&this.options.new_payback&&(this.S.targets.includes(e)||(this.S.targets.push(e),this.self.elm.emit("target",e,!0)),this.S.targets=this.S.targets.filter((e=>!!this.S.enemies.includes(e)||(this.self.elm.emit("target",e,!1),!1))))}RemoveEnemy(e){this.S.enemies=this.S.enemies.filter((t=>t!==e)),this.self.elm.emit("enemy",e,!1),this.IsPayback()&&this.options.new_payback&&(this.S.targets=this.S.targets.filter((t=>t!==e)),this.self.elm.emit("target",e,!1),this.S.targets.length||this.UpdateStrategy())}RemovePlayer(e){let t=this.S.enemies.indexOf(e);-1!==t&&(this.S.enemies.splice(t,1),this.self.elm.emit("enemy",e,!1)),t=this.S.targets.indexOf(e),-1!==t&&(this.S.targets.splice(t,1),this.self.elm.emit("target",e,!1)),this.S.targets.length||this.UpdateStrategy()}SetStrategy(e,t=null){if(this.IsEnabled()){if(this.S.laststrategychange>this.self.esm.frame)return this.self.iom.IsLocal()&&this.self.sfx.Play("no");this.S.diyusi=e,this.UpdateStrategy(t),this.S.laststrategychange=this.self.esm.frame+30,this.self.iom.IsLocal()&&this.self.sfx.Play("target"),this.self.elm.emit("strategy",this.S.diyusi)}}UpdateStrategy(e=null){this.self.c.IsServer()&&(this.interval=this.self.esm.frame+300,this.self.elm.emit("action",{type:"strategy",value:this.S.diyusi,target:e}))}Loop(){this.IsEnabled()&&(this.IsManual()||this.IsPayback()&&this.options.new_payback&&this.S.enemies.length||this.self.esm.frame===this.interval&&this.UpdateStrategy())}SetB2BDistance(e){const t=this.b2bdistance;if(t!==e){if(this.b2bdistance=e,t<=-8&&e>-8)return this.self.hm.H.board.el("b2bdistance").delete(Math.min(0,e));e<=-8&&t>-8?(this.self.hm.H.board.el("b2bdistance").create(e),this.self.sfx.Play("b2bcharge_danger")):this.self.hm.H.board.el("b2bdistance").update(e)}}}const he=function(e){"use strict";const t=e.gsm,n=100;function s(){t.otherstates.lastpiece=e.siom.EjectOverlayState()}function i(){t.otherstates.undo.push(t.otherstates.lastpiece),t.otherstates.undo.length>n&&t.otherstates.undo.shift(),t.otherstates.redo.length=0}return{Enable:function(){e.elm.on("piece","undo",s),e.elm.on("lock","undo",i)},Disable:function(){t.otherstates.undo.length=0,t.otherstates.redo.length=0,t.otherstates.lastpiece=null,e.elm.remove("piece","undo"),e.elm.remove("lock","undo")},Copy:s,Save:i,Undo:function(){if(t.setoptions.can_undo&&!t.pause){if(t.otherstates.undo.length<1)return e.c.OnClient((()=>{e.hm.H.holderstate.ds+=10*e.lm.H.lastdT,e.sfx.Play("no")}));t.otherstates.redo.push(t.otherstates.lastpiece),t.otherstates.lastpiece=t.otherstates.undo.pop(),e.siom.OverlayState(Gt(t.otherstates.lastpiece)),t.impendingdamage=t.impendingdamage.filter((e=>e.active)),e.hm.CreateHolder(),e.znm.UpdateFromZenConfig(),t.retry=!1,t.retryiter=0,t.esc=!1,t.esciter=0,e.c.OnClient((()=>{e.hm.H.holderstate.dx-=7*e.lm.H.lastdT,e.hm.H.board.fx("undoredo").create(!1),e.sfx.Play("undo",.7)}))}},Redo:function(){if(t.setoptions.can_undo&&!t.pause){if(t.otherstates.redo.length<1)return e.c.OnClient((()=>{e.hm.H.holderstate.ds+=10*e.lm.H.lastdT,e.sfx.Play("no")}));t.otherstates.undo.push(t.otherstates.lastpiece),t.otherstates.lastpiece=t.otherstates.redo.pop(),e.siom.OverlayState(Gt(t.otherstates.lastpiece)),t.impendingdamage=t.impendingdamage.filter((e=>e.active)),e.hm.CreateHolder(),e.znm.UpdateFromZenConfig(),t.retry=!1,t.retryiter=0,t.esc=!1,t.esciter=0,e.c.OnClient((()=>{e.hm.H.holderstate.dx+=7*e.lm.H.lastdT,e.hm.H.board.fx("undoredo").create(!0),e.sfx.Play("redo",.7)}))}}}},ue=function(e){"use strict";const t=e.gsm;function n(t){switch(t.type){case"are":e.fm.Next();break;case"incoming-attack-hit":e.atm.IncomingAttackHit(t.data.gid);break;case"start-explode-attack":e.atm.StartExplodeAttack(t.data);break;case"process-exploded-attack":e.atm.ProcessExplodedAttack(t.data);break;case"outgoing-attack-hit":e.atm.OutgoingAttackHit();break;case"process-garbage-status":e.atm.ProcessGarbageStatus(t.data.id);break;case"push-garbage-line":e.bm.AreWeToppedYet(),e.bm.PushLine(t.data),e.bm.ClearIsLegalAtPosMemo(),e.bm.PushUpFallingIfNeeded(),e.hm.H.fallingdirty=!0,e.zthm.IncrementPrompt("tank",1),e.c.OnClient((()=>{e.gpm.Vibrate(si.GARBAGERISE),e.sfx.Play("garbagerise")}));break;case"freeze-counters":e.dsm.frozen=!0;break;case"revive-from-stock-loss":e.stm.ReviveFromStockLoss();break;case"revive-other":e.zthm.ReviveOther();break;case"revive-self-finish":e.zthm.ReviveSelfFinish()}}return{WaitFrames:function(n,s,i){t.waitingframes.push({target:(e.esm?.frame??0)+n,type:s,data:i})},ExecuteWaitingFrames:function(){const s=e.esm?.frame??0;for(let e=t.waitingframes.length-1;e>=0;e--)t.waitingframes[e].target===s&&(n(t.waitingframes[e]),t.waitingframes.splice(e,1))},ExecuteWaitingFrame:n,WaitFramesUnsafe:function(n,s){t.unsafewaitingframes.push({target:(e.esm?.frame??0)+n,handler:s})},ExecuteUnsafeWaitingFrames:function(n=!1){const s=e.esm?.frame??0;for(let e=t.unsafewaitingframes.length-1;e>=0;e--)(t.unsafewaitingframes[e].target===s||n)&&(t.unsafewaitingframes[e].handler(),t.unsafewaitingframes.splice(e,1))}}},_e=function(e){"use strict";const t=e.gsm,n={leveling:"on",spins:"all-mini",combotable:"multiplier",kickset:"SRS+",stride:"on",gravitymode:"relaxed",gravitystatic:20,counters:"off",garbagemode:"off",cheeselayer_height:6,cheesetimer_interval:4,cheesemessiness:100,infinite_hold:"off"};function i(){localStorage.setItem("zenConfig",JSON.stringify(n))}function o(){switch(n.gravitymode){case"subzero":t.g=0,t.setoptions.infinite_movement=!0,t.setoptions.locktime=999999999;break;case"off":t.g=0,t.setoptions.infinite_movement=!1,t.setoptions.locktime=30;break;case"relaxed":t.g=.015+.035*s(.78,.21,.86,.43)(Math.min(1,Math.max(0,t.stats.zenprogress))),t.setoptions.infinite_movement=!1,t.setoptions.locktime=30;break;case"engaging":t.g=.05+.2*s(.78,.21,.86,.43)(Math.min(1,Math.max(0,t.stats.zenprogress))),t.setoptions.infinite_movement=!1,t.setoptions.locktime=30;break;case"spicy":t.g=.25+2.25*s(.78,.21,.86,.43)(Math.min(1,Math.max(0,t.stats.zenprogress))),t.setoptions.infinite_movement=!1,t.setoptions.locktime=30;break;case"static":t.g=n.gravitystatic,t.setoptions.infinite_movement=!1,t.setoptions.locktime=30}}return{ScoreToZenProgress:function(e,s){return t.setoptions.usezenconfig&&"off"===n.leveling?0:e/(1e4+1e4*(Math.log2(s+1)-1))},ZenLevelup:function(){if(t.setoptions.usezenconfig&&"discreet"===n.leveling)return e.sfx.Play("levelup"),t.stats.zenlevel++,t.stats.zenprogress=0,o(),"minimal"!==it.video.graphics&&"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&e.hm.H.board.fx("levelup").create(t.stats.zenlevel),e.hm.IsFullMode()&&0!==e.lm.H.soundSkipRate&&Ur.play("bgcircle"),e.pbm.BlastBar("progress"),Rs.saveZen({map:e.bm.BoardToMap(),level:t.stats.zenlevel,progress:t.stats.zenprogress,score:t.stats.score}),Us(),na.PlayBgmSmoothlyWithRandom("RANDOMcalm"),!1;t.pause=!0,e.fm.SetSleep(!0),e.wfm.WaitFrames(1,"freeze-counters",{}),t.escAllowed=!1,t.retryAllowed=!1,xt("zen_panel").classList.add("noop"),e.hm.H.board.fx("zenlevel").create(e.cm.constants.Strings.extra.zenlevel),Ur.play("bgcircle",{amt:300,speed:300}),na.FadeOutBgm(3),e.sfx.Play("warp",1.25);const i=new a.Graphics;i.beginFill(14540253,1),i.drawRect(0,0,innerWidth,innerHeight),i.endFill(),i.position.set(0,0),i.alpha=0,Gr.addChild(i);const r=new a.Graphics;return r.beginFill(14540253,1),r.drawRect(innerWidth/-2,-2,innerWidth,4),r.endFill(),r.position.set(innerWidth/2,innerHeight/2),r.alpha=0,r.scale.x=0,Gr.addChild(r),El.animate(e.hm.H.holder,{0:{"scale.x":"inherit","scale.y":"inherit",rotation:0},1:{"scale.x":0,"scale.y":0,rotation:-1}},3.1,s(.93,0,.83,-.89)),setTimeout((()=>{if("ultra"===it.video.graphics){const e=new a.filters.PixelateFilter(1),t=new a.filters.TwistFilter(innerWidth,0);t.offset=new a.Point(innerWidth/2,innerHeight/2);const n=new a.filters.TwistFilter(innerWidth/3,0);n.offset=new a.Point(innerWidth/2,innerHeight/2),il.filters=[e,t,n],El.animate(t,{0:{angle:0},1:{angle:-3}},2.1,s(.61,.01,.94,.04)),El.animate(n,{0:{angle:0},1:{angle:10}},2.1,s(.61,.01,.94,.04)),El.animate(e,{0:{size:1},1:{size:100}},2.1,s(.61,.01,.94,.04)),setTimeout((()=>{nl.scale(3)}),1950)}}),1e3),setTimeout((()=>{El.animate(sl,{0:{alpha:"inherit"},1:{alpha:0}},.5,s(.5,.5,.5,.5))}),2600),setTimeout((()=>{El.animate(i,{0:{alpha:0},1:{alpha:1}},.2,s(.5,.5,.5,.5)),El.animate(r,{0:{alpha:0,"scale.x":0},1:{alpha:1,"scale.x":1}},.2,s(.5,.5,.5,.5)),Ur.play("zen_wormhole")}),2900),setTimeout((()=>{t.stats.zenlevel++,t.stats.zenprogress=0,nl.opacity(0),e.dsm.frozen=!1,il.filters=null,t.stats.lines=0,t.stats.inputs=0,t.stats.piecesplaced=0,t.stats.garbage.sent=0,t.stats.garbage.attack=0,t.stats.garbage.cleared=0,t.stats.finesse.combo=0,t.stats.finesse.faults=0,t.stats.finesse.perfectpieces=0,o();const n=t.board.reduce(((e,t)=>e+(t.some((e=>"gb"===e))?1:0)),0);for(let s=0;s<n;s++)t.board.pop(),t.board.unshift(Array(e.W).fill(null)),t.boardedges.pop(),t.boardedges.unshift(Array(e.W).fill(255)),e.bm.ClearIsLegalAtPosMemo(),e.am.RemoveRow(e.T()-1),e.hm.H.fallingdirty=!0,e.hm.H.stackdirty=!0;Rs.saveZen({map:e.bm.BoardToMap(),level:t.stats.zenlevel,progress:t.stats.zenprogress,score:t.stats.score}),El.animate(i,{0:{alpha:1},1:{alpha:0}},1,s(.5,.5,.5,.5))}),3100),setTimeout((()=>{nl.scale(1),Us(),El.animate(i,{0:{alpha:0},.2:{alpha:1},1:{alpha:.2}},.4,s(.5,.5,.5,.5)),Ur.play("zen_wormhole_exit")}),6400),setTimeout((()=>{El.animate(i,{0:{alpha:.2},1:{alpha:1}},.6,s(.5,.5,.5,.5)),El.animate(r,{0:{"scale.y":1},1:{"scale.y":300}},.6,s(.46,.06,.79,.09))}),6800),setTimeout((()=>{r.destroy(),t.destroyed||(e.hm.H.holder.rotation=0,El.animate(e.hm.H.holder,{0:{"scale.x":0,"scale.y":0},1:{"scale.x":1,"scale.y":1}},3,s(.24,.59,.32,.96))),El.animate(i,{0:{alpha:1},1:{alpha:0}},1,s(.5,.5,.5,.5)),sl.alpha=Math.min(1,10*it.video.background),nl.opacity(.9)}),7400),setTimeout((()=>{i.destroy(),t.destroyed||(t.pause=!1,t.escAllowed=!0,t.retryAllowed=!0,t.time.frameoffset=e.esm.frame,e.fm.SetSleep(!1),e.fm.Next(),e.hm.CreateHolder(),na.PlayBgmSmoothlyWithRandom("RANDOMcalm")),nl.opacity(1),xt("zen_panel").classList.remove("noop")}),10400),!0},GetZenConfig:function(){return n},LoadZenConfig:function(){const e=localStorage.getItem("zenConfig");if(e){const t=JSON.parse(e);for(const e in t)n[e]||delete t[e];Object.assign(n,t);for(const e of yt("#zen_panel_content .panel_optionset .panel_option")){const t=e.getAttribute("data-key"),s=e.getAttribute("data-value");n[t]===s?e.classList.add("selected"):e.classList.remove("selected")}}},SaveZenConfig:i,UpdateFromZenConfig:function(){if(t.setoptions.usezenconfig){switch(n.leveling){case"off":t.setoptions.slot_bar2="";break;case"on":case"discreet":t.setoptions.slot_bar2="progress"}switch(n.spins&&(t.setoptions.spinbonuses=n.spins),n.combotable&&(t.setoptions.combotable=n.combotable),n.kickset&&(t.setoptions.kickset=n.kickset),t.setoptions.infinite_hold="on"===n.infinite_hold,t.setoptions.infinite_hold&&(t.holdlocked=!1),o(),t.setoptions.slot_counter1="",t.setoptions.slot_counter2="",t.setoptions.slot_counter3="",t.setoptions.slot_counter4="",t.setoptions.slot_counter5="",t.setoptions.hasgarbage=!1,n.counters){case"versus":t.setoptions.slot_counter1="attack",t.setoptions.slot_counter2="pieces",t.setoptions.slot_counter5="vs",t.setoptions.hasgarbage=!0;break;case"time":t.setoptions.slot_counter1="stopwatch",t.setoptions.slot_counter2="lines",t.setoptions.slot_counter3="pieces",t.setoptions.slot_counter5="finesse";break;case"speed":t.setoptions.slot_counter1="pieces",t.setoptions.slot_counter2="keys",t.setoptions.slot_counter5="finesse";break;case"efficiency":t.setoptions.slot_counter1="finesse_l",t.setoptions.slot_counter2="keys",t.setoptions.slot_counter5="vs"}switch(n.garbagemode){case"off":t.setoptions.slot_bar1="",t.setoptions.survivalmode="none";break;case"backfire_half":case"backfire_full":case"backfire_double":t.setoptions.slot_bar1="impending",t.setoptions.hasgarbage=!0,t.setoptions.survivalmode="none";break;case"unclear_half":case"unclear_full":case"unclear_double":t.setoptions.slot_bar1="",t.setoptions.hasgarbage=!0,t.setoptions.survivalmode="none";break;case"cheeselayer":t.setoptions.slot_bar1="",t.setoptions.survivalmode="layer",t.setoptions.survival_messiness=n.cheesemessiness,t.setoptions.survival_layer_amt=n.cheeselayer_height;break;case"cheesetimer":t.setoptions.slot_bar1="",t.setoptions.survivalmode="timer",t.setoptions.survival_messiness=n.cheesemessiness,t.setoptions.survival_timer_itv=60*n.cheesetimer_interval}e.hm.CreateHolder(),i()}},UpdateZenGravity:o,UpdateGarbageOffense:function(s){if(n.garbagemode.startsWith("backfire_")){let i=s;if("backfire_half"===n.garbagemode&&(i=Math.floor(s/2)),"backfire_double"===n.garbagemode&&(i=Math.floor(2*s)),i<1)return;e.atm.AddPendingGarbage({type:"garbage",amt:i,column:Math.floor(t.rngex.nextFloat()*e.bm.ColumnWidth()),x:5,y:35,active:!1})}else if(n.garbagemode.startsWith("unclear_")){let i=s;if("unclear_half"===n.garbagemode&&(i=Math.floor(s/2)),"unclear_double"===n.garbagemode&&(i=Math.floor(2*s)),i<1)return;const o=Math.floor(t.rngex.nextFloat()*e.bm.ColumnWidth());e.gpm.Vibrate(si.GARBAGERISE),e.sfx.Play("garbagerise");for(let t=0;t<i;t++)e.bm.IsFull()&&e.stm.LoseStockOrGameOver("garbagesmash"),e.hm.H.holderstate.ds+=2*e.lm.H.lastdT,e.bm.PushLine({column:o,edges:(0===t?64:0)|(t>=i-1?4:0)})}}}};class me extends w{static FloorDistance=[0,50,150,300,450,650,850,1100,1350,1650,1/0];static GravityBumps=[0,.48,.3,.3,.3,.3,.3,.3,.3,.3,.3];static LockTimes=[0,30,29,28,27,26,24,22,20,18,16];static SpeedrunReq=[7,8,8,9,9,10,0,0,0,0,0];static Mods=["invisible","messy","volatile","nohold","doublehole","allspin","gravity","expert","duo"];static GetSpeedCap(e){const t=this.FloorDistance.find((t=>e<t))-e;return Math.max(0,Math.min(1,t/5-.2))}static GetFloorLevel(e){return this.FloorDistance.filter((t=>e>=t)).length||1}constructor(e){super(e),this.duoOtherSideGame=null,this.duoOtherSidePrompts=[],this.lastBg=null,this._targetingGrace=[0,4.8,3.9,2.1,1.4,1.3,.9,.6,.4,.3,.2]}Loop(){if(!this.S.setoptions.zenith)return;!this.self.c.IsServer()&&this.S.setoptions.zenith_duo&&Fa&&!this.duoOtherSideGame&&(this.duoOtherSideGame=Fa.Find(this.S.setoptions.zenith_ally[1]),this.duoOtherSideGame&&this.S.zenith.reviveprompts.length&&(this.duoOtherSideGame.duoSetPrompts(this.S.zenith.reviveprompts,!0),this.self.hm.H.board.el("zenithpromptsself").update(this.S.zenith.reviveprompts),this.self.hm.H.board.el("zenithpromptsself").action("fix"))),this.self.c.IsServer()&&this.S.setoptions.zenith_duo&&(this.duoOtherSideGame=null);const e=this.self.esm.frame;let t=Math.floor(this.S.stats.zenith.rank);const n=this.S.stats.zenith.altitude;if(e>=this.S.zenith.rank_locked_until){let e=3;this.S.setoptions.zenith_duo?(this.S.setoptions.zenith_expert&&e++,this.S.setoptions.zenith_allyexpert&&e++):this.S.setoptions.zenith_expert&&(e=5);this.S.zenith.climb_pts-=e*(t**2+t)/3600}const s=4*t,i=4*(t-1);if(this.S.zenith.climb_pts<0)if(t<=1)this.S.zenith.climb_pts=0;else{this.S.zenith.climb_pts+=i,this.S.zenith.last_rank_change_was_promote=!1,t--,this.self.c.OnClient((()=>{this.self.hm.H.duoIsRight||this.self.sfx.Play("speed_down")}));const e=me.SpeedrunReq[0];10!==me.GetFloorLevel(this.S.stats.zenith.altitude)&&t<e&&(this.S.stats.zenith.speedrun=!1)}else if(this.S.zenith.climb_pts>=s){this.S.zenith.climb_pts-=s,this.S.zenith.last_rank_change_was_promote=!0,this.S.zenith.rank_locked_until=e+Math.max(60,60*(5-this.S.zenith.promotion_fatigue)),this.S.zenith.promotion_fatigue++,t++,this.self.c.OnClient((()=>{this.self.hm.H.duoIsRight||this.self.sfx.Play(`speed_up_${Math.min(4,Math.max(1,t-1))}`)}));const n=me.SpeedrunReq[me.GetFloorLevel(this.S.stats.zenith.altitude)];!this.S.setoptions.zenith_duo&&0!==n&&t>=n&&(this.S.stats.zenith.speedrun=!0,this.S.stats.zenith.speedrun_seen=!0)}this.S.zenith.last_rank_change_was_promote&&this.S.zenith.climb_pts>=2*(t-1)&&(this.S.zenith.promotion_fatigue=0),this.S.stats.zenith.rank=t+this.S.zenith.climb_pts/(4*t),this.S.stats.zenith.peakrank=Math.max(this.S.stats.zenith.rank,this.S.stats.zenith.peakrank),this.S.stats.zenith.avgrankpts+=this.S.stats.zenith.rank;const o=.25*t,a=me.GetSpeedCap(this.S.stats.zenith.altitude);if(this.S.stats.zenith.altitude+=o/60*a,this.S.zenith.bonusremaining>0)if(this.S.zenith.bonusremaining<=.05)this.S.stats.zenith.altitude+=this.S.zenith.bonusremaining,this.S.zenith.bonusremaining=0;else{const e=Math.min(10,.1*this.S.zenith.bonusremaining);this.S.stats.zenith.altitude+=e,this.S.zenith.bonusremaining-=e}const r=this.S.stats.zenith.altitude,l=me.GetFloorLevel(r);if(l!==this.S.stats.zenith.floor&&(this.self.c.OnClient((()=>{if(!this.self.hm.H.duoIsRight){if(this.self.hm.IsFullMode()&&l>1){const e=Bl(this.self.hm.H.holder,As(Ol.x)*this.self.Wh,As(Ol.x)*this.self.Hh);Ur.play("spike_flair",{x:e.x,y:e.y,w:this.self.W*this.self.hm.S(),h:this.self.H*this.self.hm.S()})}const e=["","HALL OF BEGINNINGS","THE HOTEL","THE CASINO","THE ARENA","THE MUSEUM","ABANDONED OFFICES","THE LABORATORY","THE CORE","CORRUPTION","PLATFORM OF THE GODS"];this.self.hm.H.board.fx("timeleft").create(`\fc3FLOOR \fc9${l}\f3\n\n${e[l]}`);const t=[null,null,"zenith_levelup_c","zenith_levelup_b","zenith_levelup_a","zenith_levelup_fsharp","zenith_levelup_e","zenith_levelup_a","zenith_levelup_ahalfsharp","zenith_levelup_e","zenith_levelup_e"];null==t[l]||this.S.stats.zenith.speedrun||this.self.sfx.Play(t[l])}})),this.S.setoptions.zenith_gravity&&(this.S.g+=me.GravityBumps[l],this.S.setoptions.locktime=me.LockTimes[l]),1===l?this.S.glock=240:this.S.stats.zenith.splits[l-2]=Math.round(this.self.lm.GetGameTime())),this.S.stats.zenith.floor=l,!this.self.c.IsServer()&&("minimal"===it.video.graphics||it.video.nozenithanim)&&this.self.iom.IsLocal()){const e=me.GetApplicableBg(r);e!==this.lastBg&&(nl.setBackground(e),this.lastBg=e)}if(void 0!==this.S.TEMP_zenith_apm_cycle){if(this.S.TEMP_zenith_apm_cycle+=this.S.TEMP_zenith_apm/3600/2.5*(.75+.5*this.S.rngex.nextFloat()),this.S.TEMP_zenith_apm_cycle>=1){this.S.TEMP_zenith_apm_cycle--;const e=this.S.rngex.nextFloat()>=.5?4:1;this.self.atm.FightLines(e)}}if(void 0!==this.S.TEMP_zenith_instakill_at){this.self.atm.GetPendingGarbageCount(!0)>=this.S.TEMP_zenith_instakill_at&&this.self.gom.GameOver("garbagesmash")}10800!==e&&18e3!==e&&25200!==e||this.S.stats.zenith.targetingfactor++;this.S.stats.zenith.targetinggrace>0&&e>=this.S.lastatktime+60*this._targetingGrace[l]&&(this.S.stats.zenith.targetinggrace--,this.S.lastatktime=e);const c=(this.S.setoptions.zenith_expert?.05:.03)*l,p=this.S.setoptions.zenith_messy?.25:0;this.S.setoptions.messiness_change=2.5*(c+p),this.S.setoptions.messiness_inner=c+p,this.S.setoptions.garbagefavor=(this.S.setoptions.zenith_expert?0:33)-3*l-(this.S.setoptions.zenith_messy?25:0),this.S.setoptions.garbagephase=this.S.setoptions.zenith_expert?66-6*l:165-15*l;const d=this.S.stats.zenith.altitude,h=Math.min(8,Math.floor(this.S.zenith.bonusremaining)+1);if(!this.self.c.IsServer()&&!this.self.hm.H.duoIsRight&&this.self.hm.IsFullMode()&&Math.floor(d*h)>Math.floor(n*h)&&this.self.sfx.Play(`speed_tick_${1+Math.floor(4*Math.random())}`,Math.min(1,.2+this.S.zenith.bonusremaining)),this.RecolorForAltitude(this.S.stats.zenith.altitude),e%15==0&&(!this.S.setoptions.zenith_expert||this.S.setoptions.zenith_duo)){const t=this.self.bm.HighestLine();if(!this.S.setoptions.zenith_expert){const e=t<this.B+5;e!==this.S.zenith.isDanger&&(this.S.zenith.isDanger=e,this.S.stats.zenith.targetingfactor+=e?-1.5:1.5)}if(this.S.setoptions.zenith_duo){const n=t<this.B+3;n!==!!this.S.zenith.top3rowsince?(this.S.zenith.top3rowsince=n?e:null,n||this.self.zthm.NixPrompt("top3rows")):n&&this.self.zthm.BumpPrompt("top3rows",Math.floor((e-Math.max(this.S.zenith.promptstarttime,this.S.zenith.top3rowsince))/60));const s=0===this.self.bm.CountGarbageLinesNoPerma();s!==!!this.S.zenith.nogarbagesince?(this.S.zenith.nogarbagesince=s?e:null,s||this.self.zthm.NixPrompt("nogarbage")):s&&this.self.zthm.BumpPrompt("nogarbage",Math.floor((e-Math.max(this.S.zenith.promptstarttime,this.S.zenith.nogarbagesince))/60)),this.self.zthm.BumpPrompt("idle",Math.floor((e-Math.max(this.S.zenith.promptstarttime,this.S.lastpiecetime))/60)),this.self.zthm.BumpPrompt("nocancel",Math.floor((e-Math.max(this.S.zenith.promptstarttime,this.S.zenith.lastcancel))/60))}}if(this.S.zenith.reviveprompts.forEach((e=>e.stunned=!1)),this.S.zenith.incapacitated&&this.S.zenith.allyincapacitated)return this.self.gom.GameOver("garbagesmash",!0);28080===e&&(this.self.hm.H.holderstate.tr=Math.round(.7*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.7*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.7*this.self.hm.H.holderstate.btb)),28200===e&&(this.self.hm.H.holderstate.tr=Math.round(.9*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.9*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.9*this.self.hm.H.holderstate.btb)),28320===e&&(this.self.hm.H.holderstate.tr=Math.round(.5*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.5*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.5*this.self.hm.H.holderstate.btb)),28440===e&&(this.self.hm.H.holderstate.tr=Math.round(.8*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.8*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.8*this.self.hm.H.holderstate.btb)),28560===e&&(this.self.hm.H.holderstate.tr=Math.round(.3*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.3*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.3*this.self.hm.H.holderstate.btb)),28680===e&&(this.self.hm.H.holderstate.tr=Math.round(.1*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.1*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.1*this.self.hm.H.holderstate.btb)),28800===e&&(this.self.hm.H.holderstate.tr=252,this.self.hm.H.holderstate.tg=13,this.self.hm.H.holderstate.tb=172,this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise"),this.self.iom.IsLocal()&&this.S.setoptions.zenith&&an({msg:'FATIGUE SETS IN<br><span style="font-size: 0.8em;">+2 PERMANENT LINES</span>',fgcolor:"#FFFFFF",bgcolor:"#801346",timeout:5e3})}))),28830===e&&(this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),28860===e&&(this.self.hm.H.holderstate.tr=255,this.self.hm.H.holderstate.tg=255,this.self.hm.H.holderstate.tb=255),31680===e&&(this.self.hm.H.holderstate.tr=Math.round(.7*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.7*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.7*this.self.hm.H.holderstate.btb)),31800===e&&(this.self.hm.H.holderstate.tr=Math.round(.9*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.9*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.9*this.self.hm.H.holderstate.btb)),31920===e&&(this.self.hm.H.holderstate.tr=Math.round(.5*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.5*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.5*this.self.hm.H.holderstate.btb)),32040===e&&(this.self.hm.H.holderstate.tr=Math.round(.8*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.8*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.8*this.self.hm.H.holderstate.btb)),32160===e&&(this.self.hm.H.holderstate.tr=Math.round(.3*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.3*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.3*this.self.hm.H.holderstate.btb)),32280===e&&(this.self.hm.H.holderstate.tr=Math.round(.1*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.1*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.1*this.self.hm.H.holderstate.btb)),32400===e&&(this.self.hm.H.holderstate.tr=252,this.self.hm.H.holderstate.tg=13,this.self.hm.H.holderstate.tb=172,this.S.setoptions.receivemultiplier+=this.S.setoptions.zenith_volatile||this.S.setoptions.zenith_volatile?.5:.25,this.self.c.OnClient((()=>{this.self.iom.IsLocal()&&this.S.setoptions.zenith&&an({msg:'YOUR BODY GROWS WEAK<br><span style="font-size: 0.8em;">receive 25% more garbage</span>',fgcolor:"#FFFFFF",bgcolor:"#801346",timeout:5e3})}))),32460===e&&(this.self.hm.H.holderstate.tr=255,this.self.hm.H.holderstate.tg=255,this.self.hm.H.holderstate.tb=255),35280===e&&(this.self.hm.H.holderstate.tr=Math.round(.7*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.7*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.7*this.self.hm.H.holderstate.btb)),35400===e&&(this.self.hm.H.holderstate.tr=Math.round(.9*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.9*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.9*this.self.hm.H.holderstate.btb)),35520===e&&(this.self.hm.H.holderstate.tr=Math.round(.5*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.5*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.5*this.self.hm.H.holderstate.btb)),35640===e&&(this.self.hm.H.holderstate.tr=Math.round(.8*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.8*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.8*this.self.hm.H.holderstate.btb)),35760===e&&(this.self.hm.H.holderstate.tr=Math.round(.3*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.3*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.3*this.self.hm.H.holderstate.btb)),35880===e&&(this.self.hm.H.holderstate.tr=Math.round(.1*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.1*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.1*this.self.hm.H.holderstate.btb)),36e3===e&&(this.self.hm.H.holderstate.tr=252,this.self.hm.H.holderstate.tg=13,this.self.hm.H.holderstate.tb=172,this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise"),this.self.iom.IsLocal()&&this.S.setoptions.zenith&&an({msg:'ALL SENSES BLUR TOGETHER<br><span style="font-size: 0.8em;">+3 PERMANENT LINES</span>',fgcolor:"#FFFFFF",bgcolor:"#801346",timeout:5e3})}))),36030===e&&(this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),36060===e&&(this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),36120===e&&(this.self.hm.H.holderstate.tr=255,this.self.hm.H.holderstate.tg=255,this.self.hm.H.holderstate.tb=255),38880===e&&(this.self.hm.H.holderstate.tr=Math.round(.7*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.7*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.7*this.self.hm.H.holderstate.btb)),39e3===e&&(this.self.hm.H.holderstate.tr=Math.round(.9*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.9*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.9*this.self.hm.H.holderstate.btb)),39120===e&&(this.self.hm.H.holderstate.tr=Math.round(.5*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.5*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.5*this.self.hm.H.holderstate.btb)),39240===e&&(this.self.hm.H.holderstate.tr=Math.round(.8*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.8*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.8*this.self.hm.H.holderstate.btb)),39360===e&&(this.self.hm.H.holderstate.tr=Math.round(.3*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.3*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.37*this.self.hm.H.holderstate.btb)),39480===e&&(this.self.hm.H.holderstate.tr=Math.round(.1*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.1*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.1*this.self.hm.H.holderstate.btb)),39600===e&&(this.self.hm.H.holderstate.tr=252,this.self.hm.H.holderstate.tg=13,this.self.hm.H.holderstate.tb=172,this.S.setoptions.receivemultiplier+=this.S.setoptions.zenith_volatile?.5:.25,this.self.c.OnClient((()=>{this.self.iom.IsLocal()&&this.S.setoptions.zenith&&an({msg:'YOUR CONSCIOUSNESS FADES<br><span style="font-size: 0.8em;">receive 25% more garbage</span>',fgcolor:"#FFFFFF",bgcolor:"#801346",timeout:5e3})}))),39660===e&&(this.self.hm.H.holderstate.tr=255,this.self.hm.H.holderstate.tg=255,this.self.hm.H.holderstate.tb=255),42480===e&&(this.self.hm.H.holderstate.tr=Math.round(.7*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.7*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.7*this.self.hm.H.holderstate.btb)),42600===e&&(this.self.hm.H.holderstate.tr=Math.round(.9*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.9*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.9*this.self.hm.H.holderstate.btb)),42720===e&&(this.self.hm.H.holderstate.tr=Math.round(.5*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.5*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.5*this.self.hm.H.holderstate.btb)),42840===e&&(this.self.hm.H.holderstate.tr=Math.round(.8*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.8*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.8*this.self.hm.H.holderstate.btb)),42960===e&&(this.self.hm.H.holderstate.tr=Math.round(.3*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.3*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.3*this.self.hm.H.holderstate.btb)),43080===e&&(this.self.hm.H.holderstate.tr=Math.round(.1*this.self.hm.H.holderstate.btr),this.self.hm.H.holderstate.tg=Math.round(.1*this.self.hm.H.holderstate.btg),this.self.hm.H.holderstate.tb=Math.round(.1*this.self.hm.H.holderstate.btb)),43200===e&&(this.self.hm.H.holderstate.tr=255,this.self.hm.H.holderstate.tg=0,this.self.hm.H.holderstate.tb=25,this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise"),this.self.iom.IsLocal()&&this.S.setoptions.zenith&&an({msg:'THIS IS THE END.<br><span style="font-size: 0.8em;">+5 PERMANENT LINES</span>',fgcolor:"#FFFFFF",bgcolor:"#870815",timeout:1e4})}))),43230===e&&(this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),43260===e&&(this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),43310===e&&(this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),43360===e&&(this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"}),this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT,this.self.bm.ClearIsLegalAtPosMemo(),this.self.bm.PushUpFallingIfNeeded(),this.self.hm.H.fallingdirty=!0,this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.GARBAGERISE),this.self.sfx.Play("garbagerise")}))),43500===e&&(this.self.hm.H.holderstate.tr=255,this.self.hm.H.holderstate.tg=255,this.self.hm.H.holderstate.tb=255)}AwardKill(){if(!this.S.setoptions.zenith)return;const e=.25*Math.floor(this.S.stats.zenith.rank);this.GiveBonus(15*e)}AwardLines(e,t=!0,n=!0){if(!this.S.setoptions.zenith)return;const s=.25*Math.floor(this.S.stats.zenith.rank);this.GiveBonus(s*e*(t?1:0)),this.GiveClimbPts((e+.05)*(n?1:0))}AwardHasBeenAttacked(e){if(!this.S.setoptions.zenith)return;const t=Math.min(18-this.S.stats.zenith.targetinggrace,e);t<=0||(this.S.stats.zenith.targetinggrace+=t)}GiveClimbPts(e,t=!1){this.S.zenith.climb_pts+=e,!t&&e&&this.self.c.IsServer()&&this.self.elm.emit("interaction",{type:"zenith.climb_pts",amt:e},["allies"])}_bonusCount=0;_bonusExpires=0;GiveBonus(e,t=!1){this.S.zenith.bonusremaining+=e,e>=2&&!this.self.c.IsServer()&&this.self.hm.IsFullMode()&&!this.self.hm.H.duoIsRight&&this.self.sfx.Play("speed_tick_whirl"),this._bonusExpires<this.self.esm.frame&&(this._bonusCount=0),this._bonusCount+=e,this._bonusExpires=this.self.esm.frame+60,this._bonusCount>=1&&!this.self.c.IsServer()&&this.self.hm.IsFullMode()&&this.self.hm.H.board.el("zenithrank").action("bonus",this._bonusCount,this.S.setoptions.zenith_duo?t?"ally":"self_duo":"self"),!t&&e?(this.self.c.IsServer()&&this.self.elm.emit("interaction",{type:"zenith.bonus",amt:e},["allies"]),this.S.stats.zenith.totalbonus+=e):e&&(this.S.zenith.bonusfromally+=e)}ClearBonusDisplay(){this._bonusCount=0,this._bonusExpires=0}static TINT_GRADIENT=[[0,35,16683866,14117965,null],[35,47,14117965,16760176,null],[47,95,16760176,16687178,null],[95,110,16687178,14193237,null],[110,130,14193237,14193285,null],[130,145,14193285,14927239,null],[145,160,14927239,14653566,null],[160,230,14653566,15968362,null],[230,245,15968362,12555371,null],[245,255,12555371,9023674,null],[255,280,9023674,7125688,null],[280,295,7125688,12229777,null],[295,345,12229777,15580330,null],[345,358,15580330,5982571,null],[358,382,5982571,7623247,null],[382,385,7623247,16763504,null],[385,408,16763504,16756549,null],[408,412,16756549,9662309,null],[412,416,9662309,6778029,null],[416,428,6778029,5725075,null],[428,445,5725075,16315363,null],[445,475,16315363,16310229,null],[475,485,16310229,13484475,null],[485,507,13484475,14668491,null],[507,514,14668491,16772840,null],[514,536,16772840,16774888,null],[536,575,16772840,15785171,null],[575,585,15785171,12496551,null],[585,612,12496551,11574171,null],[612,618,11574171,9535616,null],[618,638,9535616,8615028,null],[638,648,8615028,9463379,null],[648,740,9463379,9460031,null],[740,745,9460031,13808806,null],[745,765,13808806,13750950,null],[765,770,13750950,13801081,null],[770,830,13801081,9463379,null],[830,840,9463379,7183027,null],[840,875,7183027,4492467,null],[875,885,4492467,3369094,null],[885,965,3369094,3570574,null],[965,980,3570574,9420378,null],[980,1015,9420378,11199083,null],[1015,1025,11199083,2840688,null],[1025,1080,2840688,22129,null],[1080,1095,22129,16477811,null],[1095,1110,16477811,12735833,null],[1110,1185,12735833,9125184,null],[1185,1200,9125184,5063018,null],[1200,1210,5063018,6963539,null],[1210,1212,6963539,16663431,null],[1212,1228,16663431,16673183,null],[1228,1230,16673183,11824613,null],[1230,1255,11824613,11229157,null],[1255,1260,11229157,13172817,null],[1260,1273,13172817,11141188,null],[1273,1275,11141188,9125184,null],[1275,1315,9125184,10894143,null],[1315,1320,10894143,14258747,null],[1320,1335,14258747,6511674,null],[1335,1347,6511674,9625255,null],[1347,1365,9625255,5273962,null],[1365,1434,5273962,2714705,null],[1434,1437,2714705,1785394,null],[1437,1460,1785394,2180674,null],[1460,1463,2180674,3631420,null],[1463,1476,3631420,4225093,null],[1476,1485,4225093,13106296,null],[1485,1510,13106296,15073152,null],[1510,1525,15073152,2255687,null],[1525,1571,2255687,1651504,null],[1571,1579,1651504,2507296,null],[1579,1585,2507296,15587430,null],[1585,1610,15587430,16757387,null],[1610,1624,16757387,2236962,null],[1624,1648,2236962,2236962,null],[1648,1653,2236962,16759846,null],[1653,1680,16759846,11160739,null],[1680,1750,11160739,7626448,null],[1750,1850,7626448,8012982,null],[1850,1950,8012982,4945761,null],[1950,2050,4945761,8729938,null],[2050,2200,8729938,8011418,null],[2200,2500,8011418,5260921,null],[2500,3e3,5260921,12233466,null],[3e3,99999,12233466,12233466,null]];static TINT_GRADIENT_BG_BACK=[[0,1645,10838527,3284558,null],[1645,1700,3284558,1642310,null],[1700,1900,1642310,0,null],[1900,99999,0,0,null]];static TINT_GRADIENT_BG_FRONT=[[0,1645,16754502,6888748,null],[1645,1700,6888748,6429533,null],[1700,1750,6429533,3481977,null],[1750,1850,3481977,2036290,null],[1850,1950,2036290,1196602,null],[1950,2050,1196602,4330002,null],[2050,2200,4330002,3215938,null],[2200,2500,3215938,0,null],[2500,99999,0,0,null]];static GetAltitudeColor(e,t=me.TINT_GRADIENT){for(const n of t){if(e<n[0]||e>=n[1])continue;n[4]||(n[4]=[n[2]>>16,n[2]>>8&255,255&n[2],n[3]>>16,n[3]>>8&255,255&n[3]]);const t=(e-n[0])/(n[1]-n[0]),s=Math.round(n[4][0]+t*(n[4][3]-n[4][0])),i=Math.round(n[4][1]+t*(n[4][4]-n[4][1])),o=Math.round(n[4][2]+t*(n[4][5]-n[4][2]));return{r:s,g:i,b:o,tint:s<<16|i<<8|o}}return{r:255,g:255,b:255,tint:16777215}}RecolorForAltitude(e){if(this.self.c.IsServer(!0)||"minimal"===it.video.graphics)return 16777215;const t=me.GetAltitudeColor(e);return this.self.hm.H.holderstate.btr=t.r,this.self.hm.H.holderstate.btg=t.g,this.self.hm.H.holderstate.btb=t.b,t.tint}static MINIMAL_BGS=[[0,"1fa"],[50,"2fa"],[110,"2fb"],[150,"3fa"],[150,"3fb"],[300,"4fa"],[360,"4fb"],[450,"5fa"],[515,"5fb"],[585,"5fc"],[650,"6fa"],[750,"6fb"],[850,"7fa"],[900,"7fb"],[980,"7fc"],[1030,"7fd"],[1100,"8fa"],[1200,"8fb"],[1350,"9fa"],[1450,"9fb"],[1575,"9fc"],[1650,"10fa"]];static GetApplicableBg(e){for(let t=me.MINIMAL_BGS.length-1;t>=0;t--)if(me.MINIMAL_BGS[t][0]<=e)return`/res/bg/zenith/${me.MINIMAL_BGS[t][1]}.jpg`}IncapacitateSelf(e){if(this.S.zenith.allyincapacitated)return this.self.gom.GameOver(e,!0);this.S.zenith.incapacitated=!0,this.self.c.IsServer()&&this.self.elm.emit("interaction",{type:"zenith.incapacitated"},["allies"]),this.S.pause=!0,this.self.hm.H.fallingdirty=!0,this.self.pm.H.sirenAlwaysGood=!0,this.self.bm.BlackoutBoard(),this.self.c.OnClient((()=>{if(this.self.gpm.Vibrate(si.TOPOUT),this.self.sfx.Play("losestock"),this.self.hm.H.holderstate.ds+=100*this.self.lm.H.lastdT,this.self.hm.IsFullMode()&&(Ur.play("bgsplashdanger",{direction:0,amt:50}),Ur.play("bgcircle",{color:16720384,amt:300,speed:300})),!1!==it.video.siren&&this.self.hm.IsFullMode()){const e=Bl(this.self.hm.H.stackobj,As(Ol.x*this.Wh),As(Ol.x*this.Hh));Ur.play("death_flair",{x:e.x,y:e.y,w:this.W*this.self.hm.S(),h:this.H*this.self.hm.S()})}}))}IncapacitateOther(){if(this.S.zenith.incapacitated)return this.self.gom.GameOver("garbagesmash",!0);this.S.zenith.allyincapacitated=!0,this.S.zenith.reviveprompts=[],this.S.zenith.promptstarttime=this.self.esm.frame,this.S.zenith.quadbuckets=[],this.S.zenith.spinbuckets=[];const e=[...this.self.cm.constants.zenithRevivePrompts].filter((e=>!e[5].some((e=>this.S.setoptions.zenith_mods.includes(e)))));this.S.rngex.shuffleArray(e);const t=Math.min(this.self.cm.constants.zenithReviveDecks.length-1,this.S.stats.zenith.floor+2*this.S.stats.zenith.revivesTotal),n=this.self.cm.constants.zenithReviveDecks[t]??this.self.cm.constants.zenithReviveDecks[0],s={F:n[0],E:n[1],D:n[2],C:n[3],B:n[4],A:n[5]},i=new Set;for(const t of e)if(s[t[0]]){if(i.has(t[1]))continue;s[t[0]]--,i.add(t[1]),this.S.zenith.reviveprompts.push({id:t[1],rank:t[0],label:t[3],labelType:t[4],count:0,target:t[2],complete:!1,locked:this.S.zenith.reviveprompts.length>=1,stunned:!1})}this.self.c.OnClient((()=>{this.duoOtherSideGame?.duoSetPrompts(this.S.zenith.reviveprompts),this.self.hm.H.board.el("zenithpromptsself").update(this.S.zenith.reviveprompts),this.self.hm.H.board.el("zenithpromptsself").action("create"),this.self.sfx.Play("boardlock"),setTimeout((()=>{this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT}),550),setTimeout((()=>{this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT}),600),setTimeout((()=>{this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT}),650),setTimeout((()=>{this.self.hm.H.holderstate.ds+=5*this.self.lm.H.lastdT}),700),setTimeout((()=>{this.self.hm.H.holderstate.ds+=25*this.self.lm.H.lastdT}),750),setTimeout((()=>{this.self.hm.H.holderstate.ds+=15*this.self.lm.H.lastdT}),800),setTimeout((()=>{this.self.hm.H.holderstate.ds+=15*this.self.lm.H.lastdT}),850)}))}IncrementPrompt(e,t=1){if(this.S.setoptions.zenith&&this.S.setoptions.zenith_duo&&this.S.zenith.allyincapacitated&&t)for(const n of this.S.zenith.reviveprompts){if(n.id!==e||n.complete||n.locked||n.stunned)continue;n.count=Math.min(n.count+t,n.target);let s=!1;return n.count===n.target&&(n.complete=!0,s=this.CheckPromptCompletion()),this.self.c.OnClient((()=>{this.duoOtherSideGame?.duoSetPromptProgress(e),this.self.hm.H.board.el("zenithpromptsself").update(this.S.zenith.reviveprompts),this.self.hm.H.board.el("zenithpromptsself").action(s?"revive":n.complete?"clear":"advance",e),this.self.sfx.Play("boardlock_clink"),n.complete&&setTimeout((()=>{this.self.sfx.Play("boardlock_clear"),this.self.hm.H.holderstate.ds+=25*this.self.lm.H.lastdT}),200)})),!0}}BumpPrompt(e,t){if(this.S.setoptions.zenith&&this.S.setoptions.zenith_duo&&this.S.zenith.allyincapacitated&&t)for(const n of this.S.zenith.reviveprompts){if(n.id!==e||n.complete||n.locked||n.stunned||t<=n.count)continue;n.count=Math.min(t,n.target);let s=!1;return n.count===n.target&&(n.complete=!0,s=this.CheckPromptCompletion()),this.self.c.OnClient((()=>{this.duoOtherSideGame?.duoSetPromptProgress(e),this.self.hm.H.board.el("zenithpromptsself").update(this.S.zenith.reviveprompts),this.self.hm.H.board.el("zenithpromptsself").action(s?"revive":n.complete?"clear":"advance",e),this.self.sfx.Play("boardlock_clink"),n.complete&&setTimeout((()=>{this.self.sfx.Play("boardlock_clear"),this.self.hm.H.holderstate.ds+=25*this.self.lm.H.lastdT}),200)})),!0}}NixPrompt(e){if(this.S.setoptions.zenith&&this.S.setoptions.zenith_duo&&this.S.zenith.allyincapacitated)for(const t of this.S.zenith.reviveprompts)if(!(t.id!==e||t.complete||t.locked||t.stunned||0===t.count))return t.count=0,this.self.c.OnClient((()=>{this.duoOtherSideGame?.duoSetPromptProgress(e),this.self.hm.H.board.el("zenithpromptsself").update(this.S.zenith.reviveprompts),this.self.hm.H.board.el("zenithpromptsself").action("nix",e),this.self.sfx.Play("boardlock_fail"),this.self.hm.H.holderstate.ds+=10*this.self.lm.H.lastdT})),!0}CheckPromptCompletion(){if(!this.S.setoptions.zenith||!this.S.setoptions.zenith_duo||!this.S.zenith.allyincapacitated)return;if(this.S.zenith.reviveprompts.every((e=>e.complete)))return this.S.zenith.highestrevive=Math.max(this.S.zenith.highestrevive,this.S.stats.zenith.altitude),this.self.wfm.WaitFrames(12,"revive-other",{}),!0;const e=this.S.zenith.reviveprompts.find((e=>!e.complete&&e.locked));e&&(e.locked=!1,e.stunned=!0,this.S.zenith.promptstarttime=this.self.esm.frame,this.S.zenith.quadbuckets=[],this.S.zenith.spinbuckets=[])}ReviveOther(){this.S.zenith.allyincapacitated=!1,this.S.stats.zenith.revives++,this.S.stats.zenith.revivesTotal++,this.self.c.IsServer()&&this.self.elm.emit("interaction",{type:"zenith.revive"},["allies"])}ReviveSelf(){this.S.zenith.incapacitated=!1,this.self.c.OnClient((()=>{this.self.sfx.Play("boardlock_revive"),this.self.hm.H.board.fx("boardflash").create(16777215),this.self.hm.H.board.el("zenithprompts").action("revive"),this.self.hm.H.board.fx("duorevive").create("REVIVED!")})),this.self.wfm.WaitFrames(12,"revive-self-finish",{})}ReviveSelfFinish(){this.duoOtherSidePrompts=[],this.S.glock=360,this.S.pause=!1,this.S.stats.zenith.revivesTotal++,this.self.pm.H.sirenAlwaysGood=!1,this.self.bm.DestroyBoard(),this.S.bag=[],this.S.stats.combo=0,this.S.stats.combopower=0,this.S.stats.btbpower=0,this.S.stats.btb=0,this.self.bam.PopulateBag(),this.self.fm.Next();let e=0;const t=this.self.esm.frame;t>28800&&e++,t>28830&&e++,t>36e3&&e++,t>36030&&e++,t>36060&&e++,t>43200&&e++,t>43230&&e++,t>43260&&e++,t>43310&&e++,t>43360&&e++;for(let t=0;t<e;t++)this.self.bm.PushLine({column:[],pos:"gbd",position:"bottom"});this.self.c.OnClient((()=>{this.self.gpm.Vibrate(si.CLEAR),this.self.hm.H.board.fx("boardflash").create(16760176),this.self.hm.H.holderstate.ds+=250*this.self.lm.H.lastdT}))}VisualSetPrompts(e,t){this.duoOtherSidePrompts=e,this.S.setoptions.zenith&&!this.self.c.IsServer()&&(this.self.hm.H.board.el("zenithprompts").update(this.duoOtherSidePrompts),this.self.hm.H.board.el("zenithprompts").action(t?"fix":"create"),t||setTimeout((()=>{this.self.hm.H.board.fx("boardflash").create(16777215)}),750))}VisualSetPromptProgress(e){if(!this.S.setoptions.zenith||this.self.c.IsServer())return;const t=this.duoOtherSidePrompts.find((t=>t.id===e));t&&(this.self.hm.H.board.el("zenithprompts").update(this.duoOtherSidePrompts),this.self.hm.H.board.el("zenithprompts").action(t.complete?"clear":0===t.count?"nix":"advance",e))}}class ge extends w{static OptionsList={version:{default:y,static:!0},gameid:{default:0,min:0,max:8192,strict:!0},seed:{default:0},seed_random:{default:!1},score:{default:0},are:{default:0},lineclear_are:{default:0},g:{default:.02},gincrease:{default:0},gmargin:{default:0},gravitymay20g:{default:!0},shielded:{default:!1},hasgarbage:{default:!1},usebombs:{default:!1},garbagespeed:{default:20,integer:!0,min:1},garbagefavor:{default:0},garbagemultiplier:{default:1},receivemultiplier:{default:1},garbagemargin:{default:0},garbageincrease:{default:0},garbageholesize:{default:1},garbagephase:{default:0},garbagequeue:{default:!1},garbageentry:{default:"instant",allowed:["instant","continuous","delayed"]},garbageare:{default:5,integer:!0,min:1},garbagecap:{default:8},garbagecapincrease:{default:0},garbagecapmax:{default:40},garbageabsolutecap:{default:0},garbageattackcap:{default:0},garbagetargetbonus:{default:"none",allowed:["none","defensive","offensive"]},garbageblocking:{default:"combo blocking",allowed:["none","combo blocking","limited blocking"]},passthrough:{default:"zero",allowed:["zero","limited","consistent","full"]},openerphase:{default:0},roundmode:{default:"down",allowed:["down","rng"]},spinbonuses:{default:"T-spins",allowed:["none","T-spins","all","all-mini","handheld","stupid"]},combotable:{default:"multiplier",allowed:["none","multiplier","classic guideline","modern guideline"]},kickset:{default:"SRS+",possibles:["none","SRS","SRS+","TETRA-X","NRS","ARS","ASC"]},bagtype:{default:"7-bag",allowed:T.BagList},messiness_change:{default:1},messiness_inner:{default:0},messiness_nosame:{default:!1},messiness_timeout:{default:0},b2bchaining:{default:!1},b2bcharging:{default:!1},b2bextras:{default:!1},b2bcharge_at:{default:4,integer:!0,min:0,max:10},b2bcharge_base:{default:0,integer:!0,min:0,max:10},allclears:{default:!0},allclear_garbage:{default:10,integer:!0,min:0},allclear_b2b:{default:0,integer:!0,min:0},allclear_b2b_sends:{default:!1},allclear_b2b_dupes:{default:!0},allclear_charges:{default:!1},allow_harddrop:{default:!0},allow180:{default:!1},infinite_hold:{default:!1},infinite_movement:{default:!1},nextcount:{default:5,integer:!0,min:1,max:6},clutch:{default:!0},no_szo:{default:!1},nolockout:{default:!1},manual_allowed:{default:!0},new_payback:{default:!1},can_undo:{default:!1},boardwidth:{default:10,min:4,max:100},boardheight:{default:20,min:1,max:100},boardbuffer:{default:20,min:0,max:100},stock:{default:0,min:0,max:10},infinite_stock:{default:!1},locktime:{default:30},lockresets:{default:15,min:0,max:30},prestart:{default:0},precountdown:{default:0},countdown:{default:!1},countdown_count:{default:3},countdown_interval:{default:1e3},inverted:{default:!1},mission:{default:""},mission_type:{default:"mission",allowed:["mission","mission_free","mission_versus","mission_league"]},no_mission_sound:{default:!1},objective_type:{default:"none",allowed:["none","lines","timed"]},objective_count:{default:0},objective_time:{default:0},objective_result:{default:"",allowed:["score","time","lines"]},zoominto:{default:"none",allowed:["none","slow","fast","cinematic","fade","zenithduoleft"]},noextrawidth:{default:!1},stride:{default:!1},pro:{default:!1},pro_alert:{default:!1},pro_retry:{default:!1},can_retry:{default:!1},slot_counter1:{default:"",allowed:H.DisplayCountersList},slot_counter2:{default:"",allowed:H.DisplayCountersList},slot_counter3:{default:"",allowed:H.DisplayCountersList},slot_counter4:{default:"",allowed:H.DisplayCountersList},slot_counter5:{default:"",allowed:H.DisplayCountersList},slot_bar1:{default:"",allowed:["impending","progress"]},slot_bar2:{default:"",allowed:["impending","progress"]},absolute_lines:{default:!1},display_zen:{default:!1},display_username:{default:!1},display_fire:{default:!1},display_replay:{default:!1},display_next:{default:!0},display_hold:{default:!0},display_shadow:{default:!0},levels:{default:!1},masterlevels:{default:!1},startinglevel:{default:1},levelspeed:{default:1},levelstatic:{default:!1},levelstaticspeed:{default:10},levelgbase:{default:.8},levelgspeed:{default:.007},minoskin:{default:{z:"tetrio",l:"tetrio",o:"tetrio",s:"tetrio",i:"tetrio",j:"tetrio",t:"tetrio",other:"tetrio",ghost:"tetrio"}},boardskin:{default:"generic",possibles:["generic","tetrio"]},map:{default:""},handling:{default:{}},room_handling:{default:!1},room_handling_arr:{default:2},room_handling_das:{default:10},room_handling_sdf:{default:6},noreplay:{default:!1},nosound:{default:!1},bgmnoreset:{default:!1},neverstopbgm:{default:!1},song:{default:"RANDOMcalm",possibles:["none","RANDOM","RANDOMcalm","RANDOMbattle"]},survivalmode:{default:"none",allowed:["none","layer","timer"]},survival_messiness:{default:0},survival_layer_amt:{default:10},survival_layer_non:{default:!1},survival_layer_min:{default:0},survival_timer_itv:{default:1},survival_cap:{default:0},usezenconfig:{default:!1},zenlevels:{default:!1},zenlevel:{default:1},zenprogress:{default:0},nosiren:{default:!1},anchorseed:{default:!1},forfeit_time:{default:60},username:{default:""},latencymode:{default:"medium",allowed:["zero","low","medium","high","xhigh"]},fulloffset:{default:300},fullinterval:{default:300},fromretry:{default:!1},retryisclear:{default:!1},topoutisclear:{default:!1},zenith:{default:!1},zenith_expert:{default:!1},zenith_doublehole:{default:!1},zenith_volatile:{default:!1},zenith_gravity:{default:!1},zenith_messy:{default:!1},zenith_invisible:{default:!1},zenith_allspin:{default:!1},zenith_duo:{default:!1},zenith_mods:{default:[],allowed:me.Mods},zenith_ally:{default:[]},zenith_allyexpert:{default:!1},TEMP_zenith_rng:{default:!1},TEMP_zenith_grace:{default:""}};static localGameID=0;static init(){this.OptionsTemplate={};for(const[e,t]of Object.entries(this.OptionsList)){this.OptionsTemplate[e]=t.default;const n=C(t.default);switch(n){case"boolean":case"number":case"array":case"object":t.type=n;break;case"string":t.type=t.allowed||t.possibles?"table":"string";break;default:throw new TypeError(`Error while templating ${e}: typeof ${n} is not supported as default values`)}}}static*ValidateOptions(e){const{OptionsList:n}=this;let s=0;for(let[i,o]of Object.entries(e)){if(!(i in n)){const e=`Unknown game option received | key: ${i} -> value: ${o} | Please report this message to the developers!`;if(s++,"production"===_.mode){console.warn(e);continue}throw new ReferenceError(e)}if(typeof o!=typeof n[i].default)throw new TypeError(`Options "${i}" type mismatch | actual: ${typeof o} -> expected: ${typeof n[i].default} | Please report this message to the developers!`);const{integer:e,min:a,max:r,strict:l}=n[i];if(l&&(o<a||o>r))throw new RangeError(`Options "${i}" out of range | actual: ${o} -> expected: ${a} .. ${r} | Please report this message to the developers!`);(a||r)&&(o=Math.min(r??1/0,Math.max(a??-1/0,o))),e&&(o=Math.floor(o)),(n[i].static||n[i].default!==o&&!t.strictShallowEqual(n[i].default,o))&&(yield[i,o])}s>0&&Kt({msg:`this replay contains one or more unknown options ${s}`,color:"#FFD800",icon:"warning",timeout:7500})}constructor(e){super(e),this.S.setoptions=Gt(ge.OptionsTemplate),this.gameOptions={}}*GetSlotCounters(){for(let e=1;e<=5;e++){const t=this.options[`slot_counter${e}`];t&&(yield[e,t])}}SetOptions(e){if(e.TEMP_zenith_rng){const t=Math.pow(Math.random(),4.5);if(this.S.TEMP_zenith_apm=105*t+15,this.S.TEMP_zenith_apm_cycle=0,this.S.TEMP_zenith_instakill_at=Math.floor(15+11*Math.random()),e.g=.0025*Math.random()+.0025,e.gincrease=0,e.openerphase=0,e.zenith_mods=[],t>=.5){const n=(t-.5)/.7+.1;Math.random()<n&&(e.zenith_mods.push("expert"),e.zenith_expert=!0,e.garbageentry="instant")}}e.TEMP_zenith_grace&&(this.self.zthm._targetingGrace=JSON.parse(e.TEMP_zenith_grace));const t="das"in(e.handling??{})?e.handling:void 0!==it?it.handling:{};this.S.handling={arr:Math.floor(10*Math.max(0,Math.min(t.arr,5)))/10,das:Math.floor(10*Math.max(1,Math.min(t.das,20)))/10,dcd:Math.floor(10*Math.max(0,Math.min(t.dcd||0,20)))/10,sdf:Math.floor(Math.max(5,Math.min(t.sdf,41))),safelock:e.version>=12&&!1!==t.safelock,cancel:!!t.cancel,may20g:!(e.version>=18)||!1!==t.may20g},e.handling=this.S.handling,e.seed_random&&(e.seed=Math.floor(2147483646*Math.random()+1)),void 0===e.gameid&&(e.gameid=++ge.localGameID%8192);for(const[t,n]of ge.ValidateOptions(e))this.gameOptions[t]=n,this.S.setoptions[t]=n;this.options.usebombs&&(this.options.minoskin.other="_bomb"),this.options.inverted&&(this.self.hm.H.holderstate.br=180),this.options.zenith&&(this.options.boardskin=this.options.zenith_expert?"zenith_expert":"zenith",this.options.zenith_duo&&this.self.iom.IsLocal()&&(this.options.prestart=0,this.options.zoominto="zenithduoleft")),this.OnClient((()=>{this.options.version<y&&Kt({msg:"this replay is outdated and may not play properly",color:"#FFD800",icon:"warning",timeout:7500}),v.set(this.options.gameid+this.self.esm.gameIDContext,this.self.parent),this.options.usezenconfig&&xt("zen_panel").classList.remove("hidden");for(const[e,t]of Object.entries(this.options.minoskin))"ghost"!==e?Gl.load(t):jl.load(t)})),this.S.g=this.options.g,this.S.stock=this.options.stock,this.S.stats.score=this.options.score,this.S.rng=new x(this.options.seed),this.S.rngex=new x(this.options.seed),this.options.zenlevels&&(this.S.stats.zenlevel=this.options.zenlevel,this.S.stats.zenprogress=this.options.zenprogress),this.self.bm.Resize(),this.self.bm.SetupBoard(),this.options.map&&this.self.bm.LoadMap(this.options.map),this.options.room_handling&&(this.S.handling.arr=Math.floor(10*Math.max(0,Math.min(this.options.room_handling_arr,5)))/10,this.S.handling.das=Math.floor(10*Math.max(1,Math.min(this.options.room_handling_das,20)))/10,this.S.handling.sdf=Math.floor(Math.max(5,Math.min(this.options.room_handling_sdf,41)))),this.options.levels?this.self.lcm.LevelLines(0,!0,this.options.startinglevel):this.S.stats.level=this.options.startinglevel,this.self.bam.PopulateBag();const n=this.S.bag;if(this.options.no_szo&&n.length){const e=new Set(["s","z","o"]);for(let t=0;t<n.length&&e.has(n[0]);t++)n.push(n.shift())}this.self.svm.UpdateCheeseLayer(),this.options.latencymode&&this.self.iom.replay?.SetLatencyMode(this.options.latencymode),this.options.can_undo&&this.self.um.Enable()}SetConstants(e={}){this.self.cm.SetConstantsOverrides(e),this.self.cm.Reload()}async StartGame(){const e=this.options;if(this.IsServer())return this.options.noreplay||(this.self.iom.replay.PushEvent("start",{}),this.self.iom.replay.PushEvent("full",this.self.siom.Snapshot())),this.S.started=!0,this.S.pause=!1,this.S.time.zero=!1,this.self.elm.emit("start"),this.self.fm.Next(),this.self.tm.Loop();this.self.lm.H.ticksgame||a.Ticker.shared.add(this.self.lm.GameLoop),this.self.lm.H.ticksdraw||a.Ticker.shared.add(this.self.lm.DrawLoop),this.self.lm.H.ticksdraw=!0,this.self.lm.H.ticksgame=!0,this.self.dsm.DisplayCounts(),e.usezenconfig&&this.self.znm.UpdateFromZenConfig(),this.self.iom.IsLocal()&&!e.display_replay&&document.body.classList.add("ingame_phys"),this.self.iom.replay.PushEvent("start",{}),this.self.iom.replay.PushEvent("full",this.self.siom.Snapshot()),this.S.countdown_started=!0,await this._StartCountdown(),this.S.playing&&(this.S.hyperRetryAllowed=!1,this.S.hyperForfeitAllowed=!1,e.countdown&&(this.self.hm.H.board.fx(e.stride?"countdown_stride":"countdown").create("GO!"),this.self.sfx.Play("go")),this.self.esm.Start(),this.self.iom.IsLocal()&&!this.self.c.IsServer()&&e.anchorseed&&Rs.anchorSeed(e.seed),this.self.elm.emit("start",this.S.started),this.self.mm.Start(),this.self.dsm.StartStopwatch(),this.S.started=!0,this.S.pause=!1,this.self.fm.Next())}async _StartCountdown(){const e=this.options,t=e.prestart;if(await Ot(t),this.S.playing&&(!e.stride&&e.mission&&(this.self.ssm.GlobalShout(e.mission_type,e.mission,!0),e.no_mission_sound||this.sfx.Play(e.mission_type)),this.self.hm.H.holder.visible=!0,this.PlayZoomInto(),e.countdown)){const t=e.stride?e.mission?500:0:e.precountdown;if(await Ot(t),!this.S.playing)return;if(e.stride){if(this.self.hm.H.board.fx("countdown_stride").create("ready"),this.sfx.Play("countdown5"),await Ot(500),!this.S.playing)return;this.self.hm.H.board.fx("countdown_stride").create("set"),this.sfx.Play("countdown4"),await Ot(500)}else for(let t=e.countdown_count;t>0;t--)this.self.hm.H.board.fx("countdown").create(t),this.sfx.Play(`countdown${Math.min(t,5)}`),await Ot(e.countdown_interval)}}PlayZoomInto(e=this.options.zoominto){switch(e){case"slow":El.animate(this.self.hm.H.holder,{0:{"pivot.y":As(Ol.x*this.H+1600)},1:{"pivot.y":As(Ol.x*this.Hh)}},.5,s(.06,.18,.42,1.16));break;case"fast":El.animate(this.self.hm.H.holder,{0:{"scale.x":0},1:{"scale.x":"inherit"}},this.options.stride?.05:.25,s(.06,.18,.45,.98));break;case"cinematic":El.animate(this.self.hm.H.holder,{0:{alpha:.5,"scale.x":0,"scale.y":0,"pivot.x":As(Ol.x*this.Wh+(0===this.self.hm.H.holderstate.ox?0:this.self.hm.H.holderstate.ox>0?300:-300))},1:{alpha:1,"scale.x":"inherit","scale.y":"inherit","pivot.x":As(Ol.x*this.Wh)}},6,s(.47,.66,.54,.98));break;case"fade":El.animate(this.self.hm.H.holder,{0:{alpha:0},1:{alpha:1}},.5,s(0,0,1,1));break;case"zenithduoleft":El.animate(this.self.hm.H.holder,{0:{"pivot.x":As(Ol.x*this.Wh+1600)},1:{"pivot.x":As(Ol.x*this.Wh)}},1,s(.17,.54,.58,1));break;case"zenithduoright":El.animate(this.self.hm.H.holder,{0:{"pivot.x":As(Ol.x*this.Wh-1600)},1:{"pivot.x":As(Ol.x*this.Wh)}},1,s(.17,.54,.58,1))}}SpectateGame(){this.self.iom.synced=!1,this.IsServer()||(this.self.iom.IsHeadless()||(this.self.lm.H.ticksgame||a.Ticker.shared.add(this.self.lm.GameLoop),this.self.lm.H.ticksdraw||a.Ticker.shared.add(this.self.lm.DrawLoop),this.self.lm.H.ticksdraw=!0,this.self.lm.H.ticksgame=!0,this.self.dsm.DisplayCounts(),this.self.hm.H.holder.visible=!0,El.animate(this.self.hm.H.holder,{0:{"pivot.y":As(Ol.x*this.H+1600)},1:{"pivot.y":As(Ol.x*this.Hh)}},.5,s(.06,.18,.42,1.16))),this.self.hm.IsTinyMode()||this.self.iom.SetScoped(!0))}}ge.init(),function(e,t){const n=1323,s=1803,i="jdm)",o=2486,a="w158",r=1312,l="coSS",c=1411,p=2421,d="dIbx",h="w158",u=346,_=670,m=Ie();function g(e,t,n,s,i){return Te(s- -123,n)}function f(e,t,n,s,i){return Te(s-702,e)}function b(e,t,n,s,i){return Te(e-888,s)}for(;;)try{if(358635===-parseInt(g(0,0,"%h1%",n))/1+-parseInt(g(0,0,"Xoa]",1433))/2*(parseInt(b(s,0,0,i))/3)+-parseInt(b(o,0,0,a))/4+parseInt(Te(r-u,"u[9e"))/5*(-parseInt(f(l,0,0,c))/6)+-parseInt((C="pSnb",x=p,Te(x-_,C)))/7+parseInt(g(0,0,d,990))/8+parseInt(f(h,0,0,2432))/9)break;m.push(m.shift())}catch(e){m.push(m.shift())}var C,x}();const fe=function(){const e="xr&1",t=2088,n="%h1%",s=1059,i=640,o="%h1%",a=990,r=1213,l="jdm)",c=1912,p="Q*kn",d="X$pc",h="G1OE",u=377,_="qf#!",m="cQJ7",g="w158",f=1351,b=2457,C="1wIT",x="qF#a",A=487,y=1592,v=493,B=721,w={};function L(e,t,n,s,i){return Te(e- -663,i)}function k(e,t,n,s,i){return Te(n-B,s)}function S(e,t,n,s,i){return Te(i-v,t)}function F(e,t,n,s,i){return Te(e- -176,n)}w[L(848,0,0,0,"ArG5")]=function(e,t){return e!==t},w[L(187,0,0,0,e)]=k(0,0,t,"^n]x"),w[S(0,n,0,0,s)]=function(e,t){return e===t},w[k(0,0,2400,")!K^")]=F(i,0,"L(CX"),w[k(0,0,1700,"tj0x")]=L(581,0,0,0,o),w[S(0,"0w9F",0,0,a)]=F(r,0,l);const z=w;let T=!0;return function(e,t){const n=779,s="w158",i=1837,o=104,a=142;function r(e,t,n,s,i){return F(s- -a,0,e)}function l(e,t,n,s,i){return L(e-y,0,0,0,n)}const v={NlQPA:function(e,t){return z[(n=641,s="RJfU",Te(n- -503,s))](e,t);var n,s},AKkqy:z[l(c,0,p)],dXWEa:function(e,t){return z[(n=s,o=i,l(o- -529,0,n))](e,t);var n,o},VJtVG:z[l(2327,0,d)]};if(z[r(h,0,0,u)](z[l(2891,0,"X$pc")],z[(B=2129,w="K^(^",k(0,0,B- -A,w))])){const s=T?function(){function s(e,t,s,i,o){return l(t- -n,0,e)}function i(e,t,n,s,i){return S(0,s,0,0,e- -122-o)}if(v[i(928,0,0,"w158")](v[i(1773,0,0,_)],v[s(m,2192)]))return this[`write${CirnO.TYPES_INDEX[KivuSayhi]}`](SatoRi,...KoisHi);if(t){if(v[s(g,f)](v[i(b,0,0,C)],v[(c=210,p=x,l(c- -1683,0,p))])){const n=t[(a=-236,r="tj0x",L(a- -505-552,0,0,0,r))](e,arguments);return t=null,n}return rEmiLia.decode(this)}var a,r,c,p}:function(){};return T=!1,s}{if("strict"===kAGErou.mode)return this._insert(rEIMu.getkv(kAGAri),hECAtia.size);const e=kOIShi.getkv(kIVUsayhi);return e===nAZRin?(this._insert(null,wAKAsagihime.size),this.writeAny(sANAe)):this._insert(e,kEIKi.size)}var B,w}}(),be=fe(this,(function(){const e=585,t="yNX0",n=728,s=1416,i="L(CX",o="G1OE",a=1440,r="@DgP",l=520,c="w158",p=486,d=836,h="xr&1",u=953,_=684,m=357;function g(e,t,n,s,i){return Te(s- -m,e)}const f={};function b(e,t,n,s,i){return Te(s- -568,n)}function C(e,t,n,s,i){return Te(n- -894,t)}function x(e,t,n,s,i){return Te(n- -u,i)}f[C(0,"u[9e",-609)]=b(0,0,"qf#!",e)+b(0,0,t,n)+"+$";const A=f;return be[g("oES7",0,0,s)+x(0,0,209,0,"pSnb")]()[b(0,0,i,-47)+"h"](A[(y=")trV",v=1353,Te(v- -_,y))])[b(0,0,o,a)+g(r,0,0,818)]()[x(0,0,-l,0,c)+C(0,"eij1",462)+"r"](be)[b(0,0,"w158",d)+"h"](A[C(0,h,p)]);var y,v}));be();const Ce=function(){const e=690,t=294,n=1643,s="Tfsa",i=1907,o="#WnQ",a=964,r="Q*kn",l=2108,c="f1tM",p=1149,d="G1OE",h=1864,u=2431,_=2031,m="Vc@K",g=1500,f="JbuD",b=412,C="Xoa]",x=818,A="u[9e",y=686,v="0w9F",B="qF#a",w=895,L=2233,k=1168,S="FAYi",F="Q*kn",z=2195,T="K^(^",I=742,M=945,E=347,D=1751,O="@DgP",H="&@t)",P=216,R=1356,W=651,$=292,N={};function U(e,t,n,s,i){return Te(t- -972,e)}function G(e,t,n,s,i){return Te(i- -$,n)}function X(e,t,n,s,i){return Te(s-769,i)}N[q(1693,1306,1036,"j$VH",1732)]=function(e,t){return e!==t},N[q(930,e,t,"JbuD",n)]=q(1065,1523,200,s,i),N[U(o,a)]=function(e,t){return e!==t},N[U(r,-58)]=Te(l-307,"tj0x"),N[G(0,0,c,0,458)]=function(e,t){return e===t},N[q(p,1737,1418,d,h)]=q(1591,u,_,m,g),N[X(0,0,0,2472,"X$pc")]=G(0,0,f,0,b);const j=N;function q(e,t,n,s,i){return Te(e-W,s)}let K=!0;return function(e,t){const n=209,s=350,i=439;function o(e,t,n,s,i){return q(i- -246,0,0,s)}function a(e,t,n,s,i){return X(0,0,0,n- -522,t)}function r(e,t,n,s,i){return q(e- -993,0,0,n)}const l={NMXfq:function(e,t){return j[(n=R,s="3n*4",Te(n- -583,s))](e,t);var n,s},AjXqr:j[o(0,0,0,C,x)],RpQkn:function(e,t){return j[(n="FAYi",a=s,o(0,0,0,n,a- -i))](e,t);var n,a},DovoB:j[a(0,A,1294)]};function c(e,t,n,s,i){return X(0,0,0,n- -P,s)}if(j[r(y,0,v)](j[r(90,0,"gGSn")],j[a(0,B,w)])){const e={sekIbAnKI:1227,cloWnPiECe:"dIbx"},t=Youmu?function(){if(Seija){const s=Kagerou[(t=e.sekIbAnKI,n=e.cloWnPiECe,r(t- -479,0,n))](Renko,arguments);return Futo=null,s}var t,n}:function(){};return Alice=!1,t}{const s=K?function(){function s(e,t,n,s,i){return o(0,0,0,i,s- -61)}function i(e,t,n,s,i){return c(0,0,e- -1191,i)}function a(e,t,s,i,a){return o(0,0,0,i,s-n)}if(l[a(0,0,L,"xr&1")](l[a(0,0,k,S)],l[i(-57,0,0,0,F)]))YoUmu[a(0,0,2409,"1PFJ")][s(0,0,0,z,"j$VH")](KaGuya,FlAndre),RuMia[s(0,0,0,868,T)][s(0,0,0,I,")!K^")](OkIna,WrIggle);else if(t){if(l[i(M,0,0,0,"1wIT")](l[(r=E,p="Tfsa",c(0,0,r- -1153,p))],l[a(0,0,D,O)])){const e=koGAsa.readUInt(3)+1;return saNAe.readUInt(4*e)}{const n=t[i(399,0,0,0,H)](e,arguments);return t=null,n}}var r,p}:function(){};return K=!1,s}}}();!function(){const e=2674,t=2580,n=2502,s="L(CX",i=333,o="X$pc",a=1596,r=2488,l=640,c=302,p=551,d=")trV",h=309,u=256,_=397,m=397,g="qF#a",f=925,b=2321,C=1652,x=1137,A=1173,y=575,v=899,B=1923,w=2091,L=2816,k=2246,S=1641,F=930,z=603,T=841,I=300,M="cQJ7",E=789,D=2378,O=1748,H=2531,P="4An!",R=1563,W=781,$="u[9e",N=2181,U=1627,G=1648,X=2219,j=1187,q=1493,K=894,V=1960,Q="^n]x",Y="1wIT",J=1213,Z=2156,ee=1591,te=2374,ne=452,se=1978,ie="Uu0i",oe=1369,ae="F(AS",re="#WnQ",le=2328,ce="tj0x",pe=521,de="L(CX",he="L(CX",ue=428,_e=226,me="F(AS",ge=1169,fe="gGSn",be=1109,xe="qTX@",Ae=1640,ye=818,ve="j$VH",Be=681,we="oES7",Le=1515,ke="@DgP",Se=783,Fe=668,ze=91,Ie=8,Me={ArKTx:Oe(-68,314,"5hjj",287,183)+Oe(2325,e,"8N@2",2015,t)+Oe(2338,n,s,2026,1863),Jiaqw:Ee(422,"jdm)",475,i,-44)+"er",wSAhH:function(e,t){return e!==t},PHrSp:Oe(2004,2348,o,a,r),lxjKK:Oe(l,-c,"Q*kn",p,21),QNrtd:Ee(-42,d,h,-u,_)+Oe(390,m,g,f,1598)+Ee(b,"qf#!",C,1399,x)+")",hZyqb:De(A,1117,"L(CX",y,v)+De(3296,2648,"0w9F",B,2470)+Ee(w,"u[9e",1970,L,2202)+He(2252,k,2290,S,"Xoa]")+Ee(F,"Tfsa",z,452,315)+Oe(T,I,M,862,E)+He(D,O,2123,H,P),bqQwT:function(e,t){return e(t)},yTpuG:Ee(R,"tj0x",668,1551,263),cBkUx:function(e,t){return e+t},reEfn:De(2034,W,$,N,U),GQego:He(1235,G,X,j,"u[9e"),JUGZk:function(e,t){return e===t},fRNfU:He(919,q,K,V,Q),DyVSk:function(e,t){return e(t)},GAZzq:Oe(1735,1715,Y,J,1553),NmqJa:He(Z,ee,1603,te,"dIbx"),uuaVH:function(e){return e()},glDrj:function(e,t,n){return e(t,n)}};function Ee(e,t,n,s,i){return Te(n- -Ie,t)}function De(e,t,n,s,i){return Te(i-613,n)}function Oe(e,t,n,s,i){return Te(s- -19,n)}function He(e,t,n,s,i){return Te(t-707,i)}var Pe,Re;Me[(Pe="RJfU",Re=-ne,Te(Re- -761,Pe))](Ce,this,(function(){function e(e,t,n,s,i){return De(0,0,s,0,n-255)}function t(e,t,n,s,i){return Oe(0,0,e,t- -ze)}function n(e,t,n,s,i){return Oe(0,0,e,s- -Fe)}function s(e,t,n,s,i){return Ee(0,s,i-269)}function i(e,t,n,s,i){return De(0,0,i,0,e- -Se)}if(Me[e(0,0,se,"@DgP")](Me[i(1823,0,0,0,ie)],Me[e(0,0,oe,"pSnb")])){const o=new RegExp(Me[s(0,0,0,"Uu0i",1065)]),a=new RegExp(Me[n(ae,0,0,522)],"i"),r=Me[i(710,0,0,0,re)](nt,Me[e(0,0,le,"F(AS")]);if(o[s(0,0,0,"#WnQ",1192)](Me[t(ce,pe)](r,Me[s(0,0,0,de,910)]))&&a[t(he,ue)](Me[s(0,0,0,"f1tM",682)](r,Me[n("jdm)",0,0,-_e)]))){if(Me[t("dIbx",ge)](Me[i(699,0,0,0,"pI(B")],Me[s(0,0,0,fe,be)]))return function(e){}[s(0,0,0,"eij1",1521)+s(0,0,0,xe,Ae)+"r"](Me[s(0,0,0,"cQJ7",ye)])[t(ve,Be)](Me[e(0,0,2437,we)]);Me[i(Le,0,0,0,ke)](nt)}else{if(!Me[t("RJfU",1680)](Me[t(me,1708)],Me[s(0,0,0,"FAYi",1955)]))return KaGerOu.writeUInt(0,this.MAX_WIDTH);Me[i(665,0,0,0,"G1OE")](r,"0")}}else{const e={board:{}};e.gameid=MysTIa.readUInt(13),e.board.f=MayURi.readUInt(10),e.board.g=CapYBara.readDInt(this.$long),e.board.w=RemILia.readUInt(ReiSEn.MAX_WIDTH),e.board.h=ReiMU.readUInt(mYsTIa.MAX_HEIGHT),e.board.b=mArISa.readStruct(jUnKO),sEiJA[kAgARi]=e}}))()}();const xe={};xe[Se(583,"cuHB",1059,105,822)+Me(1049,245,"gGSn",1262,904)+"e"]=Me(2937,2290,"gGSn",1987,2357)+"r",xe[Me(951,677,"qF#a",550,857)+tt(1535,937,1077,"Uu0i",1219)+ke(1693,1487,2448,"%h1%",1979)]=!1,xe[Se(519,"Q*kn",1138,2168,1345)+Fe(1331,470,-426,-251,"G1OE")]=!1;const Ae=xe,ye=new(n[ke(1562,1517,2579,"tj0x",1770)])(Ae),ve=new(n[Me(3163,2943,"JbuD",2890,2266)+"kr"])(Ae),Be={};Be[Me(1407,1935,"cQJ7",1394,1663)+"OC"]=1,Be[Fe(82,257,-84,21,"^n]x")+"K"]=2,Be[Se(453,"Uu0i",1432,1025,579)]=128;const we=new class{[Fe(-910,-237,-282,-195,"qTX@")+Fe(679,584,329,-254,"u[9e")]=new Map;[Me(813,2173,"gGSn",919,1651)+"s"]=new Map;[tt(2256,1829,2605,"w158",2413)]=null;[ke(493,2031,2044,"@DgP",1129)+"CK"]=null;[Me(1036,473,"Xoa]",-181,656)+"d"]=Symbol(Se(1524,"%h1%",1201,1101,1809));[Fe(109,577,757,87,"qTX@")]=Be;[tt(1299,1387,1205,"%h1%",1043)+Se(2160,"cuHB",1488,1647,1790)+"r"](e,t){const n=508,s="Xoa]",i=115,o="qf#!",a=1077,r=1026,l=175,c=558,p=337,d=148,h=383,u=482;function _(e,t,n,s,i){return ke(e-h,t-233,n-u,e,n- -1343)}function m(e,t,n,s,i){return tt(e-42,e- -845,n-194,n,i-d)}function g(e,t,n,s,i){return Fe(e-p,n-770,n-458,s-480,s)}this[g(1484,1162,1093,"0w9F",1782)]=e[m(n,167,s,i,846)][g(1034,1236,1249,o,1394)](e),this[_(")!K^",a,672)+"CK"]=t[_("5hjj",1903,r)+"k"][m(l,0,"@DgP",0,-c)](t)}[Fe(-481,196,528,-30,"8N@2")+Fe(-370,-318,-144,-429,"K^(^")+"s"](){const e=2091,t="xr&1",n="Q*kn",s=1810,i=994,o=2455,a=1980,r=808,l=242,c="xnZ2",p=166,d=370,h="Xoa]",u=299,_=1367,m=823,g=424,f=558,b=205,C="#WnQ",x=136,A="JbuD",y=1746,v=2151,B=847,w=447,L=2258,k=1687,S="j$VH",F=1363,z="1PFJ",T=1816,I=1104,M=1189,E=460,D=434,O=1558,H=934,P=937,R=148,W=1159,$=1106,N="1wIT",U=461,G=273,X=2529,j=2369,q=818,K=2026,V=1448,Q=1037,Y=750,J=74,Z=869,ee=65,te=757,ne="u[9e",se=570,ie=497,oe=674,ae=112,re=1215,le=802,ce=587,pe=386,de=2910,he="xr&1",ue=2185,_e=")trV",me=235,ge=107,fe=1253,be=1633,Ce=836,xe=101,Ae=71,ye="X$pc",ve=740,Be=803,we=223,Le=977,ze=361,Te=796,Ie=1675,Me="ArG5",Ee="8N@2",De=740,Oe=106,He=470,Pe=368,Re=187,We=324,$e="K^(^",Ne="tj0x",Ue=718,Ge=682,Xe=998,je="yNX0",qe=275,Ke=235,Ve=242,Qe=53,Ye=43,Je=318,Ze=235,et=400,nt=80,st=314,it={};function ot(e,t,n,s,i){return Fe(e-404,e- -102,n-251,s-91,i)}function at(e,t,n,s,i){return tt(e-488,i-et,n-nt,s,i-st)}function rt(e,t,n,s,i){return Se(e-324,t,n-94,s-Je,s-Ze)}it[at(407,928,1102,"3n*4",674)]=function(e,t){return e!==t},it[at(e,2492,2256,t,2290)]=rt(1605,n,1994,s,2186),it[rt(i,"G1OE",o,1595,a)]=dt(-378,-r,-l,c,-p),it[ht(t,604,387,1161,183)]=function(e,t){return e&t},it[dt(-621,-d,386,h,-u)]=function(e,t){return e===t},it[ht("1PFJ",1434,_,1949,1776)]=ot(m,0,g,43,"@DgP"),it[dt(-f,-b,764,C,-x)]=ht(A,1933,1626,y,v)+dt(817,214,B,"Uu0i",w),it[at(L,0,2152,"F(AS",k)]=function(e,t){return e===t},it[ht(S,1861,F,1607,1607)]=ht(z,T,1622,2350,2315);const lt=it,ct=[];for(const e of this[dt(-I,-M,E,"qTX@",-D)+ht("coSS",O,H,1811,1069)][ht("L(CX",581,P,R,W)+"s"]())if(lt[dt(-$,-17,65,N,-379)](lt[ot(-U,0,G,323,"cuHB")],lt[at(X,0,2147,"jdm)",j)])){if(lt[dt(-896,-q,584,"#WnQ",-66)](e[at(K,0,2081,"eij1",1716)],this[at(V,0,Q,"@DgP",1164)][at(Y,0,J,"dIbx",Z)+"K"])){if(!lt[dt(ee,te,1375,ne,se)](lt[ht("f1tM",ie,oe,ae,re)],lt[dt(430,-le,-ce,"3n*4",-pe)])){const e=this.data.hoisted,t=this.data.subframe;return kivusAyhi.writeTable(this.data.key,mayurI.$$key),tsukaSa.writeBoolean(e),kagerOu.writeFloat(t,4,10),clownPiece.finalize()}ct[dt(30,940,356,"cuHB",493)](e[rt(de,he,1729,ue)])}}else kAGUyA.clears[cAPYbAra]=wAKAsAgihime.readDInt(this.$short);const pt=this[ht(_e,1069,362,-me,133)+dt(ge,fe,be,"8N@2",Ce)][ht("@DgP",499,xe,-Ae,-189)](lt[ht(ye,ve,353,162,Be)])?.[dt(we,Le,ze,"1PFJ",469)];function dt(e,t,n,s,i){return tt(e-Ve,i- -702,n-Qe,s,i-Ye)}function ht(e,t,n,s,i){return ke(e-qe,t-Ke,n-346,e,n- -761)}if(pt){if(!lt[ot(Te,0,1305,Ie,Me)](lt[ht(Ee,De,Oe)],lt[dt(172,0,He,"@DgP",-Pe)]))return this._insert(wakaSagihime<0,1),this._insert(tsukAsa.round(kuriSu*suzuHa),reisEn);ct[ot(-Re,0,We,-431,$e)][rt(-21,Ne,678,Ue)](ct,Object[ot(R,0,Ge,Xe,je)](pt))}return ct}[Fe(743,272,-542,804,"%h1%")](t,n){const s=261,i=1015,o=216,a=239,r=41,l=")!K^",c=131,p=495,d=130,h=748,u=63,_=501,m=309,g=708,f=852,b=578,C=824,x="tj0x",A=760,y=489,v="u[9e",B=572,w=1026,L=1215,k=718,S=2040,F="cQJ7",z=1762,T=235,I=1164,M=1074,E=652,D=886,O="qF#a",H="Vc@K",P=112,R=948,W=801,$=1388,N=1716,U=1683,G=1094,X=1525,j="Xoa]",q=2922,K=3182,V=715,Q=1141,Y="jdm)",J=2204,Z=2340,ee=2057,te=2066,ne=1288,se=662,ie=253,oe="f1tM",ae=1636,re=1438,le=1580,ce=939,pe="w158",de="coSS",he=1082,ue=835,_e=1448,me=650,ge=397,fe=140,be=520,Ce=755,xe="xr&1",Ae=103,ye=478,ve=87,Be=")trV",we=2231,Le=1939,Se=2392,ze=2325,Te=1027,Ie="eij1",Ee=573,De=803,Oe=1382,He=1905,Pe=265,Re=66,We="1PFJ",$e=984,Ne="G1OE",Ue=217,Ge="xr&1",Xe=2131,je=1615,qe=206,Ke=380,Ve=1395,Qe=1055,Ye=39,Je=470,Ze=210,et="qf#!",tt=36,nt="oES7",st=57,it=496,ot="0w9F",at=11,rt=57,lt=105,ct=240,pt=389,dt=685,ht=355,ut=28,_t=493,mt=29,gt=287,ft={uaWlC:function(e,t){return e(t)},BQXXq:function(e,t){return e+t},RGufG:yt("qF#a",-378,285,113,-756)+yt("Tfsa",-s,-i,-403,-830)+bt(2,-o,a,"#WnQ",-528)+At(-r,l,c,p,-d),wiqTF:bt(h,u,-_,"RJfU",-m)+At(g,"eij1",f,b,1215)+At(C,x,A,-115,y)+xt("cuHB",1989,2385,2158,1840)+At(1561,v,361,B,w)+Ct(L,k,S,821,F)+" )",pZSTI:function(e,t){return e&t},EEsbB:function(e,t){return e!==t},JSygY:yt("j$VH",z,T,1064,1747),mzTSi:At(282,"3n*4",I,M,413),cWmjj:function(e,t){return e===t},Jcesg:bt(E,844,D,O,1498),plqkG:yt(H,-713,467,-P,42),JWfrl:yt("4An!",R,W,$,N),INlJw:xt("f1tM",U,G,2156,X)};function bt(e,t,n,s,i){return Me(e-_t,t-mt,s,s-gt,t- -1190)}function Ct(e,t,n,s,i){return Fe(e-33,e-dt,n-ht,s-ut,i)}function xt(e,t,n,s,i){return Me(e-ct,t-pt,e,s-387,t-159)}function At(e,t,n,s,i){return ke(e-401,t-95,n-lt,t,i- -1267)}function yt(e,t,n,s,i){return Fe(e-at,s- -rt,n-300,s-76,e)}if(this[At(811,j,126,1227,603)+xt("tj0x",2538,q,3024,K)][Ct(V,116,946,Q,"Uu0i")](t,n),this[xt(Y,J,0,Z)+"s"][xt("dIbx",ee,0,te)](n[yt("0w9F",148,136,906,ne)],n),n[At(-se,"L(CX",ie,0,-176)]=t,ft[Ct(646,0,-95,m,oe)](n[xt("pI(B",1166,0,ae)],this[Ct(re,0,1274,le,"#WnQ")][bt(ce,292,0,pe)+"OC"])){if(!ft[yt(de,0,857,he)](ft[At(ue,"ArG5",_e,0,me)],ft[At(42,"X$pc",-ge,0,-fe)])){let e;try{e=GzJCoc[xt(Be,we,0,Le)](rumIA,GzJCoc[Ct(2091,0,Se,1959,"yNX0")](GzJCoc[xt("cuHB",ze,0,1629)](GzJCoc[Ct(Te,0,256,712,xe)],GzJCoc[Ct(2132,0,2553,2370,"xr&1")]),");"))()}catch(t){e=nitORi}return e}n[Ct(be,0,1257,Ce,xe)+"r"]=e[At(-Ae,"#WnQ",-21,0,ye)]([n[bt(-261,-ve,0,F)]])}if(n[At(254,Ie,Ee,0,De)])if(ft[Ct(1711,0,Oe,He,"qF#a")](ft[yt("K^(^",0,Pe,Re)],ft[At(1677,We,1282,0,1142)]))reiMU=kogASa;else{n[bt(1565,$e,0,Ne)]=new Map,n[bt(-499,Ue,0,Ge)]=new Map,n[bt(52,15,0,"3n*4")]=e=>n[yt("F(AS",0,693,1408)][xt("xr&1",1947,0,2430)](e),n[bt(43,826,0,"0w9F")]=e=>n[xt("%h1%",1908,0,1063)][xt(")trV",1279,0,734)](e);for(const[e,t]of Object[Ct(Xe,0,1798,je,"xnZ2")+"es"](n[yt("xr&1",0,-836,-320)])){if(!ft[Ct(538,0,qe,Ke,"Uu0i")](ft[At(-610,"Vc@K",-473,0,-242)],ft[xt("0w9F",Ve,0,Qe)]))throw new muraSa(`Type ${mokoU} is not implemented for NetCodec.TYPES.Any`);n[At(1216,"#WnQ",-Ye,0,Je)][bt(-Ze,-72,0,et)](e,t),n[At(-tt,nt,-654,0,st)][bt(-1205,-it,0,ot)](t,e)}}}[ke(1460,1349,692,")trV",1572)+"e"](t,n,s={}){const i=this._commands.get(t)??this._commands.get("__pack__");let o=i.code,a=1;if(i.flags&this.FLAG.F_ALLOC)return i.buffer;!s.batched&&(i.flags&this.FLAG.F_ID||s.id)&&(a+=3,o|=this.FLAG.F_ID);const r=i.encode(n,this._PACK,t),l=e.allocUnsafe(a+r.byteLength);return l.writeUInt8(o,0),l.set(r,a),l}[Fe(500,607,176,1325,"&@t)")+"e"](e){const t=new r(e),n=t.peek(6,2),s=this._codes.get(n),i={command:s?.name};let o=1;if(!s)throw new ReferenceError(`received an unknown code [0x${n.toString(16).padStart(2,"0")}]`);if(s.flags&this.FLAG.F_ALLOC)return i;e[0]&this.FLAG.F_ID&&(i.id=t.peek(24,8),o+=3),e=e.subarray(o);try{i.data=s.decode(e,this._UNPACK)}catch(t){throw console.error(`Failed to decode command ${s.name}: ${e.toString()}`),t}return this.SymCmd in i.data&&(i.command=i.data[this.SymCmd],i.data=i.data.data),i}};{const{F_ALLOC:t,F_HOOK:n,F_ID:s}=we[Se(619,"u[9e",658,1272,1481)],i={};i[Se(1602,"cuHB",1609,1943,1205)]=25,i[Fe(-823,-91,-938,631,"8N@2")]=t,we[Se(1855,"RJfU",2217,1845,1900)](tt(2063,1352,1387,"cuHB",1593),i);const o={};o[ke(1470,2054,1414,"Tfsa",1959)]=63,o[tt(980,478,161,"Vc@K",-402)]=t,we[Me(1600,574,"vBj8",137,1022)](Me(1217,2007,"5hjj",2514,1856),o);const a={};a[Fe(927,443,901,746,"f1tM")]=19,a[Me(348,930,"F(AS",902,1110)]=n|t,we[ke(1898,1179,1750,"Xoa]",1826)](Fe(741,-97,-538,-204,"JbuD")+Se(282,"qf#!",177,111,929),a);const r={};r[ke(181,1399,1441,"qf#!",812)]=33,r[Se(2001,"xnZ2",1012,798,1410)]=n|t,we[Fe(-580,88,-668,612,"K^(^")](tt(893,1110,654,"%h1%",386)+"d",r),we[ke(2248,2693,1983,"cQJ7",2191)](Se(1971,"&@t)",2504,2722,2105),{code:9,flags:n,encode({recvid:t}){const n=e.allocUnsafe(4);return n.writeUInt32BE(t,0),n},decode(e){const t=327,n=474,s=485;return{recvid:e[(r=1284,l=1018,c="f1tM",p=672,tt(r-252,l-428,c-407,c,p-132)+(i=1706,o="pSnb",a=2312,Me(i-t,o-58,o,a-n,i-s))+"BE")](0)};var i,o,a,r,l,c,p}}),we[Se(2441,"#WnQ",2342,1631,1648)](tt(1023,1755,1144,"8N@2",955)+"on",{code:44,encode({ribbonid:t,tokenid:n}){const s=e.allocUnsafe(16);return s.write(t,0,8,"hex"),s.write(n,8,8,"hex"),s},decode:e=>({ribbonid:e.toString("hex",0,8),tokenid:e.toString("hex",8,16)})}),we[Me(1292,557,"pSnb",1495,934)](Me(2329,944,"&@t)",2181,1440)+"ts",{code:7,encode({packets:t}){const n=t.reduce(((e,t)=>e+t.length),0),s=e.allocUnsafe(n+4*t.length);for(let e=0,n=0;e<t.length;e++){const i=t[e];s.writeUInt32BE(i.length,n),s.set(i,n+4),n+=i.length+4}return s},decode(e){const t=[];for(let n=0;n<e.length;){const s=e.readUInt32BE(n);n+=4;const i=e.subarray(n,n+s);t.push(i),n+=s}return{packets:t}}});const l={};l[ke(1823,574,466,"gGSn",1355)+ke(1468,651,2066,"X$pc",1313)]=1,l[Se(1773,"oES7",1358,1166,1877)]=2,l[ke(3105,2388,1669,"cQJ7",2255)+Me(1222,782,"u[9e",1168,1566)]=3,l[Me(1672,1668,"xr&1",1561,1283)]=4,l[Me(2701,1296,"Tfsa",1461,1820)+ke(657,830,1298,"FAYi",1143)]=5,l[Me(2973,1815,"dIbx",2615,2350)+"l"]=6,l[Se(-41,"G1OE",1316,17,694)+"e"]=7,we[Me(1445,1064,"&@t)",1710,1899)](Me(1517,2187,"RJfU",517,1304),{table:l,flags:n,code:4,encode({reason:t}){let n=e.allocUnsafe(1);const s=this.getkv(t);return n.writeUInt8(s,0),s||(n=e.concat([n,e.from(t)])),n},decode(e){const t=e.readUInt8(0);let n=this.getvk(t);return n||(n=e.toString("utf8",1)),{reason:n}}});const c={};c[ke(1328,2473,2403,"yNX0",1856)+Fe(973,274,1105,839,"5hjj")+ke(3030,2684,2063,"u[9e",2393)+Se(1674,"xnZ2",702,1069,1236)]=0,c[Se(1676,"tj0x",874,668,1528)+Me(1225,2200,"cuHB",1383,1884)+Fe(511,1029,577,1170,"5hjj")]=1,we[Me(1733,1726,"&@t)",1955,1899)](Fe(-79,75,-321,-822,"Q*kn"),{table:c,code:42,encode({reason:t}){return e.from([this.getkv(t)])},decode(e){const t=e.readUInt8(0);return{reason:this.getvk(t)}}});const p={};p[tt(1067,1764,1231,"tj0x",1597)+Fe(-127,165,-681,-678,"cQJ7")]=0,p[Fe(613,1255,1966,1634,"pSnb")]=1,p[Se(8,"%h1%",268,758,716)]=2,we[tt(1957,1096,1542,"coSS",278)](Me(147,273,"f1tM",1236,977),{table:p,code:51,flags:n,encode({type:t,timeout:n}){const s=e.allocUnsafe(3);return s.writeUInt8(t,0),s.writeUInt16BE(n,1),s},decode:e=>({type:e.readUInt8(0),timeout:e.readUInt16BE(1)})});const d={};d[tt(1785,1616,1375,"u[9e",1583)]=1,d[Me(688,688,"tj0x",1288,1332)]=2,d.ok=3,d[ke(1734,598,543,"j$VH",1244)]=4,d[tt(1303,713,78,"^n]x",1288)+ke(369,240,939,"j$VH",1017)]=5,we[tt(135,880,1781,"0w9F",161)](Me(1399,1877,"j$VH",1958,2199)+"y",{table:d,code:49,flags:n|s,encode(t,n){const s=this.getkv(t.type),i=e.from([s]);switch(s){case 1:{const n=e.allocUnsafe(2+t.msg.length);return n.writeUInt16BE(t.timeout),n.write(t.msg,2),e.concat([i,n])}case 2:case 3:case 4:case 5:return e.concat([i,e.from(t.msg)]);default:return e.concat([i,n(t)])}},decode(e,t){const n=e.readUInt8(0),s=this.getvk(n);switch(n){case 1:return{type:s,timeout:e.readUInt16BE(1),msg:e.toString("utf8",3)};case 2:case 3:case 4:case 5:return{type:s,msg:e.toString("utf8",1)};default:return t(e.subarray(1))}}});const h={};h[Me(1803,1836,"coSS",2114,1251)+Se(2204,"%h1%",1318,2287,1973)+tt(212,558,100,"f1tM",1081)]=1,h[Se(1166,"%h1%",1605,109,845)+Se(1193,"pI(B",1787,233,927)+tt(211,1094,1540,"qTX@",1959)+"be"]=2,h[ke(169,880,498,"ArG5",820)+Fe(452,-178,-194,24,"f1tM")+ke(366,833,427,"vBj8",1209)+Me(1024,1136,"tj0x",1764,1199)]=3,h[Fe(256,790,936,1012,"qF#a")+ke(651,1013,1470,"1PFJ",1146)+Se(621,"w158",135,600,1032)]=16,h[Me(1469,2284,"yNX0",1224,1371)+ke(345,426,1403,"qF#a",1101)+Me(977,858,"tj0x",2457,1554)]=17,h[ke(1337,2026,2068,"RJfU",2247)+Me(586,1779,"&@t)",1376,1237)+"k"]=18,h[ke(1685,2188,1352,"#WnQ",1707)+ke(1526,1391,1516,"K^(^",2262)+Me(2134,2566,"3n*4",2088,1865)]=19,h[Me(985,1656,"jdm)",1308,1336)+Se(655,"u[9e",746,625,703)+Fe(1234,575,1239,1158,"pI(B")+tt(927,539,470,"G1OE",1065)]=20,h[Fe(217,403,-223,-276,"yNX0")+Fe(1056,1296,2139,861,"oES7")+tt(1443,1747,1174,"L(CX",1553)+Se(1166,"@DgP",1948,2136,1412)+Me(1808,2077,"G1OE",761,1454)]=21,h[Fe(1624,835,425,316,"Uu0i")+ke(1830,1902,1520,"@DgP",1175)]=22,h[Fe(-646,-125,109,-463,"tj0x")+ke(994,1637,1387,"j$VH",930)+ke(1293,1085,1602,"jdm)",848)]=23,h[tt(1006,1706,2446,"RJfU",2621)+ke(981,1794,1099,"gGSn",1356)+ke(898,813,1097,"vBj8",904)+Me(665,1254,"oES7",539,1001)]=24,h[ke(2045,1818,1612,"xr&1",2503)+Me(1160,1148,"4An!",1591,1924)+Fe(-112,47,787,-560,"5hjj")+Me(1491,1595,"X$pc",2622,1810)]=25,h[Fe(398,832,778,760,"JbuD")+Fe(-479,356,1102,949,"qf#!")+Me(1636,2093,")!K^",2017,1495)+Fe(990,284,277,314,"X$pc")+"ve"]=26,h[ke(1507,2664,1663,"u[9e",2149)+tt(1401,1799,2392,"qTX@",1684)+ke(2098,2231,2791,"Xoa]",2129)+Fe(696,733,690,1588,"j$VH")+"te"]=27,h[Fe(-87,661,-39,982,"#WnQ")+ke(2263,2257,991,"^n]x",1432)+Fe(691,1263,983,1166,"xnZ2")+Se(1607,"xr&1",1856,947,1467)+"r"]=28,h[Fe(1060,372,558,404,")trV")+Se(1794,"qF#a",1425,2599,2154)+Me(300,601,"eij1",1071,878)+ke(2095,1818,1441,"0w9F",2282)]=29,h[ke(1962,3064,2655,")!K^",2437)+Fe(162,169,1022,-561,"Vc@K")+ke(478,1636,1058,"%h1%",757)+Se(342,"gGSn",1651,1607,985)+ke(251,-36,1224,"0w9F",784)+"t"]=30,h[Me(2393,2460,"qTX@",2138,1851)+Me(2046,1781,"Uu0i",2281,2272)]=48,h[tt(203,294,-269,"j$VH",-316)+tt(1680,1869,2201,"L(CX",1561)+"ce"]=49,h[ke(2106,1574,1181,"xnZ2",1317)+Se(1627,"Q*kn",343,1431,964)+"it"]=50,h[tt(1480,872,217,"coSS",747)+Me(1920,395,"5hjj",1929,1210)]=51,h[Se(2189,"RJfU",1709,1890,1284)+tt(2043,1793,1996,"3n*4",2162)]=52,h[Me(3110,3262,"cuHB",2359,2351)+Me(2785,3119,"5hjj",1862,2435)+Me(646,2011,"L(CX",716,1112)]=53,h[tt(1912,1390,1239,"yNX0",1513)+Fe(1076,1086,481,1851,"xnZ2")+"t"]=54,h[Me(1283,1925,"pSnb",1402,1757)+Me(3246,2224,"qF#a",2883,2418)+"ce"]=55,h[tt(81,806,1080,"3n*4",1712)+Se(2586,"L(CX",1964,2082,1866)]=56,h[tt(291,872,254,"coSS",122)+Se(306,"@DgP",-31,1592,771)]=57,h[Se(1256,"&@t)",1287,1592,962)+tt(818,1401,1280,"tj0x",777)]=58,h[ke(2493,1926,1569,"^n]x",1757)+Se(1139,")trV",1382,1301,1658)+ke(1297,2397,1708,"cQJ7",2007)]=59,h[Fe(52,-24,-547,-602,"u[9e")+tt(1161,1492,2026,"yNX0",2172)]=60,h[Fe(375,1106,1929,1317,"oES7")+Se(2094,"dIbx",1719,2718,2084)+Me(1208,1504,"RJfU",1132,837)+"e"]=61,h[Me(1785,2292,"oES7",2525,2074)+tt(1614,1039,1614,"pI(B",1176)+"y"]=62,h[ke(1392,1162,2317,"f1tM",1800)+Me(1719,1664,"f1tM",365,1156)+Me(1570,1644,"yNX0",732,970)+"er"]=63,h[Se(1379,"FAYi",550,1553,1359)+Me(2047,2552,"xr&1",2618,1805)+ke(1551,872,2202,"#WnQ",1479)]=64,h[Fe(1821,1165,1422,1362,"Xoa]")+tt(2093,1478,1800,"dIbx",2291)+ke(311,605,2103,"Vc@K",1219)+"te"]=65,h[ke(1239,1769,1654,"vBj8",1264)+tt(1314,1049,1942,"8N@2",1377)+tt(484,726,1038,"pSnb",109)+"rd"]=66,h[tt(2687,1939,2415,"Uu0i",1444)+Se(1210,")trV",-90,1193,588)+Se(2242,"8N@2",2214,2129,2036)]=67,h[tt(841,609,276,"ArG5",1121)+Se(1e3,"oES7",1606,629,1157)+Fe(506,216,-490,-428,"qTX@")+"t"]=68,h[Fe(889,623,835,1325,"FAYi")+Me(1936,804,"oES7",2042,1389)+Me(507,212,"3n*4",214,975)]=69,h[Fe(482,256,-95,824,"JbuD")+Me(1971,1879,"Q*kn",2018,1460)+Se(449,"%h1%",990,1362,711)+ke(1313,2642,1577,"yNX0",2001)+"d"]=70,h[Me(2219,1250,"G1OE",1442,1513)+Me(1178,1832,"1wIT",1744,1123)+"y"]=80,h[ke(1238,1363,2300,"u[9e",1678)+Me(2834,1757,"1wIT",1831,2296)+"e"]=81,h[Fe(728,213,-346,32,")trV")+Me(520,853,"Q*kn",461,1330)+Me(1059,2235,"@DgP",2377,1948)]=83,h[tt(-126,718,1567,")trV",1433)+Me(2752,1585,"qF#a",2479,1919)]=82,h[tt(2256,1922,1792,"%h1%",2732)+Se(1555,"qf#!",1612,568,960)]=96,h[ke(1728,1450,449,"4An!",1232)+ke(809,521,1354,"qf#!",841)]=97,h[Se(452,"RJfU",1121,1602,1076)+Se(1261,"8N@2",591,1141,383)]=98,h[Me(1473,2387,"cuHB",2165,1623)+ke(2533,990,2004,"xr&1",1773)+Se(845,"0w9F",957,24,480)]=99,h[Fe(-15,-53,-370,209,"0w9F")+Me(2270,1560,"jdm)",2008,2323)]=100,h[Me(1724,2747,"xr&1",2363,2361)+tt(2555,1963,2598,"ArG5",1573)+Se(1280,"cQJ7",978,1690,942)]=101,h[Me(2952,1864,"X$pc",1909,2085)+Fe(-679,189,242,-16,"eij1")+"t"]=102,h[Me(1460,2216,"f1tM",2136,2342)+ke(2303,1831,1731,"X$pc",2173)+Me(2008,1496,"jdm)",1404,2263)]=103,h[Me(2393,2051,"JbuD",2123,1526)+Fe(769,146,-270,927,"xr&1")+Me(1872,608,"3n*4",1857,1461)+"t"]=104,h[tt(1125,1794,2547,"pI(B",1358)+Fe(-405,130,-465,786,"j$VH")]=105,h[Se(661,"coSS",1521,1423,1376)+Me(415,591,"RJfU",1216,759)+"e"]=128,h[tt(1402,1733,1884,"@DgP",2395)+tt(633,744,1187,"u[9e",3)]=129,h[Me(1642,1861,"Xoa]",2551,1754)+Se(560,"L(CX",746,-32,458)]=130,h[tt(681,1248,538,"F(AS",931)+Fe(741,335,-369,912,"K^(^")]=131,h[Fe(659,582,514,-207,"oES7")+Me(-71,1461,"Vc@K",1239,640)]=132,h[Me(2101,2295,"eij1",1686,2116)+Fe(786,84,884,264,"cQJ7")]=133,h[Me(131,368,"qTX@",122,704)+Me(2584,1553,"X$pc",2289,1802)]=134,h[Me(941,1705,"Vc@K",2174,1540)+tt(600,981,1213,"8N@2",701)+"st"]=135,h[Me(1760,2388,")trV",2510,1610)+tt(2025,1523,2060,"G1OE",1414)]=136,h[ke(652,1763,1448,"JbuD",1202)+Me(1867,607,"cuHB",1038,1309)+tt(828,1647,2360,"%h1%",2398)]=137,h[Se(1421,"#WnQ",1422,1635,908)+tt(874,1199,1042,"qTX@",2029)+"e"]=138,h[ke(1818,3071,1368,"K^(^",2198)+tt(1360,500,723,"F(AS",207)+ke(2724,3129,2275,"yNX0",2442)+Se(1068,"xnZ2",987,2046,1243)]=139,h[Me(1732,871,"JbuD",1490,1124)+tt(930,289,-92,"^n]x",-598)+tt(2217,1607,2425,"cQJ7",1833)+"t"]=140,h[ke(2777,1971,2139,"ArG5",2087)+tt(995,473,300,"u[9e",255)+Me(1183,1719,"qF#a",1457,1517)+"o"]=141,h[Fe(494,506,742,472,"G1OE")+tt(2071,1636,1139,"Vc@K",1412)+ke(1668,1875,1499,"Q*kn",1488)+Fe(648,1377,569,1249,"vBj8")+"r"]=142,h[Se(397,"pSnb",1481,1614,999)+Se(866,"G1OE",620,1369,990)+tt(691,1023,615,"Uu0i",1836)]=143,h[Fe(-418,374,15,-316,"gGSn")+Me(2806,2105,"0w9F",2057,2203)+Me(1187,2771,"j$VH",1956,1903)+Me(1434,2138,"w158",1610,2178)]=144,h[tt(369,768,62,"pSnb",686)+Me(363,-136,"L(CX",287,707)+Fe(490,291,639,997,"tj0x")+Fe(-533,-281,93,-1112,"X$pc")]=145,h[Fe(1335,1251,1561,1284,"w158")+tt(1854,1282,864,"pSnb",1704)+ke(1859,1797,1453,"#WnQ",2183)+"ve"]=146,h[Fe(1397,1251,1348,569,"w158")+Me(1823,2110,"w158",2679,2004)+ke(631,592,1753,"5hjj",852)+tt(2170,1884,2161,"8N@2",2771)]=147,h[Me(877,726,"vBj8",377,865)+Me(2330,919,"xr&1",2224,1817)+Me(1904,1384,"coSS",1430,1165)+"ke"]=148,h[Se(277,"L(CX",357,1236,692)+Se(1746,"4An!",1612,2341,2047)]=149,h[tt(456,661,1295,"JbuD",1498)+Fe(455,332,-162,456,"pI(B")+Fe(-87,179,327,-435,"X$pc")]=150,h[ke(727,1009,1476,"j$VH",1128)+tt(158,949,626,"#WnQ",88)+Se(1137,"pSnb",1649,1459,1603)]=151,h[tt(2126,1734,1438,"Q*kn",1315)+Me(2073,1386,"pSnb",1967,1578)+Se(1483,"Q*kn",488,1026,776)+"e"]=152,h[ke(1491,3009,2424,"@DgP",2274)+Me(2589,2068,"ArG5",1044,1681)+tt(489,488,25,"j$VH",373)]=153,h[Fe(604,642,-223,-237,")trV")+ke(1699,1101,2505,"j$VH",1863)+tt(-654,161,523,"Vc@K",-515)]=154,h[tt(1013,287,1044,"4An!",111)+tt(954,1765,1327,"L(CX",1939)]=155,h[Me(576,-202,"yNX0",-5,703)+ke(32,1626,126,"cQJ7",759)+"er"]=177,h[Se(2074,"1PFJ",1757,753,1405)+tt(354,144,961,")!K^",-456)+"ve"]=178,h[Me(952,-55,"xnZ2",-239,638)+Se(1733,"1PFJ",1921,1704,1268)+"ch"]=179,h[Me(1001,292,"cuHB",1577,760)+Me(1193,1977,"qf#!",2206,1824)+"rt"]=180,h[Se(-395,"yNX0",-253,291,471)+Se(569,"@DgP",1220,714,1462)+Fe(709,1007,1809,488,"dIbx")]=181,h[Me(1175,421,"jdm)",1669,1223)+tt(1170,990,996,"@DgP",1638)+Fe(-82,-146,513,193,"qTX@")+Me(1977,578,"eij1",734,1446)]=208,h[Se(466,"^n]x",443,1043,621)+Se(2034,"pSnb",1122,1369,1302)+Me(1932,1632,"xnZ2",1152,1033)+Me(1498,848,"X$pc",694,683)]=209,h[tt(1523,1350,1921,"JbuD",2083)+tt(606,865,279,"pSnb",1523)+ke(382,1499,1849,")trV",1231)+"e"]=210,h[Fe(360,149,-492,-749,"@DgP")+tt(1642,1305,658,"Vc@K",1261)+Fe(1239,495,-285,1027,"dIbx")]=211,h[Me(1268,1941,"f1tM",2072,1787)+tt(2202,1392,715,")!K^",1676)+Fe(-936,-266,-62,462,"xr&1")]=212,h[Se(2108,"w158",1775,2128,1832)+tt(542,549,583,"F(AS",1065)]=255,we[Fe(167,272,508,69,"%h1%")](Fe(-296,499,226,403,"pI(B")+tt(1382,1030,1816,"Xoa]",1868),{table:h,flags:s,code:43,encode(t,n,s){const i=n(t),o=e.allocUnsafe(1+i.length),a=this.getkv(s);return o.writeUInt8(a,0),o.set(i,1),o},decode(e,t){const n=e.readUInt8(0),s=this.getvk(n),i=t(e.subarray(1));return{[we.SymCmd]:s,data:i}}})}const Le={};function ke(e,t,n,s,i){return Te(i-413,s)}function Se(e,t,n,s,i){return Te(i-103,t)}function Fe(e,t,n,s,i){return Te(t- -633,i)}Le[tt(-606,195,1016,"Tfsa",-596)]=0,Le[Se(1397,"X$pc",1371,375,1121)]=1,Le[tt(1e3,1184,686,"8N@2",475)+"t"]=2,Le[ke(2079,886,1251,"coSS",1697)+"g"]=3,Le[Se(1521,"Tfsa",2578,926,1726)+"r"]=4,Le[Fe(-406,473,249,542,"RJfU")+"an"]=5,Le[tt(606,735,-107,"^n]x",414)]=6,Le[Se(110,"JbuD",1267,45,553)]=7,Le[Se(886,"pSnb",1285,2521,1795)]=8,Le[Me(1903,2381,"u[9e",2783,2149)]=9,Le[Fe(1009,199,281,293,"xnZ2")+"t"]=10,Le[Me(1273,1604,"FAYi",1739,1433)+"e"]=11,Le[ke(1936,1503,2371,"qF#a",2219)+"r"]=12,Le[ke(2299,1683,3042,"X$pc",2396)]=13;const ze={};function Te(e,t){const n=Ie();return Te=function(t,s){let i=n[t-=272];if(void 0===Te.nPtTHR){var o=function(e){let t="",n="",s=t+o;for(let n,i,o=0,a=0;i=e.charAt(a++);~i&&(n=o%4?64*n+i:i,o++%4)?t+=s.charCodeAt(a+10)-10!=0?String.fromCharCode(255&n>>(-2*o&6)):o:0)i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(let e=0,s=t.length;e<s;e++)n+="%"+("00"+t.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(n)};Te.pBJYGr=function(e,t){let n,s,i=[],a=0,r="";for(e=o(e),s=0;s<256;s++)i[s]=s;for(s=0;s<256;s++)a=(a+i[s]+t.charCodeAt(s%t.length))%256,n=i[s],i[s]=i[a],i[a]=n;s=0,a=0;for(let t=0;t<e.length;t++)s=(s+1)%256,a=(a+i[s])%256,n=i[s],i[s]=i[a],i[a]=n,r+=String.fromCharCode(e.charCodeAt(t)^i[(i[s]+i[a])%256]);return r},e=arguments,Te.nPtTHR=!0}const a=t+n[0],r=e[a];if(r)i=r;else{if(void 0===Te.veSXTV){const e=function(e){this.UySLZY=e,this.DBTywN=[1,0,0],this.HRILbx=function(){return"newState"},this.DKXlGW="\\w+ *\\(\\) *{\\w+ *",this.AaMmTo="['|\"].+['|\"];? *}"};e.prototype.UXIisI=function(){const e=new RegExp(this.DKXlGW+this.AaMmTo).test(this.HRILbx.toString())?--this.DBTywN[1]:--this.DBTywN[0];return this.ooTVRz(e)},e.prototype.ooTVRz=function(e){return Boolean(~e)?this.LFPDyL(this.UySLZY):e},e.prototype.LFPDyL=function(e){for(let e=0,t=this.DBTywN.length;e<t;e++)this.DBTywN.push(Math.round(Math.random())),t=this.DBTywN.length;return e(this.DBTywN[0])},new e(Te).UXIisI(),Te.veSXTV=!0}i=Te.pBJYGr(i,s),e[a]=i}return i},Te(e,t)}function Ie(){const e=["A3BcJ1io","qxhcKmo8mW","WRtdPCkTF8o5","v8oXdJD5","W7atWOlcKCof","W4ZcIxC","h3ZdI8ktWRu","sGHzW6VdJG","pb3dRbBdSq","zvnDWPb2","qSorWQNcOKe","k8k5W6naWRu","W7ZcRCoSDCoM","W6pdH3ldRhO","WRddKhRcJG","WO1qWRG","WQmGwq","Fmk+W5jkW5C","W7CrWPZcUSoK","WPxdGsK","WOpcRSozWR3cMq","bSkJW6maWO0","v3FcKmoNoa","WO7dGdGDnq","ExbUWOfU","W57dHtJcUMG","qmoGdcPP","WRu6xmoPWRC","WR9TcaddLG","vCktcwNdTa","WQfvmtZdKW","W4GOAmoDWPG","WRpdPvldISkb","W48SvSo6tW","B8oIy8kina","W603fJe","W642DmovWO8","WPKLsW","sCkBWQNcVLy","WQLfWROdpa","x8oWp8oLxq","fwhdRSkiWPW","eComWRuIma","vCk7Cvi","qCo1csLf","W5SEC8o7Eq","wmoxyLRdOq","pvZdOqK","WOSQF8oLWQq","WQhcTmokWQG","sCo0DtRdJq","uCoix1y","qh1AWRXt","f8oHW7PcWQi","o8orW7PUWQ0","qazpW6W","CCkwg1VdKW","W50pWP/cL8oF","WOtdPmk7qCoO","WOldVw3cSXe","cxDLtKG","hKtdH8k/W5G","c2pdJJNdKW","WOVcQKldG8ki","nuZdSmkzWP4","WOddUCknvSow","d8kngwVdTG","WQldShFcIte","WOxdShZcQZ0","W6xdHrdcMNq","DmkJF8kd","WPTofYJdSG","bmo8W6jpWRu","rfVcJuuH","WQSAr8oRWP8","e8oatg0U","pCkOW7y","WO5lnq","W67dPXJcS0O","W6qhDmovWO8","imoOWOKOgW","yZ58W4hdUW","WPNdIIiClG","WQFcRCk2wSks","pSosWRm9ea","WQ/dR8kGESol","W4/dGMldN2a","D8kRcfZdHW","WPFdMgy","W6BdOYpcOSkk","lmo2W7jVWR8","W5BdVIFcQmk8","f8o2fcX4","WPmMxSoWvW","W5SsWOddPW","W4/dGMy","CSogF0ZdOq","cf/dNCkwWRq","jmoQWRmumG","wfFcMvKD","WRxdTmkTB8oA","eSokrumV","y8kxB0RdJq","hSo6W6HrWOS","WObwnstdSq","ymkfW7rYW7q","CCkPECkvoq","f8kgW7Di","bSo7W7G","WRRdOGddLmkq","wwNcKxy7","W7CLWQZdTvS","W67dOXZcTKu","WPFcQefiW6C","eeldQWJdKq","WP9jmZNdUW","uCoPq0tdHG","q8otWQNcOG","FmoWdH1+","dSoqW6PiWQm","W4/dGNJdIwK","W4BcIwidW7K","WO1FnsJdKq","q8o2AItdKW","s8kbB8kvnW","q8oQyJZdHG","WRBcUCozWQRcGq","W5hcQmokvmoB","ESoTxLddSW","cCoAW71tWQ0","jLBdRH7dJq","vCoWydxdHa","W68ECSosFa","bCklW5HiWPi","iCoZW6/cLmoB","CCoXDt7dPG","lCk6W6xcKG","twRcNCo2","W58PpXdcHq","emkDWRJcOKC","o8orW7P/WRq","WOVdKc0lkq","WRddLW81fG","ESoGWQNcMua","bSkmW5xcVSol","W5aJwCo5qa","z8oKueBdKW","vmokwLpdUq","DSoSWR7dKSklW7ZcGh1Lf8opW50A","ALeADq","DmoBp13dKq","W63dNYtcV8k0","WO3cVSobWRNcGW","W4pdK2BdKhe","BSkJE8kceG","b8kYW6mcWQ8","WOOBWR4rda","tGvkWRRcNq","nCofW6PjWO4","W6JcRfSU","W5ZcSCocv8om","l8o8W7bo","W7VcOwuCWPe","FmowvuZdGq","WRqQEa","o8ogWQiciq","mKLoBvu","ECkDC0ldIq","umklxSkseq","W5SPWRRcN8o4","W5K4wmoM","W48VvSoYBq","e8odWQWIBa","W4GSDSobWO8","f1Xds0K","ACowhJXZ","WPKJxmo3WOi","ymkfgfRdSG","W7yzxmoRWRS","W7VcMmoHD8oR","WPFdIIGk","mCkGW7qcWOq","v2RcMgO","WPhcU8oiWQRcGG","rwVcJCoHna","uCoTCaFdPa","W7WJWQBdHem","BhBcVw8C","WODrWRGrea","kCkYW6NcGW","WOBcQwzoW7W","ygHMWPTQ","WQ7cS8ofWRS","a8k0W6SqWQW","BGT9W5/dHa","vCoRyJRdGW","WQWxWP/cK8oA","DmohtrhdUW","WRLgWQCkgW","W5ddLIxcJ3q","suxcJNq/","WQ8RuCoRWQi","W6CzFSoUAa","W68CWO8","dJJcNfrc","gfRdKSk9W48","h8kBW7jFWQ0","WQ/dRSkLBW","W4tcMMqrWQy","pghdNmkzWR4","r8kngxldQq","WRZdIsKxmW","htpcIfzp","W7azFSoYWQu","hSocWQ3cOLW","W7OqWQ/dVhO","kx/dSCkyW74","rmomWQtcGLu","W5hcIwWn","WOZdSSkpqCoZ","tCozqW3cJa","usxdNgGN","W5GXya","W67dSIVcTq","rwVcMSo8oq","WPPAWPNcQ2u","DSkrWR1LW7m","WRtdPCkTF8oS","F8oAnGy","WRhdSSkLB8oA","FmkBCq","W6Ktz8otCa","E2jFWQTn","WR4MySo2W6S","u2ZcG8o2","jCk5W5TmWQ8","amo7W7G","tgdcMmo0ka","y8khFfldMq","W7RdPYFcOSkk","heldNSkYW54","WQVcUfddHSkd","WRvxWPxcGe8","W7KYkcBcNW","d8oqW65gWRu","BNdcLmoXoa","W6/dOH7cPeW","omkjW7bxWOu","W60tzCoBWPW","F1pcHwmR","ihNdH8kSW5u","WPZdKcimlG","W5iSgaBcOG","zSkaDLldIq","bNJdI8kaWOK","ostcKNHl","fmkkW60","A2tcLMi3","DmkCFeNdIa","WOrpiIBdRq","v8kVqSkgjq","WPJcLCocWPBcIa","cuVdNCouW4y","r8oMbcHX","WPyoESolW5G","WO7dKCkeCmoY","lNhdJCkFWPC","CLVcUh8l","r8oTht0","pCkmW5NcNSo1","kwpdQW","twVdLhO6","WP3dRHG7ga","jmkPW5i8WQS","qCktBvxdIq","W47dHNJdM3W","ESoopmozEq","af7dG8kvWQ0","amk/WQWnWQC","whKDuty","CmkVveZdTa","xSoxW6DoWQK","WRVdK3hcIa","FMhcKf4G","WQ3cRmooWQ7cLa","e8kkW7DCWQO","WR/dGNZcLa","k3RdOmo5W7O","o8o2WQqncW","FCkxFLddIq","b8kQW60t","x0XFWQb8","W7ldUby","xGXF","WQrrWRdcKN0","fezzvLK","uSozWQNcOW","w8ktW7LmW7W","W7FdQu7dSge","gfhdQCk/WOG","iwNdGq","vmoLDtBdHG","kmk4W6ZcGCop","WQ3cPe/dGSod","uSoLyZ/dHW","taPiW6ZdNW","C8kaFKxdHW","dhZdTq/dSG","WQvoWRpcTK8","lmo2W7j+WQy","a8oIW6rWWOC","qWPo","lvzhxhm","g8onWQ0IiW","AK8oAIy","g1zdxa","aCkdW7XxWQO","mgVdT8oSW6S","nmo7W4fyWOa","WP3cSNtdLSkD","WRP/dCoZW6q","sgNcJCo0jq","pCoMWPup","W6CcWRBdRhC","WQfoWRxcQa","pwzztq","vmoqWQ/cV1y","W5hcNL0eWOC","ydnOW5NdTG","tmkhWRddOa","WOdcQe/dGSka","W6pcH8opaYm","cCoqW6O","tCoOl8ou","WRZcPeZdGmkF","WQxcL8o/WOJcOG","wSo5lZL6","WQ3cRmoFWRxcJW","D8kqW79P","WQxdN3hcMZG","WONcK3NdJSke","W6euWPFcNSoF","uMRcKgS","vgZcL2uH","DmoVsxtdLG","h8oVWRalgG","zCkOeN4","irZcHx1V","v3dcN0e4","WRdcS8oeWRhdJG","W4ddJ3m","WQrmWR7cUvW","WOypx8otW5q","W7pdHeZdKK4","g1Prx1K","W77dLrBcHvS","DmkuW7b5WRG","nSk4W6dcICom","W70SctxcGq","W43cJw4bWQi","WP7dL3BcSae","A0vZWOPh","amo0o8oqFW","WRddId0yiW","WRvtWQ/cUKq","gKbcv0G","W5VcHmo2rSoZ","n1ZdOqNdRa","fmoysJ/cTSoQWRzPe286WOW","W5SRxSo6","bCk5W6NcSSoB","z1OqysS","W6eiWPpcLmoU","rv7dHCk/W5u","W5hdIMZdMq","Ew/cGuav","EvOFyGO","aLddKG","ACoChdLi","WPldJZGacG","qKtcOgCx","WQxdG8oEct8","W77cUCodySoF","i2/dSq","W64rASoa","smkmpMVdPW","sJtcKKTk","gL/dNIRdMq","F8oYWO3cIuO","W7JdU1pcPu0","xSoWeSojqG","W73cImoHCmo7","smoUm8ouDG","W4ecWPJdSgi","WPieDCoGWOG","W7OBuSoXta","c03dHmosW7y","WOpcSSos","W7y0jbZcLG","D8oTva","WQJcH1hdVSkN","FmktzW","rmoXzZxdHW","W5OWWRNcUSoy","W4qoWONdSq","qabfW6BdIG","BmkQA8kujq","imollXlcNCo4WOWwnmkbc0WHWQy","d1TBWRbi","WRqRsCo6WQm","mSo9WOGd","WPaTyG","W5BdKgBdLwy","W7VcUmoewCoA","WQVcSSocWQG","yLOsyIW","FmkfW7HUW6i","W54LqSo4vW","vv1BWQPo","WOJdGdWdoW","mCoNWRiLaa","WRhcV0xdGCkm","rNpcJ8oGoq","nmkYW77cLCot","WOFdPmkOt8oE","WO5skcldSa","nLZdObBdVq","WQ7cO1bwW6a","W7BcMCoZFG","W7VdPIxcPmkr","hSo7W6Xp","vYHnW53dUa","WOFcNKnmW5G","DYTyW63dGq","WPzqWQSBoG","qvfuWO92","WRaTdZVcHW","W589ySovWPK","d8opwG","hComWQqJ","W5eoWQZdTNC","q8oXndvw","EfaDBZ4","WRdcR8oFWR3cLa","EWfjW5pdUa","f8otWO4sjq","nCkOW6JcK8oF","W6JcGSoe","e27dKmkcWP0","WPZdLY0cpW","WRxdH1dcQtm","F8oBW7LXWRG","WQjzWQJcRK0","W4xdSGFcV8kt","W6mmWOBcNmoi","ySkxFLtdJW","WOraWQaueG","W4GXFSor","tKhcGG","W6dcVSouqSo4","zLaAyW","F2ZcL8oGoa","hgBdHSkpW7e","WRbqWRBcT18","WP1jlIdcSa","pddcLfHl","zutcMw83","W6lcMNCGWQ8","W7BdHtJcL1y","dSohWQ8UnG","W4K9BSorWO8","WQVdIY8Hoa","zCkxBfi","x8khCKtdIq","sIztW6FdOW","WRyNwmoSWRq","vSozWQ3cT0e","dvyzufi","WOrzWQS","W6xcH3OeWRS","W4tcJ8oopJi","rCoJo8ocuW","yulcMM4","AvmB","wCobWR8","yCo3p8oyFq","csNcKeKo","bKVdJW","lmo4W45BWRu","jCkXW6hcICon","kfxdSCoQW7W","vmoZENBdUa","W7pcQSotEmoF","yCkaW55jW5C","W50EWPFdVwu","WQjeWQOcnW","W4e9ASoDWPG","WQtcTCozWRe","dSoqW7bjWQu","WRLwWQ7cT3G","bSkcW5q2WOe","W7y/hJdcSq","dw7dOCkTWPi","W77cRSoZt8oo","W4JcUSoacqC","dKtdKmkQW5m","WRCIE8oL","WPHClI/dSW","FSkDDa","h0nsqvu","W7O7dZVcKq","W6yFWPVdJKy","W6pdKcxcP8kB","WQqIwa","xH1kW6/dIq","W4tcGCoYcJG","xmkNEW","k2ZdO8o4W6S","sSoZvepdPa","uCkdW5fzW7a","WPWTDCoVW6q","fSoNCwyW","W5ddGbNcHKK","y8kDCeVcGG","WQBdO3RcIty","WPhcONXDW7G","q8kycg8","u2lcR0aC","W63dJs7cHgO","kCoZW7rxWQ0","W5BcMMysWRi","W6tdVf7dS0C","b8olWRSI","Be1A","WQRcRSkIDmol","WRpdSmkOESol","W7ddOK8","W5VdUXlcSvC","FCkwW7G","aYFcMG","W6/dVYFcT8kn","a8kYWR5mWRi","emk1WQWwWQW","WQhdOCkHFSkr","W6JcISoskcm","dYJdJw9/","W4pdHcdcOSks","gmkPW6ma","W4NdHM/dJW","WQSVrq","DmkCW7TO","WO90WQmOeW","uCk/W4DLW5a","W6W7dtJcNa","kCobW6XtWQi","hConWQ80","rmoblSoyxa","WOjjnYJdKG","sLSAvsS","bZlcM14","WRNcOLJdISkj","egVdP8oNW6S","W4uhWP3dTwu","W7WUu8ocqG","WOFdPmkOxSoh","Ah0vuYC","pupdGCocW68","sqXiW6BdIW","W5hcNfWXWRO","pCoZW6JcImoo","sSoSxKBdPq","dYNcLLvb","W67cPSoBnXi","iMVdJCktWRq","hCoXaZW","rSouyxldJW","W63dUrq","fvZdOmkxWR8","c8kTW7NcLCo4","WRdcTCoBWRdcHq","hfDdzL8","WObtiYhdUW","WOLrWQeydG","y8kxwKddGG","W67dJ1tdMwa","W63dOY7cH04","WPFdKNVcRcy","s0JcImoFbq","W7lcQM0sWPe","W4FcPwTiW7a","WRzDWQJcUKK","W4dcHNCWWOe","WRBcSuu","a8oIW6HUWQy","WPdcS2bDW6e","W4e1smodWOe","wCkQWQaBW7hcMxiKW7HTEfXV","b8ohWRu","wKtcO8o0dW","W6WjWPVcKSou","lCkTBSkm","WPFcRN1s","iwtdOq","s8oPkmoEDG","W7uhvCoKva","amojvvOm","WQaIxmoOWQi","W6hcJSoghJ4","WPbuWQifgW","W4WyBSoCAq","yLexCG","W5uBWPBdSW","F8ktCKm","W7BdQgtdS00","cL7dNSkXW5u","nSkOW47cS8o7","d8obW7bbWQa","uSkPcLRdKa","WPFcLCofWQG","WP/dSKVcTa","W7NdUXtcVKq","WQ5cjq","WOOBWQCEca","s0tcTCovka","umoaWRGZjW","W7dcUCoeC8oD","hmkWW7/cJ8oa","WQOKw8oAWRK","lKddNSk/WOi","WPxcKvfSW6q","Bmo/gW","W7hcJSozdW","t3dcL8oWoa","q8oOl8ou","bmoOW7m","WRtdVNJcUq0","D8kjxCkUbG","BMPqWQTQ","W4WGCCo9WQy","WPKSuSoIWRm","ufpcJvi4","cgddI8kCWP0","W6VcHmoAhG","W6H1l8k3WRbLWPyKzmkLhmoPkW","WQxdHImcnW","b8kYW6mqWQa","wCoMaCoqCq","WPldV3hcIa","WRVdJeVcRZ0","yCkAW7jXWRG","g1/dI8oBW48","FSoOuKK","W6/dSHZcThy","W4JcHNTqW6m","W7WYcq","ufpcJq","gexdKCkQW78","W4dcI3SpWRG","fmkDWRCA","WOFcONftW7e","W5tcMmoycIW","eCodqa","W4e9hYdcSW","cSkivKCg","bCo3W7DE","WPXsid/dQG","FfJcJwm","dSkirfOn","WPixBCokWOi","xSoaEZddPW","DMVcGa","W6uDWPVcLCkF","WRGGFCoPW6K","W7CWbsa","DrTmW7VdIq","rCoImSovFq","f8kUW6mkWQC","W7W4rCo3wG","cSkaW71k","e8oBW6PFWR4","r2dcHgmA","W7hcKSoAhG","p8osW4PEWQO","W7dcHCoAgIK","W5/dMZNcTea","FCobiCoCCW","pCkMW7bLWQS","vSk/w8ktcG","WONdM3BcKGC","pCkTW6G","w1tcJhu+","eComWQiOjG","W5ldSX7cLua","uvGz","W7ddTGu","W7y9WRpcVSoP","kctdOCoM","pCknW69/","neZdG8kzWP4","oNxdVYJdKW","ovRdOrxdQW","gConWQuI","DSoUvuC","BmkzwSkwea","rgdcMSo8oq","WOhcKmoCWQRcGq","W7yzWOlcGSoy","wN3cNxO","fCoAW7u","W5yBWPJdS2i","W7JdPdlcHmkX","CmkgEG","W6JcHmoohG","cmoJyd7dHW","W4ZcM8olgsy","sMS5rbq","n2/dT8o9W6S","xCoIpW","WRlcPetdIG","WP3dGdG","WPb4WOpcVh4","W73dTIJcO8kx","d8ktgwVdPa","W4K3A8ozW4i","W5eVq8oIrG","CSkfW61WW68","WOr1WRtcRa","v8oizxe","WRhdRSk7DSow","W7/dUXy","WPXtiZ7dVq","fMBdItZdNq","z8oUreZdPa","kCk0W6pcTCot","W7WRcJlcKa","W7BcGSoqhG","W6xcVtBcSCkm","WPrqWROfda","jCoSWRmZjG","pMFdLSkxW7u","W7dcVtxcPmkF","WQddRmkPy8ow","WOdcOfy","W7lcMCoddY8","sSoiF2BdHq","W64Fz8ogBa","WQxdK3hcMa","W47dTsRcLKi","lvPUCvm","cehdL8ko","ySkFz03dMW","WO5kWRe","WPldIJ4gia","WRhcQmokWRRcHG","W7u+WR7dNeu","W6/dSG3cVei","v1XFvKK","jmofW4b7WOe","WQmIe8o8WQq","Fe0xCJO","wSoIlW","AwVcJq","W4eEWQdcPSoA","D8oqWRJcMfm","W7CXC8o2W68","DSkhW69ZW6q","DupcLCo8pa","ASkIzmkt","W5RdTJlcNCkn","WQFcVKrVW74","vgX9WQzR","EehcJa","BfaABq8","C8oGwe4","D1hcOMeA","WRbsWRtcT10","W6WFWOlcMCoE","W5ZdNdpcQfu","WPtdISkBDSoU","gmonWQz1","WORdHd4BiW","bSoqWQa+","W7hcSmowFmoF","W7hcUftdJSkF","BSo8EaldSa","WOHhlcJcSa","WRGUyG","FmoVvK7dPq","vaDCWQTC","WOxdJg4fWQm","W6ddIYJcK8kn","amoKi8oqzG","jCk2W5GJWOO","amkoW7rkW60","W4JdTYlcHmkF","W6pcHmoyhs8","uSoHBYddIW","WPHsWQ4","EvyCyW","fCkOW7yx","D8k1FCkc","W7ldSXJdSeO","WRHzWRBcVfS","WOepz8o1WQa","vmoXgtnR","gCkNW7O","WQZdR8kLDq","WQaNrCoQWRu","FCkDEbq","gu/dLSk6W4i","WQO3D8o0W6K","AxLuWQnv","W40+w8o+zG","rmkph2xdPa","lNNdQmknWO8","B8oahhJdNW","W4NcTmotu8kq","l8k4W7tcLq","W6FdKMhdT18","imo7WPeceq","zeDkW7Cp","WPpcQ3nfW7a","W44VrCoGrG","W5W5ACorW4i","WPDJWPlcL2C","vhZcICo2","aKBdHmom","vMVcNxO","WO7dOSkAA8oY","W7hcN2G3WOq","x0zrWQKt","WRNdKNO","iwNdL8kpWRO","WQBcN1NdN8ki","WQldK3S","zcDhW4pdMa","c8obW7vgWQ0","WQZcSSooWR/cLa","r2tcLmo2CW","nCkIW6y","W73dTIi","cexdM8o+W40","veKv","DSkBW75ZW7i","WOlcQNC","xmk6zG","lwtdTtddKW","g0xdGa","W6dcSSoOiHa","WOH9rmoqwsNdVW8","WROSEmoMW6K","W7JdHhRcKtS","W6uJqJFcMG","vNBdLID6","yf7cQ2OA","k8kwW4lcSmo7","fSo3WOCVbW","s8kkcwJdIW","BKTqDsG","ESoMkCoDDW","W7ddVHpcUvC","W6SvWPi","auNdOCkLWOW","j1BdOrNdVq","bCojrG","og3dISko","W5JcUmot","B8obWQ3cSL4","vmo1ad0Z","s2dcGa","W63dSHJcU3C","W7CjWOpcKCoq","gCouW7jw","W5tdGcVcGwu","W7VdGqxcP8kq","WQ/dRSk8BSol","W5dcQmotuSoF","W5pdS8ovu8os","WO9AWQbqva","W5WPq8o/ta","f8ooWPa+ea","E2RcGMeq","rmoOBJddIq","W5iBWPW","wHTcW73dIG","h1pdH8k7","tmkOBSkIiW","W5NcTmojv8os","W4VcUmojrCox","W5VdOrZcH0u","CJLQW4RdPa","efP7weS","t8oQAcC","fSoFre0","ACkNEmkfcW","sLSAqYC","WPldMCkCxSoS","BZXTW4/dQG","WRb/WROMoq","WQuMxmo7W78","W7pdLmkOASoZh2G","W7xdLLNdHg4","CfxcHNqT","W7u3dZ8","uCkocW","h8oBW71vWQG","Etb7W4ZdVa","W60QdtlcKW","W5lcJxSfWRG","DmodDdxdPq","fCoaWQ0I","WPRcPhvKW7a","D8k/FCkolG","F3KwCZO","WRNdMNdcJIC","ASoXWRVcO2S","dCowuvOC","W43cK8otkHG","W6dcN8oz","W43cQmoeqSol","dxxdVHpdQq","WQjuWRxcQLW","j8oyW5LbWQa","qSkPoCouFG","W7RdKJxcKvq","CghcL0SX","WPpdNYK","xWDFWRfj","pSk6W5vaWOO","WQVcHSopfIG","FSo1gGTX","Ff4mAW","W6JdOZBcVmkh","W5Coz8oHWQm","WR4IE8oLWQ4","W44Lvmo/qG","h0nyvK4","ufpcJumH","ESo6cZfZ","WONdII8goW","WOrCWQau","W43cSSoiw8kq","Ba1p","jgVdNq3dRa","nCkIW6y0WRS","W5WVWPldOvC","FCoGqG","WQiRxSoGWRu","WQxdQmkTCSor","wrbBW6W","fCkRW61TWPO","hxFdMZi","WPFdHg3cNs0","WR0sWQJcVuq","fvFdQY7dUq","jfRdQHNdVq","W4FdNWZcSxy","W5W9CmoFWPO","raDcW70","WQpdO37cKWC","W5ixpWa","ymkCW6D5","BYvVW63dJa","iSokWQmDfq","h2/dP8kxW70","WQhcQh1qW7a","c3/dHINdJa","lSokDK0a","hCoDW7nsWO0","vL3cUwOB","n8kYW67cJ8oB","bSkFW6LdWRO","WRXtWR7cVq","emkeW53cO8oP","l2/dSCkFW64","W6BcGCkbW7u","yCkuW7LTW44","oColW4zVWPq","W7mjtmoFWQe","B1ODAtS","W50xWOa","WQpdMCkoqSoL","W6lcHsRdHdGXWOm+x8kF","t2dcHMmZ","qSoUjCouyq","WOjhoq","WQLUWRFcKN8","WP1dicNdNa","CmkVySkxjq","oeTtBv0","aZpcLK8","W5lcMK4KWOC","csJcJe9j","W5q7WPVdU1S","fx3dJmohW6y","CSoWcqHV","WRxdQCk2FG","WRu+vmoHWRm","l8o9W7LgWQi","eCoXWRu1kW","nsBdKmkDWR4","WQJcLgjoW7S","W7tdUrtcPa","r8oPiSof","WO3cN2xdQ8kY","WRNdHNRcJIa","ECoYAG","vmoLvxBdOq","CCkJFq","W6ddHCozdJO","W77dUbNcTq","l2ddMmkoW7u","Bmk7y8kLnq","cuBdKG","vConWRJcJ1e","xmoOp8oqzG","f8kiW53cTSo1","kCk8W7u","xWXkW6xdMW","zSkIBSkija","WQfzWOpcTwm","WRtcVCohWQNcHq","sSoqWQlcUuy","W4JdPbxcLmko","W47dTYNcKCkX","WQxcVCozWR7cGq","ntlcJ09G","rKZcSeCZ","WOXXWPC0dG","WOHOWOpcTuW","bv/dR8kRWP0","fe5p","kCo9W6niWQS","W6WpWRRcMCoc","nvJdNmobW4q","W4JdNHpcPa","W4lcH2Sd","WO3cS3TDW7K","W5mFnaVcPG","f8koW7PeWQy","W5WXaZJcKa","W5i6uSoKvW","CCkzW7G","uSouWQlcVfS","m1NdHmoJW4y","f0Xs","tmoUjCov","WPhcKIxcIdTDW65NySoRWQpcTxe","F0yoyW","aKtdNSkQ","h0RdM8koWP0","beZdKCkTW54","nItdQmoQW6C","WOlcPhK","jCkaW7zdWQy","WPyNDCofW6m","WPvCWRqv","WOWVCSodW7G","W7CyWQtcISoY","W7FcJSojfdG","hCoXgZ1Z","W6RcNmoeot8","W5ddGMldMq","i2VdT8oPW68","FCkQW75ZW7G","WQZcT2zvW7O","WPKrtCoUWRi","swRcLW","W6dcHCoEcsm","WRnkW4/dH8kbfGNcSSkzdSkVj8kE","f8kzW4TnWPm","agxdS8oKW4W","yfOhCY8","WPhcQh1rWRS","q27cNmoN","wvHwWRbW","W5xcGwaiWQq","FSkodh7dHG","W6GilWtcHa","ouldQmkpWRK","DmksW7HU","eMZdJJBdLa","jMpdQ8oV","w8o0WOdcLKC","WPn/WP8fha","bSkmWQaJjG","WQvfWQRcVq","bSkVy8kFoq","uSktW4vlW58","gmozW7S","B8oJl8oHya","aSolWQ0ljW","aqlcOa","WR/dIY8apG","g8obW7DvWQi","WQxdR8kIAmol","reDz","FmoYeWVcQa","WQ3cKev0W4e","b8kiwuKC","imo8W7raWOO","WRqRtCoJWRa","WOZcUgNdJSkJ","WRLqWQ7cV1a","BSkJACkc","W6pcJCopcq","WRmArCokW5m","ESkBW7rO","cmoqW6PiWRu","lwtdOG","WPVdGsG","qSoqWRZcVfm","WPpcPMbiW6W","WQ1WaY7dSG","wCowcSoOwa","W7K/athdMW","WOmBWQ8fcG","xMhcKeSQ","WRFcNKj5W4y","W6ihDSooFa","xmoIkSovua","zmozbdr/","Amk+qmkMfG","W57dPWVcUKy","Ba1pW5NdNq","W4GSzCosWOO","WQrpWR/cQKy","WPhcLd5xWQS","cdhcMG","jLBdRH7dMG","zSo1q0VdRG","W4NcIxW","wCo4cZr6","xWDFWQPt","ufdcKe4k","mgVdMd/dUq","vCkydg8","WP7dRW0yhW","imoZW6f5WQS","W7VdVcNcVCoq","jSohrMSd","W5FdUGZcP1O","WQ8OvmoSWRa","W5GTWOddPxm","WPNcH2hdQa","WRRcPvtdNCke","W77cLSoPtSoi","aSoEWQeF","wrTcW7NdGW","CCkJySkkBG","k2tdSmo4W6S","WQFdRSkOAa","yKRcLmoRdW","yKSB","FSovnqDk","qCoHEtBdPa","WR3cUepdNCke","wvBcINqa","WPGNCG","kCocW7XnWQ8","qLXCWQHy","WOnBWQ0FgG","vCoTEZy","hItcJ14","pGtcR351","WQ/dO8k4","AmkYdKldQW","F8kFDwFdVW","WQ5+cqRdUa","qSoHyJZdHG","iSo2W7vVWQq","W7RdPZtcUCkq","bSkJW64lWQG","bmoSWQ4pkW","i8kkW7PaWQC","DuZcL8oN","W7BcJSoBdI8","tKfFWRat","j8kwW4mkWPa","DCkaW4LtW6a","iwpdNCoGW60","BCk5yCkl","amk/W7ib","WP3dGd8coW","wMVcL2e2","W6tdKZtcS2y","D8kFzmkDjq","WQG2C8o1W6u","W5ZdJZxcL0u","d8ohta","cSoZW7TpW6K","WRNcLfTeW54","W4iyWOK","W63dGHJcPue","gKbzsKG","dvXhufi","aSkiW6a","zLBcO2C6","k8kkW4S3WP0","WRBdOCk+B8og","omoSWQqwcW","r8orlaj+","WO7cRNXtW7y","WR1wcrJdMq","W4pcHgO","W5SSFmoXya","WO8RDmoAW5C","WQSSECoTWQ4","WP7cIvpdQSk4","WOJdIImcDa","hmksW5/cR8oT","h8o9WP4","W4ZcH2Sd","W6JdTLhdPMm","W4JcQSoYjai","W4qqWPNcKCof","WRGTCSoZ","Dmk+zmktjq","WOO3zmoPW64","z8ktC1pdIq","WQ4RF8oSW6u","W43cUmoguSo3","W5lcNg4aWRe","g8oeWQC0jW","xmoVrq","C8k8DCkonG","W6avWPJcLa","s8oWiWfU","p2FdMSktWRO","ESoehSowrq","BCo2WQtdJCkt","WPBcHCo7WPNcSW","B8omimoaAW","fSohvKqn","jCkLW7uMWP0","dwZdNCkUWRO","dSodvu8D","W70XaIFcGq","W5xcISoycc8","nSo/zg07","f0pdGSofW4S","rMNcMmo0lG","q8kngq","mgpdQSoLWQa","WRbDWQWQkq","WRVdMxVcMq","y8obWR7cPve","caJcUvnJ","WRtdJ2VcMq","zSoKrwVdRG","W6dcVSoiuSoB","sKHtWQfu","CSoDurBdSq","A8oUqbFdKG","W6BcGCoPhG0","xSo1jmoh","qSkgBu/dGG","W5hcNxWo","e2pdJW","WPTkcGRdQW","WRpdMhZcKZa","WQRcU0tdJSkz","u8oECg7dJa","W4hdNItcOSkj","x2yUqWW","W7m3aG","kNRdLSkx","kg3dMSkvWR8","qSk1tfpdVq","WQ/dTmk1","dmk9W5XOWRy","W67dPXtcVLa","W6KzWO/cGW","qSkoeh/dRq","CSoWcqX8","zmoSWPZcLwe","hfJdNSkQW54","AeSrDhC","WRzDWRFcVqy","W54SDW","W6euWPFcHmkF","eCopwK8e","yqzkW63dQG","W6mmWPFcK8oy","W7yBWRtdMMS","kK7dK8kkW5O","W6xdVcJcTW","CmkaBuFdLq","gaNcKhHS","sLSAuJ4","c1Putvm","w14DBs0","xmkOxhBdTq","istdPSoKW7S","cmo3Ad/dHW","WRuRsq","WQVcUCohWRJcKW","W6/dUaNcSvC","cmoNBtBdGW","W6ZdVYFcTSkX","pCkaW614W7C","WQz2WOZcOge","tSkpcxK","qaHt","W7pdGghdVLW","WPXGcsVdNW","WP9hjr7dQG","cSo6W7LzWRm","pN7dRCoQW6i","WRBcReu","W4iyWPBdUt8","swfAWOTU","WOddJmknxa","WQ3cVKpdM8kc","Bmo2qGNdRG","wSo7aW","mHdcVKTR","hKZdKCk7W4K","WQPAWQ8uoW","b8owWRmUla","cKtdUmk9","W7RdTHdcTq0","W6/cSSo5mrK","W6GTCmomqa","DSkSfwBdOG","W5i2CmoRWPG","C1VcJa","uSkrW7LiW7C","c37dJIldHW","lwldMWldLW","W6qSzCogWOS","W7ZcNSohkt0","WR/dSLtcRH4","Cmk4F8koiW","WPddRCkNEmos","W4pcJe4bWOy","yrTFW5VdUa","Ee8xAcS","j1BdRGJdUW","qMRcLSo/oa","W6K3aJRcKa","xwpcTKCl","W441zSorWP4","c17dRGldIW","t1TFWQDw","pubcw1a","W7qorSorWPW","kZNcMW","k8kWW6K","W5qNWOJdP2S","smolimo8zG","W7pcSCoLu8ow","l1ZdPSoGW6u","gdlcKfyi","DKFcIguY","W7mkfJdcUW","sKHtWQet","WPvAWQ0zhW","W485DSotWOK","EvyCzda","k8oVWOaFhq","zSoKru3dSa","W5OxaIa","f8kgW7XmWQy","cexdMCkTW48","tmkieMpdTa","W4xdUHBcSSkp","W7VcVsVcUCkz","uCo4ca","W6tcImoEeIu","WQddM0BcSr4","jNFdMsJdKa","WOilE8ooWOq","E3tcI8kgW60","W4pcPNu+WRa","o0hdTmkmW6m","WRRdMx7cIa","nmkVW6lcKSov","h0nwxK8","lx/dLmo7W7W","qCo/WRrrW7/dQmknF3HEWQFdOG","r8ohWQxcPfC","iwtdPSoKW6O","EmkrW61VW5C","CmkDW7XOWRG","W78YadVcLG","W67dSG/cPKy","qCoHDq","W4ZcRCoowmop","duPds1m","WPNdKNZcUtC","nt7cKfzl","Ba1pW53dJG","W4OsWPFdVwu","W4KJWONdOvy","rGXsW7O","hMH5v10","WPqPv8oeW7a","sSomChRdNW","W4G3z8oDWO0","W4mOWOVdOx0","WQpdMh3cNtO","b8onWQiUiW","qmo9fZ0","vmoHCt/dGW","ECoisaddTG","W7xcKCoWfI0","W5CYySoHWOq","W4JcRuOhWQ4","W7JdL3VcMa","WOWkEmo0","hCkXW4JcICod","W4G9DSocWOK","mmkcW67cISoF","W4/cJxG","gJZcNfa","sCoZBZBdKa","Bmk8Amkvna","W5i2BCoa","xMVcGgCX","W4yrfIhcNW","zSoEnrr0","n8oBW7XqWOe","s8kPkSotFq","m3JdRmo/W6S","emkbW65cWQO","WQSMD8oSW6K","tLRcIh4k","rCkegMVdTq","WOpcMMOsWQi","cmo8W7vfWQm","ymk9W6TmW4y","dMNdTmkj","W4JcQSoYjb0","tKvBWQvp","tWvo","W586catcHW","qSkBzum","W4GVWO/cL8oO","W586cadcLa","wSoXatXU","kCk7W5XOWOy","WRldHhdcJdO","bfRdG8k3W5q","W4tcJ8ookd4","W7qQWRxcOmoa","W7VdSrJcOG","q8o0vXhdSq","FIHKW7NdTW","j8kJW7yPWRO","WRJcQK3dISod","WQSSySo/WQu","i8k8W6dcG8ku","W7JcUmotF8oq","cmkBW7ntWQS","d0pdKG","W7GwWPRdPKG","W7JdSqK","u8k7s3xdSW","fNZdOGldIG","W73dVW3cL8kl","WRL4WO8Oiq","DmkuEupdJW","EfWrDdO","wSo6ca","W6ySWOFcG8ol","cKJdM8k7","ymkGtSkscq","mCotW51jWOe","WPv+WRtcJKa","WQ/cK019W4C","W4uUWQpcKCo7","WRXDWQi","maldM2z9","FmkcW7nEW6m","t30qudC","W5qKua","F2HN","dSoAW65vWRK","dwZdNq","xgRcKgS","wSoVhCouFG","gepdJCk7","W4/dIgOEWQC","W7urWO/dSLW","WQOQBmoL","yupcHw4C","jJZcVLrl","i8kZW7yjWO0","WO3dHcuBkq","xM7dIGnkhSoWD0H4","WO7cQhzz","hvldGCoCW4q","W5BdMMBdMq","WQxdIcmlpW","rMKTFJ4","W7u7fsC","W5hdHMi","jSklW70","mmoGWQ8rkG","gSkHW7e","F1m1qsO","yCoBW695W7S","sCkLBmkwnW","W7iXc2y","WRqQEmoVW6u","W40VwCoIqG","zmouWQ7cVfC","eINcMLvv","rCkkm1ldPW","v8oAWQJcU2i","W5SLrCoWrG","WQnzWRVcVhS","swVcKmoN","WP1lWQ7cLKK","WRnqWR8","cCo3W7vfWQm","C8krlwhdRG","W4HgWRCEhq","cmkeW45DWRy","W6C9cWZcKa","W6JcGSoeeJ4","mSkYW6hcKmoF","WQ7dSSozWRNcJa","WQjmWRBcSvW","DvlcIMK9","rNFcLSo+","WRyZC8oYW7q","yCoGruC","yCkDBfxdHq","tGzpW6W","DmkNW7blW5K","zGlcVe7cQCktW4VcO8oKWQSOWRZdMa","ifldRrBdVq","jSoOWPyQeW","WRiRsCo9WR4","jCoGW5bQWO0","lCkeW4WqWPK","vmoqWQdcSuS","W6VdVYm","W5ddHMBdKgK","hSkuW6FcNmo8","C8kEEG","W7iCDCoZuW","lxddOa","e8kaW6LaWRy","kZRcHNn1","ixJdTG","W7BdGNtdKg0","WOFdPLdcPra","WO5oWR/cUuW","mSkUW7FcTSo7","WQFcSmokWRRcRW","AmojwtxdKW","kCk8W7NcHCos","E8kLc3NdMq","rCkUcMhdHW","FxdcKMG3","AmorWQVcVfa","jSo2WOqdhq","WQ0MEmoZW6K","je7dLmkBW5G","WQdcSmoo","WQ7dPHKidq","yCosWPBcVNq","WQtdK37cMba","nv/dOXxdUW","WQldJ2/cMq","tSkrC0pdJq","q8oWwctdJW","gINcK1nJ","WQrjWQ/cUuK","EmkEzM/dQG","xCoAWQJcTq","W4ZdL2u","WO57bmkIefdcQJ3dLCofnrLu","WQpdRCkPDCol","D2tcNuih","WPjzWOu3cW","B0JcLCoybq","ywhcNCoakq","WRDoWRxcTq","CKji","W4ldUHtcVMe","s8oTBW","WPdcOMzvW7e","xN7dK8kVW7FdPmk+","aCo3WQaOeq","W4tcJ8oolYS","WQFcN8o8","W73dQJBcTq","du5vvvK","eefEtq","WOvIWQmAfa","CSkVA8kBtG","WQnjWRNcRf0","aLJdKSk6","W7KLqSo0tW","WPRdUhRcRr0","W446xSo4ua","uCoBWQJcOW","W54wWPu","wSo2i8ofxW","o0tdOr/dQG","mmk4W6pcLCot","WOTdiIldUG","WOpcUmopWOJcGq","WQhcSmoOWQNcQq","W7atWPNcNCkF","W43dL37dMxO","FSkCW7nZW7m","nmouW5a","s3ZcHgS","e8oXW5vOWOy","efpdLCooW50","sGXFW7/dHa","WPmhu8o7","BIvCW7/dJG","rCkeh2xdPa","mx/dPmoDW4y","aXZcKMnl","W4BcMg4fWRW","vSoaWPJcN0q","k19/BhS","E8oJWQJcU2e","iCoRW4zMWQq","AwbqWRa","W6ZcHCoddW","c8oaW5HmWPi","WORcON5yW6y","WQ7dVbWQcq","xmkHzmkjeW","W6GYWQRdVfi","WRfYWPOvkG","W7ldPXJcOLC","e8oaW49kWR4","W4BdJgpdNMq","WRNdKNdcLcq","W67dVGFcTq","W7hdGXdcP2K","f8kRW6y","DeZcJSo7nG","D8oDaYW","x8oxWQBcTve","W6iPwmoYrG","xmkYW5XfW64","W4SNBSoBAq","W5iSDW","WP4Jt8oMWQS","omoUruK9","cYNcLLri","hComWQGZ","W7ytWQxcHmod","u3dcM8o+na","W43cICo8cWC","kCk0W6m","uCohWRG","aCkjW6PkWRC","l2/dVmo4","c8oixvW","sSoXq03dSa","vSohWQ3cVvC","ctlcK05l","lehdRftdQG","zqRcV07cQCkFW4xdH8o8WR0tWPVdHMG","bs3cMKLs","W6pdVYdcVmkz","nv/dJ8kUWRe","WQ8Gvmo7","CmkVwu3dSW","WRxdR8kVCSoE","WO/dHbSdgq","lSkbW60","zmkTymkcBG","jMBdOmkRW6m","E1OqCJ4","qmoMjW","WPjUWP/cSMm","WQldPCkIyG","WP/dIY8apG","W53dM3nxWQS","W73cUCoqBmoP","WORcQxTi","W5u5Aa","WQxdGN7cMJi","greiW7ulnKKptaRdO3ZdRq","WRddHhdcKq","W67dSHJcUW","wCkEW7TPW48","BSo8h0hdRW","cmoqW79EWPG","lCkQW4ClWRa","Et/dISk8WQhcSwTg","ogNdJCkFWR8","W7JdGx7cIde","WO5klsldQq","jxldNa","CmkqCftdMa","W7ZdOYlcSCkk","ygRcHhOu","ug7cO3WN","jSklW71/WRe","WQ/dTCkaESoi","j1RdTr8","kxZcL8kxWRq","rvBcI2O8","WPWgzCoIW4i","D8kJxSktmG","AmkLBSkm","gSkGW6Sd","vmoypcbj","sCo4WOxcSv8","vmoLvq","qebq","W4BdQvFdI00","c0byvbi","qvGOBJq","W5esxmoJzq","W4KmA8o3WQy","y1JcHMT3","gttcHv4","WODwWROzeq","yCkGAa","W5qOyCogWPG","W5qlkW7cNG","sSovCgddJa","WOvLWORcNxS","xXXiW73dGa","imkfW4LdWOe","pConqG","pmoHW6rBWQe","W586ca","dtZcKL4i","W67cMhSpWRG","z2rAWQT+","yxKKrri","WQRcG0z0","WORcGK7dMW","wmoXfcS","DCkBBexdGW","WQHaWQmsgW","W5GRrq","t2dcKwu","WRFdPvldISkB","W7VcLmojqG","WRi3vCoDWRy","eu/dMCk3W48","jCkXW6hcHCow","WOddRmkJESol","w8oPl8ouDa","W4GQrCo2WRW","cCofW7DuWQG","W5yLWRFdSKq","vSoAdvrq","W6O3aI0","WQ4XF8o0W6u","WP/dHSk9CSoo","WRjSWP41lq","WOjjjsG","WPpdT8k2ESoQ","W7WmCSojAG","WQhcTSoOWRNcPW","lCkZW6tcKG","W6uXWPxdU3a","B2hcMSowpG","W6pcUvC+WQy","WQ7cOMldG8kU","WQ3dLSkVCmou","W60XdZ3cLa","xH1zW6ddJa","gColWQ8UnG","zmoXzZxdHW","W5uEWQhdV3i","WRZcRgq","W601btRcHG","W4NcKSo6nYK","z8oKqLBdSG","o0xdQG","W7FdVmo4z8km","W5hcSSo6pHK","W6dcHCojfc4","smoLBdy","WRnYWQdcGe8","FrNcHMG1","WQ3dTmkwCCoE","ymkqW6K","aCodWQu0","W5hdK3/dKNS","WRmGwCoG","gCoAW7buWQK","rmoOza","b0euWRpdTa","WRddUNtcSsa","bc7cI0Lt","ySkBzum","nMxdQSoMWQa","W7FcHmoffMq","sCklneldOW","FCkAW6L1W7a","WPBdQ8kpsCoN","ASoojCof","pwVdOtNdQW","xqvkW7ddIG","wWbFW6W","e8oOW6OfWQC","EmkCDLi","WRPVlZK","W542z8oBWOG","oSoPzMe/","EmkuDKxdJq","xCkNjCoEzG","bKpdMq","W4pdMKpdNM4","gSkZW68gWQW","WRtdRSoSB8ox","cuThWRby","WQC8t8oUWQG","q8oqWR/cO1S","jLZdObFcTG","m3/dNGldJa","u2hcQ2u1","D0lcHwO","xLLsWQ1j","vmoHztW","EKZcS0yg","W4/cVSopmJG","Av4DBtG","CSktC0O","k1/dKSo6W54"];return(Ie=function(){return e})()}function Me(e,t,n,s,i){return Te(i-335,n)}ze[Se(1128,")!K^",1227,1075,1780)]=0,ze[Fe(-538,371,269,1091,"3n*4")+Me(1906,2495,"u[9e",1131,1670)]=1,ze[Fe(2044,1239,665,1752,"vBj8")]=2,ze[Fe(643,103,-3,-364,"Tfsa")]=3,ze[ke(1628,2462,1304,"jdm)",2076)+"e"]=4;class Ee{static[tt(36,237,-615,"#WnQ",398)]=Le;static[ke(1950,1780,2228,"qF#a",2236)+Fe(989,177,-232,617,"cQJ7")+"X"]=Array[ke(2268,2289,2833,"^n]x",2060)](Object[Fe(1332,929,361,1601,"RJfU")](this[Fe(155,708,622,130,"8N@2")]));static[tt(971,513,-228,"cQJ7",825)+ke(1130,1609,1826,"Uu0i",2038)+Me(3072,2282,"qF#a",1488,2158)]=new Set([Se(1408,"qf#!",1972,2115,1918)+tt(1120,377,277,"Uu0i",302),Fe(1415,614,1364,1065,"oES7"),Se(135,"w158",1496,-155,595)+"an",Me(236,200,"ArG5",1527,1e3)+"r",Se(739,"Vc@K",1539,1113,1340)+"g",Se(2487,"pI(B",2271,2028,1985)]);static[tt(2487,1924,1698,"0w9F",2465)](e){return e>>>0===e?Math.max(32-Math.clz32(e),1):Math.max(32-Math.clz32(~e)+1,2)}static[Fe(1747,886,171,1238,"gGSn")+Fe(1167,619,1433,1241,"oES7")](e){return Math.ceil(this.cla32(e)/4)}static[Me(1989,1470,"qf#!",2273,2201)]=class{constructor({min:e,max:t}){const n=652,s=212,i=97,o="8N@2",a=1533,r="JbuD",l="oES7",c=1830,p=1195,d=1309,h=395,u=211,_=534,m="K^(^",g=215,f="5hjj",b=426,C=201,x=866,A=344,y=481,v=112,B=388,w=803,L=287,k=346,S=1094;function F(e,t,n,s,i){return Me(e-L,t-k,e,s-178,n- -S)}function z(e,t,n,s,i){return Me(e-A,t-261,s,s-93,e- -y)}function T(e,t,n,s,i){return ke(e-b,t-C,n-337,s,n- -x)}var I,M,E,D;this[T(514,1111,1196,"f1tM")+T(-n,-s,i,o)]=e,this[T(2313,631,a,"Vc@K")+z(1567,2069,0,r)]=t,this[F(l,c,938,p)+T(1831,1703,d,"#WnQ")]=Math[F("1wIT",h,u,181)](2,e),this[T(_,1306,1040,m)+(I=-59,M=g,E=797,D="Xoa]",ke(I-71,M-v,E-B,D,M- -w))]=Math[z(767,759,0,f)](2,t)}get[Se(573,"yNX0",90,1004,902)+"ze"](){const e="FAYi",t=453,n=108,s=324;function i(e,i,o,a,r){return Me(e-t,i-n,a,a-s,i-444)}return this[i(1857,1533,0,"X$pc")+i(2238,1479,0,e)]}get[ke(377,918,1290,"Q*kn",1023)+"ze"](){const e=160,t=636,n=240;function s(s,i,o,a,r){return tt(s-e,o- -t,o-449,s,r-n)}return this[s("w158",0,645,0,215)+s("5hjj",0,-321,0,-309)]}[ke(1235,673,1306,"u[9e",706)+Fe(589,25,-693,466,"qTX@")](e){return e?this._maxBits:this._minBits}[Se(-427,"u[9e",1253,772,398)+ke(2179,2426,1203,"L(CX",1916)](e){let t;switch(e){case e>>>0:t=this._minSize<=e;break;case e|0:t=-this._minSize/2>e;break;default:throw new RangeError(`Float/Double is not supported for DInt: got ${e}`)}return{bit:t,size:t?this._maxBits:this._minBits}}};static[tt(937,411,-205,"L(CX",-487)+"r"]=new class{[tt(994,757,1627,"Uu0i",1276)]=ze;[tt(2118,1320,616,"@DgP",498)+"e"](e,t){const{TYPES:n}=this;if("number"!=typeof t)throw new TypeError(`Attempted to encode ${typeof t} as a number`);if(Number.isNaN(t))return e.writeUInt(n.NaN,3);if(!Number.isFinite(t))return e.writeUInt(n.Infinity,3),e.writeBoolean(t===Number.POSITIVE_INFINITY);switch(t){case t>>>0:{const s=Ee.GetIntSize(t);e.writeUInt(n.UInt,3),e.writeUInt(s-1,3),e.writeUInt(t,4*s);break}case t|0:{const s=Ee.GetIntSize(t);e.writeUInt(n.Int,3),e.writeUInt(s-1,3),e.writeInt(t,4*s);break}default:e.writeUInt(n.Double,3),e.writeDouble(t)}}[ke(810,1238,1709,"tj0x",1458)+"e"](e){switch(e.readUInt(3)){case 0:return NaN;case 1:return e.readBoolean()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;case 2:{const t=e.readUInt(3)+1;return e.readUInt(4*t)}case 3:{const t=e.readUInt(3)+1;return e.readInt(4*t)}case 4:return e.readDouble()}}};static[Fe(782,981,1480,1100,"dIbx")]=class{constructor(e,t=Fe(581,1202,610,2105,"0w9F")+"t"){const n="^n]x",s=179,i=351,o=2642,a=439,r="dIbx",l=799,c=2161,p="8N@2",d=836,h=2059,u=1196,_="ArG5",m=2439,g="tj0x",f=1346,b="Q*kn",C=518,x="&@t)",A=988,y=626,v=644,B="Xoa]",w=545,L=253,k=110,S=963,F=1628,z=646,T=1261,I="gGSn",M=1890,E=1067,D=543,O="Q*kn",H=2054,P=1832,R=702,W=1120,$="qF#a",N=60,U="1PFJ",G=231,X=648,j=1982,q=1812,K="Uu0i",V=1231,Q="xr&1",Y=1444,J=1573,Z=849,ee=598,te=426,ne=959,se="pI(B",ie=452,oe=274,ae=309,re=392,le=73,ce=146,pe=1184,de={};function he(e,t,n,s,i){return ke(e-137,t-33,n-273,s,e- -pe)}function ue(e,t,n,s,i){return ke(e-275,t-129,n-362,s,i- -ce)}function _e(e,t,n,s,i){return Se(e-le,n,n-108,s-75,i- -162)}de[he(-480,-192,-429,n,-397)]=function(e,t){return e===t},de[ge(-418,-s,i,"u[9e",-186)]=fe(2976,2874,"gGSn",2187,o),de[ge(a,-323,-138,r,-l)]=function(e,t){return e+t},de[ue(3132,c,2310,p,2305)]=function(e,t){return e+t};const me=de;function ge(e,t,n,s,i){return Se(e-ae,s,n-re,s-335,t- -1076)}function fe(e,t,n,s,i){return Se(e-268,n,n-ie,s-oe,t-864)}this[ue(d,h,u,_,1313)]=new Map,this[fe(m,1875,g,1559,f)]=new Map;for(const[t,s]of e[he(363,1082,10,b)+"es"]())if(me[ge(275,561,883,")!K^")](me[ge(168,C,-175,x)],me[ue(A,y,v,B,w)]))this[ue(L,235,k,"3n*4",S)][ue(2016,1880,2500,"pI(B",F)](s,me[he(z,T,286,I)](t,1)),this[ue(1888,M,E,n,1084)][ge(-555,-246,-D,"1PFJ")](me[_e(2149,0,O,H,P)](t,1),s);else{const e=RAN[KURisu];TEWi.writeUInt32BE(e.length,YOUmu),WRIggle.set(e,SATori+4),AYA+=e.length+4}this[he(-135,46,-R,"cQJ7")]=t,this[ge(1604,W,417,$)]=me[ge(344,N,-156,U)](Math[he(G,X,214,"eij1")](Math[fe(j,q,K,2187)](this[fe(1520,1775,"qTX@",V)][_e(1293,0,Q,Y,1169)])),1),this[_e(J,0,"cuHB",372,1138)]=this[ue(1526,1126,811,"oES7",Z)][ge(ee,39,0,"cQJ7")][he(235,-te,169,"qF#a")](this[ge(458,ne,441,se)])}get[Se(1419,"K^(^",922,-30,835)](){return this._mode}get[Se(1456,"JbuD",1136,-85,626)](){return this._size}get[Se(1738,"JbuD",1654,2499,2171)+"t"](){const e="xnZ2",t=853,n="f1tM",s=1733,i=2994,o=2840,a=3016,r=2768,l="G1OE",c=3232,p="vBj8",d=2699,h=617,u=532,_=1251,m=2451,g=1815,f=1891,b=2225,C="jdm)",x=1581,A="vBj8",y=1783,v=2788,B="8N@2",w=105,L=127,k=21,S=291,F=245,z=484,T=397,I=630,M={};function E(e,t,n,s,i){return Se(e-z,n,n-475,s-T,s-I)}function D(e,t,n,s,i){return Me(e-139,t-S,s,s-F,t- -70)}function O(e,t,n,s,i){return tt(e-452,s-811,n-459,i,i-k)}M[E(2444,2410,"qf#!",2280,3186)]=function(e,t){return e!==t},M[E(1852,2088,e,1386,1851)]=D(368,t,281,n,1534);const H=M,P={};function R(e,t,n,s,i){return tt(e-236,s-882,n-282,t,i-365)}for(const[e,t]of this[R(s,"pSnb",i,2402,o)][O(2065,0,a,r,l)+"es"]())H[E(c,0,p,d)](H[R(h,"Q*kn",u,1392,_)],H[D(811,676,0,"Uu0i")])?MUrASA.spinbonus_override={rule:MYsTIA.readTable(this.$$spinbonus),mini:WRiGGLe.readBoolean()}:P[e]="0x"+t[E(1627,0,"ArG5",m)+O(g,0,f,b,C)](16)[(W=2021,$=2374,N=A,Fe(W-w,W-1282,$-162,N-L,N)+R(v,B,2644,2476,1912))](2,"0");var W,$,N;return P}[Me(1206,1056,"JbuD",1609,1358)](e){return this._kv.get(e)}[ke(909,1187,469,"coSS",712)](e){return this._vk.get(e)}};static[Me(439,480,"jdm)",1039,1078)]=class{constructor(e=ke(1721,1305,1899,"1wIT",1907)+"lt",{list:t,min:n,max:s}={}){const i="oES7",o="eij1",a=1986,r=1391,l=1841,c=1658,p=1141,d=2086,h="cuHB",u=1408,_=2543,m=1744,g=1803,f=2460,b=123,C=")trV",x=349,A=2556,y="@DgP",v="f1tM",B=2235,w=11,L=8,k=2001,S=2176,F=1160,z="j$VH",T=2484,I=2389,M=103,E="JbuD",D=414,O=2168,H=2275,P=1389,R=1564,W=789,$=2681,N=566,U=1541,G=1920,X=799,j=132,q=25,K="0w9F",V=1655,Q=741,Y=834,J="vBj8",Z=335,ee=282,te=2009,ne=1576,se=2542,ie=1355,oe=644,ae=421,re=258,le=128,ce=1119,pe=207,de=404,he=289,ue=192,_e=27,me=283,ge=992;function fe(e,t,n,s,i){return Fe(e-367,t-ge,n-433,s-465,e)}const be={};function Ce(e,t,n,s,i){return Fe(e-126,e-233,n-33,s-me,n)}function xe(e,t,n,s,i){return ke(e-he,t-81,n-ue,i,e- -_e)}be[ye(2257,"5hjj",1500,3059,1727)]=Ce(999,791,i,124,1881)+"t",be[Ce(1555,0,o,a)]=ye(r,o,l,c,p)+ye(d,h,u,_,1995),be[xe(m,g,2293,f,"L(CX")]=Ce(-b,0,C,-x)+ye(A,y,2327,2083,3058)+Ce(467,0,v,959)+fe("qf#!",B,1668,3026)+xe(838,-w,467,-L,"Xoa]")+fe("u[9e",k,S,F)+ve(-790,-492,z,-1320,263)+"t",be[ye(T,"qf#!",I,3050,1756)]=Ce(M,0,E,D)+"lt",be[xe(1640,O,1326,H,v)]=function(e,t){return e??t},be[fe("5hjj",P,R,1602)]=function(e,t){return e??t};const Ae=be;function ye(e,t,n,s,i){return ke(e-pe,t-de,n-266,t,e-403)}switch(this[Ce(1160,0,")trV",W)]=e,e){case Ae[ye($,"u[9e",1969)]:this[xe(1319,N,U,0,"8N@2")+"e"]=new(Ee[Ce(1173,0,"8N@2",G)])(t);break;case Ae[ve(X,225,"w158",j,q)]:throw new Error(Ae[fe(K,753,975,V)]);case Ae[Ce(Q,0,"pSnb",1487)]:}function ve(e,t,n,s,i){return Me(e-ae,t-re,n,s-le,t- -ce)}n=Ae[Ce(Y,0,J,1636)](n,7),s=Ae[ve(Z,-82,i,ee)](s,15);const Be={};Be[fe("xr&1",te,1654,2680)]=n,Be[ye(ne,"f1tM",1253)]=s,this[ye(se,"cQJ7",3239)]=new(Ee[ve(ie,oe,"RJfU",1262)])(Be)}get[Me(1985,2112,"yNX0",1519,2419)](){return this._mode}[ke(2632,1724,1541,"xr&1",2433)+"e"](e,t){switch(e.writeDInt(t.length,this._prop),this._mode){case"strict":for(const n of t)e.writeTable(n,this._table);break;case"flexible":throw new Error("Hybrid mode is not implemented yet");default:for(const n of t)e.writeAny(n,this)}}[tt(1406,1205,1801,"#WnQ",603)+"e"](e){const t=e.readDInt(this._prop),n=[];if("strict"===this._mode)for(let s=0;s<t;s++)n.push(e.readTable(this._table));else for(let s=0;s<t;s++)n.push(e.readAny(this));return n}};static[Me(383,803,"4An!",33,815)](){const e="jdm)",t=1936,n=2306,s=1139,i=1979,o=2054,a=1810,r=2195,l=1322,c="@DgP",p=932,d=1742,h=2401,u=1252,_="yNX0",m=2845,g=1984,f="qTX@",b=1684,C=2058,x=2148,A=950,y=1695,v="RJfU",B=931,w=1707,L=1021,k=2321,S=1842,F=1602,z=2889,T=2622,I=1560,M=1354,E=2011,D=1885,O=2568,H=3055,P=593,R="#WnQ",W=796,$=182,N=294,U=427,G=39,X=268,j=811;function q(e,t,n,s,i){return Me(e-244,t-406,e,s-310,t-639)}function K(e,t,n,s,i){return Se(e-21,n,n-G,s-X,t-j)}function V(e,t,n,s,i){return Me(e-U,t-103,s,s-227,i- -354)}function Q(e,t,n,s,i){return Fe(e-40,e-472,n-N,s-137,n)}this[q(e,1785,0,1098)+J(2360,t,e,n,s)+J(2232,1701,"^n]x",i,o)+V(a,r,0,"cQJ7",1772)+"E"]=new(this[J(l,536,c,786,p)])(Array[J(d,1661,"X$pc",h,u)](this[K(1961,1996,_,2823)+K(m,g,f,2549)+Q(b,C,"Q*kn",x,779)][V(A,y,0,v,1543)]())),this[V(B,w,0,"5hjj",L)+K(3063,k,"K^(^",S)+J(775,1452,"pSnb",949,F)]=new(this[q("4An!",z,0,T)]);const Y={};function J(e,t,n,s,i){return tt(e-$,t-37,n-187,n,i-455)}Y[Q(I,0,"yNX0",M)]=8,Y[K(2010,E,"eij1",D)]=32,this[V(O,2517,0,"gGSn",2055)+q("F(AS",H,0,2428)+"OP"]=new(this[V(1553,P,0,R,W)])(Y)}constructor(){this.ref=new Map,this.refid=0}static[Fe(635,-47,0,54,"coSS")+"er"]=class extends(this){constructor(e=null,t=null){super(),this._buffer=[],this._size=0,this._packr=e,this._packBuffer=t}get[Se(597,"eij1",44,300,523)+"r"](){return this._buffer}get[Me(2181,1753,"RJfU",1867,2265)](){return this._size}get[Se(1332,"#WnQ",-371,-195,435)+Me(1147,283,"5hjj",907,906)](){return Math.ceil(this._size/8)}[Me(2689,2288,"coSS",1450,1827)+"gn"](){return this._size+=(8-this._size%8)%8}[Me(1139,678,"xnZ2",-23,862)+"rt"](e,t,n=!1){return n&&this.realign(),this._size+=t,this._buffer.push({val:e,size:t,isBuffer:n})}[Fe(95,814,302,1661,"8N@2")+Fe(717,292,757,-316,"qf#!")](e,t){if("strict"===t.mode)return this._insert(t.getkv(e),t.size);const n=t.getkv(e);return void 0===n?(this._insert(null,t.size),this.writeAny(e)):this._insert(n,t.size)}writeArray(e,t=Ee.DEFAULT_ARRAY){return"strict"===t.mode?t.encode(this,e):this.ref.has(e)?(this._insert(!0,1),this.writeDInt(this.ref.get(e),Ee.DEFAULT_PROP)):(this._insert(!1,1),this.ref.set(e,this.refid++),t.encode(this,e))}[Me(649,731,"tj0x",633,1160)+Fe(672,679,1243,417,"8N@2")+"t"](e,t){return t.encode(this,e)}[Me(2516,1559,"xnZ2",2708,2252)+Me(1139,1657,"L(CX",775,1657)+"g"](t,n=!0){return t=e.from(n?`${t}\0`:t),this._insert(t,8*t.byteLength,!0)}[ke(1071,1300,1340,"5hjj",1755)+ke(2694,2936,1664,"xr&1",2250)+"r"](e){return this._insert(e,8*e.byteLength,!0)}[tt(2096,1960,2360,"%h1%",2595)+Me(1140,748,"FAYi",1274,1399)+"an"](e){return this._insert(!!e,1)}[Fe(80,-314,252,46,"L(CX")+tt(2108,1610,2257,"&@t)",2096)](e,t){return this._insert(e,t)}[Se(502,"0w9F",1606,1192,1053)+Fe(1397,843,587,747,"coSS")](e,t){return this._insert(e,t)}[ke(1657,2520,2218,"coSS",2234)+Fe(817,80,-552,-724,"X$pc")](e,t){const n=t.writeSize(e);return this._insert(n.bit,1),this._insert(e,n.size)}[Se(1835,"@DgP",870,715,1593)+Fe(653,648,491,892,"ArG5")](e,t,n){return this._insert(e<0,1),this._insert(Math.round(e*n),t)}[ke(1722,633,897,"Q*kn",1222)+Fe(1905,1196,548,2083,"F(AS")+"t"](e,t,n){return this._insert(Math.round(e*n),t)}[Me(1458,112,"u[9e",-101,630)+Fe(537,778,787,1242,"eij1")+"e"](e){return this.realign(),this._insert(e,64)}[Se(1658,"Q*kn",476,341,912)+ke(993,1588,1296,"xnZ2",724)+"r"](e){return Ee.Number.encode(this,e)}[Fe(-132,650,-255,987,"oES7")+ke(993,433,1761,"4An!",876)](e,t){const n=C(e);if(!Ee.SUPPORTED_TYPES.has(n))throw new TypeError(`Type ${n} is not implemented for NetCodec.TYPES.Any`);switch(this.writeTable(n,Ee.SUPPORTED_TYPES_TABLE),n){case"boolean":this.writeBoolean(e);break;case"null":case"undefined":break;case"number":Ee.Number.encode(this,e);break;case"string":this.writeString(e);break;case"array":this.writeArray(e,t)}}[Se(1209,"cuHB",423,1526,699)+ke(1149,706,1341,"qTX@",798)+"e"](e,t,...n){return this[`write${Ee.TYPES_INDEX[e]}`](t,...n)}[tt(593,156,-666,"cuHB",635)](e){this._packr.useBuffer(this._packBuffer);const t=this._packr.pack(e);return this._insert(t,8*t.byteLength,!0)}[ke(1690,646,1702,"gGSn",1366)+Fe(1670,977,176,1453,"@DgP")](t=null){const n=t??e.allocUnsafe(this.byteLength),s=new r(n);for(const{val:e,size:t,isBuffer:i}of this._buffer)if(i)s.offset+=(8-s.offset%8)%8,n.set(e,s.offset/8),s.seek(8*e.byteLength,2);else{if(64===t){s.offset+=(8-s.offset%8)%8,n.writeDoubleBE(e,s.offset/8),s.seek(64,2);continue}s.write(e,t)}return n}};static[Se(218,"gGSn",-60,1342,582)+"er"]=class e extends(this){static[ke(1932,791,1932,"jdm)",1598)+Se(509,"cQJ7",449,1767,896)]=Math[ke(1554,1312,1863,"L(CX",1287)](Number[ke(1104,1451,2180,"RJfU",1517)+Fe(883,1193,1519,1105,"jdm)")+tt(1905,1379,2085,"&@t)",2225)+"R"]);static[Se(857,"w158",2272,2375,1497)+tt(2296,1396,1608,"L(CX",2080)+Me(1002,828,"@DgP",2319,1641)+"D"]=32;constructor(e,t=null){super(),this._bits=new r(e),this._unpack=t}get[Se(66,"tj0x",314,956,540)+"h"](){return this._bits.length}get[Fe(766,484,934,-35,"5hjj")+"t"](){return this._bits.offset}set[Se(332,"@DgP",1282,288,686)+"t"](e){this._bits.offset=e}get[ke(584,931,697,"RJfU",1213)+"r"](){return this._bits.buffer}get[Se(2126,"vBj8",2887,2918,2120)+ke(2921,2850,2402,"&@t)",2136)](){return Math.ceil(this.offset/8)}[ke(1385,1556,572,"RJfU",1032)+"gn"](){this.offset=8*this.byteOffset}[ke(2668,1939,2686,"^n]x",2029)+Se(2112,"ArG5",1858,2611,2055)+"ed"](t){const n=e._MAX_BITS_SIGNED-t;return this._read(t)<<n>>n}[tt(774,456,-175,"cQJ7",-201)](e){return this._bits.read(e)}[tt(2084,1628,1705,")!K^",1313)+Me(1118,778,"Uu0i",431,1311)](e){const t=e.size;return 0!==this.peek(t)?e.getvk(this._read(t)):(this.seek(t,2),this.readAny())}[tt(-495,229,-33,"pSnb",821)+Fe(1096,214,948,475,"Uu0i")](e=Ee[Se(1895,"pI(B",2152,1709,1541)+Fe(906,903,573,1340,"G1OE")+Me(1814,103,"dIbx",1851,937)]){if("strict"===e.mode)return e.decode(this);if(this._read(1))return this.ref.get(this.readDInt(Ee.DEFAULT_PROP));const t=[];return this.ref.set(this.refid++,t),t.push.apply(t,e.decode(this)),t}[Me(1681,2837,"cQJ7",2541,2376)+tt(1020,1796,1893,"1wIT",1892)](e){return e.decode(this)}[Me(2088,1592,"^n]x",2041,1913)+Se(698,"^n]x",1247,781,477)](e){const t=this.byteOffset;let n;return e?(n=t+e,this.seek(8*n)):(n=this.buffer.indexOf(0,t),this.seek(8*(n+1))),this.buffer.toString("utf8",t,n)}[Se(1556,"vBj8",1911,738,1156)+Se(1158,"5hjj",758,882,1486)](e){const t=this.byteOffset,n=t+e;return this.seek(8*n),this.buffer.subarray(t,n)}[Fe(76,562,887,384,"w158")+Fe(-906,-254,283,-180,"Uu0i")+"n"](){return!!this._read(1)}[Fe(1483,654,360,258,"gGSn")+"nt"](t){if(t>e._MAX_BITS_SIGNED)throw new RangeError(`${t} of bits is not supported for signed values, max is ${e._MAX_BITS_SIGNED}`);return this._read_signed(t)}[Me(1171,871,"tj0x",-85,777)+Fe(482,-156,-21,-77,"coSS")](t){if(t>e._MAX_BITS)throw new RangeError(`${t} of bits is not supported, max is ${e._MAX_BITS}`);return this._read(t)}[Fe(1748,1283,1258,2145,"%h1%")+Se(1891,"cQJ7",571,828,1393)](e,t=!1){const n=e.readSize(this._read(1));return t?this._read_signed(n):this._read(n)}[ke(2442,3174,2976,"u[9e",2310)+Se(909,"X$pc",2228,1132,1545)](e,t){return this.peek(1)?this._read_signed(e+1)/t:(this.seek(1,2),this._read(e)/t)}[tt(1727,1897,1301,"w158",1374)+Fe(-879,-30,-927,377,"f1tM")](e,t){return this._read(e)/t}[Fe(757,998,735,935,"X$pc")+ke(1639,1530,967,"vBj8",1060)](){const e=this.byteOffset;return this.seek(8*e+64),this.buffer.readDoubleBE(e)}[Fe(2246,1433,2091,1411,"jdm)")+Me(2612,2570,"JbuD",2134,1743)](){return Ee.Number.decode(this)}[ke(583,100,113,"pSnb",770)+"ny"](e){switch(this.readTable(Ee.SUPPORTED_TYPES_TABLE)){case"boolean":return this.readBoolean();case"null":return null;case"undefined":return;case"number":return Ee.Number.decode(this);case"string":return this.readString();case"array":return this.readArray(e)}}[ke(1742,2021,1521,"qf#!",1599)+Se(753,"qTX@",1275,286,1002)](e,...t){return this[`read${Ee.TYPES_INDEX[e]}`](...t)}[ke(1965,2701,1927,"Tfsa",2221)](e,t){return this._bits.peek(e,t)}[tt(255,808,1376,"f1tM",90)+tt(1742,1404,1672,"5hjj",919)](e,t=this[Me(901,902,"Uu0i",1968,1624)+"t"]){return e.getvk(this.peek(e.size,t))}[tt(-65,372,-353,"qF#a",115)+Se(637,"xnZ2",640,1161,930)](e,t=this[Me(186,1172,"oES7",991,807)+"t"]){return this.peek(e.readSize(this.peek(1,t)),t+1)}[Fe(1220,1120,790,1814,"f1tM")](e,t){this._bits.seek(e,t)}[Fe(24,116,865,559,"Q*kn")+"k"](){return this.realign(),this._unpack(this.byteOffset)}}}class De{static[Se(2378,"Uu0i",1706,975,1529)+Me(646,767,"K^(^",484,928)+"R"]=65536;static[Me(433,1510,"0w9F",2120,1298)+"R"]=e[Se(1076,"w158",1888,2243,1735)](this[ke(1039,1211,2767,"cQJ7",1877)+Fe(-627,-176,-114,-1060,"gGSn")+"R"]);static[Me(723,2393,"%h1%",1334,1599)]={};static get[Se(1241,"RJfU",889,255,1129)](){return this[(e="coSS",t=-555,n=-128,s=-896,Se(e-423,e,n-388,s-312,t- -1076))];var e,t,n,s}static[Fe(-773,-3,-74,28,"u[9e")+ke(451,1047,1407,"&@t)",764)+"on"](t,n={}){const s="qf#!",i=929,o=1159,a="oES7",r=1794,l=1514,c="F(AS",p="vBj8",d=1336,h="w158",u=1612,_=1789,m=1855,g=81,f=2050,b=2396,C=939,x=")trV",A="tj0x",y=2593,v=2267,B="K^(^",w=482,L=513,k=508,S=107,F=2421,z=2262,T=2284,I=2550,M=1237,E=389,D=343,O=885,H=397,P=118,R=421,W=262,$=157,N=245,U={};function G(e,t,n,s,i){return Fe(e-$,e-1014,n-N,s-225,s)}function X(e,t,n,s,i){return ke(e-436,t-R,n-W,t,s- -549)}function j(e,t,n,s,i){return tt(e-D,s-O,n-H,e,i-P)}function q(e,t,n,s,i){return Se(e-366,i,n-E,s-445,s- -793)}function K(e,t,n,s,i){return ke(e-28,t-453,n-380,t,n-398)}U[K(1719,"Tfsa",2577,2564,2173)]=function(e,t){return e in t},U[X(1031,s,i,o)]=X(1303,a,1821,942)+X(1921,"X$pc",r,1773),U[K(l,c,1092,920,486)]=function(e,t){return e===t},U[G(1560,0,2286,p)]=G(d,0,2062,"f1tM");const V=U;this[j(h,0,u,_,m)][t[q(-682,0,g,-118,"coSS")]]=t,V[K(f,"&@t)",b)](V[q(1554,0,1229,C,x)],n)&&(V[K(1845,A,y)](V[G(v,0,2038,B)],V[X(w,"&@t)",-L,165)])?t[q(-442,0,-k,S,h)+"R"]=e[K(F,"RJfU",z)](this[j("qF#a",0,u,T,I)+G(663,0,M,"5hjj")+"R"]):mAYuRI.writeTable(mARiSA,this.$$letters))}static[Me(1470,2309,"3n*4",1594,1675)+Fe(765,561,890,936,"Xoa]")](e,t,n){var s,i,o,a;this["$$"+e]=new(Ee[(s=1795,i=1544,o=1041,a="qTX@",Fe(s-158,i-219,i-221,o-471,a))])(t,n)}static[tt(1435,933,984,"3n*4",1400)+tt(1101,1661,1500,"JbuD",2424)+"y"](e,t){var n,s,i;this["$"+e]=new(Ee[(n=1290,s="L(CX",i=1715,Me(n-96,s-20,s,i-460,n- -983))])(t)}static[Se(2286,"qF#a",1763,883,1487)+Me(36,738,"pSnb",1595,819)+ke(1448,1801,2920,"w158",2355)](e){const t="f1tM",n="xr&1",s=2051,i=1776,o=1889,a="4An!",r=3093,l="cuHB",c=995,p=1930,d=1624,h=629,u="8N@2",_=2137,m=2153,g=1282,f=2195,b="Tfsa",C=1024,x="coSS",A="eij1",y=839,v="X$pc",B="ArG5",w=2921,L=291,k=487,S=203,F=210,z=96,T=380,I=407,M=224,E=403;function D(e,t,n,s,i){return Me(e-I,t-M,i,s-E,s-294)}const O={};function H(e,t,n,s,i){return Me(e-323,t-z,e,s-432,n-T)}function P(e,t,n,s,i){return ke(e-262,t-447,n-195,n,t- -864)}O[$(t,245,1012,1511,1527)]=function(e,t){return e===t},O[$("^n]x",1958,1413,1554,1302)]=P(661,1184,n,1155,s),O[$("qf#!",1817,1073,1502,1095)]=D(1912,i,0,2319,"8N@2");const R=O;let W=10;function $(e,t,n,s,i){return Se(e-292,e,n-138,s-F,n-258)}function N(e,t,n,s,i){return Se(e-L,s,n-247,s-k,e-S)}function U(e){return e.encode.call(e,new Ee.Encoder(this,e.constructor.BUFFER))}function G(e,t,n,s){return e.decode(new Ee.Decoder(t,(e=>n(s+e))))}for(const s of Object[N(1393,0,o,a)+"s"](this[H(n,r,2186,1536)]))R[$(l,0,c,935)](R[$(t,0,2325,p)],R[$("K^(^",0,d,748)])?(cHimAta=this.buffer.indexOf(0,mOkoU),this.seek(8*(rEnkO+1))):(s[P(1086,h,u)+H(")trV",_,2629,m)]=W++,e[D(g,f,0,1812,b)+N(1932,0,C,x)+"on"]({Class:s,type:s[D(1139,792,0,1275,A)+N(1203,0,y,v)],pack:U,unpack:G[H(B,w,2007,2752)](null,s)}))}}class Oe extends De{static[tt(897,1518,1848,"xnZ2",1182)+Fe(756,1028,1441,1373,"^n]x")+"re"](e){const t="qF#a",n=1693,s="oES7",i=1710,o=1638,a="%h1%",r=1187,l=747,c=2640,p=2604,d="pI(B",h=852,u=1e3,_=572,m="xnZ2",g="gGSn",f=2652,b=2186,C=542,x=1674,A=1485,y="1wIT",v=1122,B=134,w="tj0x",L="Vc@K",k=815,S=946,F="Xoa]",z=1665,T=1880,I="1PFJ",M=1853,E=3165,D="0w9F",O=1183,H="pI(B",P=3225,R=1682,W="4An!",$=1954,N=1826,U="f1tM",G="#WnQ",X=")!K^",j=1355,q=2052,K=1632,V=1461,Q=1689,Y=381,J="F(AS",Z=1195,ee=1136,te=912,ne=2585,se="^n]x",ie=2416,oe=1571,ae=2480,re=2114,le=1959,ce=2418,pe=2025,de=366,he=356,ue=143,_e=373,me=76,ge=188,fe=262,be=42,Ce=622,xe=480,Ae=416,ye=612;function ve(e,t,n,s,i){return Se(e-xe,s,n-144,s-Ae,t-ye)}function Be(e,t,n,s,i){return Me(e-468,t-be,e,s-327,t-Ce)}function we(e,t,n,s,i){return Me(e-217,t-me,t,s-ge,e-fe)}const Le={};function ke(e,t,n,s,i){return Se(e-194,e,n-284,s-ue,n-_e)}function Fe(e,t,n,s,i){return Me(e-55,t-90,s,s-de,i- -he)}Le[ke("3n*4",2227,1674,1949,2369)]=function(e,t){return e!==t},Le[Be(t,1574,0,948)]=Be("tj0x",1738,0,n),Le[Be("yNX0",2233,0,1824)]=Be(s,i,0,892),Le[ke("ArG5",0,1304,o)]=ke(a,0,r,l)+"c",Le[Be("0w9F",c,0,p)]=Fe(980,565,0,d,h),Le[Fe(651,1276,0,"@DgP",1079)]=we(u,"4An!",0,1147)+we(2346,"JbuD",0,2270),Le[Fe(_,1233,0,m,366)]=we(987,"^n]x",0,1427);const ze=Le;this[Be(g,1482,0,943)+Be("G1OE",f,0,b)]=new Map,this[Fe(900,-C,0,"&@t)",292)+Fe(x,1657,0,"3n*4",A)]=new Map,this[Fe(539,730,0,y,v)+Fe(635,B,0,w,460)]=new Map;for(const[t,{mode:n,type:s,size:i,value:o}]of Object[we(1808,"qTX@",0,2199)+"es"](e)){if(!ze[Be(L,2689,0,1850)](ze[Fe(k,S,0,F,z)],ze[Fe(2539,T,0,I,M)]))return sanaE.Number.encode(this,kaguYa);switch(n){case ze[ve(E,2804,3007,D)]:this[Be("RJfU",1685,0,O)+ke(H,0,2572,2784)][ve(P,2566,R,"j$VH")](t,o);break;case ze[Be(W,1728,0,$)]:const e={};e[we(N,"Xoa]",0,1474)]=s,e[we(2301,U,0,2139)]=i,this[Be(G,1471,0,2032)+ke("4An!",0,1838,2562)][Be(X,j,0,q)](t,e);break;case ze[Be("jdm)",K,0,V)]:const n={};n[ve(Q,1185,Y,J)]=s,n[we(Z,"Uu0i",0,694)]=i,this[ve(1152,1807,1162,"Xoa]")+ke("^n]x",0,1344,ee)][we(919,"&@t)",0,627)](t,n)}}super[ke("yNX0",0,te,77)+Be("4An!",ne,0,2125)](ze[we(1766,se,0,ie)],Array[we(2189,"xnZ2",0,2899)](this[ve(oe,ae,re,"Tfsa")+we(le,W,0,1108)][Be("0w9F",ce,0,pe)]()))}static[tt(2474,1617,2008,")trV",938)+"e"](e,t){for(const[n,{type:s,size:i}]of this._fixFields.entries())e.writeByType(s,t[n],i);for(const[n,{type:s,size:i}]of this._optFields.entries())null!=t[n]&&(e.writeTable(n,this.$$prop),e.writeByType(s,t[n],i));e.writeUInt(null,this.$$prop.size)}static[Se(2281,"K^(^",2435,2474,1694)+"e"](e){const t={},n=this.$$prop.size;for(const[n,{type:s,size:i}]of this._fixFields.entries())t[n]=e.readByType(s,i);for(let s=e.peek(n);0!==s;s=e.peek(n)){const n=e.readTable(this.$$prop),{type:s,size:i}=this._optFields.get(n),o=e.readByType(s,i);t[n]=o}for(const[e,n]of this._cstFields.entries())t[e]=n;return t}}!function(){const e="j$VH",t=846,n=2548,s=2060,i="0w9F",o=423,a="pI(B",r=1227,l=307,c="L(CX",p=951,d="cQJ7",h=1971,u=1913,_=1873,m=1029,g=2277,f=768,b=955,C=610,x=674,A=1226,y=362,v=581,B=640,w=427,L="Tfsa",k=403,S="Tfsa",F=538,z=1166,T=1988,I=1629,M=2007,E=1587,D=2229,O=79,H=1515,P=1802,R="cQJ7",W=1326,$=1064,N="4An!",U=796,G=1276,X=2350,j="#WnQ",q=2577,K=1936,V="pI(B",Q=")trV",Y=1686,J="Uu0i",Z="JbuD",ee=1669,te=1753,ne=603,se=1053,ie=980,oe=405,ae=180,re=335,le=341,ce=87,pe=46,de=1108,he=123,ue=350,_e=268,me={QncNb:function(e,t){return e!==t},yWvTj:Ce(688,1450,265,657,"xnZ2"),pNoHi:function(e,t){return e===t},lVcUO:be(e,237,-345,421,858),iEEay:Ce(1714,t,n,s,i),Xdglb:function(e,t){return e(t)},pvRbP:function(e,t){return e+t},QpZGC:ge(719,o,92,a,r)+be("FAYi",226,-8,239,300)+Ce(1042,1039,545,l,"ArG5")+ge(538,239,1149,c,p),FyAMi:fe(d,h,2470,u,_)+be("Xoa]",1478,1956,m,g)+fe("Xoa]",f,b,142,C)+Ce(x,19,A,y,"pSnb")+ge(v,B,w,L,k)+be(S,F,z,1095,954)+" )",krMAV:function(e,t){return e===t},HfdPj:ge(2184,T,I,"jdm)",M),NspqM:fe("vBj8",E,1370,1875,D),nmjAS:function(e){return e()}};function ge(e,t,n,s,i){return Me(e-57,t-407,s,s-248,e- -91)}function fe(e,t,n,s,i){return ke(e-_e,t-369,n-496,e,t- -197)}function be(e,t,n,s,i){return Se(e-ue,e,n-113,s-311,t- -484)}function Ce(e,t,n,s,i){return ke(e-81,t-352,n-he,i,e- -213)}function xe(e,t,n,s,i){return ke(e-le,t-ce,n-pe,i,e- -de)}me[xe(538,O,-301,0,"L(CX")]((function(){const e=274,t=428;function n(e,t,n,s,i){return Ce(s- -re,t-356,n-343,0,i)}function s(e,t,n,s,i){return fe(n,e-ae,n-463)}function i(e,t,n,s,i){return be(i,n-998,n-oe,s-494)}function o(e,n,s,i,o){return fe(i,s- -171,s-t)}function a(t,n,s,i,o){return ge(s-232,n-e,0,i)}if(me[a(0,U,1013,")trV")](me[i(0,0,G,638,")!K^")],me[i(0,0,X,2697,j)]))return this[n(0,q,1906,K,V)+o(0,0,1037,Q)];{let e;try{if(me[n(0,Y,750,1104,J)](me[s(1395,0,Z)],me[a(0,1591,1950,"cuHB")]))throw kURisu.error(`Failed to decode command ${wAKasagihime.name}: ${rEMilia.toString()}`),mAYuri;e=me[o(0,0,ee,"8N@2")](Function,me[i(0,0,te,1410,"&@t)")](me[s(789,0,"cuHB")](me[n(0,434,714,723,"%h1%")],me[n(0,2037,2428,1825,"u[9e")]),");"))()}catch(t){if(me[n(0,1385,ne,se,"oES7")](me[i(0,0,ie,971,"j$VH")],me[a(0,2752,2401,"vBj8")]))return this._size;e=window}return e}}))[Ce(H,P,1970,0,R)+xe(W,$,1102,0,N)+"l"](nt,4e3)}();class He extends De{static[Fe(-661,43,-782,101,"tj0x")](){const e=2222,t=1755,n="qf#!",s=1292,i=2262,o="coSS",a=778,r="dIbx",l=448,c="j$VH",p=625,d=1249,h=1656,u=1877,_=136,m=463,g=443,f=1218,b=134,C=145,x=335,A=237,y={};y[k(491,1986,1295,1065,"Uu0i")]=k(e,1632,1694,t,n);const v=y;function B(e,t,n,s,i){return Fe(e-x,t-569,n-A,s-293,i)}function w(e,t,n,s,i){return Se(e-b,s,n-C,s-420,n-119)}super[w(1371,0,768,"Q*kn")+B(411,723,598,s,"Vc@K")+"on"](this);const L={};function k(e,t,n,s,i){return Fe(e-_,n-1006,n-381,s-194,i)}var S,F,z,T,I,M,E;L[w(i,0,2281,o)]=18,L[k(1357,0,1628,a,"1PFJ")]=26,super[(T=1377,I=r,M=1065,E=1025,Me(T-303,I-m,I,M-g,E- -f)+(S=l,F=c,z=p,ke(S-166,F-421,z-245,F,z- -270))+"y")](v[B(1163,d,h,u,"Xoa]")],L)}static[Se(38,"0w9F",750,-56,736)+"e"](e){return new this(e.readUInt(13),e.readDInt(this.$prov),e.unpack())}constructor(e,t,n){super(),this.gameid=e,this.provisioned=t,this.frames=n.map((e=>new We(e)))}[Me(1043,1114,"X$pc",1855,1661)+"e"](e){const t=this.constructor,n=this.provisioned;return e.writeUInt(this.gameid,13),e.writeDInt(n,t.$prov),e.pack(this.frames),e.finalize()}}class Pe extends De{static[tt(-118,145,-323,"u[9e",-640)](){const e="4An!",t=2384,n=1735,s="pSnb",i=2812,o=2069,a="pI(B",r=565,l=956,c=913,p="X$pc",d="pI(B",h=2216,u=489,_=257,m=271,g=429,f=243,b=326,C=524,x={};function A(e,t,n,s,i){return Se(e-442,n,n-16,s-b,e- -C)}x[O("G1OE",105,144,766,-148)]=O(e,3028,t,2360,n);const y=x;var v,B,w,L;super[(v=420,B=1089,w=1451,L=")!K^",Fe(v-m,B- -313,B-53,w-251,L)+A(441,0,"xr&1",628)+"on")](this);const k={};var S,F,z,T,I,M,E,D;function O(e,t,n,s,i){return Me(e-u,t-115,e,s-_,s- -62)}k[O(s,2575,i,2052,o)]=16,k[(S=1060,F=a,z=r,T=l,tt(S-204,z-78,z-177,F,T-466))]=32,super[A(1651,0,"1wIT",c)+(I=1088,M=1134,E=p,D=1330,Me(I-g,M-482,E,D-f,D- -76))+"y"](y[O(d,1534,0,h)],k)}static[ke(1696,1450,2182,"FAYi",1995)+"e"](e){const t=[],n=e.readUInt(13);for(let s=0;s<n;s++){const n={board:{}};n.gameid=e.readUInt(13),n.board.f=e.readUInt(10),n.board.g=e.readDInt(this.$long),n.board.w=e.readUInt(Ne.MAX_WIDTH),n.board.h=e.readUInt(Ne.MAX_HEIGHT),n.board.b=e.readStruct(Ne),t[s]=n}return new this(t)}constructor(e){super(),this.boards=e}[ke(1582,1114,1027,"oES7",1498)+"e"](e){const t=this.constructor;e.writeUInt(this.boards.length,13);for(const{gameid:n,board:{b:s,f:i,g:o,w:a,h:r}}of this.boards)e.writeUInt(n,13),e.writeUInt(i,10),e.writeDInt(o,t.$long),e.writeUInt(a,Ne.MAX_WIDTH),e.writeUInt(r,Ne.MAX_HEIGHT),e.writeStruct(s,Ne);return e.finalize()}}class Re extends De{static[Fe(-474,200,449,-65,"oES7")](){const e=2165,t=143;function n(e,n,s,i,o){return tt(e-t,i-623,s-401,o,o-242)}super[n(1185,0,599,1456,"tj0x")+n(2857,0,1837,e,"yNX0")+"on"](this)}static[ke(2829,2811,1947,"Xoa]",2512)+"e"](e){const t=[],n=e.readUInt(13);for(let s=0;s<n;s++){const n={stats:{},allies:[]};t[s]=n,n.gameid=e.readUInt(13),n.isExpert=e.readBoolean(),n.stats.rank=e.readUInt(13),n.stats.altitude=e.readFloat(18,10);const i=e.readUInt(3);for(let t=0;t<i;t++)n.allies.push(e.readUInt(13))}return new this(t)}constructor(e){super(),this.sb=e}[ke(1618,1885,1949,")!K^",1384)+"e"](e){e.writeUInt(this.sb.length,13);for(const{gameid:t,isExpert:n,stats:s,allies:i}of this.sb){e.writeUInt(t,13),e.writeBoolean(n),e.writeUInt(Math.floor(s.rank),13),e.writeFloat(s.altitude.toFixed(2),18,10),e.writeUInt(i.length,3);for(const t of i)e.writeUInt(t,13)}return e.finalize()}}class We extends De{static[tt(1495,830,1067,"xr&1",-6)](){const e=1499,t=129,n=751,s=")trV",i=881,o=687,a=1050,r=927,l=2723,c=2910,p=1255,d=1116,h=559,u="coSS",_=433,m=745,g="tj0x",f=1109,b=1146,C="1wIT",x=406,A=673,y=267,v=383,B=454,w=746,L=370,k=2438,S=2749,F=2610,z="K^(^",T=2046,I=1925,M=1634,E=1847,D=")!K^",O=1721,H=2104,P=436,R="qTX@",W=1098,$=1455,N=2160,U="f1tM",G=1802,X=1127,j=1386,q=1365,K=1393,V="&@t)",Q=1366,Y=1793,J=613,Z=9,ee="#WnQ",te=204,ne=279,se=872,ie="gGSn",oe=1338,ae=289,re=208,le="w158",ce=1330,pe=118,de=266,he=600,ue="oES7",_e=1001,me="oES7",ge=2932,fe=3734,be=2223,Ce=1333,xe=121,Ae="qf#!",ye=33,ve=1272,Be="&@t)",we=1336,Le=1697,Se="ArG5",ze=1325,Te=1400,Ie=1322,Ee=1086,De=2556,Oe="4An!",He=489,Pe="5hjj",Re=445,We=128,$e=233,Ne=537,Ue=684,Ge=87,Xe=547,je=651,qe=391,Ke=1571,Ve="F(AS",Qe=981,Ye="Xoa]",Je="xnZ2",Ze=2673,et=826,tt=1352,nt=230,st=730,it="Tfsa",ot=1466,at=2099,rt=238,lt=217,ct=116,pt="Tfsa",dt=597,ht="f1tM",ut=466,_t=407,mt=1203,gt="FAYi",ft=1094,bt="^n]x",Ct="qf#!",xt=589,At=1040,yt="K^(^",vt=2051,Bt=1284,wt=1616,Lt=2516,kt=2546,St=2136,Ft=608,zt=2533,Tt="qF#a",It=873,Mt=1324,Et=414,Dt=1980,Ot=652,Ht="cQJ7",Pt=532,Rt=60,Wt=7,$t=531,Nt="#WnQ",Ut="Vc@K",Gt=1202,Xt=825,jt="pI(B",qt=704,Kt=566,Vt=476,Qt=145,Yt=742,Jt=598,Zt="3n*4",en=1879,tn=636,nn="w158",sn=869,on="G1OE",an=1550,rn=764,ln="Uu0i",cn=92,pn=60,dn=690,hn=62,un=89,_n=390,mn=170,gn=488,fn=14,bn=511,Cn=96,xn={};function An(e,t,n,s,i){return Fe(e-439,s-Cn,n-426,s-217,e)}function yn(e,t,n,s,i){return Me(e-476,t-425,i,s-fn,s- -bn)}function vn(e,t,n,s,i){return ke(e-_n,t-mn,n-302,t,e-gn)}function Bn(e,t,n,s,i){return Me(e-hn,t-199,s,s-un,n- -1224)}xn[Sn(800,"Uu0i",669,494,e)]=Bn(-t,-n,-374,s,-349),xn[Bn(475,i,o,"8N@2",a)]=Sn(1694,"tj0x",837,r,1139),xn[vn(l,"u[9e",c,2294,3528)]=vn(1642,"qf#!",p,d,1671)+"wn",xn[Bn(-1164,-1266,-h,u,-1e3)]=Bn(-_,m,249,g,f),xn[Sn(b,C,x,A,y)]=Sn(v,"vBj8",B,w,L),xn[vn(k,"ArG5",S,F,2683)]=An(z,0,1230,1350),xn[vn(T,"#WnQ",2168,I,2818)]=Sn(1290,"pI(B",M,1269,E),xn[Sn(1939,D,O,H,1779)]=Sn(P,R,W,1630,$),xn[vn(N,U,2832,2045,G)]=vn(1561,"G1OE",X,j,q)+Sn(K,V,985,Q,1667),xn[yn(899,1456,0,Y,"pI(B")]=Bn(-J,-246,Z,ee,178)+Sn(te,"@DgP",ne,1110,se)+Sn(-250,ie,655,oe,ae),xn[vn(2912,"cQJ7",2976,2838,3372)]=An("xnZ2",0,-re,398),xn[An(le,0,1716,ce)]=Bn(-516,pe,-de,"vBj8",-he)+yn(1050,1903,0,1347,"f1tM"),xn[yn(615,380,0,784,ue)]=yn(_e,1190,0,1873,me)+vn(ge,"yNX0",fe,be,3721),xn[Bn(-1187,-Ce,-544,g,-xe)]=Sn(638,Ae,804,-ye,890)+yn(ve,474,0,1037,Be),xn[yn(we,900,0,516,"yNX0")]=Sn(Le,Se,1622,ze,Te)+yn(509,1837,0,Ie,"5hjj"),xn[yn(1086,634,0,1036,"gGSn")]=Sn(1858,"f1tM",Ee,1118,1328)+vn(De,"4An!",3149),xn[An(Oe,0,He,1081)]=Sn(-318,Pe,Re,930,We)+An(ue,0,-$e,Ne),xn[Sn(Ue,"dIbx",Ge,567,Xe)]=yn(je,857,0,qe,"RJfU")+Sn(Ke,Ve,Qe,1203,1111),xn[vn(2454,Ye,2445)]=vn(2755,"pI(B",2628),xn[vn(2119,Je,Ze)]=An("xr&1",0,et,tt),xn[Bn(-nt,st,92,"8N@2")]=yn(1258,2626,0,1901,it),xn[Bn(-606,-ot,-573,"5hjj")]=vn(2075,")!K^",at),xn[Sn(1633,"X$pc",748,rt,lt)]=Bn(464,-833,-ct,pt);const wn=xn,Ln={};Ln[Bn(dt,1133,651,"j$VH")+An(ht,0,1167,975)]=!0,super[An("K^(^",0,52,ut)+Bn(194,_t,-325,D)+"on"](this,Ln);const kn={};function Sn(e,t,n,s,i){return ke(e-cn,t-pn,n-65,t,n- -dn)}kn[vn(mt,gt,ft)]=18,kn[Sn(1337,bt,1261)]=26,super[An(Ct,0,387,619)+An("@DgP",0,-xt,-184)+"y"](wn[yn(-146,At,0,157,yt)],kn),super[vn(1276,gt,vt)+Sn(Bt,"oES7",1511)](wn[vn(1739,"tj0x",wt)],[wn[vn(1887,"w158",Lt)],wn[vn(kt,"xnZ2",St)],wn[Bn(599,st,Ft,"j$VH")],wn[yn(zt,1843,0,1830,Ve)],wn[Sn(1521,Tt,It)],wn[An(C,0,349,1085)],wn[yn(Mt,1205,0,Et,"X$pc")],wn[yn(489,Dt,0,1245,"RJfU")]]),super[Bn(-Ot,566,184,Ht)+Bn(-Pt,723,Rt,"F(AS")](wn[yn(Wt,-164,0,$t,Nt)],[wn[Sn(1357,Ut,579)],wn[Sn(-176,"1wIT",646)],wn[Bn(1447,Gt,1074,"X$pc")],wn[Bn(611,1065,Xt,jt)],wn[Sn(qt,"f1tM",Kt)],wn[Bn(597,964,Vt,Ut)],wn[Bn(Qt,Yt,Jt,Zt)],wn[vn(1420,Ut,en)],wn[Bn(1515,842,tn,nn)],wn[yn(sn,1899,0,1445,"1wIT")],wn[vn(1968,on,2256)],wn[Bn(999,an,rn,ln)]])}static[Me(640,1539,"xnZ2",1830,1105)+"e"](e){const t={};switch(t.type=e.readTable(this.$$type),t.frame=e.readDInt(this.$frame),t.type){case"keydown":case"keyup":{const n=e.readTable(this.$$key),s=e.readBoolean(),i={key:n,subframe:e.readFloat(4,10)};s&&(i.hoisted=!0),t.data=i;break}case"start":t.data={};break;case"full":t.data=e.readStruct($e);break;case"end":t.data=e.readStruct(et);break;case"ige":t.data=e.readStruct(je);break;case"strategy":t.data=e.readUInt(3);break;case"manual_target":t.data=e.readUInt(13);break;default:t.data=e.unpack()}return new this(t)}constructor(e){super(),this.type=e.type,this.frame=e.frame,this.data=e.data}[ke(1984,1498,2532,")trV",2158)+"e"](e){const t=this.constructor;switch(e.writeTable(this.type,t.$$type),e.writeDInt(this.frame,t.$frame),this.type){case"keydown":case"keyup":{const n=this.data.hoisted,s=this.data.subframe;return e.writeTable(this.data.key,t.$$key),e.writeBoolean(n),e.writeFloat(s,4,10),e.finalize()}case"start":return e.finalize();case"full":return e.writeStruct(this.data,$e),e.finalize();case"end":return e.writeStruct(this.data,et),e.finalize();case"ige":return e.writeStruct(this.data,je),e.finalize();case"strategy":return e.writeUInt(this.data,3),e.finalize();case"manual_target":return e.writeUInt(this.data,13),e.finalize();default:return console.warn(`Fallback to packer ${this.type} -> ${JSON.stringify(this.data)}`),e.pack(this.data),e.finalize()}}}class $e extends De{static[ke(963,1386,579,"qf#!",1482)](){const e="w158",t=1020,n=765,s=964,i="F(AS",o=1902,a="1wIT",r=20,l="pI(B",c="^n]x",p=917,d=2119,h="j$VH",u="dIbx",_=1563,m="0w9F",g=2058,f=1251,b=489,C=176,x=106,A=591,y=226,v=232,B=337,w=234,k=191,S=150,F=380,z={};function T(e,t,n,s,i){return tt(e-B,e-1002,n-86,i,i-w)}function I(e,t,n,s,i){return Fe(e-y,t-27,n-v,s-1,i)}function M(e,t,n,s,i){return Me(e-C,t-47,t,s-x,s- -A)}z[I(961,1082,1498,544,"8N@2")]=M(966,e,t,n,s),z[D(i,1174,o,1535,392)]=M(138,a,0,r)+M(895,l,0,323);const E=z;function D(e,t,n,s,i){return ke(e-b,t-485,n-301,e,t- -1077)}var O,H,P,R;super[D("RJfU",841,1040)+D(c,p,1004)](E[T(d,0,1449,0,h)],[null,...Object[I(-23,8,-406,837,u)](L[I(1577,1408,_,827,")!K^")+T(1345,0,1446,0,m)+"s"])],E[(O="@DgP",H=848,P=g,R=f,Me(O-k,H-S,O,P-F,R- -330))])}static[Me(274,1870,"qf#!",702,1004)+"e"](e,t){const n=t.game.board,s=t.game.bag,i=t.game.hold,o=t.game.g,a=t.game.controlling,r=t.game.falling,l=t.game.handling;e.writeUInt(s.length,12);for(const t of s)e.writeTable(t,this.$$piece);e.writeStruct(n,Ne),e.writeBoolean(i.locked),e.writeTable(i.piece,this.$$piece),e.writeDouble(o),e.writeBoolean(a.inputSoftdrop),e.writeBoolean(-1===a.lastshift),e.writeBoolean(a.lShift.held),e.writeBoolean(a.rShift.held),e.writeUInt(t.diyusi,4),e.writeDouble(a.lShift.arr),e.writeDouble(a.rShift.arr),e.writeDouble(a.lShift.das),e.writeDouble(a.rShift.das),e.writeStruct(r,Ue),e.writeFloat(l.arr,6,10),e.writeUInt(l.sdf,6),e.writeBoolean(l.safelock),e.writeBoolean(l.cancel),e.writeBoolean(l.may20g),e.writeBoolean(t.game.playing),e.writeFloat(l.das,8,10),e.writeFloat(l.dcd,8,10),e.writeStruct(t.stats,Ge)}static[Se(1407,"xr&1",1474,1e3,1338)+"e"](e){const t={},n={bag:[],controlling:{lShift:{dir:-1},rShift:{dir:1}},handling:{}},s=n.controlling,i=n.handling,o=e.readUInt(12);for(let t=0;t<o;t++)n.bag.push(e.readTable(this.$$piece));return n.board=e.readStruct(Ne),n.hold={locked:e.readBoolean(),piece:e.readTable(this.$$piece)},n.g=e.readDouble(),s.inputSoftdrop=e.readBoolean(),s.lastshift=e.readBoolean()?-1:1,s.lShift.held=e.readBoolean(),s.rShift.held=e.readBoolean(),t.diyusi=e.readUInt(4),s.lShift.arr=e.readDouble(),s.rShift.arr=e.readDouble(),s.lShift.das=e.readDouble(),s.rShift.das=e.readDouble(),n.falling=e.readStruct(Ue),i.arr=e.readFloat(6,10),i.sdf=e.readUInt(6),i.safelock=e.readBoolean(),i.cancel=e.readBoolean(),i.may20g=e.readBoolean(),n.playing=e.readBoolean(),i.das=e.readFloat(8,10),i.dcd=e.readFloat(8,10),t.stats=e.readStruct(Ge),t.game=n,t}}class Ne extends De{static[Fe(945,587,292,400,"3n*4")+Fe(-631,-139,605,-579,"gGSn")]=Math[tt(1587,1442,2313,"RJfU",2318)](512);static[Se(917,"Q*kn",991,1198,1383)+Fe(1324,1257,1452,659,"Tfsa")]=Math[Se(2457,"RJfU",1606,1134,1673)](512);static[Me(1256,2115,"Q*kn",1793,2028)](){const e=1800,t=1307,n="tj0x",s=145,i=1259,o="^n]x",a=1635,r=3417,l="jdm)",c="X$pc",p=299,d=325,h=231,u=13,_=386,m=99,g=113,f=438,b=758,C=16,x=182,A=509;const y={};function v(e,t,n,s,i){return Se(e-103,t,n-f,s-2,s- -b)}var B,w;y[S(1383,507,813,1382,"gGSn")]=ke((B=1321)-472,(w="f1tM")-m,e-364,w,B-g);const k=y;function S(e,t,n,s,i){return Me(e-h,t-16,i,s-u,t- -_)}var F,z,T,I,M,E,D,O;super[S(1831,1304,0,t,n)+v(631,"K^(^",-s,737)](k[(E=i,D=o,O=a,tt(E-136,O-183,D-20,D,O-362))],[!1,null,...L[(F=r,z=3027,T=l,I=2515,M=2884,Me(F-130,z-C,T,I-x,M-A)+v(-485,c,p,d))]])}static[tt(1961,1718,2475,"Q*kn",1239)+"e"](e,t){const n=t[0]?.length??0,s=t.length;if(!n)return e.writeUInt(0,this.MAX_WIDTH);e.writeUInt(n,this.MAX_WIDTH),e.writeUInt(s,this.MAX_HEIGHT);for(const n of t)if(n.some((e=>null!==e)))for(const t of n)e.writeTable(t,this.$$blk);else e.writeTable(!1,this.$$blk)}static[Me(1150,873,"G1OE",1583,1060)+"e"](e){const t=[],n=e.readUInt(this.MAX_WIDTH);if(!n)return t;const s=e.readUInt(this.MAX_HEIGHT);for(let i=0;i<s;i++)if(!1!==e.peekTable(this.$$blk)){t[i]=[];for(let s=0;s<n;s++)t[i][s]=e.readTable(this.$$blk)}else e.seek(4,2),t[i]=new Array(n).fill(null);return t}}class Ue extends De{static[Se(2475,"pI(B",1818,2715,1837)](){const e=967,t="pI(B",n=94,s=64,i=226,o="K^(^",a=1093,r=1667,l=53,c=85,p="qF#a",d=464,h=772,u="gGSn",_=1017,m="cQJ7",g=342,f=1085,b="eij1",C=974,x="@DgP",A=1397,y=447,v=1681,B=1656,w=349,k="qTX@",S=1025,F=563,z=227,T=679,I=36,M=117,E=112,D=75,O=76,H={};function P(e,t,n,s,i){return Fe(e-455,i- -2,n-O,s-407,s)}H[$(1472,1793,1018,1480,"u[9e")]=P(-e,0,563,t,-n),H[W(421,8,-s,-i,o)]=W(1549,a,518,r,"Tfsa")+$(-l,c,-206,217,p);const R=H;function W(e,t,n,s,i){return Se(e-443,i,n-481,s-D,t- -1015)}function $(e,t,n,s,i){return Fe(e-I,n- -M,n-76,s-E,i)}function N(e,t,n,s,i){return tt(e-z,s- -T,n-304,n,i-151)}super[W(-1362,-d,-h,145,u)+N(-_,0,m,-g,-f)](R[P(527,0,78,b,322)],[null,...Object[$(477,0,C,1747,x)](L[W(A,689,152,y,t)+P(v,0,B,"j$VH",1041)+"s"])],R[N(w,0,k,S,F)])}static[ke(1633,1375,1195,"Tfsa",1663)+"e"](e,t){const n=1072,s=874,i="1PFJ",o=1178,a=886,r=2660,l="cuHB",c=3057,p=1330,d=279,h=1134,u=824,_=1086,m="pI(B",g=791,f=22,b=48,C=1074,x=2834,A=2364,y=2355,v=248,B=404,w=25,L=7,k=811;const S={};var F,z,T,I;S[(z=-331,T=573,I="pSnb",tt(z-394,z- -501,T-276,I,I-60))]=M("cuHB",n,-319,s,385)+M(i,1048,o,a,1011)+Se((F=r)-337,l,c-169,2800-332,F-k)+M("#WnQ",p,d,178,631)+O(h,u,-73,_,m)+M("0w9F",g,-f,38,-49);function M(e,t,n,s,i){return Fe(e-65,i- -175,n-344,s-L,e)}const E=S[O(b,752,1076,C,"JbuD")][O(x,A,1906,y,"JbuD")]("|");let D=0;function O(e,t,n,s,i){return ke(e-v,t-B,n-404,i,t-w)}for(;;){switch(E[D++]){case"0":e.writeTable(t.type,this.$$piece);continue;case"1":e.writeUInt(t.keys,16);continue;case"2":e.writeUInt(t.safelock,3);continue;case"3":e.writeUInt(t.kick,5);continue;case"4":e.writeUInt(t.r,2);continue;case"5":e.writeDouble(t.y);continue;case"6":e.writeUInt(t.lockresets,5);continue;case"7":e.writeUInt(t.flags,W.FLAGS_COUNT);continue;case"8":e.writeUInt(t.irs,2);continue;case"9":e.writeUInt(t.hy,Ne.MAX_HEIGHT);continue;case"10":e.writeUInt(t.rotresets,6);continue;case"11":e.writeInt(t.x,Ne.MAX_WIDTH);continue;case"12":e.writeDouble(t.locking);continue}break}}static decode(e){const t={};return t.type=e.readTable(this.$$piece),t.x=e.readInt(Ne.MAX_WIDTH),t.r=e.readUInt(2),t.hy=e.readUInt(Ne.MAX_HEIGHT),t.irs=e.readUInt(2),t.kick=e.readUInt(5),t.keys=e.readUInt(16),t.flags=e.readUInt(W.FLAGS_COUNT),t.safelock=e.readUInt(3),t.lockresets=e.readUInt(5),t.rotresets=e.readUInt(6),t.y=e.readDouble(),t.locking=e.readDouble(),t}}class Ge extends De{static[ke(704,1693,2061,"xr&1",1371)](){const e=")!K^",t=1233,n=1587,s="&@t)",i=1181,o=1977,a=1668,r=1190,l=1861,c=559,p=533,d=776,h=1954,u=1212,_=1523,m="^n]x",g=1603,f="3n*4",b=2815,C=1107,x=1153,A="oES7",y=1915,v=282,B=804,w="1PFJ",k=877,S=249,F=91,z="cuHB",T=989,I="dIbx",M=1492,E=1454,D=1228,O=494,H=1074,P=1512,R="j$VH",W=637,$="F(AS",N=1167,U=1372,G=1880,X="jdm)",j=738,q=996,K=220,V=601,Q=885,Y=1205,J=590,Z=2978,ee=2421,te=772,ne=1082,se="jdm)",ie=2344,oe=2176,ae=3081,re=2581,le=1935,ce=1600,pe=284,de=971,he=154,ue=206,_e=2431,me=2269,ge="w158",fe=1114,be=1686,Ce=1279,xe="Q*kn",Ae=1669,ye=2385,ve=1962,Be=1134,we=1618,Le=947,Se="pSnb",ze=800,Te=978,Ie=181,Ee=366,De=107,Oe="dIbx",He=560,Pe=453,Re="jdm)",We=694,$e=2808,Ne="4An!",Ue=1689,Ge=1391,Xe=485,je="u[9e",qe=898,Ke=596,Ve=522,Qe="qTX@",Ye=108,Je=1750,Ze="0w9F",et="JbuD",tt=1025,nt=1967,st=1485,it=697,ot=1118,at=1871,rt=1609,lt=1788,ct="eij1",pt=1263,dt="oES7",ht=1723,ut=2198,_t=3369,mt=1700,gt=1644,ft=1503,bt=1547,Ct=1003,xt="qf#!",At=2137,yt="3n*4",vt=2104,Bt="eij1",wt=1207,Lt=131,kt="G1OE",St=161,Ft=778,zt="@DgP",Tt=418,It="%h1%",Mt=1251,Et=623,Dt=2577,Ot=2340,Ht=1824,Pt=1208,Rt=1449,Wt=1763,$t="RJfU",Nt=1076,Ut=1798,Gt=1592,Xt=1397,jt=1913,qt="L(CX",Kt=1939,Vt=1092,Qt=1652,Yt=1336,Jt=2718,Zt=1447,en="pSnb",tn=1220,nn=2171,sn="8N@2",on=620,an=647,rn=1279,ln=3052,cn=2757,pn=1274,dn=959,hn=487,un=355,_n="Uu0i",mn=773,gn="u[9e",fn=457,bn=573,Cn=1520,xn=1743,An=1777,yn=293,vn=390,Bn=478,wn=385,Ln=96,kn=256,Sn=174,Fn=85,zn=399,Tn=332,In=277,Mn=123;function En(e,t,n,s,i){return ke(e-349,t-469,n-In,t,e-Mn)}const Dn={};function On(e,t,n,s,i){return ke(e-Fn,t-109,n-zn,e,s-Tn)}function Hn(e,t,n,s,i){return Me(e-330,t-Sn,t,s-497,n- -253)}function Pn(e,t,n,s,i){return Fe(e-Bn,s-wn,n-Ln,s-kn,t)}function Rn(e,t,n,s,i){return Fe(e-yn,i-434,n-173,s-vn,n)}Dn[Pn(640,e,t,347,377)]=Pn(n,s,1540,i,o),Dn[Hn(1520,"RJfU",a,r,l)]=Pn(51,"u[9e",1461,c,513)+Rn(p,d,e,93,956),Dn[En(h,"@DgP",u)]=En(_,m,g),Dn[On(f,2600,3298,b,3587)]=Rn(698,1272,"Vc@K",C,x),Dn[Hn(737,A,1373,1009,y)]=Rn(v,B,w,k,1148)+"es",Dn[Rn(-S,-F,z,T,455)]=Pn(1726,I,M,E,1212)+"es",Dn[Rn(330,1087,"pI(B",D,O)]=On("3n*4",629,360,H,P)+"es",Dn[En(1985,R,1300)]=Hn(W,$,541,N,541),Dn[En(U,"pSnb",G)]=En(2108,X,1299)+"s",Dn[Rn(j,172,I,q,K)]=Rn(V,276,"0w9F",389,Q)+Rn(Y,942,"f1tM",J,1138),Dn[On(s,2775,Z,2081,ee)]=On("F(AS",te,666,1305,ne)+En(2201,"jdm)",2132),Dn[On(se,ie,oe,2354,ae)]=On("Uu0i",2973,2546,re,2445)+Hn(2733,"dIbx",le,2747,1874)+Hn(ce,"cQJ7",935,276,1789)+"s",Dn[Rn(1134,805,"qF#a",1586,895)]=Pn(827,"K^(^",-105,pe,de)+Rn(-308,he,"X$pc",395,ue)+"es",Dn[Rn(_e,me,ge,fe,be)]=Hn(Ce,xe,Ae,ye,2506)+Rn(ve,1638,")!K^",Be,we)+Pn(Le,Se,ze,Te,865)+"s",Dn[Pn(-719,")trV",428,Ie,-Ee)]=Hn(-De,Oe,He,910,-300)+En(966,m,1533)+"es",Dn[Hn(Pe,Re,1353,1260,We)]=Pn(1404,"f1tM",301,678,809)+On("tj0x",2244,$e,2148)+On(Ne,Ue,Ge,1390)+"s",Dn[Pn(Xe,je,qe,Ke,129)]=Rn(-Ve,442,Qe,24,Ye)+En(Je,Ze,1903)+"es",Dn[Hn(688,et,1126,tt)]=En(nt,"1wIT",2539)+Rn(st,it,"gGSn",1366,1255)+Pn(1294,"Uu0i",752,1604),Dn[On("w158",450,1150,ot)]=On("eij1",1476,at,2006)+Pn(1163,")trV",rt,lt),Dn[Rn(1728,0,ct,1502,pt)]=On(dt,at,1078,ht)+On("tj0x",ut,_t,2486)+"s",Dn[Rn(mt,0,"G1OE",121,965)]=Pn(658,"yNX0",2297,1565)+Rn(gt,0,"jdm)",ft,1608);const Wn=Dn;super[On(Ze,3115,bt,2203)+Hn(778,"RJfU",802,Ct)](Wn[En(1287,xt,1962)],[...Object[On(yt,2779,vt,2549)](L[Pn(826,Bt,1428,wt)+En(897,"eij1",771)+"s"])],Wn[Rn(-Lt,0,kt,St,Ft)]);const $n={};$n[Hn(367,zt,Tt,687)]=8,$n[Pn(885,It,Mt,Et)]=16,super[Pn(Dt,"1wIT",Ot,Ht)+En(1643,se,Pt)+"y"](Wn[Hn(Rt,"u[9e",y,1407)],$n);const Nn={};Nn[Hn(Wt,$t,1413,Nt)]=16,Nn[Hn(1704,"0w9F",1451,Ut)]=32,super[On("X$pc",Gt,2158,Xt)+Pn(1785,"coSS",1213,1345)+"y"](Wn[En(1035,Ze,927)],Nn),this[Rn(jt,0,qt,Kt,1435)+"rs"]=[Wn[Rn(668,0,A,880,Vt)],Wn[En(Qt,"#WnQ",Yt)],Wn[En(2009,"JbuD",Jt)],Wn[Pn(1165,"qf#!",1212,299)],Wn[Hn(Zt,en,918,tn)],Wn[Rn(nn,0,sn,1433,1431)],Wn[On("f1tM",on,an,rn)],Wn[On("JbuD",At,ln,2157)],Wn[En(1630,"qF#a",1382)],Wn[Hn(cn,f,1858,1570)],Wn[Pn(1827,"f1tM",pn,dn)],Wn[Pn(hn,"K^(^",un,592)],Wn[Pn(675,_n,mn,1352)],Wn[On(gn,fn,bn,1076)],Wn[En(2022,$t,Cn)],Wn[Pn(1735,"cQJ7",958,xn)],Wn[Rn(2389,0,Ze,1158,An)]]}static[tt(1432,1099,1008,"qF#a",408)+"e"](e,t){const n=t.garbage,s=t.clears,i=t.finesse;e.writeDInt(t.lines,this.$short),e.writeDInt(t.level_lines,this.$short),e.writeDInt(t.level_lines_needed,this.$short),e.writeDInt(t.inputs,this.$long),e.writeDInt(t.holds,this.$long),e.writeDInt(t.score,this.$long),e.writeUInt(t.level,8),e.writeDInt(t.combo,this.$long),e.writeDInt(t.topcombo,this.$long),e.writeUInt(t.combopower,3),e.writeDInt(t.btb,this.$short),e.writeDInt(t.topbtb,this.$short),e.writeUInt(t.btbpower,8),e.writeDInt(t.tspins,this.$long),e.writeDInt(t.piecesplaced,this.$long);for(const t of this._clears)e.writeDInt(s[t],this.$short);e.writeDInt(n.sent,this.$long),e.writeDInt(n.sent_nomult,this.$long),e.writeDInt(n.maxspike,this.$long),e.writeDInt(n.maxspike_nomult,this.$long),e.writeDInt(n.received,this.$long),e.writeDInt(n.attack,this.$long),e.writeDInt(n.cleared,this.$long),e.writeDInt(t.kills,this.$short),e.writeDInt(i.combo,this.$long),e.writeDInt(i.faults,this.$long),e.writeDInt(i.perfectpieces,this.$long),e.writeStruct(t.zenith,Xe)}static[ke(2527,1297,1227,"1wIT",2097)+"e"](e){const t={zenlevel:1,zenprogress:0,clears:{},garbage:{},finesse:{}};t.lines=e.readDInt(this.$short),t.level_lines=e.readDInt(this.$short),t.level_lines_needed=e.readDInt(this.$short),t.inputs=e.readDInt(this.$long),t.holds=e.readDInt(this.$long),t.score=e.readDInt(this.$long),t.level=e.readUInt(8),t.combo=e.readDInt(this.$long),t.topcombo=e.readDInt(this.$long),t.combopower=e.readUInt(3),t.btb=e.readDInt(this.$short),t.topbtb=e.readDInt(this.$short),t.btbpower=e.readUInt(8),t.tspins=e.readDInt(this.$long),t.piecesplaced=e.readDInt(this.$long);for(const n of this._clears)t.clears[n]=e.readDInt(this.$short);return t.garbage.sent=e.readDInt(this.$long),t.garbage.sent_nomult=e.readDInt(this.$long),t.garbage.maxspike=e.readDInt(this.$long),t.garbage.maxspike_nomult=e.readDInt(this.$long),t.garbage.received=e.readDInt(this.$long),t.garbage.attack=e.readDInt(this.$long),t.garbage.cleared=e.readDInt(this.$long),t.kills=e.readDInt(this.$short),t.finesse.combo=e.readDInt(this.$long),t.finesse.faults=e.readDInt(this.$long),t.finesse.perfectpieces=e.readDInt(this.$long),t.zenith=e.readStruct(Xe),t}}class Xe extends De{static[Me(816,724,"5hjj",1061,1450)](){const e=1797,t=1578,n="1PFJ",s=205,i=123,o=262,a="%h1%",r=709,l=1459,c=704,p="oES7",d=1429,h=1069,u=290,_=153,m=443,g=126,f=23,b=124,C=467,x=82,A=295,y=218,v=857;const B={};B[L(-1127,-345,-605,"F(AS",-320)]=Fe(1925-182,t-b,e-C,2117-x,"4An!");const w=B;function L(e,t,n,s,i){return ke(e-u,t-426,n-_,s,i- -1122)}const k={};var S,F,z,T,I,M,E,D;k[L(-605,-422,369,n,-s)]=16,k[L(i,o,-520,"vBj8",342)]=32,super[(I=8,M=a,E=-82,D=256,Se(I-A,M,M-126,E-y,D- -v)+L(r,l,c,p,774)+"y")](w[(S=d,F="dIbx",z=h,T=1093,Se(S-226,F,z-m,T-g,T-f))],k)}static[tt(-570,196,177,"L(CX",899)+"e"](e,t){e.writeDouble(t.altitude),e.writeDouble(t.rank),e.writeDouble(t.peakrank),e.writeDouble(t.avgrankpts),e.writeDouble(t.totalbonus),e.writeFloat(t.targetingfactor,16,100),e.writeFloat(t.targetinggrace,16,100),e.writeUInt(t.floor,4),e.writeUInt(t.revives,8),e.writeUInt(t.revivesTotal,8),e.writeBoolean(t.speedrun),e.writeBoolean(t.speedrun_seen);for(let n=0;n<9;n++)e.writeDInt(t.splits[n],this.$long)}static[Me(379,313,"RJfU",1573,911)+"e"](e){const t={};t.altitude=e.readDouble(),t.rank=e.readDouble(),t.peakrank=e.readDouble(),t.avgrankpts=e.readDouble(),t.totalbonus=e.readDouble(),t.targetingfactor=e.readFloat(16,100),t.targetinggrace=e.readFloat(16,100),t.floor=e.readUInt(4),t.revives=e.readUInt(8),t.revivesTotal=e.readUInt(8),t.speedrun=e.readBoolean(),t.speedrun_seen=e.readBoolean(),t.splits=[];for(let n=0;n<9;n++)t.splits[n]=e.readDInt(this.$long);return t}}class je extends De{static[ke(2099,1035,2013,"0w9F",1437)](){const e="^n]x",t=126,n=717,s=298,i=863,o=1102,a=607,r=723,l="u[9e",c=1313,p=2211,d="cuHB",h=103,u="X$pc",_=1051,m=2209,g=1051,f=248,b=1010,C=1488,x=623,A=1083,y=104,v="j$VH",B=91,w="4An!",L=703,k=72,S=833,F="Q*kn",z=177,T="JbuD",I=2208,M=1464,E=1942,D=489,O=800,H=883,P="@DgP",R=1821,W=1813,$=3615,N=2743,U=1959,G=1654,X=827,j=2054,q=1023,K=1553,V=17,Q=949,Y="#WnQ",J=440,Z="qF#a",ee=1453,te=1090,ne=641,se=173,ie=1603,oe="K^(^",ae=1774,re=1303,le=990,ce=2533,pe=2175,de=1861,he=2602,ue=1194,_e=899,me=1770,ge=1934,fe=1440,be=1685,Ce=868,xe=532,Ae=1249,ye=740,ve=1467,Be=2637,we=2038,Le=1394,ze="8N@2",Te=222,Ie=419,Ee="1PFJ",De=559,Oe=171,He="F(AS",Pe="&@t)",Re=1466,We=1835,$e=695,Ne=651,Ue=779,Ge=2054,Xe="dIbx",je="qTX@",qe=2751,Ke=2006,Ve=824,Qe=1674,Ye=918,Je="RJfU",Ze=2474,et="0w9F",nt=1209,st=1438,it="f1tM",ot=2704,at=3267,rt="eij1",lt=1681,ct="0w9F",pt="Q*kn",dt=3191,ht="dIbx",ut=1578,_t=1071,mt="FAYi",gt=1988,ft=441,bt=1015,Ct=2037,xt=2085,At=783,yt=495,vt=2814,Bt=1465,wt=627,Lt=2084,kt=1816,St=702,Ft=920,zt=231,Tt=1417,It=425,Mt=757,Et={};function Dt(e,t,n,s,i){return Me(e-475,t-115,t,s-121,e- -29)}function Ot(e,t,n,s,i){return Se(e-371,n,n-78,s-It,e- -Mt)}function Ht(e,t,n,s,i){return Fe(e-zt,n-Tt,n-301,s-190,e)}Et[Wt(1236,1468,1417,810,e)]=Wt(-t,n,-s,-i,"eij1"),Et[Ht("RJfU",855,o,1592,1394)]=Wt(a,710,-123,625,"tj0x"),Et[Wt(387,54,r,-197,l)]=Ot(c,1139,"FAYi",p,988)+Ot(69,-160,d,-h,-238)+"n",Et[Ot(1300,1488,u,_,m)]=Dt(g,")!K^",f,267,b)+Wt(928,95,523,C,"Q*kn")+Wt(x,A,666,-y,v)+Ot(-B,499,w,-L,-37),Et[Ot(k,-S,F,375,z)]=Ht(T,2958,I,M,E)+"t",Et[Wt(D,O,H,759,"3n*4")]=Ht(P,1460,1167,R,363)+Dt(1212,"Vc@K",0,W),Et[Ht("#WnQ",$,N,U,2963)]=Ht("yNX0",G,1339,X,j)+Ot(742,q,"JbuD",1395,K)+Ot(-V,444,"Xoa]",314,-169),Et[Dt(Q,Y,0,J)]=Ot(1256,682,Z,ee,te),Et[Ot(665,ne,"xr&1",622,-se)]=$t("Xoa]",1632,ie,2426,1404)+"m",Et[$t(oe,ae,1472,re,le)]=Ht("JbuD",ce,pe,de,he)+$t("yNX0",1329,1530,1312,567),Et[Wt(ue,_e,me,ge,")!K^")]=Ht(e,2085,fe,883,624)+"ge",Et[Ht("oES7",912,K,be,717)]=Dt(Ce,"JbuD",0,xe)+Ot(Ae,ye,"w158",2054,1763)+$t("pI(B",2091,ve,Be,2720)+"s",Et[Ht(e,2681,2421,2787,we)]=Dt(Le,ze,0,1920)+Wt(Te,809,Ie,7,Ee)+"us",Et[Wt(52,303,-De,-Oe,v)]=Dt(1765,He,0,1974)+Ht(Pe,1545,Re,We,1217)+Ot($e,830,"ArG5",Ne,Ue)+Ht("#WnQ",ce,2543,Ge,1880),Et[Ot(716,0,Xe,-173)]=Ht("Uu0i",0,1319,1523)+Ht(je,0,2593,qe)+Ht(oe,0,1621,Ke);const Pt=Et,Rt={};function Wt(e,t,n,s,i){return ke(e-139,t-345,n-399,i,e- -Ft)}function $t(e,t,n,s,i){return tt(e-353,t-St,n-21,e,i-218)}Rt[Wt(Ve,Qe,1050,Ye,Je)]=8,Rt[$t("cuHB",Ze,1974,2376,2549)]=24,super[Ot(536,0,et,nt)+$t("4An!",924,507,0,st)+"y"](Pt[Ht(it,0,ot,at)],Rt),super[Dt(1361,rt,0,lt)+Ht("tj0x",0,1333,1929)](Pt[Ht(ct,0,2186,2501)],[Pt[Ht(pt,0,2504,dt)],Pt[$t(ht,1253,ut,0,_t)],Pt[Ot(1142,0,mt,1748)],Pt[Ht(mt,0,gt,1778)],Pt[Dt(1557,it,0,1398)],Pt[Ot(ft,0,"^n]x",bt)],Pt[$t("coSS",Ct,2728,0,2211)]]),super[Ht(Y,0,xt,1822)+Wt(601,At,897,0,"j$VH")](Pt[Wt(1105,1156,yt,0,"Xoa]")],[Pt[Ht("@DgP",0,2229,vt)],Pt[Ot(1240,0,"@DgP",879)],Pt[Ht("ArG5",0,1721,1562)],Pt[Ht("yNX0",0,Bt,wt)],Pt[Ht("%h1%",0,Lt,kt)]])}static[ke(653,449,869,"j$VH",1322)+"e"](e,t){const n=t.frame,s=t.type,i=t.data;switch(e.writeDInt(t.id,this.$byte),e.writeDInt(n,this.$byte),e.writeTable(s,this.$$type),s){case"interaction":return e.writeStruct(i,qe);case"interaction_confirm":switch(e.writeTable(i.type,this.$$int_type),i.type){case"garbage":return e.writeStruct(i,qe);case"zenith.climb_pts":case"zenith.bonus":return e.writeUInt(i.gameid,13),e.writeDInt(i.frame,this.$byte),e.writeDouble(i.amt);case"zenith.incapacitated":case"zenith.revive":return e.writeUInt(i.gameid,13),e.writeDInt(i.frame,this.$byte);default:throw new Error(`Unknown interaction type received: ${i.type}`)}case"target":e.writeUInt(i.targets.length,13);for(const t of i.targets)e.writeUInt(t,13);break;case"targeted":e.writeBoolean(i.value),e.writeUInt(i.gameid,13),e.writeDInt(i.frame,this.$byte);break;case"allow_targeting":e.writeBoolean(i.value);break;case"kev":e.writeUInt(i.victim.gameid,13),e.writeUInt(i.killer.gameid,13),e.writeDInt(i.frame,this.$byte),e.writeUInt(i.fire,10);break;case"custom":return e.writeStruct(i,Ve)}}static[ke(2950,2675,2709,"vBj8",2084)+"e"](e){const t={};t.id=e.readDInt(this.$byte),t.frame=e.readDInt(this.$byte),t.type=e.readTable(this.$$type);e:switch(t.type){case"interaction":t.data=e.readStruct(qe);break;case"interaction_confirm":{const n=e.readTable(this.$$int_type);switch(n){case"garbage":t.data=e.readStruct(qe);break e;case"zenith.climb_pts":case"zenith.bonus":t.data={type:n,gameid:e.readUInt(13),frame:e.readDInt(this.$byte),amt:e.readDouble()};break e;case"zenith.incapacitated":case"zenith.revive":t.data={type:n,gameid:e.readUInt(13),frame:e.readDInt(this.$byte)};break e}break}case"target":{const n=[],s=e.readUInt(13);for(let t=0;t<s;t++)n.push(e.readUInt(13));t.data={targets:n};break}case"targeted":t.data={value:e.readBoolean(),gameid:e.readUInt(13),frame:e.readDInt(this.$byte)};break;case"allow_targeting":t.data={value:e.readBoolean()};break;case"kev":t.data={victim:{gameid:e.readUInt(13)},killer:{gameid:e.readUInt(13)},frame:e.readDInt(this.$byte),fire:e.readUInt(10)};break;case"custom":t.data=e.readStruct(Ve)}return t}}class qe extends Oe{static[Fe(1949,1115,863,1101,"G1OE")](){const e=3274,t=2193,n=2695,s=1842,i=2760,o="X$pc",a=1338,r=758,l=1198,c=3411,p="jdm)",d=2015,h="4An!",u=1384,_="pI(B",m=870,g=888,f="qf#!",b=1628,C=2030,x=1753,A=2314,y=2410,v=827,B="L(CX",w=2285,L=1644,k="yNX0",S=527,F="Tfsa",z=1145,T=1161,I=2493,M=1137,E=1883,D=1503,O=1357,H="&@t)",P=566,R=999,W=1338,$=2155,N="qF#a",U=1195,G="F(AS",X="oES7",j=1982,q=1683,K=2899,V=2482,Q=2836,Y=167,J="3n*4",Z=538,ee=2873,te=2130,ne=2801,se=210,ie=2611,oe=2316,ae=1222,re=1186,le=713,ce=1629,pe=1772,de="0w9F",he=2052,ue=2712,_e=2025,me=467,ge="^n]x",fe=759,be=607,Ce=131,xe=1651,Ae=2057,ye=2870,ve="8N@2",Be=2265,we=1696,Le="xnZ2",ke=434,Fe=907,ze=2331,Te=1858,Ie=2152,Me=1907,De=2198,Oe="eij1",He=1299,Pe=713,Re=1908,We=588,$e="G1OE",Ue=412,Ge=2955,Xe=2481,je="FAYi",qe=1286,Ke=1558,Ve=1875,Qe=1671,Ye="Q*kn",Je=2033,Ze=1662,et="1PFJ",nt=1425,st="j$VH",it=885,ot=1201,at=882,rt=1182,lt=459,ct=848,pt="Tfsa",dt=2090,ht=2560,ut=989,_t="pSnb",mt=1776,gt=267,ft=996,bt=2784,Ct=2272,xt=2430,At=2188,yt=546,vt=1748,Bt=2110,wt=929,Lt=1630,kt=1860,St=2143,Ft="cQJ7",zt=1943,Tt=2072,It=2346,Mt=2529,Et=1662,Dt="Uu0i",Ot=2988,Ht=2693,Pt=1178,Rt=1109,Wt=1407,$t="%h1%",Nt=2997,Ut=1605,Gt="3n*4",Xt=2580,jt="pSnb",qt=2235,Kt=2408,Vt=3799,Qt="vBj8",Yt=901,Jt=1744,Zt=2045,en="coSS",tn=2078,nn=2460,sn=1439,on=1658,an="pI(B",rn="qTX@",ln=2704,cn=1026,pn=1410,dn=567,hn=30,un=12,_n=595,mn=1372,gn=1632,fn=902,bn=1027,Cn=2500,xn=2274,An=2528,yn=808,vn=1335,Bn=2154,wn=759,Ln=1355,kn="u[9e",Sn=1384,Fn=2558,zn=1821,Tn=1983,In=1829,Mn=682,En=156,Dn=2281,On=1855,Hn=2700,Pn=919,Rn=1786,Wn="coSS",$n=2590,Nn="0w9F",Un=1418,Gn=1292,Xn=1964,jn=1237,qn="Q*kn",Kn=77,Vn=1517,Qn=1635,Yn=1874,Jn=1778,Zn=1472,es=1865,ts=1710,ns=1085,ss=1939,is=707,os=884,as=1090,rs=2557,ls="X$pc",cs=2307,ps=2148,ds=1496,hs=1507,us=1341,_s=2888,ms="JbuD",gs=2974,fs=1101,bs=1332,Cs=553,xs=89,As=392,ys=32,vs=2024,Bs=1361,ws=274,Ls=1059,ks=191,Ss=2294,Fs=2034,zs=2129,Ts=1748,Is=1851,Ms=998,Es="coSS",Ds=2964,Os=2263,Hs="1wIT",Ps=1799,Rs=2291,Ws=2004,$s=1888,Ns=1699,Us=1724,Gs=2528,Xs="8N@2",js=2451,qs="L(CX",Ks=2406,Vs=2462,Qs="@DgP",Ys=2186,Js=867,Zs="tj0x",ei=709,ti=490,ni=821,si=122,ii=364,oi=450,ai=499,ri=474,li=208,ci={};ci[gi(2954,e,t,"&@t)",n)]=gi(s,i,2417,o,2215),ci[Ai(1498,"&@t)",2026,1520,a)]=Ai(r,"coSS",954,428,l)+"c",ci[wi(2171,c,2707,p,3202)]=wi(1152,1481,d,h,1366)+"ge",ci[wi(1907,1644,u,_,m)]=ki(g,f,1032,1270,b),ci[gi(1698,C,1054,"oES7",1853)]=gi(2944,x,A,"5hjj",y)+Bi(469,"F(AS",-150,v,744);const pi=ci,di={};di[gi(1178,1160,1170,B,1197)]=8,di[gi(2202,w,L,k,1984)]=24,super[ki(S,F,z,T,1520)+gi(2490,I,M,"1PFJ",E)+"y"](pi[Ai(D,"K^(^",1426,1426,O)],di);const hi={};hi[gi(751,893,1162,H,1645)]=pi[Ai(P,"&@t)",1991,R,W)],hi[gi($,2133,2380,N,1575)]=pi[wi(U,2276,1935,G,1283)];const ui={};ui[ki(2312,X,2468,j,q)]=pi[Ai(K,"Uu0i",V,Q,2297)],ui[Ai(Y,J,Z,944,656)]=Ee[ki(ee,"xr&1",1660,te,ne)][Bi(-739,"1wIT",-se,-759,-511)],ui[Ai(ie,"w158",oe,ae,2091)]=this[wi(1414,2029,1271,")!K^",421)];const _i={};_i[wi(1750,re,1623,f,le)]=pi[wi(1709,ce,1682,"f1tM",1658)],_i[wi(pe,2107,1939,de,he)]=Ee[wi(1707,ue,1896,"0w9F",_e)][Bi(-me,ge,fe,be,-Ce)],_i[wi(xe,Ae,2046,"qF#a",ye)]=13;const mi={};function gi(e,t,n,s,i){return tt(e-266,i-1029,n-li,s,i-238)}mi[ki(2249,ve,Be,2451,2067)]=pi[Bi(we,Le,732,ke,Fe)],mi[ki(ze,"Tfsa",Te,2490,2061)]=Ee[gi(Ie,Me,1813,"4An!",De)][Ai(1540,Oe,-89,He,Pe)],mi[Ai(2509,"Xoa]",Re,2329,2108)]=this[Bi(We,$e,Ue,-255,-268)];const fi={};fi[wi(2694,Ge,Xe,"G1OE",2330)]=pi[Ai(1222,je,2117,qe,Ke)],fi[wi(Ve,1815,Qe,Ye,Je)]=Ee[gi(3008,0,Ze,et,2206)][Ai(1470,"gGSn",2982,nt,2132)],fi[ki(1221,st,2058,1839,2233)]=this[Ai(it,"Uu0i",ot,at,1012)];const bi={};bi[Ai(rt,"tj0x",1084,lt,ct)]=pi[Ai(1624,pt,dt,617,1313)],bi[wi(ht,1772,2153,"Xoa]",1487)]=Ee[Bi(ut,_t,mt,gt,ft)][Ai(bt,"qf#!",Ct,xt,At)],bi[gi(2100,0,1114,Le,1201)]=this[Bi(467,"Uu0i",yt,-830,-233)];const Ci={};Ci[ki(892,"qf#!",vt,1511,Bt)]=pi[Bi(1012,"Uu0i",wt,385,M)],Ci[gi(2762,0,Lt,et,kt)]=Ee[gi(1396,0,St,ve,2242)][ki(2342,Ft,2178,2758,zt)],Ci[ki(1088,"u[9e",Tt,1874,2508)]=this[ki(It,"3n*4",Mt,2799,3285)];const xi={};function Ai(e,t,n,s,i){return tt(e-ii,i-oi,n-ai,t,i-ri)}xi[wi(2269,1386,1702,"Q*kn",2359)]=pi[Ai(Et,Dt,3146,Ot,2382)],xi[wi(Ht,1004,1815,"xnZ2",2130)]=Ee[ki(1999,"jdm)",Pt,Rt,1512)][Ai(Wt,$t,Nt,3099,2293)],xi[ki(Ut,Gt,3103,2281,2775)]=Ne[Ai(Xt,jt,qt,2373,Kt)+wi(3164,3505,2978,"cuHB",Vt)];const yi={};yi[Bi(331,Qt,450,1077,Yt)]=pi[wi(Jt,2025,Zt,en,2774)],yi[gi(tn,0,2092,"dIbx",nn)]=Ee[wi(sn,2177,on,an,1638)][gi(2060,0,2309,rn,ln)],yi[ki(cn,"Uu0i",1561,pn,dn)]=Ne[Bi(hn,"@DgP",un,129,-_n)+ki(1125,"F(AS",mn,gn,2122)];const vi={};function Bi(e,t,n,s,i){return tt(e-349,i- -795,n-si,t,i-146)}function wi(e,t,n,s,i){return Se(e-232,s,n-62,s-ti,n-ni)}vi[gi(fn,0,bn,"qTX@",1685)]=pi[gi(Cn,0,xn,"5hjj",An)],vi[Bi(1513,"Vc@K",yn,0,733)]=Ee[wi(vn,0,Bn,"Xoa]")][Bi(102,"pI(B",339,0,wn)],vi[Ai(Ln,kn,624,0,Sn)]=Ne[Ai(2512,"Q*kn",Fn,0,zn)+ki(Tn,"w158",2021,In,1390)];const Li={};function ki(e,t,n,s,i){return Se(e-29,t,n-17,s-437,s-ei)}Li[Bi(Mn,"Uu0i",57,0,-En)]=pi[Ai(2950,Le,Dn,0,2152)],Li[ki(On,et,1522,1771)]=Ee[gi(Hn,0,Pn,"Uu0i",Rn)][gi(2113,0,3541,"#WnQ",2802)+"g"],Li[ki(2147,Wn,1898,2363)]=!0;const Si={};Si[Ai($n,Nn,Un,0,Ct)]=pi[wi(3216,0,2754,"xnZ2")],Si[ki(2730,"^n]x",Gn,Xn)]=Ee[Bi(jn,qn,Kn,0,922)][Ai(3172,")!K^",Vn,0,2378)],Si[ki(Qn,kn,1442,Yn)]=16;const Fi={};Fi[wi(3294,0,2999,")trV")]=pi[Ai(2592,"X$pc",2628,0,Jn)],Fi[Ai(Zn,"Q*kn",es,0,1069)]=Ee[gi(1366,0,ts,"xr&1",2219)][Ai(ns,$e,1781,0,1353)+"an"];const zi={};zi[gi(1592,0,2511,ge,ss)]=pi[Bi(is,Gt,os,0,as)],zi[wi(2619,0,rs,ls)]=Ee[Ai(2192,"8N@2",2017,0,1663)][ki(cs,"4An!",ps,ds)],zi[gi(hs,0,747,"dIbx",us)]=Ne[gi(_s,0,2950,ms,gs)+gi(1468,0,983,Dt,1289)];const Ti={};Ti[wi(fs,0,bs,pt)]=pi[Ai(Cs,"gGSn",1287,0,1013)],Ti[Bi(-xs,Le,As,0,-ys)]=Ee[Ai(vs,"yNX0",1719,0,Bs)][Bi(-ws,"cuHB",-543,0,-378)+"e"];const Ii={};Ii[Bi(Ls,"tj0x",984,0,ks)]=hi,Ii[Ai(2605,"vBj8",2634,0,Ss)]=ui,Ii[ki(Fs,"pSnb",2514,zs)+"d"]=_i,Ii[Ai(1660,"8N@2",2866,0,2049)]=mi,Ii[Bi(-902,"JbuD",-1168,0,-635)]=fi,Ii[wi(Ts,0,Is,"ArG5")]=bi,Ii[Bi(-Ms,Es,-481,0,-185)+"d"]=Ci,Ii.x=xi,Ii.y=yi,Ii[wi(Ds,0,Os,Hs)+"n"]=vi,Ii[ki(Ps,ge,Rs,Ws)+Ai($s,$e,Ns,0,1232)]=Li,Ii[wi(Us,0,Gs,Xs)]=Si,Ii[gi(2229,0,2754,"coSS",Bn)+"d"]=Fi,Ii[ki(js,qs,Ks,2672)]=zi,Ii[ki(Vs,Qs,1948,Ys)+"t"]=Ti,super[Ai(Js,Zs,194,0,946)+Ai(Mn,qs,626,0,626)+"re"](Ii)}}class Ke extends Oe{static[ke(1041,236,1776,"tj0x",1089)](){const e=2072,t=816,n=1558,s=1446,i=1657,o=795,a=")trV",r=410,l="&@t)",c=143,p=763,d=618,h="yNX0",u=1625,_=2717,m=2170,g=1311,f=425,b=58,C=885,x=507,A=548,y=1477,v=724,B=24,w="qTX@",L=1714,k="yNX0",S="vBj8",F=2006,z=2010,T="qf#!",I=1814,M=2153,E=170,D=381,O=257,H=1412,P=1161,R="0w9F",W=1234,$=149,N=1680,U=1184,G="&@t)",X=1983,j=323,q=7,K=1006,V=447,Q=975,Y=458,J=949,Z="Xoa]",ee=1636,te=1237,ne=1345,se=250,ie=377,oe=457,ae=787,re=713,le=1150,ce="FAYi",pe=1290,de=2674,he=1782,ue=565,_e=968,me=1788,ge=2554,fe=1784,be=898,Ce="0w9F",xe=1800,Ae=102,ye="1wIT",ve=1213,Be=1362,we="@DgP",Le=1024,Se=1272,ze=1093,Te=1231,Ie="pSnb",De=891,Oe="tj0x",He=937,Pe="coSS",Re="%h1%",We=866,$e=1659,Ue=2173,Ge=2322,Xe=1826,je=1131,qe=628,Ke=1131,Ve=75,Qe=1922,Ye=1440,Je=1156,Ze="xnZ2",et=1855,nt=1302,st="u[9e",it=973,ot=1349,at=1437,rt=1035,lt=1904,ct=413,pt=35,dt=124,ht=640,ut=1712,_t=1355,mt="%h1%",gt=2408,ft=1595,bt=784,Ct=828,xt=1512,At=2207,yt="FAYi",vt=449,Bt=1322,wt=2105,Lt=2061,kt=1554,St=1653,Ft="FAYi",zt=975,Tt=213,It=1058,Mt=1020,Et="Q*kn",Dt=1597,Ot=194,Ht=591,Pt="L(CX",Rt=1612,Wt=947,$t=633,Nt=1510,Ut="oES7",Gt=1793,Xt=1082,jt=")!K^",qt=1946,Kt=1460,Vt=1757,Qt=407,Yt=2589,Jt=1739,Zt=1589,en=1275,tn=1635,nn=1262,sn=1396,on=20,an=21,rn=17,ln=349,cn=11,pn=411,dn=345,hn=337,un=439,_n=350,mn=324,gn={};function fn(e,t,n,s,i){return Me(e-hn,t-un,e,s-_n,s- -mn)}gn[fn("vBj8",e,1345,1280,t)]=fn("Q*kn",831,n,s,i)+"n",gn[Bn(1227,"ArG5",1816,2501,1352)]=Bn(o,a,928,1796,r),gn[fn(l,295,-c,p,d)]=Sn(h,321,834,u,402)+"e",gn[Ln(2593,_,m,"oES7",g)]=kn(f,-b,-C,"1wIT",x),gn[Sn("F(AS",A,988,u,y)]=kn(v,-B,-202,w,300),gn[Ln(2468,1882,L,k,2314)]=fn(S,F,0,z)+Sn(T,I,M,2232,1436);const bn=gn;super[Bn(E,"jdm)",D,428,-O)+kn(H,851,P,R,W)](bn[kn($,1039,1259,"eij1",N)],[bn[Ln(959,U,1101,G,X)],bn[kn(-675,-j,318,"4An!",-q)]]);const Cn={};Cn[Ln(K,420,409,"FAYi",261)]=8,Cn[Bn(V,"L(CX",219,Q,-Y)]=32,super[fn("dIbx",2352,0,1919)+Bn(J,Z,1483,897,ee)+"y"](bn[fn("L(CX",te,0,ne)],Cn);const xn={};xn[Bn(se,Z,ie,-oe,-73)]=bn[kn(ae,660,1415,"qF#a",1450)],xn[Bn(re,"Vc@K",1408,1041,1409)]=Ee[Ln(1253,1864,le,ce,pe)][fn("K^(^",de,0,he)],xn[fn("dIbx",810,0,451)]=this[kn(71,205,-550,"cuHB",-ue)+Sn("3n*4",_e,1792,me,ge)];const An={};An[Bn(1156,"xnZ2",fe,943,be)]=bn[Sn(Ce,xe,921,Ae,618)],An[fn(ye,1035,0,ve)]=Ee[kn(Be,1030,1470,we,1755)][Ln(Le,Se,1815,"3n*4",ze)],An[Sn("Xoa]",2737,2197,2568,3009)]=this[kn(1900,Te,530,Ie,De)];const yn={};yn[Sn(Oe,395,He,330,1307)]=bn[kn(1030,622,420,Pe,1310)],yn[Sn(Re,We,$e,1154,Ue)]=Ee[Sn(a,Ge,2107,Xe,1444)][fn(l,Y,0,je)+"an"];const vn={};function Bn(e,t,n,s,i){return ke(e-cn,t-pn,n-dn,t,n- -661)}vn[kn(-207,qe,Ke,"cuHB",Ve)]=bn[Sn("Uu0i",Qe,Ye,Je,1444)],vn[Sn(Ze,et,nt,1054,1557)]=Ee[fn(st,995,0,it)][Sn("4An!",526,1095,ot,at)],vn[fn("Q*kn",1437,0,812)]=Ne[Ln(670,1539,rt,"#WnQ",lt)+kn(-ct,pt,-414,"X$pc",408)];const wn={};function Ln(e,t,n,s,i){return ke(e-248,t-495,n-ln,s,n- -306)}function kn(e,t,n,s,i){return Fe(e-280,t- -rn,n-163,s-401,s)}function Sn(e,t,n,s,i){return tt(e-13,n-539,n-on,e,i-an)}wn[kn(-494,-dt,-ht,Oe)]=bn[Ln(3075,2418,2164,"cuHB")],wn[Ln(ut,787,_t,mt)]=Ee[Sn("G1OE",gt,ft,bt,1946)][Sn("f1tM",Ct,xt,At,1686)],wn[fn(yt,vt,0,507)]=Ne[fn("f1tM",Bt,0,wt)+Bn(Lt,"G1OE",kt)];const Fn={};Fn[Bn(269,"X$pc",1063)]=bn[Ln(St,1218,ft,Ft)],Fn[Ln(zt,Tt,It,"5hjj")]=Ee[Bn(Mt,Et,Dt)][kn(Ot,Ht,1136,Ze)],Fn[Bn(2266,Pt,Rt)]=16;const zn={};zn[Ln(73,Wt,$t,"tj0x")]=bn[Sn(")!K^",0,1577,0,Nt)],zn[Sn(Ut,0,1277,0,438)]=Ee[Bn(Gt,"tj0x",Xt)][Ln(506,1371,727,jt)+"g"];const Tn={};Tn[Ln(qt,1532,1052,"jdm)")+"n"]=xn,Tn[fn("coSS",1098,0,863)]=An,Tn[Sn("Tfsa",0,Kt,0,Vt)]=yn,Tn[Ln(523,-477,Qt,Ze)]=vn,Tn[fn("Xoa]",Yt,0,Jt)+"n"]=wn,Tn[kn(-32,-294,-572,mt)]=Fn,Tn[Ln(Zt,en,tn,Pt)+"t"]=zn,super[Bn(1509,"Q*kn",nn)+Sn("gGSn",0,sn,0,1663)+"re"](Tn)}}class Ve extends De{static[Se(2682,"yNX0",2305,2574,1931)](){const e=256,t=3082,n=2540,s=1402,i=2021,o=2128,a=2140,r="yNX0",l=1130,c=1006,p=1236,d=71,h=1916,u="qf#!",_=229,m=209,g=615,f=1681,b=784,C=2166,x=1825,A="4An!",y=1378,v="1wIT",B=1762,w=1540,L="cQJ7",k=475,S="cuHB",F=1943,z="%h1%",T=1197,I=1684,M="K^(^",E=27,D=529,O="dIbx",H="xnZ2",P=878,R=2271,W=1671,$="w158",N=1504,U=1409,G=785,X=2691,j="Tfsa",q=936,K=671,V="X$pc",Q=939,Y=745,J="@DgP",Z=2116,ee="Vc@K",te=2235,ne=31,se=488,ie=205,oe=208,ae=312,re=201,le=339,ce=339,pe={};function de(e,t,n,s,i){return Se(e-le,s,n-317,s-ce,n-35)}function he(e,t,n,s,i){return tt(e-oe,e- -372,n-ae,i,i-re)}function ue(e,t,n,s,i){return ke(e-se,t-17,n-288,e,t-ie)}function _e(e,t,n,s,i){return ke(e-ne,t-494,n-200,n,s- -224)}function me(e,t,n,s,i){return Se(e-479,s,n-68,s-325,n-10)}pe[me(1262,964,1262,"8N@2",2140)]=me(1490,1117,1072,"1PFJ",e),pe[ue("4An!",2291,t,n,2617)]=he(s,0,i,0,"0w9F")+"ge",pe[he(-165,0,168,0,"yNX0")]=de(2958,0,o,"dIbx"),pe[_e(2086,1339,"1wIT",a,1493)]=ue(r,l,929),pe[me(c,550,p,"coSS",1164)]=me(d,990,388,"#WnQ",1299),pe[_e(3032,2963,"qf#!",2124,1757)]=me(1426,h,1163,u,763),pe[_e(-_,-m,"X$pc",g)]=me(889,f,b,"1PFJ",1301)+ue("5hjj",C,2759),pe[me(2048,0,x,"jdm)")]=ue("L(CX",2680,3564)+ue(A,1127,263)+"e",pe[_e(1803,y,v,2052)]=me(B,0,w,L)+me(k,0,1255,S),pe[de(975,0,1231,"Tfsa")]=de(F,0,1299,"u[9e")+me(529,0,978,z),pe[de(1238,0,T,"F(AS")]=de(2507,0,2056,")trV")+me(1122,0,I,"coSS")+"s";const ge=pe;super[de(1468,0,844,M)+me(-E,0,D,O)](ge[_e(1214,567,H,P)],[ge[de(R,0,W,"oES7")],ge[ue($,2013,N)],ge[_e(606,U,S,1084)],ge[he(1468,0,1364,0,M)],ge[_e(G,1750,"Vc@K",965)],ge[de(X,0,1781,j)],ge[he(q,0,K,0,V)],ge[me(-135,0,577,"RJfU")],ge[me(Q,0,Y,J)],ge[_e(Z,1662,ee,te)]])}static[Me(1622,741,"1wIT",1123,1214)+"e"](e,{type:t,data:n}){switch(e.writeTable(t,this.$$type),t){case"garbage":return e.writeStruct(n,qe);case"map":return e.writeStruct(n.map,Qe),e.writeUInt(n.w,Ne.MAX_WIDTH),e.writeUInt(n.h,Ne.MAX_HEIGHT);case"queue":return e.writeBoolean(n.start),e.writeString(n.queue.toString());case"piece":return e.writeString(n.piece);case"lines":return e.writeStruct(n,Ke);case"boardsize":return e.writeUInt(n.w,Ne.MAX_WIDTH),e.writeUInt(n.h,Ne.MAX_HEIGHT);case"holderstate":case"constants":return e.pack(n);case"setoptions":return e.writeStruct(n.options,Je);case"tetrominoes":return e.writeStruct(n,Ye)}}static[tt(2348,1770,2261,"3n*4",2141)+"e"](e){const t={};switch(t.type=e.readTable(this.$$type),t.data={},t.type){case"garbage":t.data=e.readStruct(qe);break;case"map":t.data.map=e.readStruct(Qe),t.data.w=e.readUInt(Ne.MAX_WIDTH),t.data.h=e.readUInt(Ne.MAX_HEIGHT);break;case"queue":t.data.start=e.readBoolean(),t.data.queue=e.readString().split(",");break;case"piece":t.data.piece=e.readString();break;case"lines":t.data=e.readStruct(Ke);break;case"boardsize":t.data.w=e.readUInt(Ne.MAX_WIDTH),t.data.h=e.readUInt(Ne.MAX_HEIGHT);break;case"holderstate":case"constants":t.data=e.unpack();break;case"setoptions":t.data.options=e.readStruct(Je);break;case"tetrominoes":t.data=e.readStruct(Ye)}return t}}class Qe extends De{static[tt(2298,1606,853,"pI(B",1143)](){const e=1381,t=1283,n=730,s=773,i=1255,o=1300,a="u[9e",r=2083,l=753,c=968,p=999,d=436,h="Vc@K",u=305,_=440,m=765,g=1681,f=1117,b="Vc@K",C=724,x=1113,A=294,y="L(CX",v=1042,B=2097,w=2351,L="X$pc",k=2987,S="5hjj",F=2080,z=2954,T=2260,I=2477,M="RJfU",E=2677,D=472,O=515,H=127,P=116,R=621,W=73,$=9,N={};function U(e,t,n,s,i){return ke(e-316,t-$,n-239,t,e- -636)}function G(e,t,n,s,i){return Me(e-207,t-W,e,s-326,i- -901)}function X(e,t,n,s,i){return tt(e-P,t-R,n-37,n,i-188)}N[V(1295,1414,1466,"%h1%",911)]=X(e,t,"jdm)",506,1673)+"rs",N[V(n,806,1599,"qf#!",s)]=X(i,o,a,r,l)+V(1261,c,p,"5hjj",d),N[q(h,u,55,_,m)]=G("oES7",g,0,f,1399);const j=N;function q(e,t,n,s,i){return tt(e-479,s- -521,n-218,e,i-410)}super[G(b,C,0,x,A)+G(y,421,0,989,v)](j[q("xr&1",0,B,e,1351)],["?",",","_","#","@","z","l","o","s","i","j","t","g","d"],j[X(2175,w,L,0,k)]);const K={};function V(e,t,n,s,i){return tt(e-D,i- -O,n-H,s,i-35)}K[q(S,0,F,1228,1722)]=16,K[U(330,"5hjj",-56)]=32,super[X(z,T,"&@t)",0,1896)+X(2611,I,b,0,2255)+"y"](j[U(1810,M,E)],K)}static[Fe(1526,1240,1512,1374,"JbuD")+"e"](e,t){const n=t.split("");e.writeDInt(n.length,this.$word);for(const t of n)e.writeTable(t,this.$$letters)}static[Me(969,594,"pI(B",1044,1348)+"e"](e){let t="";const n=e.readDInt(this.$word);for(let s=0;s<n;s++){t+=e.readTable(this.$$letters)}return t}}class Ye extends De{static[Me(2080,2001,"pI(B",2302,2069)](){const e="u[9e",t=3254,n=1108,s="3n*4",i=1366,o=1115,a=1144,r="F(AS",l=919,c=1042,p="RJfU",d=1091,h=1771,u="coSS",_=1274,m=317,g=466,f=377,b=239,C=496,x="Q*kn",A=1751,y=1745,v=484,B=341,w=2589,k=1844,S="qTX@",F=971,z=2238,T=2288,I="pI(B",M=1776,E=1598,D=2752,O=2333,H=1376,P=2959,R="JbuD",W=2497,$=1762,N="^n]x",U=2303,G=1274,X="0w9F",j=1560,q=2087,K=67,V=195,Q="^n]x",Y=455,J=190,Z=241,ee="#WnQ",te=938,ne=2094,se=743,ie=1069,oe=2178,ae=2006,re=1756,le=2388,ce=772,pe="RJfU",de=1433,he=1899,ue="ArG5",_e=1936,me="Tfsa",ge=1122,fe=502,be=629,Ce=2213,xe=1394,Ae=1853,ye="w158",ve=1733,Be=1043,we=953,Le="gGSn",ke=2634,Fe=3046,ze=1870,Te=936,Ie=70,Ee="FAYi",De=784,Oe=946,He=1849,Pe="Vc@K",Re="^n]x",We=323,$e=3403,Ne="F(AS",Ue=1796,Ge=2102,Xe=2570,je="@DgP",qe=1929,Ke=1426,Ve=2843,Qe=2037,Ye=465,Je=267,Ze=156,et=236,nt=44,st=350,it=389,ot=966,at=414,rt=201,lt=710,ct=135,pt=151,dt={};function ht(e,t,n,s,i){return tt(e-ct,n-841,n-pt,t,i-153)}function ut(e,t,n,s,i){return Se(e-25,i,n-at,s-rt,t- -lt)}function _t(e,t,n,s,i){return Me(e-453,t-it,s,s-442,i- -ot)}function mt(e,t,n,s,i){return tt(e-nt,s-230,n-st,n,i-305)}function gt(e,t,n,s,i){return Me(e-Je,t-214,n,s-Ze,i-et)}dt[ht(2518,"Xoa]",2067,0,2744)]=ht(2795,e,2557,0,t)+ht(792,"8N@2",n,0,694),dt[mt(1434,1208,s,609,789)]=ut(486,i,o,2161,"f1tM")+"al",dt[_t(1340,a,0,r,l)]=mt(1173,c,p,1922,d),dt[mt(513,h,u,_,904)]=gt(m,1708,"vBj8",1486,896)+ut(g,f,-b,C,x),dt[_t(-210,-189,0,"f1tM",308)]=ht(A,"Q*kn",1110,0,y)+_t(-v,B,0,p,89),dt[ht(w,"u[9e",2666,0,1963)]=gt(k,1492,S,1724,F)+"s",dt[ht(z,"1wIT",T,0,2977)]=ht(1638,I,M,0,E)+gt(D,O,"1wIT",H,1939);const ft=dt,bt=ft[ht(P,R,W,0,$)][ht(1743,N,U,0,1925)]("|");let Ct=0;for(;;){switch(bt[Ct++]){case"0":super[mt(G,0,X,j,q)+ht(1467,"0w9F",2214,0,1881)](ft[_t(K,-V,0,Q,Y)],["i","i2","i3","l3","i5","oo"]);continue;case"1":const e={};e[ut(146,-94,-530,-J,"Q*kn")]=3,e[ut(-826,-Z,-603,-1e3,ee)]=7,super[mt(te,0,p,1604,ne)+_t(se,1303,0,"f1tM",ie)+"y"](ft[mt(2026,0,"%h1%",oe,ae)],e);continue;case"2":super[mt(2118,0,x,re,le)+ht(ce,pe,de,0,2027)](ft[_t(883,112,0,"Q*kn",757)],[...Object[ht(he,ue,2051,0,2342)](L[ht(_e,me,ge,0,1906)+_t(fe,149,0,"JbuD",714)])],ft[gt(be,647,"FAYi",Ce,xe)]);continue;case"3":super[ht(Ae,ye,ve,0,Be)+ut(we,1249,1789,o,"xr&1")](ft[gt(2952,2241,Le,ke,2318)],[...L[gt(2341,1693,"G1OE",2139,1839)+ht(Fe,"cQJ7",2736,0,ze)]]);continue;case"4":super[gt(Te,Ie,Ee,De,Oe)+gt(He,2557,Pe,2803,2176)](ft[_t(215,-414,0,Re,-We)],[...Object[ht($e,Ne,2702,0,Ue)](L[mt(1307,0,"j$VH",Ge,2308)+ht(Xe,je,qe,0,Ke)+gt(2137,Ve,r,2948,Qe)+"es"])],ft[_t(797,1296,0,"#WnQ",Ye)]);continue}break}}static[tt(928,629,-269,"Uu0i",1508)+"e"](e,t){const n=t.tetrominoes,s=t.minotypes,i=t.tetrominoes_color,o=Object.keys(n);e.writeUInt(o.length,8);for(const t of o)e.writeString(t);for(const[t,o]of Object.entries(n)){const{matrix:n,preview:a}=o;e.writeDInt(n.w,this.$tiny),e.writeDInt(n.h,this.$tiny),e.writeUInt(n.dx,3),e.writeUInt(n.dy,3),e.writeDInt(n.data[0].length,this.$tiny);const[r,l]=[Ee.cla32(n.w-1),Ee.cla32(n.h-1)];for(const t of n.data)for(const[n,s]of t)e.writeUInt(n,r),e.writeUInt(s,l);e.writeDInt(a.w,this.$tiny),e.writeDInt(a.h,this.$tiny);const[c,p]=[Ee.cla32(a.w-1),Ee.cla32(a.h-1)];for(const[t,n]of a.data)e.writeUInt(t,c),e.writeUInt(n,p);e.writeBoolean(void 0!==o.weight),e.writeBoolean(o.spinbonus_override),e.writeBoolean(o.kickset_override),e.writeBoolean(o.kickset_special),e.writeBoolean(s.includes(t)),e.writeTable(i[t],this.$$colors),void 0!==o.weight&&e.writeDInt(o.weight,this.$tiny),o.spinbonus_override&&(e.writeTable(o.spinbonus_override.rule,this.$$spinbonus),e.writeBoolean(o.spinbonus_override.mini)),o.kickset_override&&e.writeTable(o.kickset_override,this.$$kicksets),o.kickset_special&&e.writeTable(o.kickset_special,this.$$special)}}static[ke(870,1656,1779,"RJfU",989)+"e"](e){const t={},n=[],s={},i=e.readUInt(8),o=[];for(let n=0;n<i;n++){const n=e.readString();t[n]={matrix:{},preview:{}},o.push(n)}for(const i of o){const o=t[i],{matrix:a,preview:r}=o;a.w=e.readDInt(this.$tiny),a.h=e.readDInt(this.$tiny),a.dx=e.readUInt(3),a.dy=e.readUInt(3);const l=e.readDInt(this.$tiny),[c,p]=[Ee.cla32(a.w-1),Ee.cla32(a.h-1)];a.data=[];for(let t=0;t<4;t++){a.data[t]=[];for(let n=0;n<l;n++){const[s,i]=[e.readUInt(c),e.readUInt(p)];a.data[t][n]=[s,i]}}r.w=e.readDInt(this.$tiny),r.h=e.readDInt(this.$tiny);const[d,h]=[Ee.cla32(r.w-1),Ee.cla32(r.h-1)];r.data=[];for(let t=0;t<l;t++){const[n,s]=[e.readUInt(d),e.readUInt(h)];r.data[t]=[n,s]}const u=e.readBoolean(),_=e.readBoolean(),m=e.readBoolean(),g=e.readBoolean(),f=e.readBoolean();s[i]=e.readTable(this.$$colors),u&&(o.weight=e.readDInt(this.$tiny)),_&&(o.spinbonus_override={rule:e.readTable(this.$$spinbonus),mini:e.readBoolean()}),m&&(o.kickset_override=e.readTable(this.$$kicksets)),g&&(o.kickset_special=e.readTable(this.$$special)),f&&n.push(i)}return{minotypes:n,tetrominoes:t,tetrominoes_color:s}}}class Je extends De{static[ke(867,1303,1669,"eij1",791)+Fe(1255,1272,961,754,"8N@2")]=[Se(1440,"xnZ2",1157,646,1508)+"an",Se(2328,"%h1%",1472,2521,1982)+"r",Fe(1550,966,998,1436,"w158"),Me(1598,2557,"8N@2",1172,2044)+"t",Fe(1243,720,-153,1481,"L(CX"),Se(1631,"cQJ7",2132,1084,1299)+"g"];static[Fe(841,1420,2073,1075,")!K^")+tt(1005,646,1233,")!K^",1350)]=ge[tt(1706,1671,1797,"cuHB",841)+Se(740,"ArG5",1068,994,1202)+"t"];static[tt(-234,548,-147,"tj0x",1275)](){const e="#WnQ",t=1906,n="xr&1",s=1705,i=2108,o="FAYi",a=1380,r=127,l=752,c="w158",p=182,d=484,h=1395,u=2466,_="X$pc",m=1080,g=1837,f=1822,b=2811,C=2888,x="F(AS",A=2001,y=1947,v="dIbx",B=1720,w=1926,L=2581,k="Vc@K",S=1567,F="&@t)",z=202,T=2668,I=2091,M=1038,E=543,D=264,O=516,H=2285,P="RJfU",R=2381,W=3,$=2,N="ArG5",U=188,G=521,X=1142,j="pI(B",q=868,K=2054,V="^n]x",Q=355,Y=1083,J="ArG5",Z=2045,ee="Q*kn",te=1480,ne=2988,se=2260,ie="qf#!",oe=1070,ae="jdm)",re="0w9F",le=110,ce=314,pe=325,de="K^(^",he=872,ue=358,_e=1046,me=1722,ge=1183,fe=2433,be=1484,Ce=1541,xe=1555,Ae=1140,ye=100,ve=117,Be="yNX0",we=489,Le=1526,ke=1063,ze=737,Te="u[9e",Ie=1535,Ee=216,De=940,Oe="cuHB",He=686,Pe="pSnb",Re=1371,We=771,$e=500,Ne=1668,Ue=1929,Ge=2478,Xe=2762,je=1544,qe=1502,Ke="cuHB",Ve=2223,Qe=878,Ye=1442,Je=408,Ze="qTX@",et=852,nt="qF#a",st=803,it="f1tM",ot=991,at=2273,rt=2306,lt=509,ct=1774,pt=2089,dt="tj0x",ht=1407,ut=1879,_t="3n*4",mt=1265,gt=1728,ft=2206,bt="vBj8",Ct=1358,xt="L(CX",At=1348,yt="8N@2",vt="oES7",Bt=")trV",wt=1981,Lt="qF#a",kt=982,St=1818,Ft=95,zt=459,Tt=525,It=2134,Mt=44,Et=573,Dt=302,Ot=122,Ht=49,Pt=404,Rt=49,Wt=167,$t=441,Nt=462,Ut=492;function Gt(e,t,n,s,i){return Se(e-Nt,t,n-288,s-Ut,i-60)}const Xt={};function jt(e,t,n,s,i){return Me(e-Wt,t-$t,n,s-362,t- -1101)}function qt(e,t,n,s,i){return Fe(e-12,s-Rt,n-139,s-230,n)}function Kt(e,t,n,s,i){return Me(e-Ot,t-Ht,t,s-Pt,s-448)}function Vt(e,t,n,s,i){return tt(e-Mt,e-Et,n-176,t,i-Dt)}Xt[qt(217,-690,e,-241,-1064)]=Gt(t,n,1504,s,i)+"ns",Xt[Gt(1606,o,a,1644,1388)]=qt(-r,l,c,p,d)+Gt(1467,o,h,u,2166),Xt[qt(1835,1291,_,m,g)]=Kt(f,"FAYi",b,2156,C),Xt[Gt(1059,x,A,y,1685)]=Vt(2120,v,B,2234,w),Xt[Kt(L,k,S,2309,2949)]=qt(560,-939,F,-z,505)+Kt(1280,"1wIT",T,I,2472),Xt[qt(-M,E,e,-D,O)]=Vt(H,P,2685,2653,R),Xt[qt(-881,615,"1PFJ",W,-$)]=qt(27,-115,N,U,G)+"o",Xt[jt(1892,1050,"JbuD",X)]=Gt(551,j,1329,1667,q)+"s",Xt[qt(K,0,V,1264)]=jt(Q,1089,")!K^",Y)+qt(-433,0,J,-146)+Kt(Z,ee,0,te),Xt[Kt(ne,"yNX0",0,se)]=function(e,t){return e!==t},Xt[Gt(-151,ie,oe,1391,505)]=qt(-631,0,"qTX@",-178),Xt[qt(-390,0,ae,86)]=function(e,t){return e===t},Xt[Vt(1980,"^n]x",1962,0,1421)]=jt(35,-226,re,-530),Xt[jt(le,1014,v,446)]=jt(-ce,-pe,de,-389),Xt[Vt(he,"pSnb",ue,0,_e)]=Kt(3013,x,0,2481);const Qt=Xt;super[jt(me,ge,")!K^",1656)+Gt(fe,de,be,Ce,xe)](Qt[jt(1935,Ae,"&@t)",1108)],Object[jt(-ye,ve,"yNX0",75)](this[Vt(1089,Be,we,0,1572)+Gt(Le,"L(CX",ke,149,ze)])),super[Vt(935,Te,Ie,0,Ee)+qt(De,0,Oe,He)](Qt[Vt(1322,Pe,Re,0,720)],["i","j","l","o","s","t","z",Qt[jt(We,$e,"Uu0i",820)],Qt[Vt(Ne,"K^(^",Ue,0,1707)]],Qt[Kt(Ge,"vBj8",0,2108)]),super[Vt(2117,"4An!",2094,0,1750)+Kt(2821,"0w9F",0,2284)](Qt[Kt(3309,"Uu0i",0,Xe)],[Qt[Kt(1468,"ArG5",0,je)],Qt[Vt(qe,"cuHB",1691,0,940)],Qt[Kt(1399,Ke,0,Ve)]],Qt[jt(191,Qe,"qF#a",Ye)]);for(const[e,t]of Object[qt(Je,0,Ze,627)+"es"](this[qt(et,0,nt,1350)+Vt(st,it,36,0,655)]))if(Qt[jt(1764,ot,"%h1%",1403)](Qt[Vt(2152,"xnZ2",1533,0,2280)],Qt[Gt(at,"xnZ2",rt,1346,1870)])){const e=KURISU.successful,t=DOREMY.gameoverreason,n=MAYURI.killer.gameid,s="spark"===TSUKASa.killer.type,i=NITORI.killer.username??"",{apm:o,pps:a,vsscore:r}=REISEN.aggregatestats,{game:l,stats:c,diyusi:p}=SUZUHA;KAGARI.writeBoolean(e),HECATIa.writeTable(t,this.$$gor),kivusaYhi.writeUInt(n,13),sekibaNki.writeBoolean(s,1),tsukasA.writeString(i),maribeL.writeStruct(wrigglE.options,chimatA),hecatiA.writeDouble(o),capybaRa.writeDouble(a),kageroU.writeDouble(r),wakasaGihime.writeStruct({game:l,stats:c,diyusi:p},clownpIece)}else if(t[jt(-899,-237,V,lt)+"ed"])if(Qt[Vt(ct,"Vc@K",1224,0,1022)](Qt[Kt(pt,dt,0,2324)],Qt[qt(ht,0,"Uu0i",981)]))super[Kt(2206,"j$VH",0,2176)+Vt(ut,_t,mt,0,gt)]("_"+e,t[Vt(ft,bt,Ct,0,2682)+"ed"]);else{const[e,t]=[mAyURI.readUInt(KAgUYA),WAkASAgihime.readUInt(DOrEMY)];KUrISU.data[KOgASA]=[e,t]}else if(t[Vt(2040,xt,At,0,1474)+Vt(807,yt,1658,0,-58)]){if(Qt[Kt(2001,vt,0,2802)](Qt[jt(-453,437,Bt,1344)],Qt[Kt(1365,"F(AS",0,2133)]))return this._insert(wrigGle,hecaTia);super[Vt(1796,"5hjj",wt,0,1705)+Vt(989,Lt,kt,0,St)]("_"+e,t[qt(613,0,"yNX0",-Ft)+Gt(zt,"8N@2",1268,127,Tt)],Qt[Vt(2012,dt,It,0,1543)])}}static*[Se(935,"Q*kn",920,590,1407)+Fe(749,-82,-431,-81,"qf#!")+"ns"](e){const{TypeOrders:t,OptsBook:n}=this,s=Object.keys(e).sort(((e,s)=>t.indexOf(n[e].type)-t.indexOf(n[s].type)));for(const t of s){const s=e[t],i=n[t];yield[t,s,i]}}static[tt(438,162,780,"xnZ2",-637)+"e"](e,t){for(const[n,s,i]of this.ParseOptions(t))switch(e.writeTable(n,this.$$options),i.type){case"object":if("handling"===n)e.writeFloat(s.arr,6,10),e.writeUInt(s.sdf,6),e.writeBoolean(s.safelock),e.writeBoolean(s.cancel),e.writeBoolean(s.may20g),e.writeFloat(s.das,8,10),e.writeFloat(s.dcd,8,10);else if("minoskin"===n){e.writeUInt(Object.keys(s).length,8);for(const[t,n]of Object.entries(s))e.writeTable(t,this.$$minoskin),e.writeTable(n,this.$$skins)}break;case"array":e.writeArray(s);break;case"boolean":e.writeBoolean(s);break;case"table":e.writeTable(s,this[`$$_${n}`],i.mode);break;case"number":e.writeNumber(s);break;case"string":e.writeString(s);break;default:throw new TypeError(`Unknown type for key: ${n} value: ${s} | got -> ${i.type}`)}e.writeTable(null,this.$$options)}static[tt(-336,448,1200,"RJfU",1170)+"e"](e){const t=this.$$options.size,n=this.OptsBook,s={};for(let i=e.peek(t);0!==i;i=e.peek(t)){const t=e.readTable(this.$$options),i=n[t]?.type;switch(i){case"object":if("handling"===t){const n={};n.arr=e.readFloat(6,10),n.sdf=e.readUInt(6),n.safelock=e.readBoolean(),n.cancel=e.readBoolean(),n.may20g=e.readBoolean(),n.das=e.readFloat(8,10),n.dcd=e.readFloat(8,10),s[t]=n}else if("minoskin"===t){const n={},i=e.readUInt(8);s[t]=n;for(let t=0;t<i;t++){const t=e.readTable(this.$$minoskin),s=e.readTable(this.$$skins);n[t]=s}}break;case"array":s[t]=e.readArray();break;case"boolean":s[t]=e.readBoolean();break;case"table":s[t]=e.readTable(this[`$$_${t}`]);break;case"number":s[t]=e.readNumber();break;case"string":s[t]=e.readString();break;default:throw new TypeError(`Unknown type for key: ${t} | got -> ${i}`)}}return e.seek(t,2),s}}class Ze extends Je{static*[ke(1138,1339,317,"L(CX",753)+ke(1503,1793,1229,"G1OE",1544)+"ns"](e){for(const[n,s,i]of super.ParseOptions(e))i.default!==s&&("object"===i.type&&t.strictShallowEqual(i.default,s)||(yield[n,s,i]))}}class et extends De{static[Fe(1451,851,348,1718,"JbuD")](){const e=17,t=317,n=90,s="#WnQ",i=345,o=97,a=167,r=428,l="@DgP",c=2145,p=1462,d=1740,h=")trV",u=336,_=1197,m=2180,g=1624,f="5hjj",b="8N@2",C=814,x=499,A=1759,y=2608,v=1289,B=1668,w=987,L="&@t)",k=2071,S="yNX0",F=566,z=221,T=1931,I=915,M="RJfU",E=273,D=3510,O="K^(^",H=1604,P=3339,R=3286,W=2577,$="Uu0i",N=1074,U=1122,G=2509,X=2641,j=2737,q="X$pc",K=2119,V=1356,Q=1522,Y=729,J="4An!",Z=1764,ee=703,te=333,ne="Q*kn",se=741,ie="^n]x",oe=1884,ae=2192,re=1994,le=1773,ce=2321,pe="j$VH",de=999,he=1321,ue=114,_e=391,me=3078,ge="w158",fe=385,be=31,Ce=931,xe=1351,Ae="qF#a",ye=542,ve=1718,Be=1014,we=466,Le=199,ke=151,ze=452,Te=280,Ie=7,Ee=439,De=52,Oe={};function He(e,t,n,s,i){return Se(e-474,e,n-276,s-De,i-508)}function Pe(e,t,n,s,i){return Me(e-9,t-Ie,n,s-Ee,e-284)}function Re(e,t,n,s,i){return Fe(e-381,t- -Te,n-276,s-7,e)}Oe[Re("3n*4",274,289,1124,-163)]=Re("1PFJ",e,-230,t,n),Oe[Re(s,-i,566,-964,-o)]=Re(")!K^",631,1508,a,r)+"t",Oe[Pe(1540,1436,"yNX0",1867,1949)]=He(l,c,p,1946,d)+Re(h,u,1048,1231,_)+"sh",Oe[Pe(m,2985,"tj0x",2630,1429)]=Ne(1944,g,465,1191,f)+"h",Oe[Pe(902,-5,b,C,x)]=$e(2645,A,"gGSn",2631,y),Oe[He(")!K^",0,v,B,w)]=$e(2070,2777,L,2187,k)+Re(S,F,-49,z,284)+"ar",Oe[He("qTX@",0,T,I,1077)]=Re(M,493,-72,-E,299)+"r",Oe[Pe(2714,D,O,3413)]=Pe(2196,H,"jdm)",3009)+"it",Oe[He("w158",0,P,2901,2620)]=$e(1742,R,"oES7",W,3365),Oe[He($,0,1273,N,U)]=$e(3314,G,"jdm)",X,3239),Oe[He("FAYi",0,j,2102,2302)]=He(q,0,1707,1577,K)+"ow",Oe[Pe(1064,338,")trV",V)]=$e(2712,2696,"L(CX",2381,2545)+Pe(Q,Y,J,1089);const We=Oe;function $e(e,t,n,s,i){return tt(e-ke,s-704,n-408,n,i-ze)}function Ne(e,t,n,s,i){return Me(e-we,t-54,i,s-Le,s- -956)}const Ue={};Ue[Re("Q*kn",214,399,1065)+Pe(1790,1080,"Q*kn",Z)]=!0,super[He("FAYi",0,3190,2895,2596)+Ne(982,ee,0,te,"gGSn")+"on"](this,Ue),super[Re(ne,se,1300,208)+He(ie,0,oe,1377,ae)](We[He("1wIT",0,re,1499,2001)],[null,We[Pe(le,ce,"j$VH",1001)],We[Re(pe,de,he,ue)],We[Re("cQJ7",1028,_e,1656)],We[Pe(2430,me,"pI(B",1737)],We[$e(1477,0,ge,1488,1985)],We[Re(f,-fe,-1292,be)],We[He("0w9F",0,Ce,1370,xe)],We[Re(Ae,-352,89,412)],We[$e(1618,0,"X$pc",1092,ye)],We[$e(1553,0,"Q*kn",2417,2628)],We[Pe(1184,ve,ie,Be)]])}static[Se(2476,"FAYi",1604,2124,1599)+"e"](e,t){const n=t.successful,s=t.gameoverreason,i=t.killer.gameid,o="spark"===t.killer.type,a=t.killer.username??"",{apm:r,pps:l,vsscore:c}=t.aggregatestats,{game:p,stats:d,diyusi:h}=t;e.writeBoolean(n),e.writeTable(s,this.$$gor),e.writeUInt(i,13),e.writeBoolean(o,1),e.writeString(a),e.writeStruct(t.options,Ze),e.writeDouble(r),e.writeDouble(l),e.writeDouble(c),e.writeStruct({game:p,stats:d,diyusi:h},$e)}static[Me(164,53,"8N@2",497,727)+"e"](e){const t={killer:{},aggregatestats:{}};return t.successful=e.readBoolean(),t.gameoverreason=e.readTable(this.$$gor),t.killer.gameid=e.readUInt(13),t.killer.type=e.readBoolean()?"spark":"sizzle",t.killer.username=e.readString(),t.options=e.readStruct(Ze),t.aggregatestats.apm=e.readDouble(),t.aggregatestats.pps=e.readDouble(),t.aggregatestats.vsscore=e.readDouble(),Object.assign(t,e.readStruct($e)),t}}function tt(e,t,n,s,i){return Te(t- -128,s)}function nt(e){const t=975,n=322,s=510,i=957,o=1265,a=2100,r=190,l=470,c=460,p=1187,d=1458,h=1669,u=1259,_=360,m=531,g=320,f=224,b="qTX@",C=790,x=87,A=507,y=220,v="Tfsa",B=151,w=10,L="dIbx",k=177,S=2074,F="xr&1",z=1422,T=688,I="j$VH",M=706,E=1606,D="qF#a",O=141,H=642,P=159,R=2279,W=1562,$=1336,N=1871,U=1120,G=1340,X=1030,j=19,q=662,K=181,V=1757,Q=1253,Y=1505,J=753,Z="pSnb",ee=667,te=1836,ne=431,se="F(AS",ie=12,oe=523,ae=1032,re="dIbx",le=1790,ce=857,pe=956,de=1229,he="@DgP",ue=349,_e=101,me=381,ge="Vc@K",fe=137,be=1280,Ce="oES7",xe=385,Ae={wakASaGIhiME:390},ye=79,ve=327,Be=461,we="f1tM",Le=191,Se=2873,Fe=2460,ze=1751,Ie=2956,Me=2258,Ee=341,De=1138,Oe=596,He="cQJ7",Pe=480,Re=356,We=1088,$e="cuHB",Ne=473,Ue=91,Ge="w158",Xe=650,je=1587,qe="%h1%",Ke=1002,Ve=1421,Qe="JbuD",Ye="#WnQ",Je=1877,Ze="jdm)",et=1108,nt="8N@2",st=820,it="u[9e",ot=868,at=177,rt="FAYi",lt=545,ct="qTX@",pt=211,dt=2066,ht=2415,ut="RJfU",_t=2285,mt="0w9F",gt=1423,ft=1150,bt=1808,Ct=1783,xt=2214,At=2936,yt=")!K^",vt=269,Bt="eij1",wt="Xoa]",Lt=3187,kt=2517,St=2155,Ft=382,zt=2163,Tt=1838,It=")trV",Mt=498,Et=1403,Dt=868,Ot=143,Ht="Tfsa",Pt=2674,Rt="cuHB",Wt=1840,$t=655,Nt=1474,Ut=1227,Gt=785,Xt=734,jt=147,qt=1505,Kt=580,Vt=632,Qt="^n]x",Yt=5,Jt=334,Zt="qf#!",en=36,tn="pSnb",nn=2120,sn=1454,on={waKasAgihiME:424,WaKasAgihiME:309};function an(e,t,n,s,i){return ke(e-150,t-352,n-489,n,s-84)}function rn(e,t,n,s,i){return tt(e-476,n-412,n-on.waKasAgihiME,i,i-on.WaKasAgihiME)}const ln={mTdxn:function(e,t){return e!==t},SbWFa:pn(t,n,s,i,"vBj8"),ilyIF:an(o,a,"xr&1",2010),vilLe:hn(r,119,"FAYi",l,c),cjCeG:hn(272,1197,"f1tM",p,d),SsIaN:function(e,t){return e===t},pwYxP:rn(1843,0,h,0,"Uu0i")+"g",GdoAO:function(e,t){return e!==t},anxVV:pn(418,u,1323,834,"pSnb"),nFpRK:pn(-_,-m,1018,g,"coSS")+an(f,1769,"Q*kn",944)+hn(1362,2301,b,1486,C),YBNtP:hn(-89,-83,"eij1",-x,-569)+"er",gEHAw:function(e,t){return e!==t},zmLwm:pn(-661,336,-A,-y,v),DWdlo:pn(-24,-B,113,431,"Q*kn"),ptlhE:function(e,t){return e!==t},HzcTK:function(e,t){return e+t},yMIam:function(e,t){return e/t},UwzaU:hn(w,313,L,-k,660)+"h",bBxlr:function(e,t){return e%t},vszPA:pn(-59,53,260,158,"ArG5"),iWdnA:dn(1516,S,F,1381,2287),dHdOS:function(e,t){return e+t},gRmWO:rn(z,0,T,0,"j$VH"),bdAgQ:hn(351,-265,I,628,155),KfyTi:pn(M,1304,E,821,D)+"n",ABsEU:pn(-29,O,-385,-627,"%h1%"),EgTdf:pn(-H,358,-P,-186,"Q*kn"),TuYHo:function(e,t){return e+t},XLOJi:rn(2020,0,R,0,"u[9e")+dn(W,1601,"4An!",$,N)+"t",OTeJI:function(e,t){return e(t)},xdNYs:function(e){return e()},ayUbf:an(U,G,"cuHB",X),wzobm:function(e,t){return e!==t},QwILh:hn(-j,631,"qf#!",q,-K),XMApM:hn(V,Q,"u[9e",1332,851),BvLEf:function(e,t){return e!==t},LiPbq:rn(1596,0,Y,0,F),DarCk:hn(426,J,Z,185,ee),TcOae:function(e,t){return e(t)}};function cn(e){const t=1411,n=704;function s(e,t,n,s,i){return an(e-367,t-122,t,s- -sn)}function i(e,t,n,s,i){return an(e-338,t-383,e,i-384)}const o={gKTTB:function(e,t){return ln[(n=tn,s=nn,Te(s-173,n))](e,t);var n,s},jFeiN:ln[i(we,2569,0,0,1694)],ghmhA:ln[s(-Le,"L(CX",0,681)],umjJU:ln[i("Uu0i",Se,0,0,2038)]};function a(e,t,n,s,i){return an(e-145,t-en,i,n- -66)}function r(e,t,s,i,o){return hn(e-316,t-168,s,e-n,o-211)}function l(e,t,n,s,i){return rn(e-415,0,t- -399,0,e)}if(ln[l(")!K^",1833)](ln[a(1413,Fe,ze,0,"Q*kn")],ln[a(2291,Ie,Me,0,"4An!")]))return!0;if(ln[i("Tfsa",2342,0,0,2963)](typeof e,ln[l("qf#!",Ee)])){if(!ln[i("Vc@K",De,0,0,1971)](ln[r(Oe,455,He,0,294)],ln[a(Pe,Re,We,0,$e)]))return function(e){}[s(-132,"5hjj",0,Ne)+r(681,Ue,"Vc@K",0,1185)+"r"](ln[l(Ge,Xe)])[a(661,je,951,0,"ArG5")](ln[r(1789,1363,qe,0,1319)]);mYstIA.writeUInt(kOgaSA,13)}else if(ln[a(Ke,1996,Ve,0,we)](ln[l(Qe,546)],ln[l(Ye,Je)]))if(ln[a(1274,671,1309,0,Ze)](ln[l("pSnb",1789)]("",ln[s(et,nt,0,st)](e,e))[ln[s(827,it,0,ot)]],1)||ln[r(632,574,"K^(^",0,at)](ln[s(-703,rt,0,-647)](e,20),0)){if(ln[s(-lt,ct,0,pt)](ln[r(1803,1490,"yNX0",0,dt)],ln[i("cQJ7",ht,0,0,2939)]))return MoKOu.ceil(this._size/8);(function(){function e(e,t,n,i,o){return s(e-415,n,0,e-222)}return!!o[e(-Jt,0,"4An!")](o[e(-113,0,Zt)],o[e(299,0,")!K^")])||DoRemy})[l(ut,1188)+a(_t,1807,2224,0,mt)+"r"](ln[a(gt,ft,bt,0,"pSnb")](ln[r(Ct,1085,"j$VH",0,1773)],ln[r(xt,At,"&@t)",0,2741)]))[r(1124,1836,yt,0,vt)](ln[a(2873,2888,2492,0,Bt)])}else ln[i(wt,Lt,0,0,kt)](ln[i("qTX@",2928,0,0,St)],ln[s(Ft,yt,0,-209)])?function(){const e=3;function n(t,n,s,i,o){return r(s-86,n-155,i,0,o-e)}return!!o[n(0,Xt,610,")trV",-jt)](o[(i=qt,a="ArG5",l=2367,s(i-184,a,0,l-t))],o[n(0,Kt,Vt,Qt,Yt)])&&RUMIa.encode(this,CLOWnpiece);var i,a,l}[r(zt,Tt,It,0,2385)+r(Mt,607,"f1tM",0,Et)+"r"](ln[s(-Dt,"eij1",0,-Ot)](ln[r(2180,2535,Ht,0,Pt)],ln[r(je,774,Rt,0,Wt)]))[r(1184,421,"Vc@K",0,942)](ln[r($t,1386,"ArG5",0,Nt)]):HEcATIa.weight=CLoWNPiece.readDInt(this.$tiny);else dorEMY.writeTable(marIBEl.spinbonus_override.rule,this.$$spinbonus),murASA.writeBoolean(tsuKASa.spinbonus_override.mini);ln[a(Ut,1159,Gt,0,"Uu0i")](cn,++e)}function pn(e,t,n,s,i){return tt(e-Be,s- -838,n-489,i,i-250)}function dn(e,t,n,s,i){return ke(e-ye,t-ve,n-418,n,s- -1124)}function hn(e,t,n,s,i){return tt(e-206,s- -Ae.wakASaGIhiME,n-372,n,i-353)}try{if(ln[rn(1597,0,te,0,"K^(^")](ln[hn(-ne,0,se,-ie,-549)],ln[dn(oe,ae,re,1167)]))ln[an(2020,1525,"3n*4",le)](rUmia);else{if(e)return ln[rn(1376,0,ce,0,"vBj8")](ln[dn(pe,de,he,ue)],ln[pn(9,0,_e,416,"Xoa]")])?cn:reNkO.Number.decode(this);ln[pn(496,0,-1004,-me,"j$VH")](ln[an(1979,1748,ge,1929)],ln[rn(1872,0,1490,0,"1PFJ")])?ln[dn(fe,-be,Ce,-xe)](cn,0):(MOkOU.writeUInt(OKaBE,13),YUkARi.writeUInt(SUzUHa,10),MArIBel.writeDInt(SEiJA,KAgARi.$long),MUrASa.writeUInt(SAnAE,ALiCE.MAX_WIDTH),HEcATia.writeUInt(MAyURi,KAgERou.MAX_HEIGHT),REmILia.writeStruct(MArISa,CApYBara))}}catch(e){}}Ee[ke(2994,2779,2104,"Uu0i",2130)](),He[Me(359,882,"RJfU",1861,1074)](),Pe[Fe(678,435,316,650,"f1tM")](),Re[ke(2035,937,463,"Tfsa",1306)](),We[Se(296,"0w9F",1371,1867,1127)](),$e[Fe(1548,1195,874,830,"yNX0")](),Ne[Me(2123,1196,"j$VH",1185,1508)](),Ue[Fe(1746,1115,2005,963,"G1OE")](),Ge[Me(1985,1774,"JbuD",1445,1819)](),Xe[Me(1322,2167,"j$VH",954,1508)](),je[Se(1520,"JbuD",2129,1690,1587)](),qe[Se(2416,"eij1",2140,1402,1761)](),Ke[Me(1687,692,"Xoa]",1382,1391)](),Ve[Fe(-424,-153,-593,685,"4An!")](),Ye[Fe(2114,1238,518,951,"L(CX")](),Qe[tt(1859,1589,1880,"Uu0i",2480)](),Je[tt(1137,1597,1678,"1PFJ",829)](),et[ke(1962,2465,1834,"xnZ2",1992)](),De[Me(1073,1391,"0w9F",2494,1683)+Se(1356,"Xoa]",2574,1032,1677)+ke(1608,1584,336,"Uu0i",1034)](n),we[ke(1344,1198,2089,"Vc@K",1247)+Fe(522,787,-116,921,"K^(^")+"r"](ye,ve);class st{static _CACHE_MAXSIZE=4096;static _BATCH_TIMEOUT=25;static _CLOSE_CODES={1e3:"ribbon closed normally",1001:"client closed ribbon",1002:"protocol error",1003:"protocol violation",1005:"no error provided",1006:"ribbon lost",1007:"payload data corrupted",1008:"protocol violation",1009:"too much data",1010:"negotiation error",1011:"server error",1012:"server restarting",1013:"temporary error",1014:"bad gateway",1015:"TLS error"};static FLAG={ALIVE:1,SUCCESSFUL:2,CONNECTING:4,FAST_PING:8,TIMING_OUT:16,DEAD:32};constructor(e){this._uri=e,this._ws=null,this._id=null,this._tokenid=null,this._spoolid=null,this._sentid=0,this._recvid=0,this._heartbeat=0,this._flags=0,this._lastReason="ribbon lost",this._sentQueue=[],this._recvQueue=[],this._corkQueue=null,this._logs=[],this._lastPush=performance.now(),this._listeners=new Map,this._handlers=new Map,this._pingItvId=setInterval(this._PingInterval.bind(this),2500),this._lastPing=0;for(const e of we.GetHandlers())this._handlers.set(e,[]);this._reconnectLast=0,this._reconnectCount=0,this._reconnectPenalty=0,this._reconnectTime=null}get id(){return this._id}get endpoint(){return this._uri}get spool(){return this._spoolid}get logs(){return this._logs}get _prefix(){}_PushLogs(e){}LogInfo(e,...t){}LogWarn(e,...t){}LogError(e,...t){}_OnOpen(){this._flags|=st.FLAG.ALIVE|st.FLAG.SUCCESSFUL,this._flags&=~st.FLAG.TIMING_OUT,this._tokenid?this.send("session",{ribbonid:this._id,tokenid:this._tokenid}):this.send("new")}async _OnMessage(t){this._flags|=st.FLAG.ALIVE,this._flags&=~st.FLAG.TIMING_OUT;try{const n=await new Response(t.data).arrayBuffer(),s=e.from(n),i=we.Decode(s);this._ProcessMessage(i),this._ProcessQueue()}catch(e){}}_OnError(e){this.HasConnectedOnce()||this._run("connect_error")}_OnClose(e){this._ws=null,this._lastReason=st._CLOSE_CODES[e.code],this._flags|=st.FLAG.CONNECTING,"ribbon lost"===this._lastReason&&(this.IsTimingOut()?this._lastReason="ping timeout":this.HasConnectedOnce()||(this._lastReason="failed to connect")),this.reconnect()}_PingInterval(){if(this._heartbeat++,this._ShouldPing()){if(!this.IsAlive())return this._flags|=st.FLAG.TIMING_OUT|st.FLAG.ALIVE|st.FLAG.CONNECTING,this.reconnect();this._flags&=~st.FLAG.ALIVE,this.IsConnected()&&(this._lastPing=Date.now(),this.send("ping",{recvid:this._recvid}))}}_ShouldPing(){return!(!(this._flags&st.FLAG.FAST_PING)||this.IsTimingOut())||this._heartbeat%2==0}_ProcessMessage(e){return e.id?e.id<=this._recvid?void 0:e.id===this._recvid+1?this._RunMessage(e):void this._recvQueue.push(e):this._RunMessage(e)}_ProcessQueue(){if(this._recvQueue.length){if(this._recvQueue.length>st._CACHE_MAXSIZE)return this.close("too many lost packets");for(this._recvQueue.sort(((e,t)=>e.id-t.id));this._recvQueue.length;){const e=this._recvQueue[0];if(e.id<=this._recvid)this._recvQueue.shift();else{if(e.id!==this._recvid+1)break;this._RunMessage(this._recvQueue.shift())}}}}_RunMessage(e){switch(e.id&&(this._recvid=e.id),e.command){case"session":{const{ribbonid:t,tokenid:n}=e.data;this._flags&=~st.FLAG.CONNECTING,this._id=t,this._tokenid&&this.send("packets",{packets:this._sentQueue.map((e=>e.packet))}),this._tokenid=n,this._run("open"),this._run("save",this._lastReason);break}case"ping":{const t=e.data.recvid;for(this._emit("ping",{ms:Date.now()-this._lastPing});this._sentQueue.length&&this._sentQueue[0].id<=t;)this._sentQueue.shift();break}case"kick":{const{reason:t}=e.data;this._lastReason="server closed ribbon",this._emit("kick",t),this.close();break}case"nope":{const{reason:t}=e.data;this._lastReason=t,this.close();break}case"packets":e.data.packets.forEach((e=>this._ProcessMessage(we.Decode(e))));break;case"server.authorize":this._run("authorized",e.data);default:if(this._corkQueue)return this._corkQueue.push(e);this._emit(e.command,e.data)}}HasConnectedOnce(){return this._flags&st.FLAG.SUCCESSFUL}IsConnected(){return 1===this._ws?.readyState}IsConnecting(){return this._flags&st.FLAG.CONNECTING}IsAlive(){return this._flags&st.FLAG.ALIVE}IsTimingOut(){return this._flags&st.FLAG.TIMING_OUT}IsDead(){return this._flags&st.FLAG.DEAD}SetEndpoint(e){this._uri=e}SetSpoolID(e){this._spoolid=e}SetFasterPing(e){this._flags=this._flags&~st.FLAG.FAST_PING|e<<Math.log2(st.FLAG.FAST_PING)}async Switch(e=this._uri){this._uri=e,this._flags|=st.FLAG.CONNECTING,await Ot(5),this._reconnect_internal()}connect(){this._ws&&(this._ws.onopen=null,this._ws.onclose=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.close()),this._flags|=st.FLAG.CONNECTING,this._ws=new WebSocket(this._uri,this._spoolid),this._ws.onopen=this._OnOpen.bind(this),this._ws.onclose=this._OnClose.bind(this),this._ws.onerror=this._OnError.bind(this),this._ws.onmessage=this._OnMessage.bind(this)}reconnect(){if(this._reconnectTime)return;if(this._ws?.close(),Date.now()-this._reconnectLast>4e4&&(this._reconnectCount=0),this._reconnectLast=Date.now(),this._reconnectCount>=20||this.IsDead()){const e=this.IsDead()?"may not reconnect":"too many reconnects";return this.close(e)}const e=this._reconnectPenalty+5+100*this._reconnectCount;this._run("resume",e),clearTimeout(this._reconnectTime),this._reconnectTime=setTimeout(this._reconnect_internal.bind(this),e),this._reconnectPenalty=0,this._reconnectCount++}_reconnect_internal(){this._reconnectTime=null,this.IsDead()||(this._run("reconnect"),this.connect())}send(e,t,n){const s=we.Encode(e,t,n);if(!(s[0]&we.FLAG.F_ID))return this._send_internal(s);const i=++this._sentid;if(new r(s).seek(8).write(i,24),this._sentQueue.push({id:i,packet:s}),!this.IsConnecting()){for(;this._sentQueue.length>st._CACHE_MAXSIZE;)this._sentQueue.shift();if(this.IsConnected())return this._send_internal(s)}}_send_internal(e){try{this._ws.send(e),window.XDBG_LASTSEND=Date.now()}catch(e){}}_run(e,t){this._listeners.get(e)?.forEach((e=>e(t)))}listen(e,t){this._listeners.get(e)||this._listeners.set(e,[]),this._listeners.get(e).push(t)}cork(){null==this._corkQueue&&(this._corkQueue=[])}uncork(){if(this._corkQueue){for(const{command:e,data:t}of this._corkQueue)this._emit(e,t);this._corkQueue=null}}_emit(e,t){if(!this._handlers.has(e))throw new ReferenceError(`Received an unknown command: ${e} --\x3e ${t}`);this._handlers.get(e).forEach((e=>e(t)))}on(e,t){this._handlers.get(e).push(t)}off(e,t){if(!t)return this._handlers.get(e).length=0;this._handlers.get(e).filter((e=>e!==t))}close(e=this._lastReason){this._lastReason=e,this._run("close",e);try{this.IsConnected()&&this.send("die"),this._ws?.close()}catch(e){}this._flags|=st.FLAG.DEAD,clearInterval(this._pingItvId)}cut(e=0){this._reconnectPenalty=e,this._ws?.close()}}const it={controls:{style:"guideline",custom:{moveLeft:[],moveRight:[],softDrop:[],hardDrop:[],rotateCCW:[],rotateCW:[],rotate180:[],hold:[],exit:[],retry:[],chat:[],target1:[],target2:[],target3:[],target4:[],menuUp:[],menuDown:[],menuLeft:[],menuRight:[],menuBack:[],menuConfirm:[],openSocial:[]},sensitivity:.5,vibration:1},handling:{arr:2,das:10,dcd:0,sdf:6,safelock:!0,cancel:!1,may20g:!0},volume:{disable:!1,music:1,sfx:1,stereo:.5,others:!0,attacks:!0,next:!1,noreset:!0,oof:!0,scrollable:!0,bgmtweak:{}},video:{graphics:"high",caching:"low",actiontext:"all",particles:.6,background:.7,bounciness:1,shakiness:1,gridopacity:.1,boardopacity:.85,shadowopacity:.15,zoom:1,alwaystiny:!1,nosuperlobbyanim:!1,nozenithanim:!1,colorshadow:!1,holdlocked:!0,sidebyside:!0,spin:!0,chatfilter:!0,background_url:null,background_usecustom:null,nochat:!1,hideroomids:!1,emotes:!0,emotes_anim:!0,siren:!0,powersave:!1,invert:!1,nobg:!1,chatbg:!0,replaytoolsnocollapse:!1,kos:!0,fire:!0,focuswarning:!0,hidenetwork:!1,guide:!0,lowrescounters:!1,desktopnotifications:!0,lowres:!1,webgl:"webgl2",bloom:1,chroma:.5,flashwave:1},gameoptions:{pro_40l:!1,pro_40l_alert:!1,pro_40l_retry:!1,stride_40l:!1,slot_40l_counter1:void 0,slot_40l_counter2:void 0,slot_40l_counter3:void 0,slot_40l_counter4:void 0,slot_40l_counter5:void 0,pro_blitz:!1,pro_blitz_alert:!1,pro_blitz_retry:!1,stride_blitz:!1,slot_blitz_counter1:void 0,slot_blitz_counter2:void 0,slot_blitz_counter3:void 0,slot_blitz_counter4:void 0,slot_blitz_counter5:void 0},electron:{loginskip:"always",frameratelimit:"4x",presence:!0,taskbarflash:!0,autoupdate:!0,anglecompat:!1,adblock:!1},notifications:{suppress:!1,forcesound:!0,online:"ingame",offline:"off",dm:"both",dm_pending:"both",invite:"both",other:"both"}},ot="ID_2",at={moveLeft:["A","KEYA","NUMPAD4"],moveRight:["D","KEYD","NUMPAD6"],softDrop:["W","KEYW","NUMPAD8"],hardDrop:["S","KEYS","NUMPAD5"],rotateCCW:["ARROWLEFT","LEFT","NUMPAD7"],rotateCW:["ARROWRIGHT","RIGHT","NUMPAD9"],rotate180:["ARROWUP","UP","NUMPAD2"],hold:["SHIFT","SHIFTLEFT","NUMPADENTER"],exit:["ESCAPE"],retry:["R","KEYR"],chat:["T","KEYT"],target1:["1","DIGIT1"],target2:["2","DIGIT2"],target3:["3","DIGIT3"],target4:["4","DIGIT4"],menuUp:["W","KEYW","ARROWUP","UP"],menuDown:["S","KEYS","ARROWDOWN","DOWN"],menuLeft:["A","KEYA","ARROWLEFT","LEFT"],menuRight:["D","KEYD","ARROWRIGHT","RIGHT"],menuBack:["ESCAPE","BACKSPACE"],menuConfirm:["ENTER","NUMPADENTER","SPACE"],openSocial:["TAB"]},rt={moveLeft:["ARROWLEFT","LEFT","NUMPAD4"],moveRight:["ARROWRIGHT","RIGHT","NUMPAD6"],softDrop:["ARROWDOWN","DOWN","NUMPAD2"],hardDrop:["SPACE","NUMPAD8"],rotateCCW:["CONTROL","CONTROLLEFT","Z","KEYZ","NUMPAD3","NUMPAD7"],rotateCW:["ARROWUP","UP","X","KEYX","NUMPAD1","NUMPAD5","NUMPAD9"],rotate180:["A","KEYA"],hold:["SHIFT","SHIFTLEFT","C","KEYC","NUMPAD0"],exit:["ESCAPE"],retry:["R","KEYR"],chat:["T","KEYT"],target1:["1","DIGIT1"],target2:["2","DIGIT2"],target3:["3","DIGIT3"],target4:["4","DIGIT4"],menuUp:["W","KEYW","ARROWUP","UP"],menuDown:["S","KEYS","ARROWDOWN","DOWN"],menuLeft:["A","KEYA","ARROWLEFT","LEFT"],menuRight:["D","KEYD","ARROWRIGHT","RIGHT"],menuBack:["ESCAPE","BACKSPACE"],menuConfirm:["ENTER","NUMPADENTER","SPACE"],openSocial:["TAB"]},lt={moveLeft:["A","KEYA","NUMPAD4"],moveRight:["D","KEYD","NUMPAD6"],softDrop:["W","KEYW","NUMPAD8"],hardDrop:["S","KEYS","NUMPAD5"],rotateCCW:["ARROWLEFT","LEFT","NUMPAD7"],rotateCW:["ARROWRIGHT","RIGHT","NUMPAD9"],rotate180:["ARROWUP","UP","NUMPAD2"],hold:["SHIFT","SHIFTLEFT","NUMPADENTER"],exit:["ESCAPE"],retry:["R","KEYR"],chat:["T","KEYT"],target1:["1","DIGIT1"],target2:["2","DIGIT2"],target3:["3","DIGIT3"],target4:["4","DIGIT4"],menuUp:["W","KEYW","ARROWUP","UP"],menuDown:["S","KEYS","ARROWDOWN","DOWN"],menuLeft:["A","KEYA","ARROWLEFT","LEFT"],menuRight:["D","KEYD","ARROWRIGHT","RIGHT"],menuBack:["ESCAPE","BACKSPACE"],menuConfirm:["ENTER","NUMPADENTER","SPACE"],openSocial:["TAB"]},ct={moveLeft:["BUTTON_14"],moveRight:["BUTTON_15"],softDrop:["BUTTON_13"],hardDrop:["BUTTON_12"],rotateCCW:["BUTTON_0"],rotateCW:["BUTTON_1"],rotate180:["BUTTON_3"],hold:["BUTTON_4","BUTTON_5"],exit:["BUTTON_8"],retry:["BUTTON_9"],chat:[],target1:["AXIS_1_NEG"],target2:["AXIS_0_POS"],target3:["AXIS_1_POS"],target4:["AXIS_0_NEG"],menuUp:["BUTTON_12"],menuDown:["BUTTON_13"],menuLeft:["BUTTON_14"],menuRight:["BUTTON_15"],menuBack:["BUTTON_1"],menuConfirm:["BUTTON_0"],openSocial:[]},pt=["../res/bg/1.jpg","../res/bg/2.jpg","../res/bg/3.jpg","../res/bg/4.jpg","../res/bg/5.jpg","../res/bg/6.jpg","../res/bg/7.jpg","../res/bg/8.jpg","../res/bg/9.jpg","../res/bg/10.jpg","../res/bg/11.jpg","../res/bg/12.jpg","../res/bg/13.jpg","../res/bg/14.jpg","../res/bg/15.jpg","../res/bg/16.jpg","../res/bg/17.jpg","../res/bg/18.jpg","../res/bg/19.jpg","../res/bg/20.jpg","../res/bg/21.jpg","../res/bg/22.jpg","../res/bg/23.jpg","../res/bg/24.jpg","../res/bg/25.jpg","../res/bg/26.jpg","../res/bg/27.jpg","../res/bg/28.jpg","../res/bg/29.jpg","../res/bg/30.jpg","../res/bg/31.jpg","../res/bg/32.jpg","../res/bg/33.jpg","../res/bg/34.jpg","../res/bg/35.jpg"],dt=[];let ht="",ut=!0;function _t(){localStorage.setItem("userConfig",JSON.stringify(it))}function mt(){const e=localStorage.getItem("userConfig");if(!e){console.log("First boot - welcome to TETR.IO!");const e=localStorage.getItem("feecofScore")||0;return it.video.graphics=e<3e5?"low":e<6e5?"medium":e<1e6||!window.IS_ELECTRON?"high":"ultra",void console.log(`Autoselected graphics mode ${it.video.graphics}`)}Object.assign(it,JSON.parse(e))}let gt=-1;function ft(){switch(Object.keys(rt).forEach((e=>{void 0===it.controls.custom[e]&&(it.controls.custom[e]=[])})),it.controls.style){case"guideline":{const e={...rt};for(const[t,n]of Object.entries(e))e[t]=[...n,...ct[t]];Object.assign(at,e);break}case"wasd":{const e={...lt};for(const[t,n]of Object.entries(e))e[t]=[...n,...ct[t]];Object.assign(at,e);break}case"custom":{Object.assign(at,it.controls.custom);let e=!1;Object.keys(at).forEach((t=>{at[t].forEach((t=>{null!==t&&t!==t.toUpperCase()&&(e=!0)}))})),e&&(it.controls.custom=rt,Object.assign(at,it.controls.custom),Kt({msg:"your keybinds were reset due to an update. please re-enter them!",color:"#FF4200",icon:"error",timeout:15e3}));break}}}function bt(){if(ft(),it.handling.arr=parseFloat(it.handling.arr),it.handling.das=parseFloat(it.handling.das),it.handling.sdf=parseFloat(it.handling.sdf),it.handling.dcd=parseFloat(it.handling.dcd||0),it.volume.music=parseFloat(it.volume.music),it.volume.sfx=parseFloat(it.volume.sfx),it.volume.stereo=parseFloat(it.volume.stereo),na.SetBgmVolume(it.volume.music),it.volume.disable&&na.KillBgm(),document.body.setAttribute("data-graphics",it.video.graphics),il&&it.video.background!==gt&&(il.alpha=it.video.background,gt=it.video.background),ut){if(dt.length=0,(it.video.background_url||"").split(",").forEach((e=>e&&dt.push(e.trim()))),ht=it.video.background_usecustom===ot?dt:pt,Ns.length=0,ht===dt)for(const[e,t]of dt.entries())Gs(t).then((t=>!t&&Yt(`failed to load background #${e+1}`)));Us(!0),ut=!1}sl&&(sl.alpha=Math.min(1,10*it.video.background)),document.body.classList.toggle("noingamechat",!!it.video.nochat),document.body.classList.toggle("hideroomids",!!it.video.hideroomids),xt("multi_join").type=it.video.hideroomids?"password":"text",document.body.classList.toggle("invert",!!it.video.invert),document.body.classList.toggle("nobg",!!it.video.nobg),document.body.classList.toggle("chatbg",!!it.video.chatbg),document.body.classList.toggle("replaytoolsnocollapse",!!it.video.replaytoolsnocollapse),document.body.classList.toggle("hidenetwork",!!it.video.hidenetwork),document.body.classList.toggle("hidefocuswarning",!1===it.video.focuswarning),document.body.classList.toggle("ceriad_blocked",!!(_.noceriad||window.IS_ELECTRON&&(it.electron.adblock||window.TETRAKARN))),document.body.classList.toggle("ceriad_disabled",document.body.classList.contains("ceriad_blocked")||document.body.classList.contains("ceriad_exempt")||document.body.classList.contains("ceriad_unavailable")),xt("sys_guide").classList.toggle("hidden",!1===it.video.guide),xt("room_opts_welcome").classList.toggle("hidden",!1===it.video.guide),yl(),Al(),window.IS_ELECTRON&&window.IPC.send("anglecompat",!!it.electron.anglecompat),$s()}function Ct(e){return e.code?e.code.toUpperCase():e.key?" "===e.key?"SPACE":3===e.location?`NUMPAD${e.key.toUpperCase()}`:e.key.toUpperCase():e.detail?.toUpperCase()??!1}mt();const xt=(...)=>document.getElementById(...),At=(...)=>document.querySelector(...),yt=(...)=>document.querySelectorAll(...);function vt(e,t,n){if(!t)return e;const s=t.split(".");for(;s.length;){const t=s.shift(),i=t.indexOf("[");if(-1===i){if(void 0!==n&&(void 0===e[t]&&(e[t]={}),0===s.length))return e[t]=n,e;e=e[t];continue}const o=t.substring(0,i),a=~~t.substring(i+1,t.length-1);void 0===e[o]&&(e[o]=[]),void 0!==n&&0===s.length&&(e[o][a]=n),e=e[o][a]}return e}function Bt(e){const t=Math.round(e),n=t%1e3,s=Math.floor(t/1e3)%60,i=Math.floor(t/6e4);return{ms:n.toString().padStart(3,"0"),s:s.toString().padStart(2,"0"),m:i.toString()}}function wt(e){const t=Math.abs(Math.floor((new Date-e)/1e3));let n=Math.floor(t/31536e3);return n>1?`${n} years`:(n=Math.floor(t/2592e3),n>1?`${n} months`:(n=Math.floor(t/86400),n>1?`${n} days`:(n=Math.floor(t/3600),n>1?`${n} hours`:(n=Math.floor(t/60),n>1?`${n} minutes`:`${Math.floor(t)} seconds`))))}function Lt(e){let t=Math.floor(e/3600);return t>1?`${t}<span>H</span>`:(t=Math.floor(e/60),t>1?`${t}<span>M</span>`:`${Math.floor(e)}<span>S</span>`)}function kt(e){const t=Math.abs(Math.floor((new Date-e)/1e3));if(t<10)return"now";let n=Math.floor(t/86400);return n>1?`${n}d`:(n=Math.floor(t/3600),n>1?`${n}h`:(n=Math.floor(t/60),n>1?`${n}m`:`${Math.floor(t)}s`))}function St(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML.replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function Ft(e){return e=(e=(e=(e=(e=(e=(e=(e=St(e).replace('"',"&quot;")).replace(/!\[(.+?)\]\((https?:\/\/[^\s/$.?#"][^\s"()]*)\)/gi,'<img class="chat_img" src="$2" alt="$1">')).replace(/\[(.+?)\]\((https?:\/\/[^\s/$.?#"][^\s"()]*)\)/gi,'<a class="chatlink" href="$2" target="_blank" rel="nofollow noopener noreferrer" referrerpolicy="origin-when-cross-origin">$1</a>')).replace(/# (.+)/g,"<h2>$1</h2>")).replace(/[*]{2}(.+?)[*]{2}/g,"<b>$1</b>")).replace(/[_](.+?)[_](?!\S)/g,"<i>$1</i>")).replace(/~~(.+?)~~/g,"<s>$1</s>")).replace(/~(.+?)~/g,"<u>$1</u>")}function zt(e){try{return!!new URL(e)}catch{return!1}}const Tt={5e5:"",4e5:"",1e5:"",9e4:"",5e4:"",4e4:"",1e4:"",9e3:"",5e3:"",4e3:"",1e3:"",900:"",500:"",400:"",100:"",90:"",50:"",40:"",10:"",9:"",5:"",4:"",1:""};function It(e){const t=Object.keys(Tt);let n="";for(e=Math.max(0,Math.floor(e));e>=1;)for(let s=t.length-1;s>=0;s--)if(e/parseInt(t[s])>=1){e-=parseInt(t[s]),n+=Tt[t[s]];break}return n}const Mt=new Map;function Et(e){if(Mt.has(e))return Mt.get(e);const t=`data:image/svg+xml;base64,${new u(Rt(e),{background:[0,0,0,200],margin:.15,size:300,brightness:.48,saturation:.65,format:"svg"}).toString()}`;return Mt.set(e,t),t}function Dt(e=1,t=4,n="ABCDEFGHJKLMNPQRSTUVWXYZ"){let s="";const i=e+Math.floor((t-e+1)*Math.random());for(let e=0;e<i;e++)s+=n[Math.floor(Math.random()*n.length)];return s}function Ot(e){return new Promise((t=>setTimeout(t,e)))}function Ht(e){try{_paq.push(["trackEvent","Advertising","Impression",e])}catch{}}function Pt(e){try{_paq.push(e)}catch{}}function Rt(e){function t(e,t){var n,s,i,o,a;return i=2147483648&e,o=2147483648&t,a=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(s=1073741824&t)?2147483648^a^i^o:n|s?1073741824&a?3221225472^a^i^o:1073741824^a^i^o:a^i^o}function n(e,n,s,i,o,a,r){return e=t(e,t(t(n&s|~n&i,o),r)),t(e<<a|e>>>32-a,n)}function s(e,n,s,i,o,a,r){return e=t(e,t(t(n&i|s&~i,o),r)),t(e<<a|e>>>32-a,n)}function i(e,n,s,i,o,a,r){return e=t(e,t(t(n^s^i,o),r)),t(e<<a|e>>>32-a,n)}function o(e,n,s,i,o,a,r){return e=t(e,t(t(s^(n|~i),o),r)),t(e<<a|e>>>32-a,n)}function a(e){var t,n="",s="";for(t=0;3>=t;t++)n+=(s="0"+(s=e>>>8*t&255).toString(16)).substr(s.length-2,2);return n}var r,l,c,p,d,h,u,_,m;for(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var s=e.charCodeAt(n);128>s?t+=String.fromCharCode(s):(127<s&&2048>s?t+=String.fromCharCode(s>>6|192):(t+=String.fromCharCode(s>>12|224),t+=String.fromCharCode(s>>6&63|128)),t+=String.fromCharCode(63&s|128))}return t}(e),r=function(e){for(var t,n=e.length,s=16*(((t=n+8)-t%64)/64+1),i=Array(s-1),o=0,a=0;a<n;)o=a%4*8,i[t=(a-a%4)/4]|=e.charCodeAt(a)<<o,a++;return i[t=(a-a%4)/4]|=128<<a%4*8,i[s-2]=n<<3,i[s-1]=n>>>29,i}(e),h=1732584193,u=4023233417,_=2562383102,m=271733878,e=0;e<r.length;e+=16)l=h,c=u,p=_,d=m,h=n(h,u,_,m,r[e+0],7,3614090360),m=n(m,h,u,_,r[e+1],12,3905402710),_=n(_,m,h,u,r[e+2],17,606105819),u=n(u,_,m,h,r[e+3],22,3250441966),h=n(h,u,_,m,r[e+4],7,4118548399),m=n(m,h,u,_,r[e+5],12,1200080426),_=n(_,m,h,u,r[e+6],17,2821735955),u=n(u,_,m,h,r[e+7],22,4249261313),h=n(h,u,_,m,r[e+8],7,1770035416),m=n(m,h,u,_,r[e+9],12,2336552879),_=n(_,m,h,u,r[e+10],17,4294925233),u=n(u,_,m,h,r[e+11],22,2304563134),h=n(h,u,_,m,r[e+12],7,1804603682),m=n(m,h,u,_,r[e+13],12,4254626195),_=n(_,m,h,u,r[e+14],17,2792965006),h=s(h,u=n(u,_,m,h,r[e+15],22,1236535329),_,m,r[e+1],5,4129170786),m=s(m,h,u,_,r[e+6],9,3225465664),_=s(_,m,h,u,r[e+11],14,643717713),u=s(u,_,m,h,r[e+0],20,3921069994),h=s(h,u,_,m,r[e+5],5,3593408605),m=s(m,h,u,_,r[e+10],9,38016083),_=s(_,m,h,u,r[e+15],14,3634488961),u=s(u,_,m,h,r[e+4],20,3889429448),h=s(h,u,_,m,r[e+9],5,568446438),m=s(m,h,u,_,r[e+14],9,3275163606),_=s(_,m,h,u,r[e+3],14,4107603335),u=s(u,_,m,h,r[e+8],20,1163531501),h=s(h,u,_,m,r[e+13],5,2850285829),m=s(m,h,u,_,r[e+2],9,4243563512),_=s(_,m,h,u,r[e+7],14,1735328473),h=i(h,u=s(u,_,m,h,r[e+12],20,2368359562),_,m,r[e+5],4,4294588738),m=i(m,h,u,_,r[e+8],11,2272392833),_=i(_,m,h,u,r[e+11],16,1839030562),u=i(u,_,m,h,r[e+14],23,4259657740),h=i(h,u,_,m,r[e+1],4,2763975236),m=i(m,h,u,_,r[e+4],11,1272893353),_=i(_,m,h,u,r[e+7],16,4139469664),u=i(u,_,m,h,r[e+10],23,3200236656),h=i(h,u,_,m,r[e+13],4,681279174),m=i(m,h,u,_,r[e+0],11,3936430074),_=i(_,m,h,u,r[e+3],16,3572445317),u=i(u,_,m,h,r[e+6],23,76029189),h=i(h,u,_,m,r[e+9],4,3654602809),m=i(m,h,u,_,r[e+12],11,3873151461),_=i(_,m,h,u,r[e+15],16,530742520),h=o(h,u=i(u,_,m,h,r[e+2],23,3299628645),_,m,r[e+0],6,4096336452),m=o(m,h,u,_,r[e+7],10,1126891415),_=o(_,m,h,u,r[e+14],15,2878612391),u=o(u,_,m,h,r[e+5],21,4237533241),h=o(h,u,_,m,r[e+12],6,1700485571),m=o(m,h,u,_,r[e+3],10,2399980690),_=o(_,m,h,u,r[e+10],15,4293915773),u=o(u,_,m,h,r[e+1],21,2240044497),h=o(h,u,_,m,r[e+8],6,1873313359),m=o(m,h,u,_,r[e+15],10,4264355552),_=o(_,m,h,u,r[e+6],15,2734768916),u=o(u,_,m,h,r[e+13],21,1309151649),h=o(h,u,_,m,r[e+4],6,4149444226),m=o(m,h,u,_,r[e+11],10,3174756917),_=o(_,m,h,u,r[e+2],15,718787259),u=o(u,_,m,h,r[e+9],21,3951481745),h=t(h,l),u=t(u,c),_=t(_,p),m=t(m,d);return(a(h)+a(u)+a(_)+a(m)).toLowerCase()}function Wt(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e,!1):e()}function $t(e){e()}function Nt(e){}function Ut(){return!1}function Gt(e){return void 0===e?e:JSON.parse(JSON.stringify(e))}const Xt={};let jt=0,qt=[];function Kt(e){let t=e;if("string"==typeof e&&(t={msg:e}),t.suppressable&&(it.notifications.suppress&&document.body.classList.contains("ingame_phys")||Or()))return void qt.push(t);const n=document.createElement("div");if(n.classList.add("notification"),n.classList.add("ns"),n.setAttribute("style",`--pri: ${t.color||"#FFFFFF"}; --sec: ${t.subcolor||"#000000"};`),n.style.borderColor=t.color||"#FFFFFF",n.style.backgroundColor=t.bgcolor||"#060606DD",n.style.color=t.fgcolor||"#FFFFFF",n.setAttribute("data-nid",t.id||++jt),xt("notifications").appendChild(n),t.classes&&t.classes.forEach((e=>{n.classList.add(e)})),t.icon){n.classList.add("has_image");const e=document.createElement("img");e.classList.add("notification_icon"),e.src=t.icon.includes("/")?t.icon:`res/icon/${t.icon}.svg`,n.appendChild(e)}if(t.subicon){const e=document.createElement("img");e.classList.add("notification_icon_sub"),e.src=t.subicon.includes("/")?t.subicon:`res/icon/${t.subicon}.svg`,n.appendChild(e)}if(t.header){const e=document.createElement("h1");e.innerHTML=t.header,n.appendChild(e)}const s=document.createElement("p");if(s.innerHTML=t.msg,n.appendChild(s),t.buttons=t.buttons||[],t.buttons.length){const e=document.createElement("div");e.classList.add("notification_button_holder"),e.classList.add("flex-row"),e.classList.add("ns"),n.appendChild(e),t.buttons.forEach((t=>{const s=document.createElement("div");s.classList.add("notification_button"),s.classList.add("flex-item"),s.innerHTML=`${t.icon?`<img src="${t.icon}" />`:""}${t.label}`,t.classes.forEach((e=>{s.classList.add(e)})),s.addEventListener("click",(()=>{t.onclick((()=>{tn(n)}))})),e.appendChild(s)}))}Xt[t.id||jt]=setTimeout((()=>{tn(n)}),t.timeout||5e3);const i=tn.bind(null,n),o=t.onclick?t.onclick.bind(null,i):i;return n.addEventListener("click",o),n}function Vt(e,t){return Kt({msg:e,color:"#FF2200",icon:"denied",timeout:t})}function Qt(e){return Kt({msg:e,color:"#FFF43C",icon:"warning"})}function Yt(e){return Kt({msg:e,color:"#FF4200",icon:"error"})}function Jt(e){return Kt({msg:e,color:"#FFCC00",icon:"announcement",timeout:1e4})}function Zt(e){return Kt({msg:e,color:"#6AFF3C",icon:"ok"})}function en(e){let t=e.error?e.error.msg||"no error message":"no error";return e.error&&e.error.stack&&(t+=`<p class="notification-stack">${e.error.name}&lt;${e.error.constructorName}&gt;: ${e.error.errorMessage}<br><br>${e.error.stack.replace(/\n/g,"<br>")}</p>`),Kt({msg:t,color:"#FF4200",icon:"error",classes:e.error&&e.error.stack?["hasstack"]:[]})}function tn(e){e.classList.add("despawning"),setTimeout((()=>{e.remove()}),500)}function nn(e){const t=At(`#notifications .notification[data-nid="${e}"]`);t&&t.remove()}function sn(e,t){if(!e||!xt("notifications").contains(e))return Kt(t);let n=t;"string"==typeof t&&(n={msg:t});const s=e;if(s.innerHTML="",s.style.borderColor=n.color||"#FFFFFF",n.icon){s.classList.add("has_image");const e=document.createElement("img");e.classList.add("notification_icon"),e.src=`res/icon/${n.icon}.svg`,s.appendChild(e)}const i=document.createElement("p");return i.innerHTML=n.msg,s.appendChild(i),n.timeout&&(clearTimeout(Xt[s.getAttribute("data-nid")]),Xt[jt]=setTimeout((()=>{tn(s)}),n.timeout||5e3)),s}function on(){qt.forEach((e=>{Kt(e)})),qt=[]}function an(e){let t=e;"string"==typeof e&&(t={msg:e});const n=document.createElement("div");n.classList.add("waterfall_item"),n.classList.add("ns"),n.style.setProperty("--bgc",t.bgcolor||"#888888"),n.style.setProperty("--timeout",(t.timeout||5e3)/1e3+"s"),n.style.color=t.fgcolor||"#FFFFFF",xt("waterfall").prepend(n);const s=document.createElement("p");s.classList.add("ns"),s.innerHTML=t.msg,n.appendChild(s),setTimeout((()=>{rn(n)}),t.timeout||5e3);const i=s.getBoundingClientRect();return Ur.play("waterfall",{x:i.left+i.width/2,y:i.top+1.3*i.height,w:i.width,h:i.height,color:Yr(t.bgcolor)||8947848}),n}function rn(e){e.parentNode&&(e.classList.add("despawning"),setTimeout((()=>{e.parentNode.removeChild(e)}),500))}function ln(e=null,t=null,n="sizzle"){const s=document.createElement("div");if(s.classList.add("killfeed_item"),s.classList.add("ns"),s.classList.toggle("victim",e==mn.username()),s.classList.toggle("killer",t==mn.username()),xt("killfeed").prepend(s),t){const e=document.createElement("p");e.classList.add("ns"),e.innerHTML=t.toUpperCase(),s.appendChild(e)}const i=document.createElement("img");if(i.src=`/res/icon/elim-${n}.svg`,s.appendChild(i),e){const t=document.createElement("p");t.classList.add("ns"),t.innerHTML=e.toUpperCase(),s.appendChild(t)}return setTimeout((()=>{cn(s)}),1e4),s}function cn(e){e.parentNode&&(e.classList.add("despawning"),setTimeout((()=>{e.parentNode.removeChild(e)}),500))}const pn={};function dn(e){const t=`dlg_${Date.now()}${Math.floor(1e6*Math.random())}`,n=document.createElement("div");if(n.classList.add("oob_modal"),n.classList.add("hidden"),n.id=t,xt("dialogs").appendChild(n),e.title){const t=document.createElement("h1");t.innerHTML=e.title,n.appendChild(t)}if(e.msg){const t=document.createElement("p");t.innerHTML=e.msg,n.appendChild(t)}e.classes&&e.classes.forEach((e=>{n.classList.add(e)}));const s=document.createElement("div");return s.classList.add("oob_button_holder"),s.classList.add("flex-row"),s.classList.add("ns"),n.appendChild(s),e.buttons.forEach((e=>{const t=document.createElement("div");t.classList.add("oob_button"),t.classList.add("flex-item"),t.innerHTML=e.label,e.classes.forEach((e=>{t.classList.add(e)})),e.id&&(t.id=e.id),t.addEventListener("click",(()=>{e.callback((()=>{hn(n)}),n)})),s.appendChild(t)})),setTimeout((()=>{n.classList.remove("hidden"),ii.push(),ii.bindGuide(oi.dialog)}),1),xt("dialogs").classList.remove("hidden"),Gi(),pn[t]={id:t,options:e,el:n},n}function hn(e,t=!1){e.classList.contains("hidden")||(e.classList.add("hidden"),Xi(),ii.pop(),t&&pn[e.id]&&pn[e.id].onskip&&pn[e.id].onskip(),delete pn[e.id],e.__onclose&&e.__onclose(),setTimeout((()=>{1===e.parentNode.childElementCount&&e.parentNode.classList.add("hidden"),e.parentNode.removeChild(e)}),500))}function un(){for(const e of Object.values(pn))hn(e.el,!0)}Wt((()=>{xt("dialogs").addEventListener("mousedown",(e=>{if(e.target!==xt("dialogs"))return;if(!xt("dialogs").children.length)return;const t=xt("dialogs").children[xt("dialogs").children.length-1];t.classList.contains("noclickout")||t.classList.contains("hidden")||(hn(t,!0),na.PlaySe("menuclick"))}))})),Wt((()=>{document.addEventListener("keydown",(function(e){if(e.repeat)return;let t=e.code;if("NumpadEnter"===t&&(t="Enter"),"Enter"!==t&&"Escape"!==t)return;if(!e.target.getAttribute(`data-${t.toLowerCase()}`))return;const n=xt(e.target.getAttribute(`data-${t.toLowerCase()}`));"input"===n.tagName.toLowerCase()||"textarea"===n.tagName.toLowerCase()?n.focus():n.click(),e.preventDefault()}))}));const _n=(()=>{let e=null;const t=[];return Wt((()=>{!async function(){let n="No-GPU";const s=document.createElement("canvas").getContext("webgl");if(s){const e=s.getExtension("WEBGL_debug_renderer_info");e&&(n=s.getParameter(e.UNMASKED_RENDERER_WEBGL))}const o=navigator.hardwareConcurrency||0,a=navigator.deviceMemory||0,r=navigator.userAgent.replace("//","--")||"No-UA",l=await i.load(),c=(await l.get()).visitorId;let p=localStorage.getItem("debugIdentity");p||(p=`${Date.now()}-${Math.floor(1e9*Math.random())}`.replace("//","--"),localStorage.setItem("debugIdentity",p)),p=p.replace("//","--");const d=`${window.screen.availWidth}x${window.screen.availHeight}@${window.devicePixelRatio||1}`,h={};switch(it.controls.style){case"guideline":Object.assign(h,rt);break;case"wasd":Object.assign(h,lt);break;case"custom":Object.assign(h,it.controls.custom)}const u=`${h.moveLeft[0]||"?"}, ${h.moveRight[0]||"?"}, ${h.softDrop[0]||"?"}, ${h.hardDrop[0]||"?"}, ${h.rotateCCW[0]||"?"}, ${h.rotateCW[0]||"?"}, ${h.rotate180[0]||"?"}, ${h.hold[0]||"?"}`.replace("//","--"),_=window.BASEBOARD||"N/A";e=`xHW-${btoa(`${r} // ${o}-core // ${a}-GB // ${n} // ${c} // ${p} // ${d} // ${u} // ${it.handling.arr}F ARR, ${it.handling.das}F DAS, ${it.handling.sdf}X SDF // ${_}`)}`,t.forEach((t=>t(e)))}()})),{get:()=>e,getWhenReady:n=>{e?n(e):t.push(n)}}})(),mn=(()=>{const e={loggedIn:!1,token:"",id:"",username:""};function t(){localStorage.setItem("tetrio_userToken",e.token),localStorage.setItem("tetrio_userID",e.id),localStorage.setItem("tetrio_username",e.username)}return function(){const t=localStorage.getItem("tetrio_userToken")||localStorage.getItem("userToken"),n=localStorage.getItem("tetrio_userID")||localStorage.getItem("userID"),s=localStorage.getItem("tetrio_username")||localStorage.getItem("username");t?(e.loggedIn=!0,e.token=t,e.id=n,e.username=s):(e.loggedIn=!1,e.token="",e.id="",e.username="")}(),{loggedIn:()=>e.loggedIn,id:()=>e.id,token:()=>e.token,username:()=>e.username,changeUsername:n=>{e.username=n,t()},logout:()=>{e.loggedIn=!1,e.token="",e.id="",e.username="",Rs.resetZen(),t()},login:(n,s,i,o=!0)=>{e.loggedIn=!0,e.token=n,e.id=s,e.username=i,o&&t()},anon:()=>document.body.classList.contains("anon"),requestPassword:function(t){if(document.body.classList.contains("uses2fa"))return dn({title:"PASSWORD REQUESTED",msg:`to continue, please re-enter the password for <span class="inline_self">${e.username.toUpperCase()}</span><br><input data-escape="request_password_cancel" data-enter="request_password_totp" id="request_password" type="password" placeholder="PASSWORD" autocomplete="current-password"><br><br>as well as a six-digit code from your authenticator app, or one of your recovery codes<br><input data-escape="request_password_cancel" data-enter="request_password_submit" id="request_password_totp" placeholder="six digits" class="mono_input centered_input" autocomplete="off">`,buttons:[{label:"CANCEL",classes:[],id:"request_password_cancel",callback:e=>{e()}},{label:"SUBMIT",classes:["pri"],id:"request_password_submit",callback:e=>{t(xt("request_password").value,xt("request_password_totp").value),e()}}]}),void xt("request_password").focus();dn({title:"PASSWORD REQUESTED",msg:`to continue, please re-enter the password for <span class="inline_self">${e.username.toUpperCase()}</span><br><input data-escape="request_password_cancel" data-enter="request_password_submit" id="request_password" type="password" placeholder="PASSWORD" autocomplete="current-password">`,buttons:[{label:"CANCEL",classes:[],id:"request_password_cancel",callback:e=>{e()}},{label:"SUBMIT",classes:["pri"],id:"request_password_submit",callback:e=>{t(xt("request_password").value,""),e()}}]}),xt("request_password").focus()},esc:async function(e,t){if(!crypto.subtle)return;e=await crypto.subtle.importKey("raw",e,"AES-CBC",!1,["encrypt"]);const n=crypto.getRandomValues(new Uint8Array(16)),s=await crypto.subtle.encrypt({name:"AES-CBC",iv:n},e,(new TextEncoder).encode(t));return btoa(JSON.stringify({x:btoa(String.fromCharCode(...new Uint8Array(s))),z:btoa(String.fromCharCode(...n))}))}}})(),gn=(()=>{const e=new n.Packr({bundleStrings:!0}),t=new n.Unpackr({bundleStrings:!0});return{send:n=>{let{method:s=(()=>{throw new Error("XHR: A method is required")})(),url:i=(()=>{throw new Error("XHR: A path is required")})(),body:o,authenticated:a,parse:r=!0,ignoreSuccess:l=!1,headers:c={},accept:p,type:d="application/vnd.osk.theorypack"}=n;void 0===a&&(a=i.startsWith("/api/")),void 0===p&&(p=i.startsWith("/api/")?"application/vnd.osk.theorypack":"*/*");const h=new XMLHttpRequest;return h.open(s,i,!0),h.setRequestHeader("Accept",p),"application/vnd.osk.theorypack"===p&&(h.responseType="arraybuffer"),"string"==typeof o?h.setRequestHeader("Content-Type","text/plain"):o instanceof FormData||"object"==typeof o&&(h.setRequestHeader("Content-Type",d),"application/json"===d?o=JSON.stringify(o):"application/vnd.osk.theorypack"===d&&(o=e.pack(o))),a&&mn.loggedIn()&&h.setRequestHeader("Authorization",`Bearer ${mn.token()}`),Object.keys(c).forEach((e=>{h.setRequestHeader(e,c[e])})),new Promise(((e,n)=>{h.onload=()=>{if(4===h.readyState){if(!r)return void e(h.responseText);let s=null;switch(h.getResponseHeader("Content-Type").split(";")[0]){case"application/json":s=JSON.parse(h.responseText);break;case"application/vnd.osk.theorypack":s=t.unpack(new Uint8Array(h.response))}if(!l){if(!s)return void n({success:!1,error:{msg:"A connection error has occured"}});if(!s.success)return void n(s)}e(s)}},h.onerror=()=>{n({success:!1,error:{msg:"A connection error has occured"}})},h.send(o)}))},get:(e,t={},n={})=>{let s=!1;return Object.keys(t).forEach((n=>{e+=`${s?"&":"?"}${encodeURIComponent(n)}=${encodeURIComponent(t[n])}`,s=!0})),gn.send({method:"GET",url:e,...n})},post:(e,t=void 0,n={})=>gn.send({method:"POST",url:e,body:t,...n})}})();function fn(e){return Math.pow(e/500,.6)+e/(5e3+Math.max(0,e-4e6)/5e3)+1}function bn(e){return Math.floor(fn(e)%1*100)}function Cn(e,t=""){if(e<0||Number.isNaN(e))return'<div title="No level" class="leveltag ns lt_null">0</div>';const n=Math.floor(e),s=e%1;if(n>=5e3)return`<div title="${Math.floor(100*s)}% towards next level" class="leveltag ns lt_golden">${n}</div>`;const i=Math.floor(n/10)%10,o=Math.floor(n/100)%5,a=Math.floor(n/500)%10;return`<div ${t} title="${Math.floor(100*s)}% towards next level" class="leveltag ns lt_shape_${o} lt_badge_color_${a} lt_shape_color_${i}">${n}</div>`}function xn(e,t){if(e<0||Number.isNaN(e))return t.innerHTML="0",t.className="leveltag ns lt_null",void(t.title="No level");const n=Math.floor(e),s=e%1;if(t.innerHTML=n,n>=5e3)return void(t.className="leveltag ns lt_golden");const i=Math.floor(n/10)%10,o=Math.floor(n/100)%5,a=Math.floor(n/500)%10;t.className=`leveltag ns lt_shape_${o} lt_badge_color_${a} lt_shape_color_${i}`,t.title=`${Math.floor(100*s)}% towards next level`}function An(e){const t=Math.floor(e);if(5e3==t)return na.PlaySe("level500"),void setTimeout((()=>{na.PlaySe("levelup"),na.PlaySe("allclear"),na.PlaySe("worldrecord")}),750);na.PlaySe(t>=5e3?"level1":t%500!=0?t%100!=0?t%10!=0?"level1":"level10":"level100":"level500")}function yn(e){const t=Math.floor(e);return 5e3==t?"MAX LEVEL!":t>=5e3?"LEVEL UP!":t%500==0?"DISTINGUISHED!":t%100==0?"PROMOTED!":t%10==0?"BADGE UP!":"LEVEL UP!"}function vn(e,t){if(document.body.classList.contains("anon"))return;const n=fn(e),s=fn(t),i=Math.floor(n)!==Math.floor(s),o=n%1,a=i?1:s%1;xn(n,xt("me_leveling_current")),xt("me_leveling").classList.remove("levelingup"),xt("me_leveling_amt").innerHTML=`+${t-e} xp`,xt("me_leveling_message").classList.add("hidden"),xt("me_leveling_fg").style.right=`calc(${.4*o-.2}em + ${100-100*o}%)`,xt("me_leveling").getBoundingClientRect(),xt("me_leveling").classList.remove("hidden"),setTimeout((()=>{xt("me_leveling_fg").style.right=`calc(${.4*a-.2}em + ${100-100*a}%)`,xn(s,xt("me_level")),xn(s,xt("zenith_party_self_level"))}),750),i?(xt("me_leveling_message").innerHTML=yn(s),setTimeout((()=>{xt("me_leveling_message").classList.remove("hidden"),xt("me_leveling").classList.add(5001===Math.floor(s)?"maxlevel":"levelingup"),An(s)}),1750),setTimeout((()=>{xn(s,xt("me_leveling_current"));const e=xt("me_leveling").getBoundingClientRect();Ur.play("xp_ultra",{x:e.left,y:e.top,w:e.width,h:e.height})}),2500),setTimeout((()=>{xt("me_leveling").classList.add("hidden"),xt("me_leveling").classList.remove(5001===Math.floor(s)?"maxlevel":"levelingup")}),5001===Math.floor(s)?16750:6750)):setTimeout((()=>{xt("me_leveling").classList.add("hidden")}),3e3)}let Bn=0;function wn(e,t=!1){(e=Math.floor(e))&&!Number.isNaN(e)&&(!t&&e&&vn(Bn,Bn+e),Bn+=e)}let Ln=!1;const kn=function(){const e={sfx:{state:"loading SFX..."},fonts:{state:null},textures:{state:null},feecof:{state:null},homebanner:{state:"loading home banner data..."},environment:{state:"checking for game updates..."}};let t=0;const n=[];let s=!1,i=!1;const o=window.I;function r(){xt("preload").classList.add("hidden"),n.forEach((e=>{e()})),function(){const e=Ws.quickjoin;if(!e)return;switch(e.substring(0,2)){case"R:":ia.navigateToID(e.trim());break;case"P:":case"D:":break;case"S:":xi(void 0,e.length>2?e.substring(2).trim():void 0);break;default:Di("connecting to live servers"),i=!0,Sa.require().then((t=>{Oi(),Li("playmulti"),t.maintenance&&document.body.classList.add("maintenance"),Oa.joinRoom(e.trim())})).catch((()=>{Oi(),Yt("could not connect to live servers")}))}}(),i||document.body.classList.contains("banstatus_restrict")||Sa.connect()}function l(){let t="";Object.keys(e).forEach((n=>{e[n].state&&(t+=`<p>${e[n].state}</p>`)})),xt("preload_msgs").innerHTML=t}return window.I=void 0,Wt((()=>{"devel"===_.mode&&document.body.classList.add("devel"),xt("js_load_error").classList.add("handled"),a.utils.isWebGLSupported()||xt("no_webgl_error").classList.remove("hidden"),l()})),Wt((()=>{console.log("%cTETR.IO","color: #DFC0F3;\n\t\t\t\t\t display: block;\n\t\t\t\t\t font-size: 5em;\n\t\t\t\t\t font-weight: 900;\n\t\t\t\t\t text-shadow: 0px 0px 2px #9150BA;\n\t\t\t\t\t background-color: #45345088;\n\t\t\t\t\t padding: 0 0.25em;\n\t\t\t\t\t border-radius: 3px;"),console.log("%cPlease be careful when pasting anything in the console. Attackers may be out to steal your login information.","color: #FFA69F;\n\t\t\t\t\t display: block;\n\t\t\t\t\t font-size: 1.2em;\n\t\t\t\t\t font-weight: 900;\n\t\t\t\t\t text-shadow: 0px 0px 2px #D53428;\n\t\t\t\t\t background-color: #993B2288;\n\t\t\t\t\t padding: 0 1em;\n\t\t\t\t\t border-radius: 3px;")})),{i:function(){return o},finishLoad:function(n){e[n].state=null,l(),++t===Object.keys(e).length&&(xt("preload").classList.add("ready"),s&&r())},setState:function(t,n){e[t].state=n,l()},finish:function(){t===Object.keys(e).length&&r(),s=!0},ready:function(e){n.push(e)},unready:function(){s&&(xt("preload").classList.remove("hidden"),s=!1,Ei())},update:function(e=!1,t=void 0){Ln=!0,e||Kt({msg:"installing a required update... if this seems stuck, hit CTRL+F5 to force a reload",color:"#0060FF",icon:"update",timeout:15e3});const n=()=>{if(!t)return location.reload(!0);const e=new URLSearchParams(location.search);e.set("hv",t),location.search=e.toString(),location.reload(!0)};try{Ms((()=>{n()}))}catch(e){console.error(e)}setTimeout((()=>{n()}),1e3)}}}(),Sn={},Fn=1,zn=2,Tn=3,In=4,Mn=[["awesome.png",Fn],["b1.png",Fn],["bigflush.png",Fn],["checked.png",Fn],["crossed.png",Fn],["dogchoke.png",Fn],["evil.png",Fn],["kagari.png",Fn],["kagayes.png",Fn],["kagablush.png",Fn],["kagri.png",Fn],["konata.png",Fn],["nicodab.png",Fn],["pog.png",Fn],["pausechamp.png",Fn],["weirdchamp.png",Fn],["sadchamp.png",Fn],["tetrio.png",Fn],["trelele.png",Fn],["ultreme.png",Fn],["woomy.png",Fn],["yui_eyes.png",Fn],["oyes.png",Fn],["eee.png",Fn],["woke.png",Fn],["bin.png",Fn],["drboob.png",Fn],["vno.png",Fn],["thonk.png",Fn],["konacry.png",Fn],["goodmorning.png",Fn],["goodnight.png",Fn],["kagasing.png",Fn],["kagashock.png",Fn],["crying.png",Fn],["mikotommr.png",Fn],["happy.png",Fn],["feisty.png",Fn],["cacopog.png",Fn],["chaotic_cat.png",Fn],["eyes.png",Fn,"","eyeseyes"],["unranked.png",Fn],["rankD.png",Fn],["rankDplus.png",Fn],["rankCminus.png",Fn],["rankC.png",Fn],["rankCplus.png",Fn],["rankBminus.png",Fn],["rankB.png",Fn],["rankBplus.png",Fn],["rankAminus.png",Fn],["rankA.png",Fn],["rankAplus.png",Fn],["rankSminus.png",Fn],["rankS.png",Fn],["rankSplus.png",Fn],["rankSS.png",Fn],["rankU.png",Fn],["rankX.png",Fn],["rankXplus.png",Fn],["garpog.png",Fn],["scott_pog.png",Fn],["beastpog.png",Fn],["kagapog.png",Fn,"","pogari"],["kogori.png",Fn],["goodkagari.png",Fn,"","kagablanket"],["kogori.png",Fn],["ohyeah.png",Fn],["alcapog.png",Fn],["link_pog.png",Fn],["cabpog.png",Fn,"","caboozledpog","caboozled_pog"],["piece_z.png",Fn],["piece_l.png",Fn],["piece_o.png",Fn],["piece_s.png",Fn],["piece_i.png",Fn],["piece_j.png",Fn],["piece_t.png",Fn],["pasta.png",Fn],["sad.png",Fn],["kagathink.png",Fn,"","thinkagari"],["notlikethis.png",Fn],["random.png",Fn],["starechamp.png",Fn],["bench.png",Fn],["mikot.png",Fn],["kagaxd.png",Fn,"","xd"],["mahoblush.png",Fn],["maholove.png",Fn],["love.png",Fn],["serikasip.png",Fn],["serikabishi.png",Fn],["serikalove.png",Fn],["serikabwah.png",Fn],["unamused.png",Fn,"","unamusedlink"],["deepwoke.png",Fn],["pogo.png",Fn,"","pg"],["nue.png",Fn],["kotapog.png",Fn],["tf.png",Fn,"","troll"],["rshrug.png",Fn,"","linkshrug"],["ghello.png",Fn,"","linkwave","bhi"],["bbye.png",Fn,"","linkbye"],["vwhoops.png",Fn,"","linkwhoops"],["ok.png",Fn],["hq.png",Fn],["lq.png",Fn],["nq.png",Fn],["stare.png",Fn],["questionable.png",Fn],["clownsmug.png",Fn],["lesanae.png",Fn],["daistronk.png",Fn],["supporter.png",zn],["drake.gif",zn],["kagaristep.gif",zn,"","kagastep"],["nyndance.gif",zn],["pogchomp.gif",zn],["worthit.gif",zn],["laundrycat.gif",zn,"","catbedoingthelaundry"],["lizzieboi.gif",zn],["rainbowheart.gif",zn],["petthekagari.gif",zn,"","petthekagarin"],["kaganom.gif",zn],["cirno.gif",zn],["h.gif",zn],["blobsweat.png",zn,'style="width: 2.53em;"'],["gg.png",zn,'style="width: 2.53em;"'],["ggs.png",zn,'style="width: 3.17em;"'],["glhf.png",zn,'style="width: 3.98em;"'],["troort.png",zn,'style="width: 2.25em;"'],["glad.png",zn,'style="width: 2.77em;"'],["un.png",zn,'style="width: 2.93em;"'],["goodholiday.gif",zn],["capyboogie.gif",zn],["yapping.gif",zn],["verified.png",zn],["gotcha.png",Tn],["kagahorny.png",Tn],["mikotohorny.png",Tn],["tsukasa.png",Tn,'style="width: 212px; height: 219px;"'],["donowall.png",Tn,'style="width: 200px; height: 108px;"'],["kanonsays.png",Tn,'style="width: 200px; height: 238px;"'],["capybara.png",Tn,'style="width: 200px; height: 227px;"'],["wifeheart.png",In,'style="width: 128px; height: 127px;"']];function En(e,t,n="",...s){const[i,o]=e.split(/(\.\w+)$/),a={id:i.toLowerCase(),type:o,src:`/res/emotes/${i}`,access:t,extra:n};Sn[`:${i.toLowerCase()}:`]=a;for(const e of s)Sn[`:${e.toLowerCase()}:`]=a}function Dn(e){if(!e.includes(":"))return[];const t=e.match(/:(\w+):/g);return t?[...new Set(t.map((e=>e.toLowerCase())))]:[]}function On(e,t,n,s){const i=e.toLowerCase(),o=Sn[i];if(!o)return t;switch(o.access){case zn:if(!n.supporter&&![...$n,"bot"].includes(n.role))return t;break;case Tn:if(!$n.includes(n.role))return t;break;case In:if("osk"!==n.username)return t}let a=o.extra;"ultreme"===o.id&&$n.includes(n.role)&&(a='style="width: 200px; height: 200px;"');const r=new RegExp(i,"gi");return t.replace(r,`<img class="emote" ${a} "data-emotes"${o.id}" title="${i}" alt="${i}" src="${o.src+(s?".png":o.type)}" />`)}function Hn(e,t={},n){if(!1===it.video.emotes)return e;for(const s of Dn(e))e=On(s,e,t,n);return e}function Pn(e){if(!1===it.video.emotes)return!1;for(const t of Dn(e)){const e=Sn[t.toLowerCase()];if(e&&e.access===zn)return!0}return!1}for(const e of Mn)En(...e);const Rn=["z","d","d+","c-","c","c+","b-","b","b+","a-","a","a+","s-","s","s+","ss","u","x","x+"],Wn={AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AN:"Netherlands Antilles",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"land Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barthlemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia, Plurinational State of",BQ:"Caribbean Netherlands",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:"Congo, the Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"Cte d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Curaao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",EU:"Europe",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia, Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon","GB-ENG":"England","GB-NIR":"Northern Ireland","GB-SCT":"Scotland","GB-WLS":"Wales",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran, Islamic Republic of",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova, Republic of",ME:"Montenegro",MF:"Saint Martin",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia, the former Yugoslav Republic of",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestine",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"Runion",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SJ:"Svalbard and Jan Mayen Islands",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten (Dutch part)",SY:"Syrian Arab Republic",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania, United Republic of",UA:"Ukraine",UG:"Uganda",UM:"US Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela, Bolivarian Republic of",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna Islands",XK:"Kosovo",WS:"Samoa",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe",XX:"Unknown",XM:"The Moon"},$n=["halfmod","mod","admin","sysop"],Nn={default:"options.presets=default;match.modename=VERSUS;match.gamemode=versus;match.ft=1;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=all-mini;options.allow180=1;options.kickset=SRS+;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=5;options.display_shadow=1;options.are=0;options.lineclear_are=0;options.room_handling=0;options.room_handling_arr=2;options.room_handling_das=10;options.room_handling_sdf=6;options.g=0.02;options.gincrease=0.0025;options.gmargin=3600;options.garbagemultiplier=1;options.garbageblocking=combo blocking;options.garbagemargin=10800;options.garbageincrease=0.008;options.locktime=30;options.garbagespeed=20;options.garbagecap=8;options.garbagecapincrease=0;options.garbagecapmax=40;options.manual_allowed=0;options.b2bchaining=0;options.combotable=multiplier;options.clutch=1;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.usebombs=0;options.openerphase=14;options.b2bcharging=1;options.allclear_garbage=5;options.allclear_b2b=1;options.roundmode=down","tetra league":"options.presets=tetra league;match.modename=TETRA LEAGUE;gamebgm=RANDOMbattle;userLimit=2;match.gamemode=versus;match.ft=7;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=all-mini;options.allow180=1;options.kickset=SRS+;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=5;options.display_shadow=1;options.are=0;options.lineclear_are=0;options.room_handling=0;options.room_handling_arr=2;options.room_handling_das=10;options.room_handling_sdf=6;options.g=0.02;options.gincrease=0.0035;options.gmargin=7200;options.garbagemultiplier=1;options.garbageblocking=combo blocking;options.garbagemargin=10800;options.garbageincrease=0.008;options.locktime=30;options.garbagespeed=20;options.garbagecap=8;options.garbagecapincrease=0;options.garbagecapmax=40;options.manual_allowed=0;options.b2bchaining=0;options.combotable=multiplier;options.clutch=1;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.usebombs=0;options.openerphase=14;options.b2bcharging=1;options.allclear_garbage=5;options.allclear_b2b=1;options.roundmode=down","tetra league (season 1)":"options.presets=tetra league (season 1);match.modename=TETRA LEAGUE;gamebgm=RANDOMbattle;userLimit=2;match.gamemode=versus;match.ft=7;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=T-spins;options.allow180=1;options.kickset=SRS+;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=5;options.display_shadow=1;options.are=0;options.lineclear_are=0;options.room_handling=0;options.room_handling_arr=2;options.room_handling_das=10;options.room_handling_sdf=6;options.g=0.02;options.gincrease=0.0035;options.gmargin=7200;options.garbagemultiplier=1;options.garbageblocking=combo blocking;options.garbagemargin=10800;options.garbageincrease=0.008;options.locktime=30;options.garbagespeed=20;options.garbagecap=8;options.garbagecapincrease=0;options.garbagecapmax=40;options.manual_allowed=0;options.b2bchaining=1;options.combotable=multiplier;options.clutch=1;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.usebombs=0;options.openerphase=0;options.b2bcharging=0;options.allclear_garbage=10;options.allclear_b2b=0;options.roundmode=down",classic:"options.presets=classic;match.modename=CLASSIC VERSUS;match.gamemode=versus;match.ft=1;match.wb=1;options.stock=0;options.bagtype=classic;options.spinbonuses=none;options.allow180=0;options.kickset=NRS;options.allow_harddrop=0;options.display_next=1;options.display_hold=0;options.nextcount=1;options.display_shadow=0;options.are=12;options.lineclear_are=18;options.room_handling=1;options.room_handling_arr=5;options.room_handling_das=16;options.room_handling_sdf=6;options.g=0.02;options.gincrease=0.0005;options.gmargin=3600;options.garbagemultiplier=1;options.garbageblocking=none;options.garbagemargin=10800;options.garbageincrease=0;options.locktime=5;options.garbagespeed=20;options.garbagecap=8;options.garbagecapincrease=0;options.garbagecapmax=40;options.manual_allowed=0;options.b2bchaining=0;options.combotable=none;options.clutch=0;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=0;options.messiness_change=0;options.messiness_inner=0;options.usebombs=0;options.openerphase=0;options.b2bcharging=0;options.allclear_garbage=10;options.allclear_b2b=0;options.roundmode=down","enforced delays":"options.presets=enforced delays;match.modename=VERSUS;match.gamemode=versus;match.ft=2;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=T-spins;options.allow180=0;options.kickset=SRS;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=5;options.display_shadow=1;options.are=7;options.lineclear_are=35;options.room_handling=1;options.room_handling_arr=2;options.room_handling_das=9;options.room_handling_sdf=10;options.g=0.02;options.gincrease=0.00125;options.gmargin=3600;options.garbagemultiplier=1;options.garbageblocking=limited blocking;options.garbagemargin=0;options.garbageincrease=0;options.locktime=30;options.garbagespeed=10;options.garbagecap=100;options.garbagecapincrease=0;options.garbagecapmax=100;options.manual_allowed=0;options.b2bchaining=0;options.combotable=classic guideline;options.clutch=0;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.garbageentry=instant;options.messiness_change=0.25;options.messiness_inner=0.25;options.usebombs=0;options.openerphase=0;options.b2bcharging=0;options.allclear_garbage=10;options.allclear_b2b=0;options.roundmode=down",arcade:"options.presets=arcade;match.modename=ARCADE VERSUS;match.gamemode=versus;match.ft=1;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=T-spins;options.allow180=0;options.kickset=ARS;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=3;options.display_shadow=0;options.are=27;options.lineclear_are=25;options.room_handling=1;options.room_handling_arr=1;options.room_handling_das=10;options.room_handling_sdf=20;options.g=0.02;options.gincrease=0.0025;options.gmargin=3600;options.garbagemultiplier=1;options.garbageblocking=combo blocking;options.garbagemargin=10800;options.garbageincrease=0.008;options.locktime=18;options.garbagespeed=20;options.garbagecap=8;options.garbagecapincrease=0;options.garbagecapmax=40;options.manual_allowed=0;options.b2bchaining=0;options.combotable=multiplier;options.clutch=1;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.usebombs=0;options.openerphase=0;options.b2bcharging=0;options.allclear_garbage=10;options.allclear_b2b=0;options.roundmode=down",quickplay:"options.presets=quickplay;match.modename=VERSUS;match.gamemode=versus;match.ft=1;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=T-spins;options.allow180=1;options.kickset=SRS+;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=5;options.display_shadow=1;options.are=0;options.lineclear_are=0;options.room_handling=0;options.room_handling_arr=2;options.room_handling_das=10;options.room_handling_sdf=6;options.g=0.05;options.gincrease=0.0025;options.gmargin=0;options.garbagemultiplier=1;options.garbageblocking=combo blocking;options.garbagemargin=10800;options.garbageincrease=0.008;options.locktime=30;options.garbagespeed=20;options.garbagecap=4;options.garbagecapincrease=0.033;options.garbagecapmax=10;options.manual_allowed=0;options.b2bchaining=1;options.combotable=multiplier;options.clutch=1;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.usebombs=0;options.openerphase=0;options.b2bcharging=0;options.allclear_garbage=10;options.allclear_b2b=0;options.roundmode=down","4wide":"options.presets=4wide;match.modename=4-WIDE;match.gamemode=versus;match.ft=1;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=handheld;options.allow180=1;options.kickset=SRS-X;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=5;options.display_shadow=1;options.are=0;options.lineclear_are=0;options.room_handling=0;options.room_handling_arr=2;options.room_handling_das=10;options.room_handling_sdf=6;options.g=0.02;options.gincrease=0.0025;options.gmargin=3600;options.garbagemultiplier=1;options.garbageblocking=combo blocking;options.garbagemargin=10800;options.garbageincrease=0.008;options.locktime=30;options.garbagespeed=20;options.garbagecap=4;options.garbagecapincrease=0.02;options.garbagecapmax=8;options.manual_allowed=0;options.b2bchaining=0;options.combotable=multiplier;options.clutch=1;options.passthrough=zero;options.nolockout=1;options.boardwidth=4;options.boardheight=26;options.allclears=1;options.usebombs=0;options.openerphase=0;options.b2bcharging=0;options.allclear_garbage=5;options.allclear_b2b=1;options.roundmode=down","100 battle royale":"options.presets=100 battle royale;match.modename=BATTLE ROYALE;match.gamemode=royale;userLimit=100;match.ft=1;match.wb=1;options.stock=0;options.bagtype=7-bag;options.spinbonuses=all-mini;options.allow180=0;options.kickset=SRS;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=6;options.display_shadow=1;options.are=6;options.lineclear_are=25;options.room_handling=1;options.room_handling_arr=2;options.room_handling_das=12;options.room_handling_sdf=6;options.g=0.02;options.gincrease=0.003;options.gmargin=3600;options.garbagemultiplier=1;options.garbageblocking=combo blocking;options.garbagemargin=10800;options.garbageincrease=0.008;options.locktime=30;options.garbagespeed=20;options.garbagecap=100;options.garbagecapincrease=0.033;options.garbagecapmax=100;options.manual_allowed=1;options.b2bchaining=0;options.combotable=classic guideline;options.clutch=0;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.garbagequeue=1;options.garbagetargetbonus=defensive;options.garbageentry=delayed;options.garbageare=7;options.garbageattackcap=20;options.garbageabsolutecap=12;options.messiness_change=0.25;options.messiness_inner=0.25;options.usebombs=0;options.openerphase=14;options.b2bcharging=1;options.allclear_garbage=5;options.allclear_b2b=1;options.roundmode=down",bombs:"options.presets=bombs;match.modename=VERSUS;match.gamemode=versus;match.ft=1;match.wb=1;options.stock=0;options.bagtype=7+2-bag;options.spinbonuses=all-mini;options.allow180=1;options.kickset=SRS+;options.allow_harddrop=1;options.display_next=1;options.display_hold=1;options.nextcount=5;options.display_shadow=1;options.are=0;options.lineclear_are=0;options.room_handling=0;options.room_handling_arr=2;options.room_handling_das=10;options.room_handling_sdf=6;options.g=0.02;options.gincrease=0.0025;options.gmargin=3600;options.garbagemultiplier=0.8;options.garbageblocking=combo blocking;options.garbagemargin=0;options.garbageincrease=0.005;options.locktime=30;options.garbagespeed=20;options.garbagecap=8;options.garbagecapincrease=0;options.garbagecapmax=40;options.manual_allowed=0;options.b2bchaining=0;options.combotable=multiplier;options.clutch=1;options.passthrough=zero;options.nolockout=1;options.boardwidth=10;options.boardheight=20;options.allclears=1;options.messiness_inner=0.3;options.usebombs=1;options.openerphase=14;options.b2bcharging=0;options.allclear_garbage=3;options.allclear_b2b=0;options.roundmode=down"},Un="\n---default---,DEFAULT,use the default option;\n---empty---,EMPTY,leave this slot empty;\nscore,SCORE,display the score in this slot;\nspp,SCORE (per piece),display the score and score per piece in this slot;\nstopwatch,STOPWATCH,display the time passed in this slot;\nlines,LINES,display the amount of cleared lines in this slot;\npieces,PIECES,display the amount of placed pieces and speed in this slot;\nkeys,INPUTS,display the amount of buttonpresses in this slot;\nfinesse,FINESSE,display your finesse in this slot;\nfinesse_l,FINESSE (SMALLER),display your finesse in this slot (for use on the left-hand side);\nhold,HOLD,display the amount of held pieces in this slot;\nallclears,ALL CLEARS,display the amount of ALL CLEARS in this slot\n".replace(/\n/g,""),Gn="\n---default---,DEFAULT,use the default option;\n---empty---,EMPTY,leave this slot empty;\nscore,SCORE,display the score in this slot;\nspp,SCORE (per piece),display the score and score per piece in this slot;\ntimer,TIMER,display the time remaining in this slot;\nlines,LINES,display the amount of cleared lines in this slot;\nlevel,LEVEL,display the current level in this slot;\npieces,PIECES,display the amount of placed pieces and speed in this slot;\nkeys,INPUTS,display the amount of buttonpresses in this slot;\nfinesse,FINESSE,display your finesse in this slot;\nfinesse_l,FINESSE (SMALLER),display your finesse in this slot (for use on the left-hand side);\nhold,HOLD,display the amount of held pieces in this slot;\nallclears,ALL CLEARS,display the amount of ALL CLEARS in this slot\n".replace(/\n/g,"");kn.ready((function(e){xt("slot_40l_counter1").setAttribute("data-items",Un),xt("slot_40l_counter2").setAttribute("data-items",Un),xt("slot_40l_counter3").setAttribute("data-items",Un),xt("slot_40l_counter4").setAttribute("data-items",Un),xt("slot_40l_counter5").setAttribute("data-items",Un),xt("slot_blitz_counter1").setAttribute("data-items",Gn),xt("slot_blitz_counter2").setAttribute("data-items",Gn),xt("slot_blitz_counter3").setAttribute("data-items",Gn),xt("slot_blitz_counter4").setAttribute("data-items",Gn),xt("slot_blitz_counter5").setAttribute("data-items",Gn)}));const Xn="\n---empty---,EMPTY,leave this slot empty;\nscore,SCORE,display the score in this slot;\nspp,SCORE (per piece),display the score and score per piece in this slot;\nstopwatch,STOPWATCH,display the time passed in this slot;\ntimer,TIMER,display the time remaining in this slot (for TIMED objective);\nlines,LINES,display the amount of cleared lines in this slot;\nlevel,LEVEL,display the current level in this slot;\npieces,PIECES,display the amount of placed pieces and speed in this slot;\nkeys,INPUTS,display the amount of buttonpresses in this slot;\nhold,HOLD,display the amount of held pieces in this slot;\nallclears,ALL CLEARS,display the amount of ALL CLEARS in this slot;\ngarbage,GARBAGE CLEARED,display the amount of garbage lines cleared in this slot\n".replace(/\n/g,""),jn=[{id:"room_content_room",classes:"hidden",blocks:[{title:"GENERAL",options:[{id:"name",label:"room name",title:"Name this room will display in the listing as",type:"text",classes:"imp",attributes:'maxlength="64" minlength="1" data-safe="consider"'},{id:"userLimit",label:"player limit",title:"Maximum players in this room. 0 = no limit. Does not apply retroactively.",type:"number",classes:"",attributes:'max="999" min="0"'},{id:"autoStart",label:"auto start",title:"Countdown until the room start. 0 = to disable.",type:"number",classes:"",attributes:'max="60" min="0"',new_until:16672608e5},{id:"public",label:"public room",title:"When enabled, broadcast the room and its info to the public room listing.",type:"checkbox",classes:"",attributes:""},{id:"allowAnonymous",label:"allow anonymous users to join",title:"Whether to allow anonymous users to enter this room. Does not apply retroactively.",type:"checkbox",classes:"",attributes:""},{id:"allowQueued",label:"allow users who are in matchmaking to join",title:"Whether to allow users who are in a matchmaking queue to enter this room. Does not apply retroactively.",type:"checkbox",classes:"",attributes:""},{id:"allowUnranked",label:"allow unranked users to play",title:"Whether to allow unranked users to play in this room.",type:"checkbox",classes:"",attributes:"",new_until:16672608e5},{id:"userRankLimit",label:"rank limit",title:"The maximum TETRA LEAGUE rank players may have to play in this room.",type:"slider",classes:"",attributes:'min="0" max="18" step="1"',new_until:16672608e5},{id:"useBestRankAsLimit",label:"limit by top rank",title:"If a rank limit is set, use the players' top ranks instead of their current ranks.",type:"checkbox",classes:"",attributes:"",new_until:1674882e6},{id:"gamebgm",label:"music",title:"Background song to play. If random, not everyone will hear the same song.",type:"music",classes:"imp",attributes:""}]}]},{id:"room_content_match",classes:"hidden",blocks:[{title:"GENERAL",options:[{id:"match.gamemode",label:"gamemode",title:"Game mode.",type:"spinner",classes:"super-imp",attributes:'data-items="versus,VERSUS,[2 -  players] great for 1v1 and small lobbies!;royale,BATTLE ROYALE,[2 -  players] a full-fledged battle royale gamemode great for big lobbies!;practice,PRACTICE,[2 players] great for live training with a friend! enables undoing and resetting your board, just like in ZEN mode"',new_until:17025984e5},{id:"match.ft",label:"first to (FT)",title:"Amount of rounds one must win to win the game.",type:"number",classes:"imp",attributes:'max="1000" min="1"'},{id:"match.wb",label:"win by (WB)",title:"Amount of points one must have over the second place to secure the win.",type:"number",classes:"imp",attributes:'max="1000" min="1"'},{id:"options.stock",label:"stock",title:"Amount of extra lives one has.",type:"number",classes:"",attributes:'max="10" min="0"'}]}]},{id:"room_content_game",classes:"hidden",blocks:[{title:"GENERAL",options:[{id:"options.presets",label:"game presets",title:"Presets to apply to this room",value:"DEFAULT",type:"spinner",classes:"super-imp",attributes:"id=\"game-presets\" data-items=\"default,DEFAULT,TETR.IO's premier room settings. optimized for battles with small groups or duels against friends and foes alike!;tetra league,TETRA LEAGUE,settings copied directly from TETR.IO's matchmaking rooms! margin times and match goals are shifted slightly with duels in mind.;tetra league (season 1),TETRA LEAGUE (season 1),last season's TETRA LEAGUE rules!;enforced delays,ENFORCED DELAYS,this preset introduces several forms of enforced handling which introduces a generous skill ceiling! puts a focus on efficient and consistent play\\, as opposed to deafeningly fast rounds.;4wide,4-WIDE,this party-focused preset uses a nonstandard board size which allows you to infinitely combo.;100 battle royale,100 BATTLE ROYALE,this preset is similar to the BATTLE ROYALE gamemode but at a slower pace.;classic,CLASSIC,an endurance-focused challenge of pure stacking intellect! almost every value is changed to imitate stacker games made many years ago.;arcade,ARCADE,featuring innovative mechanics created for a popular stacker found in arcades\\, this preset puts a focus on smart stacking and mastery with its custom kick table!;bombs,BOMBS,versus with an explosive twist! stack pieces on top of garbage to clear it and send devastating attacks to your opponents!;quickplay,LEGACY QUICK PLAY,this legacy preset emulates TETR.IO's QUICK PLAY experience pre 6.4.0\"",new_until:17025984e5},{id:"options.bagtype",label:"random bag type",title:"The type of system used to generate random pieces.",type:"spinner",classes:"imp",attributes:'data-items="7-bag,7-BAG,keep shuffling a bag of the 7 tetrominoes;14-bag,14-BAG,keep shuffling a bag of 2x the 7 tetrominoes;7+1-bag,7+1-BAG,keep shuffling a bag of the 7 tetrominoes with one random extra tetromino;7+2-bag,7+2-BAG,keep shuffling a bag of the 7 tetrominoes with two random extra tetrominoes;7+x-bag,7+X-BAG,keep shuffling a bag of the 7 tetrominoes. the first few bags contain a few extras.;classic,CLASSIC,random with repetition protection;pairs,PAIRS,alternate between 2 tetrominoes;total mayhem,TOTAL MAYHEM,completely random generation"'},{id:"options.spinbonuses",label:"allowed spins",title:"The type of pieces allowed to do spins.",type:"spinner",classes:"imp",attributes:'data-items="T-spins,T-SPINS,receive bonuses for spinning T-pieces;all,ALL-SPIN,receive bonuses for spinning all pieces;all-mini,ALL-MINI,receive bonuses for spinning T-pieces and receive back-to-back for spinning all other pieces;handheld,HANDHELD,receive bonuses for spinning all pieces BUT attacks are halved except for T-SPINS;stupid,STUPID,everything is a spin because YEAH WHY NOT (O-spin SUPPORTED!);none,NONE,receive no spin bonuses"',new_until:1724436e6},{id:"options.combotable",label:"combo table",title:"What combo table to use.",type:"spinner",classes:"imp",attributes:'data-items="none,NONE,disable combo chaining;multiplier,MULTIPLIER,TETR.IO\'s combo multiplier;classic guideline,CLASSIC GUIDELINE,classic guideline combo table;modern guideline,MODERN GUIDELINE,modern guideline combo table"',new_until:16672608e5},{id:"options.allow180",label:"allow 180 spins",title:"Whether to allow the 180 rotation key to be used.",type:"checkbox",classes:"imp",attributes:""},{id:"options.kickset",label:"kick table",title:"The type of kicks that pieces can do.",type:"spinner",classes:"",attributes:'data-items="SRS+,SRS+,the default natural rotation system with symmetric I-piece rotation;SRS,SRS,the standard natural rotation system;SRS-X,SRS-X,SRS with more powerful 180 spins;TETRA-X,TETRA-X,novel rotation system by DR OCELOT;NRS,NRS,the classic rotation system;ARS,ARS,rotation system used in arcade games;ASC,ASC,permissive rotation system by WINTERNEBS;none,NONE,no kicks possible"'},{id:"options.usebombs",label:"bombs-style garbage",title:"If enabled, use Bombs-style garbage (stack on top to clear) as opposed to the standard.",type:"checkbox",classes:"",attributes:"",new_until:17131392e5},{id:"options.allow_harddrop",label:"use hard drop",title:"Whether to allow use of the Hard Drop button.",type:"checkbox",classes:"",attributes:""},{id:"options.display_next",label:"use NEXT queue",title:"Whether to show the NEXT queue.",type:"checkbox",classes:"",attributes:""},{id:"options.display_hold",label:"use HOLD queue",title:"Whether to use the HOLD queue.",type:"checkbox",classes:"",attributes:""},{id:"options.nextcount",label:"next pieces",title:"Amount of pieces shown in the NEXT queue, if said queue is enabled.",type:"number",classes:"",attributes:'min="1" max="6"',new_until:17025984e5},{id:"options.display_shadow",label:"show shadow piece",title:"Whether to show the shadow piece.",type:"checkbox",classes:"",attributes:""},{id:"options.are",label:"ARE",title:"Amount of time in frames in between a piece being placed and the next one spawning.",type:"number",classes:"",attributes:'min="0" max="300"'},{id:"options.lineclear_are",label:"line clear ARE",title:"Amount of time in frames in between a piece being placed and the next one spawning, if a line was cleared.",type:"number",classes:"",attributes:'min="0" max="300"'},{id:"options.room_handling",label:"enforce below handling settings",title:"Whether to enforce the handling settings below.",type:"checkbox",classes:"",attributes:""},{id:"options.room_handling_arr",label:"enforced ARR",title:"Auto Repeat Rate, enforced if 'enforce below handling settings' is enabled.",type:"number",classes:"",attributes:'min="0" max="5" step="0.1"'},{id:"options.room_handling_das",label:"enforced DAS",title:"Delayed Auto Shift, enforced if 'enforce below handling settings' is enabled.",type:"number",classes:"",attributes:'min="1" max="20" step="0.1"'},{id:"options.room_handling_sdf",label:"enforced SDF",title:"Soft Drop Factor, enforced if 'enforce below handling settings' is enabled. Use 21 for MAX.",type:"number",classes:"",attributes:'min="5" max="21"'},{id:"options.nolockout",label:"disable lockout",title:"If checked, disables being eliminated from stacking above the skyline.",type:"checkbox",classes:"",attributes:""},{id:"options.boardwidth",label:"board width",title:"The width of the playing field.",type:"number",classes:"",attributes:'max="20" min="4"'},{id:"options.boardheight",label:"board height",title:"The height of the playing field.",type:"number",classes:"",attributes:'max="40" min="4"'}]},{title:"GRAVITY & MARGIN TIME",options:[{id:"options.g",label:"gravity",title:"Starting gravity (how fast blocks drop). Higher is faster.",type:"number",classes:"",attributes:'max="20" min="0" step="0.01"'},{id:"options.gincrease",label:"gravity increase",title:"The amount of gravity increase per second.",type:"number",classes:"",attributes:'max="1" min="0" step="0.0001"'},{id:"options.gmargin",label:"gravity margin time",title:"Amount of time in frames until the gravity starts to increase.",type:"number",classes:"",attributes:'max="100000" min="0" step="1"'},{id:"options.garbagemultiplier",label:"garbage multiplier",title:"Starting garbage multiplier. 1 means normal amount of garbage, 2 means double.",type:"number",classes:"",attributes:'max="100" min="0" step="0.1"'},{id:"options.garbagemargin",label:"garbage margin time",title:"Amount of time in frames until the garbage multiplier starts to increase.",type:"number",classes:"",attributes:'max="100000" min="0" step="1"'},{id:"options.garbageincrease",label:"garbage increase",title:"The amount of garbage multiplier increase per second.",type:"number",classes:"",attributes:'max="1" min="0" step="0.0001"'},{id:"options.messiness_change",label:"messiness on change",title:"The chance (from 0 to 1) that the garbage column changes per attack.",type:"number",classes:"",attributes:'max="1" min="0" step="0.01"',new_until:1711224e6},{id:"options.messiness_inner",label:"messiness within attack",title:"The chance (from 0 to 1) that the garbage column changes per garbage row.",type:"number",classes:"",attributes:'max="1" min="0" step="0.01"',new_until:1711224e6},{id:"options.messiness_nosame",label:"avoid same column RNG",title:"If checked, RNG may not roll the same garbage column twice.",type:"checkbox",classes:"",attributes:"",new_until:1711224e6},{id:"options.messiness_timeout",label:"messiness timeout",title:"Amount of time in frames until garbage will always pick a different column.",type:"number",classes:"",attributes:'max="3600" min="0" step="1"',new_until:1711224e6},{id:"options.locktime",label:"lock delay",title:"If not using master levels, the amount of frames until a piece locks down.",type:"number",classes:"",attributes:'min="1"'},{id:"options.garbagespeed",label:"garbage travel speed",title:"The time it takes in frames for garbage to travel.",type:"number",classes:"",attributes:'min="1" max="600"'},{id:"options.garbagecap",label:"garbage cap",title:"Amount of garbage that may enter the screen at once.",type:"number",classes:"",attributes:'min="1" max="40"'},{id:"options.garbagecapincrease",label:"garbage cap increase",title:"The amount of garbage cap increase per second.",type:"number",classes:"",attributes:'max="1" min="0" step="0.0001"'},{id:"options.garbagecapmax",label:"garbage cap max",title:"Maximum amount the garbage cap may reach.",type:"number",classes:"",attributes:'min="1" max="40"'},{id:"options.garbageabsolutecap",label:"garbage absolute cap",title:"Maximum amount of garbage the pending queue can hold. Any received garbage beyond this limit is nullified.",type:"number",classes:"",attributes:'min="0" max="100"',new_until:17025984e5},{id:"options.garbagephase",label:"garbage phase",title:"Amount of time in frames between each garbage phase. Each pending garbage segment has three phases before activation.",type:"number",classes:"",attributes:'min="0" max="1000"',new_until:17025984e5},{id:"options.garbagetargetbonus",label:"garbage target bonus",title:"Adds a bonus to sent garbage depending on the amount of players targeting you.",type:"spinner",classes:"",attributes:'data-items="none,NONE,no bonus whatsoever;defensive,DEFENSIVE,a bonus is added when defending incoming attacks;offensive,OFFENSIVE,a bonus is added to both defense and offence"',new_until:17025984e5},{id:"options.openerphase",label:"opener phase",title:"Amount of pieces of the opener phase. During the opener phase, if your total lines sent is less than the amount pending, you cancel double.",type:"number",classes:"",attributes:'min="0" max="1000"',new_until:1724436e6},{id:"options.garbageentry",label:"garbage entry",title:"Whether garbage should enter instantly or continuously.",type:"spinner",classes:"",attributes:'data-items="instant,INSTANT,garbage enters instantly;continuous,CONTINUOUS,garbage rolls in one by one;delayed,DELAYED PIECE SPAWN,garbage rolls in one by one but delays your next piece"',new_until:17025984e5},{id:"options.garbageare",label:"garbage are",title:"Amount of time in frames to wait during garbage spawning. Not applicable to instantaneous entry.",type:"number",classes:"",attributes:'min="1" max="300"',new_until:17025984e5},{id:"options.garbagequeue",label:"garbage queue",title:"Whether to only activate the first garbage segment in the queue.",type:"checkbox",classes:"",attributes:"",new_until:17025984e5},{id:"options.garbageblocking",label:"garbage blocking",title:"The type of blocking to use.",type:"spinner",classes:"",attributes:'data-items="combo blocking,COMBO BLOCKING,incoming garbage will be delayed and reduced on successive line clears;limited blocking,LIMITED BLOCKING,incoming garbage can be reduced only once per next immediate piece;none,NONE,incoming garbage cannot be blocked"',new_until:16672608e5},{id:"options.manual_allowed",label:"allow manual targeting",title:"Whether to allow users to click boards to manually target them.",type:"checkbox",classes:"",attributes:""},{id:"options.b2bchaining",label:"enable back-to-back chaining",title:"Whether to make long Back-to-Back chains become more powerful.",type:"checkbox",classes:"",attributes:""},{id:"options.b2bcharging",label:"enable back-to-back charging",title:"Whether to charge up a large spike with Back-to-Back, sent by breaking the chain.",type:"checkbox",classes:"",attributes:"",new_until:1724436e6},{id:"options.allclears",label:"enable all clears",title:"Whether to reward clearing the entire board",type:"checkbox",classes:"",attributes:"",new_until:1693099917e3},{id:"options.allclear_garbage",label:"all clear garbage",title:"Amount of garbage sent when performing an All Clear.",type:"number",classes:"",attributes:'min="0" max="100"',new_until:1724436e6},{id:"options.allclear_b2b",label:"all clear back-to-back",title:"Amount of Back-To-Back chains applied when performing an All Clear.",type:"number",classes:"",attributes:'min="0" max="100"',new_until:1724436e6},{id:"options.clutch",label:"enable clutch clears",title:"Whether to allow out-of-bound placements when they clear a line.",type:"checkbox",classes:"",attributes:""},{id:"options.passthrough",label:"garbage passthrough",title:"Whether attacks can be canceled while in transit or during latency.",type:"spinner",classes:"imp",attributes:'data-items="zero,ZERO,opposing attacks in transit always cancel eachother out;limited,LIMITED,opposing attacks in transit cancel out while garbage is flying;consistent,CONSISTENT,opposing attacks in transit cancel out except when garbage is flying;full,FULL,opposing attacks in transit do not cancel eachother out"',new_until:16818624e5},{id:"options.roundmode",label:"rounding mode",title:"The type of rounding mode to use for garbage.",type:"spinner",classes:"",attributes:'data-items="down,DOWN,all values are rounded down;rng,RNG,weighted randomness is used to smooth values (e.g. 1.23 has a 23% chance to become 2)"',new_until:1724436e6}]}]}],qn=[{id:"custom_content_game",classes:"",blocks:[{title:"GENERAL",options:[{id:"bagtype",label:"random bag type",title:"The type of system used to generate random pieces.",type:"spinner",classes:"imp",value:"7-bag",attributes:'data-items="7-bag,7-BAG,keep shuffling a bag of the 7 tetrominoes;14-bag,14-BAG,keep shuffling a bag of 2x the 7 tetrominoes;7+1-bag,7+1-BAG,keep shuffling a bag of the 7 tetrominoes with one random extra tetromino;7+2-bag,7+2-BAG,keep shuffling a bag of the 7 tetrominoes with two random extra tetrominoes;7+x-bag,7+X-BAG,keep shuffling a bag of the 7 tetrominoes. the first few bags contain a few extras.;classic,CLASSIC,random with repetition protection;pairs,PAIRS,alternate between 2 tetrominoes;total mayhem,TOTAL MAYHEM,completely random generation"'},{id:"spinbonuses",label:"allowed spins",title:"The type of pieces allowed to do spins.",type:"spinner",classes:"imp",value:"all-mini",attributes:'data-items="T-spins,T-SPINS,receive bonuses for spinning T-pieces;all,ALL-SPIN,receive bonuses for spinning all pieces;all-mini,ALL-MINI,receive bonuses for spinning T-pieces and receive back-to-back for spinning all other pieces;handheld,HANDHELD,recieve bonuses for spinning all pieces. non T-SPINS attacks are halved. pieces use 4-corner detection;stupid,STUPID,everything is a spin because YEAH WHY NOT (O-spin SUPPORTED!);none,NONE,receive no spin bonuses"',new_until:1724436e6},{id:"combotable",label:"combo table",title:"What combo table to use.",type:"spinner",classes:"imp",value:"multiplier",attributes:'data-items="none,NONE,Disable combo chaining;multiplier,MULTIPLIER,TETR.IO\'s combo multiplier;classic guideline,CLASSIC GUIDELINE,classic guideline combo table;modern guideline,MODERN GUIDELINE,modern guideline combo table"'},{id:"allclears",label:"enable all clears",title:"Whether to reward clearing the entire board",type:"checkbox",classes:"",attributes:"checked",new_until:1693099917e3},{id:"seed_random",label:'use random seed (overrides "seed")',title:"Whether to use a random seed.",type:"checkbox",classes:"",attributes:"checked"},{id:"seed",label:"seed",title:'Seed to use, if "use random seed" is not checked.',type:"number",classes:"",attributes:'max="2147483647" min="0" value="0"'},{id:"can_retry",label:"allow retry",title:"Whether to allow retrying.",type:"checkbox",classes:"",attributes:"checked"},{id:"stock",label:"stock",title:"Amount of extra lives one has.",type:"number",classes:"",attributes:'max="10" min="0" value="0"'},{id:"clutch",label:"enable clutch clears",title:"Whether to allow out-of-bound placements when they clear a line.",type:"checkbox",classes:"",attributes:"checked"},{id:"nolockout",label:"disable lockout",title:"If checked, disables being eliminated from stacking above the skyline.",type:"checkbox",classes:"",attributes:"checked"},{id:"boardwidth",label:"board width",title:"The width of the playing field.",type:"number",classes:"",attributes:'max="20" min="4" value="10"'},{id:"boardheight",label:"board height",title:"The height of the playing field.",type:"number",classes:"",attributes:'max="40" min="4" value="20"'}]},{title:"SURVIVAL",options:[{id:"survivalmode",label:"mode",title:"Type of survival garbage (cheese) to spawn.",type:"spinner",classes:"",value:"none",attributes:'data-items="none,NONE,do not spawn any garbage;layer,LAYER,keep a layer of garbage on the board;timer,TIMER,spawn garbage on a timer"'},{id:"survival_messiness",label:"garbage messiness %",title:"How messy survival garbage is, if enabled. 0 = completely clean, 100 = completely messy.",type:"number",classes:"",attributes:'max="100" min="0" value="100"'},{id:"survival_cap",label:"garbage cap",title:"Maximum amount of survival garbage to spawn. Any additional garbage will not spawn. 0 = infinite.",type:"number",classes:"",attributes:'max="1000000" min="0" value="0"'},{id:"survival_layer_amt",label:"layer height",title:"If the survival mode is set to layer, the height of said layer.",type:"number",classes:"",attributes:'max="40" min="1" value="9"'},{id:"survival_layer_non",label:"sticky layer",title:"If checked, do not raise the cheese layer while in a combo.",type:"checkbox",classes:"",attributes:"checked"},{id:"survival_layer_min",label:"minimum layer height",title:"If the survival mode is set to layer, the minimum height of said layer. (Garbage cap overrides this!)",type:"number",classes:"",attributes:'max="40" min="0" value="3"'},{id:"survival_timer_itv",label:"timer interval",title:"If the survival mode is set to timer, the interval in frames between spawns.",type:"number",classes:"",attributes:'max="216000" min="1" value="60"'}]},{title:"CONTROLS",options:[{id:"allow180",label:"allow 180 spins",title:"Whether to allow the 180 rotation key to be used.",type:"checkbox",classes:"",attributes:"checked"},{id:"kickset",label:"kick table",title:"The type of kicks that pieces can do.",type:"spinner",classes:"",value:"SRS+",attributes:'data-items="SRS+,SRS+,the default natural rotation system with symmetric I-piece rotation;SRS,SRS,the standard natural rotation system;SRS-X,SRS-X,SRS with more powerful 180 spins;TETRA-X,TETRA-X,novel rotation system by DR OCELOT;NRS,NRS,the classic rotation system;ARS,ARS,rotation system used in arcade games;ASC,ASC,permissive rotation system by WINTERNEBS;none,NONE,no kicks possible"'},{id:"allow_harddrop",label:"use hard drop",title:"Whether to allow use of the Hard Drop button.",type:"checkbox",classes:"",attributes:"checked"},{id:"display_next",label:"use NEXT queue",title:"Whether to show the NEXT queue.",type:"checkbox",classes:"",attributes:"checked"},{id:"display_hold",label:"use HOLD queue",title:"Whether to use the HOLD queue.",type:"checkbox",classes:"",attributes:"checked"},{id:"nextcount",label:"next pieces",title:"Amount of pieces shown in the NEXT queue, if said queue is enabled.",type:"number",classes:"",attributes:'min="1" value="5" max="5"'},{id:"infinite_movement",label:"infinite movement",title:"Whether to never lock, as long as you keep moving the piece.",type:"checkbox",classes:"",attributes:""},{id:"display_shadow",label:"show shadow piece",title:"Whether to show the shadow piece.",type:"checkbox",classes:"",attributes:"checked"},{id:"are",label:"ARE",title:"Amount of time in frames in between a piece being placed and the next one spawning.",type:"number",classes:"",attributes:'min="0" value="0" max="300"'},{id:"lineclear_are",label:"line clear ARE",title:"Amount of time in frames in between a piece being placed and the next one spawning, if a line was cleared.",type:"number",classes:"",attributes:'min="0" value="0" max="300"'}]},{title:"GRAVITY & LEVELLING",options:[{id:"g",label:"gravity",title:"Gravity (how fast blocks drop). Higher is faster.",type:"number",classes:"",attributes:'max="100" min="0" step="0.01" value="0.02"'},{id:"levels",label:'use levelling (overrides "gravity")',title:"Whether to allow players to level up. Overrides the normal gravity.",type:"checkbox",classes:"",attributes:"checked"},{id:"masterlevels",label:"use master levels",title:"If enabled, allow levels past 20 to become MASTER LEVELS (faster lock-down time and less resets).",type:"checkbox",classes:"",attributes:""},{id:"startinglevel",label:"starting level",title:"Level to start at.",type:"number",classes:"",attributes:'value="1" min="1"'},{id:"levelspeed",label:"level speed",title:"How fast you clear levels.",type:"number",classes:"",attributes:'step="0.01" value="1"'},{id:"levelstatic",label:'use static levelling (overrides "level speed")',title:"Use a static amount of lines to level up.",type:"checkbox",classes:"",attributes:"checked"},{id:"levelstaticspeed",label:"level static speed",title:"If using static levelling, the amount of lines needed to clear a level.",type:"number",classes:"",attributes:'min="1" value="10"'},{id:"levelgbase",label:"base gravity",title:"When using levels, the starting gravity.",type:"number",classes:"",attributes:'step="0.01" value="0.8"'},{id:"levelgspeed",label:"gravity increase",title:"When using levels, the speed with which gravity increases.",type:"number",classes:"",attributes:'step="0.001" value="0.007"'},{id:"locktime",label:"lock delay",title:"If not using master levels, the amount of frames until a piece locks down.",type:"number",classes:"",attributes:'min="1" value="30"'}]}]},{id:"custom_content_objective",classes:"hidden",blocks:[{title:"GENERAL",options:[{id:"objective_type",label:"objective",title:"Game mode.",type:"spinner",classes:"super-imp",value:"lines",attributes:'data-items="none,NONE,play infinitely;lines,LINES,get to a set amount of lines to clear;timed,TIMED,play for a set amount of time to clear;garbage,GARBAGE,get to a set amount of garbage lines to clear"'},{id:"objective_count",label:"count",title:"Amount of primary key to get in LINES mode. For example, in LINES mode this would be the amount of lines to be cleared.",type:"number",classes:"imp",attributes:'min="1" value="150"'},{id:"objective_time",label:"time",title:"Amount of time in milliseconds. For example, in TIMED mode this would be the amount of time until the game ends.",type:"number",classes:"imp",attributes:'min="1" value="120000"'},{id:"objective_result",label:"key",title:"The counter you will be judged on at the end of the game.",type:"spinner",classes:"super-imp",value:"score",attributes:'data-items="score,SCORE,final score will be displayed;time,TIME,final time will be displayed;lines,LINES,final line count will be displayed"'},{id:"topoutisclear",label:"topping out is OK",title:"If enabled, still display the results screen if the player tops out.",type:"checkbox",classes:"",attributes:"checked"},{id:"pro",label:"display objective behind board",title:"If enabled, show the objective target on the board. (pro mode)",type:"checkbox",classes:"",attributes:""}]}]},{id:"custom_content_meta",classes:"hidden",blocks:[{title:"INTRO",options:[{id:"mission",label:"mission",title:"Text displayed before starting game.",type:"text",classes:"imp",attributes:'value="CUSTOM GAME"'},{id:"stride",label:"stride mode",title:"Speeds up animations and disables some of the below settings.",type:"checkbox",classes:"",attributes:""},{id:"countdown",label:"play countdown",title:"Whether to play a countdown.",type:"checkbox",classes:"",attributes:"checked"},{id:"countdown_count",label:"countdown count",title:"Amount of steps in the countdown.",type:"number",classes:"",attributes:'min="1" value="3" max="60"'},{id:"countdown_interval",label:"countdown interval",title:"Amount of milliseconds between countdown ticks.",type:"number",classes:"",attributes:'min="1" value="1000"'},{id:"precountdown",label:"time before countdown",title:"Amount of milliseconds before the countdown is started.",type:"number",classes:"",attributes:'min="1" value="3000"'},{id:"prestart",label:"time before start",title:"Amount of milliseconds before the game is created.",type:"number",classes:"",attributes:'min="1" value="1000"'},{id:"zoominto",label:"zoom animation",title:"Type of animation to play when starting.",type:"spinner",classes:"",value:"slow",attributes:'data-items="none,NO ANIMATION,display no animation;fast,FAST,display a fast animation;slow,SLOW,display a slow animation;cinematic,CINEMATIC,display a very slow animation"'}]},{title:"COUNTERS",options:[{id:"slot_counter1",label:"left counter slot 1",title:"The type of metric to display in the first left-hand slot.",type:"spinner",classes:"",value:"stopwatch",attributes:`data-items="${Xn}"`},{id:"slot_counter2",label:"left counter slot 2",title:"The type of metric to display in the second left-hand slot.",type:"spinner",classes:"",value:"lines",attributes:`data-items="${Xn}"`},{id:"slot_counter3",label:"left counter slot 3",title:"The type of metric to display in the third left-hand slot.",type:"spinner",classes:"",value:"level",attributes:`data-items="${Xn}"`},{id:"slot_counter4",label:"left counter slot 4",title:"The type of metric to display in the fourth left-hand slot.",type:"spinner",classes:"",value:"---empty---",attributes:`data-items="${Xn}"`},{id:"slot_counter5",label:"right counter slot",title:"The type of metric to display in the right-hand slot.",type:"spinner",classes:"",value:"score",attributes:`data-items="${Xn}"`},{id:"absolute_lines",label:"enforce absolute line count",title:"Do not display the progression through the level in the line count.",type:"checkbox",classes:"",attributes:"checked"},{id:"slot_bar2",label:"display progress bar",title:"Whether to display the progress bar on the right.",type:"checkbox",classes:"",attributes:"checked"}]}]}];function Kn(e,t){let n="";return e.forEach((e=>{n+=`<div class="scroller room_content tab_content ${e.classes}" data-scope="${t}" id="${e.id}"><p class="rc_moreinfo ns">hover over a setting for more info</p>`,e.blocks.forEach((e=>{n+=`<div class="scroller_block light"><h2 class="ns">${e.title}</h2>`,e.options.forEach((e=>{let t="";switch(Date.now()<e.new_until&&(t+='<div class="room_config_newtag ns">NEW</div>'),e.type){case"text":n+=`<div class="room_config_row flex-row ${e.classes}" title="${e.title}">\n\t\t\t\t\t\t\t\t\t<div class="room_config_label flex-item ns">${e.label}</div>\n\t\t\t\t\t\t\t\t\t<input class="room_config_item flex-item" data-index="${e.id}" ${e.attributes}>\n\t\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t</div>`;break;case"number":n+=`<div class="room_config_row flex-row ${e.classes}" title="${e.title}">\n\t\t\t\t\t\t\t\t\t<div class="room_config_label flex-item ns">${e.label}</div>\n\t\t\t\t\t\t\t\t\t<input type="number" class="room_config_item flex-item" data-index="${e.id}" ${e.attributes}>\n\t\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t</div>`;break;case"checkbox":n+=`<div class="room_config_row flex-row ${e.classes}" title="${e.title}">\n\t\t\t\t\t\t\t\t\t<div class="room_config_label flex-item ns">${e.label}</div>\n\t\t\t\t\t\t\t\t\t<label class="rc_switch flex-item"><input type="checkbox" class="room_config_item" data-index="${e.id}" ${e.attributes}><span class="rc_switch_knob"></span></label>\n\t\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t</div>`;break;case"spinner":n+=`<div class="room_config_row flex-row ${e.classes}" title="${e.title}">\n\t\t\t\t\t\t\t\t\t<div class="room_config_label flex-item ns">${e.label}</div>\n\t\t\t\t\t\t\t\t\t<div class="room_config_item room_config_spinner flex-item ns" data-index="${e.id}" ${e.attributes}>${e.value||""}</div>\n\t\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t</div>`;break;case"music":n+=`<div class="room_config_row flex-row ${e.classes}" title="${e.title}">\n\t\t\t\t\t\t\t\t\t<div class="room_config_label flex-item ns">${e.label}</div>\n\t\t\t\t\t\t\t\t\t<div class="room_config_item room_config_spinner flex-item music_picker ns" data-index="${e.id}" ${e.attributes}></div>\n\t\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t</div>`;break;case"slider":n+=`<div class="room_config_row flex-row ${e.classes}" title="${e.title}">\n\t\t\t\t\t\t\t\t\t<div class="room_config_label flex-item ns">${e.label}</div>\n\t\t\t\t\t\t\t\t\t<div class="room_config_slider flex-item ns" title="${e.title}">\n\t\t\t\t\t\t\t\t\t\t<input id="rank_limit" data-index="${e.id}" class="room_config_item center minor_range rg_target_pri" type="range" ${e.attributes}>\n\t\t\t\t\t\t\t\t\t\t<div id="rank_field" class="verticalstrip" style="--pos: 0; --count: 18; background-image: url('/res/league-ranks/strip.png');"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t</div>`}})),n+="</div>"})),n+="</div>"})),n}kn.ready((function(){xt("room_opts_save").outerHTML=Kn(jn,"room_opts")+xt("room_opts_save").outerHTML,xt("custom_content_container").innerHTML=Kn(qn,"custom_opts"),!1===it.video.guide&&(xt("room_opts_welcome").classList.remove("active"),xt("room_opts_room").classList.add("active"),xt("room_content_welcome").classList.add("hidden"),xt("room_content_room").classList.remove("hidden"))})),kn.ready((function(e){fs(!0),window.addEventListener("resize",(()=>{fs(!0)}),!1),setTimeout((()=>{fs(!0)}),10)}));let Vn=0,Qn=0,Yn=1,Jn=1,Zn=0,es=1;const ts=30,ns={top:new Map,left:new Map,right:new Map,bottom:new Map};let ss=0,is=0;const os=1600,as=800;let rs=1,ls=0,cs=0,ps=0,ds=0,hs=0,us=0,_s=0,ms=0,gs=!0;function fs(e){if(!e&&!gs)return;e||(gs=!1),Vn=window.innerWidth,Yn=window.innerHeight,Qn=Vn-2*ts-Array.from(ns.left.values()).reduce(((e,t)=>e+t),0)-Array.from(ns.right.values()).reduce(((e,t)=>e+t),0),Jn=Yn-2*ts-Array.from(ns.top.values()).reduce(((e,t)=>e+t),0)-Array.from(ns.bottom.values()).reduce(((e,t)=>e+t),0),Zn=Qn/Math.max(1,Jn),es=it.video.zoom||1,Zn<2?(ss=Qn,is=Qn/2):(ss=2*Jn,is=Jn),rs=ss/os*es,ls=Qn-ss,cs=Jn-is,ps=ts+Array.from(ns.left.values()).reduce(((e,t)=>e+t),0)+ls/2,ds=window.innerWidth-(ts+Array.from(ns.right.values()).reduce(((e,t)=>e+t),0)+ls/2),hs=ts+Array.from(ns.top.values()).reduce(((e,t)=>e+t),0)+cs/2,us=window.innerHeight-(ts+Array.from(ns.bottom.values()).reduce(((e,t)=>e+t),0)+cs/2);_s=ps+(ds-ps)/2-rs*os/2,ms=hs+(us-hs)/2-rs*as/2,yt('canvas[data-fit="screen"]').forEach((e=>{e.width=Vn,e.height=Yn})),yt('canvas[data-fit="contain"]').forEach((e=>{e.width=ss,e.height=is,e.style.left=`${_s}px`,e.style.top=`${ms}px`})),yt('canvas[data-fit="constrain"]').forEach((e=>{e.width=e.getAttribute("data-w")*rs,e.height=e.getAttribute("data-h")*rs})),xt("sbt")&&(xt("sbt").style.left=`${ts+Array.from(ns.left.values()).reduce(((e,t)=>e+t),0)}px`,xt("sbt").style.top=`${ts+Array.from(ns.top.values()).reduce(((e,t)=>e+t),0)}px`,xt("sbt").style.right=`${ts+Array.from(ns.right.values()).reduce(((e,t)=>e+t),0)}px`,xt("sbt").style.bottom=`${ts+Array.from(ns.bottom.values()).reduce(((e,t)=>e+t),0)}px`),document.documentElement.style.setProperty("--r",rs),dl&&(xl(),dl.position.set(_s,ms),hl.position.set(_s,ms),Xr.position.set(-_s,-ms),nl&&nl.fit()),e&&v?.forEach((e=>e.flushCanvases()))}function bs(){v?.forEach((e=>"tiny"!==e.getDisplayMode()&&e.flushCanvases()))}function Cs(e,t,n){ns[e].get(t)!==n&&(ns[e].set(t,n),fs(!0))}function xs(e,t){void 0!==ns[e].get(t)&&(ns[e].delete(t),fs(!0))}function As(e){return e*rs}function ys(e){return e/rs}function vs(e){return e*(30/92)}function Bs(e){return e/(30/92)}function ws(e){return As(vs(e))}function Ls(e){return ys(Bs(e))}let ks=null,Ss=null,Fs;function zs(){document.body.classList.add("electron"),setTimeout((()=>{document.body.setAttribute("desktop-version",`v${window.CLIENT_VERSION}`)}),1e3),setTimeout((()=>{document.body.setAttribute("desktop-version",`v${window.CLIENT_VERSION}`)}),15e3),navigator.onLine||document.body.classList.add("offline"),window.addEventListener("offline",(function(e){document.body.classList.add("offline")})),window.addEventListener("online",(function(e){document.body.classList.remove("offline")})),document.addEventListener("keydown",(e=>{if(!e.repeat){if("f5"===e.key.toLowerCase()||"r"===e.key.toLowerCase()&&e.ctrlKey){if(!Ln&&document.body.classList.contains("ingame_phys")&&xt("menus").classList.contains("hidden")&&0===$i)return;kn.update(!0)}("I"===e.key&&e.ctrlKey||"f12"===e.key.toLowerCase())&&window.IPC.send("devtools"),"f11"===e.key.toLowerCase()&&"darwin"!==PLATFORM_TYPE&&window.IPC.send("fullscreen"),"f4"!==e.key.toLowerCase()||ks||(ks=setTimeout((()=>{window.IPC.send("emergency")}),5e3),Ss=setTimeout((()=>{Kt("keep holding F4 to enable SAFE MODE")}),1e3))}}),!1),document.addEventListener("keyup",(e=>{"f4"===e.key.toLowerCase()&&ks&&(clearTimeout(ks),clearTimeout(Ss),ks=null,Ss=null)}),!1),window.IPC.on("goto",((e,t)=>{if(!xt("preload").classList.contains("hidden")||document.body.classList.contains("ingame")||Sa&&Sa.isConnected()&&t.startsWith(`https://${_.domain}/#`))return Ln=!0,void(window.location=t);const n=t.replace(`https://${_.domain}/#`,"");switch(n.substring(0,2)){case"R:":ia.navigateToID(n.trim());break;case"P:":case"D:":break;default:Di("connecting to live servers"),Sa.require().then((e=>{Oi(),Li("playmulti"),e.maintenance&&document.body.classList.add("maintenance"),Oa.joinRoom(n.trim())})).catch((()=>{Oi(),Yt("could not connect to live servers")}))}}))}function Ts(){}function Is(){window.IS_ELECTRON?(Ln=!0,window.IPC.send("close")):console.error("Tried to exit while not on Electron")}function Ms(e){window.IS_ELECTRON?(window.IPC.send("nuke"),setTimeout((()=>{caches.delete("tetrio-dyn").then(e).catch((e=>{console.error(e)}))}),500)):e()}function Es(e){window.IS_ELECTRON&&!1!==it.electron.presence&&!0!==_.norichpresence&&(e.largeImageText=mn.anon()?"Playing anonymously":`${mn.username().toUpperCase()} - Lv. ${xt("me_level").innerHTML}${xt("me_leaguerank").classList.contains("hidden")?"":` - ${xt("me_leaguerank").getAttribute("src").replace("/res/league-ranks/","").replace(".png","").toUpperCase()}`}`,mn.anon()||(e.buttons=[{label:"View Profile",url:`https://${_.ch_domain}/u/${mn.username()}`}]),window.IPC.send("presence",e))}function Ds(){window.IS_ELECTRON&&!1!==it.electron.taskbarflash&&window.IPC.send("flash")}function Os(e){window.IS_ELECTRON&&window.IPC.send("blockmovement",!!e)}function Hs(){const e=_.countdown-Date.now();if(e<=0)xt("prelaunch_countdown").innerHTML="00:00:00",clearInterval(Fs),xt("prelaunch").classList.add("hiding"),setTimeout((()=>{xt("prelaunch").classList.add("hidden")}),7500);else{let t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),s=Math.floor(e%6e4/1e3);t<10&&(t=`0${t}`),n<10&&(n=`0${n}`),s<10&&(s=`0${s}`),xt("prelaunch_countdown").innerHTML=`${t}:${n}<span class="sec">:${s}</span>`}}Wt((()=>{_.countdown&&_.countdown>Date.now()&&(xt("prelaunch").classList.remove("hidden"),Fs=setInterval((()=>{Hs()}),100),Hs())}));const Ps=(()=>{let e=!1,t=0,n=!1,s=!1,i="";const o={"menus-persistent-mpu":{name:"Menus Persistent MPU",id:"ceriad-menus-persistent-mpu",type:"med_rect_atf",enabled:!0,refresh:!1,refresh_time:3e4,min_width:1366,bodyclasses:["mpmpu-mounted"]},"zenith-persistent-mpu":{name:"Zenith Persistent MPU",id:"ceriad-zenith-persistent-mpu",type:"med_rect_atf",enabled:!0,refresh:!1,refresh_time:3e4,min_width:1366,bodyclasses:["zpmpu-mounted"]},"home-lb":{name:"Homebanner",id:"ceriad-home-lb",type:"leaderboard_atf",enabled:!0,refresh:!1,refresh_time:3e4,max_width:1365},"solo-lb":{name:"Solo Menu",id:"ceriad-solo-lb",type:"leaderboard_atf",enabled:!0,refresh:!1,refresh_time:3e4,max_width:1365},"multiplayer-lb":{name:"Multiplayer Menu",id:"ceriad-multiplayer-lb",type:"leaderboard_atf",enabled:!0,refresh:!1,refresh_time:3e4,max_width:1365},"lobby-lb":{name:"Custom Room Lobby",id:"ceriad-lobby-lb",type:"leaderboard_btf",enabled:!0,refresh:!1,refresh_time:3e4},"sysroom-mpu":{name:"Quick Play Lobby",id:"ceriad-sysroom-mpu",type:"med_rect_atf",enabled:!0,refresh:!1,refresh_time:3e4},"roomresults-lb":{name:"Custom Room Results",id:"ceriad-roomresults-lb",type:"leaderboard_atf",enabled:!0,refresh:!1,refresh_time:3e4},"league-lb":{name:"Tetra League Home",id:"ceriad-league-lb",type:"leaderboard_atf",enabled:!0,refresh:!1,refresh_time:3e4,max_width:1365},"soloresults-lb":{name:"Solo Results",id:"ceriad-soloresults-lb",type:"leaderboard_atf",enabled:!0,refresh:!1,refresh_time:3e4,max_width:1365},"auth-login-lb":{name:"Login Screen",id:"ceriad-auth-login-lb",type:"leaderboard_atf",enabled:!0,refresh:!1},"auth-return-lb":{name:"Welcome Back Screen",id:"ceriad-auth-return-lb",type:"leaderboard_atf",enabled:!0,refresh:!1},"ingame-bottom_rail":{name:"Ingame Bottom Rail",id:"pw-oop-bottom_rail",type:"bottom_rail",tagless:!0,enabled:!1,allowIf:()=>window.innerWidth<=1.5*window.innerHeight,refresh:!1,refresh_time:3e4,safezones:[["bottom","ingame-bottom_rail",70]],bodyclasses:["igceriad-mounted_bottom"],animated:!1,unmountIfNotLoaded:!1,onlyApplySafeZonesWhenLoaded:!0,onlyApplyBodyClassesWhenLoaded:!0},"ingame-left_rail":{name:"Ingame Left Rail",id:"pw-oop-left_rail",type:"left_rail",tagless:!0,enabled:!1,allowIf:()=>window.innerWidth>1.5*window.innerHeight&&!Fa,refresh:!1,refresh_time:3e4,safezones:[["left","ingame-left_rail",130]],needsSafeZones:()=>!!Fa,bodyclasses:["igceriad-mounted_left"],animated:!1,unmountIfNotLoaded:!1,onlyApplySafeZonesWhenLoaded:!0,onlyApplyBodyClassesWhenLoaded:!0},"ingame-right_rail":{name:"Ingame Right Rail",id:"pw-oop-right_rail",type:"right_rail",tagless:!0,enabled:!1,allowIf:()=>window.innerWidth>1.5*window.innerHeight,refresh:!1,refresh_time:3e4,safezones:[["right","ingame-right_rail",130]],needsSafeZones:()=>!!Fa,bodyclasses:["igceriad-mounted_right"],animated:!1,unmountIfNotLoaded:!1,onlyApplySafeZonesWhenLoaded:!0,onlyApplyBodyClassesWhenLoaded:!0}},a={login:["auth-login-lb","auth-return-lb"],main:["menus-persistent-mpu","home-lb","solo-lb","multiplayer-lb","lobby-lb","roomresults-lb","league-lb","soloresults-lb","sysroom-mpu"],ingame:["ingame-bottom_rail","ingame-left_rail","ingame-right_rail"],zenith:["zenith-persistent-mpu"]};function r(t=!1,a=1){e&&(n||(n=!0,s=t,setTimeout((()=>{n&&async function(){n=!1;const e=[];let t="";if(Object.keys(o).forEach((n=>{o[n].enabled&&o[n].mounted&&(e.push({type:o[n].type,selectorId:o[n].tagless?void 0:o[n].id}),t+=`${n},`)})),s&&t===i)return void(s=!1);s=!1,i=t,await window.ramp.destroyUnits("all"),await window.ramp.addUnits(e),await window.ramp.displayUnits()}()}),a)))}function l(n,s=!1){if(!o[n])return;const i=u(n,e);if(!o[n].enabled||window.innerWidth<(o[n].min_width||0)||window.innerWidth>=(o[n].max_width||9999)||o[n].allowIf&&!o[n].allowIf())i?.classList.add("hidden");else if(!document.body.classList.contains("ceriad_disabled")){if(i?.classList.remove("hidden"),o[n].mounted||(console.log(`${n} mounted, now ${++t} mounts`),o[n].animated&&(i?.getBoundingClientRect(),i?.classList.remove("hiding"))),o[n].mounted=!0,o[n].elapsed=0,r(s),o[n].safezones&&!o[n].onlyApplySafeZonesWhenLoaded&&(!o[n].needsSafeZones||o[n].needsSafeZones()))for(const e of o[n].safezones)Cs(...e);if(o[n].bodyclasses&&!o[n].onlyApplyBodyClassesWhenLoaded)for(const e of o[n].bodyclasses)document.body.classList.add(e);if(o[n].unmountIfNotLoaded||o[n].onlyApplySafeZonesWhenLoaded||o[n].onlyApplyBodyClassesWhenLoaded){const t=performance.now(),s=setInterval((()=>{if(!o[n].mounted)return void clearInterval(s);const i=u(n,e);let a=!0;if(i?("loaded"!==i.dataset.pwStatus||""===i.innerHTML||At(`#${o[n].id}>div`)&&""===At(`#${o[n].id}>div`).innerHTML)&&(a=!1):a=!1,a){if(clearInterval(s),o[n].onlyApplySafeZonesWhenLoaded&&o[n].safezones&&(!o[n].needsSafeZones||o[n].needsSafeZones()))for(const e of o[n].safezones)Cs(...e);if(o[n].bodyclasses&&o[n].onlyApplyBodyClassesWhenLoaded)for(const e of o[n].bodyclasses)document.body.classList.add(e)}else performance.now()-t>=5e3&&o[n].unmountIfNotLoaded&&(clearInterval(s),console.log(`${n} unmounted, no content available after ${performance.now()-t}ms`),c(n))}),100)}}}function c(e,n=!1){if(!o[e])return;const s=u(e);if(!o[e].enabled)return;const i=o[e].mounted;if(o[e].mounted&&console.log(`${e} unmounted, now ${--t} mounts`),o[e].mounted=!1,o[e].elapsed=0,i&&r(n),o[e].safezones)for(const t of o[e].safezones)xs(...t);if(o[e].bodyclasses)for(const t of o[e].bodyclasses)document.body.classList.remove(t);o[e].animated&&(s?.classList.add("hiding"),setTimeout((()=>{o[e].mounted||s?.classList.add("hidden")}),500))}function p(e){a[e]&&a[e].forEach((e=>{c(e)}))}function d(){Object.keys(o).forEach((e=>{c(e)}))}let h=0;function u(e,t){if(!o[e])return null;let n=xt(o[e].id);if(!n){if(n=At(`.ceriad[data-cid="${e}"]`),!n)return null;t&&(n.id=o[e].id)}return n}Wt((()=>{setInterval((()=>{"visible"===document.visibilityState&&(xt("menus").classList.contains("hidden")&&xt("preload").classList.contains("hidden")?(p("login"),p("main")):p("ingame"),document.body.classList.contains("inzenith")||p("zenith"),function(e=!1){if(e||!h)return void(h=Date.now());const t=Date.now()-h;h=Date.now(),Object.keys(o).forEach((e=>{o[e].enabled&&o[e].refresh&&o[e].mounted&&(o[e].elapsed=(o[e].elapsed||0)+t,o[e].elapsed>=o[e].refresh_time&&l(e))}))}(),function(){for(const e of yt("[data-adunit-name]"))e.insertAdjacentElement("afterend",e.firstElementChild),e.remove()}(),Object.keys(o).forEach((e=>{o[e].mounted&&o[e].allowIf&&(o[e].allowIf()||c(e))})))}),1e3),window.IS_ELECTRON||(o["ingame-bottom_rail"].enabled=!0,o["ingame-left_rail"].enabled=!0,o["ingame-right_rail"].enabled=!0)}));let _=!1;return{getElement:u,mount:l,mountGroup:function(e){a[e]&&a[e].forEach((e=>{l(e)}))},mountIfMounted:function(e){o[e]&&o[e].enabled&&o[e].mounted&&l(e)},unmount:c,unmountGroup:p,unmountAll:d,loadProvider:async function(){if(!_){_=!0;try{let t,n;console.log("Loading Ceriad provider...");const s=new Promise(((e,s)=>{t=e,n=s}));let i,o;const a=new Promise(((e,t)=>{i=e,o=t})),l=document.createElement("script");if(l.type="text/javascript",l.text="\n\t\twindow.ramp = window.ramp || {};\n\t\twindow.ramp.que = window.ramp.que || [];\n\t\twindow.ramp.passiveMode = true;\n\t\twindow._pwGA4PageviewId = ''.concat(Date.now());\n\t\twindow.dataLayer = window.dataLayer || [];\n\t\twindow.gtag = window.gtag || function () {\n\t\t\tdataLayer.push(arguments);\n\t\t};\n\t\tgtag('js', new Date());\n\t\tgtag('config','G-EPJJCKW3S3', { 'send_page_view': false });\n\t\tgtag(\n\t\t\t'event',\n\t\t\t'ramp_js',\n\t\t\t{\n\t\t\t\t'send_to':'G-EPJJCKW3S3',\n\t\t\t\t'pageview_id': window._pwGA4PageviewId\n\t\t\t}\n\t\t);\n\t",document.head.insertAdjacentElement("beforeend",l),!window.ramp)throw new Error("Ceriad provider loaded but not available. Bailing out.");const c=new Promise((e=>window.ramp.que.push(e))),p=document.createElement("script");p.type="text/javascript",p.onload=t,p.onerror=n,p.src="https://www.googletagmanager.com/gtag/js?id=G-EPJJCKW3S3",document.head.insertAdjacentElement("beforeend",p);const d=document.createElement("script");d.type="text/javascript",d.onload=i,d.onerror=o,d.src="https://cdn.intergient.com/1025291/75001/ramp.js",document.head.insertAdjacentElement("beforeend",d),await s,console.log("GTM loaded."),await a,console.log("RAMP loaded."),await c,console.log("Ceriad provider launched."),e=!0,r()}catch(e){console.warn("Ceriad provider could not be loaded.",e),document.body.classList.add("ceriad_unavailable"),document.body.classList.add("ceriad_disabled"),d()}}}}})(),Rs=(()=>{let e=null,t=null,n=null,s=!1,i={},o=[],a=Date.now(),r=0,l=!1,c={floor:0,altitude:0,gamesplayed:0};kn.ready((()=>{xt("watchreplay_results").addEventListener("click",(function(){let t;xt("results").classList.contains("isreplay")||(t=na.GetCurrentBgm()),$o(e,t)})),xt("downloadreplay_results").addEventListener("click",(function(){const t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=document.createElement("a");n.download=`${e.id||"replay"}.ttr`,n.href=(window.webkitURL||window.URL).createObjectURL(t),n.dataset.downloadurl=["application/json",n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})),xt("downloadreplay_multilog").addEventListener("click",(function(){const t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=document.createElement("a");n.download=`${e.id||"replay"}.ttrm`,n.href=(window.webkitURL||window.URL).createObjectURL(t),n.dataset.downloadurl=["application/json",n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})),xt("tweetreplay_results").addEventListener("click",(function(){let t="",n="",s="",i="";switch(e.gamemode){case"40l":{const t=Bt(e.replay.results.stats.finaltime);s="a ",n=`time of ${t.m}:${t.s}.${t.ms}`;break}case"blitz":s="a ",n=`score of ${e.replay.results.score.toLocaleString("en-US")}`;break;case"zenith":case"zenithex":{s="an ",n=`altitude of ${Math.floor(e.replay.results.stats.zenith.altitude).toLocaleString("en-US")}.${Math.floor(e.replay.results.stats.zenith.altitude%1*10)}m`;const t=(e.replay.options.zenith_mods??[]).filter((e=>"expert"!==e));t.length&&(i=` (${t.map((e=>L.Strings.zenithModsShort[e]??"?")).join(",")})`);break}}t=xt("results").classList.contains("isreplay")?`Check out ${e.users[0].id===mn.id()?"my":`${e.users[0].username.toUpperCase()}'s`} `:`I just achieved ${s}`,t+=`${n} playing TETR.IO ${L.Strings.longTypeNames[e.gamemode]}${i}!\n\nhttps://${_.domain}/#R:${e.id}`,window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(t)}`,"_blank","menubar=0,toolbar=0,location=0,personalbar=0,status=0,noopener=1,width=640,height=480")})),xt("resubmitreplay_results").addEventListener("click",(function(){t&&(Di("resubmitting"),h(...t).then((()=>{Kt("game submitted!"),xt("results").classList.remove("error"),Oi()}),(e=>{xt("dirtyflag_state").innerHTML="SUBMISSION",en(e),Oi()})))})),xt("custom_export").addEventListener("click",(function(){const e=new Blob([JSON.stringify(F())],{type:"application/json"}),t=document.createElement("a");t.download="custom-game.ttp",t.href=(window.webkitURL||window.URL).createObjectURL(e),t.dataset.downloadurl=["application/json",t.download,t.href].join(":"),document.body.appendChild(t),t.click(),document.body.removeChild(t)})),Sa.on("game.records.revolved",(e=>{i[e]=null,z()}))}));let p=`SESS-${Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}`,d=0;function h(e,t,n){const s=gn.post("/api/games/submit",{type:e,replay:t,assumptions:n,aborted:d,i:kn.i(),serverCycle:_.serverCycle,commitId:_.commit.id},{headers:{"X-Session-ID":p}});return d=0,s}function u(){d=Math.min(10,d+1)}function m(){if(l)return ko.remove("roomzen"),document.body.classList.remove("inmultizen"),l=!1,Si(!0),void Li("lobby");"zen"!==n&&"custom"!==n&&u(),o.push(setTimeout((()=>{Si(!0),Li("home")}),600))}function g(e){n="40l",Si(!1),Li("none"),na.FadeOutBgm(),s||mn.anon()||document.body.classList.contains("banstatus_restrict")?xt("noreplay").classList.remove("hidden"):xt("noreplay").classList.add("hidden"),document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")||Mr("online","40l"),pi=new B("keyboard"),pi.setGame({version:A,seed_random:!0,anchorseed:!0,g:.02,allow180:!0,countdown:!0,countdown_interval:1e3,precountdown:5e3,prestart:1e3,mission:L.Strings.gameMissions["40l"],zoominto:"slow",slot_counter1:it.gameoptions.slot_40l_counter1||"stopwatch",slot_counter2:it.gameoptions.slot_40l_counter2||"lines",slot_counter3:it.gameoptions.slot_40l_counter3||"pieces",slot_counter4:it.gameoptions.slot_40l_counter4||(it.gameoptions.pro_40l?"keys":""),slot_counter5:it.gameoptions.slot_40l_counter5||(it.gameoptions.pro_40l?"finesse":""),slot_bar2:"progress",pro:!!it.gameoptions.pro_40l,pro_alert:!!it.gameoptions.pro_40l_alert,pro_retry:!!it.gameoptions.pro_40l_retry,stride:!!it.gameoptions.stride_40l,no_szo:!!it.gameoptions.stride_40l,objective_type:"lines",objective_count:40,can_retry:!0,nolockout:!0,bgmnoreset:!1!==it.volume.noreset,song:e.song}),pi.on("finish",(function(e){x("40l",this.replay.Export(),e)})),pi.on("fail",(function(){u(),o.push(setTimeout((()=>{na.PlaySe("failure"),Mi((t=>{"retry"===t?g({song:e.song}):(Si(!0),Li("home"))}))}),it.gameoptions.stride_40l?500:3e3))})),pi.on("quit",m),pi.createGameHolder(),pi.startGame()}function f(e){n="blitz",Si(!1),Li("none"),na.FadeOutBgm(),s||mn.anon()||document.body.classList.contains("banstatus_restrict")?xt("noreplay").classList.remove("hidden"):xt("noreplay").classList.add("hidden"),document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")||Mr("online","blitz"),pi=new B("keyboard"),pi.setGame({version:A,seed_random:!0,anchorseed:!0,allow180:!0,countdown:!0,countdown_interval:1e3,precountdown:5e3,prestart:1e3,mission:L.Strings.gameMissions.blitz,zoominto:"slow",slot_counter1:it.gameoptions.slot_blitz_counter1||"timer",slot_counter2:it.gameoptions.slot_blitz_counter2||"lines",slot_counter3:it.gameoptions.slot_blitz_counter3||"level",slot_counter4:it.gameoptions.slot_blitz_counter4||(it.gameoptions.pro_blitz?"finesse_l":""),slot_counter5:it.gameoptions.slot_blitz_counter5||"score",slot_bar2:"progress",pro:!!it.gameoptions.pro_blitz,pro_alert:!!it.gameoptions.pro_blitz_alert,pro_retry:!!it.gameoptions.pro_blitz_retry,stride:!!it.gameoptions.stride_blitz,no_szo:!!it.gameoptions.stride_blitz,objective_type:"timed",objective_time:12e4,can_retry:!0,nolockout:!0,bgmnoreset:!1,song:e.song,levels:!0,levelspeed:.42,levelgbase:.65,gravitymay20g:!1}),pi.on("finish",(function(){x("blitz",this.replay.Export(),12e4)})),pi.on("fail",(function(){u(),o.push(setTimeout((()=>{na.PlaySe("failure"),Mi((t=>{"retry"===t?f({song:e.song}):(Si(!0),Li("home"))}))}),it.gameoptions.stride_blitz?500:3e3))})),pi.on("quit",m),pi.createGameHolder(),pi.startGame()}let b={map:`${"_".repeat(400)}?`,level:1,progress:0,score:0};if(localStorage.getItem("zenProgression")){const e=JSON.parse(localStorage.getItem("zenProgression"));e.level+e.progress>=b.level+b.progress&&(b=e)}function C(e){n="custom",Si(!1),Li("none"),na.FadeOutBgm(),document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")||Mr("online","custom"),pi=new B("keyboard");const t=F();t.version=A,t.mission_type="mission_free",t.bgmnoreset=!1!==it.volume.noreset,t.song=e.song,pi.on("finish",(function(){o.push(setTimeout((()=>{y({version:S._VERSION_FORMAT,gamemode:"custom",users:[{id:mn.id(),username:mn.username()}],replay:this.replay.Export()},{isClientSide:!0})}),2e3))})),pi.on("fail",(function(){o.push(setTimeout((()=>{na.PlaySe("failure"),Mi((t=>{"retry"===t?C({song:e.song}):(Si(!0),Li("home"))}))}),3e3))})),pi.on("quit",m),pi.setGame(t),pi.createGameHolder(),pi.startGame()}function x(e,n,i){if(mn.anon()||s)return void o.push(setTimeout((()=>{y({version:S._VERSION_FORMAT,gamemode:e,users:[{id:mn.id(),username:mn.username()}],replay:n},{isClientSide:!0})}),it.gameoptions[`stride_${e}`]?500:2e3));const a=performance.now();t=[e,n,{seed:n.options.seed,finalTime:i}],h(...t).then((t=>{const n=performance.now()-a;Kt("game submitted!"),o.push(setTimeout((()=>{y(t.record.replay,{isClientSide:!0,record:t.record,ranks:t.ranks}),wn(t.xp??0)}),Math.max(0,(it.gameoptions[`stride_${e}`]?500:2e3)-n)))}),(t=>{xt("dirtyflag_state").innerHTML="SUBMISSION";const s=performance.now()-a;en(t),o.push(setTimeout((()=>{y({version:S._VERSION_FORMAT,gamemode:e,users:[{id:mn.id(),username:mn.username()}],replay:n},{isClientSide:!0,error:t.error.msg})}),Math.max(0,(it.gameoptions[`stride_${e}`]?500:2e3)-s)))}))}function y(t,n){if(t=S.Update(t),(t=new S(t)).users.length>=2)return function(t,{back:n="home",record:s=null,menuStyle:i=null,matchHighlight:o=null}){const a=t.replay.leaderboard,r=t.replay.rounds;a[1].id===mn.id()&&a.reverse();const l=a[0],c=a[1];_i.multilog.footer=`<a class="tetra_pop" data-hover="tap" data-hit="click" data-username="${St(l.username)}">${St(l.username.toUpperCase().toUpperCase())}</a> versus <a class="tetra_pop" data-hover="tap" data-hit="click" data-username="${St(c.username)}">${St(c.username.toUpperCase().toUpperCase())}</a> played on ${new Date(t.ts||Date.now()).toLocaleString()}`,_i.multilog.back=n??"home",Si(!0),Li("multilog"),wi(i??(t.id?"tetra":"victory")),t.id?(xt("multilogview").classList.remove("noreplay"),xt("replayid_multilog").textContent=`R:${t.id}`):xt("multilogview").classList.add("noreplay");e=t,xt("multilog").innerHTML="";let p=0;for(const e of r){const t=p++;e[1].id===l.id&&e.reverse();const n=document.createElement("div");n.classList.add("multilog_result"),n.classList.add("scroller_block"),n.classList.add("zero"),n.setAttribute("data-hover","tap"),n.setAttribute("data-hit","click"),n.__replays__=[e[0].replay?new k(e[0].replay):null,e[1].replay?new k(e[1].replay):null],n.__users__=[l,c],n.__roundid__=t+1,n.__datalength__=r.length,xt("multilog").appendChild(n);const s=!e[0].replay||e[0].frames<=5,i=!e[1].replay||e[1].frames<=5,a=document.createElement("div");a.classList.add("multilog_result_self"),e[0].alive&&e[0].active&&a.classList.add("success"),s&&n.classList.add("multilog_result_unavailable"),a.innerHTML=`${e[0].active?"":"forfeit - "}<span>${e[0].stats.apm.toFixed(2)}</span> APM - <span>${e[0].stats.pps.toFixed(2)}</span> PPS - <span>${e[0].stats.vsscore.toFixed(2)}</span> VS`,n.appendChild(a);const d=Bt(Math.min(e[0].lifetime,e[1].lifetime)||0),h=document.createElement("div");h.classList.add("multilog_result_time"),h.classList.toggle("focusedround",o==t+1),h.innerHTML=s||i?"-:--":`${d.m}:${d.s}`,n.appendChild(h);const u=document.createElement("div");u.classList.add("multilog_result_opponent"),e[1].alive&&e[1].active&&u.classList.add("success"),i&&n.classList.add("multilog_result_unavailable"),u.innerHTML=`<span>${e[1].stats.apm.toFixed(2)}</span> APM - <span>${e[1].stats.pps.toFixed(2)}</span> PPS - <span>${e[1].stats.vsscore.toFixed(2)}</span> VS${e[1].active?"":" - forfeit"}`,n.appendChild(u)}yt("#multilog .multilog_result").forEach((e=>{let t,n;e.__roundid__>0&&e.previousElementSibling&&!e.previousElementSibling.classList.contains("multilog_result_unavailable")&&(t=()=>{e.previousElementSibling.click()}),e.__roundid__<r.length&&e.nextElementSibling&&!e.nextElementSibling.classList.contains("multilog_result_unavailable")&&(n=()=>{e.nextElementSibling.click()}),e.addEventListener("click",(()=>{No(e.__replays__,e.__users__,na.GetCurrentBgm(),t,n,e.__roundid__,e.__datalength__)}))})),At("#multilog_self").setAttribute("data-username",l.username),At("#multilog_self .leagueplayer_name").textContent=l.username.toUpperCase(),At("#multilog_self .leagueplayer_count").textContent=l.wins,At("#multilog_self .leagueplayer_extra").innerHTML=Number.isNaN(l.stats.apm)?"NO STATS AVAILABLE":`<span>${l.stats.apm.toFixed(2)}</span> APM &bull; <span>${l.stats.pps.toFixed(2)}</span> PPS &bull; <span>${l.stats.vsscore.toFixed(2)}</span> VS`,At("#multilog_self").classList.toggle("disconnected",!l.active),At("#multilog_opponent").setAttribute("data-username",c.username),At("#multilog_opponent .leagueplayer_name").textContent=c.username.toUpperCase(),At("#multilog_opponent .leagueplayer_count").textContent=c.wins,At("#multilog_opponent .leagueplayer_extra").innerHTML=Number.isNaN(c.stats.apm)?"NO STATS AVAILABLE":`<span>${c.stats.apm.toFixed(2)}</span> APM &bull; <span>${c.stats.pps.toFixed(2)}</span> PPS &bull; <span>${c.stats.vsscore.toFixed(2)}</span> VS`,At("#multilog_opponent").classList.toggle("disconnected",!c.active),0===p&&xt("multilog").insertAdjacentHTML("beforeend",'<div class="multilog_empty">no replays available for this match</div>')}(t,n);if(function(t,{back:n="home",isClientSide:o=!1,error:a=null,record:r=null,ranks:l=null,customresulttype:c=null}){const p=t.gamemode,d=t.replay.options,h=t.users[0],u=t.replay.results.stats,_=t.replay.results.aggregatestats,m=u.clears,g=Bt(u.finaltime),f=u.finaltime/6e4,b=u.finaltime/1e3,C=xt("results_stats_full"),x=xt("results_stats_overview");switch(C.innerHTML="",x.innerHTML="",p){case"40l":case"blitz":case"custom":if(d.levels&&w(x,"LEVEL",u.level),w(x,"PIECES PLACED",u.piecesplaced.toLocaleString("en-US")),w(x,"PIECES per SECOND",(u.piecesplaced/b).toFixed(2)),u.inputs&&(w(x,"KEYS PRESSED",u.inputs),w(x,"KEYS per PIECE",(u.inputs/u.piecesplaced).toFixed(3)),w(x,"KEYS per SECOND",(u.inputs/b).toFixed(3))),w(x,"HOLDS",u.holds.toLocaleString("en-US")),w(x,"SCORE",u.score.toLocaleString("en-US")),"time"!==d.objective_type&&w(x,"TIME",`${g.m}:${g.s}.${g.ms}`),w(x,"LINES",u.lines.toLocaleString("en-US")),w(x,"LINES per MINUTE",(u.lines/f).toFixed(2)),"none"!==d.spinbonuses){w(x,`${"T-spins"===d.spinbonuses?"T-s":"s"}pins`,u.tspins)}w(x,"maximum COMBO",Math.max(0,u.topcombo-1)),w(x,"maximum back-to-back chain",Math.max(0,u.topbtb-1)),w(x,"ALL CLEARS",m.allclear.toLocaleString("en-US")),u.finesse&&(w(x,"finesse %",`${(u.finesse.perfectpieces/Math.max(1,u.piecesplaced)*100).toFixed(2)}%`),w(x,"finesse faults",u.finesse.faults.toLocaleString("en-US")));break;case"zenith":case"zenithex":{const e=["","hall of beginnings","the hotel","the casino","the arena","the museum","abandoned offices","the laboratory","the core","corruption","platform of the gods"];w(x,"TIME",`${g.m}:${g.s}.${g.ms}`),w(x,"FLOOR",`${u.zenith.floor}: ${e[u.zenith.floor]??""}`),w(x,"KO's",u.kills.toLocaleString("en-US")),w(x,"average CLIMB SPEED",(u.zenith.avgrankpts/(60*b)).toFixed(2)),w(x,"peak CLIMB SPEED",Math.floor(u.zenith.peakrank).toLocaleString("en-US")),w(x,"ALTITUDE per SECOND",(u.zenith.altitude/b).toFixed(2)),w(x,"ATTACK per MINUTE",_.apm.toFixed(2)),w(x,"PIECES per SECOND",_.pps.toFixed(2)),w(x,"VERSUS SCORE",_.vsscore.toFixed(2)),w(x,"maximum COMBO",Math.max(0,u.topcombo-1)),w(x,"maximum back-to-back chain",Math.max(0,u.topbtb-1));break}}switch(p){case"40l":case"blitz":case"custom":if(w(C,"SINGLES",m.singles.toLocaleString("en-US")),w(C,"DOUBLES",m.doubles.toLocaleString("en-US")),w(C,"TRIPLES",m.triples.toLocaleString("en-US")),w(C,"QUADS",m.quads.toLocaleString("en-US")),"none"!==d.spinbonuses){const e="T-spins"===d.spinbonuses?"T-s":"s";w(C,`${e}pins`,m.realtspins.toLocaleString("en-US")),w(C,`${e}pin MINIS`,m.minitspins.toLocaleString("en-US")),w(C,`${e}pin MINI SINGLES`,m.minitspinsingles.toLocaleString("en-US")),w(C,`${e}pin SINGLES`,m.tspinsingles.toLocaleString("en-US")),w(C,`${e}pin MINI DOUBLES`,m.minitspindoubles.toLocaleString("en-US")),w(C,`${e}pin DOUBLES`,m.tspindoubles.toLocaleString("en-US")),"T-spins"!==d.spinbonuses&&w(C,`${e}pin MINI TRIPLES`,m.minitspintriples.toLocaleString("en-US")),w(C,`${e}pin TRIPLES`,m.tspintriples.toLocaleString("en-US")),"T-spins"!==d.spinbonuses&&(w(C,`${e}pin MINI QUADS`,m.minitspinquads.toLocaleString("en-US")),w(C,"spin QUADS",m.tspinquads))}w(C,"ALL CLEARS",m.allclear.toLocaleString("en-US"));break;case"zenith":case"zenithex":w(C,"LINES SENT",u.garbage.sent.toLocaleString("en-US")),w(C,"LINES RECEIVED",u.garbage.received.toLocaleString("en-US")),w(C,"PIECES PLACED",u.piecesplaced.toLocaleString("en-US")),w(C,"KEYS PRESSED",u.inputs),w(C,"KEYS per PIECE",(u.inputs/u.piecesplaced).toFixed(3)),w(C,"KEYS per SECOND",(u.inputs/b).toFixed(3)),w(C,"HOLDS",u.holds.toLocaleString("en-US")),w(C,"LINES",u.lines.toLocaleString("en-US")),w(C,"LINES per MINUTE",(u.lines/f).toFixed(2)),w(C,"SINGLES",u.clears.singles.toLocaleString("en-US")),w(C,"DOUBLES",u.clears.doubles.toLocaleString("en-US")),w(C,"TRIPLES",u.clears.triples.toLocaleString("en-US")),w(C,"QUADS",u.clears.quads.toLocaleString("en-US")),w(C,"T-spins",u.tspins),w(C,"T-spin ZEROES",u.clears.realtspins.toLocaleString("en-US")),w(C,"T-spin MINIS",u.clears.minitspins.toLocaleString("en-US")),w(C,"T-spin MINI SINGLES",u.clears.minitspinsingles.toLocaleString("en-US")),w(C,"T-spin SINGLES",u.clears.tspinsingles.toLocaleString("en-US")),w(C,"T-spin MINI DOUBLES",u.clears.minitspindoubles.toLocaleString("en-US")),w(C,"T-spin DOUBLES",u.clears.tspindoubles.toLocaleString("en-US")),w(C,"T-spin MINI TRIPLES",u.clears.minitspintriples.toLocaleString("en-US")),w(C,"T-spin TRIPLES",u.clears.tspintriples.toLocaleString("en-US")),w(C,"T-spin MINI QUADS",u.clears.minitspinquads.toLocaleString("en-US")),w(C,"T-spin QUADS",u.clears.tspinquads.toLocaleString("en-US")),w(C,"ALL CLEARS",u.clears.allclear.toLocaleString("en-US")),w(C,"finesse %",`${(u.finesse.perfectpieces/Math.max(1,u.piecesplaced)*100).toFixed(2)}%`),w(C,"finesse faults",u.finesse.faults.toLocaleString("en-US"))}switch(p){case"40l":xt("results").classList.remove("nomusicpicker"),xt("result_header").innerHTML="FINAL TIME",xt("result_result").innerHTML=`${g.m}:${g.s}<span class="ms">.${g.ms}</span>`;break;case"blitz":xt("results").classList.add("nomusicpicker"),xt("result_header").innerHTML="FINAL SCORE",xt("result_result").textContent=u.score.toLocaleString("en-US");break;case"custom":switch(xt("results").classList.remove("nomusicpicker"),d.objective_result){case"score":xt("result_header").innerHTML="FINAL SCORE",xt("result_result").textContent=u.score.toLocaleString("en-US");break;case"time":xt("result_header").innerHTML="FINAL TIME",xt("result_result").innerHTML=`${g.m}:${g.s}<span class="ms">.${g.ms}</span>`;break;case"lines":xt("result_header").innerHTML="FINAL LINE COUNT",xt("result_result").textContent=u.lines}break;case"zenith":case"zenithex":xt("result_header").innerHTML="FINAL ALTITUDE",xt("result_result").innerHTML=`${Math.floor(u.zenith.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(u.zenith.altitude%1*10)}</span><span class="unit">M</span><span class="mods">${d.zenith_mods.map((e=>`<img src="/res/zenith-mods/pbicons-tetra/${St(e)}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`)).join("")}</span>`}const A=new Date(t.ts)?.toLocaleString(),y=L.Strings.longTypeNames[p],v=St(h.username??"Unknown Player");_i.results.footer=`${y} played by <a class="tetra_pop" data-hover="tap" data-hit="click" data-username="${v}">${v.toUpperCase()}</a> on ${A}`,_i.results.back=n,Si(!0),Li("results"),xt("results").classList.toggle("fakereplay",!t.id),xt("results").classList.toggle("isreplay",!o),xt("results").classList.toggle("noreplay",!t),wi(o?p:t.id?"tetra":"custom");t.id&&(xt("replayid_results").textContent=`R:${t.id}`);e=t,xt("handling_item_arr").textContent=d.handling.arr,xt("handling_item_das").textContent=d.handling.das,xt("handling_item_sdf").textContent=d.handling.sdf>=41?"":d.handling.sdf,xt("results").classList.toggle("disputed",!!r?.disputed),a&&(a.includes("hacked")||a.includes("suspicious")||a.includes("already submitted"))&&(a.includes("hacked")&&(s=!0),a=null);a?(xt("results").classList.add("error"),xt("submissionerror_results").textContent=a):xt("results").classList.remove("error");if(xt("results").classList.toggle("hasranks",!!l),l){if(l.user<=10){if(xt("personalrank_results").classList.toggle("textual",1===l.user),xt("personalrank_results_data").innerHTML=1===l.user?"PERSONAL BEST":l.user,xt("personalrank_results").classList.remove("hidden"),i[p]){let e=null;switch(p){case"40l":{const t=Bt(Math.abs(i[p].results.stats.finaltime-u.finaltime));e=`${t.m}:${t.s}.${t.ms}`;break}case"blitz":e=`${Math.abs(i[p].results.stats.score-u.score).toLocaleString("en-US")} points`}xt("personalrank_results_sub").innerHTML=`${e||""}${e?` ${1===l.user?"improvement":"behind"} &bull; `:""}last PB was ${wt(Date.parse(i[p].ts)).toUpperCase()} ago`}else xt("personalrank_results_sub").innerHTML="this is your first game, play more to track your improvement";xt("personalrank_results").classList.toggle("best",1===l.user)}else xt("personalrank_results").classList.add("hidden");l.local>0?(xt("countryrank_results").classList.toggle("textual",1===l.local),xt("countryrank_results_data").innerHTML=1===l.local?"COUNTRY RECORD":l.local,xt("countryrank_results_sub").innerHTML=1===l.local?"":`TOP ${Math.min(100,(l.local-1)/Math.max(1,l.localcount)*100).toFixed(2)}%`,xt("countryrank_results").classList.remove("hidden"),xt("countryrank_results").classList.toggle("best",1===l.local)):xt("countryrank_results").classList.add("hidden"),l.global>0?(xt("globalrank_results").classList.toggle("textual",1===l.global),xt("globalrank_results_data").innerHTML=1===l.global?"WORLD RECORD":l.global,xt("globalrank_results_sub").innerHTML=1===l.global?"":`TOP ${Math.min(100,(l.global-1)/Math.max(1,l.globalcount)*100).toFixed(2)}%`,xt("globalrank_results").classList.remove("hidden"),xt("globalrank_results").classList.toggle("best",1===l.global)):xt("global_results").classList.add("hidden"),1===l.user&&(i[p]=r,z()),1===l.global?(na.PlaySe("worldrecord"),vi("globalbest","WORLD RECORD!")):1===l.local?(na.PlaySe("personalbest"),vi("personalbest","COUNTRY BEST!")):1===l.user&&(na.PlaySe("personalbest"),vi("personalbest","PERSONAL BEST!"))}}(t,n),n.isClientSide)switch(na.PlaySe("showscore"),t.gamemode){case"40l":na.PlayBgmSmoothlyWithRandom("success-story");break;case"blitz":na.PlayBgmSmoothlyWithRandom("philosophy");break;case"custom":na.PlayBgmSmoothlyWithRandom("kaiser-hige-na-neko")}}function w(e,t,n){const s=document.createElement("tr");e.appendChild(s);const i=document.createElement("td");i.textContent=t,s.appendChild(i);const o=document.createElement("td");o.innerHTML=n,s.appendChild(o)}function F(){const e={};return yt("#custom_content_container .room_config_item[data-index]").forEach((t=>{const n=t.getAttribute("data-index");let s;switch(t.getAttribute("type")){case"number":s=parseFloat(t.value);break;case"checkbox":s=!!t.checked;break;case"range":s=Rn[t.value];break;default:s=t.value}t.classList.contains("room_config_spinner")&&(s=t.innerHTML),"slot_bar2"===n&&(s="progress"),e[n]=s})),e}function z(){if(i["40l"]){const e=Bt(i["40l"].results.stats.finaltime);xt("pbdisplay_40l_inner").innerHTML=`${e.m}:${e.s}<span>.${e.ms}</span>`,xt("pbdisplay_40l_inner").classList.remove("hidden"),xt("pbdisplay_40l").classList.remove("hidden")}else xt("pbdisplay_40l").classList.add("hidden"),xt("pbdisplay_40l_inner").classList.add("hidden");i.blitz?(xt("pbdisplay_blitz_inner").innerHTML=i.blitz.results.stats.score.toLocaleString("en-US"),xt("pbdisplay_blitz_inner").classList.remove("hidden"),xt("pbdisplay_blitz").classList.remove("hidden")):(xt("pbdisplay_blitz").classList.add("hidden"),xt("pbdisplay_blitz_inner").classList.add("hidden")),i.zenith?(xt("pbdisplay_zenith_inner").innerHTML=`${Math.floor(i.zenith.results.stats.zenith.altitude).toLocaleString("en-US")}<span>.${Math.floor(i.zenith.results.stats.zenith.altitude%1*10)} M</span>${i.zenith.extras.zenith.mods.map((e=>`<img src="/res/zenith-mods/pbicons/${St(e)}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`)).join("")}`,xt("pbdisplay_zenith_inner").classList.remove("hidden"),xt("pbdisplay_zenith").classList.remove("hidden")):(xt("pbdisplay_zenith").classList.add("hidden"),xt("pbdisplay_zenith_inner").classList.add("hidden")),i.zenithex?(xt("pbdisplay_zenithex_inner").innerHTML=`${Math.floor(i.zenithex.results.stats.zenith.altitude).toLocaleString("en-US")}<span>.${Math.floor(i.zenithex.results.stats.zenith.altitude%1*10)} M</span>${i.zenithex.extras.zenith.mods.map((e=>"expert"===e?"":`<img src="/res/zenith-mods/pbicons/${St(e)}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`)).join("")}`,xt("pbdisplay_zenithex_inner").classList.remove("hidden"),xt("pbdisplay_zenithex").classList.remove("hidden")):(xt("pbdisplay_zenithex").classList.add("hidden"),xt("pbdisplay_zenithex_inner").classList.add("hidden"))}return{playReplayByID:function(e,t){Di("fetching replay"),gn.get(`/api/games/${encodeURIComponent(e)}`).then((e=>{Oi(),$o(new S(e.game),t)}),(e=>{Oi(),en(e)}))},playAgain:function(e){switch(n){case"40l":g(e);break;case"blitz":e.song="hyper-velocity",f(e);break;case"custom":C(e)}},play40L:g,playBlitz:f,playZen:function(e){l=e.inroom,n="zen",a=Date.now(),el.destroyAll(),Si(!1),Li("none"),na.FadeOutBgm(),l||document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")||Mr("online","zen"),l&&(ko.set("roomzen",{header:e.roomname,sub:"ZEN WHILE WAITING",buttons:["exitRoomZen"]}),document.body.classList.add("inmultizen")),pi=new B("keyboard"),pi.loadZenConfig(),pi.setGame({version:A,seed_random:!0,allow180:!0,countdown:!0,countdown_interval:1e3,precountdown:e.inroom?0:3e3,prestart:e.inroom?500:1e3,stride:!0,zoominto:e.inroom?"fast":"slow",display_zen:!0,slot_bar2:"progress",mission:e.inroom?"":L.Strings.gameMissions.zen,mission_type:"mission_free",objective_type:"none",song:"RANDOMcalm",bgmnoreset:!0,nosiren:!0,infinite_stock:!0,zenlevels:!0,zenlevel:b.level,zenprogress:b.progress,score:b.score,map:b.map,forfeit_time:e.inroom?1:30,can_retry:!0,can_undo:!0,nolockout:!0,retryisclear:!0,usezenconfig:!0,noreplay:!0,garbagemultiplier:1,pro:!0,b2bcharging:!0,b2bcharge_at:4,b2bcharge_base:3,allclear_garbage:5,allclear_b2b:1,allclear_b2b_sends:!0,allclear_b2b_dupes:!1,allclear_charges:!1,b2bextras:!1}),pi.on("stop",m),pi.createGameHolder(),pi.startGame()},playCustom:C,testControls:function(){Si(!1),pi=new B("keyboard"),pi.setGame({version:A,seed_random:!0,g:.02,allow180:!0,countdown:!1,precountdown:0,prestart:250,zoominto:"fast",objective_type:"none",can_retry:!0,nolockout:!0,retryisclear:!0,stride:!0,infinite_stock:!0,forfeit_time:1,display_username:!0,username:`arr ${it.handling.arr}F,das ${it.handling.das}F,sdf ${41==it.handling.sdf?"":`${it.handling.sdf}X`}`,neverstopbgm:!0}),pi.on("quit",(function(){o.push(setTimeout((()=>{Si(!0)}),200))})),pi.createGameHolder(),pi.startGame()},loadReplay:y,setGameOpts:function(e){yt("#custom_content_container .room_config_item[data-index]").forEach((t=>{const n=t.getAttribute("data-index"),s=vt(e,n);switch(t.getAttribute("type")){case"number":case"text":default:t.value=s;break;case"checkbox":t.checked=!!s;break;case"range":t.value=Rn.indexOf(s)}t.classList.contains("room_config_spinner")&&(t.textContent=s)}))},reportAbortedGame:u,anchorSeed:function(e){p=`SESS-${Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}`,gn.post("/api/games/anchor",{seed:e},{headers:{"X-Session-ID":p}})},loadZen:function(e){if(e)if(localStorage.getItem("zenProgression")){const t=JSON.parse(localStorage.getItem("zenProgression"));t.level+t.progress<e.level+e.progress&&(b=e)}else b=e},saveZen:function(e,t=0){b=e,localStorage.setItem("zenProgression",JSON.stringify(e)),mn.anon()||(gn.post("/api/games/zen",{...e,timeplayed:Math.floor((Date.now()-a)/1e3)}).then((e=>{e.xp&&(r+=e.xp,t&&o.push(setTimeout((()=>{wn(r??0),r=0}),t)))})),a=Date.now())},getZen:()=>b,resetZen:()=>{b={map:`${"_".repeat(400)}?`,level:1,progress:0,score:0},localStorage.removeItem("zenProgression")},stopNow:()=>{pi&&pi.endNow(),v?.forEach((e=>e.endNow())),xt("replay").classList.add("hidden"),xt("replaytools").classList.add("disabled"),xt("replaytools").classList.add("hidden"),o.forEach((e=>{clearTimeout(e)})),o=[]},leagueOnly:()=>{pi&&pi.endNow(),v?.forEach((e=>"mission_league"===e.getState().setoptions.mission_type&&!e.source.IsReplay()||e.endNow())),xt("replay").classList.add("hidden"),xt("replaytools").classList.add("disabled"),xt("replaytools").classList.add("hidden"),o.forEach((e=>{clearTimeout(e)})),o=[]},setRecords:e=>{i=Object.fromEntries(Object.entries(e).map((e=>[e[0],e[1].record]))),z()},updatePBDisplays:z,getRecords:()=>i,setUnsafeTimeout:(...e)=>{o.push(setTimeout(...e))},addStatsLine:w,getZenithStats:()=>c,setZenithStats:(e,t)=>{if(!t){const t=[];c.floor<2&&e.floor>=2&&t.push("nohold"),c.floor<3&&e.floor>=3&&t.push("messy"),c.floor<4&&e.floor>=4&&t.push("gravity"),c.floor<5&&e.floor>=5&&t.push("volatile"),c.floor<6&&e.floor>=6&&t.push("doublehole"),c.floor<7&&e.floor>=7&&t.push("invisible"),c.floor<8&&e.floor>=8&&t.push("allspin"),c.floor<9&&e.floor>=9&&t.push("expert"),t.length&&(na.PlaySe("allclear"),Kt({msg:`you've unlocked the ${t.map((e=>`"${L.Strings.zenithMods[e].toUpperCase()}"`)).join(", ")} mod${1===t.length?"":"s"}!`,color:"#FFAE00",icon:"achievement"}),xt("zenith_deck_nag").classList.toggle("hidden",!mn.anon()))}c=e;for(const t of yt(".zenith_card"))t.classList.toggle("floorlocked",e.floor<t.dataset.floor)}}})(),Ws=(()=>{const e=`SESS-${Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}`;let t=null;const n=window.location.hash.substring(1);history.replaceState(null,null," ");let s=!1,i=[],o=!1;function r(n){return new Promise(((s,a)=>{var r,l;(r=e,l=t,new Promise(((e,t)=>{_n.getWhenReady((async n=>{gn.get("/api/users/me",void 0,{headers:{"X-Session-ID":r,"X-Connection-ID":await mn.esc(l,n)}}).then((t=>{e(t.user)}),(e=>{if(e.error&&"A-LINED"===e.error.msg)return window.location=e.error.redirect,void Is();kn.unready(),t()}))}))}))).then((e=>{if(n&&(n.classList.remove("busy"),c(n),xt("captcha_form").classList.remove("busy"),c(xt("captcha_form")),xt("totp_form").classList.remove("busy"),c(xt("totp_form")),xt("entry_form").classList.remove("busy"),c(xt("entry_form"))),kn.ready((()=>{xt("desktop_transition").className.includes("hid")||(xt("desktop_transition").classList.add("hiding-direct"),xt("home_menu").classList.add("play-entry-anim"),setTimeout((()=>{xt("desktop_transition").classList.add("hidden"),xt("home_menu").classList.remove("play-entry-anim")}),3e3))})),e.username!==mn.username()&&(Kt({msg:`your username was changed from ${mn.username().toUpperCase()} to ${e.username.toUpperCase()}.`,color:"#FFD800",icon:"swaphost",timeout:3e4}),mn.changeUsername(e.username)),xt("me_username").innerHTML=e.username,xt("me_username").classList.toggle("lu",e.username.length>13),xt("tetra_me_username").innerHTML=e.username,xt("zenith_party_self_username").innerHTML=e.username.toUpperCase(),xt("zenith_party_self_username").classList.toggle("ln",e.username.length>12),xt("zenith_party_self").setAttribute("data-username",e.username),xn(fn(e.xp),xt("me_level")),xn(fn(e.xp),xt("zenith_party_self_level")),wn(e.xp,!0),Rs.loadZen(e.zen),Rs.setRecords(e.records||{}),Rs.setZenithStats(e.zenith||{},!0),"anon"===e.role?(document.body.classList.add("anon"),localStorage.setItem("moonKagariUsername","X-ANON")):(document.body.classList.remove("anon"),!e.email&&e.xp>11756&&Ji(),localStorage.setItem("tetrio_lastUsername",e.username),localStorage.setItem("moonKagariUsername",e.username),window.Sentry?.setUser?.({id:e._id,email:e.email,username:e.username})),window.Sentry?.setTag?.("feecof",localStorage.getItem("feecofScore")),document.body.classList.toggle("uses2fa",!!e.totp&&!!e.totp.enabled),document.body.classList.toggle("dmfriendonly","everyone"!==(e.privacy_dm||"everyone")),document.body.classList.toggle("bot","bot"===e.role),document.body.classList.toggle("staff",$n.includes(e.role)),document.body.setAttribute("data-country",e.country),document.body.setAttribute("data-country-hidden",!1===e.privacy_showcounty?"yes":"no"),document.body.setAttribute("data-xp",e.xp),document.body.setAttribute("data-near-rank","z"===(e.league?.rank??"z")?e.league?.bestrank??"z":e.league?.rank),Pt(["setCustomDimension",1,e.role]),"anon"!==e.role&&Pt(["setUserId",e.username]),setTimeout((()=>{Pt(["setCustomDimension",2,window.IS_ELECTRON?`TETR.IO Desktop v${window.CLIENT_VERSION}${it.electron.adblock?" (ads blocked)":""}`:"Browser"+(document.body.classList.contains("ceriad_unavailable")?" (ads blocked)":"")])}),2500),document.body.classList.toggle("supporter",!!e.supporter),document.body.classList.toggle("supporter_at_launch",!!e.supporter),localStorage.setItem("wasLastSupporter",e.supporter||$n.includes(e.role)?"Yes, that's it!":"No, that's wrong!"),_.noceriad||e.supporter||$n.includes(e.role)||window.IS_ELECTRON&&(it.electron.adblock||window.TETRAKARN)||Ps.loadProvider(),i=e.warnings,o=!!e.thanked,"ok"===e.bannedstatus)d(),document.body.classList.remove("trapped"),localStorage.removeItem("trapped");else{document.body.classList.add("trapped"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban.");let t="silence"==e.bannedstatus?"SILENCED users may not chat or create public rooms, but can still submit scores and play online.":"RESTRICTED users may not play online or submit scores.",n=1;e.banlist.forEach((s=>{t+=`</p><p>&nbsp;</p><p class="modal_also">#${n++}: ban id ${s.id}</p><p>your ${s.from} was ${"silence"==s.type?"silenced":"restricted"} at ${new Date(s.ts).toLocaleString()} for the following reason:</p><p class="banreason">${St(s.reason)}${s.context&&s.context.chat&&s.context.chat.length?`<span class="context">${s.context.chat.map((t=>`[${e.username.toUpperCase()}] ${St(t)}`)).join("\n")}</span>`:""}</p><p>this ban ${Date.parse(s.expires)-Date.parse(s.ts)>=54e12?"will not expire":`expires in ${wt(Date.parse(s.expires))}`}.`})),xt("ban_header").innerHTML="YOU HAVE BEEN "+("silence"==e.bannedstatus?"SILENCED":"RESTRICTED"),xt("ban_reasons").outerHTML=`<p id="ban_reasons">${t}</p>`,xt("banned_warning").classList.remove("hidden"),xt("banned_warning_iponly").classList.toggle("hidden",e.banlist.some((e=>"account"===e.from))),document.body.classList.add(`banstatus_${e.bannedstatus}`),xt("desktop_transition").className.includes("hid")||(xt("desktop_transition").classList.add("hiding-preload"),setTimeout((()=>{xt("desktop_transition").classList.add("hidden")}),1e3))}_.league_season.ranked?-1===e.league.tr?(xt("league_rating").innerHTML=`${e.league.gamesplayed}<span>/10 rating games played</span>`,xt("league_rating").title="",xt("leaguestanding_rating").innerHTML=`${e.league.gamesplayed}<span>/10 rating games played</span>`,xt("league_ticker").innerHTML="play rating games to receive a rating",xt("league_rank").classList.add("hidden"),xt("league_warning").classList.add("hidden"),xt("me_leaguerank").classList.add("hidden")):(di=Math.round(e.league.tr),hi=e.league.rank,xt("league_rating").innerHTML=`${Math.round(e.league.tr)}<span>TR</span>`,xt("league_rating").title=e.league.tr,xt("leaguestanding_rating").innerHTML=`${Math.round(e.league.tr)}<span>TR</span>`,xt("league_ticker").innerHTML=`glicko: <span title="Your raw rating in the Glicko-2 system. Higher is better.">${e.league.glicko}</span><span title="How uncertain the Glicko-2 system is of your rating. Lower is better.">${e.league.rd}</span> - games won: <span>${e.league.gameswon}</span> / ${e.league.gamesplayed} (<span>${Math.floor(e.league.gameswon/e.league.gamesplayed*1e4)/100}</span>%)`,xt("league_rank").src=`/res/league-ranks/${e.league.rank}.png`,xt("leaguestanding_rank").src=`/res/league-ranks/${e.league.rank}.png`,xt("league_rank").classList.remove("hidden"),xt("league_warning").classList.toggle("hidden","z"!==e.league.rank),xt("me_leaguerank").classList.toggle("hidden","z"===e.league.rank),xt("me_leaguerank").src=`/res/league-ranks/${e.league.rank}.png`):(xt("league_rating").innerHTML="OFF-SEASON",xt("league_rating").title="",xt("leaguestanding_rating").innerHTML=`${e.league.gameswon}<span> game${1===e.league.gameswon?"":"s"} won</span>`,xt("league_ticker").innerHTML=`${e.league.gameswon} GAME${1===e.league.gameswon?"":"S"} WON`,xt("league_rank").classList.add("hidden"),xt("league_warning").classList.add("hidden"),xt("me_leaguerank").classList.add("hidden")),-1===e.league.standing?xt("league_placement").classList.add("hidden"):(ui=e.league.standing,xt("league_placement").classList.remove("hidden"),xt("league_placement").innerHTML=`#<span>${e.league.standing}</span>`,xt("league_placement").classList.toggle("t100",e.league.standing<=100&&e.league.standing>10),xt("league_placement").classList.toggle("t10",e.league.standing<=10&&e.league.standing>1),xt("league_placement").classList.toggle("t1",1===e.league.standing)),e.avatar_revision?xt("me_avatar").setAttribute("src",`/user-content/avatars/${e._id}.jpg?rv=${e.avatar_revision}`):"anon"!==e.role&&xt("me_avatar").setAttribute("src",Et(e._id)),xt("zenith_party_self_avatar").setAttribute("src",xt("me_avatar").getAttribute("src")),(e.supporter||$n.includes(e.role))&&(document.body.classList.add("ceriad_exempt"),document.body.classList.add("ceriad_disabled"),Ps.unmountAll(),document.cookie=`ceriad_exempt=1;max-age=31536000;domain=${_.domain}`),Ps.unmountGroup("login"),s(e)})).catch((e=>{console.log(e),kn.unready(),xt("desktop_transition").className.includes("hid")||(xt("desktop_transition").classList.add("hiding-preload"),setTimeout((()=>{xt("desktop_transition").classList.add("hidden")}),1e3)),n&&(n.classList.remove("busy"),c(n),xt("captcha_form").classList.remove("busy"),c(xt("captcha_form")),xt("totp_form").classList.remove("busy"),c(xt("totp_form"))),Yt("you were logged out. please log in again!"),xt("entry_username").value=mn.username(),xt("entry_button").click()}))}))}function l(){if(!a.utils.isWebGLSupported())return;"Attempting to bypass a ban will escalate it to a permanent ban."===localStorage.getItem("trapped")&&document.body.classList.add("trapped");const e=function(){if(!n)return;let e=!1;const t=n.substring(0,2);return"P:"!==t&&"D:"!==t?(yt(".quickjoin").forEach((s=>{switch(t){case"R:":case"r:":s.innerHTML="opening replay <span></span>",s.querySelector("span").textContent=n;break;case"S:":s.innerHTML="supporting <span></span>",s.querySelector("span").textContent=n.substring(2),e=!0;break;default:s.innerHTML="joining room <span></span>",s.querySelector("span").textContent=!1!==it.video.hideroomids?`#${n}`:"<hidden>"}s.classList.remove("hidden")})),yt(".electron_jump").forEach((e=>{e.classList.remove("hidden"),e.addEventListener("click",(function(e){c(xt("entry_form")),c(xt("return_form")),p(xt("electron_form")),window.location=`tetrio://${n}`}))})),yt(".electron_jump_also").forEach((e=>{e.classList.remove("hidden")})),e):void 0}();if("P:"!==n.substring(0,2))if("D:"!==n.substring(0,2)){if(window.IS_ELECTRON||_.noceriad?document.body.classList.add("no_login_ceriad"):(Ht("Login Screen"),"Yes, that's it!"===localStorage.getItem("wasLastSupporter")?document.body.classList.add("no_login_ceriad"):Ps.loadProvider()),mn.loggedIn()){if(p(xt("return_form")),xt("return_is").innerHTML=mn.username().toUpperCase(),(e||window.IS_ELECTRON&&"never"!==it.electron.loginskip&&!window.EMERGENCY_MODE)&&("always"===(it.electron.loginskip||"always")||n))return xt("return_form").classList.add("busy"),void r(xt("return_form"))}else p(xt("entry_form"));xt("desktop_transition").className.includes("hid")||(xt("desktop_transition").classList.add("hiding-preload"),setTimeout((()=>{xt("desktop_transition").classList.add("hidden")}),1e3))}else p(xt("deletion_step1_form"));else p(xt("reset_step2_form"))}function c(e){e.classList.add("hidden"),setTimeout((()=>{e.classList.contains("hidden")&&e.classList.add("noop")}),300)}function p(e){e.classList.remove("noop"),e.getBoundingClientRect(),e.classList.remove("hidden"),document.body.classList.contains("no_login_ceriad")||("return_form"===e.id?Ps.mount("auth-return-lb"):"entry_form"===e.id&&Ps.mount("auth-login-lb"))}function d(){if(!i.length)return void(o?(dn({msg:'</p><center><img src="/res/hifive.png" /><h1>THANK YOU FOR REPORTING</h1></center><p>thank you for your recent report! reports like yours help us identify those who disrupt TETR.IO for everyone.</p><p>your recent reports led to actions against a badly behaving player and their account. thank you for making TETR.IO a better place!</p><p>we hope you\'ll continue assisting us by reporting bad behavior in the future, as well.</p><br><p>TETR.IO STAFF',classes:["noclickout"],buttons:[{label:"OK",classes:[],callback:e=>{e(),kn.finish()}}]}),xt("desktop_transition").className.includes("hid")||(xt("desktop_transition").classList.add("hiding-preload"),setTimeout((()=>{xt("desktop_transition").classList.add("hidden")}),1e3))):kn.finish());const e=i.shift();dn({title:"YOU HAVE BEEN WARNED",msg:`a TETR.IO moderator has left a message for you. please read it thoroughly.</p><p>&nbsp;</p><p class="modal_also">warning id ${e.id}</p><p>you were warned at ${new Date(e.ts).toLocaleString()} for the following reason:</p><p class="banreason">${St(e.reason)}${e.context&&e.context.chat&&e.context.chat.length?`<span class="context">${e.context.chat.map((e=>`[${mn.username().toUpperCase()}] ${St(e)}`)).join("\n")}</span>`:""}`,classes:["ban_modal","noclickout"],buttons:[{label:"OK",classes:[],callback:e=>{e(),d()}}]}),xt("desktop_transition").className.includes("hid")||(xt("desktop_transition").classList.add("hiding-preload"),setTimeout((()=>{xt("desktop_transition").classList.add("hidden")}),1e3))}function h(){if(window.location.href.includes("danger_fromDomainMismatch")){document.body.insertAdjacentHTML("beforeend",'<div id="banned_warning" class="oob_modal crash_modal"><h1>SESSION HIJACK DETECTED</h1><p class="modal_warning_stern">YOU ARE BEING SCAMMED, HACKED AND/OR PHISHED! DO NOT LOG IN!</p><p>TETR.IO has detected that your session is being hijacked. an attacker can read your passwords and tokens, steal your account, read payment information, and more. DO NOT LOG IN! make sure you are on https://tetr.io/. if you are, check for viruses immediately.</p><p class="modal_also">this also happens on open proxies/unblocker websites. these are extremely dangerous for the same reasons and are not allowed on TETR.IO.</p></div>');const e=new Audio("https://kagari.online/serious_alarm.wav");e.loop=!0,Yt("your session is being hijacked! DO NOT LOG IN. please make sure you are on https://tetr.io/! if you are, please check your device against malware."),e.play()}else window.parent?window.parent.location=`https://${_.domain}/?danger_fromDomainMismatch`:window.location=`https://${_.domain}/?danger_fromDomainMismatch`;kn.unready(),kn.setState("environment","load blocked, security issue"),xt("desktop_transition").className.includes("hid")||(xt("desktop_transition").classList.add("hiding-preload"),setTimeout((()=>{xt("desktop_transition").classList.add("hidden")}),1e3))}return Wt((async()=>{if(document.getElementById("js_load_error").innerHTML.includes("TETR.IO PLUS")&&(document.body.classList.add("sigliatrip_idiot"),setTimeout((()=>{xt("sigliatrip_idiot_message").classList.add("hidden")}),15e3)),window["%hammerhead%"]||document.querySelector("src-hammerhead-stored-value")||"1"===document.body.getAttribute("__cpp")||window.alloyLocation)return h();if(_.domain){if(Array.from(new Uint8Array(await crypto.subtle.digest("SHA-1",(new TextEncoder).encode(`TETR.IO:${_.serverCycle}>>DOMAIN>>${_.domain}<<KagarinSoCute`)))).map((e=>e.toString(16).padStart(2,"0"))).join("")!==_.domain_hash||_.domain!==window.location.host)return h()}gn.get("/api/server/environment",void 0,{headers:{"X-Session-ID":e}}).then((async e=>{if(_.domain){if(Array.from(new Uint8Array(await crypto.subtle.digest("SHA-1",(new TextEncoder).encode(`TETR.IO:${_.serverCycle}>>DOMAIN>>${_.domain}<<KagarinSoCute`)))).map((e=>e.toString(16).padStart(2,"0"))).join("")!==_.domain_hash||_.domain!==window.location.host)return h()}t=Uint8Array.from(atob(e.vx),(e=>e.charCodeAt(0))),kn.finishLoad("environment"),window.IS_ELECTRON&&(console.log("%cUsing the Desktop Client","color: #F3E5C0;\n\t\t\t\t\tfont-size: 1.2em;\n\t\t\t\t\tfont-weight: 900;\n\t\t\t\t\ttext-shadow: 0px 0px 2px #BAB650;\n\t\t\t\t\tbackground-color: #504C3488;\n\t\t\t\t\tpadding: 0 1em;\n\t\t\t\t\tborder-radius: 3px;"),zs()),e.signature.build.id!==_.build.id||"creamykagarin18451"!==document.body.getAttribute("data-v")?(console.log(`%cOut of date. Local build ${_.build.id} does not match server build ${e.signature.build.id}`,"color: #FF8E8E;\n\t\t\t\t\t font-size: 1.2em;\n\t\t\t\t\t font-weight: 900;\n\t\t\t\t\t text-shadow: 0px 0px 2px #E83737;\n\t\t\t\t\t background-color: #B6181888;\n\t\t\t\t\t padding: 0 1em;\n\t\t\t\t\t border-radius: 3px;"),kn.update(!1,`${e.signature.commit.id}.${e.signature.serverCycle}.${e.signature.build.id}`)):(console.log(`%cUp to date. Local version ${_.version}-${_.mode} | Commit ${_.commit.id}@${_.branch} (${new Date(_.commit.time).toLocaleString()}) | Server cycle ${_.serverCycle} | Build ${_.build.id} (${new Date(_.build.time).toLocaleString()})`,"color: #C0F3C8;\n\t\t\t\t\t font-size: 1.2em;\n\t\t\t\t\t font-weight: 900;\n\t\t\t\t\t text-shadow: 0px 0px 2px #50BA5C;\n\t\t\t\t\t background-color: #34503788;\n\t\t\t\t\t padding: 0 1em;\n\t\t\t\t\t border-radius: 3px;"),l()),xt("preform_players_entry").innerHTML=e.stats.players.toLocaleString("en-US"),xt("preform_players_return").innerHTML=e.stats.players.toLocaleString("en-US"),xt("preform_games_entry").innerHTML=e.stats.gamesplayed.toLocaleString("en-US"),xt("preform_games_return").innerHTML=e.stats.gamesplayed.toLocaleString("en-US"),xt("preform_hours_entry").innerHTML=Math.floor(e.stats.gametime/3600).toLocaleString("en-US"),xt("preform_hours_return").innerHTML=Math.floor(e.stats.gametime/3600).toLocaleString("en-US")}),(e=>{kn.finishLoad("environment"),window.IS_ELECTRON&&(console.log("%cUsing the Desktop Client","color: #F3E5C0;\n\t\t\t\t\tfont-size: 1.2em;\n\t\t\t\t\tfont-weight: 900;\n\t\t\t\t\ttext-shadow: 0px 0px 2px #BAB650;\n\t\t\t\t\tbackground-color: #504C3488;\n\t\t\t\t\tpadding: 0 1em;\n\t\t\t\t\tborder-radius: 3px;"),zs()),Yt("failed to check for updates. check your connection!"),l()})),xt("entry_button").addEventListener("click",(function(e){let t=xt("entry_username").value.toLowerCase();if(!t){if(localStorage.getItem("defaultAnonUsername"))xt("entry_username").value=localStorage.getItem("defaultAnonUsername");else{const e=`GUEST-${Dt(6,10,"0123456789AIUEO_")}`;localStorage.setItem("defaultAnonUsername",e),xt("entry_username").value=e}return t=xt("entry_username").value.toLowerCase(),xt("entry_form").classList.add("busy"),void xt("askregister_anon").click()}xt("entry_form").classList.add("busy"),gn.get(`/api/users/${encodeURIComponent(t)}/exists`).then((e=>{xt("entry_form").classList.remove("busy"),c(xt("entry_form")),e.exists?(xt("login_is").innerHTML=t.toUpperCase(),xt("login_password_username_field").value=t.toUpperCase(),p(xt("login_form")),xt("login_password").focus()):(xt("askregister_is").innerHTML=t.toUpperCase(),xt("register_password_username_field").value=t.toUpperCase(),p(xt("askregister_form")))}),(e=>{xt("entry_form").classList.remove("busy"),en(e)}))})),xt("askregister_back").addEventListener("click",(function(e){c(xt("askregister_form")),p(xt("entry_form")),xt("entry_username").focus()})),xt("askregister_register").addEventListener("click",(function(e){c(xt("askregister_form")),localStorage.getItem("lastUsername")?(p(xt("registeralt_form")),xt("registeralt_username").textContent=localStorage.getItem("lastUsername").toUpperCase()):(p(xt("register_form")),xt("register_password_email_field").focus())})),xt("registeralt_back").addEventListener("click",(function(e){c(xt("registeralt_form")),p(xt("entry_form")),xt("entry_username").focus()})),xt("registeralt_continue").addEventListener("click",(function(e){c(xt("registeralt_form")),p(xt("register_form")),xt("register_password_email_field").focus()})),xt("register_button").addEventListener("click",(function(t){const n=xt("entry_username").value.toLowerCase(),i=xt("register_password_email_field").value,o=xt("register_password").value;o===xt("register_password_confirmation").value?(xt("register_form").classList.add("busy"),gn.post("/api/users/create",{username:n,password:o,email:i||void 0,captcha:xt("captcha").value},{headers:{"X-Session-ID":e}}).then((e=>{xt("register_password").value="",xt("register_password_confirmation").value="",Kt("welcome!"),s=!0,mn.login(e.token,e.userid,n),r(xt("register_form"))}),(e=>{if(e.error&&"BLOCK"===e.error.msg){document.body.classList.add("trapped"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban.");let t="BLOCKED users or IPs may not create accounts. try using an existing account.",n=1;return e.error.banlist.forEach((e=>{t+=`</p><p>&nbsp;</p><p class="modal_also">#${n++}: ban id ${e.id}</p><p>your ${e.from} was ${"silence"==e.type?"silenced":"restrict"==e.type?"restricted":"blocked"} at ${new Date(e.ts).toLocaleString()} for the following reason:</p><p class="banreason">${St(e.reason)}</p><p>this ban ${Date.parse(e.expires)-Date.parse(e.ts)>=54e12?"will not expire":`expires in ${wt(Date.parse(e.expires))}`}.`})),xt("block_reasons").outerHTML=`<p id="block_reasons">${t}</p>`,xt("blocked_warning").classList.remove("hidden"),xt("blocked_warning_iponly").classList.toggle("hidden",e.error.banlist.some((e=>"account"===e.from))),e.error.infinite&&(xt("block_header").innerHTML="YOU HAVE BEEN BANNED FROM TETR.IO",xt("blocked_warning").classList.remove("ban_modal"),xt("blocked_warning").classList.add("crash_modal")),xt("register_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),c(xt("register_form")),void c(xt("captcha_form"))}if(e.error&&"CAPTCHA"===e.error.msg)return xt("captcha").value="",xt("register_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),xt("captcha_button").setAttribute("data-for","register_button"),xt("captcha_image").innerHTML=e.error.captcha,c(xt("register_form")),void p(xt("captcha_form"));xt("register_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),en(e)}))):Yt("those passwords don't match")})),xt("register_back").addEventListener("click",(function(e){c(xt("register_form")),p(xt("askregister_form")),xt("register_password").value="",xt("register_password_confirmation").value=""})),xt("login_button").addEventListener("click",(function(e){const t=xt("entry_username").value.toLowerCase(),n=xt("login_password").value;xt("login_form").classList.add("busy"),gn.post("/api/users/authenticate",{username:t,password:n,totp:xt("totp").value}).then((e=>{xt("login_password").value="",mn.login(e.token,e.userid,t),r(xt("login_form"))}),(e=>{if(e.error&&"BLOCK"===e.error.msg){document.body.classList.add("trapped"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban.");let t="BLOCKED users or IPs may not use TETR.IO.",n=1;return e.error.banlist.forEach((e=>{t+=`</p><p>&nbsp;</p><p class="modal_also">#${n++}: ban id ${e.id}</p><p>your ${e.from} was ${"silence"==e.type?"silenced":"restrict"==e.type?"restricted":"blocked"} at ${new Date(e.ts).toLocaleString()} for the following reason:</p><p class="banreason">${St(e.reason)}</p><p>this ban ${Date.parse(e.expires)-Date.parse(e.ts)>=54e12?"will not expire":`expires in ${wt(Date.parse(e.expires))}`}.`})),xt("block_reasons").outerHTML=`<p id="block_reasons">${t}</p>`,xt("blocked_warning").classList.remove("hidden"),xt("blocked_warning_iponly").classList.toggle("hidden",e.error.banlist.some((e=>"account"===e.from))),e.error.infinite&&(xt("block_header").innerHTML="YOU HAVE BEEN BANNED FROM TETR.IO",xt("blocked_warning").classList.remove("ban_modal"),xt("blocked_warning").classList.add("crash_modal")),xt("login_form").classList.remove("busy"),void c(xt("login_form"))}if(e.error&&"TOTP"===e.error.msg)return xt("totp").value="",xt("login_form").classList.remove("busy"),xt("totp_form").classList.remove("busy"),xt("totp_button").setAttribute("data-for","login_button"),c(xt("login_form")),void p(xt("totp_form"));xt("totp_form").classList.remove("busy"),xt("login_form").classList.remove("busy"),en(e)}))})),xt("login_back").addEventListener("click",(function(e){c(xt("login_form")),p(xt("entry_form")),xt("entry_username").focus(),xt("login_password").value=""})),xt("login_reset").addEventListener("click",(function(e){c(xt("login_form")),p(xt("request_reset_form")),xt("request_reset_email").focus(),xt("login_password").value=""})),xt("request_reset_back").addEventListener("click",(function(e){c(xt("request_reset_form")),p(xt("login_form")),xt("login_password").focus(),xt("request_reset_email").value=""})),xt("request_reset_button").addEventListener("click",(function(t){const n=xt("entry_username").value.toLowerCase(),s=xt("request_reset_email").value;xt("request_reset_form").classList.add("busy"),gn.post("/api/users/requestPasswordReset",{username:n,email:s,captcha:xt("captcha").value},{headers:{"X-Session-ID":e}}).then((e=>{Zt("if the email you entered was correct, you should be receiving an email shortly!"),xt("request_reset_form").classList.remove("busy"),xt("request_reset_back").click(),xt("captcha_form").classList.remove("busy"),c(xt("captcha_form"))}),(e=>{if(e.error&&"CAPTCHA"===e.error.msg)return xt("captcha").value="",xt("request_reset_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),xt("captcha_button").setAttribute("data-for","request_reset_button"),xt("captcha_image").innerHTML=e.error.captcha,c(xt("request_reset_form")),p(xt("captcha_form")),void xt("captcha_form").classList.remove("busy");xt("request_reset_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),en(e)}))})),xt("reset_step2_button").addEventListener("click",(function(e){const t=n.substring(2),s=xt("reset_step2_password").value;s===xt("reset_step2_password_confirmation").value?(xt("reset_step2_form").classList.add("busy"),gn.post("/api/users/resetPassword",{recoveryid:t,password:s}).then((e=>{xt("reset_step2_password").value="",xt("reset_step2_password_confirmation").value="",Zt("password reset!"),c(xt("reset_step2_form")),p(xt("entry_form")),xt("entry_username").focus()}),(e=>{xt("reset_step2_form").classList.remove("busy"),en(e)}))):Yt("those passwords don't match")})),xt("askregister_anon").addEventListener("click",(function(t){const n=xt("entry_username").value.toLowerCase();xt("askregister_form").classList.add("busy"),gn.post("/api/users/anonymousJoin",{username:n,captcha:xt("captcha").value},{headers:{"X-Session-ID":e}}).then((e=>{e.newname||n.startsWith("guest-")||Kt("this name has been used before - please consider registering a full account!"),s=!0,mn.login(e.token,e.userid,n,!1),r(xt("askregister_form"))}),(e=>{if(e.error&&"BLOCK"===e.error.msg){document.body.classList.add("trapped"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban.");let t="BLOCKED users or IPs may not use TETR.IO. try using an existing account.",n=1;return e.error.banlist.forEach((e=>{t+=`</p><p>&nbsp;</p><p class="modal_also">#${n++}: ban id ${e.id}</p><p>your ${e.from} was ${"silence"==e.type?"silenced":"restrict"==e.type?"restricted":"blocked"} at ${new Date(e.ts).toLocaleString()} for the following reason:</p><p class="banreason">${St(e.reason)}</p><p>this ban ${Date.parse(e.expires)-Date.parse(e.ts)>=54e12?"will not expire":`expires in ${wt(Date.parse(e.expires))}`}.`})),xt("block_reasons").outerHTML=`<p id="block_reasons">${t}</p>`,xt("blocked_warning").classList.remove("hidden"),xt("blocked_warning_iponly").classList.toggle("hidden",e.error.banlist.some((e=>"account"===e.from))),e.error.infinite&&(xt("block_header").innerHTML="YOU HAVE BEEN BANNED FROM TETR.IO",xt("blocked_warning").classList.remove("ban_modal"),xt("blocked_warning").classList.add("crash_modal")),xt("askregister_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),c(xt("askregister_form")),c(xt("entry_form")),void c(xt("captcha_form"))}if(e.error&&"CAPTCHA"===e.error.msg)return xt("captcha").value="",xt("askregister_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),xt("entry_form").classList.remove("busy"),xt("captcha_button").setAttribute("data-for","askregister_anon"),xt("captcha_image").innerHTML=e.error.captcha,c(xt("askregister_form")),c(xt("entry_form")),void p(xt("captcha_form"));xt("askregister_form").classList.remove("busy"),xt("captcha_form").classList.remove("busy"),en(e)}))})),xt("captcha_button").addEventListener("click",(function(e){xt("captcha").value&&(xt("captcha_form").classList.add("busy"),xt(xt("captcha_button").getAttribute("data-for")).click())})),xt("totp_button").addEventListener("click",(function(e){xt("totp").value&&(xt("totp_form").classList.add("busy"),xt(xt("totp_button").getAttribute("data-for")).click())})),xt("return_logout").addEventListener("click",(function(e){const t=()=>{c(xt("return_form")),mn.logout(!0),p(xt("entry_form"))};document.body.classList.contains("trapped")||"Attempting to bypass a ban will escalate it to a permanent ban."===localStorage.getItem("trapped")?(c(xt("return_form")),dn({title:"AS A STERN REMINDER",msg:'IF YOU HAVE BEEN SILENCED, RESTRICTED OR OTHERWISE BANNED, YOU MAY NEVER SWITCH TO ANOTHER ACCOUNT TO EVADE THE BAN. THIS INCLUDES SWITCHING TO AN ANONYMOUS ACCOUNT. EVADING A BAN MAKES IT PERMANENT.</p><p class="modal_warning">exceptions apply if the ban was not meant for you, or when logging out of an alternate account. for more info, read the <a href="/about/rules/" target="_blank">community rules</a>.',classes:["crash_modal","noclickout"],buttons:[{label:"CANCEL",classes:[],callback:e=>{p(xt("return_form")),e()}},{label:"I'M NOT EVADING!",classes:["pri"],callback:e=>{p(xt("return_form")),e(),t()}}]})):t()})),xt("return_button").addEventListener("click",(function(e){xt("return_form").classList.add("busy"),r(xt("return_form"))})),xt("ban_skip_button").addEventListener("click",(function(e){xt("banned_warning").classList.add("hidden"),d()})),xt("deletion_step1_button").addEventListener("click",(function(e){c(xt("deletion_step1_form")),p(xt("deletion_step2_form"))})),xt("deletion_step1_cancel").addEventListener("click",(function(e){kn.update(!0)})),xt("deletion_step2_button").addEventListener("click",(function(e){c(xt("deletion_step2_form")),p(xt("deletion_step3_form")),xt("deletion_spanner").classList.remove("hidden")})),xt("deletion_step2_cancel").addEventListener("click",(function(e){kn.update(!0)}));let i=10,o=!1;function a(){o||(i--,xt("deletion_countdown").innerHTML=Math.max(0,i),-1===i?(xt("deletion_cancel_holder").remove(),xt("deletion_countdown").remove(),xt("deletion_header").innerHTML="DESTRUCTION!",setTimeout((()=>{gn.post("/api/users/finalizeDeletion",{deletionid:n.substring(2)}).then((e=>{mn.logout(),xt("deletion_header").innerHTML="ACCOUNT DELETED",xt("deletion_final_form").classList.add("shudder"),setTimeout((()=>{xt("deletion_final_form").classList.remove("shudder")}),150),setTimeout((()=>{kn.update(!0)}),5e3)}),(e=>{xt("deletion_header").innerHTML="an error has occured",en(e)}))}),500)):setTimeout(a,1e3))}xt("deletion_step3_button").addEventListener("click",(function(e){c(xt("deletion_step3_form")),p(xt("deletion_final_form")),setTimeout(a,1e3)})),xt("deletion_step3_cancel").addEventListener("click",(function(e){kn.update(!0)})),xt("deletion_final_cancel").addEventListener("click",(function(e){o=!0,kn.update(!0)}))})),{quickjoin:n,newacc:()=>s}})();function $s(){for(const e of document.getElementsByClassName("controls_keybinds_style"))e.classList.remove("pressed");xt(`controls_keybinds_style_${it.controls.style}`).classList.add("pressed");for(const e of document.getElementsByClassName("controls_keybinds_list"))e.classList.add("hidden");xt(`controls_keybinds_list_${it.controls.style}`).classList.remove("hidden");for(const e of document.getElementsByClassName("keybind_custom")){const t=it.controls.custom[e.getAttribute("data-key")],n=t&&t.length&&t[parseInt(e.getAttribute("data-id"))]||"[NOT SET]";let s=n;("BUTTON"===n.substring(0,6)||n.substring(0,4))&&(s=si.getButtonNameForCurrentController(n)),e.textContent=s,e.setAttribute("data-value",n)}for(const e of document.getElementsByClassName("keybind_custom")){const t=e.getAttribute("data-value"),n=e.getAttribute("data-scope");"[NOT SET]"!==t&&yt(`.keybind_custom${"global"!==n?`[data-scope="${n}"]`:""}[data-value="${t.replace(/"/g,"&quot;")}"]`).length>=2||"[NOT SET]"!==t&&"global"!==n&&yt(`.keybind_custom[data-scope="global"][data-value="${t.replace(/"/g,"&quot;")}"]`).length>=1?e.classList.add("keybind_warning"):e.classList.remove("keybind_warning")}for(const e of document.getElementsByClassName("guide_keybind")){const t=at[e.getAttribute("data-key")].filter((e=>!!e));e.textContent=t&&t.length?t.join(", "):"[NOT SET]"}xt("controls_sensitivity").value=it.controls.sensitivity||.5,xt("controls_sensitivity_field").textContent=100-Math.round(100*(it.controls.sensitivity||.5)),xt("controls_vibration").value=it.controls.vibration||1,xt("controls_vibration_field").textContent=0==it.controls.vibration?"OFF":Math.round(100*(it.controls.vibration||1)),xt("handling_arr").value=it.handling.arr,xt("handling_arr_field").textContent=it.handling.arr,xt("handling_arr_field_ms").value=`${Math.round(it.handling.arr*(1e3/60))}MS`,xt("handling_das").value=it.handling.das,xt("handling_das_field").textContent=it.handling.das,xt("handling_das_field_ms").value=`${Math.round(it.handling.das*(1e3/60))}MS`,xt("handling_dcd").value=it.handling.dcd||0,xt("handling_dcd_field").textContent=it.handling.dcd||0,xt("handling_dcd_field_ms").value=`${Math.round((it.handling.dcd||0)*(1e3/60))}MS`,xt("handling_sdf").value=it.handling.sdf,xt("handling_sdf_field").textContent=41==it.handling.sdf?"":it.handling.sdf,xt("handling_safelock").classList.toggle("checked",!1!==it.handling.safelock),xt("handling_cancel").classList.toggle("checked",!!it.handling.cancel),xt("handling_may20g").classList.toggle("checked",!1!==it.handling.may20g);const e=Math.min(1,it.volume.music)+Math.max(0,it.volume.music/2-.5);xt("volume_music").value=e,xt("volume_music_field").textContent=0==it.volume.music?"MUTE":Math.round(100*it.volume.music),xt("volume_overlay_mus_value").style.backgroundImage=`linear-gradient(to top, #FFF 0%, #FFF ${Math.min(200/3,e/1.5*100)}%, #ff0245 ${Math.min(200/3,e/1.5*100)}%, #ff0245 ${e/1.5*100}%, #FFF2 ${e/1.5*100}%, #FFF2 100%)`;const t=Math.min(1,it.volume.sfx)+Math.max(0,it.volume.sfx/2-.5);xt("volume_sfx").value=t,xt("volume_sfx_field").textContent=0==it.volume.sfx?"MUTE":Math.round(100*it.volume.sfx),xt("volume_overlay_sfx_value").style.backgroundImage=`linear-gradient(to top, #FFF 0%, #FFF ${Math.min(200/3,t/1.5*100)}%, #ff0245 ${Math.min(200/3,t/1.5*100)}%, #ff0245 ${t/1.5*100}%, #FFF2 ${t/1.5*100}%, #FFF2 100%)`,xt("volume_stereo").value=it.volume.stereo,xt("volume_stereo_field").textContent=0==it.volume.stereo?"OFF":Math.round(100*it.volume.stereo),xt("volume_disable").classList.toggle("checked",!!it.volume.disable),xt("volume_next").classList.toggle("checked",it.volume.next),xt("volume_others").classList.toggle("checked",it.volume.others),xt("volume_scrollable").classList.toggle("checked",!1!==it.volume.scrollable),xt("volume_attacks").classList.toggle("checked",!1!==it.volume.attacks),xt("volume_noreset").classList.toggle("checked",!1!==it.volume.noreset),xt("volume_oof").classList.toggle("checked",!1!==it.volume.oof),xt("volume_sfx").onchange=()=>na.PlaySe("clearline");for(const e of document.getElementsByClassName("video_graphics"))e.classList.remove("pressed");xt(`video_graphics_${it.video.graphics}`).classList.add("pressed");for(const e of document.getElementsByClassName("video_caching"))e.classList.remove("pressed");"high"===it.video.caching&&(it.video.caching="medium"),xt(`video_caching_${it.video.caching||"medium"}`).classList.add("pressed");for(const e of document.getElementsByClassName("video_actiontext"))e.classList.remove("pressed");xt(`video_actiontext_${it.video.actiontext||"all"}`).classList.add("pressed");for(const e of document.getElementsByClassName("video_webgl"))e.classList.remove("pressed");xt(`video_webgl_${it.video.webgl||"webgl2"}`).classList.add("pressed"),xt("video_particles").value=it.video.particles||.6,xt("video_particles_field").textContent=Math.round(100*(it.video.particles||.6)),xt("video_background").value=it.video.background,xt("video_background_field").textContent=Math.round(100*it.video.background),xt("video_bounciness").value=it.video.bounciness,xt("video_bounciness_field").textContent=Math.round(100*it.video.bounciness),xt("video_shakiness").value=it.video.shakiness,xt("video_shakiness_field").textContent=Math.round(100*it.video.shakiness),xt("video_gridopacity").value=void 0===it.video.gridopacity?.1:it.video.gridopacity,xt("video_gridopacity_field").textContent=Math.round(100*(void 0===it.video.gridopacity?.1:it.video.gridopacity)),xt("video_boardopacity").value=void 0===it.video.boardopacity?.85:it.video.boardopacity,xt("video_boardopacity_field").textContent=Math.round(100*(void 0===it.video.boardopacity?.85:it.video.boardopacity)),xt("video_shadowopacity").value=void 0===it.video.shadowopacity?.15:it.video.shadowopacity,xt("video_shadowopacity_field").textContent=Math.round(100*(void 0===it.video.shadowopacity?.15:it.video.shadowopacity)),xt("video_zoom").value=void 0===it.video.zoom?1:it.video.zoom,xt("video_zoom_field").textContent=Math.round(100*(void 0===it.video.zoom?1:it.video.zoom)),xt("video_bloom").value=void 0===it.video.bloom?1:it.video.bloom,xt("video_bloom_field").textContent=0==it.video.bloom?"OFF":Math.round(100*(void 0===it.video.bloom?1:it.video.bloom)),xt("video_chroma").value=void 0===it.video.chroma?.5:it.video.chroma,xt("video_chroma_field").textContent=0==it.video.chroma?"OFF":Math.round(100*(void 0===it.video.chroma?.5:it.video.chroma)),xt("video_flashwave").value=void 0===it.video.flashwave?1:it.video.flashwave,xt("video_flashwave_field").textContent=0==it.video.flashwave?"OFF":Math.round(100*(void 0===it.video.flashwave?1:it.video.flashwave)),xt("video_powersave").classList.toggle("checked",!!it.video.powersave),xt("video_alwaystiny").classList.toggle("checked",!!it.video.alwaystiny),xt("video_nosuperlobbyanim").classList.toggle("checked",!!it.video.nosuperlobbyanim),xt("video_nozenithanim").classList.toggle("checked",!!it.video.nozenithanim),xt("video_colorshadow").classList.toggle("checked",!!it.video.colorshadow),xt("video_holdlocked").classList.toggle("checked",!1!==it.video.holdlocked),xt("video_sidebyside").classList.toggle("checked",!!it.video.sidebyside),xt("video_spin").classList.toggle("checked",!!it.video.spin),xt("video_chatfilter").classList.toggle("checked",!1!==it.video.chatfilter),xt("video_nochat").classList.toggle("checked",!!it.video.nochat),xt("video_hideroomids").classList.toggle("checked",!!it.video.hideroomids),xt("video_emotes").classList.toggle("checked",!1!==it.video.emotes),xt("video_emotes_anim").classList.toggle("checked",!1!==it.video.emotes_anim),xt("video_invert").classList.toggle("checked",!!it.video.invert),xt("video_nobg").classList.toggle("checked",!!it.video.nobg),xt("video_chatbg").classList.toggle("checked",!!it.video.chatbg),xt("video_replaytoolsnocollapse").classList.toggle("checked",!!it.video.replaytoolsnocollapse),xt("video_kos").classList.toggle("checked",!1!==it.video.kos),xt("video_fire").classList.toggle("checked",!1!==it.video.fire),xt("video_focuswarning").classList.toggle("checked",!1!==it.video.focuswarning),xt("video_hidenetwork").classList.toggle("checked",!!it.video.hidenetwork),xt("video_guide").classList.toggle("checked",!1!==it.video.guide),xt("video_desktopnotifications").classList.toggle("checked",!1!==it.video.desktopnotifications),xt("video_siren").classList.toggle("checked",!1!==it.video.siren),xt("video_lowrescounters").classList.toggle("checked",!!it.video.lowrescounters),xt("video_lowres").classList.toggle("checked",!!it.video.lowres),xt("config_background_usecustom").classList.toggle("checked",it.video.background_usecustom===ot),xt("config_background_url").value=it.video.background_url||"",xt("diyusi_strategy_1").querySelector("h1").textContent=(at.target1[0]||"*").toLowerCase(),xt("diyusi_strategy_2").querySelector("h1").textContent=(at.target2[0]||"*").toLowerCase(),xt("diyusi_strategy_3").querySelector("h1").textContent=(at.target3[0]||"*").toLowerCase(),xt("diyusi_strategy_4").querySelector("h1").textContent=(at.target4[0]||"*").toLowerCase(),xt("pro_40l").classList.toggle("checked",!!it.gameoptions.pro_40l),xt("pro_40l_alert").classList.toggle("checked",!!it.gameoptions.pro_40l_alert),xt("pro_40l_retry").classList.toggle("checked",!!it.gameoptions.pro_40l_retry),xt("stride_40l").classList.toggle("checked",!!it.gameoptions.stride_40l),xt("slot_40l_counter1").textContent=it.gameoptions.slot_40l_counter1||"---default---",xt("slot_40l_counter2").textContent=it.gameoptions.slot_40l_counter2||"---default---",xt("slot_40l_counter3").textContent=it.gameoptions.slot_40l_counter3||"---default---",xt("slot_40l_counter4").textContent=it.gameoptions.slot_40l_counter4||"---default---",xt("slot_40l_counter5").textContent=it.gameoptions.slot_40l_counter5||"---default---",xt("pro_blitz").classList.toggle("checked",!!it.gameoptions.pro_blitz),xt("pro_blitz_alert").classList.toggle("checked",!!it.gameoptions.pro_blitz_alert),xt("pro_blitz_retry").classList.toggle("checked",!!it.gameoptions.pro_blitz_retry),xt("stride_blitz").classList.toggle("checked",!!it.gameoptions.stride_blitz),xt("slot_blitz_counter1").textContent=it.gameoptions.slot_blitz_counter1||"---default---",xt("slot_blitz_counter2").textContent=it.gameoptions.slot_blitz_counter2||"---default---",xt("slot_blitz_counter3").textContent=it.gameoptions.slot_blitz_counter3||"---default---",xt("slot_blitz_counter4").textContent=it.gameoptions.slot_blitz_counter4||"---default---",xt("slot_blitz_counter5").textContent=it.gameoptions.slot_blitz_counter5||"---default---";for(const e of document.getElementsByClassName("electron_loginskip"))e.classList.remove("pressed");xt(`electron_loginskip_${it.electron.loginskip||"always"}`).classList.add("pressed");for(const e of document.getElementsByClassName("electron_frameratelimit"))e.classList.remove("pressed");xt(`electron_frameratelimit_${it.electron.frameratelimit||"4x"}`).classList.add("pressed"),xt("config_electron_presence").classList.toggle("checked",!1!==it.electron.presence),xt("config_electron_presence").classList.toggle("hidden",!0===_.norichpresence),xt("config_electron_taskbarflash").classList.toggle("checked",!1!==it.electron.taskbarflash),xt("config_electron_anglecompat").classList.toggle("checked",!!it.electron.anglecompat),xt("config_electron_adblock").classList.toggle("checked",!!it.electron.adblock),xt("config_electron_autoupdate").classList.toggle("checked",!1!==it.electron.autoupdate),ea.random.forEach((e=>{yt(`.bgmtweak_option[data-id="${e}"]`).forEach((t=>{t.classList.toggle("pressed",t.getAttribute("data-option")===((it.volume.bgmtweak||{})[e]||"base"))}))})),xt("notifications_suppress").classList.toggle("checked",!1!==it.notifications.suppress),xt("notifications_forcesound").classList.toggle("checked",!!it.notifications.forcesound);for(const e of document.getElementsByClassName("notifications_online"))e.classList.remove("pressed");xt(`notifications_online_${it.notifications.online}`).classList.add("pressed");for(const e of document.getElementsByClassName("notifications_offline"))e.classList.remove("pressed");xt(`notifications_offline_${it.notifications.offline}`).classList.add("pressed");for(const e of document.getElementsByClassName("notifications_dm"))e.classList.remove("pressed");xt(`notifications_dm_${it.notifications.dm}`).classList.add("pressed");for(const e of document.getElementsByClassName("notifications_dm_pending"))e.classList.remove("pressed");xt(`notifications_dm_pending_${it.notifications.dm_pending}`).classList.add("pressed");for(const e of document.getElementsByClassName("notifications_invite"))e.classList.remove("pressed");xt(`notifications_invite_${it.notifications.invite}`).classList.add("pressed");for(const e of document.getElementsByClassName("notifications_other"))e.classList.remove("pressed");xt(`notifications_other_${it.notifications.other}`).classList.add("pressed")}Wt((async()=>{if(_.sentry_enabled&&!document.body.classList.contains("sigliatrip_idiot"))try{console.log("Loading Darkside error reporting...");const e=await gn.get("https://darkside.moon.kagari.moe/js-sdk-loader/460c5a5f6fedfbc31033d3feb6a110a0.min.js",void 0,{parse:!1}),t=document.createElement("script");t.type="text/javascript",t.text=e,document.head.insertAdjacentElement("beforeend",t),Sentry.onLoad((function(){Sentry.init({release:`tetrio@${_.version}+${_.build.id}`,tracesSampleRate:.01,profilesSampleRate:1,replaysSessionSampleRate:0,replaysOnErrorSampleRate:.1,tracePropagationTargets:[/^\/api/],transport:function(e){const t=Sentry.makeFetchTransport(e);return{send:(e,...n)=>{if(e&&e[1])for(const t of e[1])if(t&&!(t.length<2)&&t[0]&&"profile"===t[0].type){if(!t[1]||!t[1].profile||!t[1].profile.frames)continue;for(const e of t[1].profile.frames)(e.abs_path&&e.abs_path.includes("blob")||e.function&&e.function.includes("blob"))&&(e.abs_path="app:///tetrio.js",e.function&&(e.function=e.function.replace(/@?blob:?/,"")))}return t.send(e,...n)},flush:t.flush}},integrations:[Sentry.replayIntegration({maskAllText:!1,blockAllMedia:!1,mask:['input[type="password"]'],maxReplayDuration:12e4}),Sentry.browserTracingIntegration({beforeStartSpan:e=>({...e,name:location.pathname.replace(/\/api\/achievements\/\d+/,"/api/achievements/:k").replace(/\/api\/dms\/.+/,"/api/dms/:userid").replace(/\/api\/games\/[^\/]+/,"/api/games/:replayid").replace(/\/api\/users\/[^\/]+\/exists/,"/api/users/:username/exists").replace(/\/api\/users\/[^\/]+\/resolve/,"/api/users/:username/resolve").replace(/\/api\/users\/[0-9a-f]{24}$/,"/api/users/:userid")})})],beforeSend:e=>{let t=!1;if(!e?.exception?.values)return e;for(const n of e.exception.values)if(n?.stacktrace?.frames)for(const e of n.stacktrace.frames)(e.filename&&e.filename.includes("blob")||e.function&&e.function.includes("blob"))&&(e.filename="app:///tetrio.js",e.function&&(e.function=e.function.replace(/@?blob:?/,"")),t=!0);return t?e:null}}),console.log("Darkside provider loaded."),Sentry.lazyLoadIntegration("browserProfilingIntegration").then((e=>{Sentry.addIntegration(e())}))}))}catch(e){console.warn("Darkside provider could not be loaded.",e)}}));const Ns=[];async function Us(e=!1){if(!nl)return;Ns.length||(Ns.push(...ht),Da.shuffleArray(Ns));const t=Ns.pop(),n=await Gs(t);n&&nl.setBackground(n,e)}async function Gs(e){try{return await a.Texture.fromURL(e)}catch(t){return console.error(`Failed to load background '${e}'`),!1}}let Xs=()=>{};function js(e){xt("keybind_request").classList.remove("hidden"),Xs=e,document.addEventListener("keydown",qs,!1),document.addEventListener("gpdown",qs,!1),setTimeout((()=>{document.addEventListener("click",Ks,!1)}),0)}function qs(e){document.removeEventListener("keydown",qs,!1),document.removeEventListener("gpdown",qs,!1),document.removeEventListener("click",Ks,!1),xt("keybind_request").classList.add("hidden"),Xs(Ct(e)),e.preventDefault()}function Ks(e){document.removeEventListener("keydown",qs,!1),document.removeEventListener("gpdown",qs,!1),document.removeEventListener("click",Ks,!1),xt("keybind_request").classList.add("hidden"),Xs("X-NOKEY"),e.preventDefault()}const Vs=(e,t)=>{xt(e).addEventListener("click",(function(e){!1!==t(e)&&(_t(),bt())}))},Qs=(e,t)=>{xt(e).addEventListener("input",(function(e){!1!==t(e)&&(_t(),bt())}))};function Ys(e,t){function n(t){let n=!0;e>0&&it.volume[t]>=1&&it.volume[t]<1.05&&((null===__volOverlayAllowLoudAfter||performance.now()>=__volOverlayAllowLoudAfter+5e3)&&(__volOverlayAllowLoudAfter=performance.now()+500),performance.now()<__volOverlayAllowLoudAfter&&(n=!1)),it.volume[t]=Math.max(0,Math.min(n?2:1,parseFloat(it.volume[t])+.05*e))}"bgm"!==t&&null!=t||n("music"),"se"!==t&&null!=t||(n("sfx"),na.PlaySe("se_vol_blip")),xt("volume_overlay").classList.remove("hidden"),xt("volume_overlay").classList.remove("hiding"),setTimeout((()=>{xt("volume_overlay").classList.add("hiding")}),100),__volOverlayTimeout&&clearTimeout(__volOverlayTimeout),__volOverlayTimeout=setTimeout((()=>{xt("volume_overlay").classList.add("hidden")}),5100),_t(),bt()}kn.ready((function(e){let t="";ea.random.forEach((e=>{t+=`<div class="control_group flex-row bgmtweaking">\n\t\t\t\t\t<h1 class="bgmtweak_header rg_target_pri" data-id="${e}" data-hover="tap" data-hit="click">${Zo[e].artist} - ${Zo[e].name} (${Zo[e].genre})</h1>\n\t\t\t\t\t<div class="control_button flex-item bgmtweak_option rg_target_pri" data-id="${e}" data-option="ban" data-hover="tap" data-hit="click" title="Never play this song.">BAN</div>\n\t\t\t\t\t<div class="control_button flex-item bgmtweak_option rg_target_pri" data-id="${e}" data-option="minmin" data-hover="tap" data-hit="click" title="Play this song far less often.">--</div>\n\t\t\t\t\t<div class="control_button flex-item bgmtweak_option rg_target_pri" data-id="${e}" data-option="min" data-hover="tap" data-hit="click" title="Play this song less often.">-</div>\n\t\t\t\t\t<div class="control_button flex-item bgmtweak_option rg_target_pri" data-id="${e}" data-option="base" data-hover="tap" data-hit="click" title="Play this song a normal amount.">=</div>\n\t\t\t\t\t<div class="control_button flex-item bgmtweak_option rg_target_pri" data-id="${e}" data-option="plus" data-hover="tap" data-hit="click" title="Play this song more often.">+</div>\n\t\t\t\t\t<div class="control_button flex-item bgmtweak_option rg_target_pri" data-id="${e}" data-option="plusplus" data-hover="tap" data-hit="click" title="Play this song far more often.">++</div>\n\t\t\t\t</div>`})),xt("bgmtweak").innerHTML=t,mt(),bt(),"legacy"===it.video.webgl&&Kt({msg:"using LEGACY WEBGL - this may slow down your game. if your device supports it, switch to WEBGL 2 in CONFIG!",color:"#FFC600",icon:"warning",timeout:1e4}),setTimeout((()=>{Us(),Ur.play("bgtransition")}),300),setTimeout((()=>{Al()}),2e3),Vs("finish_guide_room",(()=>{it.video.guide=!1,xt("room_opts_room").click()})),Vs("finish_guide_sys",(()=>(xt("sys_guide").classList.add("hiding"),xt("room_opts_room").click(),setTimeout((()=>{it.video.guide=!1,_t(),bt()}),1e3),!1))),Vs("controls_keybinds_style_guideline",(()=>{it.controls.style="guideline"})),Vs("controls_keybinds_style_wasd",(()=>{it.controls.style="wasd"})),Vs("controls_keybinds_style_custom",(()=>{it.controls.style="custom"}));for(const e of document.getElementsByClassName("keybind_custom"))e.addEventListener("click",(function(t){js((t=>{it.controls.custom[e.getAttribute("data-key")][parseInt(e.getAttribute("data-id"))]="X-NOKEY"===t?"":t,_t(),bt()}))}));Qs("controls_sensitivity",(()=>{it.controls.sensitivity=xt("controls_sensitivity").value})),Qs("controls_vibration",(()=>{it.controls.vibration=xt("controls_vibration").value}));const n=()=>{Sa&&Sa.isConnected()&&Sa.updateHandling()};Qs("handling_arr",(()=>{it.handling.arr=parseFloat(xt("handling_arr").value),n()})),Qs("handling_das",(()=>{it.handling.das=parseFloat(xt("handling_das").value),n()})),Qs("handling_dcd",(()=>{it.handling.dcd=parseFloat(xt("handling_dcd").value),n()})),Qs("handling_sdf",(()=>{it.handling.sdf=parseFloat(xt("handling_sdf").value),n()})),Vs("handling_safelock",(()=>{it.handling.safelock=!xt("handling_safelock").classList.contains("checked"),n()})),Vs("handling_cancel",(()=>{it.handling.cancel=!xt("handling_cancel").classList.contains("checked"),n()})),Vs("handling_may20g",(()=>{it.handling.may20g=!xt("handling_may20g").classList.contains("checked"),n()}));for(const e of document.getElementsByClassName("stat_field"))e.addEventListener("click",(function(t){const n=e.closest(".stat");gi(n.querySelector(".stat_name").textContent,"enter a new value",n.querySelector(".stat_range").getAttribute("min"),n.querySelector(".stat_range").getAttribute("max"),n.querySelector(".stat_range").getAttribute("step")||"1",n.querySelector(".stat_range").value,(e=>{n.querySelector(".stat_range").value=e,n.querySelector(".stat_range").dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),_t(),bt()}))}));Vs("handling_reset",(()=>{it.handling.arr=2,it.handling.das=10,it.handling.dcd=1,it.handling.sdf=6,n()})),xt("handling_test").addEventListener("click",(function(e){Rs.testControls()})),Qs("volume_music",(()=>{let e=Number.parseFloat(xt("volume_music").value);e>=.99&&e<=1.01&&(e=1),it.volume.music=Math.min(1,e)+Math.max(0,2*(e-1))})),Qs("volume_sfx",(()=>{let e=Number.parseFloat(xt("volume_sfx").value);e>=.99&&e<=1.01&&(e=1),it.volume.sfx=Math.min(1,e)+Math.max(0,2*(e-1))})),Qs("volume_stereo",(()=>{it.volume.stereo=Number.parseFloat(xt("volume_stereo").value)})),Vs("volume_next",(()=>{it.volume.next=!xt("volume_next").classList.contains("checked")})),Vs("volume_others",(()=>{it.volume.others=!xt("volume_others").classList.contains("checked")})),Vs("volume_scrollable",(()=>{it.volume.scrollable=!xt("volume_scrollable").classList.contains("checked")})),Vs("volume_attacks",(()=>{it.volume.attacks=!xt("volume_attacks").classList.contains("checked")})),Vs("volume_noreset",(()=>{it.volume.noreset=!xt("volume_noreset").classList.contains("checked")})),Vs("volume_oof",(()=>{it.volume.oof=!xt("volume_oof").classList.contains("checked")})),Vs("volume_disable",(()=>{it.volume.disable=!xt("volume_disable").classList.contains("checked")})),window.addEventListener("wheel",(function(e){if(!1===it.volume.scrollable)return;if(!document.body.classList.contains("ingame")&&!e.altKey)return;if(e.target.closest("#ingame_chat_container")&&!e.altKey)return;if(e.target.closest("#zen_panel_content")&&!e.altKey)return;const t=Math.sign(-e.deltaY);e.target.closest("#volume_overlay_sfx")?Ys(t,"se"):e.target.closest("#volume_overlay_mus")?Ys(t,"bgm"):Ys(t),e.altKey&&e.preventDefault()}),{passive:!1}),Vs("video_graphics_minimal",(()=>{it.video.graphics="minimal",it.video.lowres=!0,it.video.sidebyside=!1,tl.unset(),Kt({msg:"changing GRAPHICS LEVEL requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_graphics_low",(()=>{"minimal"===it.video.graphics&&(it.video.lowres=!1,it.video.sidebyside=!0),it.video.graphics="low",tl.unset(),Kt({msg:"changing GRAPHICS LEVEL requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_graphics_medium",(()=>{"minimal"===it.video.graphics&&(it.video.lowres=!1,it.video.sidebyside=!0),it.video.graphics="medium",tl.unset(),Kt({msg:"changing GRAPHICS LEVEL requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_graphics_high",(()=>{"minimal"===it.video.graphics&&(it.video.lowres=!1,it.video.sidebyside=!0),it.video.graphics="high",tl.set(),Kt({msg:"changing GRAPHICS LEVEL requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_graphics_ultra",(()=>{"minimal"===it.video.graphics&&(it.video.lowres=!1,it.video.sidebyside=!0),it.video.graphics="ultra",tl.set(),Kt({msg:"changing GRAPHICS LEVEL requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),window.IS_ELECTRON||Kt({msg:"you are not using TETR.IO DESKTOP - ULTRA graphics may be less performant.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_caching_low",(()=>{it.video.caching="low",Kt({msg:"changing CACHING LEVEL requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_caching_medium",(()=>{it.video.caching="medium",Kt({msg:"changing CACHING LEVEL requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_webgl_legacy",(()=>(dn({title:"USE LEGACY WEBGL?",msg:'LEGACY WEBGL is the slowest WEBGL mode and may introduce bugs. only use it if the other modes do not work for you (for example, you see graphical glitches or flickering while playing)!</p><p class="modal_also">when reporting a bug, please mention LEGACY WEBGL is enabled.',buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"USE LEGACY WEBGL",classes:["sec"],callback:e=>{it.video.webgl="legacy",_t(),bt(),Kt({msg:"changing WEBGL MODE requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gl").innerHTML=`DIRTY (${it.video.webgl})`,e()}}]}),!1))),Vs("video_webgl_webgl1",(()=>{it.video.webgl="webgl1",Kt({msg:"changing WEBGL MODE requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gl").innerHTML=`DIRTY (${it.video.webgl})`})),Vs("video_webgl_webgl2",(()=>{it.video.webgl="webgl2",Kt({msg:"changing WEBGL MODE requires a restart to fully go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gl").innerHTML=`DIRTY (${it.video.webgl})`})),Vs("video_actiontext_off",(()=>{it.video.actiontext="off"})),Vs("video_actiontext_some",(()=>{it.video.actiontext="some"})),Vs("video_actiontext_all",(()=>{it.video.actiontext="all"})),Qs("video_particles",(()=>{it.video.particles=xt("video_particles").value})),Qs("video_background",(()=>{it.video.background=xt("video_background").value})),Qs("video_bounciness",(()=>{it.video.bounciness=xt("video_bounciness").value})),Qs("video_shakiness",(()=>{it.video.shakiness=xt("video_shakiness").value})),Qs("video_gridopacity",(()=>{it.video.gridopacity=xt("video_gridopacity").value})),Qs("video_boardopacity",(()=>{it.video.boardopacity=xt("video_boardopacity").value})),Qs("video_shadowopacity",(()=>{it.video.shadowopacity=xt("video_shadowopacity").value})),Qs("video_zoom",(()=>{it.video.zoom=xt("video_zoom").value,fs(!0)})),Qs("video_bloom",(()=>{it.video.bloom=xt("video_bloom").value})),Qs("video_chroma",(()=>{it.video.chroma=xt("video_chroma").value})),Qs("video_flashwave",(()=>{it.video.flashwave=xt("video_flashwave").value})),Vs("video_powersave",(()=>{it.video.powersave=!xt("video_powersave").classList.contains("checked"),Kt({msg:"changing POWER SAVE requires a restart to go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_lowres",(()=>{it.video.lowres=!xt("video_lowres").classList.contains("checked"),Kt({msg:"changing LOW RESOLUTION MODE requires a restart to go in effect. hit F5 on your keyboard to restart.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_gfx").innerHTML=`DIRTY (${it.video.graphics})`})),Vs("video_guide",(()=>{it.video.guide=!xt("video_guide").classList.contains("checked"),it.video.guide?xt("room_opts_welcome").click():xt("room_opts_room").click()})),Vs("video_desktopnotifications",(()=>{it.video.desktopnotifications=!xt("video_desktopnotifications").classList.contains("checked"),it.video.desktopnotifications&&vo(!0)})),Vs("video_lowrescounters",(()=>{it.video.lowrescounters=!xt("video_lowrescounters").classList.contains("checked")})),Vs("video_alwaystiny",(()=>{it.video.alwaystiny=!xt("video_alwaystiny").classList.contains("checked")})),Vs("video_nosuperlobbyanim",(()=>{it.video.nosuperlobbyanim=!xt("video_nosuperlobbyanim").classList.contains("checked")})),Vs("video_nozenithanim",(()=>{it.video.nozenithanim=!xt("video_nozenithanim").classList.contains("checked")})),Vs("video_colorshadow",(()=>{it.video.colorshadow=!xt("video_colorshadow").classList.contains("checked")})),Vs("video_holdlocked",(()=>{it.video.holdlocked=!xt("video_holdlocked").classList.contains("checked")})),Vs("video_sidebyside",(()=>{it.video.sidebyside=!xt("video_sidebyside").classList.contains("checked")})),Vs("video_spin",(()=>{it.video.spin=!xt("video_spin").classList.contains("checked")})),Vs("video_chatfilter",(()=>{it.video.chatfilter=!xt("video_chatfilter").classList.contains("checked")})),Vs("video_nochat",(()=>{it.video.nochat=!xt("video_nochat").classList.contains("checked")})),Vs("video_hideroomids",(()=>{it.video.hideroomids=!xt("video_hideroomids").classList.contains("checked")})),Vs("video_emotes",(()=>{it.video.emotes=!xt("video_emotes").classList.contains("checked")})),Vs("video_emotes_anim",(()=>{it.video.emotes_anim=!xt("video_emotes_anim").classList.contains("checked")})),Vs("video_invert",(()=>{it.video.invert=!xt("video_invert").classList.contains("checked")})),Vs("video_nobg",(()=>{it.video.nobg=!xt("video_nobg").classList.contains("checked")})),Vs("video_chatbg",(()=>{it.video.chatbg=!xt("video_chatbg").classList.contains("checked")})),Vs("video_replaytoolsnocollapse",(()=>{it.video.replaytoolsnocollapse=!xt("video_replaytoolsnocollapse").classList.contains("checked")})),Vs("video_kos",(()=>{it.video.kos=!xt("video_kos").classList.contains("checked")})),Vs("video_fire",(()=>{it.video.fire=!xt("video_fire").classList.contains("checked")})),Vs("video_focuswarning",(()=>{it.video.focuswarning=!xt("video_focuswarning").classList.contains("checked")})),Vs("video_hidenetwork",(()=>{it.video.hidenetwork=!xt("video_hidenetwork").classList.contains("checked")})),Vs("video_siren",(()=>{it.video.siren=!xt("video_siren").classList.contains("checked")})),xt("config_background_url").addEventListener("keydown",(function(e){"Enter"===e.key&&(it.video.background_url=xt("config_background_url").value,ut=!0,_t(),bt())})),Vs("config_background_usecustom",(()=>{it.video.background_usecustom=xt("config_background_usecustom").classList.contains("checked")?null:ot,ut=!0})),Vs("pro_40l",(()=>{it.gameoptions.pro_40l=!xt("pro_40l").classList.contains("checked")})),Vs("pro_40l_alert",(()=>{it.gameoptions.pro_40l_alert=!xt("pro_40l_alert").classList.contains("checked")})),Vs("pro_40l_retry",(()=>{it.gameoptions.pro_40l_retry=!xt("pro_40l_retry").classList.contains("checked")})),Vs("stride_40l",(()=>{it.gameoptions.stride_40l=!xt("stride_40l").classList.contains("checked")})),Qs("slot_40l_counter1",(()=>{it.gameoptions.slot_40l_counter1="---default---"===xt("slot_40l_counter1").innerHTML?void 0:xt("slot_40l_counter1").innerHTML})),Qs("slot_40l_counter2",(()=>{it.gameoptions.slot_40l_counter2="---default---"===xt("slot_40l_counter2").innerHTML?void 0:xt("slot_40l_counter2").innerHTML})),Qs("slot_40l_counter3",(()=>{it.gameoptions.slot_40l_counter3="---default---"===xt("slot_40l_counter3").innerHTML?void 0:xt("slot_40l_counter3").innerHTML})),Qs("slot_40l_counter4",(()=>{it.gameoptions.slot_40l_counter4="---default---"===xt("slot_40l_counter4").innerHTML?void 0:xt("slot_40l_counter4").innerHTML})),Qs("slot_40l_counter5",(()=>{it.gameoptions.slot_40l_counter5="---default---"===xt("slot_40l_counter5").innerHTML?void 0:xt("slot_40l_counter5").innerHTML})),Vs("pro_blitz",(()=>{it.gameoptions.pro_blitz=!xt("pro_blitz").classList.contains("checked")})),Vs("pro_blitz_alert",(()=>{it.gameoptions.pro_blitz_alert=!xt("pro_blitz_alert").classList.contains("checked")})),Vs("pro_blitz_retry",(()=>{it.gameoptions.pro_blitz_retry=!xt("pro_blitz_retry").classList.contains("checked")})),Vs("stride_blitz",(()=>{it.gameoptions.stride_blitz=!xt("stride_blitz").classList.contains("checked")})),Qs("slot_blitz_counter1",(()=>{it.gameoptions.slot_blitz_counter1="---default---"===xt("slot_blitz_counter1").innerHTML?void 0:xt("slot_blitz_counter1").innerHTML})),Qs("slot_blitz_counter2",(()=>{it.gameoptions.slot_blitz_counter2="---default---"===xt("slot_blitz_counter2").innerHTML?void 0:xt("slot_blitz_counter2").innerHTML})),Qs("slot_blitz_counter3",(()=>{it.gameoptions.slot_blitz_counter3="---default---"===xt("slot_blitz_counter3").innerHTML?void 0:xt("slot_blitz_counter3").innerHTML})),Qs("slot_blitz_counter4",(()=>{it.gameoptions.slot_blitz_counter4="---default---"===xt("slot_blitz_counter4").innerHTML?void 0:xt("slot_blitz_counter4").innerHTML})),Qs("slot_blitz_counter5",(()=>{it.gameoptions.slot_blitz_counter5="---default---"===xt("slot_blitz_counter5").innerHTML?void 0:xt("slot_blitz_counter5").innerHTML})),Vs("electron_loginskip_never",(()=>{it.electron.loginskip="never"})),Vs("electron_loginskip_quickjoin",(()=>{it.electron.loginskip="quickjoin"})),Vs("electron_loginskip_always",(()=>{it.electron.loginskip="always"})),Vs("electron_frameratelimit_1x",(()=>{it.electron.frameratelimit="1x"})),Vs("electron_frameratelimit_2x",(()=>{it.electron.frameratelimit="2x"})),Vs("electron_frameratelimit_4x",(()=>{it.electron.frameratelimit="4x"})),Vs("electron_frameratelimit_off",(()=>{it.electron.frameratelimit="off"})),Vs("config_electron_presence",(()=>{it.electron.presence=!xt("config_electron_presence").classList.contains("checked")})),Vs("config_electron_taskbarflash",(()=>{it.electron.taskbarflash=!xt("config_electron_taskbarflash").classList.contains("checked")})),Vs("config_electron_autoupdate",(()=>{window.IPC.send("noautoupdate",xt("config_electron_autoupdate").classList.contains("checked")),it.electron.autoupdate=!xt("config_electron_autoupdate").classList.contains("checked")})),Vs("config_electron_anglecompat",(()=>{it.electron.anglecompat=!xt("config_electron_anglecompat").classList.contains("checked"),Kt({msg:"changing STREAMER COMPATIBILITY MODE requires a full restart to go in effect. close TETR.IO, then reopen it.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_client").innerHTML="DIRTY"})),Vs("config_electron_vsync",(()=>{window.IPC.send("vsync",!xt("config_electron_vsync").classList.contains("checked")),Kt({msg:"changing HARD VSYNC MODE requires a full restart to go in effect. close TETR.IO, then reopen it.",color:"#FFC600",icon:"warning"}),xt("dirtyflag_client").innerHTML="DIRTY",xt("config_electron_vsync").classList.toggle("checked"),xt("config_electron_frameratelimit").classList.toggle("disable-cfg")})),Vs("config_electron_adblock",(()=>{it.electron.adblock=!xt("config_electron_adblock").classList.contains("checked"),it.electron.adblock&&(Di("one moment"),gn.get("/api/tetra/specialthanks").then((e=>{Oi();let t="";e.supporters.forEach((e=>{t+=`<a class="adblock_st ${e.username?`tetra_pop" data-hover="tap" data-hit="click" data-username="${e.username}"`:'noclick"'}>${e.flip?e.username.toUpperCase():e.name}</a>, `})),dn({title:"3RD PARTY ADS DISABLED",msg:`this toggle made possible by these generous supporters:</p><p>${t.slice(0,-2)}</p><p>please, consider supporting TETR.IO development!`,classes:["supporter_modal"],buttons:[{label:"NO",classes:[],callback:e=>{Pt(["trackEvent","Advertising","Block","Config toggle (no conversion)"]),e()}},{label:"SUPPORT!",classes:["pri"],callback:e=>{Pt(["trackEvent","Advertising","Block","Config toggle (converted)"]),e(),xi()}}]})}),(e=>{Pt(["trackEvent","Advertising","Block","Config toggle (could not load dialog)"]),Oi()})))}));for(const e of document.getElementsByClassName("bgmtweak_option"))e.addEventListener("click",(function(t){void 0===it.volume.bgmtweak&&(it.volume.bgmtweak={}),it.volume.bgmtweak[e.getAttribute("data-id")]=e.getAttribute("data-option"),_t(),bt()}));for(const e of document.getElementsByClassName("bgmtweak_header"))e.addEventListener("click",(function(t){na.PlayBgmSmoothlyWithRandom(e.getAttribute("data-id"))}));Vs("notifications_suppress",(()=>{it.notifications.suppress=!xt("notifications_suppress").classList.contains("checked")})),Vs("notifications_forcesound",(()=>{it.notifications.forcesound=!xt("notifications_forcesound").classList.contains("checked")})),Vs("notifications_online_off",(()=>{it.notifications.online="off"})),Vs("notifications_online_ingame",(()=>{it.notifications.online="ingame"})),Vs("notifications_online_both",(()=>{it.notifications.online="both"})),Vs("notifications_offline_off",(()=>{it.notifications.offline="off"})),Vs("notifications_offline_ingame",(()=>{it.notifications.offline="ingame"})),Vs("notifications_offline_both",(()=>{it.notifications.offline="both"})),Vs("notifications_dm_off",(()=>{it.notifications.dm="off"})),Vs("notifications_dm_ingame",(()=>{it.notifications.dm="ingame"})),Vs("notifications_dm_both",(()=>{it.notifications.dm="both"})),Vs("notifications_dm_pending_off",(()=>{it.notifications.dm_pending="off"})),Vs("notifications_dm_pending_ingame",(()=>{it.notifications.dm_pending="ingame"})),Vs("notifications_dm_pending_both",(()=>{it.notifications.dm_pending="both"})),Vs("notifications_invite_ingame",(()=>{it.notifications.invite="ingame"})),Vs("notifications_invite_both",(()=>{it.notifications.invite="both"})),Vs("notifications_other_ingame",(()=>{it.notifications.other="ingame"})),Vs("notifications_other_both",(()=>{it.notifications.other="both"}))})),__volOverlayTimeout=null,__volOverlayAllowLoudAfter=null;class Js{name="Unknown";icon="connect";_defaultConfirmButton="BUTTON_0";_defaultBackButton="BUTTON_1";_BUTTON_NAMES={BUTTON_0:"BTN BOTTOM",BUTTON_1:"BTN RIGHT",BUTTON_2:"BTN LEFT",BUTTON_3:"BTN TOP",BUTTON_4:"BTN LB",BUTTON_5:"BTN RB",BUTTON_6:"BTN LT",BUTTON_7:"BTN RT",BUTTON_8:"BTN SELECT",BUTTON_9:"BTN START",BUTTON_10:"BTN LS",BUTTON_11:"BTN RS",BUTTON_12:"D-PAD UP",BUTTON_13:"D-PAD DOWN",BUTTON_14:"D-PAD LEFT",BUTTON_15:"D-PAD RIGHT",AXIS_1_NEG:"L-STICK UP",AXIS_1_POS:"L-STICK DOWN",AXIS_0_NEG:"L-STICK LEFT",AXIS_0_POS:"L-STICK RIGHT",AXIS_3_NEG:"R-STICK UP",AXIS_3_POS:"R-STICK DOWN",AXIS_2_NEG:"R-STICK LEFT",AXIS_2_POS:"R-STICK RIGHT"};GetDefaultConfirmButton(){return this._defaultConfirmButton}GetDefaultBackButton(){return this._defaultBackButton}GetButtonName(e){return this._BUTTON_NAMES[e]??e}}const Zs=(()=>{const e=new Map,t=new Js;return{GetGamepadType:function(n){if(null==n)return t;const s=e.get(function(e){if("string"!=typeof e)throw new Error("Expected string, received "+typeof e);if("xinput"===e||e.includes("(XInput STANDARD GAMEPAD)"))return"xinput";const t="Vendor: ";if(e.includes(t)){const n=e.indexOf(t)+t.length;return e.substring(n,n+4)}if("-"===e[4]&&"-"===e[9])return e.substring(0,4)}(n.id));return s??t},RegisterGamepad:function(t,n){if(null!=e.get(t))throw new Error(`Attempted to register gamepad vendor id ${t} to resolver, but one already exists.`);e.set(t,n)}}})();class ei extends Js{name="Nintendo Switch";icon="controller_nintendo_switchpro";_defaultConfirmButton="BUTTON_1";_defaultBackButton="BUTTON_0";_BUTTON_NAMES={BUTTON_0:"BTN B",BUTTON_1:"BTN A",BUTTON_2:"BTN Y",BUTTON_3:"BTN X",BUTTON_4:"BTN L",BUTTON_5:"BTN R",BUTTON_6:"BTN ZL",BUTTON_7:"BTN ZR",BUTTON_8:"BTN -",BUTTON_9:"BTN +",BUTTON_10:"BTN L-STICK",BUTTON_11:"BTN R-STICK",BUTTON_12:"D-PAD UP",BUTTON_13:"D-PAD DOWN",BUTTON_14:"D-PAD LEFT",BUTTON_15:"D-PAD RIGHT",BUTTON_16:"BTN HOME",BUTTON_17:"BTN CAPTURE",AXIS_1_NEG:"L-STICK UP",AXIS_1_POS:"L-STICK DOWN",AXIS_0_NEG:"L-STICK LEFT",AXIS_0_POS:"L-STICK RIGHT",AXIS_3_NEG:"R-STICK UP",AXIS_3_POS:"R-STICK DOWN",AXIS_2_NEG:"R-STICK LEFT",AXIS_2_POS:"R-STICK RIGHT"}}Zs.RegisterGamepad("057e",new ei);class ti extends Js{name="Playstation";icon="controller_sony_dualshock4";_BUTTON_NAMES={BUTTON_0:"BTN CROSS",BUTTON_1:"BTN CIRCLE",BUTTON_2:"BTN SQUARE",BUTTON_3:"BTN TRIANGLE",BUTTON_4:"BTN L1",BUTTON_5:"BTN R1",BUTTON_6:"BTN L2",BUTTON_7:"BTN R2",BUTTON_8:"BTN SHARE",BUTTON_9:"BTN OPTIONS",BUTTON_10:"BTN L3",BUTTON_11:"BTN R3",BUTTON_12:"D-PAD UP",BUTTON_13:"D-PAD DOWN",BUTTON_14:"D-PAD LEFT",BUTTON_15:"D-PAD RIGHT",BUTTON_16:"BTN PS",BUTTON_17:"BTN TOUCHPAD",AXIS_1_NEG:"L-STICK UP",AXIS_1_POS:"L-STICK DOWN",AXIS_0_NEG:"L-STICK LEFT",AXIS_0_POS:"L-STICK RIGHT",AXIS_3_NEG:"R-STICK UP",AXIS_3_POS:"R-STICK DOWN",AXIS_2_NEG:"R-STICK LEFT",AXIS_2_POS:"R-STICK RIGHT"};GetDefaultConfirmButton(){return"ja"===navigator.language.substring(0,2)?"BUTTON_1":"BUTTON_0"}GetDefaultBackButton(){return"ja"===navigator.language.substring(0,2)?"BUTTON_0":"BUTTON_1"}}Zs.RegisterGamepad("054c",new ti);class ni extends Js{name="Xbox";icon="controller_microsoft_xboxone";_defaultConfirmButton="BUTTON_0";_defaultBackButton="BUTTON_1";_BUTTON_NAMES={BUTTON_0:"BTN A",BUTTON_1:"BTN B",BUTTON_2:"BTN X",BUTTON_3:"BTN Y",BUTTON_4:"BTN LB",BUTTON_5:"BTN RB",BUTTON_6:"BTN LT",BUTTON_7:"BTN RT",BUTTON_8:"BTN VIEW",BUTTON_9:"BTN MENU",BUTTON_10:"BTN LS",BUTTON_11:"BTN RS",BUTTON_12:"D-PAD UP",BUTTON_13:"D-PAD DOWN",BUTTON_14:"D-PAD LEFT",BUTTON_15:"D-PAD RIGHT",AXIS_1_NEG:"L-STICK UP",AXIS_1_POS:"L-STICK DOWN",AXIS_0_NEG:"L-STICK LEFT",AXIS_0_POS:"L-STICK RIGHT",AXIS_3_NEG:"R-STICK UP",AXIS_3_POS:"R-STICK DOWN",AXIS_2_NEG:"R-STICK LEFT",AXIS_2_POS:"R-STICK RIGHT"}}(()=>{const e=new ni;Zs.RegisterGamepad("xinput",e),Zs.RegisterGamepad("045e",e)})();const si=(()=>{let e=!1,t=!1;function n(){const e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[];for(let t=0;t<e.length;t++)if(e[t])return e[t]}window.addEventListener("gamepadconnected",(()=>{e=!0,function(){const e=Zs.GetGamepadType(n());ct.menuConfirm=[e.GetDefaultConfirmButton()],ct.menuBack=[e.GetDefaultBackButton()]}(),$s(),"custom"!==it.controls.style&&ft();const t=Zs.GetGamepadType(n());Kt({msg:`${t.name.toUpperCase()} controller connected`,color:"#6AFF3C",icon:t.icon}),a.Ticker.shared.add(r)})),window.addEventListener("gamepaddisconnected",(()=>{e=!1,Kt({msg:"controller disconnected",color:"#FF783C",icon:"disconnect"}),a.Ticker.shared.remove(r)})),window.addEventListener("keydown",(()=>{t=!1}),!0);const s={};let i=10,o=2;function r(a){if(!e)return;const r=n();for(let e=0;e<r.axes.length;e++){const n=`Axis_${e}_Pos`,l=r.axes[e]>(it.controls.sensitivity||.5),c=`Axis_${e}_Neg`,p=r.axes[e]<-1*(it.controls.sensitivity||.5);void 0!==s[n]&&s[n]!==l?(s[n]=l,i=10,o=2,t=!0,document.dispatchEvent(new CustomEvent("gp"+(l?"down":"up"),{detail:n}))):void 0===s[n]?s[n]=l:l&&(i>0?i-=a:o>0?o-=a:(o=2,t=!0,document.dispatchEvent(new CustomEvent("gprepeat",{detail:n,repeat:!0})))),void 0!==s[c]&&s[c]!==p?(s[c]=p,i=10,o=2,t=!0,document.dispatchEvent(new CustomEvent("gp"+(p?"down":"up"),{detail:c}))):void 0===s[c]?s[c]=p:p&&(i>0?i-=a:o>0?o-=a:(o=2,t=!0,document.dispatchEvent(new CustomEvent("gprepeat",{detail:c,repeat:!0}))))}for(let e=0;e<r.buttons.length;e++){const n=`Button_${e}`,l=r.buttons[e].value>(it.controls.sensitivity||.5);void 0!==s[n]&&s[n]!==l?(s[n]=l,i=10,o=2,t=!0,document.dispatchEvent(new CustomEvent("gp"+(l?"down":"up"),{detail:n}))):void 0===s[n]?s[n]=l:l&&(i>0?i-=a:o>0?o-=a:(o=2,t=!0,document.dispatchEvent(new CustomEvent("gprepeat",{detail:n,repeat:!0}))))}}return{getButtonNameForCurrentController:function(e){return Zs.GetGamepadType(n()).GetButtonName(e)},pulse:function(n,s,i){if(!e||!t)return;if(0==it.controls.vibration)return;const o=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[];let a;for(let e=0;e<o.length;e++)o[e]&&(a=o[e]);a.vibrationActuator&&a.vibrationActuator.playEffect&&a.vibrationActuator.playEffect("dual-rumble",{startDelay:0,duration:n,weakMagnitude:Math.min(1,(it.controls.vibration||1)*s),strongMagnitude:Math.min(1,(it.controls.vibration||1)*i)})},WEAK_GLIDE:[25,0,.15],WEAK_TAP:[50,0,.15],HARDDROP:[25,0,.2],CLEARLINE:[200,.3,.3],CLEARSPIN:[200,1,.3],CLEARQUAD:[300,.3,.6],CLEARB2B:[300,.6,.6],SPIN:[50,1,0],DAMAGE_SMALL:[150,.7,0],DAMAGE_MEDIUM:[250,.7,.7],DAMAGE_LARGE:[350,1,1],GARBAGERISE:[150,.5,0],CLEAR:[300,.5,1],TOPOUT:[500,.5,1],GARBAGESMASH:[500,1,1]}})(),ii=(()=>{let e={},t=!1,n=null,s=null,i=null,o=null;const r=[];function l(){const a=o!==i;if(o=i,a)for(const e of yt("[rg-hover]"))e.removeAttribute("rg-hover"),e.__rgBlur&&e.__rgBlur();if(!t||!e)return;if(!s||!i||null===i.offsetParent)return void n.classList.add("hidden");n.classList.remove("hidden");const r=i.getBoundingClientRect();n.style.left=`${r.left}px`,n.style.top=`${r.top}px`,n.style.width=`${r.width}px`,n.style.height=`${r.height}px`,n.classList.toggle("input",["input","textarea"].includes(document.activeElement.tagName.toLowerCase())),n.classList.toggle("noclick",i.classList.contains("noclick")),a&&(i.setAttribute("rg-hover",""),i.__rgFocus&&i.__rgFocus())}function c(e,t=null){const n=p(e);let s=Array.from(yt(n.selector));if(s=s.filter((e=>(null!==e.offsetParent||e.classList.contains("rb_bypass"))&&null===e.closest(".hidden"))),n.tags.includes("f")&&s.splice(1),n.tags.includes("l")&&s.splice(0,s.length-1),t&&n.tags.includes("n")){const e=s.indexOf(t);-1!==e&&s.length?s=[s[(e+1)%s.length]]:s.splice(1)}if(t&&n.tags.includes("p")){const e=s.indexOf(t);-1!==e&&s.length?s=[s[(e-1+s.length)%s.length]]:s.splice(0,s.length-1)}return s[0]||null}function p(e){const t=e.split("!");return 2===t.length?{tags:t[0].split(""),selector:t[1]}:{tags:[],selector:t[0]}}function d(t){let n,o=t;if(Array.isArray(t)){for(const e of t)if(n=c(e,i),n){o=e;break}if(!n)return void(s=t[0])}else if(n=c(t,i),!n)return void(s=t);i=n,s=function(t,n){const s=p(t);let i=Array.from(yt(s.selector));i=i.filter((e=>(null!==e.offsetParent||e.classList.contains("rb_bypass"))&&null===e.closest(".hidden")));const o=i.indexOf(n);let a=s.selector;return 0===o?a=`f!${s.selector}`:o===i.length-1&&(a=`l!${s.selector}`),e.items[a]?a:s.selector}(o,i),p(o).tags.includes("s")||function(e){const t=document.createElement("div");return t.classList.add("elgh"),t.style.left=`${e.offsetLeft}px`,t.style.top=`${e.offsetTop}px`,t.style.width=`${Math.max(0,Math.min(e.offsetParent.offsetWidth-e.offsetLeft-30,e.offsetWidth))}px`,t.style.height=`${e.offsetHeight}px`,e.offsetParent.appendChild(t),setTimeout((()=>{t.remove()}),1e3),t}(i).scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),i.getAttribute("data-hover")&&na.PlaySe(`menu${i.getAttribute("data-hover")}`)}function h(t){e=t,e.starter?d(e.starter):(s=null,i=null)}kn.ready((function(e){n=document.createElement("div"),n.id="ribbonglide",document.body.appendChild(n),a.Ticker.shared.add(l)}));let u=null;function _(e){if("none"===window.getComputedStyle(e,null).getPropertyValue("pointer-events"))return na.PlaySe("no"),n.classList.add("no"),null!==u&&clearTimeout(u),void setTimeout((()=>{n.classList.remove("no"),u=null}),100);si.pulse(...si.WEAK_TAP),na.PlaySe("ribbon_tap",.5),e.focus(),e.click()}return{push:()=>{r.push({guide:e,targeted:s,targetedElement:i})},pop:()=>{!function(){const t=r.pop();t&&(e=t.guide,s=t.targeted,i=t.targetedElement)}()},tryClick:e=>{_(e)},isEngaged:()=>t,engage:()=>{t=!0,document.body.classList.add("ribbonglide_engaged"),i&&(null===i.offsetParent&&!i.classList.contains("rb_bypass")||null!==i.closest(".hidden"))&&(d(s),i&&(null!==i.offsetParent||i.classList.contains("rb_bypass"))&&null===i.closest(".hidden")||d(e.starter))},disengage:()=>{t=!1,document.body.classList.remove("ribbonglide_engaged"),o=null;for(const e of yt("[rg-hover]"))e.removeAttribute("rg-hover"),e.__rgBlur&&e.__rgBlur()},bindGuide:e=>{h(e)},rebind:()=>{h(e)},action:n=>{!function(n){if(t&&!i&&d(s),t&&s&&e&&e.items&&void 0!==e.items[s])if(void 0===e.items[s][n]&&"confirm"===n&&i)_(i);else if(void 0===e.items[s][n]&&"back"===n&&e.back)_(At(e.back));else if(void 0!==e.items[s][n])if("string"==typeof e.items[s][n]||Array.isArray(e.items[s][n]))na.PlaySe("ribbon",.5),si.pulse(...si.WEAK_GLIDE),d(e.items[s][n]);else{const t=e.items[s][n](i);t&&(na.PlaySe("ribbon"),si.pulse(...si.WEAK_GLIDE),d(t))}}(n)}}})(),oi={home:{starter:"f!.scroller_item",back:"#exit_electron",items:{".scroller_item":{up:"p!.scroller_item",down:"n!.scroller_item"}}},play1p:{starter:"f!.scroller_item",back:"#back",items:{".scroller_item":{up:"p!.scroller_item",down:"n!.scroller_item"}}},"40l":{starter:"#start_40l",back:"#back",items:{"#start_40l":{left:"#music_picker_40l",right:"#music_picker_40l",up:"l!.checkbox",down:"f!.checkbox"},"#music_picker_40l":{left:"#start_40l",right:"#start_40l",up:"l!.checkbox",down:"f!.checkbox"},"f!.checkbox":{up:"#start_40l",down:"n!.checkbox"},"l!.checkbox":{up:"p!.checkbox",down:"#start_40l"},".checkbox":{up:"p!.checkbox",down:"n!.checkbox"}}},blitz:{starter:"#start_blitz",back:"#back",items:{"#start_blitz":{up:"l!.checkbox",down:"f!.checkbox"},"f!.checkbox":{up:"#start_blitz",down:"n!.checkbox"},"l!.checkbox":{up:"p!.checkbox",down:"#start_blitz"},".checkbox":{up:"p!.checkbox",down:"n!.checkbox"}}},zen:{starter:"#start_zen",back:"#back",items:{"#start_zen":{}}},custom:{starter:"#start_custom",back:"#back",items:{"#custom_export":{up:"l!.room_config_row",down:"#start_custom"},"#start_custom":{left:"#music_picker_custom",right:"#music_picker_custom",up:"#custom_export",down:"f!.room_tab"},"#music_picker_custom":{left:"#start_custom",right:"#start_custom",up:"#custom_export",down:"f!.room_tab"},".room_tab":{left:"p!.room_tab",right:"n!.room_tab",up:"#start_custom",down:"n!.room_config_row"},"f!.room_config_row":{up:"f!.room_tab",down:"n!.room_config_row",confirm:e=>{ii.tryClick(e.querySelector(".room_config_item"))}},"l!.room_config_row":{up:"p!.room_config_row",down:"#custom_export",confirm:e=>{ii.tryClick(e.querySelector(".room_config_item"))}},".room_config_row":{up:"p!.room_config_row",down:"n!.room_config_row",confirm:e=>{ii.tryClick(e.querySelector(".room_config_item"))}}}},about:{starter:"#about_line_logo",back:"#back",items:{"#about_line_logo":{up:"l!.scroller_item",down:"f!.credit_st"},".credit_st":{left:"p!.credit_st",right:"n!.credit_st",up:"#about_line_logo",down:"f!.scroller_item"},"f!.scroller_item":{up:"l!.credit_st",down:"n!.scroller_item"},"l!.scroller_item":{up:"p!.scroller_item",down:"#about_line_logo"},".scroller_item":{up:"p!.scroller_item",down:"n!.scroller_item"}}},playmulti:{starter:"f!.scroller_item",back:"#back",items:{"#multi_join":{up:"l!.scroller_item",down:"f!.scroller_item",confirm:e=>{ii.tryClick(e)}},"f!.scroller_item":{up:"#multi_join",down:"n!.scroller_item"},"l!.scroller_item":{up:"p!.scroller_item",down:"#multi_join"},".scroller_item":{up:"p!.scroller_item",down:"n!.scroller_item"}}},multilisting:{starter:"f!.room_listing_item",back:"#back",items:{".room_listing_item":{up:"p!.room_listing_item",down:"n!.room_listing_item"}}},lobby:{starter:"#roomid_container",back:"#leaveroom",items:{"#roomid_container":{up:"#room_opts_save",down:"f!.room_tab"},".room_tab":{left:"p!.room_tab",right:"n!.room_tab",up:"#roomid_container",down:"f!.room_config_row"},"f!.room_config_row":{up:"f!.room_tab",down:"n!.room_config_row",confirm:e=>{xt("roomview").classList.contains("hosting")&&ii.tryClick(e.querySelector(".room_config_item"))}},"l!.room_config_row":{up:"p!.room_config_row",down:"#room_opts_save",confirm:e=>{xt("roomview").classList.contains("hosting")&&ii.tryClick(e.querySelector(".room_config_item"))}},".room_config_row":{up:"p!.room_config_row",down:"n!.room_config_row",confirm:e=>{xt("roomview").classList.contains("hosting")&&ii.tryClick(e.querySelector(".room_config_item"))}},"#room_opts_save":{up:"l!.room_config_row",down:"#roomid_container",confirm:e=>{xt("roomview").classList.contains("hosting")&&ii.tryClick(e)}}}},victory:{starter:"f!.playerresult",back:"#backtoroom",items:{".playerresult":{up:"p!.playerresult",down:"n!.playerresult"}}},multilog:{starter:"f!.leagueplayer",back:"#back",items:{".leagueplayer":{up:"l!.multilog_result",down:"f!.multilog_result",left:"p!.leagueplayer",right:"n!.leagueplayer"},"f!.multilog_result":{up:"f!.leagueplayer",down:"n!.multilog_result"},"l!.multilog_result":{up:"p!.multilog_result",down:"f!.leagueplayer"},".multilog_result":{up:"p!.multilog_result",down:"n!.multilog_result"}}},league:{starter:"s!#enter_matchmaking",back:"#back",items:{"#enter_matchmaking":{up:"#league_tetra",down:"#league_tetra"},"#league_tetra":{up:"#enter_matchmaking",down:"#enter_matchmaking"}}},endleague:{starter:"f!.leagueplayer",back:"#backtoleague",items:{".leagueplayer":{up:"p!.leagueplayer",down:"n!.leagueplayer",left:"p!.leagueplayer",right:"n!.leagueplayer"}}},tetra:{starter:"#tetra_standalone",back:"#back",items:{"#tetra_find":{up:"l!#tetra_news_content a",down:"#tetra_standalone"},"#tetra_standalone":{up:"#tetra_find",down:"#tetra_leaderboards"},"#tetra_leaderboards":{up:"#tetra_standalone",down:"#tetra_me",left:"#tetra_me",right:"#tetra_players"},"#tetra_me":{up:"#tetra_leaderboards",down:"#tetra_achievements",left:"#tetra_players",right:"#tetra_players"},"#tetra_players":{up:"#tetra_leaderboards",down:"#tetra_achievements",left:"#tetra_me",right:"#tetra_me"},"#tetra_achievements":{up:"#tetra_me",down:"f!#tetra_news_content a",left:"#tetra_me",right:"#tetra_players"},"f!#tetra_news_content a":{up:"#tetra_me",left:"#tetra_achievements",down:"n!#tetra_news_content a",right:"n!#tetra_news_content a"},"l!#tetra_news_content a":{up:"p!#tetra_news_content a",left:"p!#tetra_news_content a",down:"#tetra_find",right:"#tetra_find"},"#tetra_news_content a":{up:"p!#tetra_news_content a",left:"p!#tetra_news_content a",down:"n!#tetra_news_content a",right:"n!#tetra_news_content a"}}},tetra_records:{starter:"f!.control_button",back:"#back",items:{".control_button":{up:"l!.record_item",down:"f!.record_item",left:"p!.control_button",right:"n!.control_button"},"f!.record_item":{up:"f!.control_button",down:"n!.record_item"},"l!.record_item":{up:"p!.record_item",down:"f!.control_button"},".record_item":{up:"p!.record_item",down:"n!.record_item"}}},tetra_me:{starter:"f!.control_button",back:"#back",items:{".control_button":{up:"l!.record_item",down:"f!.record_item",left:"p!.control_button",right:"n!.control_button"},"f!.record_item":{up:"f!.control_button",down:"n!.record_item"},"l!.record_item":{up:"p!.record_item",down:"f!.control_button"},".record_item":{up:"p!.record_item",down:"n!.record_item"}}},tetra_players:{starter:"f!.control_button",back:"#back",items:{".control_button":{up:"l!.record_item",down:"f!.record_item",left:"p!.control_button",right:"n!.control_button"},"f!.record_item":{up:"f!.control_button",down:"n!.record_item"},"l!.record_item":{up:"p!.record_item",down:"f!.control_button"},".record_item":{up:"p!.record_item",down:"n!.record_item"}}},tetra_achievements:{starter:"f!.achievement",back:"#back",items:{".achievement":{up:"p!.achievement",down:"n!.achievement",left:"p!.achievement",right:"n!.achievement"}}},results:{starter:"f!.rg_target_pri",back:"#back",items:{".rg_target_pri":{up:"p!.rg_target_pri",left:"p!.rg_target_pri",down:"n!.rg_target_pri",right:"n!.rg_target_pri"}}},zenith:{starter:"f!.rg_target_start_zenith",items:{".menuslide_rollup":{up:"l!.rg_target_pri",down:["f!.rg_target_top",".rg_target_start_zenith"]},".rg_target_top":{up:"l!.menuslide_rollup",left:"p!.rg_target_top",right:"n!.rg_target_top",down:"f!.rg_target_start_zenith"},".rg_target_start_zenith":{up:["l!.rg_target_top",".menuslide_rollup"],down:"ls!.zenith_card"},".zenith_card":{up:"f!.rg_target_start_zenith",left:"ns!.zenith_card",down:"f!.rg_target_pri",right:"ps!.zenith_card"},"f!.rg_target_pri":{up:"ls!.zenith_card",left:"p!.rg_target_pri",down:"n!.rg_target_pri",right:"n!.rg_target_pri"},"l!.rg_target_pri":{up:"p!.rg_target_pri",left:"p!.rg_target_pri",down:"f!.menuslide_rollup",right:"n!.rg_target_pri"},".rg_target_pri":{up:"p!.rg_target_pri",left:"p!.rg_target_pri",down:"n!.rg_target_pri",right:"n!.rg_target_pri"}}},config:{starter:"f!.rg_target_pri",back:"#back",items:{".rg_target_pri":{up:"p!.rg_target_pri",down:"n!.rg_target_pri",left:e=>{if("range"!==e.getAttribute("type"))return"p!.rg_target_pri";{let t=parseFloat(e.getAttribute("step"))||1;e.classList.contains("range_reversed")||(t*=-1),e.value=Math.min(parseFloat(e.getAttribute("max")),Math.max(parseFloat(e.getAttribute("min")),parseFloat(e.value)+t)),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))}},right:e=>{if("range"!==e.getAttribute("type"))return"n!.rg_target_pri";{let t=parseFloat(e.getAttribute("step"))||1;e.classList.contains("range_reversed")&&(t*=-1),e.value=Math.min(parseFloat(e.getAttribute("max")),Math.max(parseFloat(e.getAttribute("min")),parseFloat(e.value)+t)),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))}}}}},config_account:{starter:"f!.rg_target_pri",back:"#back",items:{".rg_target_pri":{up:"p!.rg_target_pri",down:"n!.rg_target_pri",left:"p!.rg_target_pri",right:"n!.rg_target_pri"}}},config_bgmtweak:{starter:"f!.rg_target_pri",back:"#back",items:{".rg_target_pri":{up:"p!.rg_target_pri",down:"n!.rg_target_pri",left:"p!.rg_target_pri",right:"n!.rg_target_pri"}}},config_electron:{starter:"f!.rg_target_pri",back:"#back",items:{".rg_target_pri":{up:"p!.rg_target_pri",down:"n!.rg_target_pri",left:"p!.rg_target_pri",right:"n!.rg_target_pri"}}},list_request:{starter:"f!#list_request .scroller_item",back:"#list_request_back",items:{"#list_request .scroller_item":{up:"p!#list_request .scroller_item",down:"n!#list_request .scroller_item"}}},tetra_dialog:{starter:".tetra_modal_close",back:".tetra_modal_close",items:{".tetra_modal_close":{up:"l!.tetra_button",down:"f!.tetra_button"},".tetra_button":{up:".tetra_modal_close",down:".tetra_modal_close",left:"p!.tetra_button",right:"n!.tetra_button"}}},dialog:{starter:"f!.oob_button",items:{".oob_button":{left:"p!.oob_button",right:"n!.oob_button"}}},social:{starter:"f!.oob_button",items:{".oob_button":{left:"p!.oob_button",right:"n!.oob_button"}}}};function ai(){dn({title:"DELETE YOUR ACCOUNT?",msg:`delete your account <span class="inline_self">${xt("config_account_username_field").value}</span> and all attached data?</p><p class="modal_also">this cannot be undone.`,classes:["crash_modal"],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"DELETE!",classes:["pri"],callback:e=>{e(),ri()}}]})}function ri(){dn({title:"DELETE YOUR ACCOUNT?",msg:`no seriously, are you sure you want to delete <span class="inline_self">${xt("config_account_username_field").value}</span> and EVERYTHING INVOLVED, like your replays, badges, XP, rating, etc?</p><p class="modal_also">you can never get it back!!!`,classes:["crash_modal","shudder"],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"DELETE!!!",classes:["pri"],callback:e=>{e(),li()}}]})}function li(){dn({title:`DELETING ${xt("config_account_username_field").value}`,msg:'please type your username<br><input class="usernamelike" data-escape="account_delete_cancel" data-enter="account_delete_submit" id="account_delete" placeholder="YOUR USERNAME" value="">',buttons:[{label:"CANCEL",classes:[],id:"account_delete_cancel",callback:e=>{e()}},{label:"SUBMIT",classes:["pri"],id:"account_delete_submit",callback:e=>{e(),xt("account_delete").value.toUpperCase()===xt("config_account_username_field").value?ci():Yt("wrong username - deletion aborted")}}]}),xt("account_delete").focus()}function ci(){mn.requestPassword(((e,t)=>{Di("requesting deletion"),gn.post("/api/users/requestDeletion",{password:e,totp:t}).then((e=>{Zt("an email has been sent with further instructions!"),Oi()}),(e=>{Oi(),en(e)}))}))}let pi,di=0,hi="z",ui=-1;const _i={none:{back:null,header:"HOME",footer:"pick a game mode"},home:{back:null,header:"HOME",footer:'welcome to <span class="cheeky">TETRIO</span>!',onenter:()=>{na.PlayBgmSmoothly(document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")?"touhoudaiensei":"kuchu-toshi"),document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")||Mr("online","menus"),Ps.mount("home-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Homebanner")},onreenter:()=>{Ps.mount("home-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Homebanner")},onexit:()=>{Ps.unmount("home-lb"),Ps.unmount("menus-persistent-mpu",!0)}},about:{back:"home",header:"ABOUT",footer:'thank you for playing <span class="cheeky">TETRIO</span>!',onenter:()=>{na.PlayBgmSmoothly(document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")?"touhoudaiensei":"kuchu-toshi"),ia.loadSpecialThanks(),document.addEventListener("keydown",sa.UnlockerKeyDown),document.addEventListener("keyup",sa.UnlockerKeyUp)},onexit:()=>{document.removeEventListener("keydown",sa.UnlockerKeyDown),document.removeEventListener("keyup",sa.UnlockerKeyUp)}},play1p:{back:"home",header:"SOLO",footer:"pick a game mode",onenter:()=>{xt("zen_count").innerHTML=Rs.getZen().level,Ps.mount("solo-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Solo Home Menu")},onreenter:()=>{Ps.mount("solo-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Solo Home Menu")},onexit:()=>{Ps.unmount("solo-lb"),Ps.unmount("menus-persistent-mpu",!0)}},playmulti:{back:"home",header:"MULTIPLAYER",footer:"pick a game mode",onback:()=>{document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")||Sa.unrequire()},onenter:()=>{na.PlayBgmSmoothly(document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")?"touhoudaiensei":"kuchu-toshi"),gn.get("/api/rooms/menu").then((e=>{xt("quickplay_players").innerHTML=`${e.quickplay.playing}${e.quickplay.total-e.quickplay.playing?`<span class="room_listing_spectators">+${e.quickplay.total-e.quickplay.playing}</span>`:""}`,xt("quickplay_players").classList.toggle("empty",!e.quickplay.playing),xt("royale_players").innerHTML=`${e.royale.playing}${e.royale.total-e.royale.playing?`<span class="room_listing_spectators">+${e.royale.total-e.royale.playing}</span>`:""}`,xt("royale_players").classList.toggle("empty",!e.royale.playing),xt("room_count").innerHTML=`${e.roomcount}`,xt("room_count").classList.toggle("empty",!e.roomcount),xt("room_count").classList.toggle("singular",1===e.roomcount)}),(e=>{xt("quickplay_players").innerHTML="0",xt("quickplay_players").classList.add("empty"),xt("royale_players").innerHTML="0",xt("royale_players").classList.add("empty")})),document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")||Mr("online","menus"),Ps.mount("multiplayer-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Multiplayer Home Menu")},onreenter:()=>{Ps.mount("multiplayer-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Multiplayer Home Menu")},onexit:()=>{Ps.unmount("multiplayer-lb"),Ps.unmount("menus-persistent-mpu",!0)}},multilisting:{back:"playmulti",header:"MULTIPLAYER / ROOM LISTING",footer:"pick a room to join!",onenter:()=>{Oa.loadListing(),xt("roomlisting_scroller").scrollTop=0,Ps.mount("menus-persistent-mpu",!0)},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},lobby:{back:null,header:"",footer:"",onenter:()=>{xt("room_chat").scrollTop=xt("room_chat").scrollHeight+100,Ps.mount(Ea&&"X-QP"===Ea?"sysroom-mpu":"lobby-lb"),Ht(Ea&&"X-QP"===Ea?"Quick Play Lobby":"Custom Room Lobby")},onreenter:()=>{Ps.mount(Ea&&"X-QP"===Ea?"sysroom-mpu":"lobby-lb")},onexit:()=>{Ps.unmount("sysroom-mpu"),Ps.unmount("lobby-lb")}},victory:{back:null,header:"RESULTS",footer:"the results are in!",onenter:()=>{na.PlayBgmSmoothly("aijin-sanka"),xt("victoryview").scrollTop=-200,xt("vvsc").scrollTop=-200,Ps.mount("roomresults-lb"),Ht("Multiplayer Results")},onreenter:()=>{Ps.mount("roomresults-lb"),Ht("Multiplayer Results")},onexit:()=>{Ps.unmount("roomresults-lb")}},multilog:{back:"home",header:"RESULTS",footer:"the results are in!"},league:{back:"playmulti",header:"TETRA LEAGUE",footer:"face off against others and rise up through the ranks!",onenter:()=>{na.PlayBgmSmoothly("touhoudaiensei"),xt("leagueview").scrollTop=0,bi(),Ps.mount("league-lb"),Ht("League Home"),Sa?.emit("channel.subscribe","league.counts")},onreenter:()=>{Ps.mount("league-lb"),Ht("League Home"),Sa?.emit("channel.subscribe","league.counts")},onexit:()=>{Ps.unmount("league-lb"),Sa?.emit("channel.unsubscribe","league.counts")}},endleague:{back:null,header:"TETRA LEAGUE / RESULTS",footer:"the results are in!",onenter:()=>{xt("league_chat").scrollTop=xt("league_chat").scrollHeight+100,Ht("League Results")}},tetra:{back:"home",header:"TETRA CHANNEL",footer:"welcome to TETRA CHANNEL!",onenter:()=>{na.PlayBgmSmoothly(document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")?"touhoudaiensei":"shikiichi-made-mousukoshi"),ia.loadNews(),ia.loadTwitch(),Ht("Tetra Home"),Ps.mount("menus-persistent-mpu",!0)},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},tetra_records:{back:"tetra",header:"TETRA CHANNEL / LEADERBOARDS",footer:"top the global leaderboards!",onenter:()=>{"null"!==document.body.dataset.country&&"no"===document.body.dataset.countryHidden?(At('.tetra_records_scale[data-value="country"]').classList.remove("hidden"),At('.tetra_records_scale[data-value="country"]').textContent=Wn[document.body.dataset.country].length>=22?Wn[document.body.dataset.country].toLowerCase():Wn[document.body.dataset.country].toUpperCase()):At('.tetra_records_scale[data-value="country"]').classList.add("hidden"),Ps.mount("menus-persistent-mpu",!0),(xt("tetra_records")._lastAutoUpdate||0)>=Date.now()-6e5||(xt("tetra_records")._lastAutoUpdate=Date.now(),ia.loadRecords("40l","global","tetra_records"),yt(".tetra_records_gamemode").forEach((e=>{e.classList.remove("pressed"),e.classList.remove("active")})),yt(".tetra_records_scale").forEach((e=>{e.classList.remove("pressed"),e.classList.remove("active")})),At('.tetra_records_gamemode[data-value="40l"]').classList.add("pressed"),At('.tetra_records_gamemode[data-value="40l"]').classList.add("active"),At('.tetra_records_scale[data-value="global"]').classList.add("pressed"),At('.tetra_records_scale[data-value="global"]').classList.add("active"),xt("tetra_records_view").dataset.gamemode="40l")},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},tetra_me:{back:"tetra",header:"TETRA CHANNEL / ME",footer:"track your progression!",onenter:()=>{Ps.mount("menus-persistent-mpu",!0),(xt("tetra_myrecords")._lastAutoUpdate||0)>=Date.now()-6e5||(xt("tetra_myrecords")._lastAutoUpdate=Date.now(),ia.loadRecords("any","me","tetra_myrecords"),yt(".tetra_myrecords_gamemode").forEach((e=>{e.classList.remove("pressed"),e.classList.remove("active")})),At('.tetra_myrecords_gamemode[data-value="any"]').classList.add("pressed"),At('.tetra_myrecords_gamemode[data-value="any"]').classList.add("active"))},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},tetra_players:{back:"tetra",header:"TETRA CHANNEL / PLAYERS",footer:"view other players and their achievements!",onenter:()=>{"null"!==document.body.dataset.country&&"no"===document.body.dataset.countryHidden?(At('.tetra_players_scale[data-value="country"]').classList.remove("hidden"),At('.tetra_players_scale[data-value="country"]').textContent=Wn[document.body.dataset.country].length>=22?Wn[document.body.dataset.country].toLowerCase():Wn[document.body.dataset.country].toUpperCase()):At('.tetra_players_scale[data-value="country"]').classList.add("hidden"),Ps.mount("menus-persistent-mpu",!0),(xt("tetra_players")._lastAutoUpdate||0)>=Date.now()-6e5||(xt("tetra_players")._lastAutoUpdate=Date.now(),ia.loadUserList("league","global","tetra_players_content"),yt(".tetra_players_lb").forEach((e=>{e.classList.remove("pressed"),e.classList.remove("active")})),yt(".tetra_players_scale").forEach((e=>{e.classList.remove("pressed"),e.classList.remove("active")})),At('.tetra_players_lb[data-value="league"]').classList.add("pressed"),At('.tetra_players_lb[data-value="league"]').classList.add("active"),At('.tetra_players_scale[data-value="global"]').classList.add("pressed"),At('.tetra_players_scale[data-value="global"]').classList.add("active"))},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},tetra_achievements:{back:"tetra",header:"TETRA CHANNEL / ACHIEVEMENTS",footer:"view your achievement progress!",onenter:()=>{ia.loadAchievements()},onexit:()=>{xt("tetra_achievements_page").classList.remove("editing"),xt("tetra_achievements_page").dataset.editing=""}},"40l":{back:"play1p",header:"40 LINES",footer:"press START to begin playing",onenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},blitz:{back:"play1p",header:"BLITZ",footer:"press START to begin playing",onenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},zen:{back:"play1p",header:"ZEN",footer:"press START to begin playing",onenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},custom:{back:"play1p",header:"CUSTOM",footer:"press START to begin playing",onenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onreenter:()=>{Ps.mount("menus-persistent-mpu",!0)},onexit:()=>{Ps.unmount("menus-persistent-mpu",!0)}},results:{back:"home",header:"RESULTS",footer:"GAME TYPE: the results are in!",onenter:()=>{xt("results_stats_set_overview").classList.add("pressed"),xt("results_stats_set_full").classList.remove("pressed"),xt("results_stats_overview").classList.remove("hidden"),xt("results_stats_full").classList.add("hidden"),Ps.mount("soloresults-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Solo Results")},onreenter:()=>{Ps.mount("soloresults-lb"),Ps.mount("menus-persistent-mpu",!0),Ht("Solo Results")},onexit:()=>{Ps.unmount("soloresults-lb"),Ps.unmount("menus-persistent-mpu",!0)}},config:{back:"home",header:"CONFIG",footer:'tweak your settings for a better <span class="cheeky">TETRIO</span> experience'},config_account:{back:"config",header:"CONFIG / ACCOUNT",footer:'change settings in your <span class="cheeky">TETRIO</span> account'},config_account_orders:{back:"config_account",header:"CONFIG / ACCOUNT / ORDERS",footer:"view past orders for your account"},config_bgmtweak:{back:"config",header:"CONFIG / BGM TWEAKER",footer:"change how often some songs play"},config_electron:{back:"config",header:'CONFIG / <span class="cheeky">TETRIO</span> DESKTOP',footer:'change <span class="cheeky">TETRIO</span> DESKTOP settings'},zenith:{back:null,header:"QUICK PLAY",footer:"scale the tower!",onenter:()=>{Ht("Quick Play")}}};let mi="none";function gi(e,t,n,s,i,o,a){dn({title:e,msg:`${t}<br><input data-escape="request_number_cancel" data-enter="request_number_submit" id="request_number" type="number" placeholder="NUMBER" autocomplete="off" value="${o}" step="${i}" min="${n}" max="${s}">`,buttons:[{label:"CANCEL",classes:[],id:"request_number_cancel",callback:e=>{e()}},{label:"SUBMIT",classes:["pri"],id:"request_number_submit",callback:e=>{a(xt("request_number").value),e()}}]}),xt("request_number").focus()}function fi(e,t,n,s){dn({title:e,msg:`${t}<br><span style="font-family: 'PFW'; font-size: 1.35em;">#</span><input data-escape="request_roomid_cancel" data-enter="request_roomid_submit" id="request_roomid" placeholder="ROOM ID" autocomplete="off" value="${n}" minlength="1" maxlength="16" class="mono_input usernamelike" style="width: calc(100% - 1.5em); margin-left: 0.2em;">`,buttons:[{label:"CANCEL",classes:[],id:"request_roomid_cancel",callback:e=>{e()}},{label:"SUBMIT",classes:["pri"],id:"request_roomid_submit",callback:e=>{s(xt("request_roomid").value),e()}}]}),xt("request_roomid").focus()}function bi(){"league"!==mi||xt("menus").classList.contains("hidden")||$i<1||gn.get("/api/rooms/league").then((e=>{if(xt("mm_queuecount_count").innerHTML=e.info.queue,xt("mm_playercount_count").innerHTML=e.info.players,e.info.avgTimes){const t=Math.round(e.info.avgTimes/1e3);xt("mm_avgtime_time").innerHTML=t<=60?`${t} <span>SECOND${1===t?"":"S"}</span>`:t<120?`1 <span>MINUTE</span> ${t-60} <span>SECOND${t-60==1?"":"S"}</span>`:t<600?`${Math.round(t/60)} <span>MINUTES</span>`:"10+ <span>MINUTES</span>",xt("mm_avgtime").classList.remove("hidden")}else xt("mm_avgtime").classList.add("hidden")}),(e=>{xt("mm_queuecount_count").innerHTML="0",xt("mm_playercount_count").innerHTML="0",xt("mm_avgtime").classList.add("hidden")}))}function Ci(){return!document.body.classList.contains("supporter")&&(!document.body.classList.contains("staff")&&(xi("THIS ACTION REQUIRES SUPPORTER"),!0))}function xi(e="SUPPORT TETR.IO",t=void 0){if(_.novault)return void Yt("purchases are disabled on this installation");dn({title:e,msg:`</p><div class="dialog_long">\n\t\t\t\t<p class="supporter_bumper">\n\t\t\t\t\tEver since starting TETR.IO back in February of 2019, I've always tried running it in a way I feel is fair. While it may be an .io-game, I don't want to go down the path of other such games. I want to pride myself on my game, not on my bottom line. TETR.IO will always be <b>free-to-win</b>, with monetization being optional for all players. Please help me sustain this goal, by supporting me, and get some cool benefits! While they won't improve your skill, they might make you stand out among friends, and rep your support! \n\t\t\t\t\t<span class="supporter_bumper_footer">&mdash; osk, founder and developer of TETR.IO</span>\n\t\t\t\t</p>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-duo.png" />play <span>DUO QUICK PLAY</span>, a co-op quick play climb (only one player needs supporter)</div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-badge.png" />show off with a very special <span>profile badge</span></div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-customize.png" />customize your profile with a <span>profile banner</span> and <span>about me</span> section</div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-amend.png" />easily <span>change your username</span> once a month and <span>change your country</span> on demand</div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-emotes.png" />get access to <span>exclusive supporter emotes</span></div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-vanityroom.png" />set a <span>custom room ID</span> on your public and private rooms</div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-friends.png" />have up to <span>500 friends</span>, up from 50</div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-discordrole.png" />get an exclusive <span>supporter role</span> in the discord</div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-ads.png" />hide all <span>ads</span> from the game and tetra channel</div>\n\t\t\t\t<div class="supporter-perk"><img src="/res/supporter-perk-love.png" />and get that warm feeling of <span>supporting a project you love</span></div>\n\t\t\t\t<div class="supporter_payment_block">\n\t\t\t\t\t<p>TETR.IO Supporter is a <b>non-recurring payment</b>. If you buy it while still being a supporter, it will extend the duration of your existing supporter status.</p>\n\t\t\t\t\t<div class="checkbox minor_checkbox ${t?"checked":""}" id="supporter_payment_block_gift">Gift to other player(s)</div>\n\t\t\t\t\t<input placeholder="the recipients' usernames, separated by spaces" id="supporter_payment_block_recipient" autocomplete="off" class="minor_input usernamelike" value="${t?St(t).toLowerCase():""}">\n\t\t\t\t\t<input type="range" min="1" max="24" value="${t?"1":"3"}" class="minor_range" id="supporter_payment_block_duration">\n\t\t\t\t\t<div class="supporter_payment_price" id="supporter_payment_price">\n\t\t\t\t\t\t<div>3 months</div>\n\t\t\t\t\t\t15\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="supporter_payment_custom" id="supporter_payment_custom">...or pick a custom length (up to 1200 months)</div>\n\t\t\t\t\t<p class="supporter_payment_also">will be converted to your local currency on payment</p>\n\t\t\t\t</div>\n\t\t\t</div><p>`,classes:["supporter_modal"],buttons:[{label:"BACK",classes:[],callback:e=>{e()}},{label:"SUPPORT!",classes:["pri"],callback:e=>{const t=xt("supporter_payment_block_recipient").value.toLowerCase().replace(/,/g,"").replace(/\s+/g," ").trim().split(" "),n=xt("supporter_payment_block_gift").classList.contains("checked"),s=n&&t.length>1?1:Math.max(1,Math.min(1200,parseInt(xt("supporter_payment_block_duration").value)));to("supporter",{months:s,price:(n?t.length:1)*(Math.min(_.catalog.supporter.bulk_after,s)*(n?_.catalog.supporter.price_gift:_.catalog.supporter.price))+Math.max(0,s-_.catalog.supporter.bulk_after)*(n?_.catalog.supporter.price_gift_bulk:_.catalog.supporter.price_bulk),isgift:n,recipients:n?t:void 0},(()=>{e()}))}}]});const n=()=>{const e=xt("supporter_payment_block_gift").classList.contains("checked"),t=e?xt("supporter_payment_block_recipient").value.toLowerCase().replace(/,/g,"").replace(/\s+/g," ").trim().split(" ").length:1,n=t>1?1:Math.max(1,Math.min(1200,parseInt(xt("supporter_payment_block_duration").value))),s=t*(Math.min(_.catalog.supporter.bulk_after,n)*(e?_.catalog.supporter.price_gift:_.catalog.supporter.price))+Math.max(0,n-_.catalog.supporter.bulk_after)*(e?_.catalog.supporter.price_gift_bulk:_.catalog.supporter.price_bulk),i=t*(Math.min(_.catalog.supporter.normal_bulk_after,n)*(e?_.catalog.supporter.normal_price_gift:_.catalog.supporter.normal_price))+Math.max(0,n-_.catalog.supporter.normal_bulk_after)*(e?_.catalog.supporter.normal_price_gift_bulk:_.catalog.supporter.normal_price_bulk),o=t*n*_.catalog.supporter.price,a=t*n*_.catalog.supporter.normal_price,r=parseInt(xt("supporter_payment_block_duration").getAttribute("max"));xt("supporter_payment_block_duration").style.background=`linear-gradient(to right, #FFF 0%, #FFF ${(n-1)/(r-1)*100}%, #000A ${(n-1)/(r-1)*100}%, #000A 100%)`,xt("supporter_payment_block_duration").style.display=t>1?"none":"inline-block",xt("supporter_payment_custom").style.display=t>1?"none":"inline-block",xt("supporter_payment_price").innerHTML=t>1?`<div>${t} recipients</div>${s!==i?`<span class="slashed_price">${i%1==0?i:i.toFixed(2)}</span> `:""}${s%1==0?s:s.toFixed(2)}${s!==i?` <span class="offer special">${Math.round(100*(1-s/i))}% OFF!</span>`:""}${s!==o?` <span class="offer">save ${Math.round(100*(1-s/a))}% ${s!==i?"in total ":""}by ${e?"gifting":"buying in bulk"}</span>`:""}`:`<div>${n} month${1===n?"":"s"}${n>=12?` <span>(${Math.floor(n/12)} year${1===Math.floor(n/12)?"":"s"}${n%12==0?"":`, ${n%12} month${n%12==1?"":"s"}`})</span>`:""}</div>${s!==i?`<span class="slashed_price">${i%1==0?i:i.toFixed(2)}</span> `:""}${s%1==0?s:s.toFixed(2)}${s!==i?` <span class="offer special">${Math.round(100*(1-s/i))}% OFF!</span>`:""}${s!==o?` <span class="offer">save ${Math.round(100*(1-s/a))}% ${s!==i?"in total ":""}by ${e?"gifting":"buying in bulk"}</span>`:""}`,1===n&&xt("supporter_payment_block_duration").setAttribute("max",24)};n(),xt("supporter_payment_block_gift").addEventListener("click",(()=>{xt("supporter_payment_block_gift").classList.toggle("checked"),n()})),xt("supporter_payment_block_duration").addEventListener("input",(()=>{n()})),xt("supporter_payment_block_recipient").addEventListener("keyup",(()=>{n()})),xt("supporter_payment_custom").addEventListener("click",(()=>{gi("CUSTOM LENGTH","enter an amount of months (max: 1200)",1,1200,1,xt("supporter_payment_block_duration").value,(e=>{e=Math.max(1,Math.min(1200,parseInt(e))),xt("supporter_payment_block_duration").setAttribute("max",Math.max(24,e)),xt("supporter_payment_block_duration").value=e,n()}))}))}function Ai(e,t){if("supporter"===e)dn({title:t.isgift?"THANK YOU FOR GIFTING!":"THANK YOU FOR SUPPORTING!",msg:`</p>\n\t\t\t\t\t\t<center>\n\t\t\t\t\t\t\t<img src="/res/supporter-tag-shiny.png" />\n\t\t\t\t\t\t\t<p>${t.isgift?`YOUR GIFT HAS BEEN SENT TO <b>${t.recipients.length>1?`ALL ${t.recipients.length} LUCKY PLAYERS`:St(t.recipients[0].toUpperCase())}</b>!`:document.body.classList.contains("supporter_at_launch")?"YOUR SUPPORTER STATUS HAS BEEN EXTENDED!":"YOU ARE NOW A TETR.IO SUPPORTER!"}</p>\n\t\t\t\t\t\t</center>\n\t\t\t\t\t\t<p class="supporter_bumper">Thank you very, <b>very</b> much for ${t.isgift?"gifting Supporter":"supporting"} &mdash; ${t.isgift?"their benefits should be applied instantly":document.body.classList.contains("supporter_at_launch")?"your tag has been extended":"your benefits should be applied instantly"}. With your support, I can keep developing TETR.IO as we both love it. ${t.isgift?"You're awesome!":document.body.classList.contains("supporter_at_launch")?"Stay awesome!":"You're awesome!"}<span class="supporter_bumper_footer">&mdash; osk</span></p>\n\t\t\t\t\t<p>`,classes:["supporter_modal"],buttons:[{label:"CLOSE",classes:[],callback:e=>{e()}}]}),na.PlaySe("supporter"),t.isgift||(document.body.classList.add("supporter"),document.body.classList.add("ceriad_exempt"),document.body.classList.add("ceriad_disabled"),Ps.unmountAll(),localStorage.setItem("wasLastSupporter","Yes, that's it!"),document.cookie=`ceriad_exempt=1;max-age=31536000;domain=${_.domain}`,qi.expires=qi.hasSupporter?qi.expires+1e3*t.months*3600*24*30.5:Date.now()+1e3*t.months*3600*24*30.5,qi.hasSupporter=!0),qi.total=qi.total?qi.total+t.price:t.price,Yi()}function yi(e,t){const n=document.createElement("input");document.body.appendChild(n),n.value=e,n.select(),document.execCommand("copy"),document.body.removeChild(n),Kt(`${t||`"${e}"`} copied!`)}function vi(e,t){const n=document.createElement("div");n.className=`shout ${e}`,n.innerText=t,xt("majorshouts").appendChild(n),setTimeout((()=>{n.remove()}),5e3),"ultra"===it.video.graphics&&pl&&L.majorShoutStyles[e]&&L.majorShoutStyles[e]()}function Bi(e){if(!it.volume.music)return;const t=xt("now_playing"),n=xt("now_playing_jp");t.innerHTML=`${Zo[e].artist.toUpperCase()} - ${Zo[e].name.toUpperCase()}`,n.innerHTML=`${Zo[e].untranslatedArtist} - ${Zo[e].untranslatedName}`,t.classList.remove("hidden"),null!=Zo[e].untranslatedArtist&&null!=Zo[e].untranslatedName&&n.classList.remove("hidden"),setTimeout((()=>{t.classList.add("hidden"),n.classList.add("hidden")}),5e3)}function wi(e){xt("menus").setAttribute("data-menu-type",e)}function Li(e,t){(_i[mi].onexit||(()=>{}))(),mi=e,xt("menus").querySelectorAll("[data-menuview]").forEach((t=>{t.getAttribute("data-menuview")!==e&&(t.classList.contains("hidden")||(t.classList.add("hidden"),setTimeout((()=>{t.classList.contains("hidden")&&t.classList.add("thidden")}),666)))})),_i[e].back||xt("back").classList.add("hidden"),xt("exit_electron").classList.toggle("hidden","home"!==e);const n=()=>{xt("menus").setAttribute("data-menu-type",e),xt("menus").querySelectorAll("[data-menuview]").forEach((t=>{t.getAttribute("data-menuview")===e&&(t.classList.remove("thidden"),t.getBoundingClientRect(),t.classList.remove("hidden"))})),_i[e].back&&xt("back").classList.remove("hidden"),xt("header_text").innerHTML=_i[e].header,xt("footer_text").innerHTML=_i[e].footer,(_i[e].onenter||(()=>{}))()};t?Ri(n):n(),ii.bindGuide(oi[e]||{})}kn.ready((function(e){let t;Si(!0),Li("home"),xt("insiders_upsell_hide").addEventListener("click",(()=>{xt("insiders_upsell").classList.add("hiding"),localStorage.setItem("x_insiders_upsell_hidden","Yes..."),setTimeout((()=>{xt("insiders_upsell").classList.add("hidden")}),800)})),xt("roomlisting_refresh").addEventListener("click",(()=>{Oa.loadListing(),xt("roomlisting_scroller").scrollTop=0})),xt("back").addEventListener("click",(function(e){_i[mi].back&&((_i[mi].onback||(()=>{}))(),Li(_i[mi].back))})),xt("exit_electron").addEventListener("click",(function(e){window.IS_ELECTRON&&dn({title:"EXIT TETR.IO?",msg:"",buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"EXIT",classes:["pri"],callback:e=>{Pi(),Di("see you next time!"),Is()}}]})})),xt("volume_tweak").addEventListener("click",(function(e){Li("config_bgmtweak")})),xt("config_electron").addEventListener("click",(function(e){window.IS_ELECTRON&&(xt("electron_ver").innerHTML=CLIENT_VERSION,window.EMERGENCY_MODE&&xt("config_electron_emergency").classList.remove("hidden"),xt("electron_frameratelimit_1x").innerHTML=1*(window.REFRESH_RATE||60)+" fps",xt("electron_frameratelimit_2x").innerHTML=2*(window.REFRESH_RATE||60)+" fps",xt("electron_frameratelimit_4x").innerHTML=4*(window.REFRESH_RATE||60)+" fps",xt("config_electron_vsync").classList.toggle("checked",!!window.VSYNC_ON),xt("config_electron_vsync").classList.toggle("hidden",!!window.VSYNC_LOCKED_ON),xt("config_electron_frameratelimit").classList.toggle("disable-cfg",!!window.VSYNC_ON),xt("config_electron_frameratelimit").classList.toggle("hidden",!!window.VSYNC_LOCKED_ON),xt("config_electron_autoupdate").classList.toggle("hidden",window.CLIENT_VERSION<=8||!navigator.platform.startsWith("Win")),Li("config_electron"))})),xt("config_export").addEventListener("click",(function(e){const t=new Blob([JSON.stringify(it)],{type:"application/json"}),n=document.createElement("a");n.download="config.ttc",n.href=(window.webkitURL||window.URL).createObjectURL(t),n.dataset.downloadurl=["application/json",n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})),xt("play_solo").addEventListener("click",(function(e){Li("play1p")})),xt("sig_about").addEventListener("click",(function(e){Li("about")})),xt("about_blog").addEventListener("click",(function(e){window.open("https://blog.osk.sh/","_blank")})),xt("about_issues").addEventListener("click",(function(e){window.open("https://github.com/tetrio/issues","_blank")})),xt("about_discord").addEventListener("click",(function(e){window.open("https://l.tetr.io/discord","_blank")})),xt("about_harddrop").addEventListener("click",(function(e){window.open("https://discord.gg/harddrop","_blank")})),xt("about_legal").addEventListener("click",(function(e){window.open("/about/","_blank")})),xt("about_support").addEventListener("click",(function(e){window.open("/about/support/","_blank")})),xt("about_patchnotes").addEventListener("click",(function(e){window.open("/about/patchnotes/","_blank")})),xt("about_music").addEventListener("click",(function(e){Ii((e=>{na.PlayBgmSmoothlyWithRandom(e)}))})),xt("sound_test").addEventListener("click",(function(e){Si(!1),Li("none"),na.FadeOutBgm(.5),sa.Start()})),xt("about_supporter").addEventListener("click",(function(e){xi()})),xt("about_desktop").addEventListener("click",(function(e){window.open("/about/desktop/","_blank")})),xt("footer_github").addEventListener("click",(function(e){window.open("https://github.com/tetrio/issues","_blank")})),xt("footer_discord").addEventListener("click",(function(e){window.open("https://l.tetr.io/discord","_blank")})),xt("footer_supporter").addEventListener("click",(function(e){xi()})),xt("footer_twitter").addEventListener("click",(function(e){window.open("https://twitter.com/tetriogame","_blank")})),xt("footer_desktop").addEventListener("click",(function(e){window.open("/about/desktop/","_blank")})),xt("game_40l").addEventListener("click",(function(e){Li("40l")})),xt("game_blitz").addEventListener("click",(function(e){Li("blitz")})),xt("game_zen").addEventListener("click",(function(e){Li("zen")})),xt("game_custom").addEventListener("click",(function(e){Li("custom")})),xt("start_40l").addEventListener("click",(()=>{Rs.play40L({song:xt("music_picker_40l").getAttribute("data-song")}),Us(),xt("music_picker_results").setAttribute("data-song",xt("music_picker_40l").getAttribute("data-song")),xt("music_picker_results").innerHTML=xt("music_picker_40l").innerHTML})),xt("start_blitz").addEventListener("click",(()=>{Rs.playBlitz({song:"hyper-velocity"}),Us()})),xt("start_zen").addEventListener("click",(()=>{Rs.playZen({}),Us()})),xt("zen_destroy").addEventListener("click",(()=>{dn({title:"DESTROY ZEN PROGRESS?",msg:'you\'ll be reset to LEVEL 1 and 0 SCORE, with an empty board to start anew.</p><p class="modal_also">this cannot be undone.',classes:["crash_modal"],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"RESET ZEN",classes:["pri"],callback:e=>{e(),dn({title:"REALLY DESTROY ZEN PROGRESS?",msg:"ARE YOU SURE YOU WON'T REGRET DESTROYING YOUR ZEN PROGRESS???",classes:["crash_modal","shudder"],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"I'M CERTAIN",classes:["pri"],callback:e=>{Rs.resetZen(),Rs.saveZen(Rs.getZen()),Zt("it's gone!"),e()}}]})}}]})})),xt("start_custom").addEventListener("click",(()=>{Rs.playCustom({song:xt("music_picker_custom").getAttribute("data-song")}),Us(),xt("music_picker_results").setAttribute("data-song",xt("music_picker_custom").getAttribute("data-song")),xt("music_picker_results").innerHTML=xt("music_picker_custom").innerHTML})),xt("start_results").addEventListener("click",(()=>{Rs.playAgain({song:xt("music_picker_results").getAttribute("data-song")}),Us()})),xt("sig_config").addEventListener("click",(function(e){Li("config")})),document.addEventListener("click",(function(e){e.target.closest("[data-hit]")&&na.PlaySe(`menu${e.target.closest("[data-hit]").getAttribute("data-hit")}`)})),document.addEventListener("mouseover",(function(e){e.target.closest("[data-hover]")&&e.target.closest("[data-hover]").getAttribute("data-hover")&&(!t||!t.closest("[data-hover]")||t&&t.closest("[data-hover]").outerHTML!==e.target.closest("[data-hover]").outerHTML)&&na.PlaySe(`menu${e.target.closest("[data-hover]").getAttribute("data-hover")}`),t=e.target.closest("[data-hover]")})),document.addEventListener("click",(function(e){e.target.classList.contains("collapse_target")&&e.target.closest(".collapsible")&&e.target.closest(".collapsible").classList.toggle("collapsed")})),document.addEventListener("click",(function(e){e.target.classList.contains("music_picker")&&Ii((t=>{if(e.target.setAttribute("data-song",t),Zo[t])e.target.innerHTML=`${Zo[t].artist.toLowerCase()} - ${Zo[t].name.toLowerCase()}`;else switch(t){case"RANDOM":e.target.innerHTML="RANDOM";break;case"RANDOMcalm":e.target.innerHTML="RANDOM: CALM";break;case"RANDOMbattle":e.target.innerHTML="RANDOM: BATTLE";break;default:e.target.innerHTML=t}e.target.dispatchEvent(new Event("input"))}))})),document.addEventListener("click",(function(e){e.target.classList.contains("replayid")&&yi(`https://${_.domain}/#${e.target.textContent}`,"replay link")})),document.addEventListener("click",(function(e){e.target.classList.contains("copyable")&&(yi(e.target.dataset.text,e.target.dataset.displayname),e.preventDefault())})),document.addEventListener("click",(function(e){e.target.classList.contains("tab")&&(yt(`.tab[data-scope="${e.target.getAttribute("data-scope")}"]`).forEach((e=>{e.classList.remove("pressed"),e.classList.remove("active")})),e.target.classList.add("pressed"),e.target.classList.add("active"),yt(`.tab_content[data-scope="${e.target.getAttribute("data-scope")}"]`).forEach((e=>{e.classList.add("hidden")})),e.target.getAttribute("data-target")&&xt(e.target.getAttribute("data-target")).classList.remove("hidden"))})),xt("list_request_back").addEventListener("click",(function(e){ii.pop(),xt("list_request").classList.add("hidden")})),document.addEventListener("click",(function(e){if(e.target.classList.contains("panel_option")){e.target.closest(".panel_optionset").querySelectorAll(".panel_option").forEach((e=>{e.classList.remove("selected")})),e.target.classList.add("selected");pi.fetchZenConfig()[e.target.getAttribute("data-key")]=e.target.getAttribute("data-value"),pi&&pi.pullZenConfig()}})),document.addEventListener("input",(function(e){if(e.target.classList.contains("panel_input")){pi.fetchZenConfig()[e.target.getAttribute("data-key")]="number"===e.target.getAttribute("type")?parseFloat(e.target.value):e.target.value,pi&&pi.pullZenConfig()}})),setInterval((()=>{if(0===$i)return;const e=new Date(Date.now());e.setUTCHours(0,0,0,0),e.setUTCDate(e.getUTCDate()+7-(e.getUTCDay()+6)%7),xt("tetra_zenithtimer").innerHTML=`LEADERBOARD CYCLES IN <b>${wt(e.getTime()).toUpperCase()}</b>`}),500),_.league_season.next_at?setInterval((()=>{if(0===$i)return;const e=_.league_season.ranked?`SEASON ${_.league_season.current} END`:`SEASON ${_.league_season.next} START`,t=Date.now()>_.league_season.next_at;xt("tetra_tltimer").innerHTML=t?`${e}ED <b>${wt(_.league_season.next_at).toUpperCase()} AGO</b>`:`${e}S <b>${wt(_.league_season.next_at).toUpperCase()} FROM NOW</b>`,xt("league_tltimer").innerHTML=t?`${e}ED <b>${wt(_.league_season.next_at).toUpperCase()} AGO</b>`:`${e}S <b>${wt(_.league_season.next_at).toUpperCase()} FROM NOW</b>`}),500):(xt("tetra_tltimer").classList.add("hidden"),xt("league_tltimer").classList.add("hidden")),document.body.classList.toggle("zenith_duoisfree",_.zenith_duoisfree),xt("league_tltimer").addEventListener("click",(function(e){dn({msg:'\n\t\t\t\t<img src="/res/crystalpntop.png" style="position: absolute; top: 0; left: 0; width: 100%; z-index: -1;" />\n\t\t\t\t<h2 style="font-size: 1.5rem; text-align: center; margin-top: -1.7rem;">GET READY FOR</h2>\n\t\t\t\t<h1 style="font-weight: 900;text-align: center;font-size: 3rem;padding-top: 0.2rem;margin-bottom: 1rem;background:linear-gradient(to right, #FFB42B, #FF6993);background-clip:text;text-fill-color:transparent;-webkit-background-clip:text;-webkit-text-fill-color:transparent;">SEASON 2</h2>\n\t\t\t\t<p style="font-family: C; font-size: 1.1rem; margin: 1rem 9rem;">Thank you for playing TETR.IO! After over four years, Season 1 of Tetra League is coming to a close. We\'ve got something exciting coming, so please stay tuned for it!</p>\n\t\t\t\t<p style="font-family: C; font-size: 1.1rem; margin: 1rem 9rem;">You can continue to play Tetra League until the end of the Season, at which point your final standing (if you are ranked) will be memorialized on your profile!</p>\n\n\t\t\t\t<div style="text-align: center;">\n\t\t\t\t\t<span style="font-family: CC; font-size: 1.1rem; color: #505c8c; vertical-align: 200%; display: inline-block;">Earn a badge that reflects your final placement!</span>\n\t\t\t\t\t<img src="/res/badges/tls1/c+.png" style="height: 5rem; margin: 0.75rem 0.4rem;" />\n\t\t\t\t\t<img src="/res/badges/tls1/s.png" style="height: 5.3rem; margin: 0.6rem 0.4rem;" />\n\t\t\t\t\t<img src="/res/badges/tls1/x.png" style="height: 5.8rem; margin: 0.35rem 0.4rem;" />\n\t\t\t\t\t<img src="/res/badges/tls1/4.png" style="height: 6.5rem; margin: 0 0.4rem;" />\n\t\t\t\t</div>\n\n\t\t\t\t<div style="margin: 1rem -1rem; padding: 1rem 10rem; background-color: #0006; font-family: C;">\n\t\t\t\t\t<div style="color: #505c8c; font-weight: 900; font-size: 1.2rem; margin-bottom: 0.5rem;">TIMELINE</div>\n\t\t\t\t\t<p style="font-size: 1.1rem;"><span style="display: inline-block; text-align: center; background: #d55275; color: #FFF; font-weight: 900; font-size: 1.2rem; padding: 0.3rem 0; clip-path: polygon(0 0, 100% 8%, 100% 92%, 0 100%); width: 1.2rem; margin-right: 0.3rem;">1</span><b>July 26th</b>: Season 1 ends</p>\n\t\t\t\t\t<p style="font-size: 1.1rem;"><span style="display: inline-block; background: #0000; color: #FFF; font-weight: 900; font-size: 1.2rem; padding: 0.3rem 0; border-radius: 1rem; width: 1.2rem; margin-right: 0.3rem;"></span>July 26th through August 2nd: Season 1 Post-Season (unranked, Season 1 rules)</p>\n\t\t\t\t\t<p style="font-size: 1.1rem;"><span style="display: inline-block; text-align: center; background: #ff3f31; color: #FFF; font-weight: 900; font-size: 1.2rem; padding: 0.3rem 0; clip-path: polygon(0 0, 100% 8%, 100% 92%, 0 100%); width: 1.2rem; margin-right: 0.3rem;">2</span><b>August 2nd</b>: Season 2 rules are published</p>\n\t\t\t\t\t<p style="font-size: 1.1rem;"><span style="display: inline-block; background: #0000; color: #FFF; font-weight: 900; font-size: 1.2rem; padding: 0.3rem 0; border-radius: 1rem; width: 1.2rem; margin-right: 0.3rem;"></span>August 2nd through August 16th: Season 2 Pre-Season (unranked, Season 2 rules)</p>\n\t\t\t\t\t<p style="font-size: 1.1rem;"><span style="display: inline-block; text-align: center; background: #ff5a31; color: #FFF; font-weight: 900; font-size: 1.2rem; padding: 0.3rem 0; clip-path: polygon(0 0, 100% 8%, 100% 92%, 0 100%); width: 1.2rem; margin-right: 0.3rem;">3</span><b>August 16th</b>: Season 2 begins</p>\n\t\t\t\t</div>\n\t\t\t',classes:["patchnotes","wide_modal"],buttons:[{label:"GOT IT!",classes:[],callback:e=>{e()}}]})})),At("#enter_matchmaking p").innerHTML=_.league_season.ranked?"LEAVING EARLY IS PUNISHED":"UNRANKED"})),window.SHOW_SUPPORTER_DIALOG=(e="SUPPORT TETR.IO")=>{xi(e)};let ki=!1;function Si(e){e?(ki||((_i[mi].onreenter||(()=>{}))(),Gi(),ki=e),xt("menus").classList.remove("hidden")):(ki&&((_i[mi].onexit||(()=>{}))(),Xi(),ki=e,Ps.unmountGroup("main")),xt("menus").classList.add("hidden"))}function Fi(){xt("list_request").classList.contains("hidden")||(ii.pop(),xt("list_request").classList.add("hidden"))}let zi=()=>{};function Ti(e,t,n){zi=t;const s=xt("list_request_scroller");for(;s.firstChild;)s.removeChild(s.firstChild);e.forEach((e=>{const t=document.createElement("div");if(t.classList.add("scroller_item"),t.classList.add("ns"),t.setAttribute("data-id",e.id),t.setAttribute("data-hover","tap"),t.setAttribute("data-hit","click"),t.setAttribute("data-keybind",e.key||"X-NOKEY"),s.appendChild(t),e.image){const n=document.createElement("img");n.src=e.image,t.appendChild(n),t.classList.add("has_image")}e.classes&&t.classList.add(...e.classes),e.attributes&&Object.keys(e.attributes).forEach((n=>{t.setAttribute(n,e.attributes[n])}));const n=document.createElement("h1");if(n.innerHTML=e.name,t.appendChild(n),e.description){const n=document.createElement("p");n.innerHTML=e.description,t.appendChild(n),t.classList.add("has_description")}t.addEventListener("click",(function(e){ii.pop(),xt("list_request").classList.add("hidden"),zi(t.getAttribute("data-id"))}))})),xt("list_request_back").classList.toggle("hidden",!n),xt("list_request").classList.remove("hidden"),ii.push(),ii.bindGuide(oi.list_request)}function Ii(e){const t=[{id:"RANDOM",name:"RANDOM",description:"pick a completely random BGM for me"},{id:"RANDOMcalm",name:"RANDOM: CALM",description:"pick a random calmer BGM for me"},{id:"RANDOMbattle",name:"RANDOM: BATTLE",description:"pick a random intenser battle BGM for me"}];Object.keys(Zo).forEach((e=>{Zo[e].hidden||t.push({id:e,name:Zo[e].name,description:`${Zo[e].artist} - ${Zo[e].genre}`})})),Ti(t,(t=>{e(t)}),!0)}function Mi(e){Ti([{id:"retry",name:"RETRY",key:"retry"},{id:"back",name:"BACK TO TITLE",key:"exit"}],(t=>{e(t)}))}function Ei(){Si(!1),Li("none"),na.KillBgm(),pi&&(pi.end(),pi.destroy(),maingame=void 0)}function Di(e){xt("afterloader_text").innerHTML=e,xt("afterloader").classList.remove("hidden"),document.activeElement.blur()}function Oi(){xt("afterloader").classList.add("hidden")}let Hi=0;function Pi(){Hi=(new Date).getTime(),xt("kuro").classList.remove("hidden"),document.activeElement.blur()}function Ri(e){const t=500-((new Date).getTime()-Hi);t<1?e():setTimeout((()=>{e()}),t)}function Wi(){Ri((()=>{xt("kuro").classList.add("hidden")}))}let $i=0,Ni=null,Ui=!1;function Gi(){0===$i&&(document.body.classList.remove("ingame"),document.body.getBoundingClientRect(),Ni&&clearTimeout(Ni),Ui&&ii.engage()),$i++}function Xi(){$i=Math.max(0,$i-1),0===$i&&xt("preload").classList.contains("hidden")&&(Ni&&clearTimeout(Ni),Ni=setTimeout((()=>{0===$i&&(document.body.classList.add("ingame"),ji())}),1e3),Ui=ii.isEngaged(),ii.disengage(),setTimeout((()=>{0===$i&&xt("replaytools").classList.contains("hidden")&&!document.body.classList.contains("inzenith")&&Ps.mountGroup("ingame")}),1))}function ji(){Math.random()<.5?(xt("enter_matchmaking").insertAdjacentElement("beforebegin",Ps.getElement("league-lb")),Ps.getElement("league-lb").classList.remove("ceriad_bg_r"),Ps.getElement("league-lb").classList.add("ceriad_bg_rt"),Ps.getElement("league-lb").classList.remove("ceriad_mt")):(xt("enter_matchmaking").insertAdjacentElement("afterend",Ps.getElement("league-lb")),Ps.getElement("league-lb").classList.remove("ceriad_bg_rt"),Ps.getElement("league-lb").classList.add("ceriad_bg_r"),Ps.getElement("league-lb").classList.add("ceriad_mt")),Math.random()<.33?xt("results_starter_anchor").insertAdjacentElement("beforebegin",Ps.getElement("soloresults-lb")):Math.random()<.67?xt("results_starter_anchor").insertAdjacentElement("afterend",Ps.getElement("soloresults-lb")):xt("results_replayinfo_anchor").insertAdjacentElement("afterend",Ps.getElement("soloresults-lb")),xt("roomview").classList.toggle("ceriad_right_aligned_experiment",Math.random()>=.5)}kn.ready((function(e){function t(e){0!==$i&&xt("social").classList.contains("hiding")&&xt("afterloader").classList.contains("hidden")&&e.target!==xt("ingame_chat_input")&&Object.keys(at).forEach((t=>{if(at[t].includes(Ct(e))&&t.startsWith("menu")){if(("menuConfirm"===t||"menuBack"===t)&&(e.repeat||"gprepeat"===e.type))return;if(["input","textarea"].includes(document.activeElement.tagName.toLowerCase()))return void(ii.isEngaged()&&"menuConfirm"===t&&document.activeElement.blur());ii.action(t.substring(4).toLowerCase()),e.stopPropagation(),e.preventDefault(),ii.isEngaged()||(na.PlaySe("ribbon_on"),ii.engage())}}))}document.addEventListener("keydown",t,!1),document.addEventListener("gpdown",t,!1),document.addEventListener("gprepeat",t,!1),document.addEventListener("mousemove",(function(e){0!==$i&&ii.isEngaged()&&(na.PlaySe("ribbon_off"),ii.disengage())}),{passive:!0}),document.addEventListener("wheel",(function(e){0!==$i&&ii.isEngaged()&&(na.PlaySe("ribbon_off"),ii.disengage())}),{passive:!0});let n=!0,s=0;window.addEventListener("beforeunload",(function(e){if(window.IS_ELECTRON)if(Ln)Sa&&Sa.isConnected()&&Sa.abort();else{if(n)return n=!1,s=0,dn({title:"EXIT TETR.IO?",msg:"",onskip:()=>{s=0,n=!0},buttons:[{label:"CANCEL",classes:[],callback:e=>{s=0,n=!0,e()}},{label:"EXIT",classes:["pri"],callback:e=>{n=!0,s=0,Sa&&Sa.isConnected()&&Sa.abort(),Pi(),Di("see you next time!"),Is()}}]}),e.preventDefault(),e.returnValue="Exit TETR.IO?","Exit TETR.IO?";if(!(++s>=5))return e.preventDefault(),e.returnValue="Exit TETR.IO?","Exit TETR.IO?";Sa&&Sa.isConnected()&&Sa.abort(),Is(),Pi(),Di("see you next time!")}else{if(!Ln&&document.body.classList.contains("ingame_phys")&&xt("menus").classList.contains("hidden")&&0===$i)return e.preventDefault(),e.returnValue="You are still ingame. Closing this tab will disconnect you. You will lose the game and may receive a penalty!","You are still ingame. Closing this tab will disconnect you. You will lose the game and may receive a penalty!";Sa&&Sa.isConnected()&&Sa.abort()}}));let i,o=window.location.hash;window.addEventListener("hashchange",(function(e){window.location.hash.length<=1||"#google_vignette"===window.location.hash||"#google_vignette"===o?o=window.location.hash:(window.location.href=`/${window.location.hash}`,Ln=!0,window.location.reload())})),window.addEventListener("focus",(function(e){document.body.classList.remove("nofocus"),Dr(),i&&(clearTimeout(i),i=null)})),window.addEventListener("blur",(function(e){document.body.classList.add("nofocus"),i&&(clearTimeout(i),i=null),i=setTimeout((()=>{Er(),i=null}),6e5)})),window.addEventListener("visibilitychange",(function(e){!1!==it.volume.oof&&("visible"===document.visibilityState?na.SetBgmVolume(it.volume.music):na.SetBgmVolume(0)),"visible"===document.visibilityState?Al():Al(10)})),xt("ingame_chat_input").addEventListener("focusin",(e=>document.body.classList.add("chatfocus"))),xt("ingame_chat_input").addEventListener("focusout",(function(e){if(xt("ingame_chat").contains(e.relatedTarget))return e.stopPropagation(),e.preventDefault(),this.focus();document.body.classList.remove("chatfocus")})),xt("menus").addEventListener("dragover",(e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}),!1);let a,r="";function l(e){"results"!==mi||xt("menus").classList.contains("hidden")||xt("results").classList.contains("isreplay")||1!==$i||Object.keys(at).forEach((t=>{at[t].includes(Ct(e))&&"retry"===t&&xt("start_results").click()}))}function c(e){xt("list_request").classList.contains("hidden")||Object.keys(at).forEach((t=>{at[t].includes(Ct(e))&&xt("list_request").querySelectorAll(".scroller_item").forEach((e=>{e.getAttribute("data-keybind")===t&&e.click()}))}))}window.DEVHOOK_LOAD_REPLAY_RAW=e=>{Rs.loadReplay(e,{back:"home",isClientSide:!0}),xt("results").classList.add("fakereplay"),r=data._id},xt("menus").addEventListener("drop",(e=>{e.stopPropagation(),e.preventDefault();const t=e.dataTransfer.files[0];if(!t)return;if(!/\.tt(?:[rpc]|rm)(?:\.json)?$/.test(t.name))return void Yt("TETR.IO cannot open this file");if(Sa&&!Sa.isBackground())return void Yt("you cannot drop a file onto TETR.IO while connected to live servers");if(document.body.classList.contains("ingame"))return void Yt("you cannot drop a file onto TETR.IO while ingame");const n=new FileReader;n.onload=()=>{Oi();try{const e=JSON.parse(n.result);/\.ttr(?:\.json)?$/.test(t.name)?(Rs.loadReplay(e,{back:"home"}),r=e.id,r&&gn.get(`/api/games/${encodeURIComponent(e.id)}/exists`).then((e=>{e.exists||xt("results").classList.add("fakereplay")}),(e=>{}))):/\.ttrm$/.test(t.name)?(Rs.loadReplay(e,{back:"home"}),r=e.id,r&&gn.get(`/api/games/${encodeURIComponent(e.id)}/exists`).then((e=>{e.exists||xt("multilogview").classList.add("noreplay")}),(e=>{}))):/\.ttp$/.test(t.name)?(Rs.setGameOpts(e),Zt("custom game loaded!")):/\.ttc$/.test(t.name)&&dn({title:"IMPORT CONFIG?",msg:'are you sure you wish to import this CONFIG file? it will override your current CONFIG.</p><p class="modal_warning">DO NOT IMPORT A CONFIG YOU DO NOT TRUST!</p><p class="modal_also">your current CONFIG will be lost.',buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"IMPORT",classes:["sec"],callback:t=>{t(),Object.assign(it,e),bt(),_t(),Zt("config loaded. you must hit F5 for all the changes to properly take effect!"),Sa&&Sa.isConnected()&&Sa.updateHandling()}}]})}catch(e){Yt("file load failed!"),console.log(e)}},Di("loading file"),n.readAsText(t)}),!1),document.addEventListener("keydown",(e=>{9===e.keyCode&&e.preventDefault()}),!1),document.addEventListener("keydown",l,!1),document.addEventListener("gpdown",l,!1),document.addEventListener("keydown",c,!1),document.addEventListener("gpdown",c,!1);const p=function(e){a?clearTimeout(a):document.body.classList.remove("idlemouse"),a=setTimeout((()=>{document.body.classList.add("idlemouse"),a=null}),5e3),xt("ceriad-menus-persistent-mpu").classList.toggle("shaded",e.clientX>=316),e.clientX>=316?xt("ceriad-menus-persistent-mpu").classList.remove("btmlock"):xt("back").classList.contains("hidden")&&!document.body.classList.contains("electron")||xt("ceriad-menus-persistent-mpu").classList.add("btmlock")};document.addEventListener("mousemove",p),document.addEventListener("click",p),At("style.darkreader")&&Kt({msg:"you seem to be using the extension DARK READER. this extension WILL mess with the TETR.IO interface, and may cause performance issues. please consider disabling it!",color:"#FFD800",icon:"warning",timeout:15e3})}));const qi={hasSupporter:!1,expires:0,total:0};kn.ready((function(e){xt("config_account").addEventListener("click",(function(e){Di("requesting account data");const t=`SESS-${Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}`;gn.get("/api/server/environment",void 0,{headers:{"X-Session-ID":t}}).then((async e=>{gn.get("/api/users/me",void 0,{headers:{"X-Session-ID":t,"X-Connection-ID":await mn.esc(Uint8Array.from(atob(e.vx),(e=>e.charCodeAt(0))),_n.get())}}).then((e=>{xt("config_account_username").value=e.user.username,xt("config_account_username_field").value=e.user.username.toUpperCase(),xt("config_account_avatar").innerHTML=e.user.avatar_revision?`<img class="avatar" src="/user-content/avatars/${e.user._id}.jpg?rv=${e.user.avatar_revision}" /> ${e.user.username.toUpperCase()}`:`<img class="avatar" src="${Et(e.user._id)}" /> No avatar set`,xt("config_account_banner_link").setAttribute("href",`https://${_.ch_domain}/u/${e.user.username}`),xt("config_account_bio_link").setAttribute("href",`https://${_.ch_domain}/u/${e.user.username}`),xt("config_account_banner").innerHTML=e.user.banner_revision?`<img class="banner" src="/user-content/banners/${e.user._id}.jpg?rv=${e.user.banner_revision}" /> ${e.user.username.toUpperCase()}`:'<img class="banner" src="/res/banner.png" /> No banner set',xt("config_account_bio").value=e.user.bio||"",e.user.email?(xt("config_account_email_warning").classList.add("hidden"),xt("config_account_email").value=e.user.email):(xt("config_account_email_warning").classList.remove("hidden"),xt("config_account_email").value=""),xt("config_account_privacy_showwon").classList.toggle("checked",!1!==e.user.privacy_showwon),xt("config_account_privacy_showplayed").classList.toggle("checked",!1!==e.user.privacy_showplayed),xt("config_account_privacy_showgametime").classList.toggle("checked",!1!==e.user.privacy_showgametime),xt("config_account_privacy_showcountry").classList.toggle("checked",!1!==e.user.privacy_showcountry),xt("config_account_country").innerHTML=`<img class="flag" src="/res/flags/${(e.user.country||"xx").toLowerCase()}.png" /> ${Wn[e.user.country||"XX"]}`,qi.hasSupporter=e.user.supporter,qi.expires=e.user.supporter_expires,qi.total=e.user.total_supported,Yi();for(const[t,n]of Object.entries(e.user.connections))At(`#account_connection_${t}>p`).innerText=n.username,xt(`account_connection_${t}`).classList.add("linked"),xt(`account_connection_${t}_link`).classList.add("hidden"),xt(`account_connection_${t}_remove`).classList.remove("hidden"),xt(`account_connection_${t}_show`).classList.toggle("checked",n.public);xt("config_account_totp_label").innerHTML=e.user.totp.enabled?"ENABLED":"NOT ENABLED",xt("config_account_totp_tokens").innerHTML=e.user.totp.enabled?`you have <b>${e.user.totp.codes_remaining}</b>/8 recovery codes remaining.`:"",xt("config_account_totp_enable").classList.toggle("hidden",!!e.user.totp.enabled),xt("config_account_totp_resetrecovery").classList.toggle("hidden",!e.user.totp.enabled),xt("config_account_totp_disable").classList.toggle("hidden",!e.user.totp.enabled),document.body.classList.toggle("uses2fa",!!e.user.totp&&!!e.user.totp.enabled),yt(".config_account_privacy_privatemode").forEach((t=>{t.classList.toggle("pressed",t.id===`config_account_privacy_privatemode_${e.user.privacy_privatemode||"public"}`)})),yt(".config_account_privacy_status_shallow").forEach((t=>{t.classList.toggle("pressed",t.id===`config_account_privacy_status_shallow_${e.user.privacy_status_shallow||"everyone"}`)})),xt("config_account_privacy_status_deep_friends").classList.toggle("disabled","nobody"===e.user.privacy_status_shallow),xt("config_account_privacy_status_deep_everyone").classList.toggle("disabled",["nobody","friends"].includes(e.user.privacy_status_shallow)),yt(".config_account_privacy_status_deep").forEach((t=>{t.classList.toggle("pressed",t.id===`config_account_privacy_status_deep_${e.user.privacy_status_deep||"everyone"}`)})),xt("config_account_privacy_status_exact_friends").classList.toggle("disabled","nobody"===e.user.privacy_status_deep),xt("config_account_privacy_status_exact_everyone").classList.toggle("disabled",["nobody","friends"].includes(e.user.privacy_status_deep)),yt(".config_account_privacy_status_exact").forEach((t=>{t.classList.toggle("pressed",t.id===`config_account_privacy_status_exact_${e.user.privacy_status_exact||"friends"}`)})),yt(".config_account_privacy_dm").forEach((t=>{t.classList.toggle("pressed",t.id===`config_account_privacy_dm_${e.user.privacy_dm||"everyone"}`)})),document.body.classList.toggle("dmfriendonly","everyone"!==(e.user.privacy_dm||"everyone")),yt(".config_account_privacy_invite").forEach((t=>{t.classList.toggle("pressed",t.id===`config_account_privacy_invite_${e.user.privacy_invite||"friends"}`)})),Oi(),Li("config_account")}),(e=>{Oi(),en(e)}))}),(e=>{Oi(),en(e)}))})),xt("config_account_supporter_support").addEventListener("click",(function(e){xi()})),xt("config_account_logout").addEventListener("click",(function(e){document.body.classList.contains("trapped")||"Attempting to bypass a ban will escalate it to a permanent ban."===localStorage.getItem("trapped")?dn({title:"AS A STERN REMINDER",msg:'IF YOU HAVE BEEN SILENCED, RESTRICTED OR OTHERWISE BANNED, YOU MAY NEVER SWITCH TO ANOTHER ACCOUNT TO EVADE THE BAN. THIS INCLUDES SWITCHING TO AN ANONYMOUS ACCOUNT. EVADING A BAN MAKES IT PERMANENT.</p><p class="modal_warning">exceptions apply if the ban was not meant for you, or when logging out of an alternate account. for more info, read the <a href="/about/rules/" target="_blank">community rules</a>.',classes:["crash_modal","noclickout"],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"I'M NOT EVADING!",classes:["pri"],callback:e=>{Pi(),Di("see you next time!"),mn.logout(),kn.update(!0)}}]}):dn({title:"LOG OUT?",msg:`log out from <span class="inline_self">${xt("config_account_username_field").value}</span>?`,buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"LOG OUT",classes:["pri"],callback:e=>{Pi(),Di("see you next time!"),mn.logout(),kn.update(!0)}}]})})),xt("config_account_logoutall").addEventListener("click",(function(e){document.body.classList.contains("trapped")||"Attempting to bypass a ban will escalate it to a permanent ban."===localStorage.getItem("trapped")?dn({title:"AS A STERN REMINDER",msg:'IF YOU HAVE BEEN SILENCED, RESTRICTED OR OTHERWISE BANNED, YOU MAY NEVER SWITCH TO ANOTHER ACCOUNT TO EVADE THE BAN. THIS INCLUDES SWITCHING TO AN ANONYMOUS ACCOUNT. EVADING A BAN MAKES IT PERMANENT.</p><p class="modal_warning">exceptions apply if the ban was not meant for you, or when logging out of an alternate account. for more info, read the <a href="/about/rules/" target="_blank">community rules</a>.',classes:["crash_modal","noclickout"],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"I'M NOT EVADING!",classes:["pri"],callback:e=>{Pi(),Di("logging out all"),gn.post("/api/users/cycle").then((e=>{Di("see you next time!"),mn.logout(),kn.update(!0)}),(e=>{Oi(),en(e)}))}}]}):dn({title:"LOG OUT ALL?",msg:`log out all devices logged into <span class="inline_self">${xt("config_account_username_field").value}</span>, including this one? this will disconnect you everywhere - use it if you forgot to log out somewhere.`,buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"LOG OUT ALL",classes:["sec"],callback:e=>{Pi(),Di("logging out all"),gn.post("/api/users/cycle").then((e=>{Di("see you next time!"),mn.logout(),kn.update(!0)}),(e=>{Oi(),en(e)}))}}]})})),xt("config_account_password_save").addEventListener("click",(function(e){const t=xt("config_account_password").value,n=xt("config_account_password_again").value;t?t===n?mn.requestPassword(((e,n)=>{Di("saving new account data"),gn.post("/api/users/setPassword",{old:e,new:t,totp:n}).then((e=>{xt("config_account_password").value="",xt("config_account_password_again").value="",Zt("password changed!"),Di("see you next time!"),mn.logout(),kn.update(!0)}),(e=>{Oi(),en(e)}))})):Yt("those passwords don't match"):Yt("you must enter a new password")})),xt("config_account_privacy_showwon").addEventListener("click",(function(e){xt("config_account_privacy_showwon").classList.toggle("checked")})),xt("config_account_privacy_showplayed").addEventListener("click",(function(e){xt("config_account_privacy_showplayed").classList.toggle("checked")})),xt("config_account_privacy_showgametime").addEventListener("click",(function(e){xt("config_account_privacy_showgametime").classList.toggle("checked")})),xt("config_account_privacy_showcountry").addEventListener("click",(function(e){xt("config_account_privacy_showcountry").classList.toggle("checked")})),xt("config_account_privacy_privatemode_private").addEventListener("click",(function(e){yt(".config_account_privacy_privatemode").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_privacy_privatemode_public").addEventListener("click",(function(e){yt(".config_account_privacy_privatemode").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_privacy_status_shallow_nobody").addEventListener("click",(function(e){yt(".config_account_privacy_status_shallow").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),xt("config_account_privacy_status_deep_friends").classList.add("disabled"),xt("config_account_privacy_status_deep_everyone").classList.add("disabled"),xt("config_account_privacy_status_deep_friends").classList.contains("pressed")&&xt("config_account_privacy_status_deep_nobody").click(),xt("config_account_privacy_status_deep_everyone").classList.contains("pressed")&&xt("config_account_privacy_status_deep_nobody").click()})),xt("config_account_privacy_status_shallow_friends").addEventListener("click",(function(e){yt(".config_account_privacy_status_shallow").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),xt("config_account_privacy_status_deep_friends").classList.remove("disabled"),xt("config_account_privacy_status_deep_everyone").classList.add("disabled"),xt("config_account_privacy_status_deep_everyone").classList.contains("pressed")&&xt("config_account_privacy_status_deep_friends").click()})),xt("config_account_privacy_status_shallow_everyone").addEventListener("click",(function(e){yt(".config_account_privacy_status_shallow").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),xt("config_account_privacy_status_deep_friends").classList.remove("disabled"),xt("config_account_privacy_status_deep_everyone").classList.remove("disabled")})),xt("config_account_privacy_status_deep_nobody").addEventListener("click",(function(e){yt(".config_account_privacy_status_deep").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),xt("config_account_privacy_status_exact_friends").classList.add("disabled"),xt("config_account_privacy_status_exact_everyone").classList.add("disabled"),xt("config_account_privacy_status_exact_friends").classList.contains("pressed")&&xt("config_account_privacy_status_exact_nobody").click(),xt("config_account_privacy_status_exact_everyone").classList.contains("pressed")&&xt("config_account_privacy_status_exact_nobody").click()})),xt("config_account_privacy_status_deep_friends").addEventListener("click",(function(e){yt(".config_account_privacy_status_deep").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),xt("config_account_privacy_status_exact_friends").classList.remove("disabled"),xt("config_account_privacy_status_exact_everyone").classList.add("disabled"),xt("config_account_privacy_status_exact_everyone").classList.contains("pressed")&&xt("config_account_privacy_status_exact_friends").click()})),xt("config_account_privacy_status_deep_everyone").addEventListener("click",(function(e){yt(".config_account_privacy_status_deep").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),xt("config_account_privacy_status_exact_friends").classList.remove("disabled"),xt("config_account_privacy_status_exact_everyone").classList.remove("disabled")})),xt("config_account_privacy_status_exact_nobody").addEventListener("click",(function(e){yt(".config_account_privacy_status_exact").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_privacy_status_exact_friends").addEventListener("click",(function(e){yt(".config_account_privacy_status_exact").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_privacy_status_exact_everyone").addEventListener("click",(function(e){yt(".config_account_privacy_status_exact").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_privacy_dm_nobody").addEventListener("click",(function(e){yt(".config_account_privacy_dm").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),document.body.classList.add("dmfriendonly")})),xt("config_account_privacy_dm_friends").addEventListener("click",(function(e){yt(".config_account_privacy_dm").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),document.body.classList.add("dmfriendonly")})),xt("config_account_privacy_dm_everyone").addEventListener("click",(function(e){yt(".config_account_privacy_dm").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)})),document.body.classList.remove("dmfriendonly")})),xt("config_account_privacy_invite_nobody").addEventListener("click",(function(e){yt(".config_account_privacy_invite").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_privacy_invite_friends").addEventListener("click",(function(e){yt(".config_account_privacy_invite").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_privacy_invite_everyone").addEventListener("click",(function(e){yt(".config_account_privacy_invite").forEach((t=>{t.classList.toggle("pressed",t.id===e.target.id)}))})),xt("config_account_email_save").addEventListener("click",(function(e){const t=xt("config_account_email").value;if(!t)return void Yt("you must enter a new email");const n=(e,n)=>{Di("saving new account data"),gn.post("/api/users/setEmail",{password:e,email:t,totp:n}).then((e=>{Zt("email changed!"),xt("config_account_email_warning").classList.add("hidden"),Oi()}),(e=>{Oi(),en(e)}))};xt("config_account_email_warning").classList.contains("hidden")?mn.requestPassword(n):n()})),xt("config_account_privacy_save").addEventListener("click",(function(e){Di("saving new account data"),gn.post("/api/users/setPreferences",{privacy_showwon:xt("config_account_privacy_showwon").classList.contains("checked"),privacy_showplayed:xt("config_account_privacy_showplayed").classList.contains("checked"),privacy_showgametime:xt("config_account_privacy_showgametime").classList.contains("checked"),privacy_showcountry:xt("config_account_privacy_showcountry").classList.contains("checked"),privacy_privatemode:xt("config_account_privacy_privatemode_private").classList.contains("pressed")?"private":"public",privacy_status_shallow:xt("config_account_privacy_status_shallow_nobody").classList.contains("pressed")?"nobody":xt("config_account_privacy_status_shallow_friends").classList.contains("pressed")?"friends":"everyone",privacy_status_deep:xt("config_account_privacy_status_deep_nobody").classList.contains("pressed")?"nobody":xt("config_account_privacy_status_deep_friends").classList.contains("pressed")?"friends":"everyone",privacy_status_exact:xt("config_account_privacy_status_exact_nobody").classList.contains("pressed")?"nobody":xt("config_account_privacy_status_exact_friends").classList.contains("pressed")?"friends":"everyone",privacy_dm:xt("config_account_privacy_dm_nobody").classList.contains("pressed")?"nobody":xt("config_account_privacy_dm_friends").classList.contains("pressed")?"friends":"everyone",privacy_invite:xt("config_account_privacy_invite_nobody").classList.contains("pressed")?"nobody":xt("config_account_privacy_invite_friends").classList.contains("pressed")?"friends":"everyone"}).then((e=>{Zt("privacy preferences changed!"),Oi(),document.body.setAttribute("data-country-hidden",xt("config_account_privacy_showcountry").classList.contains("checked")?"no":"yes")}),(e=>{Oi(),en(e)}))})),xt("config_account_country_change").addEventListener("click",(function(e){if(Ci())return;const t=[];Object.keys(Wn).forEach((e=>{["XX","XM"].includes(e)||t.push({id:e,name:`<img class="flag" style="height: 0.88em; vertical-align: middle;" src="/res/flags/${e.toLowerCase()}.png" /> <span class="i18n_mono">${Wn[e]}</span>`,description:e})})),Ti(t,(e=>{Di("saving new account data"),gn.post("/api/users/setCountry",{country:e}).then((t=>{xt("config_account_country").innerHTML=`<img class="flag" src="/res/flags/${e.toLowerCase()}.png" /> ${Wn[e]}`,document.body.setAttribute("data-country",e),Zt("country changed!"),Oi()}),(e=>{Oi(),en(e)}))}),!0)})),xt("config_account_username_save").addEventListener("click",(function(e){if(Ci())return;const t=xt("config_account_username").value;t&&t!==mn.username()?dn({title:"CHANGE USERNAME?",msg:`change your username from <span class="inline_self">${xt("config_account_username_field").value}</span> to <span class="inline_self">${St(t.toUpperCase())}</span>? this will log you out everywhere, and your previous username will be freed. this process will try to rename everywhere it can, but some links may be broken.</p><p class="modal_also">you can do this only once a month.`,buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"CHANGE IT!",classes:["sec"],callback:e=>{e(),mn.requestPassword(((e,n)=>{Di("changing username"),gn.post("/api/users/setUsername",{password:e,username:t.toLowerCase(),totp:n}).then((e=>{dn({title:"USERNAME CHANGED",msg:"your username was changed successfully. from now on, you must log in using your new username.",classes:["noclickout"],buttons:[{label:"GOT IT!",classes:["pri"],callback:e=>{Pi(),Di("see you next time!"),mn.changeUsername(t),kn.update(!0)}}]}),Oi()}),(e=>{Oi(),en(e)}))}))}}]}):Yt("you must enter a new username")}));let t=!1;window.DEVHOOK_BYPASS_NSFW_CHECK=()=>{console.log("%cYou have just DISABLED the NSFW check temporarily. The purpose of this console command is ONLY to allow you to upload false positives.","color: #FFFFFF;\n\t\t\tdisplay: block;\n\t\t\tfont-size: 1.2em;\n\t\t\tfont-weight: 900;\n\t\t\ttext-shadow: 0px 0px 2px #FFFFFF;\n\t\t\tbackground-color: #FF0000;\n\t\t\tpadding: 0 1em;\n\t\t\tborder-radius: 3px;"),console.log("%cUPLOADING EXPLICIT IMAGES WILL GET YOUR ACCOUNT RESTRICTED. UNDERSTOOD?","color: #FF0000;\n\t\t\tdisplay: block;\n\t\t\tfont-size: 1.2em;\n\t\t\tfont-weight: 900;\n\t\t\ttext-shadow: 0px 0px 2px #FF0000;\n\t\t\tbackground-color: #FFFF00;\n\t\t\tpadding: 0 1em;\n\t\t\tborder-radius: 3px;"),t=!0},xt("config_account_avatar_change").addEventListener("click",(function(e){m.request((()=>{Di("setting avatar")})).then((e=>{if(2===e.safetyLevel&&!t)return console.log(e.predictions),Oi(),void dn({title:"IMAGE REJECTED",msg:'this image was detected as potentially explicit. you must use a different image.</p><p class="modal_also">using an explicit avatar will get your account restricted.',classes:["noclickout","crash_modal"],buttons:[{label:"GOT IT",classes:["pri"],callback:e=>{e()}}]});const n=()=>{const t=new FormData;t.append("file",e.image),gn.post("/api/upload/avatar",t).then((e=>{xt("config_account_avatar").innerHTML=`<img class="avatar" src="/user-content/avatars/${mn.id()}.jpg?rv=${e.avatar_revision}" /> ${mn.username().toUpperCase()}`,xt("me_avatar").setAttribute("src",`/user-content/avatars/${mn.id()}.jpg?rv=${e.avatar_revision}`),xt("zenith_party_self_avatar").setAttribute("src",xt("me_avatar").getAttribute("src")),Zt("avatar updated!"),Oi()}),(e=>{Oi(),en(e)}))};1===e.safetyLevel||t?dn({title:"WARNING",msg:"are you sure you wish to upload this avatar? by uploading an avatar, you understand that if this avatar is deemed explicit, your account will be restricted.",classes:["noclickout"],buttons:[{label:"CANCEL",classes:[],callback:e=>{Oi(),e()}},{label:"CONTINUE",classes:["pri"],callback:e=>{n(),e()}}]}):n()})).catch((e=>{console.error(e),Oi(),Yt("string"==typeof e?e:"sorry, that file cannot be uploaded")}))})),xt("config_account_avatar_remove").addEventListener("click",(function(e){dn({title:"REMOVE AVATAR",msg:"remove your avatar? it'll be replaced by a generic identicon.",classes:[],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"REMOVE",classes:["sec"],callback:e=>{e(),Di("removing avatar"),gn.post("/api/users/removeAvatar").then((e=>{xt("config_account_avatar").innerHTML=`<img class="avatar" src="${Et(mn.id())}" /> No avatar set`,xt("me_avatar").setAttribute("src",Et(mn.id())),xt("zenith_party_self_avatar").setAttribute("src",xt("me_avatar").getAttribute("src")),Zt("avatar removed!"),Oi()}),(e=>{Oi(),en(e)}))}}]})})),xt("config_account_banner_change").addEventListener("click",(function(e){Ci()||m.request((()=>{Di("setting banner")})).then((e=>{if(2===e.safetyLevel&&!t)return console.log(e.predictions),Oi(),void dn({title:"IMAGE REJECTED",msg:"this image was detected as potentially explicit. please use a different image.",classes:["noclickout","crash_modal"],buttons:[{label:"GOT IT",classes:["pri"],callback:e=>{e()}}]});const n=new FormData;n.append("file",e.image),gn.post("/api/upload/banner",n).then((e=>{xt("config_account_banner").innerHTML=`<img class="banner" src="/user-content/banners/${mn.id()}.jpg?rv=${e.banner_revision}" /> ${mn.username().toUpperCase()}`,Zt("banner updated!"),Oi()}),(e=>{Oi(),en(e)}))})).catch((e=>{console.error(e),Oi(),Yt("string"==typeof e?e:"sorry, that file cannot be uploaded")}))})),xt("config_account_banner_remove").addEventListener("click",(function(e){Ci()||dn({title:"REMOVE BANNER",msg:"remove your banner?",classes:[],buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"REMOVE",classes:["sec"],callback:e=>{e(),Di("removing banner"),gn.post("/api/users/removeBanner").then((e=>{xt("config_account_banner").innerHTML='<img class="banner" src="/res/banner.png" /> No banner set',Zt("banner removed!"),Oi()}),(e=>{Oi(),en(e)}))}}]})})),xt("config_account_bio_save").addEventListener("click",(function(e){if(Ci())return;const t=(xt("config_account_bio").value||"").trim();Di("saving new bio"),gn.post("/api/users/setBio",{bio:t}).then((e=>{Zt("bio changed!"),Oi()}),(e=>{Oi(),en(e)}))})),xt("config_account_delete").addEventListener("click",(function(e){xt("config_account_email_warning").classList.contains("hidden")?ai():Yt("you must set an email before deleting your account.")})),xt("config_account_totp_enable").addEventListener("click",(function(e){Di("generating tokens"),gn.post("/api/users/initialize2fa").then((e=>{new QRCode(document.createElement("div"),{text:`otpauth://totp/TETR.IO:${mn.username().toUpperCase()}?secret=${e.secret}&issuer=TETR.IO`,colorLight:"#EEEEEE",colorDark:"#222222",PI:"#1E48FF",AI:"#1E48FF",logo:"/res/qrsnip.png",logoWidth:47.5,logoHeight:47.5,onRenderingEnd:(e,t)=>{Oi(),dn({title:"ENABLE TWO-FACTOR AUTHENTICATION",msg:`scan the following QR code with your favourite authenticator app (like AUTHY or GOOGLE AUTHENTICATOR), then enter the six-digit code into the box below to enable two-factor authentication<br><br><center><img src="${t}" style="width: 260px; height: 260px; object-fit: none; object-position: center; image-rendering: pixelated;" /></center><br><br><input data-escape="totp_enable_cancel" data-enter="totp_enable_submit" id="totp_enable" placeholder="six digits" class="mono_input centered_input" autocomplete="off">`,classes:["wide_modal"],buttons:[{label:"CANCEL",classes:[],id:"totp_enable_cancel",callback:e=>{e()}},{label:"SUBMIT",classes:["pri"],id:"totp_enable_submit",callback:e=>{e();const t=xt("totp_enable").value;mn.requestPassword((e=>{Di("saving"),gn.post("/api/users/enable2fa",{password:e,totp:t}).then((e=>{Oi(),Zt("two-factor authentication enabled!"),xt("config_account_totp_label").innerHTML="ENABLED",xt("config_account_totp_tokens").innerHTML="you have <b>8</b>/8 recovery codes remaining.",xt("config_account_totp_enable").classList.add("hidden"),xt("config_account_totp_resetrecovery").classList.remove("hidden"),xt("config_account_totp_disable").classList.remove("hidden"),document.body.classList.add("uses2fa"),dn({title:"TWO-FACTOR AUTHENTICATION ENABLED",msg:`you've successfully enabled two-factor authentication. now every time you log in, you'll be asked to enter one of those six-digit codes. if you don't have access to your device, you can use one of these codes in place of the 6-digit code:<br><center style="font-family: 'PFW'; font-size: 1.5em;">${e.recoveryTokens.join(" ")}</center><br>write these down! if you don't have them, and lose access to your device, you won't be able to log in. each of these tokens can only be used once, but you can create new ones at any time. keep them safe!!!`,classes:["wide_modal"],buttons:[{label:"I'VE WRITTEN THEM DOWN!",classes:[],callback:e=>{e()}}]})}),(e=>{Oi(),en(e)}))}))}}]}),xt("totp_enable").focus()}})}),(e=>{Oi(),en(e)}))})),xt("config_account_totp_resetrecovery").addEventListener("click",(function(e){mn.requestPassword(((e,t)=>{Di("resetting recovery codes"),gn.post("/api/users/reset2fa",{password:e,totp:t}).then((e=>{Oi(),xt("config_account_totp_tokens").innerHTML="you have <b>8</b>/8 recovery codes remaining.",dn({title:"RECOVERY CODES RESET",msg:`here are your new recovery codes, which you may use in place of the 6-digit code:<br><center style="font-family: 'PFW'; font-size: 1.5em;">${e.recoveryTokens.join(" ")}</center><br>write these down! if you don't have them, and lose access to your device, you won't be able to log in. each of these tokens can only be used once, but you can create new ones at any time. keep them safe!!!`,classes:["wide_modal"],buttons:[{label:"I'VE WRITTEN THEM DOWN!",classes:[],callback:e=>{e()}}]})}),(e=>{Oi(),en(e)}))}))})),xt("config_account_totp_disable").addEventListener("click",(function(e){mn.requestPassword(((e,t)=>{Di("disabling two-factor authentication"),gn.post("/api/users/disable2fa",{password:e,totp:t}).then((e=>{Oi(),Zt("two-factor authentication disabled!"),xt("config_account_totp_label").innerHTML="NOT ENABLED",xt("config_account_totp_tokens").innerHTML="",xt("config_account_totp_enable").classList.remove("hidden"),xt("config_account_totp_resetrecovery").classList.add("hidden"),xt("config_account_totp_disable").classList.add("hidden"),document.body.classList.remove("uses2fa")}),(e=>{Oi(),en(e)}))}))})),xt("config_account_orders").addEventListener("click",(function(e){Di("requesting orders"),gn.get("/api/orders/get").then((e=>{let t='<div class="centered_block np"><p id="extra_line"><b>Need help?</b> <a href="https://help.xsolla.com/" target="_blank">This page will guide you through the most common problems</a>.</p><p id="extra_line"><b>See something out of the ordinary?</b> <a href="https://refunds.xsolla.com/" target="_blank">Request a refund</a> or <a href="https://xsolla.com/refund-policy/flexible-policy" target="_blank">view our refund policy</a>.</p></div>';e.orders.forEach((e=>{t+=`<div class="scroller_block order_listing_item ns">\n\t\t\t\t\t<table class="keypairs ns" style="font-family: 'C';">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Status</td>\n\t\t\t\t\t\t\t<td><img style="height: 1em; vertical-align: -10%;" src="/res/orders/orders_${Ki[e.status]}.png" /> <b>${Vi[e.status]}</b></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Description</td>\n\t\t\t\t\t\t\t<td><i>${St(e.description)}</i></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Price (excluding taxes and fees)</td>\n\t\t\t\t\t\t\t<td>${St(e.currency)} <b>${e.price.toLocaleString("en-US",{style:"currency",currency:"EUR"})}</b></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Payment total (including taxes and fees)</td>\n\t\t\t\t\t\t\t<td>${e.payment&&e.payment.amount?`${St(e.payment.currency)} <b>${e.payment.amount.toLocaleString("en-US",{style:"currency",currency:e.payment.currency})}</b>`:"(unknown)"}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Transaction number</td>\n\t\t\t\t\t\t\t<td>${e.providerid?`<b>${St(e.providerid)}</b>`:"(not paid yet)"}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Merchant</td>\n\t\t\t\t\t\t\t<td>${e.provider?Qi[e.provider]:"(not paid yet)"}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Created</td>\n\t\t\t\t\t\t\t<td>${new Date(e.ts).toLocaleString()}, ${wt(new Date(e.ts).getTime())} ago</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>Last updated</td>\n\t\t\t\t\t\t\t<td>${new Date(e.updated).toLocaleString()}, ${wt(new Date(e.updated).getTime())} ago</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>`})),e.orders.length||(t='<div class="scroller_block ns nothing">NO ORDERS</div>'),xt("config_order_list").innerHTML=t,Oi(),Li("config_account_orders")}),(e=>{Oi(),en(e)}))}));const n=["discord","twitch","youtube","twitter","steam","reddit"];for(const e of n)xt(`account_connection_${e}_link`).addEventListener("click",(async()=>{Di("starting linking process");try{const t=await gn.get(`/api/connect/${e}`,void 0,{headers:{"X-Session-ID":`connection-${mn.id()}`}});window.open(t.link,"_blank")}catch(e){en(e)}finally{Oi()}})),xt(`account_connection_${e}_remove`).addEventListener("click",(async()=>{Di("unlinking");try{await gn.post(`/api/connect/${e}/remove`),Zt("unlinked!"),At(`#account_connection_${e}>p`).innerHTML="",xt(`account_connection_${e}_remove`).classList.add("hidden"),xt(`account_connection_${e}_link`).classList.remove("hidden"),xt(`account_connection_${e}`).classList.remove("linked")}catch(e){en(e)}finally{Oi()}})),xt(`account_connection_${e}_show`).addEventListener("click",(async function(){const t=!this.classList.contains("checked");try{await gn.post(`/api/connect/${e}/public`,{toggle:t}),this.classList.toggle("checked",t),Zt(`connection made ${t?"public":"private"}!`)}catch(e){en(e)}}))}));const Ki={new:"new",pending:"pending",processing:"processing",complete:"complete",retrying:"retrying",refunding:"processing",refunded:"refunded",retrying_refund:"retrying"},Vi={new:"NEW",pending:"PENDING",processing:"PROCESSING",complete:"COMPLETE",retrying:"RETRYING",refunding:"REFUNDING",refunded:"REFUNDED",retrying_refund:"RETRYING REFUND"},Qi={xsolla:"Xsolla"};function Yi(){const e=qi.hasSupporter?(qi.expires-Date.now())/2592e6:0;xt("config_account_supporter_star").setAttribute("src",qi.hasSupporter?"/res/supporter-tag-shiny.png":"/res/supporter-tag-dead.png"),xt("config_account_supporter_bar").setAttribute("style",`--progress: ${e/3*100}%;`),xt("config_account_supporter_bar").setAttribute("title",qi.expires?`Expires ${new Date(qi.expires).toLocaleString()}`:""),xt("config_account_supporter_bar").classList.toggle("noglow",!qi.hasSupporter),xt("config_account_supporter_bar").innerHTML=qi.hasSupporter?`Your supporter status expires in <b>${wt(qi.expires)}</b>.`:qi.expires?`Your supporter status expired <b>${wt(qi.expires)}</b> ago.`:"You are currently not a supporter.",xt("config_account_supporter_details").innerHTML=qi.total?`You have contributed <b>${qi.total.toLocaleString("en-US")}</b> to TETR.IO development so far &mdash; thank you so much!`:"Become a supporter or gift supporter status today and directly support TETR.IO development!",xt("config_account_supporter_support").innerHTML=qi.hasSupporter?"ADD MONTHS OR GIFT":"SUPPORT OR GIFT"}function Ji(){localStorage.getItem("emailNagHiddenUntil")&&Date.now()<parseInt(localStorage.getItem("emailNagHiddenUntil"))||dn({title:"hey, you haven't set an email yet!",msg:'adding an email keeps your account safe and ensures you can get back into it if you lose the password. just type your email in the box below, and it\'ll be attached to your account.<br><input type="email" class="mono_input" data-escape="emailnag_cancel" data-enter="emailnag_submit" id="emailnag" placeholder="email" value=""></p><p class="modal_also">we\'ll never send you spam or sell your email address.</p><p class="modal_warning">without an email on your account, if you forget your password, you will have no way to recover your account!',buttons:[{label:"NAH, NOT NOW",classes:[],id:"emailnag_cancel",callback:e=>{localStorage.setItem("emailNagHiddenUntil",Date.now()+1296e6),Kt("you can set your email under CONFIG > ACCOUNT. don't say we didn't warn you!"),e()}},{label:"SUBMIT",classes:["pri"],id:"emailnag_submit",callback:e=>{const t=xt("emailnag").value;t?(e(),Di("setting your email"),gn.post("/api/users/setEmail",{email:t}).then((e=>{Zt("email attached! thank you for keeping your account safe."),xt("config_account_email_warning").classList.add("hidden"),Oi()}),(e=>{Oi(),en(e)}))):Yt("you must enter a new email")}}]})}kn.ready((function(e){function t(){gn.post("/api/users/setAchievements",{achievements:[parseInt(xt("tetra_achievement_case_0").dataset.k),parseInt(xt("tetra_achievement_case_1").dataset.k),parseInt(xt("tetra_achievement_case_2").dataset.k)]}).then((e=>{}),(e=>{en(e)}))}xt("sig_channel").addEventListener("click",(function(e){Li("tetra")})),xt("tetra_standalone").addEventListener("click",(function(e){window.open(`https://${_.ch_domain}/`,"_blank")})),xt("tetra_leaderboards").addEventListener("click",(function(e){Li("tetra_records")})),xt("tetra_me").addEventListener("click",(function(e){Li("tetra_me")})),xt("tetra_players").addEventListener("click",(function(e){Li("tetra_players"),_i.tetra_players.back="tetra"})),xt("tetra_achievements").addEventListener("click",(function(e){Li("tetra_achievements")})),xt("tetra_jump_leaderboards").addEventListener("click",(function(e){window.open(`https://${_.ch_domain}/lb/${xt("tetra_records_40l").classList.contains("pressed")?"40l":"blitz"}`,"_blank")})),xt("tetra_jump_mypage").addEventListener("click",(function(e){window.open(`https://${_.ch_domain}/u/${mn.username()}`,"_blank")})),xt("tetra_jump_players").addEventListener("click",(function(e){window.open(`https://${_.ch_domain}/lb/${xt("tetra_players_league").classList.contains("pressed")?"league":"xp"}`,"_blank")})),xt("tetra_jump_40l").addEventListener("click",(function(e){window.open(`https://${_.ch_domain}/lb/40l`,"_blank")})),xt("tetra_jump_blitz").addEventListener("click",(function(e){window.open(`https://${_.ch_domain}/lb/blitz`,"_blank")})),xt("tetra_jump_tl").addEventListener("click",(function(e){window.open(`https://${_.ch_domain}/lb/league`,"_blank")})),xt("tetra_find").addEventListener("keydown",(function(e){if(e.repeat)return;if("Enter"!==e.code&&"NumpadEnter"!==e.code)return;na.PlaySe("menuclick"),e.target.blur();const t=xt("tetra_find").value.replace(`https://${_.domain}/#`,"").replace("tetrio://","");ia.navigateToID(t),e.preventDefault(),e.stopPropagation()})),xt("me").addEventListener("click",(function(e){oa({userID:mn.id()})})),document.addEventListener("click",(function(e){let t;if(e.target.closest(".tetra_pop"))t=e.target.closest(".tetra_pop"),oa({username:t.getAttribute("data-username")}),e.stopPropagation(),e.preventDefault();else if(e.target.closest(".dialog_pop"))t=e.target.closest(".dialog_pop"),dn({title:t.getAttribute("data-title"),msg:atob(t.getAttribute("data-content")),classes:["patchnotes","wide_modal"],buttons:[{label:"OK",classes:[],callback:e=>{e()}}]}),e.stopPropagation(),e.preventDefault();else if(e.target.closest(".supporter_pop"))t=e.target.closest(".supporter_pop"),xi(t.getAttribute("data-title")||"SUPPORT TETR.IO"),e.stopPropagation(),e.preventDefault();else if(e.target.closest(".replay_pop"))t=e.target.closest(".replay_pop"),ia.navigateToID(t.getAttribute("data-replay")),e.stopPropagation(),e.preventDefault();else if(e.target.closest(".scroller_player")||e.target.closest(".playerresult")||e.target.closest(".chat_tag")){t=e.target.closest(".scroller_player")||e.target.closest(".playerresult")||e.target.closest(".chat_tag");const n=t.getAttribute("data-id"),s=[];n!=mn.id()&&xt("roomview").classList.contains("hosting")&&(s.push({label:"kick",classes:[],callback:e=>{Oa.kickUser(n),e()}}),s.push({label:"ban",classes:[],callback:e=>{Oa.kickUser(n,2592e3),e()}}),xt("room_players").querySelector(`.scroller_player[data-id="${n}"]`)&&(xt("room_players").querySelector(`.scroller_player[data-id="${n}"]`).classList.contains("spectator")?s.push({label:"move to players",classes:[],callback:e=>{Oa.switchBracketHost(n,"player"),e()}}):s.push({label:"move to spectators",classes:[],callback:e=>{Oa.switchBracketHost(n,"spectator"),e()}})),s.push({label:"transfer ownership",classes:[],callback:e=>{Oa.transferOwnership(n),e()}})),oa({userID:n,buttons:s}),e.stopPropagation(),e.preventDefault()}})),yt(".tetra_records_gamemode").forEach((e=>e.addEventListener("click",(()=>{ia.loadRecords(e.dataset.value,At(".tetra_records_scale.pressed").dataset.value,"tetra_records"),xt("tetra_records_view").dataset.gamemode=e.dataset.value})))),yt(".tetra_records_scale").forEach((e=>e.addEventListener("click",(()=>{ia.loadRecords(At(".tetra_records_gamemode.pressed").dataset.value,e.dataset.value,"tetra_records")})))),yt(".tetra_myrecords_gamemode").forEach((e=>e.addEventListener("click",(()=>{ia.loadRecords(e.dataset.value,"me","tetra_myrecords")})))),yt(".tetra_players_lb").forEach((e=>e.addEventListener("click",(()=>{ia.loadUserList(e.dataset.value,At(".tetra_players_scale.pressed").dataset.value,"tetra_players_content")})))),yt(".tetra_players_scale").forEach((e=>e.addEventListener("click",(()=>{ia.loadUserList(At(".tetra_players_lb.pressed").dataset.value,e.dataset.value,"tetra_players_content")})))),yt(".achievement_case_icon").forEach((e=>e.addEventListener("click",(n=>{xt("tetra_achievements_page").classList.contains("editing")&&xt("tetra_achievements_page").dataset.editing===e.dataset.id?(xt("tetra_achievements_page").classList.remove("editing"),xt("tetra_achievements_page").dataset.editing=""):(xt("tetra_achievements_page").classList.add("editing"),xt("tetra_achievements_page").dataset.editing=e.dataset.id,e.dataset.k=0,e.dataset.rank="stub",e.innerHTML="<span>EMPTY</span>",t())})))),xt("tetra_achievement_data").addEventListener("click",(e=>{if(!xt("tetra_achievements_page").classList.contains("editing"))return;if(!e.target.closest(".achievement"))return;const n=e.target.closest(".achievement").dataset.k,s=e.target.closest(".achievement").dataset.rank,i=At(`.achievement_case_icon[data-id="${xt("tetra_achievements_page").dataset.editing}"]`);i.dataset.k=n,i.dataset.rank=s,i.innerHTML=e.target.closest(".achievement").querySelector(".achievement_icon").innerHTML,t(),xt("tetra_achievements_page").classList.remove("editing"),xt("tetra_achievements_page").dataset.editing=""}))})),kn.ready((function(){function e(e){if(e.repeat||e.isComposing)return;if("Enter"!==e.code&&"NumpadEnter"!==e.code)return;const t=e.target.value;t.length&&Oa.sendChatMessage(t),xt("chat_input").value="",xt("league_chat_input").value="",xt("ingame_chat_input").value="","ingame_chat_input"===e.target.id&&e.target.blur()}xt("play_multi").addEventListener("click",(function(){Di("connecting to live servers"),Sa.require().then((e=>{Oi(),Li("playmulti"),e.maintenance&&document.body.classList.add("maintenance")})).catch((e=>{console.log(e),Oi(),Yt("could not connect to live servers")}))})),xt("outdated_warning").addEventListener("click",(function(){kn.update()})),xt("play_returntoroom").addEventListener("click",(function(){Di("connecting to live servers"),Sa.require().then((e=>{Oi(),Oa.joinRoom(xt("play_returntoroom").dataset.room),xt("play_returntoroom").classList.add("hidden"),ko.remove("returntoroom"),document.body.classList.add("inpair"),setTimeout((()=>Oa.replaceMidgame()),100)})).catch((e=>{console.log(e),Oi(),Yt("could not connect to live servers")}))})),xt("multi_listing").addEventListener("click",(function(){Li("multilisting")})),xt("multi_join").addEventListener("keydown",(function(e){if(e.repeat)return;if("Enter"!==e.code&&"NumpadEnter"!==e.code)return;na.PlaySe("menuclick");const t=xt("multi_join").value.replace("#","").replace(`https://${_.domain}/`,"").replace("tetrio://","");t.length&&Oa.joinRoom(t.toUpperCase()),xt("multi_join").value=""})),xt("multi_quickplay").addEventListener("click",(function(){Oa.joinRoom("X-QP")})),xt("multi_royale").addEventListener("click",(function(){Oa.joinRoom("X-ROYALE")})),xt("multi_league").addEventListener("click",(function(){Di("fetching TETRA LEAGUE data");const e=`SESS-${Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}`;gn.get("/api/server/environment",void 0,{headers:{"X-Session-ID":e}}).then((async t=>{gn.get("/api/users/me",void 0,{headers:{"X-Session-ID":e,"X-Connection-ID":await mn.esc(Uint8Array.from(atob(t.vx),(e=>e.charCodeAt(0))),_n.get())}}).then((e=>{_.league_season.ranked?-1===e.user.league.tr?(xt("league_rating").innerHTML=`${e.user.league.gamesplayed}<span>/10 rating games played</span>`,xt("league_rating").title="",xt("leaguestanding_rating").innerHTML=`${e.user.league.gamesplayed}<span>/10 rating games played</span>`,xt("league_ticker").innerHTML="play rating games to receive a rating",xt("league_rank").classList.add("hidden"),xt("league_warning").classList.add("hidden"),xt("me_leaguerank").classList.add("hidden")):(di=Math.round(e.user.league.tr),hi=e.user.league.rank,xt("league_rating").innerHTML=`${Math.round(e.user.league.tr)}<span>TR</span>`,xt("league_rating").title=e.user.league.tr,xt("leaguestanding_rating").innerHTML=`${Math.round(e.user.league.tr)}<span>TR</span>`,xt("league_ticker").innerHTML=`glicko: <span title="Your raw rating in the Glicko-2 system. Higher is better.">${e.user.league.glicko}</span><span title="How uncertain the Glicko-2 system is of your rating. Lower is better.">${e.user.league.rd}</span> - games won: <span>${e.user.league.gameswon}</span> / ${e.user.league.gamesplayed} (<span>${Math.floor(e.user.league.gameswon/e.user.league.gamesplayed*1e4)/100}</span>%)`,xt("league_rank").src=`/res/league-ranks/${e.user.league.rank}.png`,xt("leaguestanding_rank").src=`/res/league-ranks/${e.user.league.rank}.png`,xt("league_rank").classList.remove("hidden"),xt("league_warning").classList.toggle("hidden","z"!==e.user.league.rank),xt("me_leaguerank").classList.toggle("hidden","z"===e.user.league.rank),xt("me_leaguerank").src=`/res/league-ranks/${e.user.league.rank}.png`):(xt("league_rating").innerHTML="OFF-SEASON",xt("league_rating").title="",xt("leaguestanding_rating").innerHTML=`${e.user.league.gameswon}<span> game${1===e.user.league.gameswon?"":"s"} won</span>`,xt("league_ticker").innerHTML=`${e.user.league.gameswon} GAME${1===e.user.league.gameswon?"":"S"} WON`,xt("league_rank").classList.add("hidden"),xt("league_warning").classList.add("hidden"),xt("me_leaguerank").classList.add("hidden")),-1===e.user.league.standing?xt("league_placement").classList.add("hidden"):(ui=e.user.league.standing,xt("league_placement").classList.remove("hidden"),xt("league_placement").innerHTML=`#<span>${e.user.league.standing}</span>`,xt("league_placement").classList.toggle("t100",e.user.league.standing<=100&&e.user.league.standing>10),xt("league_placement").classList.toggle("t10",e.user.league.standing<=10&&e.user.league.standing>1),xt("league_placement").classList.toggle("t1",1===e.user.league.standing)),Li("league"),Oi(),0===e.user.league.gamesplayed&&_.league_season.ranked&&dn({title:"WELCOME TO TETRA LEAGUE",msg:"TETRA LEAGUE is a competitive 1v1 mode. win duels against players of similar skill to rank up and conquer the leaderboards!</p><p>if you're new to stackers or are feeling rusty, it's a good idea to practice in other modes first.</p><p class=\"modal_warning\">make sure you have the time and connection to play! if you leave or disconnect early, you must rejoin immediately or you will be penalized.",buttons:[{label:"GOT IT!",classes:[],callback:e=>{e()}}]})}),(e=>{Oi(),en(e)}))}),(e=>{Oi(),en(e)}))})),xt("enter_matchmaking").addEventListener("click",(function(){if(document.body.classList.contains("matchmaking"))Oa.leaveMatchmaking();else{Oa.enterMatchmaking();const e=xt("enter_matchmaking").getBoundingClientRect();Ur.play("button_ultra",{x:e.left,y:e.top,w:e.width,h:e.height,color:[16711680,16746632]})}})),xt("multi_createroom").addEventListener("click",(function(){Ti([{id:"public",name:"PUBLIC ROOM",description:"create a public room anyone can join",classes:["block_anon","block_silenced"],attributes:{"data-block-reason":"ANONYMOUS USERS MAY NOT CREATE PUBLIC ROOMS"}},{id:"private",name:"PRIVATE ROOM",description:"create a private room for you and friends"}],(e=>{Oa.createRoom(e)}),!0)})),xt("leaveroom").addEventListener("click",(function(){Oa.leaveRoom()})),xt("leavezenith").addEventListener("click",(function(){Pi(),setTimeout((()=>{Oa.stopSpectating(!0),Oa.leaveRoom(),xt("killfeed").innerHTML="",Ri((()=>{ii.rebind()}))}),200)})),xt("backtoroom").addEventListener("click",(function(){Li("lobby"),Oa.returnToRoom()})),xt("victory_downloadreplay").addEventListener("click",(function(){const e=new Blob([JSON.stringify(Ia)],{type:"application/json"}),t=document.createElement("a");t.download="replay.ttrm",t.href=(window.webkitURL||window.URL).createObjectURL(e),t.dataset.downloadurl=["application/json",t.download,t.href].join(":"),document.body.appendChild(t),t.click(),document.body.removeChild(t)})),xt("viewreplay_endleague").addEventListener("click",(function(){setTimeout((()=>{xt("leaguestanding_rating").classList.remove("pingraise"),xt("leaguestanding_rating").classList.remove("pinglower"),xt("leaguestanding_rating").classList.remove("pingfinal"),xt("leaguestanding_rating").classList.remove("pingrating")}),500),Di("fetching replay");const e=xt("replayid_endleague").innerHTML.replace("R:","");gn.get(`/api/games/${encodeURIComponent(e)}`).then((e=>{Oi();const t=new S(e.game.replay);Rs.loadReplay(t,{back:"endleague",record:e.game,menuStyle:"endleague"})}),(e=>{Oi(),en(e)}))})),xt("backtoleague").addEventListener("click",(function(){Oa.leaveRoom(!0),Li("league"),setTimeout((()=>{xt("leaguestanding_rating").classList.remove("pingraise"),xt("leaguestanding_rating").classList.remove("pinglower"),xt("leaguestanding_rating").classList.remove("pingfinal"),xt("leaguestanding_rating").classList.remove("pingrating")}),5e3),Mr("online","menus")})),xt("chat_input").addEventListener("keydown",e),xt("league_chat_input").addEventListener("keydown",e),xt("ingame_chat_input").addEventListener("keydown",e),xt("chat_input").addEventListener("keydown",s),xt("league_chat_input").addEventListener("keydown",s),xt("ingame_chat_input").addEventListener("keydown",s);let t="",n=-1;function s(e){if(e.repeat||e.isComposing)return;if("Tab"!==e.code)return t="",void(n=-1);let s=t||e.target.value;const i=s.match(/[a-z0-9-_]+/gi)||[""],o=i[i.length-1];if(!o||o.length<2)return;const a=Oa.getRoomUsernames(o);if(!a.length)return;const r=a[++n%a.length];t=s,s=s.substring(0,s.length-o.length)+r,e.target.value=s}function i(){Oa.clearRoomConfig(),xt("startroom").classList.add("hidden"),Oa.startRoom(),setTimeout((()=>{xt("startroom").classList.remove("hidden")}),2e3)}function o(e){document.body.classList.contains("chatfocus")||Object.keys(at).forEach((t=>{if(at[t].includes(Ct(e))&&"chat"===t)if((document.body.classList.contains("inmulti")||document.body.classList.contains("inmultizen"))&&0===$i&&xt("social").classList.contains("hidden"))xt("ingame_chat_input").focus(),e.stopPropagation(),e.preventDefault();else if("lobby"===mi&&1===$i&&!xt("menus").classList.contains("hidden")&&xt("social").classList.contains("hidden")){if(["input","textarea"].includes(document.activeElement.tagName.toLowerCase()))return;xt("chat_input").focus(),e.stopPropagation(),e.preventDefault()}else if("endleague"===mi&&1===$i&&!xt("menus").classList.contains("hidden")&&xt("social").classList.contains("hidden")){if(["input","textarea"].includes(document.activeElement.tagName.toLowerCase()))return;xt("league_chat_input").focus(),e.stopPropagation(),e.preventDefault()}}))}xt("ingame_chat_input").addEventListener("keyup",(e=>{e.repeat||("Escape"===e.code&&(e.target.value="",e.target.blur()),xt("chat_input").value=e.target.value,xt("league_chat_input").value=e.target.value)})),xt("chat_input").addEventListener("keyup",(e=>{xt("ingame_chat_input").value=e.target.value})),xt("roomid_container").addEventListener("click",(function(){yi(`https://${_.domain}/${xt("roomid").innerHTML}`,"link")})),xt("roomid_change").addEventListener("click",(function(e){e.stopPropagation(),Ci()||fi("EDIT ROOM ID","pick a new room ID. alphanumeric characters only, please!",xt("roomid").innerHTML.replace("#",""),(e=>{Oa.setRoomID(e.toUpperCase().trim())}))})),xt("startroom").addEventListener("click",(function(){yt("#room_content_container .unsaved .room_config_item[data-index]").length?dn({title:"START GAME?",msg:"some settings have not yet been saved, if you start the game now, those changes will be lost!",buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"DISCARD and START GAME",classes:["sec"],callback:e=>{i(),e()}}]}):i()})),setInterval((()=>{bi()}),12e4),xt("room_switchbracket").addEventListener("click",(function(){Oa.switchBracket(xt("roomview").classList.contains("spectating")?"player":"spectator")})),xt("igw_zen").addEventListener("click",(()=>{Rs.playZen({inroom:!0,roomname:xt("room_content_name").innerText}),Us()})),xt("igw_spectate").addEventListener("click",(()=>{Oa.startMidgameSpectate()})),document.addEventListener("keydown",o,!0),document.addEventListener("gpdown",o,!0),yt("#room_content_container .room_config_item[data-index]").forEach((e=>{e.addEventListener("input",(t=>{e.closest(".room_config_row").classList.add("unsaved"),xt("room_opts_save").classList.add("unsaved"),t.target!==xt("game-presets")&&(xt("game-presets").parentNode.classList.add("unsaved"),xt("game-presets").innerHTML="custom")}))})),xt("room_opts_save").addEventListener("click",(()=>{Oa.saveRoomConfig()})),yt(".room_config_spinner").forEach((e=>{e.addEventListener("click",(()=>{const t=[];e.getAttribute("data-items")?.split(";").forEach((e=>{let n=(e=e.replace(/\\,/g,"")).split(",");n=n.map((e=>e.replace(//g,","))),t.push({id:n[0],name:n[1],description:n[2]})})),Ti(t,(t=>{e.innerHTML=t,e.dispatchEvent(new Event("input"))}),!0)}))})),xt("waitstate_forfeit_shade").addEventListener("click",(()=>{xt("waitstate_forfeit_shade").classList.add("hidden"),xt("waitstate_forfeit_true").classList.remove("hidden")})),xt("waitstate_forfeit_true").addEventListener("mouseleave",(()=>{xt("waitstate_forfeit_shade").classList.remove("hidden"),xt("waitstate_forfeit_true").classList.add("hidden")})),xt("waitstate_forfeit").addEventListener("click",(()=>{Oa.forfeitMidgame()})),xt("rank_limit").addEventListener("input",(e=>{xt("rank_field").style.setProperty("--pos",e.target.value);const t=xt("rank_limit").value,n=parseFloat(xt("rank_limit").getAttribute("max"));xt("rank_limit").style.background=`linear-gradient(to right, #FFF 0%, #FFF ${t/n*100}%, #000A ${t/n*100}%, #000A 100%)`})),xt("rank_limit").addEventListener("change",(e=>{xt("rank_field").style.setProperty("--pos",e.target.value);const t=xt("rank_limit").value,n=parseFloat(xt("rank_limit").getAttribute("max"));xt("rank_limit").style.background=`linear-gradient(to right, #FFF 0%, #FFF ${t/n*100}%, #000A ${t/n*100}%, #000A 100%)`})),xt("game-presets").addEventListener("input",(e=>{Oa.clearRoomConfig(),Oa.pushRoomConfigString(Nn[e.target.innerHTML])}))}));let Zi=0,eo="Unknown";function to(e,t,n){if(_.novault)return;let s="",i="???";switch(e){case"supporter":{let e="";e=t.isgift?1===t.recipients.length?`Supporter for ${t.recipients[0].toUpperCase()} - ${t.months} month${1===t.months?"":"s"} (gift)`:`Supporter for ${t.recipients.length} recipients (mega gift)`:`Supporter for ${mn.username().toUpperCase()} - ${t.months} month${1===t.months?"":"s"}`,s+=`<tr>\n\t\t\t\t<td>${e}</td>\n\t\t\t\t<td>1 unit</td>\n\t\t\t\t<td>${t.price.toFixed(2)}</td>\n\t\t\t</tr>`,i=`${t.price.toFixed(2)}`,Zi=t.price,eo=t.isgift?"Supporter Gift":"Supporter";break}}Di("checking payment data"),gn.post("/api/orders/create",{type:e,dryrun:!0,data:t}).then((o=>{Oi(),n&&n(),Pt(["trackEvent","Vault","Purchase Initialize",eo,Zi]),dn({title:"Checkout",msg:`</p><div class="dialog_long">\n\t\t\t\t\t<table>${s}</table>\n\t\t\t\t\t<div class="vault_total"><span>TOTAL</span>${i}</div>\n\t\t\t\t\t<p class="vault_about">Your transaction will be completed using Xsolla.<br><b>Some of Xsolla's payment partners:</b><br><img src="/res/xsolla_methods.png" /><br>and many more.</p>\n\t\t\t\t</div><div class="xsolla_mark">Xsolla is an authorized global distributor of TETR.IO</div><p>`,classes:["vault_modal"],buttons:[{label:"Cancel",classes:[],callback:e=>{e()}},{label:"Pay with Xsolla",classes:["pri","xsolla_pay_button","oob_button_arrow_right"],callback:(n,s)=>{na.PlaySe("purchase_start"),s.classList.add("oob_button_arrow_right_fly"),no(e,t,n,(()=>{s.classList.remove("oob_button_arrow_right_fly")}))}}]})}),(e=>{Oi(),en(e)}))}function no(e,t,n,s){_.novault||(window.XPayStationWidget?(Di("placing order"),gn.post("/api/orders/create",{type:e,dryrun:!1,data:t}).then((s=>{Di(""),Os(!1),n&&n();let i=!1;XPayStationWidget.off(),XPayStationWidget.on("open",(()=>{Oi(),Pt(["trackEvent","Vault","Purchase Start",eo,Zi])})),XPayStationWidget.on("status-done",(()=>{i=!0,Pt(["trackEvent","Vault","Purchase Complete",eo,Zi])})),XPayStationWidget.on("status-troubled",(()=>{Pt(["trackEvent","Vault","Purchase Troubled",eo,Zi])})),XPayStationWidget.on("close",(()=>{Os(!0),i?Ai(e,t):Pt(["trackEvent","Vault","Purchase Cancel",eo,Zi])})),XPayStationWidget.init({access_token:s.tokenid,sandbox:s.sandbox,lightbox:{zIndex:9999999999}}),XPayStationWidget.open()}),(e=>{Oi(),s&&s(),en(e)}))):Yt("a script is missing. please refresh the page or disable content blocking extensions."))}let so="",io=!0;function oo(e=!1,t=()=>{}){!e&&("home"!==mi||xt("menus").classList.contains("hidden")||$i<1)||gn.get("/about/homebanner.html",void 0,{parse:!1}).then((e=>{if(e==so)return;so=e,xt("homebanner").innerHTML=e;const n=e.startsWith("\x3c!--Yes serve a ceriad at the top yes yes yes please cool cool--\x3e");n!==io&&(io=n,n?(xt("homebanner").insertAdjacentElement("afterend",Ps.getElement("home-lb")),Ps.getElement("home-lb").classList.add("ceriad_bg_rb"),Ps.getElement("home-lb").classList.remove("ceriad_bg_rt"),Ps.getElement("home-lb").classList.add("ceriad_mb"),Ps.getElement("home-lb").classList.remove("ceriad_mt"),Ps.mountIfMounted("home-lb")):(xt("home_menu").insertAdjacentElement("beforeend",Ps.getElement("home-lb")),Ps.getElement("home-lb").classList.add("ceriad_bg_rt"),Ps.getElement("home-lb").classList.remove("ceriad_bg_rb"),Ps.getElement("home-lb").classList.add("ceriad_mt"),Ps.getElement("home-lb").classList.remove("ceriad_mb"),Ps.mountIfMounted("home-lb"))),t()}),(e=>{t()}))}Wt((()=>{oo(!0,(()=>{kn.finishLoad("homebanner")}))})),kn.ready((e=>{setInterval((()=>{oo()}),6e5)})),kn.ready((function(e){Ws.newacc()||gn.get("/about/patchnotes/notes.json",void 0,{ignoreSuccess:!0}).then((e=>{const t=localStorage.getItem("lastPatch"),n=Object.keys(e)[0];if(n!==t){localStorage.setItem("lastPatch",n);let t="";t+=`<h1>${n}</h1><h6>${e[n].ts}</h6>`,e[n].contents.forEach((e=>{e.header&&(t+=`<h2 style="color: ${e.color};" data-content="${e.header}">${e.header}</h2>`),t+=`<p>${e.items.join("</p><p>")}</p>`})),dn({title:"WHAT'S NEW",msg:`<div class="dialog_long">${t}<p class="dlf">Like this update? Please consider <a href="javascript:void();" class="lna" onclick="SHOW_SUPPORTER_DIALOG();">supporting TETR.IO development</a>!</p></div>`,classes:["patchnotes","wide_modal"],buttons:[{label:"ALL PATCH NOTES",classes:[],callback:e=>{window.open("/about/patchnotes/","_blank"),e()}},{label:"COOL!",classes:["pri"],callback:e=>{e()}}]})}}),(()=>{}))}));const ao={NONE:0,BRONZE:1,SILVER:2,GOLD:3,PLATINUM:4,DIAMOND:5,ISSUED:100},ro={0:"none",1:"bronze",2:"silver",3:"gold",4:"platinum",5:"diamond",100:"issued"},lo={PERCENTILE:1,ISSUE:2,ZENITH:3,PERCENTILELAX:4,PERCENTILEVLAX:5,PERCENTILEMLAX:6},co={NONE:0,NUMBER:1,TIME:2,TIME_INV:3,FLOOR:4,ISSUE:5,NUMBER_INV:6},po={UNRANKED:0,RANKED:1,COMPETITIVE:2},ho={[ao.DIAMOND]:[0,.05,0,4],[ao.PLATINUM]:[.05,.1,5,9],[ao.GOLD]:[.1,.3,10,29],[ao.SILVER]:[.3,.5,30,49],[ao.BRONZE]:[.5,.7,50,69],[ao.NONE]:[.7,1,0,1]},uo={[ao.DIAMOND]:[0,.05,0,4],[ao.PLATINUM]:[.05,.2,5,19],[ao.GOLD]:[.2,.6,20,59],[ao.SILVER]:[.6,1,60,99],[ao.BRONZE]:[1,1,100,1/0],[ao.NONE]:[1,1,100,1/0]},_o={[ao.DIAMOND]:[0,.1,0,9],[ao.PLATINUM]:[.1,.2,10,19],[ao.GOLD]:[.2,.5,20,49],[ao.SILVER]:[.5,1,60,99],[ao.BRONZE]:[1,1,100,1/0],[ao.NONE]:[1,1,100,1/0]},mo={[ao.DIAMOND]:[0,.2,0,1],[ao.PLATINUM]:[.2,.5,2,4],[ao.GOLD]:[.5,1,5,9],[ao.SILVER]:[1,1,10,1/0],[ao.BRONZE]:[1,1,10,1/0],[ao.NONE]:[1,1,10,1/0]},go={[ao.DIAMOND]:[0,1],[ao.PLATINUM]:[1350,1650],[ao.GOLD]:[850,1350],[ao.SILVER]:[450,850],[ao.BRONZE]:[150,450],[ao.NONE]:[0,150]},fo={[ao.NONE]:0,[ao.BRONZE]:1,[ao.SILVER]:2,[ao.GOLD]:3,[ao.PLATINUM]:5,[ao.DIAMOND]:8,[ao.ISSUED]:1},bo=[[3,6],[5,5],[10,4],[25,3],[50,2],[100,1]];function Co(e,{clickable:t=!0,isSelf:n=!0}){const s=document.createElement("div");s.classList.add("achievement"),e.vt===co.ISSUE?s.classList.add("noclick"):(s.dataset.hover="tap",s.dataset.hit="click");const i=e.stub?"stub":ro[e.rank];s.dataset.rank=i,s.dataset.k=e.k;let o=0,a="",r="";switch(e.vt){case co.NUMBER:a=`${Math.floor(e.stub?0:e.v).toLocaleString("en-US")}${e.deci?`<span>.${Math.floor((e.stub?0:e.v)%1*10**e.deci)}</span>`:""}`;break;case co.NUMBER_INV:a=e.stub?"---":`${Math.floor(-e.v).toLocaleString("en-US")}${e.deci?`<span>.${Math.floor(-e.v%1*10**e.deci)}</span>`:""}`;break;case co.TIME:{const t=Bt(e.stub?0:e.v);a=e.stub?"---":`${t.m}:${t.s}<span>.${t.ms}</span>`;break}case co.TIME_INV:{const t=Bt(e.stub?0:-e.v);a=e.stub?"---":`${t.m}:${t.s}<span>.${t.ms}</span>`;break}case co.FLOOR:a=e.stub?"---":`<span>FLOOR</span> ${e.a}`;break;case co.ISSUE:a=e.stub||-1===e.pos?"---":`<span>ISSUE #</span>${e.pos+1}`}if(e.stub)r=e.rt!==lo.ZENITH&&e.min>Number.MIN_SAFE_INTEGER?`<div class="achievement_info_rank">of ${(e.vt===co.NUMBER_INV?-e.min:e.min).toLocaleString("en-US")}</div>`:"";else if(e.v<e.min)r=`<div class="achievement_info_rank">of ${(e.vt===co.NUMBER_INV?-e.min:e.min).toLocaleString("en-US")}</div>`;else if(e.pos>-1)switch(e.rt){case lo.PERCENTILE:{const t=e.pos/Math.max(1,e.total-1),s=ho[e.rank];o=Math.max(1-(t-s[0])/(s[1]-s[0]),1-(e.pos-s[2])/(s[3]-s[2])),r=e.pos?`<div class="achievement_info_rank">top ${(100*t).toFixed(t<.01?3:2)}% (#${(e.pos+1).toLocaleString("en-US")}) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`:`<div class="achievement_info_rank">${n?"you're ":""}the very best! (#1) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`;break}case lo.ISSUE:r=`<div class="achievement_info_rank">of ${Math.max(e.pos+1,e.total).toLocaleString("en-US")} <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`;break;case lo.ZENITH:{const t=e.pos/Math.max(1,e.total-1),n=go[e.rank];o=(e.v-n[0])/(n[1]-n[0]),r=`<div class="achievement_info_rank">${Math.floor(e.v).toLocaleString("en-US")}.${Math.floor(e.v%1*10)}m, ${e.pos?`top ${(100*t).toFixed(t<.01?3:2)}%`:"the best!"} (#${(e.pos+1).toLocaleString("en-US")}) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`;break}case lo.PERCENTILELAX:{const t=e.pos/Math.max(1,e.total-1),s=uo[e.rank];o=Math.max(1-(t-s[0])/(s[1]-s[0]),1-(e.pos-s[2])/(s[3]-s[2])),r=e.pos?`<div class="achievement_info_rank">top ${(100*t).toFixed(t<.01?3:2)}% (#${(e.pos+1).toLocaleString("en-US")}) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`:`<div class="achievement_info_rank">${n?"you're ":""}the very best! (#1) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`;break}case lo.PERCENTILEMLAX:{const t=e.pos/Math.max(1,e.total-1),s=_o[e.rank];o=Math.max(1-(t-s[0])/(s[1]-s[0]),1-(e.pos-s[2])/(s[3]-s[2])),r=e.pos?`<div class="achievement_info_rank">top ${(100*t).toFixed(t<.01?3:2)}% (#${(e.pos+1).toLocaleString("en-US")}) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`:`<div class="achievement_info_rank">${n?"you're ":""}the very best! (#1) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`;break}case lo.PERCENTILEVLAX:{const t=e.pos/Math.max(1,e.total-1),s=mo[e.rank];o=Math.max(1-(t-s[0])/(s[1]-s[0]),1-(e.pos-s[2])/(s[3]-s[2])),r=e.pos?`<div class="achievement_info_rank">top ${(100*t).toFixed(t<.01?3:2)}% (#${(e.pos+1).toLocaleString("en-US")}) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`:`<div class="achievement_info_rank">${n?"you're ":""}the very best! (#1) <span title="${new Date(e.t).toLocaleString()}">${new Date(e.t).toLocaleDateString()}</span></div>`;break}}let l=null;!e.stub&&e.pos>-1&&e.art===po.COMPETITIVE&&(e.pos<3?l="t3":e.pos<5?l="t5":e.pos<10?l="t10":e.pos<25?l="t25":e.pos<50?l="t50":e.pos<100&&(l="t100"));const c=`\n\t\t<img class="achievement_icon_frame" src="/res/achievements/frames/${"stub"===i?"none":i}.png" />\n\t\t<img class="achievement_icon_frame_glint achievement_icon_frame_glint_a" src="/res/achievements/glint-a.png" />\n\t\t<img class="achievement_icon_frame_glint achievement_icon_frame_glint_b" src="/res/achievements/glint-b.png" />\n\t\t<img class="achievement_icon_frame_glint achievement_icon_frame_glint_c" src="/res/achievements/glint-c.png" />\n\t\t${o?`<div class="achievement_icon_ring">\n\t\t\t<img src="/res/achievements/frames/ring-piece.png" style="clip-path: ${xo(o)};" />\n\t\t\t<img src="/res/achievements/frames/ring-piece.png" style="clip-path: ${xo(o)};" />\n\t\t</div>`:""}\n\t\t${l?`<img class="achievement_icon_wreath" src="/res/achievements/wreaths/${l}.png" />`:""}\n\t\t<div class="achievement_icon_inner" style="background-position: ${(e.k-1)%8*-100}% ${-100*Math.floor((e.k-1)/8)}%;"></div>\n\t`,p=`\n\t\t<div class="achievement_info_name">${e.name.toUpperCase()}</div>\n\t\t<div class="achievement_info_value">${a}${r}</div>\n\t\t<div class="achievement_info_object">${e.object}</div>\n\t\t<div class="achievement_info_desc">${e.desc}</div>\n\t\t<div class="achievement_info_icons">${e.art===po.UNRANKED?'<img src="/res/achievements/unranked.png" title="This achievement does not contribute to your Achievement Rating." />':""}${e.art===po.COMPETITIVE?'<img src="/res/achievements/competitive.png" title="This achievement grants extra Achievement Rating to those who place in its Top 100 leaderboard." />':""}${e.hidden?'<img src="/res/achievements/hidden.png" title="This achievement is only visible to the worthy." />':""}</div>\n\t`;return s.innerHTML=`\n\t\t<div class="achievement_icon">${c}</div>\n\t\t<div class="achievement_info">${p}</div>\n\t`,t&&e.vt!==co.ISSUE&&s.addEventListener("click",(()=>{xt("tetra_achievements_page").classList.contains("editing")||Ao(e,{progress:o,rank:i,text:a,rankText:r,competitivePlace:l})})),{...e,progress:o,holder:s,icon:c,info:p}}function xo(e){const t=21.0907499842,n=100-2*t,s=107.756034934;if(e<=1/3){return`polygon(${t}% 0, ${t+3*e*n}% 0, 50% 50%)`}if(e<=2/3){const i=3*e-1;return`polygon(${t}% 0, ${t+n}% 0, ${t+n+i*(s-(t+n))}% ${50*i}%, 50% 50%)`}if(e<=1){const i=3*e-2;return`polygon(${t}% 0, ${t+n}% 0, ${s}% 50%, ${t+n+(1-i)*(s-(t+n))}% ${50+50*i}%, 50% 50%)`}return"none"}async function Ao(e,{progress:t,rank:n,text:s,rankText:i,competitivePlace:o}){let a;Di("fetching leaderboard");try{a=(await gn.get(`/api/achievements/${e.k}`)).entries,Oi()}catch(e){throw Oi(),en(e),e}let r="",l=0;for(const t of a){let n="";switch(e.vt){case co.NUMBER:n=`${Math.floor(t.v).toLocaleString("en-US")}${e.deci?`<span>.${Math.floor(t.v%1*10**e.deci)}</span>`:""}`;break;case co.NUMBER_INV:n=`${Math.floor(-t.v).toLocaleString("en-US")}${e.deci?`<span>.${Math.floor(-t.v%1*10**e.deci)}</span>`:""}`;break;case co.TIME:{const e=Bt(t.v);n=`${e.m}:${e.s}<span>.${e.ms}</span>`;break}case co.TIME_INV:{const e=Bt(-t.v);n=`${e.m}:${e.s}<span>.${e.ms}</span>`;break}case co.FLOOR:n=`${Math.floor(t.v).toLocaleString("en-US")}<span>.${Math.floor(t.v%1*10)}</span>`}r+=`\n\t\t\t<div class="achlb_entry" data-hover="tap" data-hit="click" data-username="${t.u.username}">\n\t\t\t\t<div class="achlb_place">${++l}</div>\n\t\t\t\t<div class="achlb_owner">${t.u.username.toUpperCase()}${t.u.supporter?'<img src="/res/supporter-tag.png" title="This person is supporting TETR.IO " />':""}${t.u.country?`<img class="flag" src="/res/flags/${t.u.country.toLowerCase()}.png" title="${Wn[t.u.country]}" />`:""}</div>\n\t\t\t\t<div class="achlb_time">${new Date(t.t).toLocaleString()}</div>\n\t\t\t\t<div class="achlb_value">${n}</div>\n\t\t\t</div>\n\t\t`}0===l&&(r='<div class="achlb_empty">nobody has gotten this achievementyet!</dev>');const c=dn({msg:`<div class="achtop ns" data-rank="${n}">\n\t\t\t<div class="achievement_icon">\n\t\t\t\t<img class="achievement_icon_frame" src="/res/achievements/frames/${"stub"===n?"none":n}.png" />\n\t\t\t\t<img class="achievement_icon_frame_glint achievement_icon_frame_glint_a" src="/res/achievements/glint-a.png" />\n\t\t\t\t<img class="achievement_icon_frame_glint achievement_icon_frame_glint_b" src="/res/achievements/glint-b.png" />\n\t\t\t\t<img class="achievement_icon_frame_glint achievement_icon_frame_glint_c" src="/res/achievements/glint-c.png" />\n\t\t\t\t${t?`<div class="achievement_icon_ring">\n\t\t\t\t\t<img src="/res/achievements/frames/ring-piece.png" style="clip-path: ${xo(t)};" />\n\t\t\t\t\t<img src="/res/achievements/frames/ring-piece.png" style="clip-path: ${xo(t)};" />\n\t\t\t\t</div>`:""}\n\t\t\t\t${o?`<img class="achievement_icon_wreath" src="/res/achievements/wreaths/${o}.png" />`:""}\n\t\t\t\t<div class="achievement_icon_inner" style="background-position: ${(e.k-1)%8*-100}% ${-100*Math.floor((e.k-1)/8)}%;"></div>\n\t\t\t</div>\n\t\t\t<div class="achievement_info">\n\t\t\t\t<div class="achievement_info_name">${e.name.toUpperCase()}</div>\n\t\t\t\t<div class="achievement_info_value">${s}${i}</div>\n\t\t\t\t<div class="achievement_info_object">${e.object}</div>\n\t\t\t\t<div class="achievement_info_desc">${e.desc}</div>\n\t\t\t</div>\n\t\t</div><div class="achlb dialog_long ns">${r}</div><div class="tetra_modal_jump ns" data-hover="tap" data-hit="click"> VIEW FULL LEADERBOARD</div>`,classes:["achievements_modal"],buttons:[]});c.querySelectorAll(".achlb_entry").forEach((e=>e.addEventListener("click",(()=>{c.classList.add("busy");oa({username:e.dataset.username}).__onclose=()=>{c.classList.remove("busy")}})))),c.querySelector(".tetra_modal_jump").addEventListener("click",(()=>{hn(c),window.open(`https://${_.ch_domain}/achievements/${e.k}`,"_blank")})),c.querySelector(".tetra_modal_jump").addEventListener("auxclick",(t=>{1===t.button&&window.open(`https://${_.ch_domain}/achievements/${e.k}`,"_blank")}))}kn.ready((()=>{document.body.addEventListener("mousemove",(e=>{const t=e.target.closest(".achievement_icon");if(!t)return;const n=t.clientWidth,s=t.clientHeight;t.__grng||(t.__grng=new Array(24).fill(0).map(((e,t)=>Math.random()*(e.i%8>3?3.14:6))));const i=t.__grng;t.style.setProperty("--rx",(e.offsetX-n/2)/n*20+"deg"),t.style.setProperty("--ry",(e.offsetY-s/2)/s*-20+"deg"),t.style.setProperty("--ga",""+(.25*(Math.max(0,Math.sin((e.offsetX/n+i[0])*i[1]))+Math.max(0,Math.sin((e.offsetY/s+i[2])*i[3])))+.5*Math.max(0,Math.sin((e.offsetX/n+i[4])*i[5]))*Math.max(0,Math.sin((e.offsetY/s+i[6])*i[7])))),t.style.setProperty("--gb",""+(.25*(Math.max(0,Math.sin((e.offsetX/n+i[8])*i[9]))+Math.max(0,Math.sin((e.offsetY/s+i[10])*i[11])))+.5*Math.max(0,Math.sin((e.offsetX/n+i[12])*i[13]))*Math.max(0,Math.sin((e.offsetY/s+i[14])*i[15])))),t.style.setProperty("--gc",""+(.25*(Math.max(0,Math.sin((e.offsetX/n+i[16])*i[17]))+Math.max(0,Math.sin((e.offsetY/s+i[18])*i[19])))+.5*Math.max(0,Math.sin((e.offsetX/n+i[20])*i[21]))*Math.max(0,Math.sin((e.offsetY/s+i[22])*i[23]))))}),{passive:!0})}));let yo=[];function vo(e=!1){"undefined"!=typeof Notification?"granted"===Notification.permission||"denied"===Notification.permission&&!e||Notification.requestPermission():console.warn("Notifications are not available on this device.")}function Bo(e,t,n=!1,s="/res/tetriox256.png",i=void 0,o=null){if("undefined"==typeof Notification)return;if(!1===it.video.desktopnotifications)return;if(!document.body.classList.contains("nofocus")&&!n)return;const a=new Notification(e,{body:t,icon:s,badge:"/res/tetriox256.png",tag:i});a.onclick=o||(()=>{window.focus(),a.close()}),yo.push(a),window.IS_ELECTRON&&Ds()}kn.ready((function(e){vo(!1),window.addEventListener("focus",(function(e){for(const e of yo)e.close();yo=[]}))}));const wo=(()=>{let e=0,t=-1,n=!1,s=0,i=null,o="",a=!1;function r(){n||s<=0||!a&&!document.body.classList.contains("nofocus")?(s--,n=!1,s<=0&&null!==i&&(clearInterval(i),i=null,o="",a=!1),document.title=`${e?`(${e.toLocaleString()}) `:""}${t>-1?`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}  `:""}TETR.IO`,xt("favicon").setAttribute("href",e?"/res/favicon-dot.ico":"/res/favicon.ico")):(n=!0,document.title=o,xt("favicon").setAttribute("href","/res/favicon-alert.ico"))}return{update:r,alert:function(e,t=5,n=250,l=!1){o=e,s=t,a=l,null!==i&&clearInterval(i),i=setInterval(r,n),r()},setNotificationCount:t=>{e=t,r()},setMMTime:e=>{t=e,r()}}})(),Lo=(()=>{"production"===_.mode?Wt((()=>{xt("performancemeter_header").innerHTML="PRODUCTION BUILD - F8 for stats",xt("sb").remove(),xt("sbt").remove()})):Wt((()=>{xt("performancemeter").classList.remove("production"),xt("performancemeter_header").innerHTML="DEVELOPMENT BUILD - F8 for stats"}));let e=!1,t=[],n=[];const s=[],i=[],o=[];let r=0,l=0,c=0,p=0,d=0,h=0,u=0,m=0,g=0,f=0,b=[],C=[],x=[],A=[],y=[],v=[],B=[],w=[];const L=1e3/60;let k=null;function S(){const e=window.performance.now();t.push(e),function(){const e=window.performance.now();y=y.filter((t=>!(e-t>1e3))),v=v.filter((t=>!(e-t>6e4))),B=B.filter((t=>!(e-t>1e3))),w=w.filter((t=>!(e-t>6e4))),t=t.filter((t=>!(e-t>1e3))),b=b.filter((t=>!(e-t.ts>1e3))),C=C.filter((t=>!(e-t.ts>6e4))),x=x.filter((t=>!(e-t.ts>1e3))),A=A.filter((t=>!(e-t.ts>1e3)))}(),u=y.length,m=v.length,g=B.length,f=w.length,r=t.length,n.push({ts:e,fps:r}),n=n.filter((t=>!(e-t.ts>5e3))),c=Math.max(1e-6,b.reduce(((e,t)=>Math.max(e,t.fill)),0)),p=Math.max(1e-6,C.reduce(((e,t)=>Math.max(e,t.fill)),0)),d=A.reduce(((e,t)=>Math.max(e,t.fill)),0),h=x.reduce(((e,t)=>Math.max(e,t.fill)),0),l=n.reduce(((e,t)=>Math.min(e||t.fps,t.fps)),0),F("fps",r),z("fps",l),T("fps",r<40),F("f",Math.round(c/L*1e4)/100),z("f",Math.round(p/L*1e4)/100),T("f",c/L>.8),F("gamef",Math.round(d/c*1e4)/100),z("gamef",Math.round(d/L*1e4)/100),F("drawf",Math.round(h/c*1e4)/100),z("drawf",Math.round(h/L*1e4)/100),F("gamem",u),z("gamem",m),F("drawm",g),z("drawm",f),T("gamem",u>9),T("drawm",g>9),F("ping",s.length?s[s.length-1]:"-"),z("ping",s.length?s.reduce(((e,t)=>Math.max(e,t))):"-"),T("ping",!!s.length&&s[s.length-1]>500),F("ping_spool",i.length?i[i.length-1]:"-"),z("ping_spool",i.length?i.reduce(((e,t)=>Math.max(e,t))):"-"),T("ping_spool",!!i.length&&i[i.length-1]>300),F("ping_backhaul",o.length?o[o.length-1]:"-"),z("ping_backhaul",o.length?o.reduce(((e,t)=>Math.max(e,t))):"-"),T("ping_backhaul",!!o.length&&o[o.length-1]>200)}function F(e,t){k.querySelector(`#perf_${e} h1 span`).innerHTML=t}function z(e,t){k.querySelector(`#perf_${e} h2 span`).innerHTML=t}function T(e,t){t?k.querySelector(`#perf_${e}`).classList.add("warning"):k.querySelector(`#perf_${e}`).classList.remove("warning")}return Wt((()=>{k=xt("performancemeter"),document.addEventListener("keydown",(t=>{119===t.which&&(e||!k.classList.contains("collapsed")&&!k.classList.contains("production")?e||k.classList.contains("production")?(e=!1,a.Ticker.shared.remove(S,this),k.classList.add("off"),k.classList.remove("collapsed")):(k.classList.remove("off"),k.classList.add("collapsed")):(e=!0,a.Ticker.shared.add(S,this),k.classList.remove("off"),k.classList.remove("collapsed")))}),!1),xt("devbuildid").innerHTML=`v${_.version}-${_.mode} | commit ${_.commit.id}@${_.branch} (${new Date(_.commit.time).toLocaleString()}) | server cycle ${_.serverCycle} | build ${_.build.id} (${new Date(_.build.time).toLocaleString()})<br>\n\t\t\t\t\t\t\t\t\t${window.IS_ELECTRON?"desktop":"browser"} | ${navigator.userAgent}<br>\n\t\t\t\t\t\t\t\t\t${it.video.graphics||"high"} | ${it.electron.anglecompat?"COMPAT ON":"compat off"} | <span id="rendererinfo">(no renderer)</span><br>\n\t\t\t\t\t\t\t\t\tgfx <span id="dirtyflag_gfx">OK</span> | net <span id="dirtyflag_net">OK</span> | state <span id="dirtyflag_state">OK</span> | client <span id="dirtyflag_client">OK</span> | gl <span id="dirtyflag_gl">OK</span><br>\n\t\t\t\t\t\t\t\t\tserver: <span id="serverdebuginfo">(not connected)</span>`,xt("version_line").innerHTML=`version ${_.version}-${_.mode.toUpperCase()} (press F8 for more info)`})),kn.ready((()=>{e||xt("performancemeter").classList.contains("production")||xt("performancemeter").classList.add("collapsed")})),{addGameM:t=>{if(e)for(;t-- >0;)y.push(window.performance.now()),v.push(window.performance.now())},addPing:e=>{s.push(Math.floor(e/2)),s.splice(0,Math.max(0,s.length-12))},addSpoolPing:e=>{i.push(Math.floor(e/2)),i.splice(0,Math.max(0,i.length-12))},addSpoolLatency:e=>{o.push(Math.floor(e/2)),o.splice(0,Math.max(0,o.length-12))}}})(),ko=new class{_states=new Map;_despawning=new Map;_elHeader=Symbol("elHeader");_elSub=Symbol("elSub");_elExtra=Symbol("elExtra");_elButtons=Symbol("elButtons");set(e,t){if(this._despawning.get(e)?.remove(),this._states.has(e))this._update(e,this._states.get(e)[1],t,this._states.get(e)[0]),this._states.get(e)[0]=t;else{const n=this._createElement(e);this._update(e,n,t,{}),this._states.set(e,[t,n])}}remove(e){if(!this._states.has(e))return;const t=this._states.get(e)[1];t&&(t.classList.add("hiding"),this._despawning.set(e,t),setTimeout((()=>{t.remove()}),500)),this._states.delete(e)}clear(){for(const[e]of this._states)this.remove(e)}_createElement(e){const t=document.createElement("div");return t.className="ongoing spawning",t.dataset.id=e,xt("ongoing").appendChild(t),t[this._elHeader]=document.createElement("div"),t[this._elHeader].className="ongoing_header",t.appendChild(t[this._elHeader]),t[this._elSub]=document.createElement("div"),t[this._elSub].className="ongoing_sub",t.appendChild(t[this._elSub]),t[this._elExtra]=document.createElement("div"),t[this._elExtra].className="ongoing_extra",t.appendChild(t[this._elExtra]),t[this._elButtons]=document.createElement("div"),t[this._elButtons].className="ongoing_buttons",t.appendChild(t[this._elButtons]),setTimeout((()=>{t.classList.remove("spawning")}),1e3),t}_update(e,t,n,s={}){n.state!==s.state&&(t.dataset.state=n.state??""),n.header!==s.header&&(t[this._elHeader].textContent=n.header??""),n.sub!==s.sub&&(t[this._elSub].textContent=n.sub??""),n.extra!==s.extra&&(t[this._elExtra].textContent=n.extra??""),n.buttons?s.buttons&&n.buttons.join()===s.buttons.join()||(this._createButtons(t,n.buttons),t.dataset.hasbuttons="yes"):s.buttons&&(t[this._elButtons].innerHTML="",t.dataset.hasbuttons="")}_buttons={leaveMatchmaking:["CANCEL MATCHMAKING",()=>{Oa.leaveMatchmaking()}],exitRoomZen:["BACK TO ROOM",()=>{Rs.stopNow(),document.body.classList.remove("inmultizen"),Si(!0),Li("lobby")}],returnToMatch:["RETURN TO MATCH",()=>{Rs.stopNow(),document.body.classList.remove("inmultizen"),xt("play_returntoroom").click()}]};_createButtons(e,t){e[this._elButtons].innerHTML="";for(const n of t){const t=this._buttons[n];if(!t)continue;const s=document.createElement("div");s.className="ongoing_button"+(t[1]?"":" disabled"),s.dataset.hover="tap",s.dataset.hit="click",s.textContent=t[0],t[1]&&s.addEventListener("click",t[1]),e[this._elButtons].appendChild(s)}}};let So=[],Fo=null,zo=0,To=!1,Io=!1,Mo=!1,Eo="normal",Do=null,Oo=null,Ho=[],Po=null,Ro=null,Wo=0;function $o(e,t){let n=30;Wo+=16384,Si(!1),na.FadeOutBgm(1);const s=St(e.users[0].username),i=e.gamemode??"unknown",o=new k(e.replay);xt("data_replay").innerHTML=`watching <span>${s.toUpperCase()}</span> play <span>${St(L.Strings.longTypeNames[i]??"UNKNOWN GAMEMODE")}</span>`,xt("replay").classList.remove("hidden"),xt("replaytools").classList.remove("hidden"),xt("replaytools").classList.remove("multi"),xt("replaytools").classList.add("disabled"),yt('.tab[data-scope="replaytools_secondary_right"]').forEach((e=>{e.classList.remove("active")})),xt("replaytools_button_1x").classList.add("active"),xt("replaytools_button_playpause").innerHTML="",xt("replaytools_timestamp").innerHTML="0:00.000<span>frame 0</span>",xt("replaytools_seekbar").setAttribute("style","--progress: 0%;"),xt("replaytools_seekbar_tip").setAttribute("style",""),xt("replaytools_button_playpause").classList.remove("disabled"),xt("replaytools_button_nextround").classList.contains("active")&&xt("replaytools_button_end").click(),pi=new B("replay",{replay:o}),So=[],Fo=null,zo=0,Io=!1,pi.on("start",(function(){xt("replaytools").classList.remove("disabled")})),pi.on("end",(function(){xt("replaytools").classList.add("disabled"),Rs.setUnsafeTimeout((()=>{Si(!0),na.PlayBgmSmoothly(document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")?"touhoudaiensei":t||"shikiichi-made-mousukoshi"),xt("replay").classList.add("hidden"),xt("replaytools").classList.add("hidden")}),500)})),pi.on("frame",(function(e,t){if(!t){const t=Bt(1e3*(e+1)/60);xt("replaytools_timestamp").innerHTML=`${t.m}:${t.s}.${t.ms}<span>frame ${e}</span>`,xt("replaytools_seekbar").setAttribute("style",`--progress: ${e/Go.frames*100}%;`)}if(e===Go.frames){if(xt("replaytools_button_stop").classList.contains("active"))return pi.playbackSpeed()&&(xt("replaytools_button_playpause").innerHTML="",pi.playbackSpeed(0)),!0;if(xt("replaytools_button_loop").classList.contains("active")){if(--n<=0){n=30;const e=Gt(Go.states[0]);return void pi.injectState(e)}return!0}}})),Go=o.Preprocess(i,s);let a=[],r=15;if("40l"===i||"custom"===i?(a=Go.localPPS,r=15):"blitz"===i?(a=Go.localSPP,r=40):"zenith"!==i&&"zenithex"!==i||(a=Go.climbSpeed,r=15),a.length<=4096){let e=0,t=999;a.forEach((n=>{e=Math.max(e,n[1]),t=Math.min(t,n[1])}));let n="clip-path: polygon(100% 100%, 0% 100%";a.forEach((s=>{n+=t/e<.1?`, ${s[0]/Go.frames*100}% ${100-s[1]/e*100}%`:`, ${s[0]/Go.frames*100}% ${90-(s[1]-t)/(e-t)*90}%`})),n+="); ",a.length>r&&(n+=`background: linear-gradient(to right, #FFF0 0%, #FF780022 ${a[r][0]/Go.frames*100}%, #FF780022 100%);`),xt("replaytools_graph").setAttribute("style",n)}else xt("replaytools_graph").setAttribute("style","");let l="";"40l"===i&&(Go.finesseFault.length<=30&&Go.finesseFault.forEach((e=>{l+=`<div class="replaytools_marker_finesse" style="left: ${e/Go.frames*100}%;"></div>`})),Go.choke.length<=5&&Go.choke.forEach((e=>{l+=`<div class="replaytools_marker_choke" style="left: ${e[0]/Go.frames*100}%; width: ${e[1]/Go.frames*100}%;"></div>`}))),"zenith"!==i&&"zenithex"!==i||Go.chapter.forEach((e=>{l+=`<div class="replaytools_marker_chapter" style="left: ${e[0]/Go.frames*100}%;">${e[1]}</div>`})),xt("replaytools_markers").innerHTML=l,pi.setGame(Go.options),pi.createGameHolder(),pi.location(0,-.1,1),pi.startGame()}function No(e,t,n,s,i,o,a){Io=!0,Mo=!1,Eo="normal",To=!1,Po=i,Ro=s,Wo+=16384,Si(!1),n&&"shiroi-hyoutan"!==n&&(na.FadeOutBgm(),Oo=n),Do=n,xt("data_replay").innerHTML=`watching <span>${St(t[0].username.toUpperCase())}</span> VS <span>${St(t[1].username.toUpperCase())}</span>${i||s?`, round <span>${o}</span>${zl(`/${a}`)}`:""}`,xt("replay").classList.remove("hidden"),xt("replaytools").classList.remove("hidden"),xt("replaytools").classList.add("disabled"),xt("replaytools").classList.add("multi"),xt("replaytools").classList.toggle("multiround",s||i),xt("replaytools_graph").setAttribute("style",""),yt('.tab[data-scope="replaytools_secondary_right"]').forEach((e=>{e.classList.remove("active")})),xt("replaytools_button_1x").classList.add("active"),xt("replaytools_button_playpause").innerHTML="",xt("replaytools_timestamp").innerHTML="0:00.000<span>frame 0</span>",xt("replaytools_seekbar").setAttribute("style","--progress: 0%;"),xt("replaytools_seekbar_tip").setAttribute("style",""),xt("replaytools_button_backward_round").classList.toggle("disabled",void 0===s),xt("replaytools_button_forward_round").classList.toggle("disabled",void 0===i),xt("replaytools_button_playpause").classList.remove("disabled"),!xt("replaytools_button_nextround").classList.contains("active")||s||i||xt("replaytools_button_end").click();const r=new B("replay",{replay:e[0]}),l=new B("replay",{replay:e[1]});Xo.push(r),Xo.push(l),Ho=[r,l],r.on("start",(function(){xt("replaytools").classList.remove("disabled"),na.PlayBgmSmoothly("shiroi-hyoutan")})),r.on("end",Uo),l.on("start",(function(){this.options.nosound=!1})),l.on("end",Uo);let c=30,p=0;r.on("frame",(function(e,t){if(!To){if(!t){const t=Bt(1e3*(e+1)/60);xt("replaytools_timestamp").innerHTML=`${t.m}:${t.s}.${t.ms}<span>frame ${e}</span>`,xt("replaytools_seekbar").setAttribute("style",`--progress: ${e/zo*100}%;`)}if(e===zo){if(2===p)return!0;if(xt("replaytools_button_stop").classList.contains("active"))return r.playbackSpeed()&&(xt("replaytools_button_playpause").innerHTML="",r.playbackSpeed(0),l.playbackSpeed(0)),!0;if(xt("replaytools_button_loop").classList.contains("active"))return!(--c<=0)||(c=30,r.injectState(Gt(So[0].states[0])),l.injectState(Gt(So[1].states[0])),void(p=1))}else p=0}})),l.on("frame",(function(e,t){if(!To)if(e===So[1].frames){if(1===p)return!0;if(xt("replaytools_button_stop").classList.contains("active"))return r.playbackSpeed()&&(xt("replaytools_button_playpause").innerHTML="",r.playbackSpeed(0),l.playbackSpeed(0)),!0;if(xt("replaytools_button_loop").classList.contains("active"))return!(--c<=0)||(c=30,r.injectState(Gt(So[0].states[0])),l.injectState(Gt(So[1].states[0])),void(p=2))}else p=0})),r.on("garbage",(()=>l.getPos())),l.on("garbage",(()=>r.getPos()));const d=()=>{const[e,t]=[Math.max(0,r.getState().stats.btb-r.getState().setoptions.b2bcharge_at+r.getState().setoptions.b2bcharge_base),Math.max(0,l.getState().stats.btb-l.getState().setoptions.b2bcharge_at+l.getState().setoptions.b2bcharge_base)];r.setB2BDistance(e-t),l.setB2BDistance(t-e)};r.on("b2bstate",d),l.on("b2bstate",d),So[0]=e[0].Preprocess("multi"),So[1]=e[1].Preprocess("multi"),zo=Math.min(So[0].frames,So[1].frames),Fo=[...So[0].piece,...So[1].piece],Fo.push(zo),Fo=Fo.filter((function(e,t){return Fo.indexOf(e)==t&&e<=zo})),Fo.sort(((e,t)=>e-t));const h=So[0].vs,u=So[1].vs;u.splice(h.length),h.splice(u.length);const _=[];if(h.forEach(((e,t)=>{_.push([e[0],h[t][1]-u[t][1]])})),_.length<=1e3){let e=1,t=-1;_.forEach((n=>{e=Math.max(e,n[1]),t=Math.min(t,n[1])})),e=Math.max(e,-.5*t),t=Math.min(t,-.5*e);let n="clip-path: polygon(100% 50%, 0% 50%";_.forEach((s=>{n+=s[1]>=0?`, ${s[0]/zo*100}% ${50-s[1]/e*50}%`:`, ${s[0]/zo*100}% ${50+s[1]/t*50}%`})),n+=");",xt("replaytools_graph").setAttribute("style",n)}xt("replaytools_markers").innerHTML="",r.setGame(So[0].options),r.createGameHolder(),r.location(-.35,-.1,1),r.startGame(),So[1].options.nosound=!0,l.setGame(So[1].options),l.createGameHolder(),l.location(.45,-.1,1),l.startGame()}function Uo(e){if(To)return;To=!0;const t=Ho.filter((e=>e!==this))[0];return xt("replaytools").classList.add("disabled"),xt("replaytools_button_backward_round").classList.add("disabled"),xt("replaytools_button_forward_round").classList.add("disabled"),xt("replaytools_button_playpause").classList.add("disabled"),Mo?Mo=!1:"winner"===e?t.queueEnd("topout",!0):t.endWin(),("next"===Eo||"normal"===Eo&&xt("replaytools_button_nextround").classList.contains("active"))&&Po?(Rs.setUnsafeTimeout((()=>{So=[],Fo=null,Io=!1,Xo.length=0}),"next"===Eo?50:500),void Rs.setUnsafeTimeout((()=>{t.endNow(),Po()}),"next"===Eo?100:1e3)):"prev"===Eo&&Ro?(Rs.setUnsafeTimeout((()=>{So=[],Fo=null,Io=!1,Xo.length=0}),"prev"===Eo?50:500),void Rs.setUnsafeTimeout((()=>{t.endNow(),Ro()}),"prev"===Eo?100:1e3)):(na.FadeOutBgm(.2),Rs.setUnsafeTimeout((()=>{Si(!0),na.PlayBgmSmoothly(document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")?"touhoudaiensei":Oo||Do||"shikiichi-made-mousukoshi"),xt("replay").classList.add("hidden"),xt("replaytools").classList.add("hidden"),So=[],Fo=null,Io=!1,Xo.length=0}),500),void Rs.setUnsafeTimeout((()=>{t.endNow()}),1e3))}let Go=null,Xo=[];kn.ready((()=>{document.addEventListener("keydown",(e=>{xt("replay").classList.contains("hidden")||document.body.classList.contains("chatfocus")||$i>=1||(["ARROWLEFT","LEFT"].includes(Ct(e))?e.shiftKey?xt("replaytools_button_backward_frame").click():e.ctrlKey?xt("replaytools_button_backward_large").click():xt("replaytools_button_backward_piece").click():["ARROWRIGHT","RIGHT"].includes(Ct(e))?e.shiftKey?xt("replaytools_button_forward_frame").click():e.ctrlKey?xt("replaytools_button_forward_large").click():xt("replaytools_button_forward_piece").click():[",","COMMA"].includes(Ct(e))?xt("replaytools_button_backward_frame").click():[".","PERIOD"].includes(Ct(e))?xt("replaytools_button_forward_frame").click():["J","KEYJ"].includes(Ct(e))?xt("replaytools_button_backward_large").click():["L","KEYL"].includes(Ct(e))?xt("replaytools_button_forward_large").click():["K","KEYK","SPACE"," "].includes(Ct(e))?xt("replaytools_button_playpause").click():["ARROWUP","UP"].includes(Ct(e))?xt("replaytools_button_5x").classList.contains("active")?xt("replaytools_button_10x").click():xt("replaytools_button_2x").classList.contains("active")?xt("replaytools_button_5x").click():xt("replaytools_button_1x").classList.contains("active")?xt("replaytools_button_2x").click():xt("replaytools_button_50x").classList.contains("active")?xt("replaytools_button_1x").click():xt("replaytools_button_25x").classList.contains("active")&&xt("replaytools_button_50x").click():["ARROWDOWN","DOWN"].includes(Ct(e))&&(xt("replaytools_button_10x").classList.contains("active")?xt("replaytools_button_5x").click():xt("replaytools_button_5x").classList.contains("active")?xt("replaytools_button_2x").click():xt("replaytools_button_2x").classList.contains("active")?xt("replaytools_button_1x").click():xt("replaytools_button_1x").classList.contains("active")?xt("replaytools_button_50x").click():xt("replaytools_button_50x").classList.contains("active")&&xt("replaytools_button_25x").click()),e.repeat||Object.keys(at).forEach((t=>{if(at[t].includes(Ct(e))&&"exit"===t)xt("exit_replay").click()})))}),!1),xt("exit_replay").addEventListener("click",(function(){Io||pi.end()})),xt("replaytools_button_25x").addEventListener("click",(function(){Io||pi.playbackSpeed()&&pi.playbackSpeed(.25)})),xt("replaytools_button_50x").addEventListener("click",(function(){Io||pi.playbackSpeed()&&pi.playbackSpeed(.5)})),xt("replaytools_button_1x").addEventListener("click",(function(){Io||pi.playbackSpeed()&&pi.playbackSpeed(1)})),xt("replaytools_button_2x").addEventListener("click",(function(){Io||pi.playbackSpeed()&&pi.playbackSpeed(2)})),xt("replaytools_button_5x").addEventListener("click",(function(){Io||pi.playbackSpeed()&&pi.playbackSpeed(5)})),xt("replaytools_button_10x").addEventListener("click",(function(){Io||pi.playbackSpeed()&&pi.playbackSpeed(10)})),xt("replaytools_button_playpause").addEventListener("click",(function(){if(!Io){if(pi.playbackSpeed())return xt("replaytools_button_playpause").innerHTML="",void pi.playbackSpeed(0);xt("replaytools_button_25x").classList.contains("active")?pi.playbackSpeed(.25):xt("replaytools_button_50x").classList.contains("active")?pi.playbackSpeed(.5):xt("replaytools_button_1x").classList.contains("active")?pi.playbackSpeed(1):xt("replaytools_button_2x").classList.contains("active")?pi.playbackSpeed(2):xt("replaytools_button_5x").classList.contains("active")?pi.playbackSpeed(5):xt("replaytools_button_10x").classList.contains("active")&&pi.playbackSpeed(10),xt("replaytools_button_playpause").innerHTML=""}})),xt("replaytools_button_forward_frame").addEventListener("click",(function(){if(Io)return;if(xt("replaytools").classList.contains("disabled"))return;pi.getFrame()>=Go.frames||pi.advanceFrames(1)})),xt("replaytools_button_forward_piece").addEventListener("click",(function(){if(Io)return;if(xt("replaytools").classList.contains("disabled"))return;const e=pi.getFrame();for(let t=0;t<Go.piece.length;t++)if(Go.piece[t]>e)return void pi.advanceFrames(Go.piece[t]-e)})),xt("replaytools_button_forward_large").addEventListener("click",(function(){if(Io)return;if(xt("replaytools").classList.contains("disabled"))return;const e=pi.getFrame();e>=Go.frames||pi.advanceFrames(Math.min(Go.frames-e,300),!0)})),xt("replaytools_button_backward_frame").addEventListener("click",(function(){Io||xt("replaytools").classList.contains("disabled")||s(pi,Go,1)})),xt("replaytools_button_backward_piece").addEventListener("click",(function(){if(Io)return;if(xt("replaytools").classList.contains("disabled"))return;const e=pi.getFrame();for(let t=Go.piece.length-1;t>=0;t--)if(Go.piece[t]<e)return void s(pi,Go,e-Go.piece[t])})),xt("replaytools_button_backward_large").addEventListener("click",(function(){Io||xt("replaytools").classList.contains("disabled")||s(pi,Go,300)}));let e=!1,t=!1;function n(e,t,n){const s=Math.max(0,n-1),i=Math.floor(s/300),o=s-300*i,a=Gt(t.states[i]);e.injectState(a),e.advanceFrames(o,!0),e.emit("frame",s,!1)}function s(e,t,s){const i=e.getFrame();n(e,t,i-s)}xt("replaytools_seekbar").addEventListener("mouseover",(()=>{t=!0})),xt("replaytools_seekbar").addEventListener("mouseout",(()=>{t=!1})),xt("replaytools_seekbar").addEventListener("mousedown",(function(t){if(Io)return;if(xt("replaytools").classList.contains("disabled"))return;e=!0;const s=pi.getFrame(),i=Math.floor(Math.min(1,Math.max(0,(t.clientX-16)/(window.innerWidth-32)))*Go.frames);s!==i&&n(pi,Go,i)})),document.addEventListener("mouseup",(()=>{Io||(e=!1)})),document.addEventListener("mousemove",(()=>{if(!Io){if(xt("replaytools").classList.contains("disabled"))return e=!1,void(t=!1);if(e){const e=pi.getFrame(),t=Math.floor(Math.min(1,Math.max(0,(event.clientX-16)/(window.innerWidth-32)))*Go.frames);e!==t&&n(pi,Go,t)}if(t){const e=Math.floor(Math.min(1,Math.max(0,(event.clientX-16)/(window.innerWidth-32)))*Go.frames),t=e/Go.frames*100;xt("replaytools_seekbar_tip").setAttribute("style",`--progress: ${t}%;`),xt("replaytools_seekbar").setAttribute("data-border-snapped",t<=10?"left":t>=90?"right":"none");const n=Bt(1e3*e/60);let s="",i="",o="",a="";if("40l"===Go.gamemode||"custom"===Go.gamemode){for(let t=Go.localPPS.length-1;t>=0;t--)if(Go.localPPS[t][0]<=e){s=`<div class="seekbar_tip_stat"><span>${Go.localPPS[t][1].toFixed(2)}</span> ${zl("L")}PPS</div>`;break}}else if("blitz"===Go.gamemode){for(let t=Go.localSPP.length-1;t>=0;t--)if(Go.localSPP[t][0]<=e){s=`<div class="seekbar_tip_stat"><span>${Go.localSPP[t][1].toFixed(2)}</span> ${zl("L")}SPP</div>`;break}}else if("zenith"===Go.gamemode||"zenithex"===Go.gamemode)for(let t=Go.climbSpeed.length-1;t>=0;t--)if(Go.climbSpeed[t][0]<=e){s=`<div class="seekbar_tip_stat"><span>${Go.climbSpeed[t][1].toFixed(2)}</span> CSP</div>`;break}if("40l"===Go.gamemode){let t=0;for(let n=e-30;n<e+30;n++)Go.finesseFault.includes(n)&&t++;t&&(o=`<div class="seekbar_tip_issue"><b>${t}</b> finesse piece${1===t?"":"s"}</div>`);for(let t=0;t<Go.choke.length;t++)if(Go.choke[t][0]-30<=e&&Go.choke[t][0]+Go.choke[t][1]+30>=e){a=`<div class="seekbar_tip_issue_severe"><b>${Math.round(1e3*Go.choke[t][1]/60)}</b>${zl("MS")} choke</div>`;break}}for(let t=0;t<Go.chapter.length;t++)if(Go.chapter[t][0]-30<=e&&Go.chapter[t][0]+30>=e){i+=`<div class="seekbar_tip_chapter">${Go.chapter[t][2]}</div>`;break}xt("replaytools_seekbar_tip").innerHTML=`\n\t\t\t\t${i}\n\t\t\t\t<div class="seekbar_tip_time">${n.m}:${n.s}.${n.ms}</div>\n\t\t\t\t${s}\n\t\t\t\t${o}\n\t\t\t\t${a}\n\t\t\t`}}})),xt("exit_replay").addEventListener("click",(function(){Io&&(Mo=!0,Eo="exit",Xo.forEach((e=>e.end())))})),xt("replaytools_button_backward_round").addEventListener("click",(function(){Io&&(Mo=!0,Eo="prev",Xo.forEach((e=>e.end())))})),xt("replaytools_button_forward_round").addEventListener("click",(function(){Io&&(Mo=!0,Eo="next",Xo.forEach((e=>e.end())))})),xt("replaytools_button_25x").addEventListener("click",(function(){Io&&Xo[0].playbackSpeed()&&Xo.forEach((e=>e.playbackSpeed(.25)))})),xt("replaytools_button_50x").addEventListener("click",(function(){Io&&Xo[0].playbackSpeed()&&Xo.forEach((e=>e.playbackSpeed(.5)))})),xt("replaytools_button_1x").addEventListener("click",(function(){Io&&Xo[0].playbackSpeed()&&Xo.forEach((e=>e.playbackSpeed(1)))})),xt("replaytools_button_2x").addEventListener("click",(function(){Io&&Xo[0].playbackSpeed()&&Xo.forEach((e=>e.playbackSpeed(2)))})),xt("replaytools_button_5x").addEventListener("click",(function(){Io&&Xo[0].playbackSpeed()&&Xo.forEach((e=>e.playbackSpeed(5)))})),xt("replaytools_button_10x").addEventListener("click",(function(){Io&&Xo[0].playbackSpeed()&&Xo.forEach((e=>e.playbackSpeed(10)))})),xt("replaytools_button_playpause").addEventListener("click",(function(){if(Io){if(Xo[0].playbackSpeed())return xt("replaytools_button_playpause").innerHTML="",void Xo.forEach((e=>e.playbackSpeed(0)));xt("replaytools_button_25x").classList.contains("active")?Xo.forEach((e=>e.playbackSpeed(.25))):xt("replaytools_button_50x").classList.contains("active")?Xo.forEach((e=>e.playbackSpeed(.5))):xt("replaytools_button_1x").classList.contains("active")?Xo.forEach((e=>e.playbackSpeed(1))):xt("replaytools_button_2x").classList.contains("active")?Xo.forEach((e=>e.playbackSpeed(2))):xt("replaytools_button_5x").classList.contains("active")?Xo.forEach((e=>e.playbackSpeed(5))):xt("replaytools_button_10x").classList.contains("active")&&Xo.forEach((e=>e.playbackSpeed(10))),xt("replaytools_button_playpause").innerHTML=""}})),xt("replaytools_button_forward_frame").addEventListener("click",(function(){if(!Io)return;if(xt("replaytools").classList.contains("disabled"))return;Xo[0].getFrame()>=zo||Xo.forEach((e=>e.advanceFrames(1)))})),xt("replaytools_button_forward_piece").addEventListener("click",(function(){if(!Io)return;if(xt("replaytools").classList.contains("disabled"))return;const e=Xo[0].getFrame();for(let t=0;t<Fo.length;t++)if(Fo[t]>e)return void Xo.forEach((n=>n.advanceFrames(Fo[t]-e)))})),xt("replaytools_button_forward_large").addEventListener("click",(function(){if(!Io)return;if(xt("replaytools").classList.contains("disabled"))return;const e=Xo[0].getFrame();e>=zo||Xo.forEach((t=>t.advanceFrames(Math.min(zo-e,300),!0)))})),xt("replaytools_button_backward_frame").addEventListener("click",(function(){Io&&(xt("replaytools").classList.contains("disabled")||Xo.forEach(((e,t)=>{s(e,So[t],1)})))})),xt("replaytools_button_backward_piece").addEventListener("click",(function(){if(!Io)return;if(xt("replaytools").classList.contains("disabled"))return;const e=Xo[0].getFrame();for(let t=Fo.length-1;t>=0;t--)if(Fo[t]<e)return void Xo.forEach(((n,i)=>{s(n,So[i],e-Fo[t])}))})),xt("replaytools_button_backward_large").addEventListener("click",(function(){Io&&(xt("replaytools").classList.contains("disabled")||Xo.forEach(((e,t)=>{s(e,So[t],300)})))})),xt("replaytools_seekbar").addEventListener("mousedown",(function(t){if(!Io)return;if(xt("replaytools").classList.contains("disabled"))return;e=!0;const s=Xo[0].getFrame(),i=Math.floor(Math.min(1,Math.max(0,(t.clientX-16)/(window.innerWidth-32)))*zo);s!==i&&Xo.forEach(((e,t)=>{n(e,So[t],i)}))})),document.addEventListener("mouseup",(()=>{Io&&(e=!1)})),document.addEventListener("mousemove",(()=>{if(Io){if(xt("replaytools").classList.contains("disabled"))return e=!1,void(t=!1);if(e){const e=Xo[0].getFrame(),t=Math.floor(Math.min(1,Math.max(0,(event.clientX-16)/(window.innerWidth-32)))*zo);e!==t&&Xo.forEach(((e,s)=>{n(e,So[s],t)}))}if(t){const e=Math.floor(Math.min(1,Math.max(0,(event.clientX-16)/(window.innerWidth-32)))*zo),t=e/zo*100;xt("replaytools_seekbar_tip").setAttribute("style",`--progress: ${t}%;`),xt("replaytools_seekbar").setAttribute("data-border-snapped",t<=10?"left":t>=90?"right":"none");const n=Bt(1e3*e/60);let s=0,i=0;for(let t=So[0].vs.length-1;t>=0;t--)if(So[0].vs[t][0]<=e){s=So[0].vs[t][1];break}for(let t=So[1].vs.length-1;t>=0;t--)if(So[1].vs[t][0]<=e){i=So[1].vs[t][1];break}xt("replaytools_seekbar_tip").innerHTML=`\n\t\t\t\t<div class="seekbar_tip_time">${n.m}:${n.s}.${n.ms}</div>\n\t\t\t\t<div class="seekbar_tip_stat"><span class="sl">${s.toFixed(2)}</span> VS --- <span class="sr">${i.toFixed(2)}</span> VS</div>\n\t\t\t`}}}))}));const jo="INTERFACE",qo="SPECIAL",Ko="BATTLE",Vo="CALM",Qo="HURT RECORD",Yo="TETR.IO";function Jo(e){this.name=e.name??"unknown",this.untranslatedName=e.untranslatedName??null,this.artist=e.artist??"UNKOWN",this.untranslatedArtist=e.untranslatedArtist??null,this.genre=e.genre??qo,this.source=e.source??"UNKNOWN",this.loop=e.loop??!1,this.loopStart=e.loopStart??0,this.loopEnd=e.loopEnd??null,this.hidden=e.hidden??!0}const Zo={"kuchu-toshi":{name:"aerial city",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:11.831,loopEnd:92.579,normalizeDb:-8.29},"shikiichi-made-mousukoshi":{name:"to the limit",untranslatedName:"",artist:"KAMIYA",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:3.719,loopEnd:93.031,normalizeDb:-10.47},touhoudaiensei:{name:"the great eastern expedition",untranslatedName:"",artist:"TAKAYUKI",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:10.694,loopEnd:216.68,normalizeDb:-8.51},"asayake-no-taiyou":{name:"morning sun",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:3.009,loopEnd:67.008,normalizeDb:-13.75},"in-sorrow-and-pains":{name:"in sorrow and pains",untranslatedName:"in sorrow and pains",artist:"MIRERA",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:4.503,loopEnd:98.533,normalizeDb:-12.44},"honemi-ni-shimiiru-karasukaze":{name:"piercing wind",untranslatedName:"",artist:"KVK",untranslatedArtist:"KVK",genre:Vo,source:Qo,loop:!0,loopStart:7.432,loopEnd:150.39,normalizeDb:-12.32},inorimichite:{name:"inorimichite",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:15.67,loopEnd:197.355,normalizeDb:-7.95},"kaze-no-sanpomichi":{name:"wind trail",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:12.865,loopEnd:227.149,normalizeDb:-6.42},"muscat-to-shiroi-osara":{name:"muscat and white dishes",untranslatedName:"",artist:"TAKAHASHI TAKASHI",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:8.853,loopEnd:192.853,normalizeDb:-6.21},"natsuzora-to-syukudai":{name:"summer sky and homework",untranslatedName:"",artist:"TAKAHASHI TAKASHI",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:20.885,loopEnd:132.882,normalizeDb:-5.98},"success-story":{name:"success story",untranslatedName:"success story",artist:"AKIKO SHIOYAMA",untranslatedArtist:"AKIKO SHIOYAMA",genre:jo,source:Qo,loop:!0,loopStart:25.342,loopEnd:103.749,normalizeDb:-3.85},"kaiser-hige-na-neko":{name:"classy cat",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:0,loopEnd:104.002,normalizeDb:-7.43},akindo:{name:"akindo",untranslatedName:"AKINDO",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:7.864,loopEnd:120.03,normalizeDb:-6.72},"hyper-velocity":{name:"hyper velocity",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:qo,source:Qo,loop:!1,loopStart:121.011,loopEnd:0,hidden:!0,normalizeDb:-9.56},philosophy:{name:"philosophy",untranslatedName:"philosophy",artist:"L-side",untranslatedArtist:"L-side",genre:jo,source:Qo,loop:!0,loopStart:9.324,loopEnd:122.774,normalizeDb:-7.27},"yoru-no-niji":{name:"rainbow of the night",untranslatedName:"",artist:"AIBA MAKOTO",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:3.651,loopEnd:144.036,normalizeDb:-7.72},"shiroi-hyoutan":{name:"white calabash",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:qo,source:Qo,loop:!0,loopStart:17.43,loopEnd:139.694,normalizeDb:-9.78},smoke:{name:"smoke",untranslatedName:"smoke",artist:"FUJINAWA KAZUHIKO",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:5.099,loopEnd:139.499,normalizeDb:-10.85},"aijin-sanka":{name:"lover's song",untranslatedName:"",artist:"OMEGANE",untranslatedArtist:"",genre:jo,source:Qo,loop:!0,loopStart:3.835,loopEnd:48.492,normalizeDb:-4.76},"akai-tsuchi-wo-funde":{name:"step on the scarlet soil",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:2.783,loopEnd:126.216,normalizeDb:-11.05},"burari-tokyo":{name:"hanging out in tokyo",untranslatedName:"TOKYO",artist:"MEESAN",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:9.68,loopEnd:144.039,normalizeDb:-10.36},"back-water":{name:"backwater",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:1.497,loopEnd:113.503,normalizeDb:-12.81},"burning-heart":{name:"burning heart",untranslatedName:"burning heart",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:0,loopEnd:76.803,normalizeDb:-14.81},"hayate-no-sei":{name:"storm spirit",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:24.815,loopEnd:120.752,normalizeDb:-14.8},"ice-eyes":{name:"ice eyes",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:6.867,loopEnd:96.013,normalizeDb:-13.36},"ima-koso":{name:"the time is now",untranslatedName:"",artist:"TOMOKI",untranslatedArtist:"TOMOKI",genre:Ko,source:Qo,loop:!0,loopStart:5.489,loopEnd:112.124,normalizeDb:-10.8},prism:{name:"prism",untranslatedName:"",artist:"AIBA MAKOTO",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:0,loopEnd:92.13,normalizeDb:-12.73},"risky-area":{name:"risky area",untranslatedName:"risky area",artist:"MIKIYA KOMABA",untranslatedArtist:"MIKIYA KOMABA",genre:Ko,source:Qo,loop:!0,loopStart:31.48,loopEnd:322.624,normalizeDb:-13.73},"fuyu-no-jinkoueisei":{name:"winter satellite",untranslatedName:"",artist:"SUDO MIKADUKI",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:25.956,loopEnd:175.128,normalizeDb:-12.45},hatsuyuki:{name:"first snow",untranslatedName:"",artist:"YOSHI",untranslatedArtist:"YOSHI",genre:Vo,source:Qo,loop:!0,loopStart:21.974,loopEnd:144.824,normalizeDb:-9.61},"kansen-gairo":{name:"main street",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:17.757,loopEnd:200.975,normalizeDb:-10.24},"chiheisen-wo-koete":{name:"over the horizon",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:2.423,loopEnd:66.402,normalizeDb:-13.81},"moyase-toushi-yobisamase-tamashii":{name:"burning spirit, awakening soul",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:15.38,loopEnd:70.238,normalizeDb:-16.2},"naraku-heno-abyssmaze":{name:"maze of the abyss",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:5.133,loopEnd:123.094,normalizeDb:-14.21},"samurai-sword":{name:"samurai sword",untranslatedName:"SAMURAI SWORD",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:6.587,loopEnd:112.184,normalizeDb:-15.75},"super-machine-soul":{name:"super machine soul",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:22.335,loopEnd:118.335,normalizeDb:-16.48},"uchuu-5239":{name:"universe 5239",untranslatedName:"5239",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:15.555,loopEnd:98.672,normalizeDb:-15.45},"ultra-super-heros":{name:"ultra super heroes",untranslatedName:"",artist:"KAMOKING",untranslatedArtist:"",genre:Ko,source:Qo,loop:!0,loopStart:1.315,loopEnd:106.273,normalizeDb:-13.55},"21seiki-no-hitobito":{name:"twenty-first century people",untranslatedName:"21",artist:"OMEGANE",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:0,loopEnd:131.311,normalizeDb:-10.97},"haru-wo-machinagara":{name:"waiting for spring to come",untranslatedName:"",artist:"OMEGANE",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:5.78,loopEnd:165.795,normalizeDb:-12.37},"go-go-go-summer":{name:"go go go summer",untranslatedName:"go go go summer",artist:"NOBUHAMU",untranslatedArtist:"NOBUHAMU",genre:Vo,source:Qo,loop:!0,loopStart:.838,loopEnd:75.499,normalizeDb:-15.57},"sasurai-no-hitoritabi":{name:"lonely journey",untranslatedName:"",artist:"NAOKI HIRAI",untranslatedArtist:"NAOKI HIRAI",genre:Vo,source:Qo,loop:!0,loopStart:4.044,loopEnd:149.198,normalizeDb:-13.55},wakana:{name:"young leaves",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:14.819,loopEnd:193.702,normalizeDb:-7.74},"zange-no-ma":{name:"confession",untranslatedName:"",artist:"OMEGANE",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:0,loopEnd:80.533,normalizeDb:-5.35},"subarashii-nichijou":{name:"amazing everyday",untranslatedName:"",artist:"TSUTOMU",untranslatedArtist:"TSUTOMU",genre:Vo,source:Qo,loop:!0,loopStart:12.399,loopEnd:140.399,normalizeDb:-14.1},asphalt:{name:"asphalt",untranslatedName:"asphalt",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:5.624,loopEnd:75.335,normalizeDb:-7.51},"madobe-no-hidamari":{name:"by the sunlit window",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:26.203,loopEnd:91.775,normalizeDb:-6.41},minamoto:{name:"origin",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:135.024,loopEnd:322.95,normalizeDb:-6.73},"sora-no-sakura":{name:"cherry blossom season",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:0,loopEnd:336.018,normalizeDb:-10.23},suiu:{name:"raindrops",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:15.058,loopEnd:121.636,normalizeDb:-5.79},"freshherb-wreath-wo-genkan-ni":{name:"entrance wreath",untranslatedName:"",artist:"CHIKA",untranslatedArtist:"",genre:Vo,source:Qo,loop:!0,loopStart:5.169,loopEnd:89.504,normalizeDb:-7.8},zenith:{name:"zenith tower",untranslatedName:null,artist:"DR OCELOT",untranslatedArtist:null,hidden:!0,genre:qo,source:Yo}},ea={calm:["kaze-no-sanpomichi","honemi-ni-shimiiru-karasukaze","inorimichite","muscat-to-shiroi-osara","natsuzora-to-syukudai","akindo","yoru-no-niji","akai-tsuchi-wo-funde","burari-tokyo","prism","fuyu-no-jinkoueisei","hatsuyuki","kansen-gairo","21seiki-no-hitobito","haru-wo-machinagara","go-go-go-summer","sasurai-no-hitoritabi","wakana","zange-no-ma","subarashii-nichijou","asphalt","madobe-no-hidamari","minamoto","sora-no-sakura","suiu","freshherb-wreath-wo-genkan-ni"],battle:["back-water","burning-heart","hayate-no-sei","ice-eyes","ima-koso","risky-area","chiheisen-wo-koete","moyase-toushi-yobisamase-tamashii","naraku-heno-abyssmaze","samurai-sword","super-machine-soul","uchuu-5239","ultra-super-heros"]};ea.random=[...ea.calm,...ea.battle],Object.freeze(ea);const ta={MENUS:0,SPECTATOR:1,PLAYING:2},na=(()=>{const e=new AudioContext,t=-2,n=new Map;let s=null,i=null,o=null,a=0;const r=e.createGain();r.connect(e.destination);const l=e.createBiquadFilter();async function p(r,c,p){if(i===r)return;p=null==p?0:p+e.currentTime,null!=i&&h(),await d(r);const u=await e.decodeAudioData(n.get(r).slice(0));if(a!==c)return;s=e.createBufferSource(),s.buffer=u,s.loop=Zo[r].loop,s.loopStart=Zo[r].loopStart,s.loopEnd=Zo[r].loopEnd,o=e.createGain(),o.connect(l);const _=e.createGain();let m=t;const g=Zo[r].normalizeDb;g&&(m+=g),_.gain.setValueAtTime(Math.pow(10,m/20),e.currentTime),_.connect(o),s.connect(_),s.start(p),i=r}async function d(e){if(!0===it.volume.disable)return;if(n.has(e))return;if(!Zo[e])throw new Error(`BGM List does not contain ${e}.`);const t=await(await fetch(`res/bgm/${e}.mp3`)).arrayBuffer();n.set(e,t)}function h(){null!=s&&(s.stop(),s=null,i=null)}l.type="lowpass",l.frequency.setValueAtTime(3e4,e.currentTime),l.connect(r);const u=1;function _(t=u){if(!0===it.volume.disable)return;if(null==s)return;if("zenith"===s)return void function(){if(!ue)return;const t=e.currentTime,n=t+1;se.gain.setValueAtTime(1,t),se.gain.linearRampToValueAtTime(0,n),ue=!1,he=!1,te.clear()}();const n=e.currentTime+t;o.gain.setValueAtTime(1,e.currentTime),o.gain.exponentialRampToValueAtTime(.01,n),s.stop(n),s=null,i=null}function m(e,t=u){if(null==e||""===e)return;if(!0===it.volume.disable)return;if(i===e)return;a++;const n=null==i?0:t;return _(n),p(e,a,n)}function g(e){let t=0;switch((it.volume.bgmtweak||{})[e]||"base"){case"ban":t=0;break;case"minmin":t=1;break;case"min":t=2;break;case"base":t=4;break;case"plus":t=8;break;case"plusplus":t=16}return t}const f=c;let b;const C=new WeakMap,x=["mission","mission_free","mission_versus","mission_league","cutin_superlobby","victory","failure","matchintro"],A=["social_dm","social_invite","social_notify_major","social_notify_minor","social_offline","social_online"];let y=0,v=-1e4;const B=10;const w="floor1",L="floor2",k="floor3",S="floor4",F="floor5",z="floor6",T="floor7",I="floor8",M="floor9",E="floor10",D="speedrun",O="floor1-expert",H={bpm:184,beatsPerBar:4},P={bpm:110,beatsPerBar:4},R={bpm:120,beatsPerBar:4},W={bpm:180,beatsPerBar:5},$={bpm:130,beatsPerBar:4},N={bpm:130,beatsPerBar:4},U={bpm:120,beatsPerBar:4},G={bpm:150,beatsPerBar:4},X={bpm:160,beatsPerBar:4},j={bpm:100,beatsPerBar:4},q={bpm:100,beatsPerBar:3},K={bpm:240,beatsPerBar:4},V=["spec-arp","spec-bass","spec-guitar","spec-pad","spec-staccato","spec-violin"],Q=[...V,O],Y=[O],J={"spec-intro":{start:0,len:re(8,H),next:"spec-begin","next-pullToStart":"spec-away-1",layers:{specdrums:{start:re(89,H,1e5),loopEnd:re(90,H,1e5),loop:!0}},dynLayers:Q,buffer:w,timing:H},"spec-begin":{start:re(8,H),len:re(8,H),next:"spec-1","next-pullToStart":"spec-away-1",layers:{specdrums:{start:re(89,H,1e5),loopEnd:re(90,H,1e5),loop:!0}},dynLayers:Q,buffer:w,timing:H},"spec-1":{start:re(16,H),len:re(16,H),next:"spec-2","next-pullToStart":"spec-away-2",layers:{specdrums:{start:re(89,H,1e5),loopEnd:re(90,H,1e5),loop:!0}},dynLayers:Q,buffer:w,timing:H},"spec-2":{start:re(32,H),len:re(32,H),next:"spec-3","next-pullToStart":"spec-away-3",layers:{specdrums:{start:re(89,H,1e5),loopEnd:re(90,H,1e5),loop:!0}},dynLayers:Q,buffer:w,timing:H},"spec-3":{start:re(64,H),len:re(24,H),next:"spec-begin","next-pullToStart":"spec-away-1",layers:{specdrums:{start:re(89,H,1e5),loopEnd:re(90,H,1e5),loop:!0}},dynLayers:Q,buffer:w,timing:H},"spec-away-1":{start:re(91,H),len:re(1,H),next:"floor1-intro",dynLayers:Q,buffer:w,timing:H},"spec-away-2":{start:re(92,H),len:re(1,H),next:"floor1-intro",dynLayers:Q,buffer:w,timing:H},"spec-away-3":{start:re(93,H),len:re(1,H),next:"floor1-intro",dynLayers:Q,buffer:w,timing:H},"floor1-intro":{start:re(94,H),len:re(8,H),next:"floor1-loop","next-end":"floor1-end","next-gte":{[me.FloorDistance[1]]:"floor2-intro"},"next-speedrun":"speedrun-intro-floor1",dynLayers:Y,buffer:w,timing:H,preload:L},"floor1-loop":{start:re(102,H),len:re(56,H),next:"floor1-loop","next-end":"floor1-end","next-gte":{[me.FloorDistance[1]]:"floor2-intro"},"next-speedrun":"speedrun-intro-floor1",dynLayers:Y,buffer:w,timing:H,preload:L},"floor1-end":{start:re(159,H),len:re(2,H),next:"spec-intro","next-pullToStart":"floor1-quick-start",dynLayers:Y,buffer:w,timing:H},"floor1-quick-start":{start:re(158,H),len:re(1,H),next:"floor1-intro","next-end":"floor1-end",dynLayers:Y,buffer:w,timing:H},"floor2-intro":{start:re(0,P),len:re(12,P),next:"floor2-loop","next-end":"floor2-end","next-gte":{[me.FloorDistance[2]]:"floor3-intro-1"},"next-speedrun":"speedrun-intro-floor2",buffer:L,timing:P,preload:k},"floor2-loop":{start:re(12,P),len:re(40,P),next:"floor2-loop","next-end":"floor2-end","next-gte":{[me.FloorDistance[2]]:"floor3-intro-1"},"next-speedrun":"speedrun-intro-floor2",buffer:L,timing:P,preload:k},"floor2-end":{start:re(52,P),len:re(2,P),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:L,timing:P,preload:w},"floor3-intro-1":{start:re(0,R),len:re(6,R),next:"floor3-intro-2","next-end":"floor3-end-calm","next-floor3-runahead":"floor3-intense-intro","next-gte":{[me.FloorDistance[3]]:"floor4-intro"},"next-speedrun":"speedrun-intro-floor3-soft",buffer:k,timing:R,preload:S},"floor3-intro-2":{start:re(6,R),len:re(6,R),next:"floor3-intro-3","next-end":"floor3-end-calm","next-floor3-runahead":"floor3-intense-intro","next-gte":{[me.FloorDistance[3]]:"floor4-intro"},"next-speedrun":"speedrun-intro-floor3-soft",buffer:k,timing:R,preload:S},"floor3-intro-3":{start:re(12,R),len:re(6,R),next:"floor3-intro-4","next-end":"floor3-end-calm","next-floor3-runahead":"floor3-intense-intro","next-gte":{[me.FloorDistance[3]]:"floor4-intro"},"next-speedrun":"speedrun-intro-floor3-soft",buffer:k,timing:R,preload:S},"floor3-intro-4":{start:re(18,R),len:re(6,R),next:"floor3-intense-intro","next-end":"floor3-end-calm","next-gte":{[me.FloorDistance[3]]:"floor4-intro"},"next-speedrun":"speedrun-intro-floor3-soft",buffer:k,timing:R,preload:S},"floor3-intense-intro":{start:re(24,R),len:re(4,R),next:"floor3-intense-loop","next-end":"floor3-end-intense","next-gte":{[me.FloorDistance[3]]:"floor4-intro"},"next-speedrun":"speedrun-intro-floor3-hard",buffer:k,timing:R,preload:S},"floor3-intense-loop":{start:re(28,R),len:re(36,R),next:"floor3-intense-loop","next-end":"floor3-end-intense","next-gte":{[me.FloorDistance[3]]:"floor4-intro"},"next-speedrun":"speedrun-intro-floor3-hard",buffer:k,timing:R,preload:S},"floor3-end-calm":{start:re(64,R),len:re(2,R),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:k,timing:R,preload:w},"floor3-end-intense":{start:re(66,R),len:re(2,R),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:k,timing:R,preload:w},"floor4-intro":{start:re(0,W),len:re(8,W),next:"floor4-loop","next-end":"floor4-end","next-gte":{[me.FloorDistance[4]]:"floor5-intro"},"next-speedrun":"speedrun-intro-floor4",layers:{arena:{start:re(58,W)}},buffer:S,timing:W,preload:F},"floor4-loop":{start:re(8,W),len:re(48,W),next:"floor4-loop","next-end":"floor4-end","next-gte":{[me.FloorDistance[4]]:"floor5-intro"},"next-speedrun":"speedrun-intro-floor4",layers:{arena:{start:re(66,W)}},buffer:S,timing:W,preload:F},"floor4-end":{start:re(56,W),len:re(2,W),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:S,timing:W,preload:w},"floor5-intro":{start:re(0,$),len:re(36,$),next:"floor5-loop","next-end":"floor5-end","next-gte":{[me.FloorDistance[5]]:"floor6-intro"},"next-speedrun":"speedrun-intro-floor5",buffer:F,timing:$,preload:z},"floor5-loop":{start:re(36,$),len:re(56,$),next:"floor5-loop","next-end":"floor5-end","next-gte":{[me.FloorDistance[5]]:"floor6-intro"},"next-speedrun":"speedrun-intro-floor5",buffer:F,timing:$,preload:z},"floor5-end":{start:re(92,$),len:re(2,$),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:F,timing:$,preload:w},"floor6-intro":{start:re(0,N),len:re(16,N),next:"floor6-loop","next-end":"floor6-end","next-gte":{[me.FloorDistance[6]]:"floor7-intro-1"},"next-speedrun":"speedrun-intro-floor6",buffer:z,timing:N,preload:T},"floor6-loop":{start:re(16,N),len:re(40,N),next:"floor6-loop","next-end":"floor6-end","next-gte":{[me.FloorDistance[6]]:"floor7-intro-1"},"next-speedrun":"speedrun-intro-floor6",buffer:z,timing:N,preload:T},"floor6-end":{start:re(56,N),len:re(2,N),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:z,timing:N,preload:w},"floor7-intro-1":{start:re(0,U),len:re(4,U),next:"floor7-intro-2","next-end":"floor7-end","next-floor7-runahead":"floor7-intro-4","next-gte":{[me.FloorDistance[7]]:"floor8-intro"},"next-speedrun":"speedrun-intro-floor7",buffer:T,timing:U,preload:I},"floor7-intro-2":{start:re(4,U),len:re(4,U),next:"floor7-intro-3","next-end":"floor7-end","next-floor7-runahead":"floor7-intro-4","next-gte":{[me.FloorDistance[7]]:"floor8-intro"},"next-speedrun":"speedrun-intro-floor7",buffer:T,timing:U,preload:I},"floor7-intro-3":{start:re(8,U),len:re(8,U),next:"floor7-intro-4","next-end":"floor7-end","next-gte":{[me.FloorDistance[7]]:"floor8-intro"},"next-speedrun":"speedrun-intro-floor7",buffer:T,timing:U,preload:I},"floor7-intro-4":{start:re(16,U),len:re(48,U),next:"floor7-loop","next-end":"floor7-end","next-gte":{[me.FloorDistance[7]]:"floor8-intro"},"next-speedrun":"speedrun-intro-floor7",buffer:T,timing:U,preload:I},"floor7-loop":{start:re(64,U),len:re(32,U),next:"floor7-loop","next-end":"floor7-end","next-gte":{[me.FloorDistance[7]]:"floor8-intro"},"next-speedrun":"speedrun-intro-floor7",buffer:T,timing:U,preload:I},"floor7-end":{start:re(96,U),len:re(2,U),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:T,timing:U,preload:w},"floor8-intro":{start:re(0,G),len:re(24,G),next:"floor8-loop","next-end":"floor8-end","next-gte":{[me.FloorDistance[8]]:"floor9-intro"},"next-speedrun":"speedrun-intro-floor8",buffer:I,timing:G,preload:M},"floor8-loop":{start:re(24,G),len:re(60,G),next:"floor8-loop","next-end":"floor8-end","next-gte":{[me.FloorDistance[8]]:"floor9-intro"},"next-speedrun":"speedrun-intro-floor8",buffer:I,timing:G,preload:M},"floor8-end":{start:re(84,G),len:re(2,G),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:I,timing:G,preload:w},"floor9-intro":{start:re(0,X),len:re(24,X),next:"floor9-loop","next-end":"floor9-end","next-gte":{[me.FloorDistance[9]]:"floor10-intro-start"},"next-speedrun":"speedrun-intro-floor9",buffer:M,timing:X,preload:E},"floor9-loop":{start:re(24,X),len:re(72,X),next:"floor9-loop","next-end":"floor9-end","next-gte":{[me.FloorDistance[9]]:"floor10-intro-start"},"next-speedrun":"speedrun-intro-floor9",buffer:M,timing:X,preload:E},"floor9-end":{start:re(96,X),len:re(2,X),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:M,timing:X,preload:w},"floor10-intro-start":{start:re(0,j),len:re(1,j),next:"floor10-intro-1","next-end":"floor10-end-soft",buffer:E,timing:j},"floor10-intro-1":{start:re(1,j),len:re(34,j),next:"floor10-intro-2","next-end":"floor10-end-soft",buffer:E,timing:j},"floor10-intro-2":{start:re(35,j),len:re(7,q),next:"floor10-intro-3","next-end":"floor10-end-soft",buffer:E,timing:q},"floor10-intro-3":{start:re(35,j)+re(7,q),len:re(1,q),next:"floor10-intro-4","next-end":"floor10-end-hard",buffer:E,timing:q},"floor10-intro-4":{start:re(35,j)+re(8,q),len:re(10,j),next:"floor10-loop-1","next-end":"floor10-end-hard",buffer:E,timing:j},"floor10-loop-1":{start:re(45,j)+re(8,q),len:re(30,j),next:"floor10-loop-2","next-end":"floor10-end-hard",buffer:E,timing:j},"floor10-loop-2":{start:re(75,j)+re(8,q),len:re(8,q),next:"floor10-loop-3","next-end":"floor10-end-hard",buffer:E,timing:q},"floor10-loop-3":{start:re(75,j)+re(16,q),len:re(10,j),next:"floor10-loop-1","next-end":"floor10-end-hard",buffer:E,timing:j},"floor10-end-hard":{start:re(85,j)+re(16,q),len:re(2,j),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:E,timing:j,preload:w},"floor10-end-soft":{start:re(87,j)+re(16,q),len:re(2,j),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:E,timing:j,preload:w},"speedrun-intro-floor1":{start:re(0,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor2":{start:re(2,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor3-soft":{start:re(4,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor3-hard":{start:re(6,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor4":{start:re(8,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor5":{start:re(10,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor6":{start:re(12,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor7":{start:re(14,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor8":{start:re(16,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-intro-floor9":{start:re(18,K),len:re(2,K),next:"speedrun-evo-1","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0},"speedrun-evo-1":{start:re(20,K),len:re(32,K),next:"speedrun-evo-2","next-end":"speedrun-end-1",buffer:D,timing:K,speedrunEvo:0,preload:E},"speedrun-evo-2":{start:re(52,K),len:re(16,K),next:"speedrun-evo-3","next-end":"speedrun-end-2",buffer:D,timing:K,speedrunEvo:1,preload:E},"speedrun-evo-3":{start:re(68,K),len:re(8,K),next:"speedrun-evo-4","next-end":"speedrun-end-3",buffer:D,timing:K,speedrunEvo:2,preload:E},"speedrun-evo-4":{start:re(76,K),len:re(8,K),next:"speedrun-evo-5","next-end":"speedrun-end-3",buffer:D,timing:K,speedrunEvo:2,preload:E},"speedrun-evo-5":{start:re(84,K),len:re(32,K),next:"speedrun-evo-6","next-end":"speedrun-end-4",buffer:D,timing:K,speedrunEvo:2,preload:E},"speedrun-evo-6":{start:re(116,K),len:re(24,K),next:"speedrun-evo-4","next-end":"speedrun-end-3",buffer:D,timing:K,speedrunEvo:2,preload:E},"speedrun-end-1":{start:re(144,K),len:re(2,K),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:D,timing:K,preload:w},"speedrun-end-2":{start:re(146,K),len:re(2,K),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:D,timing:K,preload:w},"speedrun-end-3":{start:re(140,K),len:re(2,K),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:D,timing:K,preload:w},"speedrun-end-4":{start:re(142,K),len:re(2,K),next:"spec-intro","next-pullToStart":"floor1-quick-start",buffer:D,timing:K,preload:w},"speedrun-return-1":{start:re(161,H),len:re(2,H),next:"floor1-loop","next-end":"floor1-end","next-gte":{[me.FloorDistance[1]]:"floor2-intro"},"next-speedrun":"speedrun-intro-floor1",dynLayers:Y,buffer:w,timing:H,preload:L},"speedrun-return-2":{start:re(54,P),len:re(2,P),next:"floor2-loop","next-end":"floor2-end","next-gte":{[me.FloorDistance[2]]:"floor3-intro-1"},"next-speedrun":"speedrun-intro-floor2",buffer:L,timing:P,preload:k},"speedrun-return-3":{start:re(68,R),len:re(2,R),next:"floor3-intense-loop","next-end":"floor3-end-calm","next-gte":{[me.FloorDistance[3]]:"floor4-intro"},"next-speedrun":"speedrun-intro-floor3-soft",buffer:k,timing:R,preload:S},"speedrun-return-4":{start:re(114,W),len:re(2,W),next:"floor4-loop","next-end":"floor4-end","next-gte":{[me.FloorDistance[4]]:"floor5-intro"},"next-speedrun":"speedrun-intro-floor4",layers:{arena:{start:re(116,W)}},buffer:S,timing:W,preload:F},"speedrun-return-5":{start:re(94,$),len:re(2,$),next:"floor5-loop","next-end":"floor5-end","next-gte":{[me.FloorDistance[5]]:"floor6-intro"},"next-speedrun":"speedrun-intro-floor5",buffer:F,timing:$,preload:z},"speedrun-return-6":{start:re(58,N),len:re(2,N),next:"floor6-loop","next-end":"floor6-end","next-gte":{[me.FloorDistance[6]]:"floor7-intro-1"},"next-speedrun":"speedrun-intro-floor6",buffer:z,timing:N,preload:T},"speedrun-return-7":{start:re(98,U),len:re(2,U),next:"floor7-intro-4","next-end":"floor7-end","next-gte":{[me.FloorDistance[7]]:"floor8-intro"},"next-speedrun":"speedrun-intro-floor7",buffer:T,timing:U,preload:I},"speedrun-return-8":{start:re(86,G),len:re(2,G),next:"floor8-loop","next-end":"floor8-end","next-gte":{[me.FloorDistance[8]]:"floor9-intro"},"next-speedrun":"speedrun-intro-floor8",buffer:I,timing:G,preload:M},"speedrun-return-9":{start:re(98,X),len:re(2,X),next:"floor9-loop","next-end":"floor9-end","next-gte":{[me.FloorDistance[9]]:"floor10-intro-1"},"next-speedrun":"speedrun-intro-floor9",buffer:M,timing:X,preload:E},"speedrun-return-10":{start:re(89,j)+re(16,q),len:re(1,j),next:"floor10-intro-1","next-end":"floor10-end-soft",buffer:E,timing:j}},Z=new Map,ee=new Set,te=new Map,ne=new Set;let se=null,ie={};const oe=["arena","specdrums",...Q];const ae=(new Audio).canPlayType("audio/ogg")?"ogg":"m4a";function re(e,t,n=1e3){return Math.round(e*t.beatsPerBar*60/t.bpm*n)/n}let le=null,ce=[],pe=!1,de=!1,he=!1,ue=!1,_e=ta.MENUS,ge=0,fe=0;let be=0;function Ce(){le={},le.primary=[],ce=le.primary}const xe=new Set,Ae=new Set,ye=new Set(V);let ve=e.currentTime;let Be,we=!1,Le=ta.MENUS,ke=!1,Se=!1;function Fe(t,n){const s=J[t];if(!te.has(s.buffer))return Z.has(s.buffer)||ee.has(s.buffer)?Z.has(s.buffer)&&!ne.has(s.buffer)&&De(s.buffer):Oe(s.buffer),null;const i=n+s.len,o=e.createBufferSource();o.buffer=te.get(s.buffer),o.connect(se),o.start(n,s.start,s.len);const a=[];if(null!=s.layers)for(const[t,i]of Object.entries(s.layers)){const o=e.createBufferSource();o.buffer=te.get(s.buffer),o.connect(ie.get(t)),i.loop&&(o.loop=!0,o.loopStart=i.start,o.loopEnd=i.loopEnd),o.start(n,i.start,s.len),a.push(o)}const r={name:t,src:o,startTime:n,endTime:i,cancel:0,data:s,layerSrcs:a,enabledDynLayers:new Set};return ze(r),r}function ze(e){for(const t of xe.keys())Ie(e,t)}function Te(e){return Z.has(e)?!!te.has(e)||(De(e),!1):(Oe(e),!1)}function Ie(t,n){if(t.enabledDynLayers.has(n))return!1;if(null==t.data.dynLayers)return!1;if(-1===t.data.dynLayers.indexOf(n))return!1;if(!Te(n))return!1;t.enabledDynLayers.add(n);const s=e.createBufferSource();if(s.buffer=te.get(n),s.connect(ie.get(n)),t.startTime<e.currentTime){s.start(e.currentTime,t.data.start+(e.currentTime-t.startTime),t.endTime-e.currentTime)}else s.start(t.startTime,t.data.start,t.data.len);return t.layerSrcs.push(s),!0}function Me(e,t,n,s=!1){const i=Fe(e,n);if(null==i)return!1;if(s){for(let e=1;e<t.length;e++){t[e].src.stop();for(const n of t[e].layerSrcs)n.stop()}t.length=1}return t.push(i),!0}function Ee(t,n,s,i=-1){if(!(s<=ce[0].cancel)){if(-1===i){i=0;let t=0;for(;i<e.currentTime;)i=ce[0].startTime+re(t,n),t++}if(Me(t,ce,i,!0)){ce[0].src.stop(i);for(const e of ce[0].layerSrcs)e.stop(i);ce[0].cancel=s,ce[0].endTime=i}}}async function De(t){Z.has(t)&&(ne.has(t)||te.has(t)||(ne.add(t),te.set(t,await e.decodeAudioData(Z.get(t).slice(0))),ne.delete(t)))}async function Oe(e){if(!0===it.volume.disable)return;if(Z.has(e))return;if(ee.has(e))return;ee.add(e);const t=await(await fetch(`res/bgm/zenith/${e}.${ae}`)).arrayBuffer();Z.set(e,t),ee.delete(e)}function He(){if(!ue||!0===it.volume.disable||null==ce[0])return{progressToNextBeat:0,currentBeatInBar:0,beatsPerBar:0};const t=ce[0].data.timing,n=(e.currentTime-ce[0].startTime)/(60/t.bpm);return{progressToNextBeat:n%1,currentBeatInBar:Math.floor(n%t.beatsPerBar),beatsPerBar:t.beatsPerBar}}function Pe(){if(null==Be)return;xt("radiance_loading").innerHTML=Array.from(ee.keys()).sort().join("<br>");let t=0,n=0;xt("radiance_cached").innerHTML=Array.from(Z.entries()).sort().map((e=>{const n=e[1].byteLength/1048576;return t+=n,`${e[0]} (${n.toFixed(2)}MB)`})).join("<br>"),xt("radiance_decoding").innerHTML=Array.from(ne.keys()).sort().join("<br>"),xt("radiance_inmem").innerHTML=Array.from(te.entries()).sort().map((e=>{const t=e[1],s=t.numberOfChannels*t.length*4/1048576;return n+=s,`${e[0]} (${s.toFixed(2)}MB)`})).join("<br>"),xt("radiance_queue").innerHTML=ce.map((t=>{if(e.currentTime<t.startTime)return t.name;return`${t.name}&nbsp;&nbsp;&nbsp;${(t.endTime-e.currentTime).toFixed(2)}`})).join("<br>"),xt("radiance_cachetotal").textContent=`${t.toFixed(2)}MB`,xt("radiance_memtotal").textContent=`${n.toFixed(2)}MB`;const s=He();xt("radiance_barinfo").textContent=`${s.currentBeatInBar+1} / ${s.beatsPerBar}`}return{LoadBgmFile:d,SetBgmVolume:function(e){!0!==it.volume.disable&&(r.gain.value=e)},SetBGMLowPassFilter:function(t){!0!==it.volume.disable&&(l.frequency.setValueAtTime(l.frequency.value,e.currentTime),l.frequency.exponentialRampToValueAtTime(t?450:3e4,e.currentTime+.3))},PlayBgmSmoothly:m,PlayBgmSmoothlyWithRandom:async function(e,t=u){if(null!=e&&""!==e&&!0!==it.volume.disable){if("RANDOM"===e.substring(0,6)){const n=6===e.length?"random":e.substring(6);if(null==ea[n])throw new Error(`There is no random OST pool with the id of ${n}`);const s=function(e){const t=[];for(let n=0;n<e.length;n++){const s=g(e[n]);t[n]=(t[n-1]||0)+s}const n=t[t.length-1],s=Math.random()*n;let i=null;for(let n=0;n<e.length;n++)if(0!==t[n]&&s<=t[n]){i=e[n];break}return null===i?e[Math.floor(Math.random()*e.length)]:i}(ea[n]);return await m(s,t),void Bi(s)}await m(e,t),Bi(e)}},KillBgm:h,FadeOutBgm:_,GetCurrentBgm:function(){return i},InitSe:async function(){const t=`/sfx/tetrio.${""===(new Audio).canPlayType("audio/ogg")?"mp3":"ogg"}${window.HARD_VER?`?hv=${window.HARD_VER}`:""}`,n=await(await fetch(t)).arrayBuffer();b=await e.decodeAudioData(n),kn.finishLoad("sfx")},PlaySe:function(t,n=1,s=0){if(null==f[t])return null;if(!0===it.volume.disable)return null;if(null==b)return null;const i=function(e,t){return x.includes(e)?Math.min(t*it.volume.music,it.volume.music):it.notifications.forcesound&&A.includes(e)?1:Math.min(t*it.volume.sfx,it.volume.sfx)}(t,n);if(i<=0)return null;const o=e.createBufferSource();o.buffer=b;const a=e.createGain();a.connect(e.destination);const r=e.createStereoPanner();r.connect(a),o.connect(r),a.gain.value=i,"minimal"!==it.video.graphics&&(r.pan.value=s),"minimal"!==it.video.graphics&&"elim"===t&&(!function(){const t=e.currentTime;t-v>B&&(y=0);y++,v=t}(),o.playbackRate.value=Math.min(2,Math.pow(1.05946,y-1)));const l=f[t];o.start(e.currentTime,l[0]/1e3,l[1]/1e3);const c={};return C.set(c,o),c},StopSe:function(e){if(!0===it.volume.disable)return;const t=C.get(e);null!=t&&t.stop()},Update:function(){if(!0===it.volume.disable)return;if(!he)return!de&&te.size>0&&te.clear(),void(pe&&Pe());for(ue||(ce.push(Fe(_e===ta.PLAYING?"floor1-quick-start":"spec-intro",e.currentTime)),ue=!0);null!=ce[1]&&ce[0].endTime<e.currentTime;)ce.shift();const t=ce[ce.length-1];t.endTime-e.currentTime<5&&ce[0].cancel<=0&&Me(t.data.next,ce,t.endTime);const n=ce[0].data.preload;if(n&&(Z.has(n)?De(n):Oe(n)),Le===ta.MENUS&&_e===ta.SPECTATOR){const t=ie.get("specdrums").gain;t.setValueAtTime(t.value,e.currentTime),t.linearRampToValueAtTime(1,e.currentTime+.5)}if(Le===ta.SPECTATOR&&_e===ta.MENUS){const t=ie.get("specdrums").gain;t.setValueAtTime(t.value,e.currentTime),t.linearRampToValueAtTime(0,e.currentTime+.5)}if(Le!==ta.PLAYING&&_e===ta.PLAYING&&(ie.get("arena").gain.setValueAtTime(0,e.currentTime),we=!1),!we&&ge>=335){const t=ie.get("arena").gain;t.setValueAtTime(t.value,e.currentTime),t.linearRampToValueAtTime(1,e.currentTime+5),we=!0}if(Se&&_e!==ta.SPECTATOR?Ae.add(O):Ae.delete(O),e.currentTime>=ve){const t=new Set(Ae);t.delete(O);const n=e=>e.size>0?[...e][Math.floor(Math.random()*e.size)]:null,s=()=>{const e=n(ye);ye.delete(e),Ae.add(e)},i=()=>{const e=n(t);Ae.delete(e),ye.add(e)},o=()=>{const e=n(ye),s=n(t);Ae.delete(s),Ae.add(e),ye.delete(e),ye.add(s)},a=new Set;Ae.size<3&&a.add(s),Ae.size>2&&(a.add(i),a.add(o)),n(a)();const r=40*Math.random()+20;ve=e.currentTime+r}for(const t of Q){const n=xe.has(t);if(n===Ae.has(t))continue;const s=t===O?.5:6,i=ie.get(t).gain;if(n)if(i.value>=.999999)i.setValueAtTime(i.value,e.currentTime),i.linearRampToValueAtTime(0,e.currentTime+s);else{if(!(i.value<=1e-6))continue;xe.delete(t)}else{if(!Te(t))continue;Oe(t),xe.add(t),i.setValueAtTime(i.value,e.currentTime),i.linearRampToValueAtTime(1,e.currentTime+s)}}if(e.currentTime-be>=.25){for(let e=0;e<ce.length;e++){ze(ce[e])}be=e.currentTime}null!=ce[0].data["next-pullToStart"]&&_e==ta.PLAYING&&Ee(ce[0].data["next-pullToStart"],ce[0].data.timing,3),null!=ce[0].data["next-end"]&&_e!=ta.PLAYING&&Ee(ce[0].data["next-end"],ce[0].data.timing,4);const s=ce[0].data["next-gte"];if(s)for(const[e,t]of Object.entries(s)){ge>=e&&Ee(t,ce[0].data.timing,2);break}null!=ce[0].data["next-speedrun"]&&ke&&Ee(ce[0].data["next-speedrun"],ce[0].data.timing,3);const i=me.GetFloorLevel(ge);if(null==ce[0].data.speedrunEvo||ke||Ee(`speedrun-return-${i}`,ce[0].data.timing,3),null!=ce[0].data["next-floor3-runahead"]&&ge>=210&&Ee(ce[0].data["next-floor3-runahead"],ce[0].data.timing,1,ce[0].endTime),null!=ce[0].data["next-floor7-runahead"]&&ge>=970&&Ee(ce[0].data["next-floor7-runahead"],ce[0].data.timing,1,ce[0].endTime),e.currentTime-fe>=1){const t=new Set;for(let e=0;e<ce.length;e++)if(t.add(ce[e].data.buffer),ce[e].data.dynLayers)for(const n of ce[e].data.dynLayers)xe.has(n)&&t.add(n);const n=ce[0].data.preload;n&&t.add(n),ke&&t.add(D);const s=new Set;for(const e of te.keys())t.has(e)||s.add(e);for(const e of s.keys())te.delete(e);fe=e.currentTime}pe&&Pe(),Le=_e},ZenithStart:async function(){if(!0===it.volume.disable)return;_(u),Ce(),a++;const t=a;if(de=!0,await Oe(w),await De(w),a===t){_e=ta.MENUS,Ce(),function(){se=e.createGain(),se.connect(l),ie=new Map;for(const t of oe)ie.set(t,e.createGain());for(const t of ie.values())t.connect(se),t.gain.setValueAtTime(0,e.currentTime)}(),ve=0,xe.clear(),Ae.clear();for(const e of V)ye.add(e);s="zenith",he=!0,de=!1,Bi("zenith")}},ZenithSetState:function(e){_e=e},ZenithSetHeight:function(e){ge=e},ZenithGetTimingInfo:He,ZenithGetSpeedrunEvo:function(){return!0===it.volume.disable?0:ce[0].data.speedrunEvo??0},ZenithSetSpeedrun:function(e){ke=e},ZenithStartDebug:function(){Be=function(){const e=document.createElement("div");return e.classList.add("radianceinfo_root"),e.classList.add("zenithsongdebug_root"),e.innerHTML='\n\t\t<h1>Radiance Zenith Debug</h1>\n\t\t<div>\n\t\t\t<div class="col loadblock">\n\t\t\t\t<b>Downloading:</b><div id="radiance_loading"></div>\n\t\t\t\t<br>\n\t\t\t</div>\n\t\t\t<div class="col loadblock">\n\t\t\t\t<b>Decoding:</b><div id="radiance_decoding"></div>\n\t\t\t\t<br>\n\t\t\t</div>\n\t\t\t<div class="full cacheblock">\n\t\t\t\t<b>Cached: (<span id="radiance_cachetotal"></span>)</b><div id="radiance_cached"></div>\n\t\t\t\t<br>\n\t\t\t</div>\n\t\t\t<div class="full memblock">\n\t\t\t\t<b>In Memory: (<span id="radiance_memtotal"></span>)</b><div id="radiance_inmem"></div>\n\t\t\t\t<br>\n\t\t\t</div>\n\t\t\t<div class="full">\n\t\t\t\t<b>Bar: </b><span id="radiance_barinfo"></span>\n\t\t\t\t<br>\n\t\t\t\t<b>Part Queue:</b>\n\t\t\t\t<div id="radiance_queue"></div>\n\t\t\t\t<br>\n\t\t\t</div>\n\t\t</div>\n\t\t<br>\n\t\t',e}(),document.body.appendChild(Be),pe=!0},ZenithStopDebug:function(){Be.remove(),pe=!1},ZenithSetExpert:function(e){Se=e},StartChromeThrottleHack:async function(){if(""===(new Audio).canPlayType("audio/ogg")||window.IS_ELECTRON)return;const t=await(await fetch("/res/silence.ogg")).arrayBuffer(),n=await e.decodeAudioData(t),s=e.createBufferSource();s.buffer=n,s.loop=!0,s.connect(e.destination),s.start()},HOOK_LoadBgmFromUrl:async function(e,t=Zo[e]){if(!0===it.volume.disable)return!1;if(n.has(e))return!0;Zo[e]=t;let s=null;try{const t=await fetch(e);return!!t.ok&&(s=await t.arrayBuffer(),!0)}catch{return!1}finally{n.set(e,s)}}}})();kn.ready((function(){na.StartChromeThrottleHack(),a.Ticker.shared.add((()=>na.Update())),window.DEVHOOK_ZENITH_RADIANCE_DEBUG_ON=()=>na.ZenithStartDebug(),window.DEVHOOK_ZENITH_RADIANCE_DEBUG_OFF=()=>na.ZenithStopDebug()})),Wt((()=>{na.InitSe(),na.LoadBgmFile("kuchu-toshi")}));const sa=(()=>{function e(e){return e.list[e.current]}function t(e){e.current=(e.current+1)%e.list.length}function n(e){e.current=(e.current+e.list.length-1)%e.list.length}const s={list:null,current:0},i={list:null,current:0},o=0,a=1,r=2,l=["soundtest_sound","soundtest_music"],p=[s,i];let d=o,h=1,u=0,_=new Set,m=null,g=0,f=null,b=null,C=!1,x="";const A=[];let y=0;function v(){if(y=0,A.length=0,0===x.length)return;const e=p[d].list;for(const t of e){let e=0,n=0;const s=[];let i=!0;for(const o of x){const a=t.indexOf(o,n);if(-1===a){i=!1;break}e=Math.max(e,a-n),n=a+1,s.push(a)}i&&A.push([t,e,s])}A.sort(((e,t)=>e[1]-t[1]))}function B(){g++,g>180&&(!function(){const e=performance.now(),t=new Set;for(const n of _)e-n[1]<=1e4&&t.add(n);_=t}(),g=0);const e=na.GetCurrentBgm();e!==f&&(xt("soundtest_currentsongplaying").innerText=na.GetCurrentBgm(),f=e);const t=it.volume.sfx,n=it.volume.music;t===m&&n===b||(T(),m=t,b=n)}function w(l){if(C){if("Escape"===l.code)return l.preventDefault(),C=!1,void M();if("Enter"===l.code||"Space"===l.code)return l.preventDefault(),0!==A.length&&(!function(e,t){const n=e.list.indexOf(t);-1!==n&&(e.current=n)}(p[d],A[y][0]),S(),z()),C=!1,void M();if("<"===l.key||">"===l.key)return;switch(l.code){case"ArrowUp":l.preventDefault(),y=(y+A.length-1)%A.length,I();break;case"ArrowDown":l.preventDefault(),y=(y+1)%A.length,I()}return"Backspace"===l.code?(l.preventDefault(),x=l.ctrlKey?"":x.substring(0,x.length-1),v(),void I()):void(1===l.key.length&&(l.preventDefault(),x+=l.key,v(),I()))}if("Backspace"===l.code||"Escape"===l.code||"KeyQ"===l.code)return l.preventDefault(),Si(!0),Li("home"),document.removeEventListener("keydown",w),cl.ticker.remove(B),void L.remove();switch(l.code){case"KeyF":case"Slash":return l.preventDefault(),C=!0,I(),void M();case"KeyM":return l.preventDefault(),d=(d+1)%r,M(),x="",void v();case"Digit9":case"Digit0":{l.preventDefault();const e="Digit9"===l.code?-1:1;return void(l.shiftKey&&!l.ctrlKey?Ys(e,"se"):l.ctrlKey&&!l.shiftKey?Ys(e,"bgm"):Ys(e))}}if(d===o){const i=l.shiftKey?.2:.1,o=l.shiftKey?.1:.05;switch(l.code){case"Space":{l.preventDefault();const t=na.PlaySe(e(s),h,u);_.add([t,performance.now()]);break}case"KeyR":l.preventDefault(),h=1,u=0,F();break;case"ArrowUp":l.preventDefault(),h=Math.min(h+o,1),F();break;case"ArrowDown":l.preventDefault(),h=Math.max(h-o,0),F();break;case"ArrowLeft":l.preventDefault(),l.ctrlKey?(u=Math.max(u-i,-1),F()):(n(s),S());break;case"ArrowRight":l.preventDefault(),l.ctrlKey?(u=Math.min(u+i,1),F()):(t(s),S());break;case"KeyX":l.preventDefault();for(const e of _)na.StopSe(e[0]);_.clear()}}else if(d===a)switch(l.code){case"Space":l.preventDefault(),na.PlayBgmSmoothly(e(i));break;case"ArrowLeft":l.preventDefault(),n(i),z();break;case"ArrowRight":l.preventDefault(),t(i),z();break;case"KeyX":l.preventDefault(),l.shiftKey?na.FadeOutBgm():na.KillBgm()}}let L=null;const k=new Intl.NumberFormat("en-US",{maximumFractionDigits:2,minimumFractionDigits:2});function S(){xt("soundtest_currentsound").innerText=e(s)}function F(){xt("soundtest_sound_vol").innerText=k.format(h),xt("soundtest_sound_pan").innerText=k.format(u)}function z(){const t=e(i);xt("soundtest_currentsong").innerText=t,xt("soundtest_currentsong_name").innerText=Zo[t].name.toUpperCase(),xt("soundtest_currentsong_nameu").innerText=Zo[t].untranslatedName.toUpperCase(),xt("soundtest_currentsong_artist").innerText=Zo[t].artist.toUpperCase(),xt("soundtest_currentsong_artistu").innerText=Zo[t].untranslatedArtist.toUpperCase(),xt("soundtest_currentsong_genre").innerText=Zo[t].genre,xt("soundtest_currentsong_source").innerText=Zo[t].source}function T(){xt("soundtest_sevol").innerText=k.format(it.volume.sfx),xt("soundtest_bgmvol").innerText=k.format(Math.round(100*it.volume.music)/100)}function I(){xt("soundtest_searchquery").innerText=x;const e=xt("soundtest_searchitems");for(;e.firstChild;)e.firstChild.remove();for(let t=0;t<A.length&&t<15;t++){const[n,,s]=A[t],i=document.createElement("div");let o="";t===y?(i.classList.add("flash"),o+="> "):o+="&nbsp;&nbsp;";for(let e=0;e<n.length;e++)o+=-1===s.indexOf(e)?`<span class="darkened">${n[e]}</span>`:`${n[e]}`;i.innerHTML=o,e.appendChild(i)}}function M(){for(const e of xt("soundtest_maincontainer").children)e.classList.add("hidden");C?xt("soundtest_search").classList.remove("hidden"):xt(l[d]).classList.remove("hidden")}let E=0,D=!1;const O="KeyT";return{Start:function(){document.addEventListener("keydown",w),cl.ticker.add(B),null==s.list&&(s.list=Array.from(Object.keys(c))),null==i.list&&(i.list=Array.from(Object.keys(Zo))),L=function(){const e=document.createElement("div");return e.classList.add("radianceinfo_root"),e.classList.add("soundtest_root"),e.innerHTML='\n\t\t<h1 id="soundtest_title">Radiance Test</h1>\n\t\t<div>\n\t\t\t<b>SE Vol: </b><span id="soundtest_sevol"></span>\n\t\t\t<br>\n\t\t\t<b>BGM Vol: </b><span id="soundtest_bgmvol"></span>\n\t\t</div>\n\t\t<br>\n\t\t<div id="soundtest_maincontainer">\n\t\t\t<div id="soundtest_sound" class="hidden">\n\t\t\t\t<h2>SE</h2>\n\t\t\t\t<div>\n\t\t\t\t\t<b>ID: </b><span id="soundtest_currentsound"></span>\n\t\t\t\t\t<br><br>\n\t\t\t\t\t<b>Vol: </b><span id="soundtest_sound_vol"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<b>Pan: </b><span id="soundtest_sound_pan"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id="soundtest_music" class="hidden">\n\t\t\t\t<h2>BGM</h2>\n\t\t\t\t<div>\n\t\t\t\t\t<b>ID: </b><span id="soundtest_currentsong"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<b>Name: </b><span id="soundtest_currentsong_name"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<b>Name (Original): </b><span id="soundtest_currentsong_nameu"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<b>Artist: </b><span id="soundtest_currentsong_artist"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<b>Artist (Original): </b><span id="soundtest_currentsong_artistu"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<b>Genre: </b><span id="soundtest_currentsong_genre"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<b>Source: </b><span id="soundtest_currentsong_source"></span>\n\t\t\t\t\t<br><br>\n\t\t\t\t\t<b>Now Playing: </b><span id="soundtest_currentsongplaying"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id="soundtest_search" class="hidden">\n\t\t\t\t<h2>Search</h2>\n\t\t\t\t<div>\n\t\t\t\t\t<span id="soundtest_searchquery"></span><span class="text-entry">_</span>\n\t\t\t\t</div>\n\t\t\t\t<br>\n\t\t\t\t<div id="soundtest_searchitems">\n\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t',e}(),document.body.appendChild(L),S(),z(),M(),F(),T()},UnlockerKeyDown:function(e){D||e.code===O&&e.shiftKey&&(D=!0,E=performance.now())},UnlockerKeyUp:function(e){D=!1;const t=xt("sound_test");t.classList.contains("hidden")&&e.code===O&&performance.now()-E>1e3&&(na.PlaySe("piece_change"),t.classList.remove("hidden"))}}})(),ia=(()=>{let e=[],t=0,n=[];return{loadSpecialThanks:function(){gn.get("/api/tetra/specialthanks").then((e=>{let t="";e.supporters.forEach((e=>{t+=`<div class="flex-item"><a class="credit_st ${e.username?`tetra_pop" data-hover="tap" data-hit="click" data-username="${e.username}"`:'noclick"'}>${e.flip?e.username.toUpperCase():e.name}</a><span class="jp_kana">${e.username&&e.username.toUpperCase()!==e.name?e.flip?e.name:e.username.toUpperCase():""}</span></div>`})),xt("specialthanks").innerHTML=t}),(()=>{xt("specialthanks").innerHTML='<div class="flex-item">error fetching special thanks</div>'}))},loadNews:function(){gn.get("/api/tetra/news").then((e=>{let t="";e.news.forEach((e=>{if(t+='<div class="tetra_news_item">',"leaderboard"===e.type){const n=e.data.rank<=3?`leaderboard${e.data.rank}`:"improvement";let s="";switch(e.data.gametype){case"40l":case"5mblast":{const t=Bt(e.data.result);s=`a time of <a class="replay_pop" data-hover="tap" data-hit="click" data-replay="R:${e.data.replayid}">${t.m}:${t.s}.${t.ms}</a>`;break}case"blitz":s=`a score of <a class="replay_pop" data-hover="tap" data-hit="click" data-replay="R:${e.data.replayid}">${e.data.result.toLocaleString("en-US")}</a>`;break;case"zenith":case"zenithex":s=`an altitude of <a class="replay_pop" data-hover="tap" data-hit="click" data-replay="R:${e.data.replayid}">${Math.floor(e.data.result).toLocaleString("en-US")}.${Math.floor(e.data.result%1*10)}</a>${zl("M")}`}t+=`<img class="ns" src="/res/badges/${n}.png" /><a class="tetra_pop" data-hover="tap" data-hit="click" data-username="${e.data.username}">${e.data.username.toUpperCase()}</a> reached #${e.data.rank} in ${L.Strings.longTypeNames[e.data.gametype]} with ${s}`}else"badge"===e.type&&(t+=`<img class="ns" src="/res/badges/${e.data.type}.png" /><a class="tetra_pop" data-hover="tap" data-hit="click" data-username="${e.data.username}">${e.data.username.toUpperCase()}</a> received the <span>"${St(e.data.label.toLowerCase())}"</span> badge`);t+=`<div class="tetra_news_ts" title="${new Date(e.ts).toLocaleString()}">${wt(Date.parse(e.ts))} ago</div></div>`})),""===t&&(t='<div class="tetra_news_empty">NO NEWS</div>'),xt("tetra_news_content").innerHTML=t}),(()=>{xt("tetra_news_content").innerHTML='<div class="tetra_news_empty">ERROR FETCHING NEWS</div>'}))},loadTwitch:function(){gn.get("/api/tetra/twitch").then((e=>{let t="";e.live.forEach((e=>{t+=`<a class="tetra_live_item" data-hover="tap" data-hit="click" href="https://www.twitch.tv/${St(e.login)}" target="_blank" data-title="${St(e.title)}">${St(e.username)}<span>${St(e.viewers)}</span><img src="${St(e.thumbnail)}" /></a>`})),xt("tetra_live").classList.toggle("hidden",""===t),xt("tetra_live_content").innerHTML=t}),(()=>{}))},loadRecords:async function(n,s,i){Di("fetching records");let o=[];try{switch(s){case"me":{let s=[];switch(Date.now()<t?s=e:(s=(await gn.get("/api/records/me")).records,e=s,t=Date.now()+6e4),n){case"40l":o=s.filter((e=>"40l"===e.gamemode));break;case"blitz":o=s.filter((e=>"blitz"===e.gamemode));break;case"zenith":o=s.filter((e=>"zenith"===e.gamemode));break;case"zenithex":o=s.filter((e=>"zenithex"===e.gamemode));break;case"league":o=s.filter((e=>"league"===e.gamemode));break;default:o=[...s].sort(((e,t)=>new Date(t.ts)-new Date(e.ts)))}break}case"friends":o=(await gn.get(`/api/records/friends/${n}`)).records;break;case"country":s=`country_${document.body.dataset.country}`;default:o=(await gn.get(`/api/records/leaderboard/${n}_${s}`)).records}Oi(),function(e,t,n,s){const i=xt(t);if(!i)throw"there is no holder?";i.innerHTML="";let o=1;if(e.forEach((e=>{const t=!!e.otherusers.length;t&&e.results.leaderboard[1].id===mn.id()&&e.results.leaderboard.reverse();const a=document.createElement("div");a.classList.add("scroller_block"),a.classList.add("record_item"),a.classList.toggle("record_disputed",!!e.disputed),a.classList.add("ns"),a.setAttribute("data-hover","hover"),a.setAttribute("data-hit","hit3"),1===o&&a.classList.add("record_first"),i.appendChild(a);const r=document.createElement("div");r.classList.add("record_grade"),r.classList.add("ns"),r.innerHTML=o,a.appendChild(r);const l=document.createElement("div");l.classList.add("record_owner"),"any"===n?t?l.innerHTML+=`${L.Strings.longTypeNames[e.gamemode].toLowerCase()} ${zl("VS")} ${e.results.leaderboard[1].username.toUpperCase()}`:l.innerHTML=L.Strings.longTypeNames[e.gamemode]:l.innerHTML=t?`${zl("VS")} ${e.results.leaderboard[1].username.toUpperCase()}`:`${e.user.username.toUpperCase()}${1&e.user.flags?'<img src="/res/supporter-tag.png" title="This person is supporting TETR.IO " />':""}${e.user.country?`<img class="flag" src="/res/flags/${e.user.country.toLowerCase()}.png" title="${Wn[e.user.country]}" />`:""}`,a.appendChild(l);const c=document.createElement("div");c.classList.add("record_ts"),c.innerHTML=new Date(e.ts).toLocaleString(),a.appendChild(c);const p=document.createElement("div");p.classList.add("record_result"),a.appendChild(p);const d=document.createElement("div");switch(d.classList.add("record_extra"),a.appendChild(d),e.gamemode){case"40l":case"5mblast":{const t=Bt(e.results.stats.finaltime);p.innerHTML=`${t.m}:${t.s}<span class="ms">.${t.ms}</span>`,d.innerHTML=`<span>${e.results.stats.piecesplaced}</span> pieces - <span>${e.results.stats.finesse?.faults??"?"}</span>F - <span>${(e.results.stats.inputs/(e.results.stats.finaltime/1e3)).toFixed(2)}</span> KPS - <span>${(e.results.stats.inputs/e.results.stats.piecesplaced).toFixed(2)}</span> KPP - <span>${e.results.aggregatestats.pps.toFixed(2)}</span> PPS`;break}case"blitz":p.innerHTML=`${e.results.stats.score.toLocaleString("en-US")}`,d.innerHTML=`LV<span>${e.results.stats.level}</span> - <span>${e.results.stats.piecesplaced}</span> pieces - <span>${e.results.stats.finesse?.faults??"?"}</span>F - <span>${(e.results.stats.score/e.results.stats.piecesplaced).toFixed(2)}</span> SPP - <span>${e.results.aggregatestats.pps.toFixed(2)}</span> PPS`;break;case"zenith":case"zenithex":{const t=Bt(e.results.stats.finaltime);p.innerHTML=`${e.extras.zenith.mods.map((e=>"expert"===e?"":`<img class="mod" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" src="/res/zenith-mods/pbicons-tetra/${St(e)}.png" />`)).join("")} ${Math.floor(e.results.stats.zenith.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(e.results.stats.zenith.altitude%1*10)}</span><span class="unit">M</span>`,d.innerHTML=`<span>${t.m}:${t.s}</span>.${t.ms} - <span>${e.results.stats.kills}</span> KO${1===e.results.stats.kills?"":"'s"} - avg. speed <span>${(e.results.stats.zenith.avgrankpts/(e.results.stats.finaltime/1e3*60)).toFixed(2)}</span>, peak <span>${Math.floor(e.results.stats.zenith.peakrank)}</span> - <span>${e.results.aggregatestats.apm.toFixed(2)}</span> APM - <span>${e.results.aggregatestats.pps.toFixed(2)}</span> PPS`;break}case"league":switch(e.extras.result){case"victory":p.innerHTML=`${zl("VICTORY")} ${e.results.leaderboard[0].wins}-${e.results.leaderboard[1].wins}`;break;case"defeat":p.innerHTML=`${zl("DEFEAT")} ${e.results.leaderboard[0].wins}-${e.results.leaderboard[1].wins}`;break;case"tie":p.innerHTML=`${zl("TIE")} ${e.results.leaderboard[0].wins}-${e.results.leaderboard[1].wins}`;break;case"dqvictory":p.innerHTML="opponent forfeited";break;case"dqdefeat":p.innerHTML="you forfeited";break;case"nocontest":p.innerHTML="no contest";break;case"nullified":p.innerHTML="match nullified"}d.innerHTML=Number.isNaN(e.results.leaderboard[0].stats.apm)?"NO STATS AVAILABLE":`<span>${e.results.leaderboard[0].stats.apm.toFixed(2)}</span> APM - <span>${e.results.leaderboard[0].stats.pps.toFixed(2)}</span> PPS - <span>${e.results.leaderboard[0].stats.vsscore.toFixed(2)}</span> VS`}a.addEventListener("click",(()=>{Di("fetching replay"),gn.get(`/api/games/${encodeURIComponent(e.replayid)}`).then((t=>{Oi();const n=new S(t.game.replay);Rs.loadReplay(n,{back:"me"===s?"tetra_me":"tetra_records",record:e})}),(e=>{Oi(),en(e)}))})),o++})),!e.length){const e=document.createElement("div");e.classList.add("scroller_block"),e.classList.add("ns"),e.classList.add("nothing"),e.innerHTML="NO RECORDS",i.appendChild(e)}i.classList.toggle("noindex","me"===s&&["any","league"].includes(n)),i.classList.toggle("nofirst","me"===s&&["any","league"].includes(n)),i.classList.toggle("noname","me"===s&&["40l","blitz","zenith","zenithex"].includes(n))}(o,i,n,s)}catch(e){throw Oi(),en(e),e}},loadUserList:function(e,t,n){const s=`/api/users/by/${e}/${"country"===t?document.body.dataset.country:t}`;return new Promise(((t,i)=>{Di("fetching players"),gn.get(s).then((s=>{Oi(),function(e,t,n){const s=xt(e);if(!s)throw"there is no holder?";s.innerHTML="";let i=1;if(t.forEach((e=>{if("xp"===n&&(!e.xp||"anon"===e.role||"bot"===e.role))return;const t=document.createElement("div");t.classList.add("scroller_block"),t.classList.add("ns"),t.classList.add("record_item"),t.setAttribute("data-hover","hover"),t.setAttribute("data-hit","hit3"),1===i&&t.classList.add("record_first"),s.appendChild(t);const o=document.createElement("div");o.classList.add("record_grade"),o.classList.add("ns"),o.innerHTML=i,t.appendChild(o);const a=document.createElement("div");if(a.classList.add("record_owner"),a.innerHTML=`${e.username.toUpperCase()}${e.supporter?'<img src="/res/supporter-tag.png" title="This person is supporting TETR.IO " />':""}${e.country?`<img class="flag" src="/res/flags/${e.country.toLowerCase()}.png" title="${Wn[e.country]}" />`:""}`,t.appendChild(a),"xp"===n){const n=document.createElement("div");n.classList.add("record_ts"),n.innerHTML=`${bn(e.xp)}% TOWARDS NEXT LEVEL`,t.appendChild(n);const s=document.createElement("div");s.classList.add("record_result"),t.appendChild(s),s.innerHTML=Cn(fn(e.xp));const i=document.createElement("div");i.classList.add("record_extra"),i.innerHTML=`<span>${Math.floor(e.xp)}</span> XP`,t.appendChild(i)}else if("ar"===n){const n=document.createElement("div");n.classList.add("record_ts");const s=Object.values(e.ar_counts).reduce(((e,t)=>e+t),0);n.innerHTML=`<span>${s}</span> achievement${1===s?"":"s"}`,t.appendChild(n);const i=document.createElement("div");i.classList.add("record_result"),t.appendChild(i),i.innerHTML=`${e.ar.toLocaleString("en-US")}<span>AR</span>`;const o=document.createElement("div");o.classList.add("record_extra");let a="";e.ar_counts[100]&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/issued.png" title="Issued-Once (+1AR)" /> ${e.ar_counts[100]}`),e.ar_counts[1]&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/bronze.png" title="Bronze (+1AR)" /> ${e.ar_counts[1]}`),e.ar_counts[2]&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/silver.png" title="Silver (+2AR)" /> ${e.ar_counts[2]}`),e.ar_counts[3]&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/gold.png" title="Gold (+3AR)" /> ${e.ar_counts[3]}`),e.ar_counts[4]&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/platinum.png" title="Platinum (+5AR)" /> ${e.ar_counts[4]}`),e.ar_counts[5]&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/diamond.png" title="Diamond (+8AR)" /> ${e.ar_counts[5]}`),e.ar_counts.t100&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/t100.png" title="Top 100 in Competitive Achievements (+1AR)" /> ${e.ar_counts.t100}`),e.ar_counts.t50&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/t50.png" title="Top 50 in Competitive Achievements (+2AR)" /> ${e.ar_counts.t50}`),e.ar_counts.t25&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/t25.png" title="Top 25 in Competitive Achievements (+3AR)" /> ${e.ar_counts.t25}`),e.ar_counts.t10&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/t10.png" title="Top 10 in Competitive Achievements (+4AR)" /> ${e.ar_counts.t10}`),e.ar_counts.t5&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/t5.png" title="Top 5 in Competitive Achievements (+5AR)" /> ${e.ar_counts.t5}`),e.ar_counts.t3&&(a+=`${a?" - ":""}<img src="/res/achievements/frames/t3.png" title="Top 3 in Competitive Achievements (+6AR)" /> ${e.ar_counts.t3}`),o.innerHTML=a,t.appendChild(o)}else if("league"===n){const n=document.createElement("div");n.classList.add("record_ts"),n.innerHTML=`<span>${e.league.gameswon}</span> / ${e.league.gamesplayed} games won (<span>${Math.floor(e.league.gameswon/e.league.gamesplayed*1e4)/100}</span>%)`,t.appendChild(n);const s=document.createElement("div");s.classList.add("record_result"),t.appendChild(s),s.innerHTML=`${Math.round(e.league.tr)}<span>TR</span> <img src="/res/league-ranks/${e.league.rank}.png" />`,s.title=e.league.tr;const i=document.createElement("div");i.classList.add("record_extra"),i.innerHTML=`glicko: <span>${e.league.glicko}</span><span>${e.league.rd}</span>`,t.appendChild(i)}t.addEventListener("click",(()=>{oa({userID:e._id})})),i++})),!t.length){const e=document.createElement("div");e.classList.add("scroller_block"),e.classList.add("ns"),e.classList.add("nothing"),e.innerHTML="NO PLAYERS",s.appendChild(e)}}(n,s.users,e),t(s)}),(e=>{Oi(),en(e),i()}))}))},loadAchievements:async function(){Di("fetching achievements");try{const e={general:"GENERAL",solo:"SOLO",league:"TETRA LEAGUE",zenith:"QUICK PLAY"},t=["general","solo","league","zenith"],s=await gn.get("/api/achievements/me"),i=s.achievements.map((e=>Co(e,{})));i.sort(((e,n)=>t.indexOf(e.category)-t.indexOf(n.category)||(n.rank??-1)-(e.rank??-1)||(n.progress??-1)-(e.progress??-1)||new Date(n.t??0)-new Date(e.t??0)||e.o-n.o||e.k-n.k));const o={};for(const e of i)o[e.category]||(o[e.category]=[]),o[e.category].push(e);n=i,xt("tetra_achievement_case_avatar").src=xt("me_avatar").src,xt("tetra_achievement_case_ar").innerHTML=`${s.ar.toLocaleString("en-US")}<span>AR</span>`,xt("tetra_achievement_data").innerHTML="";for(const t of Object.keys(o)){const n=document.createElement("div");n.classList.add("scroller_block","ns"),xt("tetra_achievement_data").appendChild(n);const s=document.createElement("h1");s.textContent=e[t]??`${t}`.toUpperCase(),n.appendChild(s);const i=document.createElement("div");i.classList.add("achievements"),n.appendChild(i);for(const e of o[t])i.appendChild(e.holder)}for(let e=0;e<3;e++){const t=i.find((t=>t.k===s.featured[e]));t?(xt(`tetra_achievement_case_${e}`).dataset.k=t.k,xt(`tetra_achievement_case_${e}`).dataset.rank=t.stub?"stub":ro[t.rank],xt(`tetra_achievement_case_${e}`).innerHTML=t.icon):(xt(`tetra_achievement_case_${e}`).dataset.k=0,xt(`tetra_achievement_case_${e}`).dataset.rank="stub",xt(`tetra_achievement_case_${e}`).innerHTML="<span>EMPTY</span>")}Oi(),ii.bindGuide(oi.tetra_achievements)}catch(e){throw Oi(),en(e),e}},navigateToID:e=>function(e){if(/^R:.+$/.test(e)){const t=e.replace("R:","").split("@")[0];Di("fetching replay"),gn.get(`/api/games/${encodeURIComponent(t)}`).then((t=>{Oi(),na.PlayBgmSmoothly(document.body.classList.contains("inpair")||document.body.classList.contains("matchmaking")?"touhoudaiensei":"shikiichi-made-mousukoshi");const n=new S(t.game.replay);Rs.loadReplay(n,{back:"tetra",record:t.game,matchHighlight:e.replace("R:","").split("@")[1]})}),(e=>{Oi(),en(e)}))}else oa({username:e.toLowerCase()})}(e)}})();function oa(e){const t=document.createElement("div");t.classList.add("oob_modal"),t.classList.add("tetra_modal"),t.classList.add("hidden"),t.classList.add("busy"),xt("dialogs").appendChild(t),setTimeout((()=>{t.classList.remove("hidden"),ii.push(),ii.bindGuide(oi.tetra_dialog)}),1);const n=()=>{gn.get(`/api/users/${encodeURIComponent(e.userID)}`).then((n=>{const s=yr(n.user._id);let i=!1;if(s&&("friend"===s.type?(t.classList.add("tm_friend"),i=!0):"block"===s.type&&t.classList.add("tm_blocked")),(n.user.supporter||$n.includes(n.user.role))&&n.user.banner_revision){const e=document.createElement("img");e.classList.add("tetra_modal_banner"),e.classList.add("ns"),e.src=`/user-content/banners/${n.user._id}.jpg?rv=${n.user.banner_revision}`,t.classList.add("has_banner"),t.appendChild(e);const s=document.createElement("div");s.classList.add("tetra_modal_banner_sep"),s.classList.add("ns"),t.appendChild(s)}const o=document.createElement("img");o.classList.add("avatar"),o.src=n.user.avatar_revision?`/user-content/avatars/${n.user._id}.jpg?rv=${n.user.avatar_revision}`:"banned"===n.user.role?"/res/avatar-banned.png":"anon"===n.user.role?"/res/avatar.png":Et(n.user._id),t.appendChild(o);const a=document.createElement("h2");if(a.innerHTML=`${n.user.username.toUpperCase()}${n.user.country?`<img class="flag" src="/res/flags/${n.user.country.toLowerCase()}.png" title="${Wn[n.user.country]}" />`:""}`,t.appendChild(a),!["anon","bot","banned","hidden"].includes(n.user.role)){const e=document.createElement("h3");e.innerHTML=`${n.user.ts?`JOINED ${wt(Date.parse(n.user.ts)).toUpperCase()} AGO`:"HERE SINCE THE BEGINNING"}${n.user.friendCount?` - <span title="Amount of players who have friended this person"><img src="/res/icon/friends${(n.user.supporter||$n.includes(n.user.role))&&n.user.banner_revision?"":"-green"}.svg" />${n.user.friendCount}</span>`:""}${n.user.friendedYou?i?" - MUTUAL FRIENDS":" - FRIENDED YOU":""}`,t.appendChild(e)}const r=document.createElement("div");if(r.classList.add("tetra_modal_close"),r.classList.add("ns"),r.innerHTML="CLOSE",r.setAttribute("data-hover","tap"),r.setAttribute("data-hit","click"),t.appendChild(r),r.addEventListener("click",(()=>{hn(t)})),n.user._id==mn.id()&&Bn!==n.user.xp&&(xn(fn(n.user.xp),xt("me_level")),xn(fn(n.user.xp),xt("zenith_party_self_level")),wn(n.user.xp-Bn,!0)),e.topbuttons=e.topbuttons||[],e.topbuttons.push(...aa(n.user)),e.topbuttons.length){const n=document.createElement("div");n.classList.add("tetra_topbutton_holder"),n.classList.add("ns"),t.appendChild(n),e.topbuttons.forEach((e=>{const s=document.createElement("div");s.classList.add("tetra_topbutton"),s.innerHTML=`${e.icon?`<img src="/res/icon/${e.icon}.svg" />`:""}${e.label}`,s.title=e.title||"",e.classes.forEach((e=>{s.classList.add(e)})),s.addEventListener("click",(()=>{e.callback((()=>{hn(t)}),s,t)})),s.addEventListener("mouseout",(()=>{s.classList.remove("tb_unfriending")})),n.appendChild(s)}))}let l,c;l=n.user.gameswon>-1&&n.user.gamesplayed>-1?`<div class="tetra_tag_record" title="Online games won / online games played"><span>${n.user.gameswon}</span> / ${n.user.gamesplayed}</div>`:n.user.gameswon>-1?`<div class="tetra_tag_record" title="Online games won"><span>${n.user.gameswon}</span></div>`:n.user.gamesplayed>-1?`<div class="tetra_tag_record" title="Online games played">${n.user.gamesplayed}</div>`:"",c=n.user.gametime>-1?`<div class="tetra_tag_gametime" title="Total time played">${Lt(n.user.gametime)}</div>`:"";let p="";n.user.connections.twitch&&(p+=`<a data-hover="tap" data-hit="click" href="https://www.twitch.tv/${St(n.user.connections.twitch.username)}" title="Twitch: ${St(n.user.connections.twitch.display_username)} (${St(n.user.connections.twitch.username)})" target="_blank" class="tetra_tag_social"></a>`),n.user.connections.youtube&&(p+=`<a data-hover="tap" data-hit="click" href="https://youtube.com/channel/${St(n.user.connections.youtube.id)}" title="YouTube: ${St(n.user.connections.youtube.username)}" target="_blank" class="tetra_tag_social"></a>`),n.user.connections.twitter&&(p+=`<a data-hover="tap" data-hit="click" href="https://x.com/${St(n.user.connections.twitter.username)}" title="X: ${St(n.user.connections.twitter.display_username)} (@${St(n.user.connections.twitter.username)})" target="_blank" class="tetra_tag_social"></a>`),n.user.connections.reddit&&(p+=`<a data-hover="tap" data-hit="click" href="https://reddit.com/u/${St(n.user.connections.reddit.username)}" title="reddit: /u/${St(n.user.connections.reddit.username)}" target="_blank" class="tetra_tag_social"></a>`),n.user.connections.steam&&(p+=`<a data-hover="tap" data-hit="click" href="https://steamcommunity.com/profiles/${St(n.user.connections.steam.id)}" title="Steam: ${St(n.user.connections.steam.username)}" target="_blank" class="tetra_tag_social"></a>`),n.user.connections.discord&&(p+=`<a data-hover="tap" data-hit="click" href="javascript:void();" title="Discord: @${St(n.user.connections.discord.username)}" target="_blank" class="tetra_tag_social copyable" data-text="${St(n.user.connections.discord.username)}" data-displayname="username"></a>`);let d="";for(const e of n.user.achievements){const t=Co(e,{clickable:!1,isSelf:!1});d+=`\n\t\t\t\t\t<div class="achievement tetra_featured_achievement" data-rank="${ro[t.rank]}">\n\t\t\t\t\t\t<div class="achievement_icon">${t.icon}</div>\n\t\t\t\t\t\t<div class="achievement_info">${t.info}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`}if(!["anon","bot","banned","hidden"].includes(n.user.role)){const e=document.createElement("div");e.classList.add("tetra_tag_holder"),e.classList.add("ns"),e.innerHTML=`\n\t\t\t\t${"sysop"===n.user.role?'<img class="mod_badge" src="/res/verified-sysop.png" title="This person has unlimited permissions on TETR.IO." alt="Sysop" />':""}\n\t\t\t\t${"admin"===n.user.role?'<img class="mod_badge" src="/res/verified-admin.png" title="This person has administration permissions on TETR.IO." alt="Administrator" />':""}\n\t\t\t\t${"mod"===n.user.role?'<img class="mod_badge" src="/res/verified-mod.png" title="This person has global moderation permissions on TETR.IO." alt="Global Moderator" />':""}\n\t\t\t\t${"halfmod"===n.user.role?'<img class="mod_badge" src="/res/verified-halfmod.png" title="This person has community moderation permissions on TETR.IO." alt="Community Moderator" />':""}\n\t\t\t\t${Cn(fn(n.user.xp))}${c}${l}${p}\n\t\t\t\t${d}\n\t\t\t\t${n.user.supporter?`<img class="supporter_badge" src="/res/supporter${n.user.supporter_tier}.png" title="This person is supporting TETR.IO " alt="Supporter" />`:""}`,t.appendChild(e)}if(n.user.badstanding){const e=document.createElement("div");e.classList.add("tetra_badstanding"),e.classList.add("ns"),e.innerHTML="<h1>BAD STANDING</h1><p>one or more recent bans on record</p>",t.appendChild(e)}if(!n.user.distinguishment){let e=0,t="";n.user.records&&n.user.records["40l"]&&1===n.user.records["40l"].rank&&(n.user.distinguishment={type:"champion",detail:"40l",text:"40 LINES CHAMPION"},e++,t+=(""===t?"":" & ")+"40L"),n.user.records&&n.user.records.blitz&&1===n.user.records.blitz.rank&&(n.user.distinguishment={type:"champion",detail:"blitz",text:"BLITZ CHAMPION"},e++,t+=(""===t?"":" & ")+"BLITZ"),n.user.league&&1===n.user.league.standing&&(n.user.distinguishment={type:"champion",detail:"league",text:"TETRA LEAGUE CHAMPION"},e++,t+=(""===t?"":" & ")+"TL"),e>=2&&(n.user.distinguishment={type:"champion",detail:"x-multiple",text:`${t} CHAMPION`})}if(n.user.distinguishment){const e=document.createElement("div");switch(e.classList.add("tetra_distinguishment"),e.classList.add("ns"),e.classList.add(`tetra_distinguishment_${n.user.distinguishment.type}`),n.user.distinguishment.type){case"staff":e.setAttribute("data-detail",n.user.distinguishment.detail),e.innerHTML="alumni"===n.user.distinguishment.detail?`<h1>${St(n.user.distinguishment.header).replace(/%tetrio%/g,'<img src="/res/tetrio-logo.svg" style="filter: invert(1);" />').replace(/%osk%/g,'<img src="/res/osk.svg" />')}: <span>${St(n.user.distinguishment.footer)}</span></h1>`:`<h1>${St(n.user.distinguishment.header).replace(/%tetrio%/g,'<img src="/res/tetrio-logo.svg" style="filter: invert(1);" />').replace(/%osk%/g,'<img src="/res/osk.svg" />')}</h1><p>${St(n.user.distinguishment.footer)}</p>`;break;case"champion":e.setAttribute("data-detail",n.user.distinguishment.detail),e.innerHTML=`<h1>${St(n.user.distinguishment.text)}</h1>`;break;case"twc":e.setAttribute("data-detail",n.user.distinguishment.detail),e.innerHTML=`<h1>TETR.IO WORLD CHAMPION</h1><p>${St(n.user.distinguishment.detail)} TETR.IO WORLD CHAMPIONSHIP</p>`}t.appendChild(e)}const h=ca(n.user.badges);if(Object.keys(h).length>0){const e=document.createElement("div");e.classList.add("tetra_badge_holder"),e.classList.add("ns"),t.appendChild(e);for(const t of Object.values(h)){if(t.length<=1){pa(t[0],e);continue}const n=document.createElement("div");n.classList.add("tetra_badge_group"),n.style=`--c: ${t.length};`,e.appendChild(n),t.forEach(((e,t)=>pa(e,n,t)))}}if("anon"===n.user.role){const e=document.createElement("div");e.classList.add("tetra_modal_warning"),e.innerHTML="this user is playing anonymously",t.appendChild(e)}else if("hidden"===n.user.role){const e=document.createElement("div");e.classList.add("tetra_modal_warning"),e.innerHTML="information about this user is currently unavailable",t.appendChild(e)}else if("banned"===n.user.role){const e=document.createElement("div");e.classList.add("tetra_modal_warning"),e.innerHTML="<h1>BANNED</h1>this user is currently banned. bans are placed when TETR.IO rules or terms of service are broken.",t.appendChild(e),t.classList.add("banned")}else if("bot"===n.user.role){const e=document.createElement("div");e.classList.add("tetra_modal_warning"),e.innerHTML="<h1>BOT</h1><br><br>this is a known bot. all bots must have this tag, or it and its owners will be permanently banned."+(n.user.botmaster?`<br><br>this bot is operated by <b>${n.user.botmaster}</b>`:""),t.appendChild(e)}else{const e=document.createElement("div");e.classList.add("tetra_modal_records"),e.classList.add("flex-row"),t.appendChild(e);const s=n.user.country?`<img class="flag" src="/res/flags/${n.user.country.toLowerCase()}.png" title="${Wn[n.user.country]}" />`:"";if(0!==n.user.league.gamesplayed){const t=document.createElement("div");t.classList.add("tetra_modal_record"),t.classList.add("flex-item"),t.classList.add("tetra_modal_record_league"),n.user.league.gamesplayed>=10?(t.innerHTML=`\n\t\t\t\t\t\t\t<div class="tetra_modal_record_header">\n\t\t\t\t\t\t\t\t<h6>TETRA LEAGUE</h6>\n\t\t\t\t\t\t\t\t<div class="standingset">\n\t\t\t\t\t\t\t\t\t${-1!==n.user.league.standing_local?`\n\t\t\t\t\t\t\t\t\t\t<div class="standingset_local">${s} #<span>${n.user.league.standing_local.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t\t${-1!==n.user.league.standing?`\n\t\t\t\t\t\t\t\t\t\t<div class="standingset_global ${1===n.user.league.standing?"t1":""}" data-digits="${(n.user.league.standing-1).toString().length}">#<span>${n.user.league.standing.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<h5 title="${n.user.league.tr}"><img src="/res/league-ranks/${n.user.league.rank}.png" />${Math.round(n.user.league.tr)}<span class="ms">TR</span></h5>\n\t\t\t\t\t\t\t<h3><span>${n.user.league.apm||"---"}</span> apm <span>${n.user.league.pps||"---"}</span> pps <span>${n.user.league.vs||"---"}</span> vs</h3>`,t.classList.add("tetra_modal_record_league_active")):t.innerHTML=`\n\t\t\t\t\t\t\t<div class="tetra_modal_record_header"><h6>TETRA LEAGUE</h6></div>\n\t\t\t\t\t\t\t<h5>${n.user.league.gamesplayed}<span class="ms">/10 rating games</span></h5>\n\t\t\t\t\t\t\t<h3><span>${n.user.league.gameswon}</span> game${1===n.user.league.gameswon?"":"s"} won</h3>\n\t\t\t\t\t\t`,e.appendChild(t)}if(n.user.records["40l"].record){const t=n.user.records["40l"],i=t.record,o=Bt(i.results.stats.finaltime),a=document.createElement("div");a.classList.add("tetra_modal_record"),a.classList.add("flex-item"),a.innerHTML=`\n\t\t\t\t\t\t<div class="tetra_modal_record_header">\n\t\t\t\t\t\t\t<h6>${L.Strings.longTypeNames["40l"]}</h6>\n\t\t\t\t\t\t\t<div class="standingset">\n\t\t\t\t\t\t\t\t${t.rank_local?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_local">${s} #<span>${t.rank_local.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t${t.rank?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_global ${1===t.rank?"t1":""}" data-digits="${(t.rank-1).toString().length}">#<span>${t.rank.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h5>${o.m}:${o.s}<span class="ms">.${o.ms}</span></h5>\n\t\t\t\t\t\t<h3><span>${wt(Date.parse(i.ts)).toUpperCase()}</span> ago</h3>`,e.appendChild(a)}if(n.user.records.blitz.record){const t=n.user.records.blitz,i=t.record,o=document.createElement("div");o.classList.add("tetra_modal_record"),o.classList.add("flex-item"),o.innerHTML=`\n\t\t\t\t\t\t<div class="tetra_modal_record_header">\n\t\t\t\t\t\t\t<h6>${L.Strings.longTypeNames.blitz}</h6>\n\t\t\t\t\t\t\t<div class="standingset">\n\t\t\t\t\t\t\t\t${t.rank_local?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_local">${s} #<span>${t.rank_local.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t${t.rank?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_global ${1===t.rank?"t1":""}" data-digits="${(t.rank-1).toString().length}">#<span>${t.rank.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h5>${i.results.stats.score.toLocaleString("en-US")}</h5>\n\t\t\t\t\t\t<h3><span>${wt(Date.parse(i.ts)).toUpperCase()}</span> ago</h3>`,e.appendChild(o)}if(n.user.records.zenith.record||n.user.records.zenith.best.record){const t=n.user.records.zenith,i=t.record,o=t.best.record,a=document.createElement("div");a.classList.add("tetra_modal_record"),a.classList.add("flex-item"),a.innerHTML=`\n\t\t\t\t\t\t<div class="tetra_modal_record_header">\n\t\t\t\t\t\t\t<h6>${L.Strings.longTypeNames.zenith}</h6>\n\t\t\t\t\t\t\t<div class="standingset">\n\t\t\t\t\t\t\t\t${t.rank_local?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_local">${s} #<span>${t.rank_local.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t${t.rank?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_global ${1===t.rank?"t1":""}" data-digits="${(t.rank-1).toString().length}">#<span>${t.rank.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${i?`\n\t\t\t\t\t\t\t<h5 title="This week">${Math.floor(i.results.stats.zenith.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(i.results.stats.zenith.altitude%1*10)}</span><span class="unit">M</span></h5>\n\t\t\t\t\t\t`:`\n\t\t\t\t\t\t\t<h5 title="Not this week - player has not played this week" class="revolvedscore">${Math.floor(o.results.stats.zenith.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(o.results.stats.zenith.altitude%1*10)}</span><span class="unit">M</span></h5>\n\t\t\t\t\t\t`}\n\t\t\t\t\t\t${i&&o?`\n\t\t\t\t\t\t\t<h3 title="Updates every week">career best <span>${Math.floor(o.results.stats.zenith.altitude).toLocaleString("en-US")}.${Math.floor(o.results.stats.zenith.altitude%1*10)}</span>${zl("M")} (#${t.best.rank.toLocaleString("en-US")})</h3>\n\t\t\t\t\t\t`:`\n\t\t\t\t\t\t\t<h3><span>${wt(Date.parse((i??o).ts)).toUpperCase()}</span> ago</h3>\n\t\t\t\t\t\t`}`,e.appendChild(a)}if(n.user.records.zenithex.record||n.user.records.zenithex.best.record){const t=n.user.records.zenithex,i=t.record,o=t.best.record,a=document.createElement("div");a.classList.add("tetra_modal_record"),a.classList.add("flex-item"),a.innerHTML=`\n\t\t\t\t\t\t<div class="tetra_modal_record_header">\n\t\t\t\t\t\t\t<h6>${L.Strings.longTypeNames.zenithex}</h6>\n\t\t\t\t\t\t\t<div class="standingset">\n\t\t\t\t\t\t\t\t${t.rank_local?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_local">${s} #<span>${t.rank_local.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t${t.rank?`\n\t\t\t\t\t\t\t\t\t<div class="standingset_global ${1===t.rank?"t1":""}" data-digits="${(t.rank-1).toString().length}">#<span>${t.rank.toLocaleString("en-US")}</span></div>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${i?`\n\t\t\t\t\t\t\t<h5 title="This week">${Math.floor(i.results.stats.zenith.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(i.results.stats.zenith.altitude%1*10)}</span><span class="unit">M</span></h5>\n\t\t\t\t\t\t`:`\n\t\t\t\t\t\t\t<h5 title="Not this week - player has not played this week" class="revolvedscore">${Math.floor(o.results.stats.zenith.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(o.results.stats.zenith.altitude%1*10)}</span><span class="unit">M</span></h5>\n\t\t\t\t\t\t`}\n\t\t\t\t\t\t${i&&o?`\n\t\t\t\t\t\t\t<h3 title="Updates every week">career best <span>${Math.floor(o.results.stats.zenith.altitude).toLocaleString("en-US")}.${Math.floor(o.results.stats.zenith.altitude%1*10)}</span>${zl("M")} (#${t.best.rank.toLocaleString("en-US")})</h3>\n\t\t\t\t\t\t`:`\n\t\t\t\t\t\t\t<h3><span>${wt(Date.parse((i??o).ts)).toUpperCase()}</span> ago</h3>\n\t\t\t\t\t\t`}`,e.appendChild(a)}}if(!["anon","bot","banned","hidden"].includes(n.user.role)){const e=document.createElement("div");e.classList.add("tetra_modal_jump"),e.classList.add("ns"),e.setAttribute("data-hover","tap"),e.setAttribute("data-hit","click"),e.innerHTML=" VIEW FULL PROFILE",e.addEventListener("click",(()=>{hn(t),window.open(`https://${_.ch_domain}/u/${n.user.username}`,"_blank")})),e.addEventListener("auxclick",(e=>{1===e.button&&window.open(`https://${_.ch_domain}/u/${n.user.username}`,"_blank")})),t.appendChild(e)}if(e.buttons=e.buttons||[],e.buttons.length){const n=document.createElement("div");n.classList.add("tetra_button_holder"),n.classList.add("flex-row"),n.classList.add("ns"),t.appendChild(n),e.buttons.forEach((e=>{const s=document.createElement("div");s.classList.add("tetra_button"),s.classList.add("flex-item"),s.innerHTML=e.label,e.classes.forEach((e=>{s.classList.add(e)})),s.addEventListener("click",(()=>{e.callback((()=>{hn(t)}))})),n.appendChild(s)}))}t.classList.remove("busy"),ii.rebind()}),(e=>{en(e),hn(t)}))};return e.userID?n():gn.get(`/api/users/${encodeURIComponent(e.username)}/resolve`).then((t=>{e.userID=t._id,n()}),(e=>{en(e),hn(t)})),xt("dialogs").classList.remove("hidden"),Gi(),t}function aa(e){const t=[];if(e._id!=mn.id()&&!mn.anon()){if("banned"===e.role)return t.push({label:"",icon:"block",title:"Block user",classes:["notext","tb_danger","tb_notblockedonly"],callback:(t,n,s)=>{n.classList.add("busy"),gn.post("/api/relationships/block",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.add("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}}),t.push({label:"UNBLOCK",icon:"block",title:"Unblock user",classes:["tb_blockedonly"],callback:(t,n,s)=>{n.classList.add("busy"),gn.post("/api/relationships/remove",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.remove("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}}),t.push({label:"",icon:"friends",title:"Unfriend? (click twice)",classes:["notext","tb_friendonly","tb_unfriendbutton","tb_notblockedonly"],callback:(t,n,s)=>{n.classList.contains("tb_unfriending")?(n.classList.add("busy"),gn.post("/api/relationships/remove",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.remove("tm_friend")}),(e=>{n.classList.remove("busy"),en(e)}))):n.classList.add("tb_unfriending")}}),t;if(["anon"].includes(e.role))return t.push({label:"",icon:"report",title:"Report user",classes:["notext","tb_danger"],callback:(t,n,s)=>{t(),ra(e,(()=>{n.classList.add("busy"),gn.post("/api/relationships/block",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.add("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}))}}),t.push({label:"",icon:"block",title:"Block user",classes:["notext","tb_danger","tb_notblockedonly"],callback:(t,n,s)=>{n.classList.add("busy"),gn.post("/api/relationships/block",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.add("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}}),t.push({label:"UNBLOCK",icon:"block",title:"Unblock user",classes:["tb_blockedonly"],callback:(t,n,s)=>{n.classList.add("busy"),gn.post("/api/relationships/remove",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.remove("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}}),t;t.push({label:"",icon:"report",title:"Report user",classes:["notext","hidden","tb_overflow","tb_danger","tb_notfriendonly","tb_notblockedonly"],callback:(t,n,s)=>{t(),ra(e,(()=>{n.classList.add("busy"),gn.post("/api/relationships/block",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.add("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}))}}),t.push({label:"",icon:"block",title:"Block user",classes:["notext","hidden","tb_overflow","tb_danger","tb_notfriendonly","tb_notblockedonly"],callback:(t,n,s)=>{n.classList.add("busy"),gn.post("/api/relationships/block",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.add("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}}),t.push({label:"",icon:"more",title:"More options...",classes:["notext","tb_more","tb_notfriendonly","tb_notblockedonly"],callback:(e,t,n)=>{t.parentNode.querySelectorAll(".tb_overflow").forEach((e=>{e.classList.remove("hidden")})),t.classList.add("hidden")}}),t.push({label:"",icon:"gift",title:"Gift TETR.IO Supporter",classes:["notext","tb_notblockedonly"],callback:(t,n,s)=>{t(),xi(void 0,e.username)}}),t.push({label:"MESSAGE",icon:"message",title:"Send a direct message",classes:["tb_friendonly","tb_notblockedonly"],callback:(t,n,s)=>{t(),nr(e._id)}}),t.push({label:"FRIEND",icon:"friend",title:"Add as friend",classes:["tb_notfriendonly","tb_friendbutton","tb_notblockedonly"],callback:(t,n,s)=>{n.classList.add("busy"),gn.post("/api/relationships/friend",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.add("tm_friend")}),(e=>{n.classList.remove("busy"),en(e)}))}}),t.push({label:"",icon:"friends",title:"Unfriend? (click twice)",classes:["notext","tb_friendonly","tb_unfriendbutton","tb_notblockedonly"],callback:(t,n,s)=>{n.classList.contains("tb_unfriending")?(n.classList.add("busy"),gn.post("/api/relationships/remove",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.remove("tm_friend")}),(e=>{n.classList.remove("busy"),en(e)}))):n.classList.add("tb_unfriending")}}),t.push({label:"",icon:"report",title:"Report user",classes:["notext","tb_danger","tb_blockedonly"],callback:(t,n,s)=>{t(),ra(e,(()=>{}))}}),t.push({label:"UNBLOCK",icon:"block",title:"Unblock user",classes:["tb_blockedonly"],callback:(t,n,s)=>{n.classList.add("busy"),gn.post("/api/relationships/remove",{user:e._id}).then((e=>{n.classList.remove("busy"),s.classList.remove("tm_blocked")}),(e=>{n.classList.remove("busy"),en(e)}))}})}return t}function ra(e,t){dn({title:`REPORT ${e.username.toUpperCase()}`,msg:`please choose a category to report ${e.username.toUpperCase()} to the TETR.IO moderators for. repeatedly placing false reports may result in a ban.`,classes:["ban_modal"],buttons:[{label:"TOXICITY<span>including, but not limited to toxicity, harassment, unsolicited direct messages, offensive content or bad language.</span>",classes:["pri","layercake_button"],callback:n=>{n(),la(e,"toxic","TOXICITY",t)}},{label:"CHEATING<span>including, but not limited to cheating, botting, hacking or otherwise breaking the game or getting an unfair advantage.</span>",classes:["pri","layercake_button"],callback:n=>{n(),la(e,"cheating","CHEATING",t)}},{label:"MULTIACCOUNTING<span>including, but not limited to smurfing, multiaccounting, boosting accounts, throwing games.</span>",classes:["pri","layercake_button"],callback:n=>{n(),la(e,"alting","MULTIACCOUNTING",t)}},{label:"NSFW/18+ CONTENT<span>including, but not limited to NSFW (not safe for work) avatars, banners, messages, etc.</span>",classes:["pri","layercake_button"],callback:n=>{n(),la(e,"nsfw","NSFW CONTENT",t)}},{label:"SPAM<span>including, but not limited to advertising, message flood, etc.</span>",classes:["pri","layercake_button"],callback:n=>{n(),la(e,"spam","SPAM",t)}},{label:"OTHER<span>otherwise not listed abuse against the TETR.IO terms of service, such as users under the age of 13, or rules, such as impersonation.</span>",classes:["pri","layercake_button"],callback:n=>{n(),la(e,"other","OTHER",t)}},{label:"CANCEL",classes:[],callback:e=>{e()}}]})}function la(e,t,n,s){dn({title:`REPORT ${e.username.toUpperCase()} for ${n}`,msg:`please explain briefly why you are reporting ${e.username.toUpperCase()} for ${n} to the TETR.IO moderators below. repeatedly placing false reports may result in a ban.<br><textarea data-escape="request_report_cancel" data-enter="request_report_submit" id="request_report" placeholder="REASON"></textarea>`,classes:["ban_modal"],buttons:[{label:"CANCEL",classes:[],id:"request_report_cancel",callback:e=>{e()}},{label:"SUBMIT",classes:["pri"],id:"request_report_submit",callback:n=>{n(),gn.post("/api/reports/submit",{target:e.username,type:t,reason:xt("request_report").value}).then((e=>{Zt("report sent! thank you for your help in keeping TETR.IO safe."),s()}),(e=>{en(e)}))}}]}),xt("request_report").focus()}function ca(e){if(!e||!Array.isArray(e))return[];const t={},n={};for(let n=e.length-1;n>=0;n--){const s=e[n].group??e[n].id;(t[s]??(t[s]=[])).push(e[n])}return Object.keys(t).reverse().forEach((e=>n[e]=t[e].reverse())),n}function pa(e,t,n=0){const s=document.createElement("img");s.classList.add("tetra_badge"),s.src=`/res/badges/${e.id}.png`,s.style=`--i: ${n};`,s.title=e.ts?`${e.label}\n\nAchieved on ${new Date(e.ts).toLocaleString()}`:e.label,t.appendChild(s)}const da=function(){let e,t;const n=[];let s=!1,i=!0,o=!1,a=!1,r=!1,l=Date.now(),c=null,p=!1,d=null,h=null,u=!1,m=0,g="disconnected",f=null,b=null,C="/ribbon",x=null,A=null,y=null,v=0,B=!1,w=!1,L=null,k=null,S=!1;function F(){let D=0;t=void 0,e=new st(`${"https:"===location.protocol?"wss:":"ws:"}//${location.host}/ribbon/`),p=!1,a=!0,m=Date.now(),h&&(clearTimeout(h),h=null),n.forEach((t=>{e.on(t[0],t[1])})),e.on("game.replay",(()=>{l=Math.max(l,Date.now())})),e.on("game.start",(()=>{r=!0,l=Math.max(l,Date.now()+8e3),c&&clearInterval(c),c=setInterval((()=>{r&&Date.now()-l>6e3&&ha("silence")}),200)})),e.on("game.end",(()=>{r=!1,l=Math.max(l,Date.now()),c&&clearInterval(c)})),e.on("ping",(({ms:e})=>{e>500&&ha("delay"),Lo.addPing(e),l=Math.max(l,Date.now()),b&&y&&Date.now()-D>3e4&&(D=Date.now(),y.getSpoolData(b.host).then((e=>{v=e.rtt+2*e.latency,Lo.addSpoolPing(Math.round(e.rtt)),Lo.addSpoolLatency(2*e.latency)})).catch((()=>{})))})),e.listen("open",(()=>{o=!0,document.body.classList.remove("socket_offline"),t=e.id,p||e.send("server.authorize",{token:mn.token(),handling:it.handling,signature:_,i:kn.i()})})),e.listen("reconnect",(()=>{"resuming"===g&&(_a(),xt("serverdebuginfo").textContent=`reconnecting ${f?`to ${f.name} [${f.flag}]`:""}${b?` through spool ${b.name} [${b.flag}]`:""}`)})),e.listen("resume",(t=>{xt("dirtyflag_net").innerHTML="RIBBON'D",ua(),m=Date.now();const n="resuming"===g;if(g="resuming",xt("serverdebuginfo").textContent=`ribboned ${f?`from ${f.name} [${f.flag}]`:""}${b?` through spool ${b.name} [${b.flag}]`:""}`,b&&C&&!n){x&&clearTimeout(x),A&&clearTimeout(A);const t=t=>{"resuming"===g&&o&&(b=t.spool,B=!!t.spool&&t.spool.hasFailures,e.SetSpoolID(t.token),e.Switch(t.uri),xt("serverdebuginfo").textContent=`connected ${f?`to ${f.name} [${f.flag}]`:""}${b?`, switching to spool ${b.name} [${b.flag}]`:""}`)},n=()=>{M("ResumeRespool",C).then(t,(e=>{console.error(e),"resuming"===g&&o&&(console.warn("Failed to respool. Will keep trying..."),x=setTimeout(n,2e3))}))},s=()=>{S&&M("FallbackRespool",C,!0).then(t,(e=>{console.error(e),"resuming"===g&&o&&console.error("Failed to fall back!")}))};x=setTimeout(n,2e3),A=setTimeout(s,7e3)}n||(L=setTimeout((()=>{L&&clearTimeout(L),k&&clearInterval(k),"resuming"===g&&o&&(k=setInterval((()=>{if("resuming"!==g||!o)return;let e=!1;setTimeout((()=>{e||(w=!0)}),1e3),gn.get("https://kagari.network/distress",void 0,{parse:!1,accept:"text/plain"}).then((()=>{})).catch((()=>{e=!0,w=!0}))}),1500))}),2500))})),e.listen("save",(e=>{"resuming"===g&&(Pt(["trackEvent","Ribbon","Save Success",e,Date.now()-m]),ga(),xt("serverdebuginfo").textContent=`connected ${f?`to ${f.name} [${f.flag}]`:""}${b?` through spool ${b.name} [${b.flag}]`:""}`),g="connected",y&&y.abort(),x&&clearTimeout(x),A&&clearTimeout(A),L&&clearTimeout(L),k&&clearInterval(k),w=!1,fa()})),e.listen("close",(e=>{document.body.classList.add("socket_offline");const t=o;if(o=!1,a=!1,r=!1,l=Math.max(l,Date.now()),c&&clearInterval(c),i&&!u)return xt("serverdebuginfo").textContent="(reconnecting in background)",t&&(ha("background",1e3),"devel"!==_.mode&&xt("performancemeter").classList.contains("off")||Kt({msg:"disconnected from server. reconnecting in a moment",color:"#FF783C",icon:"disconnect"})),h&&clearTimeout(h),void(h=setTimeout((()=>{F()}),3e4+12e4*Math.random()));i||Rs.stopNow(),xt("serverdebuginfo").textContent=s?"(not connected)":"(connection lost)","devel"!==_.mode&&xt("performancemeter").classList.contains("off")||Kt({msg:"disconnected from server",color:"#FF783C",icon:"disconnect"}),setTimeout((()=>{if(!s)if(xt("dirtyflag_net").innerHTML="LOST",Pi(),Li("home",!0),dn({title:"CONNECTION ERROR",classes:["noclickout"],msg:`a connection error has occured and the connection was closed unexpectedly.</p><p>check your internet connection and configuration.</p><p>REASON: ${e}${I()}`,buttons:[{label:"OK",classes:[],callback:e=>{e(),Ln=!0,location.reload()}}]}),"connected"===g)z("Disconnect",e);else{let t="Initial Connect";"migrating"===g?t="Migration":"resuming"===g&&(ma(),t="Save"),z(`${t} Failure`,e)}}),50)})),e.on("kick",(e=>{switch(o=!1,a=!1,xt("dirtyflag_net").innerHTML="LOST",document.body.classList.add("socket_offline"),u=!0,E(),e){case"outdated":if(i)return void document.body.classList.add("socket_outdated");dn({title:"UPDATE REQUIRED",classes:["noclickout"],msg:`an update is required to connect to multiplayer servers. click below to update!${I()}`,buttons:[{label:"UPDATE NOW",classes:[],callback:e=>{e(),kn.update()}}]});break;case"kick":document.body.classList.add("trapped"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban."),dn({title:"KICKED BY MODERATOR",msg:`a TETR.IO moderator or administrator has kicked you from the server. please reload to see the status of your account.${I()}`,classes:["ban_modal","noclickout"],buttons:[{label:"RELOAD",classes:[],callback:e=>{e(),kn.update(!0)}}]});break;case"restrict":case"block":document.body.classList.add("trapped"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban."),dn({title:"BANNED BY MODERATOR",msg:`a TETR.IO moderator or administrator has banned you from the server. please reload to see the status of your account.${I()}`,classes:["crash_modal","noclickout"],buttons:[{label:"RELOAD",classes:[],callback:e=>{e(),kn.update(!0)}}]});break;case"anticheat":document.body.classList.add("trapped"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban."),dn({title:"BANNED BY ANTI-CHEAT",msg:`our anti-cheat has flagged your actions as suspicious. please reload to see the status of your account.${I()}`,classes:["crash_modal","noclickout"],buttons:[{label:"RELOAD",classes:[],callback:e=>{e(),kn.update(!0)}}]});break;case"manual":document.body.classList.remove("trapped"),localStorage.removeItem("trapped"),mn.logout(),dn({title:"YOU WERE LOGGED OUT",classes:["noclickout"],msg:`you were logged out manually. please log back in again.${I()}`,buttons:[{label:"OK",classes:[],callback:e=>{e(),kn.update(!0)}}]});break;case"rename":break;default:{dn({title:"CONNECTION ERROR",classes:["noclickout"],msg:`the server has disconnected you.</p><p>REASON: ${e}</p><p>please check your internet connection and configuration.${I()}`,buttons:[{label:"OK",classes:[],callback:e=>{e(),Ln=!0,location.reload()}}]});const t=`Kick: ${e.replace(/[0-9]+/g,"#")}`;if("connected"===g)z("Disconnect",t);else{let e="Initial Connect";"migrating"===g?e="Migration":"resuming"===g&&(ma(),e="Save"),z(`${e} Failure`,t)}}}Pi(),Li("home",!0)})),e.on("server.announcement",(e=>{switch(e.type){case"announcement":na.PlaySe("notify"),Kt({msg:e.msg,color:"#FFCC00",icon:"announcement",timeout:1e4}),Oa.showAnnouncement(e.msg);break;case"maintenance":na.PlaySe("maintenance"),document.body.classList.add("maintenance"),Kt({msg:e.msg,color:"#FF5200",icon:"maintenance",timeout:15e3})}})),e.on("server.maintenance",(e=>{i||(o=!1,a=!1,xt("dirtyflag_net").innerHTML="LOST",document.body.classList.add("socket_offline"),u=!0,E(),dn({title:"MAINTENANCE STARTED",classes:["noclickout"],msg:`the server has been shut down for maintenance.</p><p>${e.reason}${I()}`,buttons:[{label:"RELOAD",classes:[],callback:e=>{e(),kn.update(!0)}}]}),Pi(),Li("home",!0))})),e.on("reload",(()=>{kn.update()})),e.on("rejected",(()=>{xt("dirtyflag_net").innerHTML="BAD",ha("rejected",5e3)})),e.on("pni",(e=>{ha(e.type,e.timeout)})),e.on("server.authorize",(e=>{d=e,f=e.worker,xt("serverdebuginfo").textContent=`connected ${f?`to ${f.name} [${f.flag}]`:""}${b?` through spool ${b.name} [${b.flag}]`:""}`,"devel"!==_.mode&&xt("performancemeter").classList.contains("off")||Kt({msg:`connected to server<br>${T()}`,color:"#61FF3C",icon:"connect",timeout:2500}),p=!0,a=!1,g="connected",Pt(["trackEvent","Ribbon","Initial Connect Success",`${f?f.name:"---"} ${b?b.name:"---"}`,Date.now()-m])}));let O=null;e.on("server.migrate",(t=>{g="migrating",C=t.endpoint;let n=`${"https:"===location.protocol?"wss:":"ws:"}//${location.host}${t.endpoint}`;b&&(n=`wss://${b.host}${t.endpoint}`),e.Switch(n),xt("serverdebuginfo").textContent=`migrating to ${t.name} [${t.flag}]${b?` through spool ${b.name} [${b.flag}]`:""}`,"devel"!==_.mode&&xt("performancemeter").classList.contains("off")||(O=Kt({msg:`switching server<br>${T()}`,color:"#FFF83C",icon:"disconnect-change",timeout:6e4})),m=Date.now()})),e.on("server.migrated",(e=>{g="connected",f=e.worker,xt("serverdebuginfo").textContent=`connected ${f?`to ${f.name} [${f.flag}]`:""}${b?` through spool ${b.name} [${b.flag}]`:""}`,O&&sn(O,{msg:`server switched<br>${T()}`,color:"#61FF3C",icon:"connect",timeout:2500}),Pt(["trackEvent","Ribbon","Migration Success",`${f?f.name:"---"} ${b?b.name:"---"}`,Date.now()-m])})),M("InitialConnect").then((t=>{b=t.spool,C=t.endpoint,B=!!t.spool&&t.spool.hasFailures,e.SetEndpoint(t.uri),e.SetSpoolID(t.token),e.connect()}),(t=>{e.close(t)}))}function z(e,t){let n=!1;return w?(setTimeout((()=>{Pt(["trackEvent","Ribbon",`${e} (their fault)`,t])}),500),void(xt("networkerror_fault_indicator")&&(xt("networkerror_fault_indicator").innerHTML="<br>this disconnect was detected to be caused by your network connection."))):"visible"!==document.visibilityState?(setTimeout((()=>{Pt(["trackEvent","Ribbon",`${e} (their fault, tabbed out)`,t])}),500),void(xt("networkerror_fault_indicator")&&(xt("networkerror_fault_indicator").innerHTML="<br>due to browser limitations, tabbing out of TETR.IO midgame may cause disconnects."))):(setTimeout((()=>{n||(n=!0,Pt(["trackEvent","Ribbon",`${e} (their fault)`,t]),xt("networkerror_fault_indicator")&&(xt("networkerror_fault_indicator").innerHTML="<br>this disconnect was detected to be caused by your network connection."))}),1e3),void gn.get("https://kagari.network/distress",void 0,{parse:!1,accept:"text/plain"}).then((()=>{n||(n=!0,Pt(["trackEvent","Ribbon",`${e} (our fault)`,t]),xt("networkerror_fault_indicator")&&(xt("networkerror_fault_indicator").innerHTML="<br>if you are certain this error is not on your side, please report it."))})).catch((()=>{})))}function T(){return b?`<img class="flag" src="/res/flags/${b.flag.toLowerCase()}.png" title="${Wn[b.flag]}" /> ${b.name.toUpperCase()}<br><img src="/res/sharp-hook-right.png" style="margin-left: 0.2em; height: 0.88em; vertical-align: -5%;" /> <img class="flag" src="/res/flags/${f.flag.toLowerCase()}.png" title="${Wn[f.flag]}" /> ${f.name.toUpperCase()}`:`<img class="flag" src="/res/flags/${f.flag.toLowerCase()}.png" title="${Wn[f.flag]}" /> ${f.name.toUpperCase()}`}function I(){let e=`<span id="networkerror_fault_indicator"></span></p><p class="modal_also">SOCKET ID: ${t||"---"}<br>WORKER: ${f?f.name.toUpperCase():"---"}<br>SPOOL: ${b?b.name.toUpperCase():"---"}`;return document.body.classList.contains("sigliatrip_idiot")&&(e+='<br><span style="color: #F00; font-weight: 900;">THIRD-PARTY MODIFICATIONS DETECTED. DO NOT REPORT ANY ERRORS WHILE USING THIRD-PARTY MODIFICATIONS.</span><br><span style="color: #F00; font-weight: 500; font-size: 0.7em;">THIRD-PARTY MODIFICATIONS ARE NOT SUPPORTED AND MAY BE INCOMPATIBLE. THIRD-PARTY MODIFICATIONS THAT IMPACT GAMEPLAY MAY BE AGAINST TERMS OF SERVICES.</span>'),e}async function M(e=null,t=void 0,n=!1){let s,i,o=[];if(n)return console.log(`${e?`${e} > `:""}Forcing fallback to endpoint ${t}.`),{uri:`${"https:"===location.protocol?"wss:":"ws:"}//${location.host}${t}`,endpoint:t,token:void 0,spool:void 0};try{console.log((e?`${e} > `:"")+"Obtaining Ribbon endpoint...");const n=await gn.get("/api/server/ribbon");if(!n.endpoint)throw console.warn((e?`${e} > `:"")+"No endpoints available."),"no endpoints available";if(s=n.endpoint,!(n.spools&&n.spools.spools&&n.spools.spools.length))return console.log(`${e?`${e} > `:""}Obtained Ribbon endpoint ${n.endpoint}. Spooling is disabled on this instance.`),{uri:`${"https:"===location.protocol?"wss:":"ws:"}//${location.host}${t||s}`,endpoint:s,token:void 0,spool:void 0};console.log(`${e?`${e} > `:""}Obtained Ribbon endpoint ${n.endpoint} and ${n.spools.spools.length} spools${n.fallback_available?", fallback available":""}.`),i=n.spools.token,o=n.spools.spools,S=n.fallback_available}catch(t){throw console.error((e?`${e} > `:"")+"Could not retrieve Ribbon endpoint."),"could not retrieve ribbon endpoint"}console.log((e?`${e} > `:"")+"Getting a spool...");try{y=new ba(o,e);const n=await y.getSpool();return console.log(`${e?`${e} > `:""}Obtained spool ${n.name} (${n.host}) [${n.flag}].`),{uri:`wss://${n.host}${t||s}`,endpoint:s,token:i,spool:n}}catch(n){if(S)return console.warn((e?`${e} > `:"")+"Could not spool a Ribbon connection, falling back.",n),{uri:`${"https:"===location.protocol?"wss:":"ws:"}//${location.host}${t||s}`,endpoint:s,token:void 0,spool:void 0};throw console.error((e?`${e} > `:"")+"Could not spool a Ribbon connection.",n),"could not spool ribbon connection"}}function E(){s=!0}return setInterval((async()=>{if(e&&"connected"===g&&o&&b)try{console.log("AmbientRespool > Starting ambient respool.");const t=await M("AmbientRespool",C);if(!(e&&"connected"===g&&o&&b&&t.spool))return;if(e.SetSpoolID(t.token),t.spool.hasFailures||(B=!1),t.spool.name===b.name)return void console.log("AmbientRespool > Obtained new token, already on best available spool.");v>10&&v/(t.spool.rtt+2*t.spool.latency)>=(B?1.25:2)?(console.log(`AmbientRespool > Will reconnect for ping advantage ${Math.round(v)}ms  ${Math.round(t.spool.rtt)}ms.`),b=t.spool,e.Switch(t.uri),xt("serverdebuginfo").textContent=`connected ${f?`to ${f.name} [${f.flag}]`:""}${b?`, switching to spool ${b.name} [${b.flag}]`:""}`):console.log(`AmbientRespool > Obtained new token, no significant ping advantage ${Math.round(v)}ms  ${Math.round(t.spool.rtt)}ms.`)}catch(e){console.warn("AmbientRespool > Ambient respool failed, could not retrieve Ribbon spool token!")}}),25e4+1e5*Math.random()),{on:(t,s)=>{n.push([t,s]),e&&e.on(t,s)},off:(t,n)=>{e&&e.off(t,n)},socket:function(){return e},emit:function(t,n){e.send(t,n)},connect:F,disconnect:function(){e.close("client closed ribbon")},abort:function(){s=!0,e.close(null,!0)},expectDisconnect:E,isConnected:()=>o,isBackground:()=>i,cut:t=>{e&&e.cut(t)},cork:()=>{e?.cork()},uncork:t=>{e?.uncork(t)},require:()=>new Promise(((t,n)=>{i=!1,!o||a?(a||F(),e?.listen("authorized",t),e?.listen("connect_error",n)):t(d)})),unrequire:()=>{i=!0},updateHandling:function(){e.send("config.handling",it.handling)},getConnectionDialogString:I}};function ha(e,t=100){Sa&&Sa.isBackground()&&!["background","split","load"].includes(e)||(xt(`network_${e}`).classList.add("ping"),setTimeout((()=>{xt(`network_${e}`).classList.remove("ping")}),t))}function ua(){Sa&&Sa.isBackground()||(xt("network_disconnect").setAttribute("src","/res/icon/network_disconnect.svg"),xt("network_disconnect").classList.remove("anim"),xt("network_disconnect").classList.add("ping"))}function _a(){Sa&&Sa.isBackground()||(xt("network_disconnect").setAttribute("src","/res/icon/network_reconnecting.png"),xt("network_disconnect").classList.add("anim"),xt("network_disconnect").classList.add("ping"))}function ma(){Sa&&Sa.isBackground()||(xt("network_disconnect").setAttribute("src","/res/icon/network_disconnect.svg"),xt("network_disconnect").classList.remove("anim"),xt("network_disconnect").classList.add("ping"),setTimeout((()=>{xt("network_disconnect").classList.remove("ping")}),5e3))}function ga(){Sa&&Sa.isBackground()||(xt("network_disconnect").setAttribute("src","/res/icon/network_reconnected.svg"),xt("network_disconnect").classList.remove("anim"),xt("network_disconnect").classList.add("ping"),fa())}function fa(){setTimeout((()=>{xt("network_disconnect").setAttribute("src","/res/icon/network_reconnected.svg"),xt("network_disconnect").classList.remove("anim"),xt("network_disconnect").classList.remove("ping")}),1e3)}const ba=function(e,t=null){let n=[],s=!1,i=0,o=0;const a=new Set;let r,l,c=!1,p=null,d=null,h=null,u=!1;function _(e){const t=e[0],n={online:128&e[1],avoidDueToHighLoad:64&e[1],recentlyRestarted:32&e[1],backhaulDisrupted:16&e[1]},s=[0,0,0];s[0]=e[2]/256*4,s[1]=e[3]/256*4,s[2]=e[4]/256*4;return{version:t,flags:n,load:s,latency:e[5],str:`v${t} /${n.avoidDueToHighLoad?"Av":""}${n.recentlyRestarted?"Rr":""}${n.backhaulDisrupted?"Bd":""}/ ${s[0]}, ${s[1]}, ${s[2]}`}}function m(){if(c)return;c=!0,p&&clearTimeout(p),d&&clearTimeout(d),h&&clearTimeout(h);for(const e of a)e.abort();a.clear();const e=[],o=n.reduce(((e,t)=>Math.min(e,t.rtt)),Number.MAX_VALUE);for(const t of n){const n=Math.ceil((t.resp.flags.avoidDueToHighLoad?5:50)*Math.pow(o/t.rtt,3)/Math.max(1,8*t.resp.load[0]-3.8));for(let s=0;s<n;s++)e.push(t)}if(0===e.length){if(s)return;return console.warn((t?`${t} > `:"")+"Spool > Spooling failed: no available spools"),void l()}const u=e[Math.floor(Math.random()*e.length)];u.hasFailures=i>0,console.log(`${t?`${t} > `:""}Spool > Spooled ${u.name}!`),r(u)}return{getSpool:function(){return new Promise(((s,g)=>{r=s,l=g,function(){console.log((t?`${t} > `:"")+"Spool > Spooling started"),new x(Math.floor(1e9*Math.random())).shuffleArray(e),performance.clearResourceTimings(),performance.setResourceTimingBufferSize(500),h=setTimeout(m,1e4);let s=0;for(const r of e){const l=new XMLHttpRequest,h=performance.now(),g=`${Date.now()}-${s++}-${Math.floor(1e6*Math.random())}`,f=`https://${r.host}/spool?${g}`;l.open("GET",f,!0),l.responseType="arraybuffer",a.add(l),l.onload=()=>{if(!c&&4===l.readyState){const s=performance.getEntriesByName(f)[0];let c;s&&0!==s.requestStart?c=s.responseStart-s.requestStart:(u||(u=!0,console.warn("Performance Resource Timing API is not available.")),c=performance.now()-h),a.delete(l);const g=_(new Uint8Array(l.response));if(!g.flags.online)return i++,console.log(`${t?`${t} > `:""}Spool > ${Math.round(c/2).toString().padStart(5," ")}+${g.latency}ms ${r.name} [${r.flag}] Denies request (${g.str})`),void(n.length+i>=e.length&&m());console.log(`${t?`${t} > `:""}Spool > ${Math.round(c/2).toString().padStart(5," ")}+${g.latency}ms ${r.name} [${r.flag}] ${g.str}`),r.rtt=c+2*g.latency,r.resp=g,n.push(r),g.flags.avoidDueToHighLoad||o++,1===n.length&&(d=setTimeout(m,1e4)),p&&clearTimeout(p),p=setTimeout(m,1500),n.length+i>=e.length&&m(),o>=3&&m()}},l.onerror=()=>{c||(a.delete(l),i++,console.log(`${t?`${t} > `:""}Spool > -----ms ${r.name} [${r.flag}] No response`),n.length+i>=e.length&&m())},l.send()}}()}))},getSpoolData:function(e){return new Promise(((t,n)=>{const s=new XMLHttpRequest,i=performance.now(),o=`ping-${Date.now()}-${Math.floor(1e6*Math.random())}`,a=`https://${e}/spool?${o}`;s.open("GET",a,!0),s.responseType="arraybuffer",s.onload=()=>{if(4===s.readyState){const e=performance.getEntriesByName(a)[0];let n;n=e&&0!==e.requestStart?e.responseStart-e.requestStart:performance.now()-i;const o=_(new Uint8Array(s.response));t({...o,rtt:n})}},s.onerror=()=>{n()},s.send()}))},abort:function(){n=[],s=!0,m()}}},Ca=new class e{static strategies=["even","elims","random","payback"];game=null;enabled=!1;preselect=null;setGame(t){this.game=t,this.enabled=!1,this.preselect=null;for(const[t,n]of e.strategies.entries())At(`#diyusi_strategy_${t+1}>p`).textContent=n,xt(`diyusi_strategy_${t+1}`).classList.toggle("active",!1);xt(`diyusi_strategy_${t.getStrategy()+1}`).classList.add("active"),xt("diyusi_enemies").hidden=!0,this.game.on("start",this._OnStart.bind(this)),this.game.on("enemy",this.setTargeting.bind(this)),this.game.on("strategy",this._OnStrategyChange.bind(this)),this.game.on("allow_target",this.setEnabled.bind(this)),this.game.on("stop",this._OnEnd.bind(this))}setStrategy(e,t){if(this.game&&this.enabled)return this.game.isStarted()?5===e?this.game.setManualTarget(t):void(this.game.getStrategy()!==e&&this.game.setStrategy(e)):(this.preselect={strategy:e,gameid:t},this._OnStrategyChange(e))}setEnabled(e){this.enabled===e||e&&!this.game||(this.enabled=e,e?(xt("diyusi").classList.remove("hidden"),xt("diyusi").classList.remove("hiding")):(xt("diyusi").classList.add("hiding"),setTimeout((()=>{xt("diyusi").classList.add("hidden")}),500)),this._ping())}async setTargeting(){const e=xt("diyusi_enemies"),t=this.game?.getEnemies().length;await Ot(100);const n=this.game?.getEnemies().length;t===n&&(t<1?e.hidden=!0:(e.querySelector("h1").textContent=`${t} TARGETING YOU`,e.classList.toggle("caution",t>=4&&t<=8),e.classList.toggle("danger",t>=9),e.hidden=!1))}_OnStart(){if(this.preselect)return 5===this.preselect.strategy?this.game.setManualTarget(this.preselect.gameid):void this.game.setStrategy(this.preselect.strategy)}_OnEnd(){this.game&&(this.setEnabled(!1),this.game=null)}_OnStrategyChange(e){for(let e=1;e<=4;e++)xt(`diyusi_strategy_${e}`).classList.toggle("active",!1);e>=4||(xt(`diyusi_strategy_${e+1}`).classList.add("active"),this._ping())}_ping(){xt("diyusi").classList.add("ping"),setTimeout((()=>{xt("diyusi").classList.remove("ping")}),150)}};kn.ready((()=>{function e(e){if(!e.repeat&&!(document.body.classList.contains("chatfocus")||$i>=1))for(const[t,n]of Object.entries(at))if(n.includes(Ct(e)))switch(t){case"target1":Ca.setStrategy(0);break;case"target2":Ca.setStrategy(1);break;case"target3":Ca.setStrategy(2);break;case"target4":Ca.setStrategy(3)}}document.addEventListener("keydown",e,!1),document.addEventListener("gpdown",e,!1)}));const xa={Arena_A1:{hx:[["Arena_A1-A1",0,0],["Arena_A1-A2",0,4096]],"1x":[["Arena_A1-A1",0,0],["Arena_A1-B1",2048,0],["Arena_A1-A2",0,2048],["Arena_A1-B2",2048,2048],["Arena_A1-A3",0,4096],["Arena_A1-B3",2048,4096]],"2x":[["Arena_A1-A1",0,0],["Arena_A1-B1",1024,0],["Arena_A1-C1",2048,0],["Arena_A1-D1",3072,0],["Arena_A1-A2",0,1024],["Arena_A1-B2",1024,1024],["Arena_A1-C2",2048,1024],["Arena_A1-D2",3072,1024],["Arena_A1-A3",0,2048],["Arena_A1-B3",1024,2048],["Arena_A1-C3",2048,2048],["Arena_A1-D3",3072,2048],["Arena_A1-A4",0,3072],["Arena_A1-B4",1024,3072],["Arena_A1-C4",2048,3072],["Arena_A1-D4",3072,3072],["Arena_A1-A5",0,4096],["Arena_A1-B5",1024,4096],["Arena_A1-C5",2048,4096],["Arena_A1-D5",3072,4096]],"4x":[["Arena_A1-A1",0,0],["Arena_A1-B1",1024,0],["Arena_A1-C1",2048,0],["Arena_A1-D1",3072,0],["Arena_A1-A2",0,1024],["Arena_A1-B2",1024,1024],["Arena_A1-C2",2048,1024],["Arena_A1-D2",3072,1024],["Arena_A1-A3",0,2048],["Arena_A1-B3",1024,2048],["Arena_A1-C3",2048,2048],["Arena_A1-D3",3072,2048],["Arena_A1-A4",0,3072],["Arena_A1-B4",1024,3072],["Arena_A1-C4",2048,3072],["Arena_A1-D4",3072,3072],["Arena_A1-A5",0,4096],["Arena_A1-B5",1024,4096],["Arena_A1-C5",2048,4096],["Arena_A1-D5",3072,4096]]},Arena_B1:{hx:[["Arena_B1-A1",0,0],["Arena_B1-A2",0,4096]],"1x":[["Arena_B1-A1",0,0],["Arena_B1-B1",2048,0],["Arena_B1-A2",0,2048],["Arena_B1-B2",2048,2048],["Arena_B1-A3",0,4096],["Arena_B1-B3",2048,4096]],"2x":[["Arena_B1-A1",0,0],["Arena_B1-B1",1024,0],["Arena_B1-C1",2048,0],["Arena_B1-D1",3072,0],["Arena_B1-A2",0,1024],["Arena_B1-B2",1024,1024],["Arena_B1-C2",2048,1024],["Arena_B1-D2",3072,1024],["Arena_B1-A3",0,2048],["Arena_B1-B3",1024,2048],["Arena_B1-C3",2048,2048],["Arena_B1-D3",3072,2048],["Arena_B1-A4",0,3072],["Arena_B1-B4",1024,3072],["Arena_B1-C4",2048,3072],["Arena_B1-D4",3072,3072],["Arena_B1-A5",0,4096],["Arena_B1-B5",1024,4096],["Arena_B1-C5",2048,4096],["Arena_B1-D5",3072,4096]],"4x":[["Arena_B1-A1",0,0],["Arena_B1-B1",1024,0],["Arena_B1-C1",2048,0],["Arena_B1-D1",3072,0],["Arena_B1-A2",0,1024],["Arena_B1-B2",1024,1024],["Arena_B1-C2",2048,1024],["Arena_B1-D2",3072,1024],["Arena_B1-A3",0,2048],["Arena_B1-B3",1024,2048],["Arena_B1-C3",2048,2048],["Arena_B1-D3",3072,2048],["Arena_B1-A4",0,3072],["Arena_B1-B4",1024,3072],["Arena_B1-C4",2048,3072],["Arena_B1-D4",3072,3072],["Arena_B1-A5",0,4096],["Arena_B1-B5",1024,4096],["Arena_B1-C5",2048,4096],["Arena_B1-D5",3072,4096]]},Arena_B2:{hx:[["Arena_B2-A1",0,0]],"1x":[["Arena_B2-A1",0,0],["Arena_B2-B1",2048,0],["Arena_B2-A2",0,2048],["Arena_B2-B2",2048,2048]],"2x":[["Arena_B2-A1",0,0],["Arena_B2-B1",1024,0],["Arena_B2-C1",2048,0],["Arena_B2-D1",3072,0],["Arena_B2-A2",0,1024],["Arena_B2-B2",1024,1024],["Arena_B2-C2",2048,1024],["Arena_B2-D2",3072,1024],["Arena_B2-A3",0,2048],["Arena_B2-B3",1024,2048],["Arena_B2-C3",2048,2048],["Arena_B2-D3",3072,2048]],"4x":[["Arena_B2-A1",0,0],["Arena_B2-B1",1024,0],["Arena_B2-C1",2048,0],["Arena_B2-D1",3072,0],["Arena_B2-A2",0,1024],["Arena_B2-B2",1024,1024],["Arena_B2-C2",2048,1024],["Arena_B2-D2",3072,1024],["Arena_B2-A3",0,2048],["Arena_B2-B3",1024,2048],["Arena_B2-C3",2048,2048],["Arena_B2-D3",3072,2048]]},Arena_B3:{hx:[["Arena_B3-A1",0,0],["Arena_B3-A2",0,4096]],"1x":[["Arena_B3-A1",0,0],["Arena_B3-B1",2048,0],["Arena_B3-A2",0,2048],["Arena_B3-B2",2048,2048],["Arena_B3-A3",0,4096],["Arena_B3-B3",2048,4096]],"2x":[["Arena_B3-A1",0,0],["Arena_B3-B1",1024,0],["Arena_B3-C1",2048,0],["Arena_B3-D1",3072,0],["Arena_B3-A2",0,1024],["Arena_B3-B2",1024,1024],["Arena_B3-C2",2048,1024],["Arena_B3-D2",3072,1024],["Arena_B3-A3",0,2048],["Arena_B3-C3",2048,2048],["Arena_B3-D3",3072,2048],["Arena_B3-A4",0,3072],["Arena_B3-D4",3072,3072],["Arena_B3-A5",0,4096],["Arena_B3-D5",3072,4096]],"4x":[["Arena_B3-A1",0,0],["Arena_B3-B1",1024,0],["Arena_B3-C1",2048,0],["Arena_B3-D1",3072,0],["Arena_B3-A2",0,1024],["Arena_B3-B2",1024,1024],["Arena_B3-C2",2048,1024],["Arena_B3-D2",3072,1024],["Arena_B3-A3",0,2048],["Arena_B3-C3",2048,2048],["Arena_B3-D3",3072,2048],["Arena_B3-A4",0,3072],["Arena_B3-D4",3072,3072],["Arena_B3-A5",0,4096],["Arena_B3-D5",3072,4096]]},Arena_C1:{hx:[["Arena_C1-A1",0,0]],"1x":[["Arena_C1-A1",0,0],["Arena_C1-B1",2048,0]],"2x":[["Arena_C1-B1",1024,0],["Arena_C1-C1",2048,0],["Arena_C1-B2",1024,1024],["Arena_C1-C2",2048,1024]],"4x":[["Arena_C1-B1",1024,0],["Arena_C1-C1",2048,0],["Arena_C1-B2",1024,1024],["Arena_C1-C2",2048,1024]]},Arena_Front:{hx:[["Arena_Front-A1",0,0],["Arena_Front-A2",0,4096],["Arena_Front-A3",0,8192]],"1x":[["Arena_Front-A1",0,0],["Arena_Front-B1",2048,0],["Arena_Front-A2",0,2048],["Arena_Front-B2",2048,2048],["Arena_Front-A3",0,4096],["Arena_Front-B3",2048,4096],["Arena_Front-A4",0,6144],["Arena_Front-B4",2048,6144],["Arena_Front-A5",0,8192],["Arena_Front-B5",2048,8192],["Arena_Front-A6",0,10240],["Arena_Front-B6",2048,10240]],"2x":[["Arena_Front-A1",0,0],["Arena_Front-B1",1024,0],["Arena_Front-C1",2048,0],["Arena_Front-D1",3072,0],["Arena_Front-A2",0,1024],["Arena_Front-B2",1024,1024],["Arena_Front-C2",2048,1024],["Arena_Front-D2",3072,1024],["Arena_Front-A3",0,2048],["Arena_Front-B3",1024,2048],["Arena_Front-C3",2048,2048],["Arena_Front-D3",3072,2048],["Arena_Front-A4",0,3072],["Arena_Front-B4",1024,3072],["Arena_Front-C4",2048,3072],["Arena_Front-D4",3072,3072],["Arena_Front-A5",0,4096],["Arena_Front-B5",1024,4096],["Arena_Front-C5",2048,4096],["Arena_Front-D5",3072,4096],["Arena_Front-A6",0,5120],["Arena_Front-B6",1024,5120],["Arena_Front-C6",2048,5120],["Arena_Front-D6",3072,5120],["Arena_Front-A7",0,6144],["Arena_Front-B7",1024,6144],["Arena_Front-C7",2048,6144],["Arena_Front-D7",3072,6144],["Arena_Front-A8",0,7168],["Arena_Front-D8",3072,7168],["Arena_Front-A9",0,8192],["Arena_Front-B9",1024,8192],["Arena_Front-C9",2048,8192],["Arena_Front-D9",3072,8192],["Arena_Front-A10",0,9216],["Arena_Front-B10",1024,9216],["Arena_Front-C10",2048,9216],["Arena_Front-D10",3072,9216],["Arena_Front-A11",0,10240],["Arena_Front-B11",1024,10240],["Arena_Front-C11",2048,10240],["Arena_Front-D11",3072,10240],["Arena_Front-A12",0,11264],["Arena_Front-B12",1024,11264],["Arena_Front-C12",2048,11264],["Arena_Front-D12",3072,11264]],"4x":[["Arena_Front-A1",0,0],["Arena_Front-B1",1024,0],["Arena_Front-C1",2048,0],["Arena_Front-D1",3072,0],["Arena_Front-A2",0,1024],["Arena_Front-B2",1024,1024],["Arena_Front-C2",2048,1024],["Arena_Front-D2",3072,1024],["Arena_Front-A3",0,2048],["Arena_Front-B3",1024,2048],["Arena_Front-C3",2048,2048],["Arena_Front-D3",3072,2048],["Arena_Front-A4",0,3072],["Arena_Front-B4",1024,3072],["Arena_Front-C4",2048,3072],["Arena_Front-D4",3072,3072],["Arena_Front-A5",0,4096],["Arena_Front-B5",1024,4096],["Arena_Front-C5",2048,4096],["Arena_Front-D5",3072,4096],["Arena_Front-A6",0,5120],["Arena_Front-B6",1024,5120],["Arena_Front-C6",2048,5120],["Arena_Front-D6",3072,5120],["Arena_Front-A7",0,6144],["Arena_Front-B7",1024,6144],["Arena_Front-C7",2048,6144],["Arena_Front-D7",3072,6144],["Arena_Front-A8",0,7168],["Arena_Front-D8",3072,7168],["Arena_Front-A9",0,8192],["Arena_Front-B9",1024,8192],["Arena_Front-C9",2048,8192],["Arena_Front-D9",3072,8192],["Arena_Front-A10",0,9216],["Arena_Front-B10",1024,9216],["Arena_Front-C10",2048,9216],["Arena_Front-D10",3072,9216],["Arena_Front-A11",0,10240],["Arena_Front-B11",1024,10240],["Arena_Front-C11",2048,10240],["Arena_Front-D11",3072,10240],["Arena_Front-A12",0,11264],["Arena_Front-B12",1024,11264],["Arena_Front-C12",2048,11264],["Arena_Front-D12",3072,11264]]},Casino_A1:{hx:[["Casino_A1-A1",0,0],["Casino_A1-A2",0,4096]],"1x":[["Casino_A1-A1",0,0],["Casino_A1-B1",2048,0],["Casino_A1-A2",0,2048],["Casino_A1-B2",2048,2048],["Casino_A1-A3",0,4096],["Casino_A1-B3",2048,4096],["Casino_A1-A4",0,6144],["Casino_A1-B4",2048,6144]],"2x":[["Casino_A1-A1",0,0],["Casino_A1-B1",1024,0],["Casino_A1-C1",2048,0],["Casino_A1-A2",0,1024],["Casino_A1-B2",1024,1024],["Casino_A1-C2",2048,1024],["Casino_A1-A3",0,2048],["Casino_A1-B3",1024,2048],["Casino_A1-C3",2048,2048],["Casino_A1-A4",0,3072],["Casino_A1-B4",1024,3072],["Casino_A1-C4",2048,3072],["Casino_A1-A5",0,4096],["Casino_A1-B5",1024,4096],["Casino_A1-C5",2048,4096],["Casino_A1-A6",0,5120],["Casino_A1-B6",1024,5120],["Casino_A1-C6",2048,5120],["Casino_A1-A7",0,6144],["Casino_A1-B7",1024,6144],["Casino_A1-C7",2048,6144]],"4x":[["Casino_A1-A1",0,0],["Casino_A1-B1",1024,0],["Casino_A1-C1",2048,0],["Casino_A1-A2",0,1024],["Casino_A1-B2",1024,1024],["Casino_A1-C2",2048,1024],["Casino_A1-A3",0,2048],["Casino_A1-B3",1024,2048],["Casino_A1-C3",2048,2048],["Casino_A1-A4",0,3072],["Casino_A1-B4",1024,3072],["Casino_A1-C4",2048,3072],["Casino_A1-A5",0,4096],["Casino_A1-B5",1024,4096],["Casino_A1-C5",2048,4096],["Casino_A1-A6",0,5120],["Casino_A1-B6",1024,5120],["Casino_A1-C6",2048,5120],["Casino_A1-A7",0,6144],["Casino_A1-B7",1024,6144],["Casino_A1-C7",2048,6144]]},Casino_A1b:{hx:[["Casino_A1b-A1",0,0],["Casino_A1b-A2",0,4096]],"1x":[["Casino_A1b-A1",0,0],["Casino_A1b-B1",2048,0],["Casino_A1b-A2",0,2048],["Casino_A1b-B2",2048,2048],["Casino_A1b-A3",0,4096],["Casino_A1b-B3",2048,4096]],"2x":[["Casino_A1b-A1",0,0],["Casino_A1b-D1",3072,0],["Casino_A1b-A2",0,1024],["Casino_A1b-D2",3072,1024],["Casino_A1b-A3",0,2048],["Casino_A1b-D3",3072,2048],["Casino_A1b-A4",0,3072],["Casino_A1b-D4",3072,3072],["Casino_A1b-A5",0,4096],["Casino_A1b-D5",3072,4096],["Casino_A1b-A6",0,5120],["Casino_A1b-D6",3072,5120]],"4x":[["Casino_A1b-A1",0,0],["Casino_A1b-D1",3072,0],["Casino_A1b-A2",0,1024],["Casino_A1b-D2",3072,1024],["Casino_A1b-A3",0,2048],["Casino_A1b-D3",3072,2048],["Casino_A1b-A4",0,3072],["Casino_A1b-D4",3072,3072],["Casino_A1b-A5",0,4096],["Casino_A1b-D5",3072,4096],["Casino_A1b-A6",0,5120],["Casino_A1b-D6",3072,5120]]},Casino_B1:{hx:[["Casino_B1-A1",0,0]],"1x":[["Casino_B1-A1",0,0],["Casino_B1-B1",2048,0],["Casino_B1-A2",0,2048],["Casino_B1-B2",2048,2048]],"2x":[["Casino_B1-A1",0,0],["Casino_B1-B1",1024,0],["Casino_B1-C1",2048,0],["Casino_B1-D1",3072,0],["Casino_B1-A2",0,1024],["Casino_B1-B2",1024,1024],["Casino_B1-C2",2048,1024],["Casino_B1-D2",3072,1024],["Casino_B1-A3",0,2048],["Casino_B1-B3",1024,2048],["Casino_B1-C3",2048,2048],["Casino_B1-D3",3072,2048],["Casino_B1-A4",0,3072],["Casino_B1-B4",1024,3072],["Casino_B1-C4",2048,3072],["Casino_B1-D4",3072,3072]],"4x":[["Casino_B1-A1",0,0],["Casino_B1-B1",1024,0],["Casino_B1-C1",2048,0],["Casino_B1-D1",3072,0],["Casino_B1-A2",0,1024],["Casino_B1-B2",1024,1024],["Casino_B1-C2",2048,1024],["Casino_B1-D2",3072,1024],["Casino_B1-A3",0,2048],["Casino_B1-B3",1024,2048],["Casino_B1-C3",2048,2048],["Casino_B1-D3",3072,2048],["Casino_B1-A4",0,3072],["Casino_B1-B4",1024,3072],["Casino_B1-C4",2048,3072],["Casino_B1-D4",3072,3072]]},Casino_B2:{hx:[["Casino_B2-A1",0,0]],"1x":[["Casino_B2-A1",0,0],["Casino_B2-B1",2048,0],["Casino_B2-A2",0,2048],["Casino_B2-B2",2048,2048]],"2x":[["Casino_B2-A1",0,0],["Casino_B2-B1",1024,0],["Casino_B2-C1",2048,0],["Casino_B2-D1",3072,0],["Casino_B2-A2",0,1024],["Casino_B2-B2",1024,1024],["Casino_B2-C2",2048,1024],["Casino_B2-D2",3072,1024],["Casino_B2-A3",0,2048],["Casino_B2-B3",1024,2048],["Casino_B2-C3",2048,2048],["Casino_B2-D3",3072,2048]],"4x":[["Casino_B2-A1",0,0],["Casino_B2-B1",1024,0],["Casino_B2-C1",2048,0],["Casino_B2-D1",3072,0],["Casino_B2-A2",0,1024],["Casino_B2-B2",1024,1024],["Casino_B2-C2",2048,1024],["Casino_B2-D2",3072,1024],["Casino_B2-A3",0,2048],["Casino_B2-B3",1024,2048],["Casino_B2-C3",2048,2048],["Casino_B2-D3",3072,2048]]},Casino_Front:{hx:[["Casino_Front-A1",0,0],["Casino_Front-A2",0,4096],["Casino_Front-A3",0,8192]],"1x":[["Casino_Front-A1",0,0],["Casino_Front-B1",2048,0],["Casino_Front-A2",0,2048],["Casino_Front-B2",2048,2048],["Casino_Front-A3",0,4096],["Casino_Front-B3",2048,4096],["Casino_Front-A4",0,6144],["Casino_Front-B4",2048,6144],["Casino_Front-A5",0,8192],["Casino_Front-B5",2048,8192],["Casino_Front-A6",0,10240],["Casino_Front-B6",2048,10240]],"2x":[["Casino_Front-A1",0,0],["Casino_Front-B1",1024,0],["Casino_Front-C1",2048,0],["Casino_Front-D1",3072,0],["Casino_Front-A2",0,1024],["Casino_Front-B2",1024,1024],["Casino_Front-C2",2048,1024],["Casino_Front-D2",3072,1024],["Casino_Front-A3",0,2048],["Casino_Front-B3",1024,2048],["Casino_Front-C3",2048,2048],["Casino_Front-D3",3072,2048],["Casino_Front-A4",0,3072],["Casino_Front-B4",1024,3072],["Casino_Front-C4",2048,3072],["Casino_Front-D4",3072,3072],["Casino_Front-A5",0,4096],["Casino_Front-B5",1024,4096],["Casino_Front-C5",2048,4096],["Casino_Front-D5",3072,4096],["Casino_Front-A6",0,5120],["Casino_Front-B6",1024,5120],["Casino_Front-C6",2048,5120],["Casino_Front-D6",3072,5120],["Casino_Front-A7",0,6144],["Casino_Front-B7",1024,6144],["Casino_Front-C7",2048,6144],["Casino_Front-D7",3072,6144],["Casino_Front-A8",0,7168],["Casino_Front-B8",1024,7168],["Casino_Front-C8",2048,7168],["Casino_Front-D8",3072,7168],["Casino_Front-A9",0,8192],["Casino_Front-B9",1024,8192],["Casino_Front-C9",2048,8192],["Casino_Front-D9",3072,8192],["Casino_Front-A10",0,9216],["Casino_Front-B10",1024,9216],["Casino_Front-C10",2048,9216],["Casino_Front-D10",3072,9216],["Casino_Front-A11",0,10240],["Casino_Front-B11",1024,10240],["Casino_Front-C11",2048,10240],["Casino_Front-D11",3072,10240],["Casino_Front-A12",0,11264],["Casino_Front-B12",1024,11264],["Casino_Front-C12",2048,11264],["Casino_Front-D12",3072,11264]],"4x":[["Casino_Front-A1",0,0],["Casino_Front-B1",1024,0],["Casino_Front-C1",2048,0],["Casino_Front-D1",3072,0],["Casino_Front-A2",0,1024],["Casino_Front-B2",1024,1024],["Casino_Front-C2",2048,1024],["Casino_Front-D2",3072,1024],["Casino_Front-A3",0,2048],["Casino_Front-B3",1024,2048],["Casino_Front-C3",2048,2048],["Casino_Front-D3",3072,2048],["Casino_Front-A4",0,3072],["Casino_Front-B4",1024,3072],["Casino_Front-C4",2048,3072],["Casino_Front-D4",3072,3072],["Casino_Front-A5",0,4096],["Casino_Front-B5",1024,4096],["Casino_Front-C5",2048,4096],["Casino_Front-D5",3072,4096],["Casino_Front-A6",0,5120],["Casino_Front-B6",1024,5120],["Casino_Front-C6",2048,5120],["Casino_Front-D6",3072,5120],["Casino_Front-A7",0,6144],["Casino_Front-B7",1024,6144],["Casino_Front-C7",2048,6144],["Casino_Front-D7",3072,6144],["Casino_Front-A8",0,7168],["Casino_Front-B8",1024,7168],["Casino_Front-C8",2048,7168],["Casino_Front-D8",3072,7168],["Casino_Front-A9",0,8192],["Casino_Front-B9",1024,8192],["Casino_Front-C9",2048,8192],["Casino_Front-D9",3072,8192],["Casino_Front-A10",0,9216],["Casino_Front-B10",1024,9216],["Casino_Front-C10",2048,9216],["Casino_Front-D10",3072,9216],["Casino_Front-A11",0,10240],["Casino_Front-B11",1024,10240],["Casino_Front-C11",2048,10240],["Casino_Front-D11",3072,10240],["Casino_Front-A12",0,11264],["Casino_Front-B12",1024,11264],["Casino_Front-C12",2048,11264],["Casino_Front-D12",3072,11264]]},Core_A1:{hx:[["Core_A1-A1",0,0],["Core_A1-A2",0,4096]],"1x":[["Core_A1-A1",0,0],["Core_A1-B1",2048,0],["Core_A1-A2",0,2048],["Core_A1-B2",2048,2048],["Core_A1-A3",0,4096],["Core_A1-B3",2048,4096],["Core_A1-A4",0,6144],["Core_A1-B4",2048,6144]],"2x":[["Core_A1-A1",0,0],["Core_A1-B1",1024,0],["Core_A1-C1",2048,0],["Core_A1-D1",3072,0],["Core_A1-A2",0,1024],["Core_A1-B2",1024,1024],["Core_A1-C2",2048,1024],["Core_A1-D2",3072,1024],["Core_A1-A3",0,2048],["Core_A1-B3",1024,2048],["Core_A1-C3",2048,2048],["Core_A1-D3",3072,2048],["Core_A1-A4",0,3072],["Core_A1-B4",1024,3072],["Core_A1-C4",2048,3072],["Core_A1-D4",3072,3072],["Core_A1-A5",0,4096],["Core_A1-B5",1024,4096],["Core_A1-C5",2048,4096],["Core_A1-D5",3072,4096],["Core_A1-A6",0,5120],["Core_A1-B6",1024,5120],["Core_A1-C6",2048,5120],["Core_A1-D6",3072,5120],["Core_A1-A7",0,6144],["Core_A1-B7",1024,6144],["Core_A1-C7",2048,6144],["Core_A1-D7",3072,6144],["Core_A1-A8",0,7168],["Core_A1-B8",1024,7168],["Core_A1-C8",2048,7168],["Core_A1-D8",3072,7168]],"4x":[["Core_A1-A1",0,0],["Core_A1-B1",1024,0],["Core_A1-C1",2048,0],["Core_A1-D1",3072,0],["Core_A1-A2",0,1024],["Core_A1-B2",1024,1024],["Core_A1-C2",2048,1024],["Core_A1-D2",3072,1024],["Core_A1-A3",0,2048],["Core_A1-B3",1024,2048],["Core_A1-C3",2048,2048],["Core_A1-D3",3072,2048],["Core_A1-A4",0,3072],["Core_A1-B4",1024,3072],["Core_A1-C4",2048,3072],["Core_A1-D4",3072,3072],["Core_A1-A5",0,4096],["Core_A1-B5",1024,4096],["Core_A1-C5",2048,4096],["Core_A1-D5",3072,4096],["Core_A1-A6",0,5120],["Core_A1-B6",1024,5120],["Core_A1-C6",2048,5120],["Core_A1-D6",3072,5120],["Core_A1-A7",0,6144],["Core_A1-B7",1024,6144],["Core_A1-C7",2048,6144],["Core_A1-D7",3072,6144],["Core_A1-A8",0,7168],["Core_A1-B8",1024,7168],["Core_A1-C8",2048,7168],["Core_A1-D8",3072,7168]]},Core_B1:{hx:[["Core_B1-A1",0,0],["Core_B1-A2",0,4096]],"1x":[["Core_B1-A1",0,0],["Core_B1-B1",2048,0],["Core_B1-A2",0,2048],["Core_B1-B2",2048,2048],["Core_B1-A3",0,4096],["Core_B1-B3",2048,4096]],"2x":[["Core_B1-A1",0,0],["Core_B1-B1",1024,0],["Core_B1-C1",2048,0],["Core_B1-D1",3072,0],["Core_B1-A2",0,1024],["Core_B1-B2",1024,1024],["Core_B1-C2",2048,1024],["Core_B1-D2",3072,1024],["Core_B1-A3",0,2048],["Core_B1-B3",1024,2048],["Core_B1-C3",2048,2048],["Core_B1-D3",3072,2048],["Core_B1-A4",0,3072],["Core_B1-B4",1024,3072],["Core_B1-C4",2048,3072],["Core_B1-D4",3072,3072],["Core_B1-A5",0,4096],["Core_B1-B5",1024,4096],["Core_B1-C5",2048,4096],["Core_B1-D5",3072,4096],["Core_B1-A6",0,5120],["Core_B1-B6",1024,5120],["Core_B1-C6",2048,5120],["Core_B1-D6",3072,5120]],"4x":[["Core_B1-A1",0,0],["Core_B1-B1",1024,0],["Core_B1-C1",2048,0],["Core_B1-D1",3072,0],["Core_B1-A2",0,1024],["Core_B1-B2",1024,1024],["Core_B1-C2",2048,1024],["Core_B1-D2",3072,1024],["Core_B1-A3",0,2048],["Core_B1-B3",1024,2048],["Core_B1-C3",2048,2048],["Core_B1-D3",3072,2048],["Core_B1-A4",0,3072],["Core_B1-B4",1024,3072],["Core_B1-C4",2048,3072],["Core_B1-D4",3072,3072],["Core_B1-A5",0,4096],["Core_B1-B5",1024,4096],["Core_B1-C5",2048,4096],["Core_B1-D5",3072,4096],["Core_B1-A6",0,5120],["Core_B1-B6",1024,5120],["Core_B1-C6",2048,5120],["Core_B1-D6",3072,5120]]},Core_B2:{hx:[["Core_B2-A1",0,0]],"1x":[["Core_B2-A1",0,0],["Core_B2-B1",2048,0],["Core_B2-A2",0,2048],["Core_B2-B2",2048,2048]],"2x":[["Core_B2-A1",0,0],["Core_B2-B1",1024,0],["Core_B2-C1",2048,0],["Core_B2-D1",3072,0],["Core_B2-A2",0,1024],["Core_B2-B2",1024,1024],["Core_B2-C2",2048,1024],["Core_B2-D2",3072,1024],["Core_B2-A3",0,2048],["Core_B2-B3",1024,2048],["Core_B2-C3",2048,2048],["Core_B2-D3",3072,2048],["Core_B2-A4",0,3072],["Core_B2-B4",1024,3072],["Core_B2-C4",2048,3072],["Core_B2-D4",3072,3072]],"4x":[["Core_B2-A1",0,0],["Core_B2-B1",1024,0],["Core_B2-C1",2048,0],["Core_B2-D1",3072,0],["Core_B2-A2",0,1024],["Core_B2-B2",1024,1024],["Core_B2-C2",2048,1024],["Core_B2-D2",3072,1024],["Core_B2-A3",0,2048],["Core_B2-B3",1024,2048],["Core_B2-C3",2048,2048],["Core_B2-D3",3072,2048],["Core_B2-A4",0,3072],["Core_B2-B4",1024,3072],["Core_B2-C4",2048,3072],["Core_B2-D4",3072,3072]]},Core_C1:{hx:[["Core_C1-A1",0,0]],"1x":[["Core_C1-A1",0,0],["Core_C1-B1",2048,0]],"2x":[["Core_C1-B1",1024,0],["Core_C1-C1",2048,0],["Core_C1-B2",1024,1024],["Core_C1-C2",2048,1024]],"4x":[["Core_C1-B1",1024,0],["Core_C1-C1",2048,0],["Core_C1-B2",1024,1024],["Core_C1-C2",2048,1024]]},Core_Front:{hx:[["Core_Front-A1",0,0],["Core_Front-A2",0,4096],["Core_Front-A3",0,8192],["Core_Front-A4",0,12288],["Core_Front-A5",0,16384]],"1x":[["Core_Front-A1",0,0],["Core_Front-B1",2048,0],["Core_Front-A2",0,2048],["Core_Front-B2",2048,2048],["Core_Front-A3",0,4096],["Core_Front-B3",2048,4096],["Core_Front-A4",0,6144],["Core_Front-B4",2048,6144],["Core_Front-A5",0,8192],["Core_Front-B5",2048,8192],["Core_Front-A6",0,10240],["Core_Front-B6",2048,10240],["Core_Front-A7",0,12288],["Core_Front-B7",2048,12288],["Core_Front-A8",0,14336],["Core_Front-B8",2048,14336],["Core_Front-A9",0,16384],["Core_Front-B9",2048,16384],["Core_Front-A10",0,18432],["Core_Front-B10",2048,18432]],"2x":[["Core_Front-A1",0,0],["Core_Front-B1",1024,0],["Core_Front-C1",2048,0],["Core_Front-D1",3072,0],["Core_Front-A2",0,1024],["Core_Front-B2",1024,1024],["Core_Front-C2",2048,1024],["Core_Front-D2",3072,1024],["Core_Front-A3",0,2048],["Core_Front-B3",1024,2048],["Core_Front-C3",2048,2048],["Core_Front-D3",3072,2048],["Core_Front-A4",0,3072],["Core_Front-B4",1024,3072],["Core_Front-C4",2048,3072],["Core_Front-D4",3072,3072],["Core_Front-A5",0,4096],["Core_Front-B5",1024,4096],["Core_Front-C5",2048,4096],["Core_Front-D5",3072,4096],["Core_Front-A6",0,5120],["Core_Front-B6",1024,5120],["Core_Front-C6",2048,5120],["Core_Front-D6",3072,5120],["Core_Front-A7",0,6144],["Core_Front-B7",1024,6144],["Core_Front-C7",2048,6144],["Core_Front-D7",3072,6144],["Core_Front-A8",0,7168],["Core_Front-C8",2048,7168],["Core_Front-D8",3072,7168],["Core_Front-A9",0,8192],["Core_Front-B9",1024,8192],["Core_Front-C9",2048,8192],["Core_Front-D9",3072,8192],["Core_Front-A10",0,9216],["Core_Front-B10",1024,9216],["Core_Front-C10",2048,9216],["Core_Front-D10",3072,9216],["Core_Front-A11",0,10240],["Core_Front-B11",1024,10240],["Core_Front-C11",2048,10240],["Core_Front-D11",3072,10240],["Core_Front-A12",0,11264],["Core_Front-B12",1024,11264],["Core_Front-C12",2048,11264],["Core_Front-D12",3072,11264],["Core_Front-A13",0,12288],["Core_Front-D13",3072,12288],["Core_Front-A14",0,13312],["Core_Front-B14",1024,13312],["Core_Front-C14",2048,13312],["Core_Front-D14",3072,13312],["Core_Front-A15",0,14336],["Core_Front-B15",1024,14336],["Core_Front-C15",2048,14336],["Core_Front-D15",3072,14336],["Core_Front-A16",0,15360],["Core_Front-B16",1024,15360],["Core_Front-C16",2048,15360],["Core_Front-D16",3072,15360],["Core_Front-A17",0,16384],["Core_Front-B17",1024,16384],["Core_Front-C17",2048,16384],["Core_Front-D17",3072,16384],["Core_Front-A18",0,17408],["Core_Front-B18",1024,17408],["Core_Front-C18",2048,17408],["Core_Front-D18",3072,17408],["Core_Front-A19",0,18432],["Core_Front-B19",1024,18432],["Core_Front-C19",2048,18432],["Core_Front-D19",3072,18432],["Core_Front-A20",0,19456],["Core_Front-B20",1024,19456],["Core_Front-C20",2048,19456],["Core_Front-D20",3072,19456]],"4x":[["Core_Front-A1",0,0],["Core_Front-B1",1024,0],["Core_Front-C1",2048,0],["Core_Front-D1",3072,0],["Core_Front-A2",0,1024],["Core_Front-B2",1024,1024],["Core_Front-C2",2048,1024],["Core_Front-D2",3072,1024],["Core_Front-A3",0,2048],["Core_Front-B3",1024,2048],["Core_Front-C3",2048,2048],["Core_Front-D3",3072,2048],["Core_Front-A4",0,3072],["Core_Front-B4",1024,3072],["Core_Front-C4",2048,3072],["Core_Front-D4",3072,3072],["Core_Front-A5",0,4096],["Core_Front-B5",1024,4096],["Core_Front-C5",2048,4096],["Core_Front-D5",3072,4096],["Core_Front-A6",0,5120],["Core_Front-B6",1024,5120],["Core_Front-C6",2048,5120],["Core_Front-D6",3072,5120],["Core_Front-A7",0,6144],["Core_Front-B7",1024,6144],["Core_Front-C7",2048,6144],["Core_Front-D7",3072,6144],["Core_Front-A8",0,7168],["Core_Front-C8",2048,7168],["Core_Front-D8",3072,7168],["Core_Front-A9",0,8192],["Core_Front-B9",1024,8192],["Core_Front-C9",2048,8192],["Core_Front-D9",3072,8192],["Core_Front-A10",0,9216],["Core_Front-B10",1024,9216],["Core_Front-C10",2048,9216],["Core_Front-D10",3072,9216],["Core_Front-A11",0,10240],["Core_Front-B11",1024,10240],["Core_Front-C11",2048,10240],["Core_Front-D11",3072,10240],["Core_Front-A12",0,11264],["Core_Front-B12",1024,11264],["Core_Front-C12",2048,11264],["Core_Front-D12",3072,11264],["Core_Front-A13",0,12288],["Core_Front-D13",3072,12288],["Core_Front-A14",0,13312],["Core_Front-B14",1024,13312],["Core_Front-C14",2048,13312],["Core_Front-D14",3072,13312],["Core_Front-A15",0,14336],["Core_Front-B15",1024,14336],["Core_Front-C15",2048,14336],["Core_Front-D15",3072,14336],["Core_Front-A16",0,15360],["Core_Front-B16",1024,15360],["Core_Front-C16",2048,15360],["Core_Front-D16",3072,15360],["Core_Front-A17",0,16384],["Core_Front-B17",1024,16384],["Core_Front-C17",2048,16384],["Core_Front-D17",3072,16384],["Core_Front-A18",0,17408],["Core_Front-B18",1024,17408],["Core_Front-C18",2048,17408],["Core_Front-D18",3072,17408],["Core_Front-A19",0,18432],["Core_Front-B19",1024,18432],["Core_Front-C19",2048,18432],["Core_Front-D19",3072,18432],["Core_Front-A20",0,19456],["Core_Front-B20",1024,19456],["Core_Front-C20",2048,19456],["Core_Front-D20",3072,19456]]},Corruption_A1:{hx:[["Corruption_A1-A1",0,0],["Corruption_A1-A2",0,4096]],"1x":[["Corruption_A1-A1",0,0],["Corruption_A1-B1",2048,0],["Corruption_A1-A2",0,2048],["Corruption_A1-B2",2048,2048],["Corruption_A1-A3",0,4096],["Corruption_A1-B3",2048,4096]],"2x":[["Corruption_A1-A1",0,0],["Corruption_A1-B1",1024,0],["Corruption_A1-C1",2048,0],["Corruption_A1-D1",3072,0],["Corruption_A1-A2",0,1024],["Corruption_A1-B2",1024,1024],["Corruption_A1-C2",2048,1024],["Corruption_A1-D2",3072,1024],["Corruption_A1-A3",0,2048],["Corruption_A1-B3",1024,2048],["Corruption_A1-C3",2048,2048],["Corruption_A1-D3",3072,2048],["Corruption_A1-A4",0,3072],["Corruption_A1-B4",1024,3072],["Corruption_A1-C4",2048,3072],["Corruption_A1-D4",3072,3072],["Corruption_A1-A5",0,4096],["Corruption_A1-B5",1024,4096],["Corruption_A1-C5",2048,4096],["Corruption_A1-D5",3072,4096],["Corruption_A1-A6",0,5120],["Corruption_A1-B6",1024,5120],["Corruption_A1-C6",2048,5120],["Corruption_A1-D6",3072,5120]],"4x":[["Corruption_A1-A1",0,0],["Corruption_A1-B1",1024,0],["Corruption_A1-C1",2048,0],["Corruption_A1-D1",3072,0],["Corruption_A1-A2",0,1024],["Corruption_A1-B2",1024,1024],["Corruption_A1-C2",2048,1024],["Corruption_A1-D2",3072,1024],["Corruption_A1-A3",0,2048],["Corruption_A1-B3",1024,2048],["Corruption_A1-C3",2048,2048],["Corruption_A1-D3",3072,2048],["Corruption_A1-A4",0,3072],["Corruption_A1-B4",1024,3072],["Corruption_A1-C4",2048,3072],["Corruption_A1-D4",3072,3072],["Corruption_A1-A5",0,4096],["Corruption_A1-B5",1024,4096],["Corruption_A1-C5",2048,4096],["Corruption_A1-D5",3072,4096],["Corruption_A1-A6",0,5120],["Corruption_A1-B6",1024,5120],["Corruption_A1-C6",2048,5120],["Corruption_A1-D6",3072,5120]]},Corruption_B1:{hx:[["Corruption_B1-A1",0,0],["Corruption_B1-A2",0,4096]],"1x":[["Corruption_B1-A1",0,0],["Corruption_B1-B1",2048,0],["Corruption_B1-A2",0,2048],["Corruption_B1-B2",2048,2048],["Corruption_B1-A3",0,4096],["Corruption_B1-B3",2048,4096]],"2x":[["Corruption_B1-A1",0,0],["Corruption_B1-B1",1024,0],["Corruption_B1-C1",2048,0],["Corruption_B1-D1",3072,0],["Corruption_B1-A2",0,1024],["Corruption_B1-B2",1024,1024],["Corruption_B1-C2",2048,1024],["Corruption_B1-D2",3072,1024],["Corruption_B1-A3",0,2048],["Corruption_B1-B3",1024,2048],["Corruption_B1-C3",2048,2048],["Corruption_B1-D3",3072,2048],["Corruption_B1-A4",0,3072],["Corruption_B1-B4",1024,3072],["Corruption_B1-C4",2048,3072],["Corruption_B1-D4",3072,3072],["Corruption_B1-A5",0,4096],["Corruption_B1-B5",1024,4096],["Corruption_B1-C5",2048,4096],["Corruption_B1-D5",3072,4096]],"4x":[["Corruption_B1-A1",0,0],["Corruption_B1-B1",1024,0],["Corruption_B1-C1",2048,0],["Corruption_B1-D1",3072,0],["Corruption_B1-A2",0,1024],["Corruption_B1-B2",1024,1024],["Corruption_B1-C2",2048,1024],["Corruption_B1-D2",3072,1024],["Corruption_B1-A3",0,2048],["Corruption_B1-B3",1024,2048],["Corruption_B1-C3",2048,2048],["Corruption_B1-D3",3072,2048],["Corruption_B1-A4",0,3072],["Corruption_B1-B4",1024,3072],["Corruption_B1-C4",2048,3072],["Corruption_B1-D4",3072,3072],["Corruption_B1-A5",0,4096],["Corruption_B1-B5",1024,4096],["Corruption_B1-C5",2048,4096],["Corruption_B1-D5",3072,4096]]},Corruption_B2:{hx:[["Corruption_B2-A1",0,0],["Corruption_B2-A2",0,4096]],"1x":[["Corruption_B2-A1",0,0],["Corruption_B2-B1",2048,0],["Corruption_B2-A2",0,2048],["Corruption_B2-B2",2048,2048],["Corruption_B2-A3",0,4096],["Corruption_B2-B3",2048,4096]],"2x":[["Corruption_B2-A1",0,0],["Corruption_B2-B1",1024,0],["Corruption_B2-C1",2048,0],["Corruption_B2-D1",3072,0],["Corruption_B2-A2",0,1024],["Corruption_B2-B2",1024,1024],["Corruption_B2-C2",2048,1024],["Corruption_B2-D2",3072,1024],["Corruption_B2-A3",0,2048],["Corruption_B2-B3",1024,2048],["Corruption_B2-C3",2048,2048],["Corruption_B2-D3",3072,2048],["Corruption_B2-A4",0,3072],["Corruption_B2-B4",1024,3072],["Corruption_B2-C4",2048,3072],["Corruption_B2-D4",3072,3072],["Corruption_B2-A5",0,4096],["Corruption_B2-B5",1024,4096],["Corruption_B2-C5",2048,4096],["Corruption_B2-D5",3072,4096]],"4x":[["Corruption_B2-A1",0,0],["Corruption_B2-B1",1024,0],["Corruption_B2-C1",2048,0],["Corruption_B2-D1",3072,0],["Corruption_B2-A2",0,1024],["Corruption_B2-B2",1024,1024],["Corruption_B2-C2",2048,1024],["Corruption_B2-D2",3072,1024],["Corruption_B2-A3",0,2048],["Corruption_B2-B3",1024,2048],["Corruption_B2-C3",2048,2048],["Corruption_B2-D3",3072,2048],["Corruption_B2-A4",0,3072],["Corruption_B2-B4",1024,3072],["Corruption_B2-C4",2048,3072],["Corruption_B2-D4",3072,3072],["Corruption_B2-A5",0,4096],["Corruption_B2-B5",1024,4096],["Corruption_B2-C5",2048,4096],["Corruption_B2-D5",3072,4096]]},Corruption_C1:{hx:[["Corruption_C1-A1",0,0],["Corruption_C1-A2",0,4096]],"1x":[["Corruption_C1-A1",0,0],["Corruption_C1-B1",2048,0],["Corruption_C1-A2",0,2048],["Corruption_C1-B2",2048,2048],["Corruption_C1-A3",0,4096],["Corruption_C1-B3",2048,4096]],"2x":[["Corruption_C1-A1",0,0],["Corruption_C1-B1",1024,0],["Corruption_C1-C1",2048,0],["Corruption_C1-D1",3072,0],["Corruption_C1-A2",0,1024],["Corruption_C1-B2",1024,1024],["Corruption_C1-C2",2048,1024],["Corruption_C1-D2",3072,1024],["Corruption_C1-A3",0,2048],["Corruption_C1-B3",1024,2048],["Corruption_C1-C3",2048,2048],["Corruption_C1-D3",3072,2048],["Corruption_C1-A4",0,3072],["Corruption_C1-B4",1024,3072],["Corruption_C1-C4",2048,3072],["Corruption_C1-D4",3072,3072],["Corruption_C1-A5",0,4096],["Corruption_C1-B5",1024,4096],["Corruption_C1-C5",2048,4096],["Corruption_C1-D5",3072,4096],["Corruption_C1-A6",0,5120],["Corruption_C1-B6",1024,5120],["Corruption_C1-C6",2048,5120],["Corruption_C1-D6",3072,5120]],"4x":[["Corruption_C1-A1",0,0],["Corruption_C1-B1",1024,0],["Corruption_C1-C1",2048,0],["Corruption_C1-D1",3072,0],["Corruption_C1-A2",0,1024],["Corruption_C1-B2",1024,1024],["Corruption_C1-C2",2048,1024],["Corruption_C1-D2",3072,1024],["Corruption_C1-A3",0,2048],["Corruption_C1-B3",1024,2048],["Corruption_C1-C3",2048,2048],["Corruption_C1-D3",3072,2048],["Corruption_C1-A4",0,3072],["Corruption_C1-B4",1024,3072],["Corruption_C1-C4",2048,3072],["Corruption_C1-D4",3072,3072],["Corruption_C1-A5",0,4096],["Corruption_C1-B5",1024,4096],["Corruption_C1-C5",2048,4096],["Corruption_C1-D5",3072,4096],["Corruption_C1-A6",0,5120],["Corruption_C1-B6",1024,5120],["Corruption_C1-C6",2048,5120],["Corruption_C1-D6",3072,5120]]},Corruption_C2:{hx:[["Corruption_C2-A1",0,0],["Corruption_C2-A2",0,4096]],"1x":[["Corruption_C2-A1",0,0],["Corruption_C2-B1",2048,0],["Corruption_C2-A2",0,2048],["Corruption_C2-B2",2048,2048],["Corruption_C2-A3",0,4096]],"2x":[["Corruption_C2-A1",0,0],["Corruption_C2-B1",1024,0],["Corruption_C2-C1",2048,0],["Corruption_C2-D1",3072,0],["Corruption_C2-A2",0,1024],["Corruption_C2-B2",1024,1024],["Corruption_C2-C2",2048,1024],["Corruption_C2-D2",3072,1024],["Corruption_C2-A3",0,2048],["Corruption_C2-D3",3072,2048],["Corruption_C2-A4",0,3072],["Corruption_C2-A5",0,4096]],"4x":[["Corruption_C2-A1",0,0],["Corruption_C2-B1",1024,0],["Corruption_C2-C1",2048,0],["Corruption_C2-D1",3072,0],["Corruption_C2-A2",0,1024],["Corruption_C2-B2",1024,1024],["Corruption_C2-C2",2048,1024],["Corruption_C2-D2",3072,1024],["Corruption_C2-A3",0,2048],["Corruption_C2-D3",3072,2048],["Corruption_C2-A4",0,3072],["Corruption_C2-A5",0,4096]]},Corruption_D1:{hx:[["Corruption_D1-A1",0,0],["Corruption_D1-A2",0,4096]],"1x":[["Corruption_D1-A1",0,0],["Corruption_D1-B1",2048,0],["Corruption_D1-A2",0,2048],["Corruption_D1-B2",2048,2048],["Corruption_D1-A3",0,4096],["Corruption_D1-B3",2048,4096]],"2x":[["Corruption_D1-A1",0,0],["Corruption_D1-B1",1024,0],["Corruption_D1-C1",2048,0],["Corruption_D1-D1",3072,0],["Corruption_D1-A2",0,1024],["Corruption_D1-B2",1024,1024],["Corruption_D1-C2",2048,1024],["Corruption_D1-D2",3072,1024],["Corruption_D1-A3",0,2048],["Corruption_D1-B3",1024,2048],["Corruption_D1-C3",2048,2048],["Corruption_D1-D3",3072,2048],["Corruption_D1-A4",0,3072],["Corruption_D1-B4",1024,3072],["Corruption_D1-C4",2048,3072],["Corruption_D1-D4",3072,3072],["Corruption_D1-A5",0,4096],["Corruption_D1-B5",1024,4096],["Corruption_D1-C5",2048,4096],["Corruption_D1-D5",3072,4096],["Corruption_D1-A6",0,5120],["Corruption_D1-B6",1024,5120],["Corruption_D1-C6",2048,5120],["Corruption_D1-D6",3072,5120]],"4x":[["Corruption_D1-A1",0,0],["Corruption_D1-B1",1024,0],["Corruption_D1-C1",2048,0],["Corruption_D1-D1",3072,0],["Corruption_D1-A2",0,1024],["Corruption_D1-B2",1024,1024],["Corruption_D1-C2",2048,1024],["Corruption_D1-D2",3072,1024],["Corruption_D1-A3",0,2048],["Corruption_D1-B3",1024,2048],["Corruption_D1-C3",2048,2048],["Corruption_D1-D3",3072,2048],["Corruption_D1-A4",0,3072],["Corruption_D1-B4",1024,3072],["Corruption_D1-C4",2048,3072],["Corruption_D1-D4",3072,3072],["Corruption_D1-A5",0,4096],["Corruption_D1-B5",1024,4096],["Corruption_D1-C5",2048,4096],["Corruption_D1-D5",3072,4096],["Corruption_D1-A6",0,5120],["Corruption_D1-B6",1024,5120],["Corruption_D1-C6",2048,5120],["Corruption_D1-D6",3072,5120]]},Corruption_D2:{hx:[["Corruption_D2-A1",0,0],["Corruption_D2-A2",0,4096]],"1x":[["Corruption_D2-A1",0,0],["Corruption_D2-B1",2048,0],["Corruption_D2-A2",0,2048],["Corruption_D2-B2",2048,2048],["Corruption_D2-A3",0,4096],["Corruption_D2-B3",2048,4096]],"2x":[["Corruption_D2-A1",0,0],["Corruption_D2-B1",1024,0],["Corruption_D2-C1",2048,0],["Corruption_D2-D1",3072,0],["Corruption_D2-A2",0,1024],["Corruption_D2-B2",1024,1024],["Corruption_D2-C2",2048,1024],["Corruption_D2-D2",3072,1024],["Corruption_D2-A3",0,2048],["Corruption_D2-B3",1024,2048],["Corruption_D2-C3",2048,2048],["Corruption_D2-D3",3072,2048],["Corruption_D2-A4",0,3072],["Corruption_D2-B4",1024,3072],["Corruption_D2-C4",2048,3072],["Corruption_D2-D4",3072,3072],["Corruption_D2-A5",0,4096],["Corruption_D2-B5",1024,4096],["Corruption_D2-C5",2048,4096],["Corruption_D2-D5",3072,4096]],"4x":[["Corruption_D2-A1",0,0],["Corruption_D2-B1",1024,0],["Corruption_D2-C1",2048,0],["Corruption_D2-D1",3072,0],["Corruption_D2-A2",0,1024],["Corruption_D2-B2",1024,1024],["Corruption_D2-C2",2048,1024],["Corruption_D2-D2",3072,1024],["Corruption_D2-A3",0,2048],["Corruption_D2-B3",1024,2048],["Corruption_D2-C3",2048,2048],["Corruption_D2-D3",3072,2048],["Corruption_D2-A4",0,3072],["Corruption_D2-B4",1024,3072],["Corruption_D2-C4",2048,3072],["Corruption_D2-D4",3072,3072],["Corruption_D2-A5",0,4096],["Corruption_D2-B5",1024,4096],["Corruption_D2-C5",2048,4096],["Corruption_D2-D5",3072,4096]]},Corruption_Front:{hx:[["Corruption_Front-A1",0,0],["Corruption_Front-A2",0,4096],["Corruption_Front-A3",0,8192],["Corruption_Front-A4",0,12288],["Corruption_Front-A5",0,16384],["Corruption_Front-A6",0,20480]],"1x":[["Corruption_Front-A1",0,0],["Corruption_Front-B1",2048,0],["Corruption_Front-A2",0,2048],["Corruption_Front-B2",2048,2048],["Corruption_Front-A3",0,4096],["Corruption_Front-B3",2048,4096],["Corruption_Front-A4",0,6144],["Corruption_Front-B4",2048,6144],["Corruption_Front-A5",0,8192],["Corruption_Front-B5",2048,8192],["Corruption_Front-A6",0,10240],["Corruption_Front-B6",2048,10240],["Corruption_Front-A7",0,12288],["Corruption_Front-B7",2048,12288],["Corruption_Front-A8",0,14336],["Corruption_Front-B8",2048,14336],["Corruption_Front-A9",0,16384],["Corruption_Front-B9",2048,16384],["Corruption_Front-A10",0,18432],["Corruption_Front-B10",2048,18432],["Corruption_Front-A11",0,20480],["Corruption_Front-B11",2048,20480]],"2x":[["Corruption_Front-A1",0,0],["Corruption_Front-B1",1024,0],["Corruption_Front-C1",2048,0],["Corruption_Front-D1",3072,0],["Corruption_Front-A2",0,1024],["Corruption_Front-B2",1024,1024],["Corruption_Front-C2",2048,1024],["Corruption_Front-D2",3072,1024],["Corruption_Front-A3",0,2048],["Corruption_Front-B3",1024,2048],["Corruption_Front-C3",2048,2048],["Corruption_Front-D3",3072,2048],["Corruption_Front-A4",0,3072],["Corruption_Front-B4",1024,3072],["Corruption_Front-C4",2048,3072],["Corruption_Front-D4",3072,3072],["Corruption_Front-A5",0,4096],["Corruption_Front-B5",1024,4096],["Corruption_Front-C5",2048,4096],["Corruption_Front-D5",3072,4096],["Corruption_Front-A6",0,5120],["Corruption_Front-B6",1024,5120],["Corruption_Front-C6",2048,5120],["Corruption_Front-D6",3072,5120],["Corruption_Front-A7",0,6144],["Corruption_Front-B7",1024,6144],["Corruption_Front-C7",2048,6144],["Corruption_Front-D7",3072,6144],["Corruption_Front-A8",0,7168],["Corruption_Front-B8",1024,7168],["Corruption_Front-C8",2048,7168],["Corruption_Front-D8",3072,7168],["Corruption_Front-A9",0,8192],["Corruption_Front-B9",1024,8192],["Corruption_Front-C9",2048,8192],["Corruption_Front-D9",3072,8192],["Corruption_Front-A10",0,9216],["Corruption_Front-B10",1024,9216],["Corruption_Front-C10",2048,9216],["Corruption_Front-D10",3072,9216],["Corruption_Front-A11",0,10240],["Corruption_Front-B11",1024,10240],["Corruption_Front-C11",2048,10240],["Corruption_Front-D11",3072,10240],["Corruption_Front-A12",0,11264],["Corruption_Front-B12",1024,11264],["Corruption_Front-C12",2048,11264],["Corruption_Front-D12",3072,11264],["Corruption_Front-A13",0,12288],["Corruption_Front-B13",1024,12288],["Corruption_Front-C13",2048,12288],["Corruption_Front-D13",3072,12288],["Corruption_Front-A14",0,13312],["Corruption_Front-C14",2048,13312],["Corruption_Front-D14",3072,13312],["Corruption_Front-A15",0,14336],["Corruption_Front-B15",1024,14336],["Corruption_Front-C15",2048,14336],["Corruption_Front-D15",3072,14336],["Corruption_Front-A16",0,15360],["Corruption_Front-B16",1024,15360],["Corruption_Front-C16",2048,15360],["Corruption_Front-D16",3072,15360],["Corruption_Front-A17",0,16384],["Corruption_Front-B17",1024,16384],["Corruption_Front-C17",2048,16384],["Corruption_Front-D17",3072,16384],["Corruption_Front-A18",0,17408],["Corruption_Front-B18",1024,17408],["Corruption_Front-C18",2048,17408],["Corruption_Front-D18",3072,17408],["Corruption_Front-A19",0,18432],["Corruption_Front-B19",1024,18432],["Corruption_Front-C19",2048,18432],["Corruption_Front-D19",3072,18432],["Corruption_Front-A20",0,19456],["Corruption_Front-B20",1024,19456],["Corruption_Front-C20",2048,19456],["Corruption_Front-D20",3072,19456],["Corruption_Front-A21",0,20480],["Corruption_Front-D21",3072,20480],["Corruption_Front-D22",3072,21504]],"4x":[["Corruption_Front-A1",0,0],["Corruption_Front-B1",1024,0],["Corruption_Front-C1",2048,0],["Corruption_Front-D1",3072,0],["Corruption_Front-A2",0,1024],["Corruption_Front-B2",1024,1024],["Corruption_Front-C2",2048,1024],["Corruption_Front-D2",3072,1024],["Corruption_Front-A3",0,2048],["Corruption_Front-B3",1024,2048],["Corruption_Front-C3",2048,2048],["Corruption_Front-D3",3072,2048],["Corruption_Front-A4",0,3072],["Corruption_Front-B4",1024,3072],["Corruption_Front-C4",2048,3072],["Corruption_Front-D4",3072,3072],["Corruption_Front-A5",0,4096],["Corruption_Front-B5",1024,4096],["Corruption_Front-C5",2048,4096],["Corruption_Front-D5",3072,4096],["Corruption_Front-A6",0,5120],["Corruption_Front-B6",1024,5120],["Corruption_Front-C6",2048,5120],["Corruption_Front-D6",3072,5120],["Corruption_Front-A7",0,6144],["Corruption_Front-B7",1024,6144],["Corruption_Front-C7",2048,6144],["Corruption_Front-D7",3072,6144],["Corruption_Front-A8",0,7168],["Corruption_Front-B8",1024,7168],["Corruption_Front-C8",2048,7168],["Corruption_Front-D8",3072,7168],["Corruption_Front-A9",0,8192],["Corruption_Front-B9",1024,8192],["Corruption_Front-C9",2048,8192],["Corruption_Front-D9",3072,8192],["Corruption_Front-A10",0,9216],["Corruption_Front-B10",1024,9216],["Corruption_Front-C10",2048,9216],["Corruption_Front-D10",3072,9216],["Corruption_Front-A11",0,10240],["Corruption_Front-B11",1024,10240],["Corruption_Front-C11",2048,10240],["Corruption_Front-D11",3072,10240],["Corruption_Front-A12",0,11264],["Corruption_Front-B12",1024,11264],["Corruption_Front-C12",2048,11264],["Corruption_Front-D12",3072,11264],["Corruption_Front-A13",0,12288],["Corruption_Front-B13",1024,12288],["Corruption_Front-C13",2048,12288],["Corruption_Front-D13",3072,12288],["Corruption_Front-A14",0,13312],["Corruption_Front-C14",2048,13312],["Corruption_Front-D14",3072,13312],["Corruption_Front-A15",0,14336],["Corruption_Front-B15",1024,14336],["Corruption_Front-C15",2048,14336],["Corruption_Front-D15",3072,14336],["Corruption_Front-A16",0,15360],["Corruption_Front-B16",1024,15360],["Corruption_Front-C16",2048,15360],["Corruption_Front-D16",3072,15360],["Corruption_Front-A17",0,16384],["Corruption_Front-B17",1024,16384],["Corruption_Front-C17",2048,16384],["Corruption_Front-D17",3072,16384],["Corruption_Front-A18",0,17408],["Corruption_Front-B18",1024,17408],["Corruption_Front-C18",2048,17408],["Corruption_Front-D18",3072,17408],["Corruption_Front-A19",0,18432],["Corruption_Front-B19",1024,18432],["Corruption_Front-C19",2048,18432],["Corruption_Front-D19",3072,18432],["Corruption_Front-A20",0,19456],["Corruption_Front-B20",1024,19456],["Corruption_Front-C20",2048,19456],["Corruption_Front-D20",3072,19456],["Corruption_Front-A21",0,20480],["Corruption_Front-D21",3072,20480],["Corruption_Front-D22",3072,21504]]},Hall_1A:{hx:[["Hall_1A-A1",0,0]],"1x":[["Hall_1A-A1",0,0],["Hall_1A-B1",2048,0],["Hall_1A-A2",0,2048],["Hall_1A-B2",2048,2048]],"2x":[["Hall_1A-A1",0,0],["Hall_1A-B1",1024,0],["Hall_1A-C1",2048,0],["Hall_1A-D1",3072,0],["Hall_1A-A2",0,1024],["Hall_1A-B2",1024,1024],["Hall_1A-C2",2048,1024],["Hall_1A-D2",3072,1024],["Hall_1A-A3",0,2048],["Hall_1A-B3",1024,2048],["Hall_1A-C3",2048,2048],["Hall_1A-D3",3072,2048],["Hall_1A-A4",0,3072],["Hall_1A-B4",1024,3072],["Hall_1A-C4",2048,3072],["Hall_1A-D4",3072,3072]],"4x":[["Hall_1A-A1",0,0],["Hall_1A-B1",1024,0],["Hall_1A-C1",2048,0],["Hall_1A-D1",3072,0],["Hall_1A-A2",0,1024],["Hall_1A-B2",1024,1024],["Hall_1A-C2",2048,1024],["Hall_1A-D2",3072,1024],["Hall_1A-A3",0,2048],["Hall_1A-B3",1024,2048],["Hall_1A-C3",2048,2048],["Hall_1A-D3",3072,2048],["Hall_1A-A4",0,3072],["Hall_1A-B4",1024,3072],["Hall_1A-C4",2048,3072],["Hall_1A-D4",3072,3072]]},Hall_Front:{hx:[["Hall_Front-A1",0,0]],"1x":[["Hall_Front-A1",0,0],["Hall_Front-B1",2048,0],["Hall_Front-A2",0,2048],["Hall_Front-B2",2048,2048]],"2x":[["Hall_Front-A1",0,0],["Hall_Front-B1",1024,0],["Hall_Front-C1",2048,0],["Hall_Front-D1",3072,0],["Hall_Front-A2",0,1024],["Hall_Front-B2",1024,1024],["Hall_Front-C2",2048,1024],["Hall_Front-D2",3072,1024],["Hall_Front-A3",0,2048],["Hall_Front-B3",1024,2048],["Hall_Front-C3",2048,2048],["Hall_Front-D3",3072,2048],["Hall_Front-A4",0,3072],["Hall_Front-B4",1024,3072],["Hall_Front-C4",2048,3072],["Hall_Front-D4",3072,3072]],"4x":[["Hall_Front-A1",0,0],["Hall_Front-B1",1024,0],["Hall_Front-C1",2048,0],["Hall_Front-D1",3072,0],["Hall_Front-A2",0,1024],["Hall_Front-B2",1024,1024],["Hall_Front-C2",2048,1024],["Hall_Front-D2",3072,1024],["Hall_Front-A3",0,2048],["Hall_Front-B3",1024,2048],["Hall_Front-C3",2048,2048],["Hall_Front-D3",3072,2048],["Hall_Front-A4",0,3072],["Hall_Front-B4",1024,3072],["Hall_Front-C4",2048,3072],["Hall_Front-D4",3072,3072]]},Hotel_A1:{hx:[["Hotel_A1-A1",0,0],["Hotel_A1-A2",0,4096]],"1x":[["Hotel_A1-A1",0,0],["Hotel_A1-B1",2048,0],["Hotel_A1-A2",0,2048],["Hotel_A1-B2",2048,2048],["Hotel_A1-A3",0,4096],["Hotel_A1-B3",2048,4096]],"2x":[["Hotel_A1-A1",0,0],["Hotel_A1-B1",1024,0],["Hotel_A1-C1",2048,0],["Hotel_A1-D1",3072,0],["Hotel_A1-A2",0,1024],["Hotel_A1-B2",1024,1024],["Hotel_A1-C2",2048,1024],["Hotel_A1-D2",3072,1024],["Hotel_A1-A3",0,2048],["Hotel_A1-B3",1024,2048],["Hotel_A1-C3",2048,2048],["Hotel_A1-D3",3072,2048],["Hotel_A1-A4",0,3072],["Hotel_A1-B4",1024,3072],["Hotel_A1-C4",2048,3072],["Hotel_A1-D4",3072,3072],["Hotel_A1-A5",0,4096],["Hotel_A1-B5",1024,4096],["Hotel_A1-C5",2048,4096],["Hotel_A1-D5",3072,4096]],"4x":[["Hotel_A1-A1",0,0],["Hotel_A1-B1",1024,0],["Hotel_A1-C1",2048,0],["Hotel_A1-D1",3072,0],["Hotel_A1-A2",0,1024],["Hotel_A1-B2",1024,1024],["Hotel_A1-C2",2048,1024],["Hotel_A1-D2",3072,1024],["Hotel_A1-A3",0,2048],["Hotel_A1-B3",1024,2048],["Hotel_A1-C3",2048,2048],["Hotel_A1-D3",3072,2048],["Hotel_A1-A4",0,3072],["Hotel_A1-B4",1024,3072],["Hotel_A1-C4",2048,3072],["Hotel_A1-D4",3072,3072],["Hotel_A1-A5",0,4096],["Hotel_A1-B5",1024,4096],["Hotel_A1-C5",2048,4096],["Hotel_A1-D5",3072,4096]]},Hotel_B1:{hx:[["Hotel_B1-A1",0,0]],"1x":[["Hotel_B1-A1",0,0],["Hotel_B1-B1",2048,0],["Hotel_B1-A2",0,2048],["Hotel_B1-B2",2048,2048]],"2x":[["Hotel_B1-A1",0,0],["Hotel_B1-B1",1024,0],["Hotel_B1-C1",2048,0],["Hotel_B1-D1",3072,0],["Hotel_B1-A2",0,1024],["Hotel_B1-B2",1024,1024],["Hotel_B1-C2",2048,1024],["Hotel_B1-D2",3072,1024],["Hotel_B1-A3",0,2048],["Hotel_B1-B3",1024,2048],["Hotel_B1-C3",2048,2048],["Hotel_B1-D3",3072,2048],["Hotel_B1-A4",0,3072],["Hotel_B1-B4",1024,3072],["Hotel_B1-C4",2048,3072],["Hotel_B1-D4",3072,3072]],"4x":[["Hotel_B1-A1",0,0],["Hotel_B1-B1",1024,0],["Hotel_B1-C1",2048,0],["Hotel_B1-D1",3072,0],["Hotel_B1-A2",0,1024],["Hotel_B1-B2",1024,1024],["Hotel_B1-C2",2048,1024],["Hotel_B1-D2",3072,1024],["Hotel_B1-A3",0,2048],["Hotel_B1-B3",1024,2048],["Hotel_B1-C3",2048,2048],["Hotel_B1-D3",3072,2048],["Hotel_B1-A4",0,3072],["Hotel_B1-B4",1024,3072],["Hotel_B1-C4",2048,3072],["Hotel_B1-D4",3072,3072]]},Hotel_Back1:{hx:[["Hotel_Back1-A1",0,0]],"1x":[["Hotel_Back1-A1",0,0],["Hotel_Back1-B1",2048,0],["Hotel_Back1-A2",0,2048],["Hotel_Back1-B2",2048,2048]],"2x":[["Hotel_Back1-A1",0,0],["Hotel_Back1-B1",1024,0],["Hotel_Back1-C1",2048,0],["Hotel_Back1-D1",3072,0],["Hotel_Back1-A2",0,1024],["Hotel_Back1-B2",1024,1024],["Hotel_Back1-C2",2048,1024],["Hotel_Back1-D2",3072,1024],["Hotel_Back1-A3",0,2048],["Hotel_Back1-B3",1024,2048],["Hotel_Back1-C3",2048,2048],["Hotel_Back1-D3",3072,2048],["Hotel_Back1-A4",0,3072],["Hotel_Back1-B4",1024,3072],["Hotel_Back1-C4",2048,3072],["Hotel_Back1-D4",3072,3072]],"4x":[["Hotel_Back1-A1",0,0],["Hotel_Back1-B1",1024,0],["Hotel_Back1-C1",2048,0],["Hotel_Back1-D1",3072,0],["Hotel_Back1-A2",0,1024],["Hotel_Back1-B2",1024,1024],["Hotel_Back1-C2",2048,1024],["Hotel_Back1-D2",3072,1024],["Hotel_Back1-A3",0,2048],["Hotel_Back1-B3",1024,2048],["Hotel_Back1-C3",2048,2048],["Hotel_Back1-D3",3072,2048],["Hotel_Back1-A4",0,3072],["Hotel_Back1-B4",1024,3072],["Hotel_Back1-C4",2048,3072],["Hotel_Back1-D4",3072,3072]]},Hotel_Back2:{hx:[["Hotel_Back2-A1",0,0]],"1x":[["Hotel_Back2-A1",0,0],["Hotel_Back2-B1",2048,0],["Hotel_Back2-A2",0,2048],["Hotel_Back2-B2",2048,2048]],"2x":[["Hotel_Back2-A1",0,0],["Hotel_Back2-B1",1024,0],["Hotel_Back2-C1",2048,0],["Hotel_Back2-D1",3072,0],["Hotel_Back2-A2",0,1024],["Hotel_Back2-B2",1024,1024],["Hotel_Back2-C2",2048,1024],["Hotel_Back2-D2",3072,1024],["Hotel_Back2-A3",0,2048],["Hotel_Back2-B3",1024,2048],["Hotel_Back2-C3",2048,2048],["Hotel_Back2-D3",3072,2048]],"4x":[["Hotel_Back2-A1",0,0],["Hotel_Back2-B1",1024,0],["Hotel_Back2-C1",2048,0],["Hotel_Back2-D1",3072,0],["Hotel_Back2-A2",0,1024],["Hotel_Back2-B2",1024,1024],["Hotel_Back2-C2",2048,1024],["Hotel_Back2-D2",3072,1024],["Hotel_Back2-A3",0,2048],["Hotel_Back2-B3",1024,2048],["Hotel_Back2-C3",2048,2048],["Hotel_Back2-D3",3072,2048]]},Hotel_Front:{hx:[["Hotel_Front-A1",0,0],["Hotel_Front-A2",0,4096]],"1x":[["Hotel_Front-A1",0,0],["Hotel_Front-B1",2048,0],["Hotel_Front-A2",0,2048],["Hotel_Front-B2",2048,2048],["Hotel_Front-A3",0,4096],["Hotel_Front-B3",2048,4096],["Hotel_Front-A4",0,6144],["Hotel_Front-B4",2048,6144]],"2x":[["Hotel_Front-A1",0,0],["Hotel_Front-B1",1024,0],["Hotel_Front-C1",2048,0],["Hotel_Front-D1",3072,0],["Hotel_Front-A2",0,1024],["Hotel_Front-B2",1024,1024],["Hotel_Front-C2",2048,1024],["Hotel_Front-D2",3072,1024],["Hotel_Front-A3",0,2048],["Hotel_Front-B3",1024,2048],["Hotel_Front-C3",2048,2048],["Hotel_Front-D3",3072,2048],["Hotel_Front-A4",0,3072],["Hotel_Front-B4",1024,3072],["Hotel_Front-C4",2048,3072],["Hotel_Front-D4",3072,3072],["Hotel_Front-A5",0,4096],["Hotel_Front-B5",1024,4096],["Hotel_Front-C5",2048,4096],["Hotel_Front-D5",3072,4096],["Hotel_Front-A6",0,5120],["Hotel_Front-B6",1024,5120],["Hotel_Front-C6",2048,5120],["Hotel_Front-D6",3072,5120],["Hotel_Front-A7",0,6144],["Hotel_Front-B7",1024,6144],["Hotel_Front-C7",2048,6144],["Hotel_Front-D7",3072,6144],["Hotel_Front-A8",0,7168],["Hotel_Front-B8",1024,7168],["Hotel_Front-C8",2048,7168],["Hotel_Front-D8",3072,7168]],"4x":[["Hotel_Front-A1",0,0],["Hotel_Front-B1",1024,0],["Hotel_Front-C1",2048,0],["Hotel_Front-D1",3072,0],["Hotel_Front-A2",0,1024],["Hotel_Front-B2",1024,1024],["Hotel_Front-C2",2048,1024],["Hotel_Front-D2",3072,1024],["Hotel_Front-A3",0,2048],["Hotel_Front-B3",1024,2048],["Hotel_Front-C3",2048,2048],["Hotel_Front-D3",3072,2048],["Hotel_Front-A4",0,3072],["Hotel_Front-B4",1024,3072],["Hotel_Front-C4",2048,3072],["Hotel_Front-D4",3072,3072],["Hotel_Front-A5",0,4096],["Hotel_Front-B5",1024,4096],["Hotel_Front-C5",2048,4096],["Hotel_Front-D5",3072,4096],["Hotel_Front-A6",0,5120],["Hotel_Front-B6",1024,5120],["Hotel_Front-C6",2048,5120],["Hotel_Front-D6",3072,5120],["Hotel_Front-A7",0,6144],["Hotel_Front-B7",1024,6144],["Hotel_Front-C7",2048,6144],["Hotel_Front-D7",3072,6144],["Hotel_Front-A8",0,7168],["Hotel_Front-B8",1024,7168],["Hotel_Front-C8",2048,7168],["Hotel_Front-D8",3072,7168]]},Lab_A1:{hx:[["Lab_A1-A1",0,0],["Lab_A1-A2",0,4096]],"1x":[["Lab_A1-A1",0,0],["Lab_A1-B1",2048,0],["Lab_A1-A2",0,2048],["Lab_A1-B2",2048,2048],["Lab_A1-A3",0,4096],["Lab_A1-B3",2048,4096],["Lab_A1-A4",0,6144],["Lab_A1-B4",2048,6144]],"2x":[["Lab_A1-A1",0,0],["Lab_A1-B1",1024,0],["Lab_A1-C1",2048,0],["Lab_A1-D1",3072,0],["Lab_A1-A2",0,1024],["Lab_A1-B2",1024,1024],["Lab_A1-C2",2048,1024],["Lab_A1-D2",3072,1024],["Lab_A1-A3",0,2048],["Lab_A1-B3",1024,2048],["Lab_A1-C3",2048,2048],["Lab_A1-D3",3072,2048],["Lab_A1-A4",0,3072],["Lab_A1-B4",1024,3072],["Lab_A1-C4",2048,3072],["Lab_A1-D4",3072,3072],["Lab_A1-A5",0,4096],["Lab_A1-B5",1024,4096],["Lab_A1-C5",2048,4096],["Lab_A1-D5",3072,4096],["Lab_A1-A6",0,5120],["Lab_A1-B6",1024,5120],["Lab_A1-C6",2048,5120],["Lab_A1-D6",3072,5120],["Lab_A1-A7",0,6144],["Lab_A1-B7",1024,6144],["Lab_A1-C7",2048,6144],["Lab_A1-D7",3072,6144]],"4x":[["Lab_A1-A1",0,0],["Lab_A1-B1",1024,0],["Lab_A1-C1",2048,0],["Lab_A1-D1",3072,0],["Lab_A1-A2",0,1024],["Lab_A1-B2",1024,1024],["Lab_A1-C2",2048,1024],["Lab_A1-D2",3072,1024],["Lab_A1-A3",0,2048],["Lab_A1-B3",1024,2048],["Lab_A1-C3",2048,2048],["Lab_A1-D3",3072,2048],["Lab_A1-A4",0,3072],["Lab_A1-B4",1024,3072],["Lab_A1-C4",2048,3072],["Lab_A1-D4",3072,3072],["Lab_A1-A5",0,4096],["Lab_A1-B5",1024,4096],["Lab_A1-C5",2048,4096],["Lab_A1-D5",3072,4096],["Lab_A1-A6",0,5120],["Lab_A1-B6",1024,5120],["Lab_A1-C6",2048,5120],["Lab_A1-D6",3072,5120],["Lab_A1-A7",0,6144],["Lab_A1-B7",1024,6144],["Lab_A1-C7",2048,6144],["Lab_A1-D7",3072,6144]]},Lab_A2:{hx:[["Lab_A2-A1",0,0],["Lab_A2-A2",0,4096]],"1x":[["Lab_A2-A1",0,0],["Lab_A2-B1",2048,0],["Lab_A2-A2",0,2048],["Lab_A2-B2",2048,2048],["Lab_A2-A3",0,4096],["Lab_A2-B3",2048,4096],["Lab_A2-A4",0,6144],["Lab_A2-B4",2048,6144]],"2x":[["Lab_A2-A1",0,0],["Lab_A2-B1",1024,0],["Lab_A2-C1",2048,0],["Lab_A2-D1",3072,0],["Lab_A2-A2",0,1024],["Lab_A2-B2",1024,1024],["Lab_A2-C2",2048,1024],["Lab_A2-D2",3072,1024],["Lab_A2-A3",0,2048],["Lab_A2-B3",1024,2048],["Lab_A2-C3",2048,2048],["Lab_A2-D3",3072,2048],["Lab_A2-A4",0,3072],["Lab_A2-B4",1024,3072],["Lab_A2-C4",2048,3072],["Lab_A2-D4",3072,3072],["Lab_A2-A5",0,4096],["Lab_A2-B5",1024,4096],["Lab_A2-C5",2048,4096],["Lab_A2-D5",3072,4096],["Lab_A2-A6",0,5120],["Lab_A2-B6",1024,5120],["Lab_A2-C6",2048,5120],["Lab_A2-D6",3072,5120],["Lab_A2-A7",0,6144],["Lab_A2-B7",1024,6144],["Lab_A2-C7",2048,6144],["Lab_A2-D7",3072,6144],["Lab_A2-A8",0,7168],["Lab_A2-B8",1024,7168],["Lab_A2-C8",2048,7168],["Lab_A2-D8",3072,7168]],"4x":[["Lab_A2-A1",0,0],["Lab_A2-B1",1024,0],["Lab_A2-C1",2048,0],["Lab_A2-D1",3072,0],["Lab_A2-A2",0,1024],["Lab_A2-B2",1024,1024],["Lab_A2-C2",2048,1024],["Lab_A2-D2",3072,1024],["Lab_A2-A3",0,2048],["Lab_A2-B3",1024,2048],["Lab_A2-C3",2048,2048],["Lab_A2-D3",3072,2048],["Lab_A2-A4",0,3072],["Lab_A2-B4",1024,3072],["Lab_A2-C4",2048,3072],["Lab_A2-D4",3072,3072],["Lab_A2-A5",0,4096],["Lab_A2-B5",1024,4096],["Lab_A2-C5",2048,4096],["Lab_A2-D5",3072,4096],["Lab_A2-A6",0,5120],["Lab_A2-B6",1024,5120],["Lab_A2-C6",2048,5120],["Lab_A2-D6",3072,5120],["Lab_A2-A7",0,6144],["Lab_A2-B7",1024,6144],["Lab_A2-C7",2048,6144],["Lab_A2-D7",3072,6144],["Lab_A2-A8",0,7168],["Lab_A2-B8",1024,7168],["Lab_A2-C8",2048,7168],["Lab_A2-D8",3072,7168]]},Lab_B1:{hx:[["Lab_B1-A1",0,0],["Lab_B1-A2",0,4096]],"1x":[["Lab_B1-A1",0,0],["Lab_B1-B1",2048,0],["Lab_B1-A2",0,2048],["Lab_B1-B2",2048,2048],["Lab_B1-A3",0,4096],["Lab_B1-B3",2048,4096]],"2x":[["Lab_B1-A1",0,0],["Lab_B1-B1",1024,0],["Lab_B1-C1",2048,0],["Lab_B1-D1",3072,0],["Lab_B1-A2",0,1024],["Lab_B1-B2",1024,1024],["Lab_B1-C2",2048,1024],["Lab_B1-D2",3072,1024],["Lab_B1-A3",0,2048],["Lab_B1-B3",1024,2048],["Lab_B1-C3",2048,2048],["Lab_B1-D3",3072,2048],["Lab_B1-A4",0,3072],["Lab_B1-B4",1024,3072],["Lab_B1-C4",2048,3072],["Lab_B1-D4",3072,3072],["Lab_B1-A5",0,4096],["Lab_B1-B5",1024,4096],["Lab_B1-C5",2048,4096],["Lab_B1-D5",3072,4096],["Lab_B1-A6",0,5120],["Lab_B1-B6",1024,5120],["Lab_B1-C6",2048,5120],["Lab_B1-D6",3072,5120]],"4x":[["Lab_B1-A1",0,0],["Lab_B1-B1",1024,0],["Lab_B1-C1",2048,0],["Lab_B1-D1",3072,0],["Lab_B1-A2",0,1024],["Lab_B1-B2",1024,1024],["Lab_B1-C2",2048,1024],["Lab_B1-D2",3072,1024],["Lab_B1-A3",0,2048],["Lab_B1-B3",1024,2048],["Lab_B1-C3",2048,2048],["Lab_B1-D3",3072,2048],["Lab_B1-A4",0,3072],["Lab_B1-B4",1024,3072],["Lab_B1-C4",2048,3072],["Lab_B1-D4",3072,3072],["Lab_B1-A5",0,4096],["Lab_B1-B5",1024,4096],["Lab_B1-C5",2048,4096],["Lab_B1-D5",3072,4096],["Lab_B1-A6",0,5120],["Lab_B1-B6",1024,5120],["Lab_B1-C6",2048,5120],["Lab_B1-D6",3072,5120]]},Lab_C1:{hx:[["Lab_C1-A1",0,0],["Lab_C1-A2",0,4096]],"1x":[["Lab_C1-A1",0,0],["Lab_C1-B1",2048,0],["Lab_C1-A2",0,2048],["Lab_C1-B2",2048,2048],["Lab_C1-A3",0,4096],["Lab_C1-B3",2048,4096]],"2x":[["Lab_C1-A1",0,0],["Lab_C1-B1",1024,0],["Lab_C1-C1",2048,0],["Lab_C1-D1",3072,0],["Lab_C1-A2",0,1024],["Lab_C1-B2",1024,1024],["Lab_C1-C2",2048,1024],["Lab_C1-D2",3072,1024],["Lab_C1-A3",0,2048],["Lab_C1-B3",1024,2048],["Lab_C1-C3",2048,2048],["Lab_C1-D3",3072,2048],["Lab_C1-A4",0,3072],["Lab_C1-B4",1024,3072],["Lab_C1-C4",2048,3072],["Lab_C1-D4",3072,3072],["Lab_C1-A5",0,4096],["Lab_C1-B5",1024,4096],["Lab_C1-C5",2048,4096],["Lab_C1-D5",3072,4096],["Lab_C1-A6",0,5120],["Lab_C1-B6",1024,5120],["Lab_C1-C6",2048,5120],["Lab_C1-D6",3072,5120]],"4x":[["Lab_C1-A1",0,0],["Lab_C1-B1",1024,0],["Lab_C1-C1",2048,0],["Lab_C1-D1",3072,0],["Lab_C1-A2",0,1024],["Lab_C1-B2",1024,1024],["Lab_C1-C2",2048,1024],["Lab_C1-D2",3072,1024],["Lab_C1-A3",0,2048],["Lab_C1-B3",1024,2048],["Lab_C1-C3",2048,2048],["Lab_C1-D3",3072,2048],["Lab_C1-A4",0,3072],["Lab_C1-B4",1024,3072],["Lab_C1-C4",2048,3072],["Lab_C1-D4",3072,3072],["Lab_C1-A5",0,4096],["Lab_C1-B5",1024,4096],["Lab_C1-C5",2048,4096],["Lab_C1-D5",3072,4096],["Lab_C1-A6",0,5120],["Lab_C1-B6",1024,5120],["Lab_C1-C6",2048,5120],["Lab_C1-D6",3072,5120]]},Lab_Front:{hx:[["Lab_Front-A1",0,0],["Lab_Front-A2",0,4096],["Lab_Front-A3",0,8192],["Lab_Front-A4",0,12288],["Lab_Front-A5",0,16384]],"1x":[["Lab_Front-A1",0,0],["Lab_Front-B1",2048,0],["Lab_Front-A2",0,2048],["Lab_Front-B2",2048,2048],["Lab_Front-A3",0,4096],["Lab_Front-B3",2048,4096],["Lab_Front-A4",0,6144],["Lab_Front-B4",2048,6144],["Lab_Front-A5",0,8192],["Lab_Front-B5",2048,8192],["Lab_Front-A6",0,10240],["Lab_Front-B6",2048,10240],["Lab_Front-A7",0,12288],["Lab_Front-B7",2048,12288],["Lab_Front-A8",0,14336],["Lab_Front-B8",2048,14336],["Lab_Front-A9",0,16384],["Lab_Front-B9",2048,16384],["Lab_Front-A10",0,18432],["Lab_Front-B10",2048,18432]],"2x":[["Lab_Front-A1",0,0],["Lab_Front-B1",1024,0],["Lab_Front-C1",2048,0],["Lab_Front-D1",3072,0],["Lab_Front-A2",0,1024],["Lab_Front-B2",1024,1024],["Lab_Front-C2",2048,1024],["Lab_Front-D2",3072,1024],["Lab_Front-A3",0,2048],["Lab_Front-B3",1024,2048],["Lab_Front-C3",2048,2048],["Lab_Front-D3",3072,2048],["Lab_Front-A4",0,3072],["Lab_Front-B4",1024,3072],["Lab_Front-C4",2048,3072],["Lab_Front-D4",3072,3072],["Lab_Front-A5",0,4096],["Lab_Front-B5",1024,4096],["Lab_Front-C5",2048,4096],["Lab_Front-D5",3072,4096],["Lab_Front-A6",0,5120],["Lab_Front-B6",1024,5120],["Lab_Front-C6",2048,5120],["Lab_Front-D6",3072,5120],["Lab_Front-A7",0,6144],["Lab_Front-D7",3072,6144],["Lab_Front-A8",0,7168],["Lab_Front-B8",1024,7168],["Lab_Front-C8",2048,7168],["Lab_Front-D8",3072,7168],["Lab_Front-A9",0,8192],["Lab_Front-B9",1024,8192],["Lab_Front-C9",2048,8192],["Lab_Front-D9",3072,8192],["Lab_Front-A10",0,9216],["Lab_Front-B10",1024,9216],["Lab_Front-D10",3072,9216],["Lab_Front-A11",0,10240],["Lab_Front-B11",1024,10240],["Lab_Front-C11",2048,10240],["Lab_Front-D11",3072,10240],["Lab_Front-A12",0,11264],["Lab_Front-B12",1024,11264],["Lab_Front-C12",2048,11264],["Lab_Front-D12",3072,11264],["Lab_Front-A13",0,12288],["Lab_Front-B13",1024,12288],["Lab_Front-C13",2048,12288],["Lab_Front-D13",3072,12288],["Lab_Front-A14",0,13312],["Lab_Front-B14",1024,13312],["Lab_Front-C14",2048,13312],["Lab_Front-D14",3072,13312],["Lab_Front-A15",0,14336],["Lab_Front-B15",1024,14336],["Lab_Front-C15",2048,14336],["Lab_Front-D15",3072,14336],["Lab_Front-A16",0,15360],["Lab_Front-B16",1024,15360],["Lab_Front-C16",2048,15360],["Lab_Front-D16",3072,15360],["Lab_Front-A17",0,16384],["Lab_Front-B17",1024,16384],["Lab_Front-C17",2048,16384],["Lab_Front-D17",3072,16384],["Lab_Front-A18",0,17408],["Lab_Front-B18",1024,17408],["Lab_Front-C18",2048,17408],["Lab_Front-D18",3072,17408],["Lab_Front-A19",0,18432],["Lab_Front-B19",1024,18432],["Lab_Front-C19",2048,18432],["Lab_Front-D19",3072,18432],["Lab_Front-A20",0,19456],["Lab_Front-B20",1024,19456],["Lab_Front-C20",2048,19456],["Lab_Front-D20",3072,19456]],"4x":[["Lab_Front-A1",0,0],["Lab_Front-B1",1024,0],["Lab_Front-C1",2048,0],["Lab_Front-D1",3072,0],["Lab_Front-A2",0,1024],["Lab_Front-B2",1024,1024],["Lab_Front-C2",2048,1024],["Lab_Front-D2",3072,1024],["Lab_Front-A3",0,2048],["Lab_Front-B3",1024,2048],["Lab_Front-C3",2048,2048],["Lab_Front-D3",3072,2048],["Lab_Front-A4",0,3072],["Lab_Front-B4",1024,3072],["Lab_Front-C4",2048,3072],["Lab_Front-D4",3072,3072],["Lab_Front-A5",0,4096],["Lab_Front-B5",1024,4096],["Lab_Front-C5",2048,4096],["Lab_Front-D5",3072,4096],["Lab_Front-A6",0,5120],["Lab_Front-B6",1024,5120],["Lab_Front-C6",2048,5120],["Lab_Front-D6",3072,5120],["Lab_Front-A7",0,6144],["Lab_Front-D7",3072,6144],["Lab_Front-A8",0,7168],["Lab_Front-B8",1024,7168],["Lab_Front-C8",2048,7168],["Lab_Front-D8",3072,7168],["Lab_Front-A9",0,8192],["Lab_Front-B9",1024,8192],["Lab_Front-C9",2048,8192],["Lab_Front-D9",3072,8192],["Lab_Front-A10",0,9216],["Lab_Front-B10",1024,9216],["Lab_Front-D10",3072,9216],["Lab_Front-A11",0,10240],["Lab_Front-B11",1024,10240],["Lab_Front-C11",2048,10240],["Lab_Front-D11",3072,10240],["Lab_Front-A12",0,11264],["Lab_Front-B12",1024,11264],["Lab_Front-C12",2048,11264],["Lab_Front-D12",3072,11264],["Lab_Front-A13",0,12288],["Lab_Front-B13",1024,12288],["Lab_Front-C13",2048,12288],["Lab_Front-D13",3072,12288],["Lab_Front-A14",0,13312],["Lab_Front-B14",1024,13312],["Lab_Front-C14",2048,13312],["Lab_Front-D14",3072,13312],["Lab_Front-A15",0,14336],["Lab_Front-B15",1024,14336],["Lab_Front-C15",2048,14336],["Lab_Front-D15",3072,14336],["Lab_Front-A16",0,15360],["Lab_Front-B16",1024,15360],["Lab_Front-C16",2048,15360],["Lab_Front-D16",3072,15360],["Lab_Front-A17",0,16384],["Lab_Front-B17",1024,16384],["Lab_Front-C17",2048,16384],["Lab_Front-D17",3072,16384],["Lab_Front-A18",0,17408],["Lab_Front-B18",1024,17408],["Lab_Front-C18",2048,17408],["Lab_Front-D18",3072,17408],["Lab_Front-A19",0,18432],["Lab_Front-B19",1024,18432],["Lab_Front-C19",2048,18432],["Lab_Front-D19",3072,18432],["Lab_Front-A20",0,19456],["Lab_Front-B20",1024,19456],["Lab_Front-C20",2048,19456],["Lab_Front-D20",3072,19456]]},Museum_A1:{hx:[["Museum_A1-A1",0,0],["Museum_A1-A2",0,4096]],"1x":[["Museum_A1-A1",0,0],["Museum_A1-B1",2048,0],["Museum_A1-A2",0,2048],["Museum_A1-B2",2048,2048],["Museum_A1-A3",0,4096],["Museum_A1-B3",2048,4096]],"2x":[["Museum_A1-A1",0,0],["Museum_A1-B1",1024,0],["Museum_A1-C1",2048,0],["Museum_A1-D1",3072,0],["Museum_A1-A2",0,1024],["Museum_A1-B2",1024,1024],["Museum_A1-C2",2048,1024],["Museum_A1-D2",3072,1024],["Museum_A1-A3",0,2048],["Museum_A1-B3",1024,2048],["Museum_A1-C3",2048,2048],["Museum_A1-D3",3072,2048],["Museum_A1-A4",0,3072],["Museum_A1-B4",1024,3072],["Museum_A1-C4",2048,3072],["Museum_A1-D4",3072,3072],["Museum_A1-A5",0,4096],["Museum_A1-B5",1024,4096],["Museum_A1-C5",2048,4096],["Museum_A1-D5",3072,4096]],"4x":[["Museum_A1-A1",0,0],["Museum_A1-B1",1024,0],["Museum_A1-C1",2048,0],["Museum_A1-D1",3072,0],["Museum_A1-A2",0,1024],["Museum_A1-B2",1024,1024],["Museum_A1-C2",2048,1024],["Museum_A1-D2",3072,1024],["Museum_A1-A3",0,2048],["Museum_A1-B3",1024,2048],["Museum_A1-C3",2048,2048],["Museum_A1-D3",3072,2048],["Museum_A1-A4",0,3072],["Museum_A1-B4",1024,3072],["Museum_A1-C4",2048,3072],["Museum_A1-D4",3072,3072],["Museum_A1-A5",0,4096],["Museum_A1-B5",1024,4096],["Museum_A1-C5",2048,4096],["Museum_A1-D5",3072,4096]]},Museum_B1:{hx:[["Museum_B1-A1",0,0],["Museum_B1-A2",0,4096]],"1x":[["Museum_B1-A1",0,0],["Museum_B1-B1",2048,0],["Museum_B1-A2",0,2048],["Museum_B1-B2",2048,2048],["Museum_B1-A3",0,4096],["Museum_B1-B3",2048,4096]],"2x":[["Museum_B1-A1",0,0],["Museum_B1-B1",1024,0],["Museum_B1-C1",2048,0],["Museum_B1-D1",3072,0],["Museum_B1-A2",0,1024],["Museum_B1-B2",1024,1024],["Museum_B1-C2",2048,1024],["Museum_B1-D2",3072,1024],["Museum_B1-A3",0,2048],["Museum_B1-B3",1024,2048],["Museum_B1-C3",2048,2048],["Museum_B1-D3",3072,2048],["Museum_B1-A4",0,3072],["Museum_B1-B4",1024,3072],["Museum_B1-C4",2048,3072],["Museum_B1-D4",3072,3072],["Museum_B1-A5",0,4096],["Museum_B1-B5",1024,4096],["Museum_B1-C5",2048,4096],["Museum_B1-D5",3072,4096]],"4x":[["Museum_B1-A1",0,0],["Museum_B1-B1",1024,0],["Museum_B1-C1",2048,0],["Museum_B1-D1",3072,0],["Museum_B1-A2",0,1024],["Museum_B1-B2",1024,1024],["Museum_B1-C2",2048,1024],["Museum_B1-D2",3072,1024],["Museum_B1-A3",0,2048],["Museum_B1-B3",1024,2048],["Museum_B1-C3",2048,2048],["Museum_B1-D3",3072,2048],["Museum_B1-A4",0,3072],["Museum_B1-B4",1024,3072],["Museum_B1-C4",2048,3072],["Museum_B1-D4",3072,3072],["Museum_B1-A5",0,4096],["Museum_B1-B5",1024,4096],["Museum_B1-C5",2048,4096],["Museum_B1-D5",3072,4096]]},Museum_C1:{hx:[["Museum_C1-A1",0,0],["Museum_C1-A2",0,4096]],"1x":[["Museum_C1-A1",0,0],["Museum_C1-B1",2048,0],["Museum_C1-A2",0,2048],["Museum_C1-B2",2048,2048],["Museum_C1-A3",0,4096],["Museum_C1-B3",2048,4096]],"2x":[["Museum_C1-A1",0,0],["Museum_C1-B1",1024,0],["Museum_C1-C1",2048,0],["Museum_C1-D1",3072,0],["Museum_C1-A2",0,1024],["Museum_C1-B2",1024,1024],["Museum_C1-C2",2048,1024],["Museum_C1-D2",3072,1024],["Museum_C1-A3",0,2048],["Museum_C1-B3",1024,2048],["Museum_C1-C3",2048,2048],["Museum_C1-D3",3072,2048],["Museum_C1-A4",0,3072],["Museum_C1-B4",1024,3072],["Museum_C1-C4",2048,3072],["Museum_C1-D4",3072,3072],["Museum_C1-A5",0,4096],["Museum_C1-B5",1024,4096],["Museum_C1-C5",2048,4096],["Museum_C1-D5",3072,4096],["Museum_C1-A6",0,5120],["Museum_C1-B6",1024,5120],["Museum_C1-C6",2048,5120],["Museum_C1-D6",3072,5120]],"4x":[["Museum_C1-A1",0,0],["Museum_C1-B1",1024,0],["Museum_C1-C1",2048,0],["Museum_C1-D1",3072,0],["Museum_C1-A2",0,1024],["Museum_C1-B2",1024,1024],["Museum_C1-C2",2048,1024],["Museum_C1-D2",3072,1024],["Museum_C1-A3",0,2048],["Museum_C1-B3",1024,2048],["Museum_C1-C3",2048,2048],["Museum_C1-D3",3072,2048],["Museum_C1-A4",0,3072],["Museum_C1-B4",1024,3072],["Museum_C1-C4",2048,3072],["Museum_C1-D4",3072,3072],["Museum_C1-A5",0,4096],["Museum_C1-B5",1024,4096],["Museum_C1-C5",2048,4096],["Museum_C1-D5",3072,4096],["Museum_C1-A6",0,5120],["Museum_C1-B6",1024,5120],["Museum_C1-C6",2048,5120],["Museum_C1-D6",3072,5120]]},Museum_C2:{hx:[["Museum_C2-A1",0,0],["Museum_C2-A2",0,4096]],"1x":[["Museum_C2-A1",0,0],["Museum_C2-B1",2048,0],["Museum_C2-A2",0,2048],["Museum_C2-B2",2048,2048],["Museum_C2-A3",0,4096],["Museum_C2-B3",2048,4096]],"2x":[["Museum_C2-A1",0,0],["Museum_C2-B1",1024,0],["Museum_C2-C1",2048,0],["Museum_C2-D1",3072,0],["Museum_C2-A2",0,1024],["Museum_C2-B2",1024,1024],["Museum_C2-C2",2048,1024],["Museum_C2-D2",3072,1024],["Museum_C2-A3",0,2048],["Museum_C2-B3",1024,2048],["Museum_C2-C3",2048,2048],["Museum_C2-D3",3072,2048],["Museum_C2-A4",0,3072],["Museum_C2-B4",1024,3072],["Museum_C2-C4",2048,3072],["Museum_C2-D4",3072,3072],["Museum_C2-A5",0,4096],["Museum_C2-B5",1024,4096],["Museum_C2-C5",2048,4096],["Museum_C2-D5",3072,4096],["Museum_C2-A6",0,5120],["Museum_C2-B6",1024,5120],["Museum_C2-C6",2048,5120],["Museum_C2-D6",3072,5120]],"4x":[["Museum_C2-A1",0,0],["Museum_C2-B1",1024,0],["Museum_C2-C1",2048,0],["Museum_C2-D1",3072,0],["Museum_C2-A2",0,1024],["Museum_C2-B2",1024,1024],["Museum_C2-C2",2048,1024],["Museum_C2-D2",3072,1024],["Museum_C2-A3",0,2048],["Museum_C2-B3",1024,2048],["Museum_C2-C3",2048,2048],["Museum_C2-D3",3072,2048],["Museum_C2-A4",0,3072],["Museum_C2-B4",1024,3072],["Museum_C2-C4",2048,3072],["Museum_C2-D4",3072,3072],["Museum_C2-A5",0,4096],["Museum_C2-B5",1024,4096],["Museum_C2-C5",2048,4096],["Museum_C2-D5",3072,4096],["Museum_C2-A6",0,5120],["Museum_C2-B6",1024,5120],["Museum_C2-C6",2048,5120],["Museum_C2-D6",3072,5120]]},Museum_Front:{hx:[["Museum_Front-A1",0,0],["Museum_Front-A2",0,4096],["Museum_Front-A3",0,8192],["Museum_Front-A4",0,12288]],"1x":[["Museum_Front-A1",0,0],["Museum_Front-B1",2048,0],["Museum_Front-A2",0,2048],["Museum_Front-B2",2048,2048],["Museum_Front-A3",0,4096],["Museum_Front-B3",2048,4096],["Museum_Front-A4",0,6144],["Museum_Front-B4",2048,6144],["Museum_Front-A5",0,8192],["Museum_Front-B5",2048,8192],["Museum_Front-A6",0,10240],["Museum_Front-B6",2048,10240],["Museum_Front-A7",0,12288],["Museum_Front-B7",2048,12288],["Museum_Front-A8",0,14336],["Museum_Front-B8",2048,14336]],"2x":[["Museum_Front-A1",0,0],["Museum_Front-B1",1024,0],["Museum_Front-C1",2048,0],["Museum_Front-D1",3072,0],["Museum_Front-A2",0,1024],["Museum_Front-B2",1024,1024],["Museum_Front-C2",2048,1024],["Museum_Front-D2",3072,1024],["Museum_Front-A3",0,2048],["Museum_Front-B3",1024,2048],["Museum_Front-C3",2048,2048],["Museum_Front-D3",3072,2048],["Museum_Front-A4",0,3072],["Museum_Front-B4",1024,3072],["Museum_Front-C4",2048,3072],["Museum_Front-D4",3072,3072],["Museum_Front-A5",0,4096],["Museum_Front-B5",1024,4096],["Museum_Front-C5",2048,4096],["Museum_Front-D5",3072,4096],["Museum_Front-A6",0,5120],["Museum_Front-B6",1024,5120],["Museum_Front-C6",2048,5120],["Museum_Front-D6",3072,5120],["Museum_Front-A7",0,6144],["Museum_Front-B7",1024,6144],["Museum_Front-C7",2048,6144],["Museum_Front-D7",3072,6144],["Museum_Front-A8",0,7168],["Museum_Front-B8",1024,7168],["Museum_Front-C8",2048,7168],["Museum_Front-D8",3072,7168],["Museum_Front-A9",0,8192],["Museum_Front-B9",1024,8192],["Museum_Front-C9",2048,8192],["Museum_Front-D9",3072,8192],["Museum_Front-A10",0,9216],["Museum_Front-B10",1024,9216],["Museum_Front-C10",2048,9216],["Museum_Front-D10",3072,9216],["Museum_Front-A11",0,10240],["Museum_Front-B11",1024,10240],["Museum_Front-C11",2048,10240],["Museum_Front-D11",3072,10240],["Museum_Front-A12",0,11264],["Museum_Front-B12",1024,11264],["Museum_Front-C12",2048,11264],["Museum_Front-D12",3072,11264],["Museum_Front-A13",0,12288],["Museum_Front-B13",1024,12288],["Museum_Front-C13",2048,12288],["Museum_Front-D13",3072,12288],["Museum_Front-A14",0,13312],["Museum_Front-B14",1024,13312],["Museum_Front-D14",3072,13312],["Museum_Front-A15",0,14336],["Museum_Front-B15",1024,14336],["Museum_Front-C15",2048,14336],["Museum_Front-D15",3072,14336],["Museum_Front-A16",0,15360],["Museum_Front-B16",1024,15360],["Museum_Front-C16",2048,15360],["Museum_Front-D16",3072,15360]],"4x":[["Museum_Front-A1",0,0],["Museum_Front-B1",1024,0],["Museum_Front-C1",2048,0],["Museum_Front-D1",3072,0],["Museum_Front-A2",0,1024],["Museum_Front-B2",1024,1024],["Museum_Front-C2",2048,1024],["Museum_Front-D2",3072,1024],["Museum_Front-A3",0,2048],["Museum_Front-B3",1024,2048],["Museum_Front-C3",2048,2048],["Museum_Front-D3",3072,2048],["Museum_Front-A4",0,3072],["Museum_Front-B4",1024,3072],["Museum_Front-C4",2048,3072],["Museum_Front-D4",3072,3072],["Museum_Front-A5",0,4096],["Museum_Front-B5",1024,4096],["Museum_Front-C5",2048,4096],["Museum_Front-D5",3072,4096],["Museum_Front-A6",0,5120],["Museum_Front-B6",1024,5120],["Museum_Front-C6",2048,5120],["Museum_Front-D6",3072,5120],["Museum_Front-A7",0,6144],["Museum_Front-B7",1024,6144],["Museum_Front-C7",2048,6144],["Museum_Front-D7",3072,6144],["Museum_Front-A8",0,7168],["Museum_Front-B8",1024,7168],["Museum_Front-C8",2048,7168],["Museum_Front-D8",3072,7168],["Museum_Front-A9",0,8192],["Museum_Front-B9",1024,8192],["Museum_Front-C9",2048,8192],["Museum_Front-D9",3072,8192],["Museum_Front-A10",0,9216],["Museum_Front-B10",1024,9216],["Museum_Front-C10",2048,9216],["Museum_Front-D10",3072,9216],["Museum_Front-A11",0,10240],["Museum_Front-B11",1024,10240],["Museum_Front-C11",2048,10240],["Museum_Front-D11",3072,10240],["Museum_Front-A12",0,11264],["Museum_Front-B12",1024,11264],["Museum_Front-C12",2048,11264],["Museum_Front-D12",3072,11264],["Museum_Front-A13",0,12288],["Museum_Front-B13",1024,12288],["Museum_Front-C13",2048,12288],["Museum_Front-D13",3072,12288],["Museum_Front-A14",0,13312],["Museum_Front-B14",1024,13312],["Museum_Front-D14",3072,13312],["Museum_Front-A15",0,14336],["Museum_Front-B15",1024,14336],["Museum_Front-C15",2048,14336],["Museum_Front-D15",3072,14336],["Museum_Front-A16",0,15360],["Museum_Front-B16",1024,15360],["Museum_Front-C16",2048,15360],["Museum_Front-D16",3072,15360]]},Office_A1:{hx:[["Office_A1-A1",0,0],["Office_A1-A2",0,4096]],"1x":[["Office_A1-A1",0,0],["Office_A1-B1",2048,0],["Office_A1-A2",0,2048],["Office_A1-B2",2048,2048],["Office_A1-A3",0,4096],["Office_A1-B3",2048,4096],["Office_A1-A4",0,6144],["Office_A1-B4",2048,6144]],"2x":[["Office_A1-A1",0,0],["Office_A1-B1",1024,0],["Office_A1-C1",2048,0],["Office_A1-D1",3072,0],["Office_A1-A2",0,1024],["Office_A1-B2",1024,1024],["Office_A1-C2",2048,1024],["Office_A1-D2",3072,1024],["Office_A1-A3",0,2048],["Office_A1-B3",1024,2048],["Office_A1-C3",2048,2048],["Office_A1-D3",3072,2048],["Office_A1-A4",0,3072],["Office_A1-B4",1024,3072],["Office_A1-C4",2048,3072],["Office_A1-D4",3072,3072],["Office_A1-A5",0,4096],["Office_A1-B5",1024,4096],["Office_A1-C5",2048,4096],["Office_A1-D5",3072,4096],["Office_A1-A6",0,5120],["Office_A1-B6",1024,5120],["Office_A1-C6",2048,5120],["Office_A1-D6",3072,5120],["Office_A1-A7",0,6144],["Office_A1-B7",1024,6144],["Office_A1-C7",2048,6144],["Office_A1-D7",3072,6144]],"4x":[["Office_A1-A1",0,0],["Office_A1-B1",1024,0],["Office_A1-C1",2048,0],["Office_A1-D1",3072,0],["Office_A1-A2",0,1024],["Office_A1-B2",1024,1024],["Office_A1-C2",2048,1024],["Office_A1-D2",3072,1024],["Office_A1-A3",0,2048],["Office_A1-B3",1024,2048],["Office_A1-C3",2048,2048],["Office_A1-D3",3072,2048],["Office_A1-A4",0,3072],["Office_A1-B4",1024,3072],["Office_A1-C4",2048,3072],["Office_A1-D4",3072,3072],["Office_A1-A5",0,4096],["Office_A1-B5",1024,4096],["Office_A1-C5",2048,4096],["Office_A1-D5",3072,4096],["Office_A1-A6",0,5120],["Office_A1-B6",1024,5120],["Office_A1-C6",2048,5120],["Office_A1-D6",3072,5120],["Office_A1-A7",0,6144],["Office_A1-B7",1024,6144],["Office_A1-C7",2048,6144],["Office_A1-D7",3072,6144]]},Office_B1:{hx:[["Office_B1-A1",0,0]],"1x":[["Office_B1-A1",0,0],["Office_B1-B1",2048,0],["Office_B1-A2",0,2048],["Office_B1-B2",2048,2048]],"2x":[["Office_B1-A1",0,0],["Office_B1-B1",1024,0],["Office_B1-C1",2048,0],["Office_B1-D1",3072,0],["Office_B1-A2",0,1024],["Office_B1-B2",1024,1024],["Office_B1-C2",2048,1024],["Office_B1-D2",3072,1024],["Office_B1-A3",0,2048],["Office_B1-B3",1024,2048],["Office_B1-C3",2048,2048],["Office_B1-D3",3072,2048],["Office_B1-A4",0,3072],["Office_B1-B4",1024,3072],["Office_B1-C4",2048,3072],["Office_B1-D4",3072,3072]],"4x":[["Office_B1-A1",0,0],["Office_B1-B1",1024,0],["Office_B1-C1",2048,0],["Office_B1-D1",3072,0],["Office_B1-A2",0,1024],["Office_B1-B2",1024,1024],["Office_B1-C2",2048,1024],["Office_B1-D2",3072,1024],["Office_B1-A3",0,2048],["Office_B1-B3",1024,2048],["Office_B1-C3",2048,2048],["Office_B1-D3",3072,2048],["Office_B1-A4",0,3072],["Office_B1-B4",1024,3072],["Office_B1-C4",2048,3072],["Office_B1-D4",3072,3072]]},Office_B2:{hx:[["Office_B2-A1",0,0]],"1x":[["Office_B2-A1",0,0],["Office_B2-B1",2048,0],["Office_B2-A2",0,2048],["Office_B2-B2",2048,2048]],"2x":[["Office_B2-A1",0,0],["Office_B2-B1",1024,0],["Office_B2-C1",2048,0],["Office_B2-D1",3072,0],["Office_B2-A2",0,1024],["Office_B2-B2",1024,1024],["Office_B2-C2",2048,1024],["Office_B2-D2",3072,1024],["Office_B2-A3",0,2048],["Office_B2-B3",1024,2048],["Office_B2-C3",2048,2048],["Office_B2-D3",3072,2048],["Office_B2-A4",0,3072],["Office_B2-B4",1024,3072],["Office_B2-C4",2048,3072],["Office_B2-D4",3072,3072]],"4x":[["Office_B2-A1",0,0],["Office_B2-B1",1024,0],["Office_B2-C1",2048,0],["Office_B2-D1",3072,0],["Office_B2-A2",0,1024],["Office_B2-B2",1024,1024],["Office_B2-C2",2048,1024],["Office_B2-D2",3072,1024],["Office_B2-A3",0,2048],["Office_B2-B3",1024,2048],["Office_B2-C3",2048,2048],["Office_B2-D3",3072,2048],["Office_B2-A4",0,3072],["Office_B2-B4",1024,3072],["Office_B2-C4",2048,3072],["Office_B2-D4",3072,3072]]},Office_Front:{hx:[["Office_Front-A1",0,0],["Office_Front-A2",0,4096],["Office_Front-A3",0,8192],["Office_Front-A4",0,12288]],"1x":[["Office_Front-A1",0,0],["Office_Front-B1",2048,0],["Office_Front-A2",0,2048],["Office_Front-B2",2048,2048],["Office_Front-A3",0,4096],["Office_Front-B3",2048,4096],["Office_Front-A4",0,6144],["Office_Front-B4",2048,6144],["Office_Front-A5",0,8192],["Office_Front-B5",2048,8192],["Office_Front-A6",0,10240],["Office_Front-B6",2048,10240],["Office_Front-A7",0,12288],["Office_Front-B7",2048,12288],["Office_Front-A8",0,14336],["Office_Front-B8",2048,14336]],"2x":[["Office_Front-A1",0,0],["Office_Front-B1",1024,0],["Office_Front-C1",2048,0],["Office_Front-D1",3072,0],["Office_Front-A2",0,1024],["Office_Front-B2",1024,1024],["Office_Front-C2",2048,1024],["Office_Front-D2",3072,1024],["Office_Front-A3",0,2048],["Office_Front-B3",1024,2048],["Office_Front-C3",2048,2048],["Office_Front-D3",3072,2048],["Office_Front-A4",0,3072],["Office_Front-B4",1024,3072],["Office_Front-C4",2048,3072],["Office_Front-D4",3072,3072],["Office_Front-A5",0,4096],["Office_Front-B5",1024,4096],["Office_Front-C5",2048,4096],["Office_Front-D5",3072,4096],["Office_Front-A6",0,5120],["Office_Front-B6",1024,5120],["Office_Front-C6",2048,5120],["Office_Front-D6",3072,5120],["Office_Front-A7",0,6144],["Office_Front-B7",1024,6144],["Office_Front-C7",2048,6144],["Office_Front-D7",3072,6144],["Office_Front-A8",0,7168],["Office_Front-B8",1024,7168],["Office_Front-C8",2048,7168],["Office_Front-D8",3072,7168],["Office_Front-A9",0,8192],["Office_Front-B9",1024,8192],["Office_Front-C9",2048,8192],["Office_Front-D9",3072,8192],["Office_Front-A11",0,10240],["Office_Front-B11",1024,10240],["Office_Front-C11",2048,10240],["Office_Front-D11",3072,10240],["Office_Front-A12",0,11264],["Office_Front-B12",1024,11264],["Office_Front-C12",2048,11264],["Office_Front-D12",3072,11264],["Office_Front-A13",0,12288],["Office_Front-B13",1024,12288],["Office_Front-C13",2048,12288],["Office_Front-D13",3072,12288],["Office_Front-A14",0,13312],["Office_Front-C14",2048,13312],["Office_Front-D14",3072,13312],["Office_Front-A15",0,14336],["Office_Front-B15",1024,14336],["Office_Front-C15",2048,14336],["Office_Front-D15",3072,14336],["Office_Front-A16",0,15360],["Office_Front-B16",1024,15360],["Office_Front-C16",2048,15360],["Office_Front-D16",3072,15360]],"4x":[["Office_Front-A1",0,0],["Office_Front-B1",1024,0],["Office_Front-C1",2048,0],["Office_Front-D1",3072,0],["Office_Front-A2",0,1024],["Office_Front-B2",1024,1024],["Office_Front-C2",2048,1024],["Office_Front-D2",3072,1024],["Office_Front-A3",0,2048],["Office_Front-B3",1024,2048],["Office_Front-C3",2048,2048],["Office_Front-D3",3072,2048],["Office_Front-A4",0,3072],["Office_Front-B4",1024,3072],["Office_Front-C4",2048,3072],["Office_Front-D4",3072,3072],["Office_Front-A5",0,4096],["Office_Front-B5",1024,4096],["Office_Front-C5",2048,4096],["Office_Front-D5",3072,4096],["Office_Front-A6",0,5120],["Office_Front-B6",1024,5120],["Office_Front-C6",2048,5120],["Office_Front-D6",3072,5120],["Office_Front-A7",0,6144],["Office_Front-B7",1024,6144],["Office_Front-C7",2048,6144],["Office_Front-D7",3072,6144],["Office_Front-A8",0,7168],["Office_Front-B8",1024,7168],["Office_Front-C8",2048,7168],["Office_Front-D8",3072,7168],["Office_Front-A9",0,8192],["Office_Front-B9",1024,8192],["Office_Front-C9",2048,8192],["Office_Front-D9",3072,8192],["Office_Front-A11",0,10240],["Office_Front-B11",1024,10240],["Office_Front-C11",2048,10240],["Office_Front-D11",3072,10240],["Office_Front-A12",0,11264],["Office_Front-B12",1024,11264],["Office_Front-C12",2048,11264],["Office_Front-D12",3072,11264],["Office_Front-A13",0,12288],["Office_Front-B13",1024,12288],["Office_Front-C13",2048,12288],["Office_Front-D13",3072,12288],["Office_Front-A14",0,13312],["Office_Front-C14",2048,13312],["Office_Front-D14",3072,13312],["Office_Front-A15",0,14336],["Office_Front-B15",1024,14336],["Office_Front-C15",2048,14336],["Office_Front-D15",3072,14336],["Office_Front-A16",0,15360],["Office_Front-B16",1024,15360],["Office_Front-C16",2048,15360],["Office_Front-D16",3072,15360]]},Platform_Back:{hx:[["Platform_Back-A1",0,0]],"1x":[["Platform_Back-A1",0,0],["Platform_Back-B1",2048,0],["Platform_Back-A2",0,2048],["Platform_Back-B2",2048,2048]],"2x":[["Platform_Back-A1",0,0],["Platform_Back-B1",1024,0],["Platform_Back-C1",2048,0],["Platform_Back-D1",3072,0],["Platform_Back-A2",0,1024],["Platform_Back-B2",1024,1024],["Platform_Back-C2",2048,1024],["Platform_Back-D2",3072,1024],["Platform_Back-A3",0,2048],["Platform_Back-B3",1024,2048],["Platform_Back-C3",2048,2048],["Platform_Back-D3",3072,2048],["Platform_Back-A4",0,3072],["Platform_Back-B4",1024,3072],["Platform_Back-C4",2048,3072],["Platform_Back-D4",3072,3072]],"4x":[["Platform_Back-A1",0,0],["Platform_Back-B1",1024,0],["Platform_Back-C1",2048,0],["Platform_Back-D1",3072,0],["Platform_Back-A2",0,1024],["Platform_Back-B2",1024,1024],["Platform_Back-C2",2048,1024],["Platform_Back-D2",3072,1024],["Platform_Back-A3",0,2048],["Platform_Back-B3",1024,2048],["Platform_Back-C3",2048,2048],["Platform_Back-D3",3072,2048],["Platform_Back-A4",0,3072],["Platform_Back-B4",1024,3072],["Platform_Back-C4",2048,3072],["Platform_Back-D4",3072,3072]]},Platform_Front:{hx:[["Platform_Front-A1",0,0]],"1x":[["Platform_Front-A1",0,0],["Platform_Front-B1",2048,0],["Platform_Front-A2",0,2048],["Platform_Front-B2",2048,2048]],"2x":[["Platform_Front-A1",0,0],["Platform_Front-B1",1024,0],["Platform_Front-C1",2048,0],["Platform_Front-D1",3072,0],["Platform_Front-A2",0,1024],["Platform_Front-B2",1024,1024],["Platform_Front-C2",2048,1024],["Platform_Front-D2",3072,1024],["Platform_Front-A3",0,2048],["Platform_Front-B3",1024,2048],["Platform_Front-C3",2048,2048],["Platform_Front-D3",3072,2048],["Platform_Front-A4",0,3072],["Platform_Front-B4",1024,3072],["Platform_Front-C4",2048,3072],["Platform_Front-D4",3072,3072]],"4x":[["Platform_Front-A1",0,0],["Platform_Front-B1",1024,0],["Platform_Front-C1",2048,0],["Platform_Front-D1",3072,0],["Platform_Front-A2",0,1024],["Platform_Front-B2",1024,1024],["Platform_Front-C2",2048,1024],["Platform_Front-D2",3072,1024],["Platform_Front-A3",0,2048],["Platform_Front-B3",1024,2048],["Platform_Front-C3",2048,2048],["Platform_Front-D3",3072,2048],["Platform_Front-A4",0,3072],["Platform_Front-B4",1024,3072],["Platform_Front-C4",2048,3072],["Platform_Front-D4",3072,3072]]}},Aa={hx:{"Arena_A1-A1":["/res/panelsoil/zenith/hx/Arena_A1-A1.png",4096,-1313.2069373975248],"Arena_A1-A2":["/res/panelsoil/zenith/hx/Arena_A1-A2.png",4096,-1244.3383617359025],"Arena_B1-A1":["/res/panelsoil/zenith/hx/Arena_B1-A1.png",4096,-1259.5355848354804],"Arena_B1-A2":["/res/panelsoil/zenith/hx/Arena_B1-A2.png",4096,-1176.5029670485667],"Arena_B2-A1":["/res/panelsoil/zenith/hx/Arena_B2-A1.png",4096,-1232.9006192971976],"Arena_B3-A1":["/res/panelsoil/zenith/hx/Arena_B3-A1.png",4096,-1230.5611731353556],"Arena_B3-A2":["/res/panelsoil/zenith/hx/Arena_B3-A2.png",4096,-1184.7267649808334],"Arena_C1-A1":["/res/panelsoil/zenith/hx/Arena_C1-A1.png",4096,-1165.40760936735],"Arena_Front-A1":["/res/panelsoil/zenith/hx/Arena_Front-A1.png",4096,-1283.4202581228044],"Arena_Front-A2":["/res/panelsoil/zenith/hx/Arena_Front-A2.png",4096,-1234.7845628889545],"Arena_Front-A3":["/res/panelsoil/zenith/hx/Arena_Front-A3.png",4096,-1191.9330675088322],"Casino_A1-A1":["/res/panelsoil/zenith/hx/Casino_A1-A1.png",4096,-1440.6540826544092],"Casino_A1-A2":["/res/panelsoil/zenith/hx/Casino_A1-A2.png",4096,-1413.4644146679684],"Casino_A1b-A1":["/res/panelsoil/zenith/hx/Casino_A1b-A1.png",4096,-1434.5355070229455],"Casino_A1b-A2":["/res/panelsoil/zenith/hx/Casino_A1b-A2.png",4096,-1407.9401553179398],"Casino_B1-A1":["/res/panelsoil/zenith/hx/Casino_B1-A1.png",4096,-1334.4206932467646],"Casino_B2-A1":["/res/panelsoil/zenith/hx/Casino_B2-A1.png",4096,-1353.1892172890186],"Casino_Front-A1":["/res/panelsoil/zenith/hx/Casino_Front-A1.png",4096,-1450.8397967736573],"Casino_Front-A2":["/res/panelsoil/zenith/hx/Casino_Front-A2.png",4096,-1382.0365512250391],"Casino_Front-A3":["/res/panelsoil/zenith/hx/Casino_Front-A3.png",4096,-1335.976794931923],"Core_A1-A1":["/res/panelsoil/zenith/hx/Core_A1-A1.png",4096,-482.2640656849193],"Core_A1-A2":["/res/panelsoil/zenith/hx/Core_A1-A2.png",4096,-414.63702977103384],"Core_B1-A1":["/res/panelsoil/zenith/hx/Core_B1-A1.png",4096,-416.1352322509627],"Core_B1-A2":["/res/panelsoil/zenith/hx/Core_B1-A2.png",4096,-349.4632344358376],"Core_B2-A1":["/res/panelsoil/zenith/hx/Core_B2-A1.png",4096,-357.74971140081743],"Core_C1-A1":["/res/panelsoil/zenith/hx/Core_C1-A1.png",4096,-287.7619953133781],"Core_Front-A1":["/res/panelsoil/zenith/hx/Core_Front-A1.png",4096,-513.4310951395493],"Core_Front-A2":["/res/panelsoil/zenith/hx/Core_Front-A2.png",4096,-441.2131861959439],"Core_Front-A3":["/res/panelsoil/zenith/hx/Core_Front-A3.png",4096,-397.5319313026727],"Core_Front-A4":["/res/panelsoil/zenith/hx/Core_Front-A4.png",4096,-347.06525473781795],"Core_Front-A5":["/res/panelsoil/zenith/hx/Core_Front-A5.png",4096,-298.7198142995433],"Corruption_A1-A1":["/res/panelsoil/zenith/hx/Corruption_A1-A1.png",4096,-224.18717718169268],"Corruption_A1-A2":["/res/panelsoil/zenith/hx/Corruption_A1-A2.png",4096,-216.1440952869437],"Corruption_B1-A1":["/res/panelsoil/zenith/hx/Corruption_B1-A1.png",4096,-153.10893458988852],"Corruption_B1-A2":["/res/panelsoil/zenith/hx/Corruption_B1-A2.png",4096,-142.68093507357577],"Corruption_B2-A1":["/res/panelsoil/zenith/hx/Corruption_B2-A1.png",4096,-194.35091327618395],"Corruption_B2-A2":["/res/panelsoil/zenith/hx/Corruption_B2-A2.png",4096,-119.81427278852179],"Corruption_C1-A1":["/res/panelsoil/zenith/hx/Corruption_C1-A1.png",4096,-150.7042989320603],"Corruption_C1-A2":["/res/panelsoil/zenith/hx/Corruption_C1-A2.png",4096,-102.12256683685283],"Corruption_C2-A1":["/res/panelsoil/zenith/hx/Corruption_C2-A1.png",4096,-143.20897285092997],"Corruption_C2-A2":["/res/panelsoil/zenith/hx/Corruption_C2-A2.png",4096,-83.00544404768544],"Corruption_D1-A1":["/res/panelsoil/zenith/hx/Corruption_D1-A1.png",4096,-38.783407689959674],"Corruption_D1-A2":["/res/panelsoil/zenith/hx/Corruption_D1-A2.png",4096,57.79238028227604],"Corruption_D2-A1":["/res/panelsoil/zenith/hx/Corruption_D2-A1.png",4096,-7.717834565079748],"Corruption_D2-A2":["/res/panelsoil/zenith/hx/Corruption_D2-A2.png",4096,45.70040700146964],"Corruption_Front-A1":["/res/panelsoil/zenith/hx/Corruption_Front-A1.png",4096,-254.2538193527385],"Corruption_Front-A2":["/res/panelsoil/zenith/hx/Corruption_Front-A2.png",4096,-211.1275406681591],"Corruption_Front-A3":["/res/panelsoil/zenith/hx/Corruption_Front-A3.png",4096,-142.06215428177043],"Corruption_Front-A4":["/res/panelsoil/zenith/hx/Corruption_Front-A4.png",4096,-99.089363705274],"Corruption_Front-A5":["/res/panelsoil/zenith/hx/Corruption_Front-A5.png",4096,-38.7499834043109],"Corruption_Front-A6":["/res/panelsoil/zenith/hx/Corruption_Front-A6.png",4096,-22.472666535694273],"Hall_1A-A1":["/res/panelsoil/zenith/hx/Hall_1A-A1.png",4096,-1586.307187789534],"Hall_Front-A1":["/res/panelsoil/zenith/hx/Hall_Front-A1.png",4096,-1584.7919322108678],"Hotel_A1-A1":["/res/panelsoil/zenith/hx/Hotel_A1-A1.png",4096,-1556.6425106501847],"Hotel_A1-A2":["/res/panelsoil/zenith/hx/Hotel_A1-A2.png",4096,-1509.3306573296895],"Hotel_B1-A1":["/res/panelsoil/zenith/hx/Hotel_B1-A1.png",4096,-1475.0401608364173],"Hotel_Back1-A1":["/res/panelsoil/zenith/hx/Hotel_Back1-A1.png",4096,-1526.0440479048557],"Hotel_Back2-A1":["/res/panelsoil/zenith/hx/Hotel_Back2-A1.png",4096,-1535.209850789422],"Hotel_Front-A1":["/res/panelsoil/zenith/hx/Hotel_Front-A1.png",4096,-1560.5869354320312],"Hotel_Front-A2":["/res/panelsoil/zenith/hx/Hotel_Front-A2.png",4096,-1524.4931012455866],"Lab_A1-A1":["/res/panelsoil/zenith/hx/Lab_A1-A1.png",4096,-697.8487401916611],"Lab_A1-A2":["/res/panelsoil/zenith/hx/Lab_A1-A2.png",4096,-667.3119375590528],"Lab_A2-A1":["/res/panelsoil/zenith/hx/Lab_A2-A1.png",4096,-725.8850907404973],"Lab_A2-A2":["/res/panelsoil/zenith/hx/Lab_A2-A2.png",4096,-687.000650507088],"Lab_B1-A1":["/res/panelsoil/zenith/hx/Lab_B1-A1.png",4096,-602.4805355025595],"Lab_B1-A2":["/res/panelsoil/zenith/hx/Lab_B1-A2.png",4096,-564.4200541567028],"Lab_C1-A1":["/res/panelsoil/zenith/hx/Lab_C1-A1.png",4096,-584.518839151506],"Lab_C1-A2":["/res/panelsoil/zenith/hx/Lab_C1-A2.png",4096,-507.7570375734328],"Lab_Front-A1":["/res/panelsoil/zenith/hx/Lab_Front-A1.png",4096,-747.7252958491555],"Lab_Front-A2":["/res/panelsoil/zenith/hx/Lab_Front-A2.png",4096,-705.5814417563902],"Lab_Front-A3":["/res/panelsoil/zenith/hx/Lab_Front-A3.png",4096,-635.8698539303913],"Lab_Front-A4":["/res/panelsoil/zenith/hx/Lab_Front-A4.png",4096,-590.329151723613],"Lab_Front-A5":["/res/panelsoil/zenith/hx/Lab_Front-A5.png",4096,-573.6235529454055],"Museum_A1-A1":["/res/panelsoil/zenith/hx/Museum_A1-A1.png",4096,-1159.6091666696325],"Museum_A1-A2":["/res/panelsoil/zenith/hx/Museum_A1-A2.png",4096,-1114.5843093476046],"Museum_B1-A1":["/res/panelsoil/zenith/hx/Museum_B1-A1.png",4096,-1056.3351579986852],"Museum_B1-A2":["/res/panelsoil/zenith/hx/Museum_B1-A2.png",4096,-1014.0989322359652],"Museum_C1-A1":["/res/panelsoil/zenith/hx/Museum_C1-A1.png",4096,-1018.9800493334471],"Museum_C1-A2":["/res/panelsoil/zenith/hx/Museum_C1-A2.png",4096,-936.3741378403527],"Museum_C2-A1":["/res/panelsoil/zenith/hx/Museum_C2-A1.png",4096,-1025.8266833691343],"Museum_C2-A2":["/res/panelsoil/zenith/hx/Museum_C2-A2.png",4096,-964.8386483063886],"Museum_Front-A1":["/res/panelsoil/zenith/hx/Museum_Front-A1.png",4096,-1143.6222608778216],"Museum_Front-A2":["/res/panelsoil/zenith/hx/Museum_Front-A2.png",4096,-1119.3936772661668],"Museum_Front-A3":["/res/panelsoil/zenith/hx/Museum_Front-A3.png",4096,-1047.8111492666721],"Museum_Front-A4":["/res/panelsoil/zenith/hx/Museum_Front-A4.png",4096,-1015.4222092000796],"Office_A1-A1":["/res/panelsoil/zenith/hx/Office_A1-A1.png",4096,-955.646165034067],"Office_A1-A2":["/res/panelsoil/zenith/hx/Office_A1-A2.png",4096,-910.2005693182849],"Office_B1-A1":["/res/panelsoil/zenith/hx/Office_B1-A1.png",4096,-855.4918803409197],"Office_B2-A1":["/res/panelsoil/zenith/hx/Office_B2-A1.png",4096,-831.7889220509281],"Office_Front-A1":["/res/panelsoil/zenith/hx/Office_Front-A1.png",4096,-925.9446466999855],"Office_Front-A2":["/res/panelsoil/zenith/hx/Office_Front-A2.png",4096,-901.4727999234656],"Office_Front-A3":["/res/panelsoil/zenith/hx/Office_Front-A3.png",4096,-865.2068275616224],"Office_Front-A4":["/res/panelsoil/zenith/hx/Office_Front-A4.png",4096,-792.5362233909909],"Platform_Back-A1":["/res/panelsoil/zenith/hx/Platform_Back-A1.png",4096,55.04235744796891],"Platform_Front-A1":["/res/panelsoil/zenith/hx/Platform_Front-A1.png",4096,57.725269210480675]},"1x":{"Arena_A1-A1":["/res/panelsoil/zenith/1x/Arena_A1-A1.png",2048,-510.3646661001158],"Arena_A1-B1":["/res/panelsoil/zenith/1x/Arena_A1-B1.png",2048,-489.33401916623666],"Arena_A1-A2":["/res/panelsoil/zenith/1x/Arena_A1-A2.png",2048,-486.66019010724386],"Arena_A1-B2":["/res/panelsoil/zenith/1x/Arena_A1-B2.png",2048,-465.7903247054906],"Arena_A1-A3":["/res/panelsoil/zenith/1x/Arena_A1-A3.png",2048,-454.79978294976644],"Arena_A1-B3":["/res/panelsoil/zenith/1x/Arena_A1-B3.png",2048,-427.4164111372226],"Arena_B1-A1":["/res/panelsoil/zenith/1x/Arena_B1-A1.png",2048,-443.8586169503417],"Arena_B1-B1":["/res/panelsoil/zenith/1x/Arena_B1-B1.png",2048,-428.0596699381492],"Arena_B1-A2":["/res/panelsoil/zenith/1x/Arena_B1-A2.png",2048,-417.5219138006576],"Arena_B1-B2":["/res/panelsoil/zenith/1x/Arena_B1-B2.png",2048,-407.3341211389336],"Arena_B1-A3":["/res/panelsoil/zenith/1x/Arena_B1-A3.png",2048,-395.36525907269106],"Arena_B1-B3":["/res/panelsoil/zenith/1x/Arena_B1-B3.png",2048,-376.16705644453197],"Arena_B2-A1":["/res/panelsoil/zenith/1x/Arena_B2-A1.png",2048,-446.0935964821873],"Arena_B2-B1":["/res/panelsoil/zenith/1x/Arena_B2-B1.png",2048,-440.67844162659463],"Arena_B2-A2":["/res/panelsoil/zenith/1x/Arena_B2-A2.png",2048,-408.03499748427686],"Arena_B2-B2":["/res/panelsoil/zenith/1x/Arena_B2-B2.png",2048,-407.9626790349768],"Arena_B3-A1":["/res/panelsoil/zenith/1x/Arena_B3-A1.png",2048,-433.0455755582128],"Arena_B3-B1":["/res/panelsoil/zenith/1x/Arena_B3-B1.png",2048,-415.5125792712577],"Arena_B3-A2":["/res/panelsoil/zenith/1x/Arena_B3-A2.png",2048,-416.34927291024457],"Arena_B3-B2":["/res/panelsoil/zenith/1x/Arena_B3-B2.png",2048,-407.3056636471583],"Arena_B3-A3":["/res/panelsoil/zenith/1x/Arena_B3-A3.png",2048,-373.63803867606737],"Arena_B3-B3":["/res/panelsoil/zenith/1x/Arena_B3-B3.png",2048,-381.0837828087411],"Arena_C1-A1":["/res/panelsoil/zenith/1x/Arena_C1-A1.png",2048,-375.47104223803075],"Arena_C1-B1":["/res/panelsoil/zenith/1x/Arena_C1-B1.png",2048,-352.8200340314202],"Arena_Front-A1":["/res/panelsoil/zenith/1x/Arena_Front-A1.png",2048,-495.23570290552124],"Arena_Front-B1":["/res/panelsoil/zenith/1x/Arena_Front-B1.png",2048,-477.12233664222003],"Arena_Front-A2":["/res/panelsoil/zenith/1x/Arena_Front-A2.png",2048,-469.7827221839445],"Arena_Front-B2":["/res/panelsoil/zenith/1x/Arena_Front-B2.png",2048,-461.3191252196394],"Arena_Front-A3":["/res/panelsoil/zenith/1x/Arena_Front-A3.png",2048,-444.6532202915904],"Arena_Front-B3":["/res/panelsoil/zenith/1x/Arena_Front-B3.png",2048,-425.20212299159886],"Arena_Front-A4":["/res/panelsoil/zenith/1x/Arena_Front-A4.png",2048,-428.1008089535516],"Arena_Front-B4":["/res/panelsoil/zenith/1x/Arena_Front-B4.png",2048,-419.5138405311521],"Arena_Front-A5":["/res/panelsoil/zenith/1x/Arena_Front-A5.png",2048,-407.4648427356021],"Arena_Front-B5":["/res/panelsoil/zenith/1x/Arena_Front-B5.png",2048,-397.39070812816516],"Arena_Front-A6":["/res/panelsoil/zenith/1x/Arena_Front-A6.png",2048,-377.21230610696904],"Arena_Front-B6":["/res/panelsoil/zenith/1x/Arena_Front-B6.png",2048,-358.7064479801425],"Casino_A1-A1":["/res/panelsoil/zenith/1x/Casino_A1-A1.png",2048,-654.0510535898237],"Casino_A1-B1":["/res/panelsoil/zenith/1x/Casino_A1-B1.png",2048,-645.3797479416316],"Casino_A1-A2":["/res/panelsoil/zenith/1x/Casino_A1-A2.png",2048,-626.6049561282057],"Casino_A1-B2":["/res/panelsoil/zenith/1x/Casino_A1-B2.png",2048,-605.4346247515085],"Casino_A1-A3":["/res/panelsoil/zenith/1x/Casino_A1-A3.png",2048,-592.1646938665457],"Casino_A1-B3":["/res/panelsoil/zenith/1x/Casino_A1-B3.png",2048,-576.5706122907413],"Casino_A1-A4":["/res/panelsoil/zenith/1x/Casino_A1-A4.png",2048,-572.6656447140067],"Casino_A1-B4":["/res/panelsoil/zenith/1x/Casino_A1-B4.png",2048,-561.9385987788311],"Casino_A1b-A1":["/res/panelsoil/zenith/1x/Casino_A1b-A1.png",2048,-652.3055640668458],"Casino_A1b-B1":["/res/panelsoil/zenith/1x/Casino_A1b-B1.png",2048,-637.4843510885761],"Casino_A1b-A2":["/res/panelsoil/zenith/1x/Casino_A1b-A2.png",2048,-618.8600857908566],"Casino_A1b-B2":["/res/panelsoil/zenith/1x/Casino_A1b-B2.png",2048,-624.6827565391039],"Casino_A1b-A3":["/res/panelsoil/zenith/1x/Casino_A1b-A3.png",2048,-592.8389654878318],"Casino_A1b-B3":["/res/panelsoil/zenith/1x/Casino_A1b-B3.png",2048,-590.0746801892924],"Casino_B1-A1":["/res/panelsoil/zenith/1x/Casino_B1-A1.png",2048,-525.8043405902855],"Casino_B1-B1":["/res/panelsoil/zenith/1x/Casino_B1-B1.png",2048,-508.2720883411637],"Casino_B1-A2":["/res/panelsoil/zenith/1x/Casino_B1-A2.png",2048,-515.8128841309697],"Casino_B1-B2":["/res/panelsoil/zenith/1x/Casino_B1-B2.png",2048,-497.1678639205621],"Casino_B2-A1":["/res/panelsoil/zenith/1x/Casino_B2-A1.png",2048,-539.0826136799096],"Casino_B2-B1":["/res/panelsoil/zenith/1x/Casino_B2-B1.png",2048,-529.0388896750173],"Casino_B2-A2":["/res/panelsoil/zenith/1x/Casino_B2-A2.png",2048,-518.4030892688678],"Casino_B2-B2":["/res/panelsoil/zenith/1x/Casino_B2-B2.png",2048,-498.06079928730514],"Casino_Front-A1":["/res/panelsoil/zenith/1x/Casino_Front-A1.png",2048,-649.545897503458],"Casino_Front-B1":["/res/panelsoil/zenith/1x/Casino_Front-B1.png",2048,-631.6571156837867],"Casino_Front-A2":["/res/panelsoil/zenith/1x/Casino_Front-A2.png",2048,-631.080214693081],"Casino_Front-B2":["/res/panelsoil/zenith/1x/Casino_Front-B2.png",2048,-606.8864754974967],"Casino_Front-A3":["/res/panelsoil/zenith/1x/Casino_Front-A3.png",2048,-590.5860659593152],"Casino_Front-B3":["/res/panelsoil/zenith/1x/Casino_Front-B3.png",2048,-589.8709558108254],"Casino_Front-A4":["/res/panelsoil/zenith/1x/Casino_Front-A4.png",2048,-566.8214132499398],"Casino_Front-B4":["/res/panelsoil/zenith/1x/Casino_Front-B4.png",2048,-552.9458721421729],"Casino_Front-A5":["/res/panelsoil/zenith/1x/Casino_Front-A5.png",2048,-538.8238705682095],"Casino_Front-B5":["/res/panelsoil/zenith/1x/Casino_Front-B5.png",2048,-539.6294728668352],"Casino_Front-A6":["/res/panelsoil/zenith/1x/Casino_Front-A6.png",2048,-531.756363406706],"Casino_Front-B6":["/res/panelsoil/zenith/1x/Casino_Front-B6.png",2048,-519.3038331960822],"Core_A1-A1":["/res/panelsoil/zenith/1x/Core_A1-A1.png",2048,316.29380655160577],"Core_A1-B1":["/res/panelsoil/zenith/1x/Core_A1-B1.png",2048,329.52935306943624],"Core_A1-A2":["/res/panelsoil/zenith/1x/Core_A1-A2.png",2048,353.96200851072706],"Core_A1-B2":["/res/panelsoil/zenith/1x/Core_A1-B2.png",2048,349.12404310189635],"Core_A1-A3":["/res/panelsoil/zenith/1x/Core_A1-A3.png",2048,374.99133297234215],"Core_A1-B3":["/res/panelsoil/zenith/1x/Core_A1-B3.png",2048,388.10891715856314],"Core_A1-A4":["/res/panelsoil/zenith/1x/Core_A1-A4.png",2048,397.64392712222985],"Core_A1-B4":["/res/panelsoil/zenith/1x/Core_A1-B4.png",2048,402.95307192027076],"Core_B1-A1":["/res/panelsoil/zenith/1x/Core_B1-A1.png",2048,401.95387528099275],"Core_B1-B1":["/res/panelsoil/zenith/1x/Core_B1-B1.png",2048,431.9887906991298],"Core_B1-A2":["/res/panelsoil/zenith/1x/Core_B1-A2.png",2048,429.34664512094554],"Core_B1-B2":["/res/panelsoil/zenith/1x/Core_B1-B2.png",2048,448.46680892047027],"Core_B1-A3":["/res/panelsoil/zenith/1x/Core_B1-A3.png",2048,455.50181859084705],"Core_B1-B3":["/res/panelsoil/zenith/1x/Core_B1-B3.png",2048,466.94379443460366],"Core_B2-A1":["/res/panelsoil/zenith/1x/Core_B2-A1.png",2048,443.9030736928463],"Core_B2-B1":["/res/panelsoil/zenith/1x/Core_B2-B1.png",2048,456.20479244601853],"Core_B2-A2":["/res/panelsoil/zenith/1x/Core_B2-A2.png",2048,473.8255967046075],"Core_B2-B2":["/res/panelsoil/zenith/1x/Core_B2-B2.png",2048,479.7201952646365],"Core_C1-A1":["/res/panelsoil/zenith/1x/Core_C1-A1.png",2048,526.0703136564354],"Core_C1-B1":["/res/panelsoil/zenith/1x/Core_C1-B1.png",2048,551.569937146829],"Core_Front-A1":["/res/panelsoil/zenith/1x/Core_Front-A1.png",2048,304.9388956435004],"Core_Front-B1":["/res/panelsoil/zenith/1x/Core_Front-B1.png",2048,316.7350495098792],"Core_Front-A2":["/res/panelsoil/zenith/1x/Core_Front-A2.png",2048,324.9984186865389],"Core_Front-B2":["/res/panelsoil/zenith/1x/Core_Front-B2.png",2048,343.2677222376643],"Core_Front-A3":["/res/panelsoil/zenith/1x/Core_Front-A3.png",2048,352.7069996960664],"Core_Front-B3":["/res/panelsoil/zenith/1x/Core_Front-B3.png",2048,372.3678731095606],"Core_Front-A4":["/res/panelsoil/zenith/1x/Core_Front-A4.png",2048,379.5928949688442],"Core_Front-B4":["/res/panelsoil/zenith/1x/Core_Front-B4.png",2048,394.25020384462965],"Core_Front-A5":["/res/panelsoil/zenith/1x/Core_Front-A5.png",2048,394.2047661017881],"Core_Front-B5":["/res/panelsoil/zenith/1x/Core_Front-B5.png",2048,421.4911441976531],"Core_Front-A6":["/res/panelsoil/zenith/1x/Core_Front-A6.png",2048,436.94332655238105],"Core_Front-B6":["/res/panelsoil/zenith/1x/Core_Front-B6.png",2048,439.7677144198365],"Core_Front-A7":["/res/panelsoil/zenith/1x/Core_Front-A7.png",2048,440.05532403673686],"Core_Front-B7":["/res/panelsoil/zenith/1x/Core_Front-B7.png",2048,464.46757941992854],"Core_Front-A8":["/res/panelsoil/zenith/1x/Core_Front-A8.png",2048,476.03984182546276],"Core_Front-B8":["/res/panelsoil/zenith/1x/Core_Front-B8.png",2048,494.08394952676616],"Core_Front-A9":["/res/panelsoil/zenith/1x/Core_Front-A9.png",2048,488.65923064369986],"Core_Front-B9":["/res/panelsoil/zenith/1x/Core_Front-B9.png",2048,517.1571803165235],"Core_Front-A10":["/res/panelsoil/zenith/1x/Core_Front-A10.png",2048,518.7017190728233],"Core_Front-B10":["/res/panelsoil/zenith/1x/Core_Front-B10.png",2048,529.3914816899648],"Corruption_A1-A1":["/res/panelsoil/zenith/1x/Corruption_A1-A1.png",2048,552.6035744772335],"Corruption_A1-B1":["/res/panelsoil/zenith/1x/Corruption_A1-B1.png",2048,577.1086872876225],"Corruption_A1-A2":["/res/panelsoil/zenith/1x/Corruption_A1-A2.png",2048,570.868673344454],"Corruption_A1-B2":["/res/panelsoil/zenith/1x/Corruption_A1-B2.png",2048,587.4915517081993],"Corruption_A1-A3":["/res/panelsoil/zenith/1x/Corruption_A1-A3.png",2048,613.88202660826],"Corruption_A1-B3":["/res/panelsoil/zenith/1x/Corruption_A1-B3.png",2048,627.0846380078374],"Corruption_B1-A1":["/res/panelsoil/zenith/1x/Corruption_B1-A1.png",2048,632.7557501001916],"Corruption_B1-B1":["/res/panelsoil/zenith/1x/Corruption_B1-B1.png",2048,634.5587055648784],"Corruption_B1-A2":["/res/panelsoil/zenith/1x/Corruption_B1-A2.png",2048,659.4878943276431],"Corruption_B1-B2":["/res/panelsoil/zenith/1x/Corruption_B1-B2.png",2048,654.0007602701533],"Corruption_B1-A3":["/res/panelsoil/zenith/1x/Corruption_B1-A3.png",2048,665.6420487946251],"Corruption_B1-B3":["/res/panelsoil/zenith/1x/Corruption_B1-B3.png",2048,689.8479205692521],"Corruption_B2-A1":["/res/panelsoil/zenith/1x/Corruption_B2-A1.png",2048,627.1593833635864],"Corruption_B2-B1":["/res/panelsoil/zenith/1x/Corruption_B2-B1.png",2048,638.0592351235996],"Corruption_B2-A2":["/res/panelsoil/zenith/1x/Corruption_B2-A2.png",2048,639.4672688084136],"Corruption_B2-B2":["/res/panelsoil/zenith/1x/Corruption_B2-B2.png",2048,666.0811779737485],"Corruption_B2-A3":["/res/panelsoil/zenith/1x/Corruption_B2-A3.png",2048,684.4668925940929],"Corruption_B2-B3":["/res/panelsoil/zenith/1x/Corruption_B2-B3.png",2048,684.6812541449234],"Corruption_C1-A1":["/res/panelsoil/zenith/1x/Corruption_C1-A1.png",2048,672.8613548098398],"Corruption_C1-B1":["/res/panelsoil/zenith/1x/Corruption_C1-B1.png",2048,681.4848546420221],"Corruption_C1-A2":["/res/panelsoil/zenith/1x/Corruption_C1-A2.png",2048,684.3034338326243],"Corruption_C1-B2":["/res/panelsoil/zenith/1x/Corruption_C1-B2.png",2048,703.8906712469515],"Corruption_C1-A3":["/res/panelsoil/zenith/1x/Corruption_C1-A3.png",2048,712.1789777299764],"Corruption_C1-B3":["/res/panelsoil/zenith/1x/Corruption_C1-B3.png",2048,725.2824683831379],"Corruption_C2-A1":["/res/panelsoil/zenith/1x/Corruption_C2-A1.png",2048,674.1180463255023],"Corruption_C2-B1":["/res/panelsoil/zenith/1x/Corruption_C2-B1.png",2048,684.7899807610211],"Corruption_C2-A2":["/res/panelsoil/zenith/1x/Corruption_C2-A2.png",2048,698.7923145521503],"Corruption_C2-B2":["/res/panelsoil/zenith/1x/Corruption_C2-B2.png",2048,702.6643601044423],"Corruption_C2-A3":["/res/panelsoil/zenith/1x/Corruption_C2-A3.png",2048,717.4423424967339],"Corruption_D1-A1":["/res/panelsoil/zenith/1x/Corruption_D1-A1.png",2048,780.8712793137977],"Corruption_D1-B1":["/res/panelsoil/zenith/1x/Corruption_D1-B1.png",2048,798.6290041284157],"Corruption_D1-A2":["/res/panelsoil/zenith/1x/Corruption_D1-A2.png",2048,818.3808179046426],"Corruption_D1-B2":["/res/panelsoil/zenith/1x/Corruption_D1-B2.png",2048,832.3377236316311],"Corruption_D1-A3":["/res/panelsoil/zenith/1x/Corruption_D1-A3.png",2048,835.0789409975287],"Corruption_D1-B3":["/res/panelsoil/zenith/1x/Corruption_D1-B3.png",2048,858.4721490823579],"Corruption_D2-A1":["/res/panelsoil/zenith/1x/Corruption_D2-A1.png",2048,790.7060549854688],"Corruption_D2-B1":["/res/panelsoil/zenith/1x/Corruption_D2-B1.png",2048,787.9576241960699],"Corruption_D2-A2":["/res/panelsoil/zenith/1x/Corruption_D2-A2.png",2048,797.6726614109335],"Corruption_D2-B2":["/res/panelsoil/zenith/1x/Corruption_D2-B2.png",2048,811.0158862709748],"Corruption_D2-A3":["/res/panelsoil/zenith/1x/Corruption_D2-A3.png",2048,846.2089621336063],"Corruption_D2-B3":["/res/panelsoil/zenith/1x/Corruption_D2-B3.png",2048,849.5968441405913],"Corruption_Front-A1":["/res/panelsoil/zenith/1x/Corruption_Front-A1.png",2048,549.9336461597222],"Corruption_Front-B1":["/res/panelsoil/zenith/1x/Corruption_Front-B1.png",2048,554.395759013717],"Corruption_Front-A2":["/res/panelsoil/zenith/1x/Corruption_Front-A2.png",2048,564.7086327671394],"Corruption_Front-B2":["/res/panelsoil/zenith/1x/Corruption_Front-B2.png",2048,577.5065159668583],"Corruption_Front-A3":["/res/panelsoil/zenith/1x/Corruption_Front-A3.png",2048,598.0274867845895],"Corruption_Front-B3":["/res/panelsoil/zenith/1x/Corruption_Front-B3.png",2048,602.7450097548516],"Corruption_Front-A4":["/res/panelsoil/zenith/1x/Corruption_Front-A4.png",2048,629.9384706336725],"Corruption_Front-B4":["/res/panelsoil/zenith/1x/Corruption_Front-B4.png",2048,640.9639002516187],"Corruption_Front-A5":["/res/panelsoil/zenith/1x/Corruption_Front-A5.png",2048,655.0664682178176],"Corruption_Front-B5":["/res/panelsoil/zenith/1x/Corruption_Front-B5.png",2048,662.2120840193105],"Corruption_Front-A6":["/res/panelsoil/zenith/1x/Corruption_Front-A6.png",2048,672.2033193065961],"Corruption_Front-B6":["/res/panelsoil/zenith/1x/Corruption_Front-B6.png",2048,696.628593690347],"Corruption_Front-A7":["/res/panelsoil/zenith/1x/Corruption_Front-A7.png",2048,708.3887380984565],"Corruption_Front-B7":["/res/panelsoil/zenith/1x/Corruption_Front-B7.png",2048,721.9254461128296],"Corruption_Front-A8":["/res/panelsoil/zenith/1x/Corruption_Front-A8.png",2048,715.2762835037453],"Corruption_Front-B8":["/res/panelsoil/zenith/1x/Corruption_Front-B8.png",2048,735.6768923082788],"Corruption_Front-A9":["/res/panelsoil/zenith/1x/Corruption_Front-A9.png",2048,751.001724548076],"Corruption_Front-B9":["/res/panelsoil/zenith/1x/Corruption_Front-B9.png",2048,771.2479539041593],"Corruption_Front-A10":["/res/panelsoil/zenith/1x/Corruption_Front-A10.png",2048,783.1102743843746],"Corruption_Front-B10":["/res/panelsoil/zenith/1x/Corruption_Front-B10.png",2048,780.4448671330541],"Corruption_Front-A11":["/res/panelsoil/zenith/1x/Corruption_Front-A11.png",2048,805.6192796360431],"Corruption_Front-B11":["/res/panelsoil/zenith/1x/Corruption_Front-B11.png",2048,808.8174963836168],"Hall_1A-A1":["/res/panelsoil/zenith/1x/Hall_1A-A1.png",2048,-792.7426474611042],"Hall_1A-B1":["/res/panelsoil/zenith/1x/Hall_1A-B1.png",2048,-778.1223335891968],"Hall_1A-A2":["/res/panelsoil/zenith/1x/Hall_1A-A2.png",2048,-777.1814427804593],"Hall_1A-B2":["/res/panelsoil/zenith/1x/Hall_1A-B2.png",2048,-774.8147412169419],"Hall_Front-A1":["/res/panelsoil/zenith/1x/Hall_Front-A1.png",2048,-809.0107876267627],"Hall_Front-B1":["/res/panelsoil/zenith/1x/Hall_Front-B1.png",2048,-781.186717925707],"Hall_Front-A2":["/res/panelsoil/zenith/1x/Hall_Front-A2.png",2048,-772.841332980647],"Hall_Front-B2":["/res/panelsoil/zenith/1x/Hall_Front-B2.png",2048,-769.3227487078938],"Hotel_A1-A1":["/res/panelsoil/zenith/1x/Hotel_A1-A1.png",2048,-743.3661161595885],"Hotel_A1-B1":["/res/panelsoil/zenith/1x/Hotel_A1-B1.png",2048,-749.621964728818],"Hotel_A1-A2":["/res/panelsoil/zenith/1x/Hotel_A1-A2.png",2048,-721.1970049101365],"Hotel_A1-B2":["/res/panelsoil/zenith/1x/Hotel_A1-B2.png",2048,-717.9983589493704],"Hotel_A1-A3":["/res/panelsoil/zenith/1x/Hotel_A1-A3.png",2048,-699.5137590248353],"Hotel_A1-B3":["/res/panelsoil/zenith/1x/Hotel_A1-B3.png",2048,-687.9914589954271],"Hotel_B1-A1":["/res/panelsoil/zenith/1x/Hotel_B1-A1.png",2048,-678.3162066533166],"Hotel_B1-B1":["/res/panelsoil/zenith/1x/Hotel_B1-B1.png",2048,-668.2821291370177],"Hotel_B1-A2":["/res/panelsoil/zenith/1x/Hotel_B1-A2.png",2048,-656.1835304385772],"Hotel_B1-B2":["/res/panelsoil/zenith/1x/Hotel_B1-B2.png",2048,-631.9378938673364],"Hotel_Back1-A1":["/res/panelsoil/zenith/1x/Hotel_Back1-A1.png",2048,-751.7974310479055],"Hotel_Back1-B1":["/res/panelsoil/zenith/1x/Hotel_Back1-B1.png",2048,-741.7942321779208],"Hotel_Back1-A2":["/res/panelsoil/zenith/1x/Hotel_Back1-A2.png",2048,-727.3339947507666],"Hotel_Back1-B2":["/res/panelsoil/zenith/1x/Hotel_Back1-B2.png",2048,-718.621630997955],"Hotel_Back2-A1":["/res/panelsoil/zenith/1x/Hotel_Back2-A1.png",2048,-748.1653157824396],"Hotel_Back2-B1":["/res/panelsoil/zenith/1x/Hotel_Back2-B1.png",2048,-728.258451748148],"Hotel_Back2-A2":["/res/panelsoil/zenith/1x/Hotel_Back2-A2.png",2048,-724.381173282849],"Hotel_Back2-B2":["/res/panelsoil/zenith/1x/Hotel_Back2-B2.png",2048,-723.9805360963019],"Hotel_Front-A1":["/res/panelsoil/zenith/1x/Hotel_Front-A1.png",2048,-744.9306078924976],"Hotel_Front-B1":["/res/panelsoil/zenith/1x/Hotel_Front-B1.png",2048,-728.4809831796285],"Hotel_Front-A2":["/res/panelsoil/zenith/1x/Hotel_Front-A2.png",2048,-718.9693575439796],"Hotel_Front-B2":["/res/panelsoil/zenith/1x/Hotel_Front-B2.png",2048,-721.4756480703314],"Hotel_Front-A3":["/res/panelsoil/zenith/1x/Hotel_Front-A3.png",2048,-694.8720807520282],"Hotel_Front-B3":["/res/panelsoil/zenith/1x/Hotel_Front-B3.png",2048,-684.1636181713352],"Hotel_Front-A4":["/res/panelsoil/zenith/1x/Hotel_Front-A4.png",2048,-674.5443378185385],"Hotel_Front-B4":["/res/panelsoil/zenith/1x/Hotel_Front-B4.png",2048,-669.8322443010271],"Lab_A1-A1":["/res/panelsoil/zenith/1x/Lab_A1-A1.png",2048,67.35341215641212],"Lab_A1-B1":["/res/panelsoil/zenith/1x/Lab_A1-B1.png",2048,91.86742124622855],"Lab_A1-A2":["/res/panelsoil/zenith/1x/Lab_A1-A2.png",2048,99.42957681253691],"Lab_A1-B2":["/res/panelsoil/zenith/1x/Lab_A1-B2.png",2048,108.35231150685266],"Lab_A1-A3":["/res/panelsoil/zenith/1x/Lab_A1-A3.png",2048,130.40726544953318],"Lab_A1-B3":["/res/panelsoil/zenith/1x/Lab_A1-B3.png",2048,129.76453511783367],"Lab_A1-A4":["/res/panelsoil/zenith/1x/Lab_A1-A4.png",2048,159.53693462115626],"Lab_A1-B4":["/res/panelsoil/zenith/1x/Lab_A1-B4.png",2048,159.1526445657848],"Lab_A2-A1":["/res/panelsoil/zenith/1x/Lab_A2-A1.png",2048,80.1489193317615],"Lab_A2-B1":["/res/panelsoil/zenith/1x/Lab_A2-B1.png",2048,90.28316359967047],"Lab_A2-A2":["/res/panelsoil/zenith/1x/Lab_A2-A2.png",2048,102.3701475007704],"Lab_A2-B2":["/res/panelsoil/zenith/1x/Lab_A2-B2.png",2048,107.86671390966595],"Lab_A2-A3":["/res/panelsoil/zenith/1x/Lab_A2-A3.png",2048,132.02014816007087],"Lab_A2-B3":["/res/panelsoil/zenith/1x/Lab_A2-B3.png",2048,151.640288167214],"Lab_A2-A4":["/res/panelsoil/zenith/1x/Lab_A2-A4.png",2048,157.19775529030903],"Lab_A2-B4":["/res/panelsoil/zenith/1x/Lab_A2-B4.png",2048,157.06542850318408],"Lab_B1-A1":["/res/panelsoil/zenith/1x/Lab_B1-A1.png",2048,178.11340303671696],"Lab_B1-B1":["/res/panelsoil/zenith/1x/Lab_B1-B1.png",2048,201.6184610278707],"Lab_B1-A2":["/res/panelsoil/zenith/1x/Lab_B1-A2.png",2048,209.3031714446414],"Lab_B1-B2":["/res/panelsoil/zenith/1x/Lab_B1-B2.png",2048,226.6604107446418],"Lab_B1-A3":["/res/panelsoil/zenith/1x/Lab_B1-A3.png",2048,237.86623312197275],"Lab_B1-B3":["/res/panelsoil/zenith/1x/Lab_B1-B3.png",2048,249.6666895744786],"Lab_C1-A1":["/res/panelsoil/zenith/1x/Lab_C1-A1.png",2048,236.29223217291485],"Lab_C1-B1":["/res/panelsoil/zenith/1x/Lab_C1-B1.png",2048,239.3326214951054],"Lab_C1-A2":["/res/panelsoil/zenith/1x/Lab_C1-A2.png",2048,259.31938387452936],"Lab_C1-B2":["/res/panelsoil/zenith/1x/Lab_C1-B2.png",2048,274.65754538202566],"Lab_C1-A3":["/res/panelsoil/zenith/1x/Lab_C1-A3.png",2048,280.65443394522805],"Lab_C1-B3":["/res/panelsoil/zenith/1x/Lab_C1-B3.png",2048,294.53266890367274],"Lab_Front-A1":["/res/panelsoil/zenith/1x/Lab_Front-A1.png",2048,47.448217408459186],"Lab_Front-B1":["/res/panelsoil/zenith/1x/Lab_Front-B1.png",2048,50.807773594202146],"Lab_Front-A2":["/res/panelsoil/zenith/1x/Lab_Front-A2.png",2048,86.33299946776879],"Lab_Front-B2":["/res/panelsoil/zenith/1x/Lab_Front-B2.png",2048,97.12786710442151],"Lab_Front-A3":["/res/panelsoil/zenith/1x/Lab_Front-A3.png",2048,109.47699835020572],"Lab_Front-B3":["/res/panelsoil/zenith/1x/Lab_Front-B3.png",2048,102.58787602517538],"Lab_Front-A4":["/res/panelsoil/zenith/1x/Lab_Front-A4.png",2048,122.67635934114716],"Lab_Front-B4":["/res/panelsoil/zenith/1x/Lab_Front-B4.png",2048,147.20442165948793],"Lab_Front-A5":["/res/panelsoil/zenith/1x/Lab_Front-A5.png",2048,153.37515522136192],"Lab_Front-B5":["/res/panelsoil/zenith/1x/Lab_Front-B5.png",2048,165.2267243041752],"Lab_Front-A6":["/res/panelsoil/zenith/1x/Lab_Front-A6.png",2048,165.435564976872],"Lab_Front-B6":["/res/panelsoil/zenith/1x/Lab_Front-B6.png",2048,198.73683293064735],"Lab_Front-A7":["/res/panelsoil/zenith/1x/Lab_Front-A7.png",2048,196.87865540718778],"Lab_Front-B7":["/res/panelsoil/zenith/1x/Lab_Front-B7.png",2048,222.7227344610232],"Lab_Front-A8":["/res/panelsoil/zenith/1x/Lab_Front-A8.png",2048,227.94263091084156],"Lab_Front-B8":["/res/panelsoil/zenith/1x/Lab_Front-B8.png",2048,239.3641528393968],"Lab_Front-A9":["/res/panelsoil/zenith/1x/Lab_Front-A9.png",2048,246.54743170332978],"Lab_Front-B9":["/res/panelsoil/zenith/1x/Lab_Front-B9.png",2048,257.24041617466924],"Lab_Front-A10":["/res/panelsoil/zenith/1x/Lab_Front-A10.png",2048,264.24369224532336],"Lab_Front-B10":["/res/panelsoil/zenith/1x/Lab_Front-B10.png",2048,290.34545951134083],"Museum_A1-A1":["/res/panelsoil/zenith/1x/Museum_A1-A1.png",2048,-358.26795373805174],"Museum_A1-B1":["/res/panelsoil/zenith/1x/Museum_A1-B1.png",2048,-346.7820508324],"Museum_A1-A2":["/res/panelsoil/zenith/1x/Museum_A1-A2.png",2048,-336.143577025795],"Museum_A1-B2":["/res/panelsoil/zenith/1x/Museum_A1-B2.png",2048,-320.1775309112393],"Museum_A1-A3":["/res/panelsoil/zenith/1x/Museum_A1-A3.png",2048,-299.57001292035966],"Museum_A1-B3":["/res/panelsoil/zenith/1x/Museum_A1-B3.png",2048,-285.86837605455145],"Museum_B1-A1":["/res/panelsoil/zenith/1x/Museum_B1-A1.png",2048,-274.4513992679914],"Museum_B1-B1":["/res/panelsoil/zenith/1x/Museum_B1-B1.png",2048,-255.98591038751027],"Museum_B1-A2":["/res/panelsoil/zenith/1x/Museum_B1-A2.png",2048,-247.47808605213274],"Museum_B1-B2":["/res/panelsoil/zenith/1x/Museum_B1-B2.png",2048,-241.63666341206192],"Museum_B1-A3":["/res/panelsoil/zenith/1x/Museum_B1-A3.png",2048,-241.92742213544162],"Museum_B1-B3":["/res/panelsoil/zenith/1x/Museum_B1-B3.png",2048,-221.75474688645465],"Museum_C1-A1":["/res/panelsoil/zenith/1x/Museum_C1-A1.png",2048,-213.19610532589635],"Museum_C1-B1":["/res/panelsoil/zenith/1x/Museum_C1-B1.png",2048,-195.70599508992893],"Museum_C1-A2":["/res/panelsoil/zenith/1x/Museum_C1-A2.png",2048,-189.25278869176708],"Museum_C1-B2":["/res/panelsoil/zenith/1x/Museum_C1-B2.png",2048,-179.0275720913047],"Museum_C1-A3":["/res/panelsoil/zenith/1x/Museum_C1-A3.png",2048,-155.20006421802233],"Museum_C1-B3":["/res/panelsoil/zenith/1x/Museum_C1-B3.png",2048,-146.98249979678096],"Museum_C2-A1":["/res/panelsoil/zenith/1x/Museum_C2-A1.png",2048,-198.0231410445494],"Museum_C2-B1":["/res/panelsoil/zenith/1x/Museum_C2-B1.png",2048,-208.8092094802223],"Museum_C2-A2":["/res/panelsoil/zenith/1x/Museum_C2-A2.png",2048,-180.7445215120516],"Museum_C2-B2":["/res/panelsoil/zenith/1x/Museum_C2-B2.png",2048,-166.71115997723234],"Museum_C2-A3":["/res/panelsoil/zenith/1x/Museum_C2-A3.png",2048,-152.4668515046003],"Museum_C2-B3":["/res/panelsoil/zenith/1x/Museum_C2-B3.png",2048,-156.70904821569817],"Museum_Front-A1":["/res/panelsoil/zenith/1x/Museum_Front-A1.png",2048,-344.5529336524014],"Museum_Front-B1":["/res/panelsoil/zenith/1x/Museum_Front-B1.png",2048,-326.56631466846113],"Museum_Front-A2":["/res/panelsoil/zenith/1x/Museum_Front-A2.png",2048,-315.94706321471915],"Museum_Front-B2":["/res/panelsoil/zenith/1x/Museum_Front-B2.png",2048,-323.9538573432688],"Museum_Front-A3":["/res/panelsoil/zenith/1x/Museum_Front-A3.png",2048,-310.9159953165584],"Museum_Front-B3":["/res/panelsoil/zenith/1x/Museum_Front-B3.png",2048,-284.0274848858467],"Museum_Front-A4":["/res/panelsoil/zenith/1x/Museum_Front-A4.png",2048,-280.9719921854486],"Museum_Front-B4":["/res/panelsoil/zenith/1x/Museum_Front-B4.png",2048,-263.68487306701115],"Museum_Front-A5":["/res/panelsoil/zenith/1x/Museum_Front-A5.png",2048,-261.36703124942926],"Museum_Front-B5":["/res/panelsoil/zenith/1x/Museum_Front-B5.png",2048,-241.9782275987339],"Museum_Front-A6":["/res/panelsoil/zenith/1x/Museum_Front-A6.png",2048,-227.3380690988996],"Museum_Front-B6":["/res/panelsoil/zenith/1x/Museum_Front-B6.png",2048,-221.42280006614587],"Museum_Front-A7":["/res/panelsoil/zenith/1x/Museum_Front-A7.png",2048,-207.03044397897852],"Museum_Front-B7":["/res/panelsoil/zenith/1x/Museum_Front-B7.png",2048,-196.89296777998518],"Museum_Front-A8":["/res/panelsoil/zenith/1x/Museum_Front-A8.png",2048,-166.90793050155597],"Museum_Front-B8":["/res/panelsoil/zenith/1x/Museum_Front-B8.png",2048,-165.23495410864868],"Office_A1-A1":["/res/panelsoil/zenith/1x/Office_A1-A1.png",2048,-142.30325061521162],"Office_A1-B1":["/res/panelsoil/zenith/1x/Office_A1-B1.png",2048,-143.97837377415306],"Office_A1-A2":["/res/panelsoil/zenith/1x/Office_A1-A2.png",2048,-110.85900015026219],"Office_A1-B2":["/res/panelsoil/zenith/1x/Office_A1-B2.png",2048,-108.58262882908922],"Office_A1-A3":["/res/panelsoil/zenith/1x/Office_A1-A3.png",2048,-104.99915291781129],"Office_A1-B3":["/res/panelsoil/zenith/1x/Office_A1-B3.png",2048,-93.46985132268932],"Office_A1-A4":["/res/panelsoil/zenith/1x/Office_A1-A4.png",2048,-58.11047608482373],"Office_A1-B4":["/res/panelsoil/zenith/1x/Office_A1-B4.png",2048,-66.72297146561866],"Office_B1-A1":["/res/panelsoil/zenith/1x/Office_B1-A1.png",2048,-52.25124058072517],"Office_B1-B1":["/res/panelsoil/zenith/1x/Office_B1-B1.png",2048,-27.072046352905986],"Office_B1-A2":["/res/panelsoil/zenith/1x/Office_B1-A2.png",2048,-30.21799867211812],"Office_B1-B2":["/res/panelsoil/zenith/1x/Office_B1-B2.png",2048,.2672583895991849],"Office_B2-A1":["/res/panelsoil/zenith/1x/Office_B2-A1.png",2048,-45.209009397891094],"Office_B2-B1":["/res/panelsoil/zenith/1x/Office_B2-B1.png",2048,-25.934043645508215],"Office_B2-A2":["/res/panelsoil/zenith/1x/Office_B2-A2.png",2048,-23.137004736322158],"Office_B2-B2":["/res/panelsoil/zenith/1x/Office_B2-B2.png",2048,-6.6117683498954065],"Office_Front-A1":["/res/panelsoil/zenith/1x/Office_Front-A1.png",2048,-146.69173454029317],"Office_Front-B1":["/res/panelsoil/zenith/1x/Office_Front-B1.png",2048,-133.94869189097977],"Office_Front-A2":["/res/panelsoil/zenith/1x/Office_Front-A2.png",2048,-134.06623557000128],"Office_Front-B2":["/res/panelsoil/zenith/1x/Office_Front-B2.png",2048,-115.66211924755109],"Office_Front-A3":["/res/panelsoil/zenith/1x/Office_Front-A3.png",2048,-100.80718087211238],"Office_Front-B3":["/res/panelsoil/zenith/1x/Office_Front-B3.png",2048,-93.29272382255535],"Office_Front-A4":["/res/panelsoil/zenith/1x/Office_Front-A4.png",2048,-73.28677286160568],"Office_Front-B4":["/res/panelsoil/zenith/1x/Office_Front-B4.png",2048,-67.00934314909367],"Office_Front-A5":["/res/panelsoil/zenith/1x/Office_Front-A5.png",2048,-62.42162063039986],"Office_Front-B5":["/res/panelsoil/zenith/1x/Office_Front-B5.png",2048,-44.28503090042945],"Office_Front-A6":["/res/panelsoil/zenith/1x/Office_Front-A6.png",2048,-33.01408859371898],"Office_Front-B6":["/res/panelsoil/zenith/1x/Office_Front-B6.png",2048,-.763732389572418],"Office_Front-A7":["/res/panelsoil/zenith/1x/Office_Front-A7.png",2048,-5.923579370313092],"Office_Front-B7":["/res/panelsoil/zenith/1x/Office_Front-B7.png",2048,13.034445769290514],"Office_Front-A8":["/res/panelsoil/zenith/1x/Office_Front-A8.png",2048,31.41262540032244],"Office_Front-B8":["/res/panelsoil/zenith/1x/Office_Front-B8.png",2048,42.156964301672055],"Platform_Back-A1":["/res/panelsoil/zenith/1x/Platform_Back-A1.png",2048,855.2845695231923],"Platform_Back-B1":["/res/panelsoil/zenith/1x/Platform_Back-B1.png",2048,871.3965790013674],"Platform_Back-A2":["/res/panelsoil/zenith/1x/Platform_Back-A2.png",2048,881.8768104007128],"Platform_Back-B2":["/res/panelsoil/zenith/1x/Platform_Back-B2.png",2048,885.6369449014405],"Platform_Front-A1":["/res/panelsoil/zenith/1x/Platform_Front-A1.png",2048,845.1938926295378],"Platform_Front-B1":["/res/panelsoil/zenith/1x/Platform_Front-B1.png",2048,871.3078548488031],"Platform_Front-A2":["/res/panelsoil/zenith/1x/Platform_Front-A2.png",2048,872.7820515364266],"Platform_Front-B2":["/res/panelsoil/zenith/1x/Platform_Front-B2.png",2048,895.7862985278023]},"2x":{"Arena_A1-A1":["/res/panelsoil/zenith/2x/Arena_A1-A1.png",1024,-94.17506624023524],"Arena_A1-B1":["/res/panelsoil/zenith/2x/Arena_A1-B1.png",1024,-102.45151210286059],"Arena_A1-C1":["/res/panelsoil/zenith/2x/Arena_A1-C1.png",1024,-89.60573050208072],"Arena_A1-D1":["/res/panelsoil/zenith/2x/Arena_A1-D1.png",1024,-91.6709114593479],"Arena_A1-A2":["/res/panelsoil/zenith/2x/Arena_A1-A2.png",1024,-91.85876310256508],"Arena_A1-B2":["/res/panelsoil/zenith/2x/Arena_A1-B2.png",1024,-87.24120104809408],"Arena_A1-C2":["/res/panelsoil/zenith/2x/Arena_A1-C2.png",1024,-85.44944630681051],"Arena_A1-D2":["/res/panelsoil/zenith/2x/Arena_A1-D2.png",1024,-79.90579721978605],"Arena_A1-A3":["/res/panelsoil/zenith/2x/Arena_A1-A3.png",1024,-81.04688158306554],"Arena_A1-B3":["/res/panelsoil/zenith/2x/Arena_A1-B3.png",1024,-72.10082092315834],"Arena_A1-C3":["/res/panelsoil/zenith/2x/Arena_A1-C3.png",1024,-64.5541568598089],"Arena_A1-D3":["/res/panelsoil/zenith/2x/Arena_A1-D3.png",1024,-69.36232504677508],"Arena_A1-A4":["/res/panelsoil/zenith/2x/Arena_A1-A4.png",1024,-62.87550535733181],"Arena_A1-B4":["/res/panelsoil/zenith/2x/Arena_A1-B4.png",1024,-54.881689562190715],"Arena_A1-C4":["/res/panelsoil/zenith/2x/Arena_A1-C4.png",1024,-50.036012596461475],"Arena_A1-D4":["/res/panelsoil/zenith/2x/Arena_A1-D4.png",1024,-50.01225082103183],"Arena_A1-A5":["/res/panelsoil/zenith/2x/Arena_A1-A5.png",1024,-44.26076902621391],"Arena_A1-B5":["/res/panelsoil/zenith/2x/Arena_A1-B5.png",1024,-50.67192544209242],"Arena_A1-C5":["/res/panelsoil/zenith/2x/Arena_A1-C5.png",1024,-49.34745312833827],"Arena_A1-D5":["/res/panelsoil/zenith/2x/Arena_A1-D5.png",1024,-44.4422467687523],"Arena_B1-A1":["/res/panelsoil/zenith/2x/Arena_B1-A1.png",1024,-50.92464078029808],"Arena_B1-B1":["/res/panelsoil/zenith/2x/Arena_B1-B1.png",1024,-41.12853390020983],"Arena_B1-C1":["/res/panelsoil/zenith/2x/Arena_B1-C1.png",1024,-44.15944099869237],"Arena_B1-D1":["/res/panelsoil/zenith/2x/Arena_B1-D1.png",1024,-34.917881693593316],"Arena_B1-A2":["/res/panelsoil/zenith/2x/Arena_B1-A2.png",1024,-36.66685832960262],"Arena_B1-B2":["/res/panelsoil/zenith/2x/Arena_B1-B2.png",1024,-27.80337300972257],"Arena_B1-C2":["/res/panelsoil/zenith/2x/Arena_B1-C2.png",1024,-27.532551982204634],"Arena_B1-D2":["/res/panelsoil/zenith/2x/Arena_B1-D2.png",1024,-27.978809106588198],"Arena_B1-A3":["/res/panelsoil/zenith/2x/Arena_B1-A3.png",1024,-24.70071524266034],"Arena_B1-B3":["/res/panelsoil/zenith/2x/Arena_B1-B3.png",1024,-18.02081075226583],"Arena_B1-C3":["/res/panelsoil/zenith/2x/Arena_B1-C3.png",1024,-7.8713659049294105],"Arena_B1-D3":["/res/panelsoil/zenith/2x/Arena_B1-D3.png",1024,-9.060994697957707],"Arena_B1-A4":["/res/panelsoil/zenith/2x/Arena_B1-A4.png",1024,-4.250124387164831],"Arena_B1-B4":["/res/panelsoil/zenith/2x/Arena_B1-B4.png",1024,1.6650554516072678],"Arena_B1-C4":["/res/panelsoil/zenith/2x/Arena_B1-C4.png",1024,1.0482695499292252],"Arena_B1-D4":["/res/panelsoil/zenith/2x/Arena_B1-D4.png",1024,.8533305656924819],"Arena_B1-A5":["/res/panelsoil/zenith/2x/Arena_B1-A5.png",1024,6.102363053766801],"Arena_B1-B5":["/res/panelsoil/zenith/2x/Arena_B1-B5.png",1024,2.2982435788127216],"Arena_B1-C5":["/res/panelsoil/zenith/2x/Arena_B1-C5.png",1024,13.785179524134005],"Arena_B1-D5":["/res/panelsoil/zenith/2x/Arena_B1-D5.png",1024,15.996119831990473],"Arena_B2-A1":["/res/panelsoil/zenith/2x/Arena_B2-A1.png",1024,-44.91993612994293],"Arena_B2-B1":["/res/panelsoil/zenith/2x/Arena_B2-B1.png",1024,-45.067407694341625],"Arena_B2-C1":["/res/panelsoil/zenith/2x/Arena_B2-C1.png",1024,-34.13936260323553],"Arena_B2-D1":["/res/panelsoil/zenith/2x/Arena_B2-D1.png",1024,-32.040735539170896],"Arena_B2-A2":["/res/panelsoil/zenith/2x/Arena_B2-A2.png",1024,-32.28808078818133],"Arena_B2-B2":["/res/panelsoil/zenith/2x/Arena_B2-B2.png",1024,-32.56031624536317],"Arena_B2-C2":["/res/panelsoil/zenith/2x/Arena_B2-C2.png",1024,-23.6086111530277],"Arena_B2-D2":["/res/panelsoil/zenith/2x/Arena_B2-D2.png",1024,-27.927366221014726],"Arena_B2-A3":["/res/panelsoil/zenith/2x/Arena_B2-A3.png",1024,-22.753993984406193],"Arena_B2-B3":["/res/panelsoil/zenith/2x/Arena_B2-B3.png",1024,-17.812576272174784],"Arena_B2-C3":["/res/panelsoil/zenith/2x/Arena_B2-C3.png",1024,-12.548466172270649],"Arena_B2-D3":["/res/panelsoil/zenith/2x/Arena_B2-D3.png",1024,-16.62231215343865],"Arena_B3-A1":["/res/panelsoil/zenith/2x/Arena_B3-A1.png",1024,-34.13998419703324],"Arena_B3-B1":["/res/panelsoil/zenith/2x/Arena_B3-B1.png",1024,-27.91161079333922],"Arena_B3-C1":["/res/panelsoil/zenith/2x/Arena_B3-C1.png",1024,-32.83135496789431],"Arena_B3-D1":["/res/panelsoil/zenith/2x/Arena_B3-D1.png",1024,-23.892364353758392],"Arena_B3-A2":["/res/panelsoil/zenith/2x/Arena_B3-A2.png",1024,-26.604014097597936],"Arena_B3-B2":["/res/panelsoil/zenith/2x/Arena_B3-B2.png",1024,-22.396561115701655],"Arena_B3-C2":["/res/panelsoil/zenith/2x/Arena_B3-C2.png",1024,-10.128857655332595],"Arena_B3-D2":["/res/panelsoil/zenith/2x/Arena_B3-D2.png",1024,-12.978511347052283],"Arena_B3-A3":["/res/panelsoil/zenith/2x/Arena_B3-A3.png",1024,-14.21752357822287],"Arena_B3-C3":["/res/panelsoil/zenith/2x/Arena_B3-C3.png",1024,3.491502367260331],"Arena_B3-D3":["/res/panelsoil/zenith/2x/Arena_B3-D3.png",1024,5.782692244959257],"Arena_B3-A4":["/res/panelsoil/zenith/2x/Arena_B3-A4.png",1024,-.3300531923567753],"Arena_B3-D4":["/res/panelsoil/zenith/2x/Arena_B3-D4.png",1024,11.5018746436292],"Arena_B3-A5":["/res/panelsoil/zenith/2x/Arena_B3-A5.png",1024,15.444265420089039],"Arena_B3-D5":["/res/panelsoil/zenith/2x/Arena_B3-D5.png",1024,26.324643491377884],"Arena_C1-B1":["/res/panelsoil/zenith/2x/Arena_C1-B1.png",1024,29.85429953942932],"Arena_C1-C1":["/res/panelsoil/zenith/2x/Arena_C1-C1.png",1024,40.99231590442686],"Arena_C1-B2":["/res/panelsoil/zenith/2x/Arena_C1-B2.png",1024,48.11799816547735],"Arena_C1-C2":["/res/panelsoil/zenith/2x/Arena_C1-C2.png",1024,50.56108102938489],"Arena_Front-A1":["/res/panelsoil/zenith/2x/Arena_Front-A1.png",1024,-104.07036391041017],"Arena_Front-B1":["/res/panelsoil/zenith/2x/Arena_Front-B1.png",1024,-91.18349266895902],"Arena_Front-C1":["/res/panelsoil/zenith/2x/Arena_Front-C1.png",1024,-94.5723120645956],"Arena_Front-D1":["/res/panelsoil/zenith/2x/Arena_Front-D1.png",1024,-85.3695550000634],"Arena_Front-A2":["/res/panelsoil/zenith/2x/Arena_Front-A2.png",1024,-89.08389828269347],"Arena_Front-B2":["/res/panelsoil/zenith/2x/Arena_Front-B2.png",1024,-80.38803279903138],"Arena_Front-C2":["/res/panelsoil/zenith/2x/Arena_Front-C2.png",1024,-76.34142128118397],"Arena_Front-D2":["/res/panelsoil/zenith/2x/Arena_Front-D2.png",1024,-79.32838004501423],"Arena_Front-A3":["/res/panelsoil/zenith/2x/Arena_Front-A3.png",1024,-69.48657117773719],"Arena_Front-B3":["/res/panelsoil/zenith/2x/Arena_Front-B3.png",1024,-68.09194333157551],"Arena_Front-C3":["/res/panelsoil/zenith/2x/Arena_Front-C3.png",1024,-68.15989808224201],"Arena_Front-D3":["/res/panelsoil/zenith/2x/Arena_Front-D3.png",1024,-64.45673579285148],"Arena_Front-A4":["/res/panelsoil/zenith/2x/Arena_Front-A4.png",1024,-57.290601815999146],"Arena_Front-B4":["/res/panelsoil/zenith/2x/Arena_Front-B4.png",1024,-58.32086815035504],"Arena_Front-C4":["/res/panelsoil/zenith/2x/Arena_Front-C4.png",1024,-61.24700099135249],"Arena_Front-D4":["/res/panelsoil/zenith/2x/Arena_Front-D4.png",1024,-51.337133111470365],"Arena_Front-A5":["/res/panelsoil/zenith/2x/Arena_Front-A5.png",1024,-51.175984956377576],"Arena_Front-B5":["/res/panelsoil/zenith/2x/Arena_Front-B5.png",1024,-48.22662226419867],"Arena_Front-C5":["/res/panelsoil/zenith/2x/Arena_Front-C5.png",1024,-43.556664137252255],"Arena_Front-D5":["/res/panelsoil/zenith/2x/Arena_Front-D5.png",1024,-45.93920565352982],"Arena_Front-A6":["/res/panelsoil/zenith/2x/Arena_Front-A6.png",1024,-35.466192328188754],"Arena_Front-B6":["/res/panelsoil/zenith/2x/Arena_Front-B6.png",1024,-36.43090585591729],"Arena_Front-C6":["/res/panelsoil/zenith/2x/Arena_Front-C6.png",1024,-27.362912591483205],"Arena_Front-D6":["/res/panelsoil/zenith/2x/Arena_Front-D6.png",1024,-27.191816215725716],"Arena_Front-A7":["/res/panelsoil/zenith/2x/Arena_Front-A7.png",1024,-23.557995626118572],"Arena_Front-B7":["/res/panelsoil/zenith/2x/Arena_Front-B7.png",1024,-24.532579962250228],"Arena_Front-C7":["/res/panelsoil/zenith/2x/Arena_Front-C7.png",1024,-15.481071040811292],"Arena_Front-D7":["/res/panelsoil/zenith/2x/Arena_Front-D7.png",1024,-16.140030335651648],"Arena_Front-A8":["/res/panelsoil/zenith/2x/Arena_Front-A8.png",1024,-8.01118251148793],"Arena_Front-D8":["/res/panelsoil/zenith/2x/Arena_Front-D8.png",1024,-5.234773489986141],"Arena_Front-A9":["/res/panelsoil/zenith/2x/Arena_Front-A9.png",1024,-1.8773602865253203],"Arena_Front-B9":["/res/panelsoil/zenith/2x/Arena_Front-B9.png",1024,-.10872007982345178],"Arena_Front-C9":["/res/panelsoil/zenith/2x/Arena_Front-C9.png",1024,4.685038675868963],"Arena_Front-D9":["/res/panelsoil/zenith/2x/Arena_Front-D9.png",1024,12.20835126114791],"Arena_Front-A10":["/res/panelsoil/zenith/2x/Arena_Front-A10.png",1024,7.854659512862181],"Arena_Front-B10":["/res/panelsoil/zenith/2x/Arena_Front-B10.png",1024,13.203273461761263],"Arena_Front-C10":["/res/panelsoil/zenith/2x/Arena_Front-C10.png",1024,20.70265169530562],"Arena_Front-D10":["/res/panelsoil/zenith/2x/Arena_Front-D10.png",1024,17.863337786162194],"Arena_Front-A11":["/res/panelsoil/zenith/2x/Arena_Front-A11.png",1024,23.472109312567504],"Arena_Front-B11":["/res/panelsoil/zenith/2x/Arena_Front-B11.png",1024,23.451106885598502],"Arena_Front-C11":["/res/panelsoil/zenith/2x/Arena_Front-C11.png",1024,33.92787122952013],"Arena_Front-D11":["/res/panelsoil/zenith/2x/Arena_Front-D11.png",1024,31.998325661782964],"Arena_Front-A12":["/res/panelsoil/zenith/2x/Arena_Front-A12.png",1024,41.52568157276083],"Arena_Front-B12":["/res/panelsoil/zenith/2x/Arena_Front-B12.png",1024,34.86654399421511],"Arena_Front-C12":["/res/panelsoil/zenith/2x/Arena_Front-C12.png",1024,46.92211463453417],"Arena_Front-D12":["/res/panelsoil/zenith/2x/Arena_Front-D12.png",1024,48.636110772876904],"Casino_A1-A1":["/res/panelsoil/zenith/2x/Casino_A1-A1.png",1024,-252.5120127807477],"Casino_A1-B1":["/res/panelsoil/zenith/2x/Casino_A1-B1.png",1024,-248.5198762445763],"Casino_A1-C1":["/res/panelsoil/zenith/2x/Casino_A1-C1.png",1024,-247.6255605530584],"Casino_A1-A2":["/res/panelsoil/zenith/2x/Casino_A1-A2.png",1024,-240.00194220683935],"Casino_A1-B2":["/res/panelsoil/zenith/2x/Casino_A1-B2.png",1024,-236.23229157964784],"Casino_A1-C2":["/res/panelsoil/zenith/2x/Casino_A1-C2.png",1024,-231.97400772350446],"Casino_A1-A3":["/res/panelsoil/zenith/2x/Casino_A1-A3.png",1024,-229.84479796780008],"Casino_A1-B3":["/res/panelsoil/zenith/2x/Casino_A1-B3.png",1024,-221.5039956226853],"Casino_A1-C3":["/res/panelsoil/zenith/2x/Casino_A1-C3.png",1024,-217.9990002912889],"Casino_A1-A4":["/res/panelsoil/zenith/2x/Casino_A1-A4.png",1024,-209.27291984621],"Casino_A1-B4":["/res/panelsoil/zenith/2x/Casino_A1-B4.png",1024,-205.24718647211012],"Casino_A1-C4":["/res/panelsoil/zenith/2x/Casino_A1-C4.png",1024,-203.5633038333474],"Casino_A1-A5":["/res/panelsoil/zenith/2x/Casino_A1-A5.png",1024,-205.3252233097865],"Casino_A1-B5":["/res/panelsoil/zenith/2x/Casino_A1-B5.png",1024,-196.1235947015661],"Casino_A1-C5":["/res/panelsoil/zenith/2x/Casino_A1-C5.png",1024,-192.87694186718505],"Casino_A1-A6":["/res/panelsoil/zenith/2x/Casino_A1-A6.png",1024,-187.87114710215627],"Casino_A1-B6":["/res/panelsoil/zenith/2x/Casino_A1-B6.png",1024,-188.31947938676487],"Casino_A1-C6":["/res/panelsoil/zenith/2x/Casino_A1-C6.png",1024,-176.90796532489506],"Casino_A1-A7":["/res/panelsoil/zenith/2x/Casino_A1-A7.png",1024,-171.91378528294112],"Casino_A1-B7":["/res/panelsoil/zenith/2x/Casino_A1-B7.png",1024,-170.79144425613896],"Casino_A1-C7":["/res/panelsoil/zenith/2x/Casino_A1-C7.png",1024,-170.766840262564],"Casino_A1b-A1":["/res/panelsoil/zenith/2x/Casino_A1b-A1.png",1024,-247.1740259801876],"Casino_A1b-D1":["/res/panelsoil/zenith/2x/Casino_A1b-D1.png",1024,-242.3608297385482],"Casino_A1b-A2":["/res/panelsoil/zenith/2x/Casino_A1b-A2.png",1024,-239.42825237133047],"Casino_A1b-D2":["/res/panelsoil/zenith/2x/Casino_A1b-D2.png",1024,-228.24761498750365],"Casino_A1b-A3":["/res/panelsoil/zenith/2x/Casino_A1b-A3.png",1024,-221.3954881987472],"Casino_A1b-D3":["/res/panelsoil/zenith/2x/Casino_A1b-D3.png",1024,-217.68946814647109],"Casino_A1b-A4":["/res/panelsoil/zenith/2x/Casino_A1b-A4.png",1024,-218.3640143161516],"Casino_A1b-D4":["/res/panelsoil/zenith/2x/Casino_A1b-D4.png",1024,-199.29534850994355],"Casino_A1b-A5":["/res/panelsoil/zenith/2x/Casino_A1b-A5.png",1024,-203.5315320003698],"Casino_A1b-D5":["/res/panelsoil/zenith/2x/Casino_A1b-D5.png",1024,-189.75878744095232],"Casino_A1b-A6":["/res/panelsoil/zenith/2x/Casino_A1b-A6.png",1024,-187.99933071805611],"Casino_A1b-D6":["/res/panelsoil/zenith/2x/Casino_A1b-D6.png",1024,-183.64021790059027],"Casino_B1-A1":["/res/panelsoil/zenith/2x/Casino_B1-A1.png",1024,-131.52969412280652],"Casino_B1-B1":["/res/panelsoil/zenith/2x/Casino_B1-B1.png",1024,-130.04449612435116],"Casino_B1-C1":["/res/panelsoil/zenith/2x/Casino_B1-C1.png",1024,-126.47424149022346],"Casino_B1-D1":["/res/panelsoil/zenith/2x/Casino_B1-D1.png",1024,-121.75252069191683],"Casino_B1-A2":["/res/panelsoil/zenith/2x/Casino_B1-A2.png",1024,-115.72060526982997],"Casino_B1-B2":["/res/panelsoil/zenith/2x/Casino_B1-B2.png",1024,-114.19360875208763],"Casino_B1-C2":["/res/panelsoil/zenith/2x/Casino_B1-C2.png",1024,-114.08813816454843],"Casino_B1-D2":["/res/panelsoil/zenith/2x/Casino_B1-D2.png",1024,-106.81255834974316],"Casino_B1-A3":["/res/panelsoil/zenith/2x/Casino_B1-A3.png",1024,-109.04941547899337],"Casino_B1-B3":["/res/panelsoil/zenith/2x/Casino_B1-B3.png",1024,-106.11736966735992],"Casino_B1-C3":["/res/panelsoil/zenith/2x/Casino_B1-C3.png",1024,-107.37317519883868],"Casino_B1-D3":["/res/panelsoil/zenith/2x/Casino_B1-D3.png",1024,-103.19863533757959],"Casino_B1-A4":["/res/panelsoil/zenith/2x/Casino_B1-A4.png",1024,-95.19404241549759],"Casino_B1-B4":["/res/panelsoil/zenith/2x/Casino_B1-B4.png",1024,-92.30574812528796],"Casino_B1-C4":["/res/panelsoil/zenith/2x/Casino_B1-C4.png",1024,-94.4988266276208],"Casino_B1-D4":["/res/panelsoil/zenith/2x/Casino_B1-D4.png",1024,-86.42136335083534],"Casino_B2-A1":["/res/panelsoil/zenith/2x/Casino_B2-A1.png",1024,-137.38925799290888],"Casino_B2-B1":["/res/panelsoil/zenith/2x/Casino_B2-B1.png",1024,-125.98298448586631],"Casino_B2-C1":["/res/panelsoil/zenith/2x/Casino_B2-C1.png",1024,-128.09821451615693],"Casino_B2-D1":["/res/panelsoil/zenith/2x/Casino_B2-D1.png",1024,-117.5898921583474],"Casino_B2-A2":["/res/panelsoil/zenith/2x/Casino_B2-A2.png",1024,-123.88696890192044],"Casino_B2-B2":["/res/panelsoil/zenith/2x/Casino_B2-B2.png",1024,-111.39394624301573],"Casino_B2-C2":["/res/panelsoil/zenith/2x/Casino_B2-C2.png",1024,-109.02933322659158],"Casino_B2-D2":["/res/panelsoil/zenith/2x/Casino_B2-D2.png",1024,-117.07547758713584],"Casino_B2-A3":["/res/panelsoil/zenith/2x/Casino_B2-A3.png",1024,-113.99150521733806],"Casino_B2-B3":["/res/panelsoil/zenith/2x/Casino_B2-B3.png",1024,-103.84857584894812],"Casino_B2-C3":["/res/panelsoil/zenith/2x/Casino_B2-C3.png",1024,-98.72595212126421],"Casino_B2-D3":["/res/panelsoil/zenith/2x/Casino_B2-D3.png",1024,-98.85970621175207],"Casino_Front-A1":["/res/panelsoil/zenith/2x/Casino_Front-A1.png",1024,-250.3829357299422],"Casino_Front-B1":["/res/panelsoil/zenith/2x/Casino_Front-B1.png",1024,-252.36555071967095],"Casino_Front-C1":["/res/panelsoil/zenith/2x/Casino_Front-C1.png",1024,-239.76293407607892],"Casino_Front-D1":["/res/panelsoil/zenith/2x/Casino_Front-D1.png",1024,-238.37469750877807],"Casino_Front-A2":["/res/panelsoil/zenith/2x/Casino_Front-A2.png",1024,-236.02888899874287],"Casino_Front-B2":["/res/panelsoil/zenith/2x/Casino_Front-B2.png",1024,-231.79422092552178],"Casino_Front-C2":["/res/panelsoil/zenith/2x/Casino_Front-C2.png",1024,-236.9079259756669],"Casino_Front-D2":["/res/panelsoil/zenith/2x/Casino_Front-D2.png",1024,-231.1860576638087],"Casino_Front-A3":["/res/panelsoil/zenith/2x/Casino_Front-A3.png",1024,-222.50252218048428],"Casino_Front-B3":["/res/panelsoil/zenith/2x/Casino_Front-B3.png",1024,-225.10605780568525],"Casino_Front-C3":["/res/panelsoil/zenith/2x/Casino_Front-C3.png",1024,-212.68425666021963],"Casino_Front-D3":["/res/panelsoil/zenith/2x/Casino_Front-D3.png",1024,-211.69848282879332],"Casino_Front-A4":["/res/panelsoil/zenith/2x/Casino_Front-A4.png",1024,-215.93384729932527],"Casino_Front-B4":["/res/panelsoil/zenith/2x/Casino_Front-B4.png",1024,-208.304820232021],"Casino_Front-C4":["/res/panelsoil/zenith/2x/Casino_Front-C4.png",1024,-210.9144351663721],"Casino_Front-D4":["/res/panelsoil/zenith/2x/Casino_Front-D4.png",1024,-206.36029462221256],"Casino_Front-A5":["/res/panelsoil/zenith/2x/Casino_Front-A5.png",1024,-193.944429037174],"Casino_Front-B5":["/res/panelsoil/zenith/2x/Casino_Front-B5.png",1024,-199.88927615345355],"Casino_Front-C5":["/res/panelsoil/zenith/2x/Casino_Front-C5.png",1024,-188.75359245530657],"Casino_Front-D5":["/res/panelsoil/zenith/2x/Casino_Front-D5.png",1024,-185.48183396191567],"Casino_Front-A6":["/res/panelsoil/zenith/2x/Casino_Front-A6.png",1024,-186.47375166176724],"Casino_Front-B6":["/res/panelsoil/zenith/2x/Casino_Front-B6.png",1024,-178.96260086832157],"Casino_Front-C6":["/res/panelsoil/zenith/2x/Casino_Front-C6.png",1024,-176.37433172189327],"Casino_Front-D6":["/res/panelsoil/zenith/2x/Casino_Front-D6.png",1024,-180.65363130761634],"Casino_Front-A7":["/res/panelsoil/zenith/2x/Casino_Front-A7.png",1024,-180.73466174897214],"Casino_Front-B7":["/res/panelsoil/zenith/2x/Casino_Front-B7.png",1024,-167.68010619957505],"Casino_Front-C7":["/res/panelsoil/zenith/2x/Casino_Front-C7.png",1024,-173.28245939988312],"Casino_Front-D7":["/res/panelsoil/zenith/2x/Casino_Front-D7.png",1024,-162.3595935051112],"Casino_Front-A8":["/res/panelsoil/zenith/2x/Casino_Front-A8.png",1024,-165.26251934335576],"Casino_Front-B8":["/res/panelsoil/zenith/2x/Casino_Front-B8.png",1024,-155.04917299195185],"Casino_Front-C8":["/res/panelsoil/zenith/2x/Casino_Front-C8.png",1024,-160.98682805298762],"Casino_Front-D8":["/res/panelsoil/zenith/2x/Casino_Front-D8.png",1024,-147.4518713409167],"Casino_Front-A9":["/res/panelsoil/zenith/2x/Casino_Front-A9.png",1024,-146.58986004641503],"Casino_Front-B9":["/res/panelsoil/zenith/2x/Casino_Front-B9.png",1024,-141.75901306626002],"Casino_Front-C9":["/res/panelsoil/zenith/2x/Casino_Front-C9.png",1024,-138.63128092453033],"Casino_Front-D9":["/res/panelsoil/zenith/2x/Casino_Front-D9.png",1024,-138.63309672540018],"Casino_Front-A10":["/res/panelsoil/zenith/2x/Casino_Front-A10.png",1024,-136.58339854532406],"Casino_Front-B10":["/res/panelsoil/zenith/2x/Casino_Front-B10.png",1024,-136.06277495051123],"Casino_Front-C10":["/res/panelsoil/zenith/2x/Casino_Front-C10.png",1024,-134.35861831532992],"Casino_Front-D10":["/res/panelsoil/zenith/2x/Casino_Front-D10.png",1024,-129.79214004658976],"Casino_Front-A11":["/res/panelsoil/zenith/2x/Casino_Front-A11.png",1024,-126.24361890463354],"Casino_Front-B11":["/res/panelsoil/zenith/2x/Casino_Front-B11.png",1024,-124.86700493668906],"Casino_Front-C11":["/res/panelsoil/zenith/2x/Casino_Front-C11.png",1024,-121.19620827815282],"Casino_Front-D11":["/res/panelsoil/zenith/2x/Casino_Front-D11.png",1024,-115.60872709936211],"Casino_Front-A12":["/res/panelsoil/zenith/2x/Casino_Front-A12.png",1024,-107.64110359483597],"Casino_Front-B12":["/res/panelsoil/zenith/2x/Casino_Front-B12.png",1024,-112.9437560841655],"Casino_Front-C12":["/res/panelsoil/zenith/2x/Casino_Front-C12.png",1024,-104.79902135637566],"Casino_Front-D12":["/res/panelsoil/zenith/2x/Casino_Front-D12.png",1024,-101.83140457883708],"Core_A1-A1":["/res/panelsoil/zenith/2x/Core_A1-A1.png",1024,722.4621304340187],"Core_A1-B1":["/res/panelsoil/zenith/2x/Core_A1-B1.png",1024,721.4627332894179],"Core_A1-C1":["/res/panelsoil/zenith/2x/Core_A1-C1.png",1024,721.6300279309334],"Core_A1-D1":["/res/panelsoil/zenith/2x/Core_A1-D1.png",1024,720.5476946024314],"Core_A1-A2":["/res/panelsoil/zenith/2x/Core_A1-A2.png",1024,733.7420230841071],"Core_A1-B2":["/res/panelsoil/zenith/2x/Core_A1-B2.png",1024,735.1591472453446],"Core_A1-C2":["/res/panelsoil/zenith/2x/Core_A1-C2.png",1024,736.9770286455371],"Core_A1-D2":["/res/panelsoil/zenith/2x/Core_A1-D2.png",1024,744.6240689649665],"Core_A1-A3":["/res/panelsoil/zenith/2x/Core_A1-A3.png",1024,744.6799527607659],"Core_A1-B3":["/res/panelsoil/zenith/2x/Core_A1-B3.png",1024,739.8969832398666],"Core_A1-C3":["/res/panelsoil/zenith/2x/Core_A1-C3.png",1024,752.0924066078192],"Core_A1-D3":["/res/panelsoil/zenith/2x/Core_A1-D3.png",1024,754.0886570645874],"Core_A1-A4":["/res/panelsoil/zenith/2x/Core_A1-A4.png",1024,752.2963316020681],"Core_A1-B4":["/res/panelsoil/zenith/2x/Core_A1-B4.png",1024,757.5327105622148],"Core_A1-C4":["/res/panelsoil/zenith/2x/Core_A1-C4.png",1024,762.2558423513588],"Core_A1-D4":["/res/panelsoil/zenith/2x/Core_A1-D4.png",1024,762.8490469156385],"Core_A1-A5":["/res/panelsoil/zenith/2x/Core_A1-A5.png",1024,763.9944949631549],"Core_A1-B5":["/res/panelsoil/zenith/2x/Core_A1-B5.png",1024,766.8103530412395],"Core_A1-C5":["/res/panelsoil/zenith/2x/Core_A1-C5.png",1024,768.832429109544],"Core_A1-D5":["/res/panelsoil/zenith/2x/Core_A1-D5.png",1024,773.4332833184923],"Core_A1-A6":["/res/panelsoil/zenith/2x/Core_A1-A6.png",1024,773.8081579005981],"Core_A1-B6":["/res/panelsoil/zenith/2x/Core_A1-B6.png",1024,777.3573357493776],"Core_A1-C6":["/res/panelsoil/zenith/2x/Core_A1-C6.png",1024,789.2834182389612],"Core_A1-D6":["/res/panelsoil/zenith/2x/Core_A1-D6.png",1024,784.8909837394518],"Core_A1-A7":["/res/panelsoil/zenith/2x/Core_A1-A7.png",1024,786.9575185692],"Core_A1-B7":["/res/panelsoil/zenith/2x/Core_A1-B7.png",1024,796.1835809329427],"Core_A1-C7":["/res/panelsoil/zenith/2x/Core_A1-C7.png",1024,796.7101481665358],"Core_A1-D7":["/res/panelsoil/zenith/2x/Core_A1-D7.png",1024,806.6184312105655],"Core_A1-A8":["/res/panelsoil/zenith/2x/Core_A1-A8.png",1024,803.259576570883],"Core_A1-B8":["/res/panelsoil/zenith/2x/Core_A1-B8.png",1024,801.5630221891885],"Core_A1-C8":["/res/panelsoil/zenith/2x/Core_A1-C8.png",1024,805.1613662978019],"Core_A1-D8":["/res/panelsoil/zenith/2x/Core_A1-D8.png",1024,816.7068982087054],"Core_B1-A1":["/res/panelsoil/zenith/2x/Core_B1-A1.png",1024,811.2611810975676],"Core_B1-B1":["/res/panelsoil/zenith/2x/Core_B1-B1.png",1024,804.608170758401],"Core_B1-C1":["/res/panelsoil/zenith/2x/Core_B1-C1.png",1024,809.6167540683686],"Core_B1-D1":["/res/panelsoil/zenith/2x/Core_B1-D1.png",1024,816.1247815665271],"Core_B1-A2":["/res/panelsoil/zenith/2x/Core_B1-A2.png",1024,814.5441618797062],"Core_B1-B2":["/res/panelsoil/zenith/2x/Core_B1-B2.png",1024,820.5805416284732],"Core_B1-C2":["/res/panelsoil/zenith/2x/Core_B1-C2.png",1024,821.4376313957514],"Core_B1-D2":["/res/panelsoil/zenith/2x/Core_B1-D2.png",1024,829.2359060712724],"Core_B1-A3":["/res/panelsoil/zenith/2x/Core_B1-A3.png",1024,837.4047961630667],"Core_B1-B3":["/res/panelsoil/zenith/2x/Core_B1-B3.png",1024,837.7826844959268],"Core_B1-C3":["/res/panelsoil/zenith/2x/Core_B1-C3.png",1024,841.062930762745],"Core_B1-D3":["/res/panelsoil/zenith/2x/Core_B1-D3.png",1024,837.1271515372546],"Core_B1-A4":["/res/panelsoil/zenith/2x/Core_B1-A4.png",1024,844.4086095877431],"Core_B1-B4":["/res/panelsoil/zenith/2x/Core_B1-B4.png",1024,850.7931725275946],"Core_B1-C4":["/res/panelsoil/zenith/2x/Core_B1-C4.png",1024,845.8551930257509],"Core_B1-D4":["/res/panelsoil/zenith/2x/Core_B1-D4.png",1024,851.0725484730191],"Core_B1-A5":["/res/panelsoil/zenith/2x/Core_B1-A5.png",1024,860.1426021656088],"Core_B1-B5":["/res/panelsoil/zenith/2x/Core_B1-B5.png",1024,860.111852667554],"Core_B1-C5":["/res/panelsoil/zenith/2x/Core_B1-C5.png",1024,857.5065064278947],"Core_B1-D5":["/res/panelsoil/zenith/2x/Core_B1-D5.png",1024,869.9739355081355],"Core_B1-A6":["/res/panelsoil/zenith/2x/Core_B1-A6.png",1024,870.5114049036368],"Core_B1-B6":["/res/panelsoil/zenith/2x/Core_B1-B6.png",1024,870.7283116820455],"Core_B1-C6":["/res/panelsoil/zenith/2x/Core_B1-C6.png",1024,878.3236175078241],"Core_B1-D6":["/res/panelsoil/zenith/2x/Core_B1-D6.png",1024,878.6709980173797],"Core_B2-A1":["/res/panelsoil/zenith/2x/Core_B2-A1.png",1024,845.5710195411706],"Core_B2-B1":["/res/panelsoil/zenith/2x/Core_B2-B1.png",1024,844.9084388536077],"Core_B2-C1":["/res/panelsoil/zenith/2x/Core_B2-C1.png",1024,841.1070434015501],"Core_B2-D1":["/res/panelsoil/zenith/2x/Core_B2-D1.png",1024,846.6487267264254],"Core_B2-A2":["/res/panelsoil/zenith/2x/Core_B2-A2.png",1024,850.4700416845704],"Core_B2-B2":["/res/panelsoil/zenith/2x/Core_B2-B2.png",1024,854.6740517739332],"Core_B2-C2":["/res/panelsoil/zenith/2x/Core_B2-C2.png",1024,852.585239457749],"Core_B2-D2":["/res/panelsoil/zenith/2x/Core_B2-D2.png",1024,855.7050198677797],"Core_B2-A3":["/res/panelsoil/zenith/2x/Core_B2-A3.png",1024,863.8445228447879],"Core_B2-B3":["/res/panelsoil/zenith/2x/Core_B2-B3.png",1024,872.0922892116472],"Core_B2-C3":["/res/panelsoil/zenith/2x/Core_B2-C3.png",1024,870.9597861202705],"Core_B2-D3":["/res/panelsoil/zenith/2x/Core_B2-D3.png",1024,871.8880899248893],"Core_B2-A4":["/res/panelsoil/zenith/2x/Core_B2-A4.png",1024,880.8562689300087],"Core_B2-B4":["/res/panelsoil/zenith/2x/Core_B2-B4.png",1024,874.7712047496525],"Core_B2-C4":["/res/panelsoil/zenith/2x/Core_B2-C4.png",1024,885.6361881108174],"Core_B2-D4":["/res/panelsoil/zenith/2x/Core_B2-D4.png",1024,891.4534122512493],"Core_C1-B1":["/res/panelsoil/zenith/2x/Core_C1-B1.png",1024,931.8558530101769],"Core_C1-C1":["/res/panelsoil/zenith/2x/Core_C1-C1.png",1024,937.7291856388641],"Core_C1-B2":["/res/panelsoil/zenith/2x/Core_C1-B2.png",1024,941.424267022477],"Core_C1-C2":["/res/panelsoil/zenith/2x/Core_C1-C2.png",1024,947.9352758038273],"Core_Front-A1":["/res/panelsoil/zenith/2x/Core_Front-A1.png",1024,704.8251037867351],"Core_Front-B1":["/res/panelsoil/zenith/2x/Core_Front-B1.png",1024,698.8242162445929],"Core_Front-C1":["/res/panelsoil/zenith/2x/Core_Front-C1.png",1024,700.8444396106335],"Core_Front-D1":["/res/panelsoil/zenith/2x/Core_Front-D1.png",1024,714.9723764742374],"Core_Front-A2":["/res/panelsoil/zenith/2x/Core_Front-A2.png",1024,712.6108190142169],"Core_Front-B2":["/res/panelsoil/zenith/2x/Core_Front-B2.png",1024,710.180171396361],"Core_Front-C2":["/res/panelsoil/zenith/2x/Core_Front-C2.png",1024,719.0454737528173],"Core_Front-D2":["/res/panelsoil/zenith/2x/Core_Front-D2.png",1024,717.3180277742251],"Core_Front-A3":["/res/panelsoil/zenith/2x/Core_Front-A3.png",1024,727.6489229094035],"Core_Front-B3":["/res/panelsoil/zenith/2x/Core_Front-B3.png",1024,722.6155007009248],"Core_Front-C3":["/res/panelsoil/zenith/2x/Core_Front-C3.png",1024,727.7958802898763],"Core_Front-D3":["/res/panelsoil/zenith/2x/Core_Front-D3.png",1024,730.4886430851293],"Core_Front-A4":["/res/panelsoil/zenith/2x/Core_Front-A4.png",1024,737.2729099498282],"Core_Front-B4":["/res/panelsoil/zenith/2x/Core_Front-B4.png",1024,738.8970093317162],"Core_Front-C4":["/res/panelsoil/zenith/2x/Core_Front-C4.png",1024,747.0619483156278],"Core_Front-D4":["/res/panelsoil/zenith/2x/Core_Front-D4.png",1024,744.6931776363449],"Core_Front-A5":["/res/panelsoil/zenith/2x/Core_Front-A5.png",1024,752.6281433490923],"Core_Front-B5":["/res/panelsoil/zenith/2x/Core_Front-B5.png",1024,747.4291502373228],"Core_Front-C5":["/res/panelsoil/zenith/2x/Core_Front-C5.png",1024,761.1931955192309],"Core_Front-D5":["/res/panelsoil/zenith/2x/Core_Front-D5.png",1024,765.4832245053743],"Core_Front-A6":["/res/panelsoil/zenith/2x/Core_Front-A6.png",1024,766.236927853161],"Core_Front-B6":["/res/panelsoil/zenith/2x/Core_Front-B6.png",1024,765.9065853125122],"Core_Front-C6":["/res/panelsoil/zenith/2x/Core_Front-C6.png",1024,764.6044230224343],"Core_Front-D6":["/res/panelsoil/zenith/2x/Core_Front-D6.png",1024,768.8728569794226],"Core_Front-A7":["/res/panelsoil/zenith/2x/Core_Front-A7.png",1024,780.9672438752526],"Core_Front-B7":["/res/panelsoil/zenith/2x/Core_Front-B7.png",1024,778.7869739651668],"Core_Front-C7":["/res/panelsoil/zenith/2x/Core_Front-C7.png",1024,777.8973315663573],"Core_Front-D7":["/res/panelsoil/zenith/2x/Core_Front-D7.png",1024,790.5769188530779],"Core_Front-A8":["/res/panelsoil/zenith/2x/Core_Front-A8.png",1024,782.7312824899305],"Core_Front-C8":["/res/panelsoil/zenith/2x/Core_Front-C8.png",1024,797.8646057952993],"Core_Front-D8":["/res/panelsoil/zenith/2x/Core_Front-D8.png",1024,802.9435995404775],"Core_Front-A9":["/res/panelsoil/zenith/2x/Core_Front-A9.png",1024,799.9464695744762],"Core_Front-B9":["/res/panelsoil/zenith/2x/Core_Front-B9.png",1024,808.1674388022989],"Core_Front-C9":["/res/panelsoil/zenith/2x/Core_Front-C9.png",1024,807.7768534823674],"Core_Front-D9":["/res/panelsoil/zenith/2x/Core_Front-D9.png",1024,803.8074470472617],"Core_Front-A10":["/res/panelsoil/zenith/2x/Core_Front-A10.png",1024,816.7567219316489],"Core_Front-B10":["/res/panelsoil/zenith/2x/Core_Front-B10.png",1024,810.5650308077187],"Core_Front-C10":["/res/panelsoil/zenith/2x/Core_Front-C10.png",1024,821.8094430040401],"Core_Front-D10":["/res/panelsoil/zenith/2x/Core_Front-D10.png",1024,818.8007487449163],"Core_Front-A11":["/res/panelsoil/zenith/2x/Core_Front-A11.png",1024,820.2689198819293],"Core_Front-B11":["/res/panelsoil/zenith/2x/Core_Front-B11.png",1024,825.923265592273],"Core_Front-C11":["/res/panelsoil/zenith/2x/Core_Front-C11.png",1024,829.3301821998646],"Core_Front-D11":["/res/panelsoil/zenith/2x/Core_Front-D11.png",1024,831.6051681351423],"Core_Front-A12":["/res/panelsoil/zenith/2x/Core_Front-A12.png",1024,843.5262395331489],"Core_Front-B12":["/res/panelsoil/zenith/2x/Core_Front-B12.png",1024,839.8077679066721],"Core_Front-C12":["/res/panelsoil/zenith/2x/Core_Front-C12.png",1024,837.6633295291323],"Core_Front-D12":["/res/panelsoil/zenith/2x/Core_Front-D12.png",1024,845.0842935084598],"Core_Front-A13":["/res/panelsoil/zenith/2x/Core_Front-A13.png",1024,855.376146303423],"Core_Front-D13":["/res/panelsoil/zenith/2x/Core_Front-D13.png",1024,859.1526952469357],"Core_Front-A14":["/res/panelsoil/zenith/2x/Core_Front-A14.png",1024,859.9267078455517],"Core_Front-B14":["/res/panelsoil/zenith/2x/Core_Front-B14.png",1024,871.7554357700417],"Core_Front-C14":["/res/panelsoil/zenith/2x/Core_Front-C14.png",1024,863.1646688757703],"Core_Front-D14":["/res/panelsoil/zenith/2x/Core_Front-D14.png",1024,876.8889920247232],"Core_Front-A15":["/res/panelsoil/zenith/2x/Core_Front-A15.png",1024,877.1557558740183],"Core_Front-B15":["/res/panelsoil/zenith/2x/Core_Front-B15.png",1024,878.6688696690085],"Core_Front-C15":["/res/panelsoil/zenith/2x/Core_Front-C15.png",1024,885.234188978885],"Core_Front-D15":["/res/panelsoil/zenith/2x/Core_Front-D15.png",1024,882.681413040961],"Core_Front-A16":["/res/panelsoil/zenith/2x/Core_Front-A16.png",1024,893.0628858340676],"Core_Front-B16":["/res/panelsoil/zenith/2x/Core_Front-B16.png",1024,891.5978211869747],"Core_Front-C16":["/res/panelsoil/zenith/2x/Core_Front-C16.png",1024,891.1767604370889],"Core_Front-D16":["/res/panelsoil/zenith/2x/Core_Front-D16.png",1024,899.5853087814123],"Core_Front-A17":["/res/panelsoil/zenith/2x/Core_Front-A17.png",1024,904.8570530472161],"Core_Front-B17":["/res/panelsoil/zenith/2x/Core_Front-B17.png",1024,905.4654121113222],"Core_Front-C17":["/res/panelsoil/zenith/2x/Core_Front-C17.png",1024,907.0157926717086],"Core_Front-D17":["/res/panelsoil/zenith/2x/Core_Front-D17.png",1024,909.4059849209523],"Core_Front-A18":["/res/panelsoil/zenith/2x/Core_Front-A18.png",1024,909.3027356170212],"Core_Front-B18":["/res/panelsoil/zenith/2x/Core_Front-B18.png",1024,914.1204236019039],"Core_Front-C18":["/res/panelsoil/zenith/2x/Core_Front-C18.png",1024,924.1418506122147],"Core_Front-D18":["/res/panelsoil/zenith/2x/Core_Front-D18.png",1024,922.6765396024656],"Core_Front-A19":["/res/panelsoil/zenith/2x/Core_Front-A19.png",1024,919.8154858070832],"Core_Front-B19":["/res/panelsoil/zenith/2x/Core_Front-B19.png",1024,922.3808282048576],"Core_Front-C19":["/res/panelsoil/zenith/2x/Core_Front-C19.png",1024,936.4822238024813],"Core_Front-D19":["/res/panelsoil/zenith/2x/Core_Front-D19.png",1024,931.9737459514478],"Core_Front-A20":["/res/panelsoil/zenith/2x/Core_Front-A20.png",1024,934.3587809846167],"Core_Front-B20":["/res/panelsoil/zenith/2x/Core_Front-B20.png",1024,937.9213917642348],"Core_Front-C20":["/res/panelsoil/zenith/2x/Core_Front-C20.png",1024,937.7357132025354],"Core_Front-D20":["/res/panelsoil/zenith/2x/Core_Front-D20.png",1024,951.1277625070308],"Corruption_A1-A1":["/res/panelsoil/zenith/2x/Corruption_A1-A1.png",1024,955.0350718156369],"Corruption_A1-B1":["/res/panelsoil/zenith/2x/Corruption_A1-B1.png",1024,957.1031119521],"Corruption_A1-C1":["/res/panelsoil/zenith/2x/Corruption_A1-C1.png",1024,965.0738957070247],"Corruption_A1-D1":["/res/panelsoil/zenith/2x/Corruption_A1-D1.png",1024,966.170138257001],"Corruption_A1-A2":["/res/panelsoil/zenith/2x/Corruption_A1-A2.png",1024,965.3638205534377],"Corruption_A1-B2":["/res/panelsoil/zenith/2x/Corruption_A1-B2.png",1024,974.1997963496141],"Corruption_A1-C2":["/res/panelsoil/zenith/2x/Corruption_A1-C2.png",1024,969.8653668591398],"Corruption_A1-D2":["/res/panelsoil/zenith/2x/Corruption_A1-D2.png",1024,977.8881002673133],"Corruption_A1-A3":["/res/panelsoil/zenith/2x/Corruption_A1-A3.png",1024,984.2373166016126],"Corruption_A1-B3":["/res/panelsoil/zenith/2x/Corruption_A1-B3.png",1024,987.5621720381532],"Corruption_A1-C3":["/res/panelsoil/zenith/2x/Corruption_A1-C3.png",1024,989.7122904464577],"Corruption_A1-D3":["/res/panelsoil/zenith/2x/Corruption_A1-D3.png",1024,985.7577809820249],"Corruption_A1-A4":["/res/panelsoil/zenith/2x/Corruption_A1-A4.png",1024,991.5117015053795],"Corruption_A1-B4":["/res/panelsoil/zenith/2x/Corruption_A1-B4.png",1024,1002.3072556403082],"Corruption_A1-C4":["/res/panelsoil/zenith/2x/Corruption_A1-C4.png",1024,1003.4715602492257],"Corruption_A1-D4":["/res/panelsoil/zenith/2x/Corruption_A1-D4.png",1024,1008.701309593401],"Corruption_A1-A5":["/res/panelsoil/zenith/2x/Corruption_A1-A5.png",1024,1002.757340619253],"Corruption_A1-B5":["/res/panelsoil/zenith/2x/Corruption_A1-B5.png",1024,1013.3417897220154],"Corruption_A1-C5":["/res/panelsoil/zenith/2x/Corruption_A1-C5.png",1024,1013.555195797351],"Corruption_A1-D5":["/res/panelsoil/zenith/2x/Corruption_A1-D5.png",1024,1013.5184608268855],"Corruption_A1-A6":["/res/panelsoil/zenith/2x/Corruption_A1-A6.png",1024,1015.081954570555],"Corruption_A1-B6":["/res/panelsoil/zenith/2x/Corruption_A1-B6.png",1024,1023.6254936980852],"Corruption_A1-C6":["/res/panelsoil/zenith/2x/Corruption_A1-C6.png",1024,1024.3610610098974],"Corruption_A1-D6":["/res/panelsoil/zenith/2x/Corruption_A1-D6.png",1024,1026.6418190706775],"Corruption_B1-A1":["/res/panelsoil/zenith/2x/Corruption_B1-A1.png",1024,1027.2643603102863],"Corruption_B1-B1":["/res/panelsoil/zenith/2x/Corruption_B1-B1.png",1024,1028.3020595314977],"Corruption_B1-C1":["/res/panelsoil/zenith/2x/Corruption_B1-C1.png",1024,1034.9578113692771],"Corruption_B1-D1":["/res/panelsoil/zenith/2x/Corruption_B1-D1.png",1024,1038.8473509144324],"Corruption_B1-A2":["/res/panelsoil/zenith/2x/Corruption_B1-A2.png",1024,1039.4297406579833],"Corruption_B1-B2":["/res/panelsoil/zenith/2x/Corruption_B1-B2.png",1024,1035.5125289642563],"Corruption_B1-C2":["/res/panelsoil/zenith/2x/Corruption_B1-C2.png",1024,1040.557044936425],"Corruption_B1-D2":["/res/panelsoil/zenith/2x/Corruption_B1-D2.png",1024,1046.3357944851052],"Corruption_B1-A3":["/res/panelsoil/zenith/2x/Corruption_B1-A3.png",1024,1046.302750607098],"Corruption_B1-B3":["/res/panelsoil/zenith/2x/Corruption_B1-B3.png",1024,1052.3042494325612],"Corruption_B1-C3":["/res/panelsoil/zenith/2x/Corruption_B1-C3.png",1024,1056.069135245903],"Corruption_B1-D3":["/res/panelsoil/zenith/2x/Corruption_B1-D3.png",1024,1063.8913113608667],"Corruption_B1-A4":["/res/panelsoil/zenith/2x/Corruption_B1-A4.png",1024,1060.833219337312],"Corruption_B1-B4":["/res/panelsoil/zenith/2x/Corruption_B1-B4.png",1024,1067.855336684134],"Corruption_B1-C4":["/res/panelsoil/zenith/2x/Corruption_B1-C4.png",1024,1069.8630652819627],"Corruption_B1-D4":["/res/panelsoil/zenith/2x/Corruption_B1-D4.png",1024,1073.9771905533312],"Corruption_B1-A5":["/res/panelsoil/zenith/2x/Corruption_B1-A5.png",1024,1074.739184929571],"Corruption_B1-B5":["/res/panelsoil/zenith/2x/Corruption_B1-B5.png",1024,1073.1988407403505],"Corruption_B1-C5":["/res/panelsoil/zenith/2x/Corruption_B1-C5.png",1024,1086.082456563221],"Corruption_B1-D5":["/res/panelsoil/zenith/2x/Corruption_B1-D5.png",1024,1078.3211456423269],"Corruption_B2-A1":["/res/panelsoil/zenith/2x/Corruption_B2-A1.png",1024,1024.7139432126348],"Corruption_B2-B1":["/res/panelsoil/zenith/2x/Corruption_B2-B1.png",1024,1025.740003942321],"Corruption_B2-C1":["/res/panelsoil/zenith/2x/Corruption_B2-C1.png",1024,1028.6339971689063],"Corruption_B2-D1":["/res/panelsoil/zenith/2x/Corruption_B2-D1.png",1024,1032.851851942312],"Corruption_B2-A2":["/res/panelsoil/zenith/2x/Corruption_B2-A2.png",1024,1036.0683749935622],"Corruption_B2-B2":["/res/panelsoil/zenith/2x/Corruption_B2-B2.png",1024,1042.0486629935956],"Corruption_B2-C2":["/res/panelsoil/zenith/2x/Corruption_B2-C2.png",1024,1048.4909662002246],"Corruption_B2-D2":["/res/panelsoil/zenith/2x/Corruption_B2-D2.png",1024,1041.870453615917],"Corruption_B2-A3":["/res/panelsoil/zenith/2x/Corruption_B2-A3.png",1024,1047.8110806780549],"Corruption_B2-B3":["/res/panelsoil/zenith/2x/Corruption_B2-B3.png",1024,1048.1821801586957],"Corruption_B2-C3":["/res/panelsoil/zenith/2x/Corruption_B2-C3.png",1024,1056.1290550456529],"Corruption_B2-D3":["/res/panelsoil/zenith/2x/Corruption_B2-D3.png",1024,1055.8530752387464],"Corruption_B2-A4":["/res/panelsoil/zenith/2x/Corruption_B2-A4.png",1024,1065.3432241471328],"Corruption_B2-B4":["/res/panelsoil/zenith/2x/Corruption_B2-B4.png",1024,1066.3759447481634],"Corruption_B2-C4":["/res/panelsoil/zenith/2x/Corruption_B2-C4.png",1024,1070.6905710365459],"Corruption_B2-D4":["/res/panelsoil/zenith/2x/Corruption_B2-D4.png",1024,1075.6549005989546],"Corruption_B2-A5":["/res/panelsoil/zenith/2x/Corruption_B2-A5.png",1024,1071.1813948569254],"Corruption_B2-B5":["/res/panelsoil/zenith/2x/Corruption_B2-B5.png",1024,1073.1616152777672],"Corruption_B2-C5":["/res/panelsoil/zenith/2x/Corruption_B2-C5.png",1024,1084.4871194712493],"Corruption_B2-D5":["/res/panelsoil/zenith/2x/Corruption_B2-D5.png",1024,1081.17422614687],"Corruption_C1-A1":["/res/panelsoil/zenith/2x/Corruption_C1-A1.png",1024,1072.9183764848447],"Corruption_C1-B1":["/res/panelsoil/zenith/2x/Corruption_C1-B1.png",1024,1068.4912576004801],"Corruption_C1-C1":["/res/panelsoil/zenith/2x/Corruption_C1-C1.png",1024,1073.3208189466563],"Corruption_C1-D1":["/res/panelsoil/zenith/2x/Corruption_C1-D1.png",1024,1080.5258955767863],"Corruption_C1-A2":["/res/panelsoil/zenith/2x/Corruption_C1-A2.png",1024,1088.132578027374],"Corruption_C1-B2":["/res/panelsoil/zenith/2x/Corruption_C1-B2.png",1024,1085.4399530553987],"Corruption_C1-C2":["/res/panelsoil/zenith/2x/Corruption_C1-C2.png",1024,1085.989704104672],"Corruption_C1-D2":["/res/panelsoil/zenith/2x/Corruption_C1-D2.png",1024,1094.5909669251585],"Corruption_C1-A3":["/res/panelsoil/zenith/2x/Corruption_C1-A3.png",1024,1089.778978673044],"Corruption_C1-B3":["/res/panelsoil/zenith/2x/Corruption_C1-B3.png",1024,1099.6923443825226],"Corruption_C1-C3":["/res/panelsoil/zenith/2x/Corruption_C1-C3.png",1024,1098.467334725636],"Corruption_C1-D3":["/res/panelsoil/zenith/2x/Corruption_C1-D3.png",1024,1109.7003934372067],"Corruption_C1-A4":["/res/panelsoil/zenith/2x/Corruption_C1-A4.png",1024,1108.8344514257992],"Corruption_C1-B4":["/res/panelsoil/zenith/2x/Corruption_C1-B4.png",1024,1111.6389156484486],"Corruption_C1-C4":["/res/panelsoil/zenith/2x/Corruption_C1-C4.png",1024,1113.5580345185738],"Corruption_C1-D4":["/res/panelsoil/zenith/2x/Corruption_C1-D4.png",1024,1117.385986723501],"Corruption_C1-A5":["/res/panelsoil/zenith/2x/Corruption_C1-A5.png",1024,1123.083995411361],"Corruption_C1-B5":["/res/panelsoil/zenith/2x/Corruption_C1-B5.png",1024,1120.4857756003908],"Corruption_C1-C5":["/res/panelsoil/zenith/2x/Corruption_C1-C5.png",1024,1128.5579966754992],"Corruption_C1-D5":["/res/panelsoil/zenith/2x/Corruption_C1-D5.png",1024,1124.7219958506269],"Corruption_C1-A6":["/res/panelsoil/zenith/2x/Corruption_C1-A6.png",1024,1129.1604586016558],"Corruption_C1-B6":["/res/panelsoil/zenith/2x/Corruption_C1-B6.png",1024,1134.1990698518382],"Corruption_C1-C6":["/res/panelsoil/zenith/2x/Corruption_C1-C6.png",1024,1139.664489919831],"Corruption_C1-D6":["/res/panelsoil/zenith/2x/Corruption_C1-D6.png",1024,1139.7956154420576],"Corruption_C2-A1":["/res/panelsoil/zenith/2x/Corruption_C2-A1.png",1024,1071.7829271668663],"Corruption_C2-B1":["/res/panelsoil/zenith/2x/Corruption_C2-B1.png",1024,1068.6082567323951],"Corruption_C2-C1":["/res/panelsoil/zenith/2x/Corruption_C2-C1.png",1024,1073.945289314652],"Corruption_C2-D1":["/res/panelsoil/zenith/2x/Corruption_C2-D1.png",1024,1078.6167782765963],"Corruption_C2-A2":["/res/panelsoil/zenith/2x/Corruption_C2-A2.png",1024,1087.1239435557884],"Corruption_C2-B2":["/res/panelsoil/zenith/2x/Corruption_C2-B2.png",1024,1085.5013454364419],"Corruption_C2-C2":["/res/panelsoil/zenith/2x/Corruption_C2-C2.png",1024,1084.9964117497182],"Corruption_C2-D2":["/res/panelsoil/zenith/2x/Corruption_C2-D2.png",1024,1089.943577180089],"Corruption_C2-A3":["/res/panelsoil/zenith/2x/Corruption_C2-A3.png",1024,1093.430289633954],"Corruption_C2-D3":["/res/panelsoil/zenith/2x/Corruption_C2-D3.png",1024,1106.1071223673823],"Corruption_C2-A4":["/res/panelsoil/zenith/2x/Corruption_C2-A4.png",1024,1108.436441772834],"Corruption_C2-A5":["/res/panelsoil/zenith/2x/Corruption_C2-A5.png",1024,1116.3292956615535],"Corruption_D1-A1":["/res/panelsoil/zenith/2x/Corruption_D1-A1.png",1024,1182.1276546648644],"Corruption_D1-B1":["/res/panelsoil/zenith/2x/Corruption_D1-B1.png",1024,1188.5371647453585],"Corruption_D1-C1":["/res/panelsoil/zenith/2x/Corruption_D1-C1.png",1024,1188.9048030821582],"Corruption_D1-D1":["/res/panelsoil/zenith/2x/Corruption_D1-D1.png",1024,1190.9011013361287],"Corruption_D1-A2":["/res/panelsoil/zenith/2x/Corruption_D1-A2.png",1024,1197.9578546687887],"Corruption_D1-B2":["/res/panelsoil/zenith/2x/Corruption_D1-B2.png",1024,1199.0908181764364],"Corruption_D1-C2":["/res/panelsoil/zenith/2x/Corruption_D1-C2.png",1024,1203.632749973978],"Corruption_D1-D2":["/res/panelsoil/zenith/2x/Corruption_D1-D2.png",1024,1208.5687623519216],"Corruption_D1-A3":["/res/panelsoil/zenith/2x/Corruption_D1-A3.png",1024,1209.0092888545528],"Corruption_D1-B3":["/res/panelsoil/zenith/2x/Corruption_D1-B3.png",1024,1210.1988571821075],"Corruption_D1-C3":["/res/panelsoil/zenith/2x/Corruption_D1-C3.png",1024,1214.938560708512],"Corruption_D1-D3":["/res/panelsoil/zenith/2x/Corruption_D1-D3.png",1024,1217.9220797158116],"Corruption_D1-A4":["/res/panelsoil/zenith/2x/Corruption_D1-A4.png",1024,1222.7892880783027],"Corruption_D1-B4":["/res/panelsoil/zenith/2x/Corruption_D1-B4.png",1024,1226.956294511537],"Corruption_D1-C4":["/res/panelsoil/zenith/2x/Corruption_D1-C4.png",1024,1231.6379125977223],"Corruption_D1-D4":["/res/panelsoil/zenith/2x/Corruption_D1-D4.png",1024,1233.880532720567],"Corruption_D1-A5":["/res/panelsoil/zenith/2x/Corruption_D1-A5.png",1024,1235.0255245903627],"Corruption_D1-B5":["/res/panelsoil/zenith/2x/Corruption_D1-B5.png",1024,1242.5144233361714],"Corruption_D1-C5":["/res/panelsoil/zenith/2x/Corruption_D1-C5.png",1024,1241.6308323486755],"Corruption_D1-D5":["/res/panelsoil/zenith/2x/Corruption_D1-D5.png",1024,1242.6797714460013],"Corruption_D1-A6":["/res/panelsoil/zenith/2x/Corruption_D1-A6.png",1024,1242.4117751670663],"Corruption_D1-B6":["/res/panelsoil/zenith/2x/Corruption_D1-B6.png",1024,1247.604609732865],"Corruption_D1-C6":["/res/panelsoil/zenith/2x/Corruption_D1-C6.png",1024,1248.0944605372417],"Corruption_D1-D6":["/res/panelsoil/zenith/2x/Corruption_D1-D6.png",1024,1261.5476224841466],"Corruption_D2-A1":["/res/panelsoil/zenith/2x/Corruption_D2-A1.png",1024,1179.2854993219573],"Corruption_D2-B1":["/res/panelsoil/zenith/2x/Corruption_D2-B1.png",1024,1190.9206102771486],"Corruption_D2-C1":["/res/panelsoil/zenith/2x/Corruption_D2-C1.png",1024,1194.6095256765884],"Corruption_D2-D1":["/res/panelsoil/zenith/2x/Corruption_D2-D1.png",1024,1197.0707847657968],"Corruption_D2-A2":["/res/panelsoil/zenith/2x/Corruption_D2-A2.png",1024,1190.3978345249761],"Corruption_D2-B2":["/res/panelsoil/zenith/2x/Corruption_D2-B2.png",1024,1201.863837474898],"Corruption_D2-C2":["/res/panelsoil/zenith/2x/Corruption_D2-C2.png",1024,1200.5416747104405],"Corruption_D2-D2":["/res/panelsoil/zenith/2x/Corruption_D2-D2.png",1024,1211.7715415220275],"Corruption_D2-A3":["/res/panelsoil/zenith/2x/Corruption_D2-A3.png",1024,1203.2040944663015],"Corruption_D2-B3":["/res/panelsoil/zenith/2x/Corruption_D2-B3.png",1024,1207.4004511422347],"Corruption_D2-C3":["/res/panelsoil/zenith/2x/Corruption_D2-C3.png",1024,1216.8291829102113],"Corruption_D2-D3":["/res/panelsoil/zenith/2x/Corruption_D2-D3.png",1024,1219.6557043578616],"Corruption_D2-A4":["/res/panelsoil/zenith/2x/Corruption_D2-A4.png",1024,1219.996129150558],"Corruption_D2-B4":["/res/panelsoil/zenith/2x/Corruption_D2-B4.png",1024,1224.7150499221093],"Corruption_D2-C4":["/res/panelsoil/zenith/2x/Corruption_D2-C4.png",1024,1225.5798689436385],"Corruption_D2-D4":["/res/panelsoil/zenith/2x/Corruption_D2-D4.png",1024,1228.6756936646916],"Corruption_D2-A5":["/res/panelsoil/zenith/2x/Corruption_D2-A5.png",1024,1228.434811265033],"Corruption_D2-B5":["/res/panelsoil/zenith/2x/Corruption_D2-B5.png",1024,1240.576348249564],"Corruption_D2-C5":["/res/panelsoil/zenith/2x/Corruption_D2-C5.png",1024,1244.2365197209535],"Corruption_D2-D5":["/res/panelsoil/zenith/2x/Corruption_D2-D5.png",1024,1246.4015773351894],"Corruption_Front-A1":["/res/panelsoil/zenith/2x/Corruption_Front-A1.png",1024,953.0869039925991],"Corruption_Front-B1":["/res/panelsoil/zenith/2x/Corruption_Front-B1.png",1024,949.0653684619019],"Corruption_Front-C1":["/res/panelsoil/zenith/2x/Corruption_Front-C1.png",1024,951.4418431464195],"Corruption_Front-D1":["/res/panelsoil/zenith/2x/Corruption_Front-D1.png",1024,956.4401335241314],"Corruption_Front-A2":["/res/panelsoil/zenith/2x/Corruption_Front-A2.png",1024,959.6199499175698],"Corruption_Front-B2":["/res/panelsoil/zenith/2x/Corruption_Front-B2.png",1024,969.8372495398122],"Corruption_Front-C2":["/res/panelsoil/zenith/2x/Corruption_Front-C2.png",1024,971.3905277040765],"Corruption_Front-D2":["/res/panelsoil/zenith/2x/Corruption_Front-D2.png",1024,972.4255501005684],"Corruption_Front-A3":["/res/panelsoil/zenith/2x/Corruption_Front-A3.png",1024,973.4505971722964],"Corruption_Front-B3":["/res/panelsoil/zenith/2x/Corruption_Front-B3.png",1024,976.1719863105609],"Corruption_Front-C3":["/res/panelsoil/zenith/2x/Corruption_Front-C3.png",1024,981.359062684349],"Corruption_Front-D3":["/res/panelsoil/zenith/2x/Corruption_Front-D3.png",1024,989.0989456006566],"Corruption_Front-A4":["/res/panelsoil/zenith/2x/Corruption_Front-A4.png",1024,988.2128446136835],"Corruption_Front-B4":["/res/panelsoil/zenith/2x/Corruption_Front-B4.png",1024,988.5220814192705],"Corruption_Front-C4":["/res/panelsoil/zenith/2x/Corruption_Front-C4.png",1024,989.9634434376844],"Corruption_Front-D4":["/res/panelsoil/zenith/2x/Corruption_Front-D4.png",1024,998.6601021261336],"Corruption_Front-A5":["/res/panelsoil/zenith/2x/Corruption_Front-A5.png",1024,998.2237142358816],"Corruption_Front-B5":["/res/panelsoil/zenith/2x/Corruption_Front-B5.png",1024,1004.6730926297697],"Corruption_Front-C5":["/res/panelsoil/zenith/2x/Corruption_Front-C5.png",1024,1010.1504192442547],"Corruption_Front-D5":["/res/panelsoil/zenith/2x/Corruption_Front-D5.png",1024,1006.1978450902584],"Corruption_Front-A6":["/res/panelsoil/zenith/2x/Corruption_Front-A6.png",1024,1008.3465260106736],"Corruption_Front-B6":["/res/panelsoil/zenith/2x/Corruption_Front-B6.png",1024,1014.807387274426],"Corruption_Front-C6":["/res/panelsoil/zenith/2x/Corruption_Front-C6.png",1024,1013.3378003987403],"Corruption_Front-D6":["/res/panelsoil/zenith/2x/Corruption_Front-D6.png",1024,1017.4257015491497],"Corruption_Front-A7":["/res/panelsoil/zenith/2x/Corruption_Front-A7.png",1024,1028.5117699889145],"Corruption_Front-B7":["/res/panelsoil/zenith/2x/Corruption_Front-B7.png",1024,1032.220138893654],"Corruption_Front-C7":["/res/panelsoil/zenith/2x/Corruption_Front-C7.png",1024,1029.1737947689205],"Corruption_Front-D7":["/res/panelsoil/zenith/2x/Corruption_Front-D7.png",1024,1031.9044661461685],"Corruption_Front-A8":["/res/panelsoil/zenith/2x/Corruption_Front-A8.png",1024,1039.0305184251163],"Corruption_Front-B8":["/res/panelsoil/zenith/2x/Corruption_Front-B8.png",1024,1034.6091029638994],"Corruption_Front-C8":["/res/panelsoil/zenith/2x/Corruption_Front-C8.png",1024,1046.0828769273064],"Corruption_Front-D8":["/res/panelsoil/zenith/2x/Corruption_Front-D8.png",1024,1052.7035018215392],"Corruption_Front-A9":["/res/panelsoil/zenith/2x/Corruption_Front-A9.png",1024,1056.175414699101],"Corruption_Front-B9":["/res/panelsoil/zenith/2x/Corruption_Front-B9.png",1024,1051.4377658507524],"Corruption_Front-C9":["/res/panelsoil/zenith/2x/Corruption_Front-C9.png",1024,1061.7668976306677],"Corruption_Front-D9":["/res/panelsoil/zenith/2x/Corruption_Front-D9.png",1024,1054.7578044992101],"Corruption_Front-A10":["/res/panelsoil/zenith/2x/Corruption_Front-A10.png",1024,1061.2769569706675],"Corruption_Front-B10":["/res/panelsoil/zenith/2x/Corruption_Front-B10.png",1024,1062.1411450157568],"Corruption_Front-C10":["/res/panelsoil/zenith/2x/Corruption_Front-C10.png",1024,1064.8271194775086],"Corruption_Front-D10":["/res/panelsoil/zenith/2x/Corruption_Front-D10.png",1024,1073.28051559031],"Corruption_Front-A11":["/res/panelsoil/zenith/2x/Corruption_Front-A11.png",1024,1077.634678819349],"Corruption_Front-B11":["/res/panelsoil/zenith/2x/Corruption_Front-B11.png",1024,1075.4355242582917],"Corruption_Front-C11":["/res/panelsoil/zenith/2x/Corruption_Front-C11.png",1024,1078.5322274389127],"Corruption_Front-D11":["/res/panelsoil/zenith/2x/Corruption_Front-D11.png",1024,1088.2221517063565],"Corruption_Front-A12":["/res/panelsoil/zenith/2x/Corruption_Front-A12.png",1024,1093.2602635782403],"Corruption_Front-B12":["/res/panelsoil/zenith/2x/Corruption_Front-B12.png",1024,1096.73359658429],"Corruption_Front-C12":["/res/panelsoil/zenith/2x/Corruption_Front-C12.png",1024,1089.528049723098],"Corruption_Front-D12":["/res/panelsoil/zenith/2x/Corruption_Front-D12.png",1024,1097.7127660399294],"Corruption_Front-A13":["/res/panelsoil/zenith/2x/Corruption_Front-A13.png",1024,1100.7784548641575],"Corruption_Front-B13":["/res/panelsoil/zenith/2x/Corruption_Front-B13.png",1024,1108.7570353265858],"Corruption_Front-C13":["/res/panelsoil/zenith/2x/Corruption_Front-C13.png",1024,1101.9226213671886],"Corruption_Front-D13":["/res/panelsoil/zenith/2x/Corruption_Front-D13.png",1024,1114.1507360500086],"Corruption_Front-A14":["/res/panelsoil/zenith/2x/Corruption_Front-A14.png",1024,1113.0128879809474],"Corruption_Front-C14":["/res/panelsoil/zenith/2x/Corruption_Front-C14.png",1024,1115.5048911853985],"Corruption_Front-D14":["/res/panelsoil/zenith/2x/Corruption_Front-D14.png",1024,1121.7626538752008],"Corruption_Front-A15":["/res/panelsoil/zenith/2x/Corruption_Front-A15.png",1024,1130.0613010745872],"Corruption_Front-B15":["/res/panelsoil/zenith/2x/Corruption_Front-B15.png",1024,1132.345733491222],"Corruption_Front-C15":["/res/panelsoil/zenith/2x/Corruption_Front-C15.png",1024,1134.520994052092],"Corruption_Front-D15":["/res/panelsoil/zenith/2x/Corruption_Front-D15.png",1024,1135.8902984038007],"Corruption_Front-A16":["/res/panelsoil/zenith/2x/Corruption_Front-A16.png",1024,1141.2745484192844],"Corruption_Front-B16":["/res/panelsoil/zenith/2x/Corruption_Front-B16.png",1024,1142.831754681278],"Corruption_Front-C16":["/res/panelsoil/zenith/2x/Corruption_Front-C16.png",1024,1141.1383378028247],"Corruption_Front-D16":["/res/panelsoil/zenith/2x/Corruption_Front-D16.png",1024,1141.3275017043293],"Corruption_Front-A17":["/res/panelsoil/zenith/2x/Corruption_Front-A17.png",1024,1150.410777030856],"Corruption_Front-B17":["/res/panelsoil/zenith/2x/Corruption_Front-B17.png",1024,1148.4201216702365],"Corruption_Front-C17":["/res/panelsoil/zenith/2x/Corruption_Front-C17.png",1024,1156.078122438153],"Corruption_Front-D17":["/res/panelsoil/zenith/2x/Corruption_Front-D17.png",1024,1163.3076469607754],"Corruption_Front-A18":["/res/panelsoil/zenith/2x/Corruption_Front-A18.png",1024,1159.4435973884013],"Corruption_Front-B18":["/res/panelsoil/zenith/2x/Corruption_Front-B18.png",1024,1161.3642301021346],"Corruption_Front-C18":["/res/panelsoil/zenith/2x/Corruption_Front-C18.png",1024,1164.4397561344522],"Corruption_Front-D18":["/res/panelsoil/zenith/2x/Corruption_Front-D18.png",1024,1177.4675264811851],"Corruption_Front-A19":["/res/panelsoil/zenith/2x/Corruption_Front-A19.png",1024,1180.7442145456046],"Corruption_Front-B19":["/res/panelsoil/zenith/2x/Corruption_Front-B19.png",1024,1178.237979891051],"Corruption_Front-C19":["/res/panelsoil/zenith/2x/Corruption_Front-C19.png",1024,1177.2902359782897],"Corruption_Front-D19":["/res/panelsoil/zenith/2x/Corruption_Front-D19.png",1024,1180.7418578835652],"Corruption_Front-A20":["/res/panelsoil/zenith/2x/Corruption_Front-A20.png",1024,1183.0825824230656],"Corruption_Front-B20":["/res/panelsoil/zenith/2x/Corruption_Front-B20.png",1024,1196.7447831137772],"Corruption_Front-C20":["/res/panelsoil/zenith/2x/Corruption_Front-C20.png",1024,1187.8892077083426],"Corruption_Front-D20":["/res/panelsoil/zenith/2x/Corruption_Front-D20.png",1024,1195.8647378830153],"Corruption_Front-A21":["/res/panelsoil/zenith/2x/Corruption_Front-A21.png",1024,1201.9745182524246],"Corruption_Front-D21":["/res/panelsoil/zenith/2x/Corruption_Front-D21.png",1024,1210.040224056153],"Corruption_Front-D22":["/res/panelsoil/zenith/2x/Corruption_Front-D22.png",1024,1223.9397012608479],"Hall_1A-A1":["/res/panelsoil/zenith/2x/Hall_1A-A1.png",1024,-401.6245609256047],"Hall_1A-B1":["/res/panelsoil/zenith/2x/Hall_1A-B1.png",1024,-399.95873894118324],"Hall_1A-C1":["/res/panelsoil/zenith/2x/Hall_1A-C1.png",1024,-398.0627637717033],"Hall_1A-D1":["/res/panelsoil/zenith/2x/Hall_1A-D1.png",1024,-389.246732023849],"Hall_1A-A2":["/res/panelsoil/zenith/2x/Hall_1A-A2.png",1024,-381.9238032584127],"Hall_1A-B2":["/res/panelsoil/zenith/2x/Hall_1A-B2.png",1024,-390.60199196424423],"Hall_1A-C2":["/res/panelsoil/zenith/2x/Hall_1A-C2.png",1024,-384.7080740414136],"Hall_1A-D2":["/res/panelsoil/zenith/2x/Hall_1A-D2.png",1024,-377.07554597775055],"Hall_1A-A3":["/res/panelsoil/zenith/2x/Hall_1A-A3.png",1024,-378.4559896831654],"Hall_1A-B3":["/res/panelsoil/zenith/2x/Hall_1A-B3.png",1024,-374.47946682260056],"Hall_1A-C3":["/res/panelsoil/zenith/2x/Hall_1A-C3.png",1024,-374.9676176159424],"Hall_1A-D3":["/res/panelsoil/zenith/2x/Hall_1A-D3.png",1024,-366.6622592092336],"Hall_1A-A4":["/res/panelsoil/zenith/2x/Hall_1A-A4.png",1024,-365.9483219320257],"Hall_1A-B4":["/res/panelsoil/zenith/2x/Hall_1A-B4.png",1024,-358.7064759918165],"Hall_1A-C4":["/res/panelsoil/zenith/2x/Hall_1A-C4.png",1024,-359.4351596543465],"Hall_1A-D4":["/res/panelsoil/zenith/2x/Hall_1A-D4.png",1024,-351.92112599133986],"Hall_Front-A1":["/res/panelsoil/zenith/2x/Hall_Front-A1.png",1024,-395.0636377699151],"Hall_Front-B1":["/res/panelsoil/zenith/2x/Hall_Front-B1.png",1024,-401.8593778548498],"Hall_Front-C1":["/res/panelsoil/zenith/2x/Hall_Front-C1.png",1024,-388.0130886475216],"Hall_Front-D1":["/res/panelsoil/zenith/2x/Hall_Front-D1.png",1024,-396.0519865370555],"Hall_Front-A2":["/res/panelsoil/zenith/2x/Hall_Front-A2.png",1024,-384.374455888481],"Hall_Front-B2":["/res/panelsoil/zenith/2x/Hall_Front-B2.png",1024,-382.2265200500511],"Hall_Front-C2":["/res/panelsoil/zenith/2x/Hall_Front-C2.png",1024,-380.59455770165414],"Hall_Front-D2":["/res/panelsoil/zenith/2x/Hall_Front-D2.png",1024,-378.9846147466638],"Hall_Front-A3":["/res/panelsoil/zenith/2x/Hall_Front-A3.png",1024,-374.61633772576766],"Hall_Front-B3":["/res/panelsoil/zenith/2x/Hall_Front-B3.png",1024,-366.8816952966748],"Hall_Front-C3":["/res/panelsoil/zenith/2x/Hall_Front-C3.png",1024,-367.67262374322485],"Hall_Front-D3":["/res/panelsoil/zenith/2x/Hall_Front-D3.png",1024,-365.63978632981355],"Hall_Front-A4":["/res/panelsoil/zenith/2x/Hall_Front-A4.png",1024,-368.0043579608582],"Hall_Front-B4":["/res/panelsoil/zenith/2x/Hall_Front-B4.png",1024,-358.1014619506721],"Hall_Front-C4":["/res/panelsoil/zenith/2x/Hall_Front-C4.png",1024,-358.3594310934923],"Hall_Front-D4":["/res/panelsoil/zenith/2x/Hall_Front-D4.png",1024,-358.406551385711],"Hotel_A1-A1":["/res/panelsoil/zenith/2x/Hotel_A1-A1.png",1024,-352.2684251674654],"Hotel_A1-B1":["/res/panelsoil/zenith/2x/Hotel_A1-B1.png",1024,-347.05063252895144],"Hotel_A1-C1":["/res/panelsoil/zenith/2x/Hotel_A1-C1.png",1024,-342.48075231400173],"Hotel_A1-D1":["/res/panelsoil/zenith/2x/Hotel_A1-D1.png",1024,-344.3087744462966],"Hotel_A1-A2":["/res/panelsoil/zenith/2x/Hotel_A1-A2.png",1024,-336.4525732117908],"Hotel_A1-B2":["/res/panelsoil/zenith/2x/Hotel_A1-B2.png",1024,-334.3149660109829],"Hotel_A1-C2":["/res/panelsoil/zenith/2x/Hotel_A1-C2.png",1024,-337.2225149423784],"Hotel_A1-D2":["/res/panelsoil/zenith/2x/Hotel_A1-D2.png",1024,-331.3903559365726],"Hotel_A1-A3":["/res/panelsoil/zenith/2x/Hotel_A1-A3.png",1024,-320.5510311350695],"Hotel_A1-B3":["/res/panelsoil/zenith/2x/Hotel_A1-B3.png",1024,-322.2961226800057],"Hotel_A1-C3":["/res/panelsoil/zenith/2x/Hotel_A1-C3.png",1024,-318.098047182702],"Hotel_A1-D3":["/res/panelsoil/zenith/2x/Hotel_A1-D3.png",1024,-317.87858505334134],"Hotel_A1-A4":["/res/panelsoil/zenith/2x/Hotel_A1-A4.png",1024,-310.5087824848513],"Hotel_A1-B4":["/res/panelsoil/zenith/2x/Hotel_A1-B4.png",1024,-305.00064175263765],"Hotel_A1-C4":["/res/panelsoil/zenith/2x/Hotel_A1-C4.png",1024,-309.9763314996614],"Hotel_A1-D4":["/res/panelsoil/zenith/2x/Hotel_A1-D4.png",1024,-299.41236354529974],"Hotel_A1-A5":["/res/panelsoil/zenith/2x/Hotel_A1-A5.png",1024,-302.11976070892166],"Hotel_A1-B5":["/res/panelsoil/zenith/2x/Hotel_A1-B5.png",1024,-298.9586758555229],"Hotel_A1-C5":["/res/panelsoil/zenith/2x/Hotel_A1-C5.png",1024,-292.2078376734008],"Hotel_A1-D5":["/res/panelsoil/zenith/2x/Hotel_A1-D5.png",1024,-292.64076112046587],"Hotel_B1-A1":["/res/panelsoil/zenith/2x/Hotel_B1-A1.png",1024,-282.4443917043702],"Hotel_B1-B1":["/res/panelsoil/zenith/2x/Hotel_B1-B1.png",1024,-278.4057295389801],"Hotel_B1-C1":["/res/panelsoil/zenith/2x/Hotel_B1-C1.png",1024,-278.2176817263716],"Hotel_B1-D1":["/res/panelsoil/zenith/2x/Hotel_B1-D1.png",1024,-276.14086778304284],"Hotel_B1-A2":["/res/panelsoil/zenith/2x/Hotel_B1-A2.png",1024,-274.6080573501221],"Hotel_B1-B2":["/res/panelsoil/zenith/2x/Hotel_B1-B2.png",1024,-264.9581956511501],"Hotel_B1-C2":["/res/panelsoil/zenith/2x/Hotel_B1-C2.png",1024,-257.00769940040766],"Hotel_B1-D2":["/res/panelsoil/zenith/2x/Hotel_B1-D2.png",1024,-257.2938100476044],"Hotel_B1-A3":["/res/panelsoil/zenith/2x/Hotel_B1-A3.png",1024,-254.4684052789442],"Hotel_B1-B3":["/res/panelsoil/zenith/2x/Hotel_B1-B3.png",1024,-257.83327775064237],"Hotel_B1-C3":["/res/panelsoil/zenith/2x/Hotel_B1-C3.png",1024,-243.8446869677371],"Hotel_B1-D3":["/res/panelsoil/zenith/2x/Hotel_B1-D3.png",1024,-252.2405846542687],"Hotel_B1-A4":["/res/panelsoil/zenith/2x/Hotel_B1-A4.png",1024,-245.49967974901082],"Hotel_B1-B4":["/res/panelsoil/zenith/2x/Hotel_B1-B4.png",1024,-236.29680917714825],"Hotel_B1-C4":["/res/panelsoil/zenith/2x/Hotel_B1-C4.png",1024,-239.81123422284136],"Hotel_B1-D4":["/res/panelsoil/zenith/2x/Hotel_B1-D4.png",1024,-236.572483188397],"Hotel_Back1-A1":["/res/panelsoil/zenith/2x/Hotel_Back1-A1.png",1024,-349.0872278726483],"Hotel_Back1-B1":["/res/panelsoil/zenith/2x/Hotel_Back1-B1.png",1024,-350.0497001354495],"Hotel_Back1-C1":["/res/panelsoil/zenith/2x/Hotel_Back1-C1.png",1024,-339.9924779267499],"Hotel_Back1-D1":["/res/panelsoil/zenith/2x/Hotel_Back1-D1.png",1024,-340.3904162885101],"Hotel_Back1-A2":["/res/panelsoil/zenith/2x/Hotel_Back1-A2.png",1024,-333.57906252811085],"Hotel_Back1-B2":["/res/panelsoil/zenith/2x/Hotel_Back1-B2.png",1024,-335.8694162808153],"Hotel_Back1-C2":["/res/panelsoil/zenith/2x/Hotel_Back1-C2.png",1024,-330.07526373751995],"Hotel_Back1-D2":["/res/panelsoil/zenith/2x/Hotel_Back1-D2.png",1024,-324.8716678715172],"Hotel_Back1-A3":["/res/panelsoil/zenith/2x/Hotel_Back1-A3.png",1024,-328.0570490530469],"Hotel_Back1-B3":["/res/panelsoil/zenith/2x/Hotel_Back1-B3.png",1024,-316.6193330171606],"Hotel_Back1-C3":["/res/panelsoil/zenith/2x/Hotel_Back1-C3.png",1024,-313.6192690358018],"Hotel_Back1-D3":["/res/panelsoil/zenith/2x/Hotel_Back1-D3.png",1024,-310.53750378486643],"Hotel_Back1-A4":["/res/panelsoil/zenith/2x/Hotel_Back1-A4.png",1024,-316.09902200634275],"Hotel_Back1-B4":["/res/panelsoil/zenith/2x/Hotel_Back1-B4.png",1024,-309.8585357401264],"Hotel_Back1-C4":["/res/panelsoil/zenith/2x/Hotel_Back1-C4.png",1024,-304.48901818448076],"Hotel_Back1-D4":["/res/panelsoil/zenith/2x/Hotel_Back1-D4.png",1024,-297.59853461786054],"Hotel_Back2-A1":["/res/panelsoil/zenith/2x/Hotel_Back2-A1.png",1024,-354.1171805586],"Hotel_Back2-B1":["/res/panelsoil/zenith/2x/Hotel_Back2-B1.png",1024,-347.43595293071047],"Hotel_Back2-C1":["/res/panelsoil/zenith/2x/Hotel_Back2-C1.png",1024,-344.1123021317095],"Hotel_Back2-D1":["/res/panelsoil/zenith/2x/Hotel_Back2-D1.png",1024,-341.4123648557175],"Hotel_Back2-A2":["/res/panelsoil/zenith/2x/Hotel_Back2-A2.png",1024,-342.78951731466316],"Hotel_Back2-B2":["/res/panelsoil/zenith/2x/Hotel_Back2-B2.png",1024,-337.820061639524],"Hotel_Back2-C2":["/res/panelsoil/zenith/2x/Hotel_Back2-C2.png",1024,-335.58537206889747],"Hotel_Back2-D2":["/res/panelsoil/zenith/2x/Hotel_Back2-D2.png",1024,-323.62631893252336],"Hotel_Back2-A3":["/res/panelsoil/zenith/2x/Hotel_Back2-A3.png",1024,-319.19761441091816],"Hotel_Back2-B3":["/res/panelsoil/zenith/2x/Hotel_Back2-B3.png",1024,-327.6508269642107],"Hotel_Back2-C3":["/res/panelsoil/zenith/2x/Hotel_Back2-C3.png",1024,-324.6583566441487],"Hotel_Back2-D3":["/res/panelsoil/zenith/2x/Hotel_Back2-D3.png",1024,-318.2394887946953],"Hotel_Front-A1":["/res/panelsoil/zenith/2x/Hotel_Front-A1.png",1024,-349.6202108687927],"Hotel_Front-B1":["/res/panelsoil/zenith/2x/Hotel_Front-B1.png",1024,-347.84491667724217],"Hotel_Front-C1":["/res/panelsoil/zenith/2x/Hotel_Front-C1.png",1024,-338.924859410595],"Hotel_Front-D1":["/res/panelsoil/zenith/2x/Hotel_Front-D1.png",1024,-339.233450483595],"Hotel_Front-A2":["/res/panelsoil/zenith/2x/Hotel_Front-A2.png",1024,-331.34937805969304],"Hotel_Front-B2":["/res/panelsoil/zenith/2x/Hotel_Front-B2.png",1024,-335.73526438746626],"Hotel_Front-C2":["/res/panelsoil/zenith/2x/Hotel_Front-C2.png",1024,-326.7058025768542],"Hotel_Front-D2":["/res/panelsoil/zenith/2x/Hotel_Front-D2.png",1024,-322.78336833512157],"Hotel_Front-A3":["/res/panelsoil/zenith/2x/Hotel_Front-A3.png",1024,-327.3849673608573],"Hotel_Front-B3":["/res/panelsoil/zenith/2x/Hotel_Front-B3.png",1024,-318.2916247569427],"Hotel_Front-C3":["/res/panelsoil/zenith/2x/Hotel_Front-C3.png",1024,-312.50936169211667],"Hotel_Front-D3":["/res/panelsoil/zenith/2x/Hotel_Front-D3.png",1024,-315.0404486960385],"Hotel_Front-A4":["/res/panelsoil/zenith/2x/Hotel_Front-A4.png",1024,-307.2451433186644],"Hotel_Front-B4":["/res/panelsoil/zenith/2x/Hotel_Front-B4.png",1024,-305.71019698745647],"Hotel_Front-C4":["/res/panelsoil/zenith/2x/Hotel_Front-C4.png",1024,-306.669638538927],"Hotel_Front-D4":["/res/panelsoil/zenith/2x/Hotel_Front-D4.png",1024,-301.0129316293172],"Hotel_Front-A5":["/res/panelsoil/zenith/2x/Hotel_Front-A5.png",1024,-306.078371593934],"Hotel_Front-B5":["/res/panelsoil/zenith/2x/Hotel_Front-B5.png",1024,-302.83991146669723],"Hotel_Front-C5":["/res/panelsoil/zenith/2x/Hotel_Front-C5.png",1024,-298.861993749709],"Hotel_Front-D5":["/res/panelsoil/zenith/2x/Hotel_Front-D5.png",1024,-290.70617940272615],"Hotel_Front-A6":["/res/panelsoil/zenith/2x/Hotel_Front-A6.png",1024,-281.7080339444447],"Hotel_Front-B6":["/res/panelsoil/zenith/2x/Hotel_Front-B6.png",1024,-287.94936427137304],"Hotel_Front-C6":["/res/panelsoil/zenith/2x/Hotel_Front-C6.png",1024,-283.2303142690862],"Hotel_Front-D6":["/res/panelsoil/zenith/2x/Hotel_Front-D6.png",1024,-272.0532482612671],"Hotel_Front-A7":["/res/panelsoil/zenith/2x/Hotel_Front-A7.png",1024,-273.228381484655],"Hotel_Front-B7":["/res/panelsoil/zenith/2x/Hotel_Front-B7.png",1024,-272.9412120637616],"Hotel_Front-C7":["/res/panelsoil/zenith/2x/Hotel_Front-C7.png",1024,-265.99094500487337],"Hotel_Front-D7":["/res/panelsoil/zenith/2x/Hotel_Front-D7.png",1024,-266.1082273075741],"Hotel_Front-A8":["/res/panelsoil/zenith/2x/Hotel_Front-A8.png",1024,-264.8379108023191],"Hotel_Front-B8":["/res/panelsoil/zenith/2x/Hotel_Front-B8.png",1024,-256.27888202770043],"Hotel_Front-C8":["/res/panelsoil/zenith/2x/Hotel_Front-C8.png",1024,-253.32874159417509],"Hotel_Front-D8":["/res/panelsoil/zenith/2x/Hotel_Front-D8.png",1024,-250.68249000035877],"Lab_A1-A1":["/res/panelsoil/zenith/2x/Lab_A1-A1.png",1024,480.66365557258683],"Lab_A1-B1":["/res/panelsoil/zenith/2x/Lab_A1-B1.png",1024,478.9555091631677],"Lab_A1-C1":["/res/panelsoil/zenith/2x/Lab_A1-C1.png",1024,483.2285798710731],"Lab_A1-D1":["/res/panelsoil/zenith/2x/Lab_A1-D1.png",1024,488.2803776626298],"Lab_A1-A2":["/res/panelsoil/zenith/2x/Lab_A1-A2.png",1024,490.2781358829044],"Lab_A1-B2":["/res/panelsoil/zenith/2x/Lab_A1-B2.png",1024,493.98595892196505],"Lab_A1-C2":["/res/panelsoil/zenith/2x/Lab_A1-C2.png",1024,498.700334547328],"Lab_A1-D2":["/res/panelsoil/zenith/2x/Lab_A1-D2.png",1024,498.7059477025713],"Lab_A1-A3":["/res/panelsoil/zenith/2x/Lab_A1-A3.png",1024,501.9149967570598],"Lab_A1-B3":["/res/panelsoil/zenith/2x/Lab_A1-B3.png",1024,508.58508292106853],"Lab_A1-C3":["/res/panelsoil/zenith/2x/Lab_A1-C3.png",1024,508.9735605606046],"Lab_A1-D3":["/res/panelsoil/zenith/2x/Lab_A1-D3.png",1024,507.0914444019526],"Lab_A1-A4":["/res/panelsoil/zenith/2x/Lab_A1-A4.png",1024,510.3696024683527],"Lab_A1-B4":["/res/panelsoil/zenith/2x/Lab_A1-B4.png",1024,520.6758314433587],"Lab_A1-C4":["/res/panelsoil/zenith/2x/Lab_A1-C4.png",1024,525.4926522950152],"Lab_A1-D4":["/res/panelsoil/zenith/2x/Lab_A1-D4.png",1024,524.298146355766],"Lab_A1-A5":["/res/panelsoil/zenith/2x/Lab_A1-A5.png",1024,528.656190828748],"Lab_A1-B5":["/res/panelsoil/zenith/2x/Lab_A1-B5.png",1024,532.2909226307361],"Lab_A1-C5":["/res/panelsoil/zenith/2x/Lab_A1-C5.png",1024,531.5694723223688],"Lab_A1-D5":["/res/panelsoil/zenith/2x/Lab_A1-D5.png",1024,534.5102064730764],"Lab_A1-A6":["/res/panelsoil/zenith/2x/Lab_A1-A6.png",1024,534.5565690982371],"Lab_A1-B6":["/res/panelsoil/zenith/2x/Lab_A1-B6.png",1024,541.3534387825689],"Lab_A1-C6":["/res/panelsoil/zenith/2x/Lab_A1-C6.png",1024,552.4439030277459],"Lab_A1-D6":["/res/panelsoil/zenith/2x/Lab_A1-D6.png",1024,553.6554579859347],"Lab_A1-A7":["/res/panelsoil/zenith/2x/Lab_A1-A7.png",1024,549.5837955706166],"Lab_A1-B7":["/res/panelsoil/zenith/2x/Lab_A1-B7.png",1024,550.3457351254473],"Lab_A1-C7":["/res/panelsoil/zenith/2x/Lab_A1-C7.png",1024,553.5527067521284],"Lab_A1-D7":["/res/panelsoil/zenith/2x/Lab_A1-D7.png",1024,567.9596422018104],"Lab_A2-A1":["/res/panelsoil/zenith/2x/Lab_A2-A1.png",1024,472.50687107355077],"Lab_A2-B1":["/res/panelsoil/zenith/2x/Lab_A2-B1.png",1024,481.28386004055704],"Lab_A2-C1":["/res/panelsoil/zenith/2x/Lab_A2-C1.png",1024,483.16352936099986],"Lab_A2-D1":["/res/panelsoil/zenith/2x/Lab_A2-D1.png",1024,483.0577369368127],"Lab_A2-A2":["/res/panelsoil/zenith/2x/Lab_A2-A2.png",1024,484.8518702084809],"Lab_A2-B2":["/res/panelsoil/zenith/2x/Lab_A2-B2.png",1024,490.86572281232935],"Lab_A2-C2":["/res/panelsoil/zenith/2x/Lab_A2-C2.png",1024,493.33651715856985],"Lab_A2-D2":["/res/panelsoil/zenith/2x/Lab_A2-D2.png",1024,504.5932002907505],"Lab_A2-A3":["/res/panelsoil/zenith/2x/Lab_A2-A3.png",1024,507.54717431910785],"Lab_A2-B3":["/res/panelsoil/zenith/2x/Lab_A2-B3.png",1024,506.9018045319623],"Lab_A2-C3":["/res/panelsoil/zenith/2x/Lab_A2-C3.png",1024,513.4514666178853],"Lab_A2-D3":["/res/panelsoil/zenith/2x/Lab_A2-D3.png",1024,511.75826800906566],"Lab_A2-A4":["/res/panelsoil/zenith/2x/Lab_A2-A4.png",1024,511.4776394580822],"Lab_A2-B4":["/res/panelsoil/zenith/2x/Lab_A2-B4.png",1024,516.4346962783891],"Lab_A2-C4":["/res/panelsoil/zenith/2x/Lab_A2-C4.png",1024,519.5827664380903],"Lab_A2-D4":["/res/panelsoil/zenith/2x/Lab_A2-D4.png",1024,523.521963230289],"Lab_A2-A5":["/res/panelsoil/zenith/2x/Lab_A2-A5.png",1024,531.3986940182713],"Lab_A2-B5":["/res/panelsoil/zenith/2x/Lab_A2-B5.png",1024,536.4523384272424],"Lab_A2-C5":["/res/panelsoil/zenith/2x/Lab_A2-C5.png",1024,529.2166085677327],"Lab_A2-D5":["/res/panelsoil/zenith/2x/Lab_A2-D5.png",1024,538.7488683065509],"Lab_A2-A6":["/res/panelsoil/zenith/2x/Lab_A2-A6.png",1024,538.7011867680005],"Lab_A2-B6":["/res/panelsoil/zenith/2x/Lab_A2-B6.png",1024,538.8177868330635],"Lab_A2-C6":["/res/panelsoil/zenith/2x/Lab_A2-C6.png",1024,549.2067841840947],"Lab_A2-D6":["/res/panelsoil/zenith/2x/Lab_A2-D6.png",1024,551.7856373714221],"Lab_A2-A7":["/res/panelsoil/zenith/2x/Lab_A2-A7.png",1024,559.1449690294693],"Lab_A2-B7":["/res/panelsoil/zenith/2x/Lab_A2-B7.png",1024,556.1257238336713],"Lab_A2-C7":["/res/panelsoil/zenith/2x/Lab_A2-C7.png",1024,561.7181153037368],"Lab_A2-D7":["/res/panelsoil/zenith/2x/Lab_A2-D7.png",1024,563.1153265548116],"Lab_A2-A8":["/res/panelsoil/zenith/2x/Lab_A2-A8.png",1024,562.2788383576293],"Lab_A2-B8":["/res/panelsoil/zenith/2x/Lab_A2-B8.png",1024,571.1127831564902],"Lab_A2-C8":["/res/panelsoil/zenith/2x/Lab_A2-C8.png",1024,566.6607998702254],"Lab_A2-D8":["/res/panelsoil/zenith/2x/Lab_A2-D8.png",1024,570.8125002070906],"Lab_B1-A1":["/res/panelsoil/zenith/2x/Lab_B1-A1.png",1024,584.7298160390189],"Lab_B1-B1":["/res/panelsoil/zenith/2x/Lab_B1-B1.png",1024,582.6055155929248],"Lab_B1-C1":["/res/panelsoil/zenith/2x/Lab_B1-C1.png",1024,584.4084954380079],"Lab_B1-D1":["/res/panelsoil/zenith/2x/Lab_B1-D1.png",1024,594.90031073],"Lab_B1-A2":["/res/panelsoil/zenith/2x/Lab_B1-A2.png",1024,599.843131131791],"Lab_B1-B2":["/res/panelsoil/zenith/2x/Lab_B1-B2.png",1024,594.9061647443295],"Lab_B1-C2":["/res/panelsoil/zenith/2x/Lab_B1-C2.png",1024,602.0040846321667],"Lab_B1-D2":["/res/panelsoil/zenith/2x/Lab_B1-D2.png",1024,602.2692294577834],"Lab_B1-A3":["/res/panelsoil/zenith/2x/Lab_B1-A3.png",1024,614.4210419394591],"Lab_B1-B3":["/res/panelsoil/zenith/2x/Lab_B1-B3.png",1024,611.4396950893295],"Lab_B1-C3":["/res/panelsoil/zenith/2x/Lab_B1-C3.png",1024,613.4009980095198],"Lab_B1-D3":["/res/panelsoil/zenith/2x/Lab_B1-D3.png",1024,612.3505710731406],"Lab_B1-A4":["/res/panelsoil/zenith/2x/Lab_B1-A4.png",1024,623.1482800215917],"Lab_B1-B4":["/res/panelsoil/zenith/2x/Lab_B1-B4.png",1024,624.2362746962972],"Lab_B1-C4":["/res/panelsoil/zenith/2x/Lab_B1-C4.png",1024,632.4426233557996],"Lab_B1-D4":["/res/panelsoil/zenith/2x/Lab_B1-D4.png",1024,632.2711360121502],"Lab_B1-A5":["/res/panelsoil/zenith/2x/Lab_B1-A5.png",1024,639.3133063970595],"Lab_B1-B5":["/res/panelsoil/zenith/2x/Lab_B1-B5.png",1024,640.2747637786555],"Lab_B1-C5":["/res/panelsoil/zenith/2x/Lab_B1-C5.png",1024,644.0373564389972],"Lab_B1-D5":["/res/panelsoil/zenith/2x/Lab_B1-D5.png",1024,645.0641310895202],"Lab_B1-A6":["/res/panelsoil/zenith/2x/Lab_B1-A6.png",1024,652.6391764479948],"Lab_B1-B6":["/res/panelsoil/zenith/2x/Lab_B1-B6.png",1024,644.8729902742419],"Lab_B1-C6":["/res/panelsoil/zenith/2x/Lab_B1-C6.png",1024,653.6277699603631],"Lab_B1-D6":["/res/panelsoil/zenith/2x/Lab_B1-D6.png",1024,655.1777162540195],"Lab_C1-A1":["/res/panelsoil/zenith/2x/Lab_C1-A1.png",1024,633.9278676906608],"Lab_C1-B1":["/res/panelsoil/zenith/2x/Lab_C1-B1.png",1024,634.4977829591684],"Lab_C1-C1":["/res/panelsoil/zenith/2x/Lab_C1-C1.png",1024,645.667667288575],"Lab_C1-D1":["/res/panelsoil/zenith/2x/Lab_C1-D1.png",1024,644.8560843002928],"Lab_C1-A2":["/res/panelsoil/zenith/2x/Lab_C1-A2.png",1024,643.3214257445226],"Lab_C1-B2":["/res/panelsoil/zenith/2x/Lab_C1-B2.png",1024,647.508240242946],"Lab_C1-C2":["/res/panelsoil/zenith/2x/Lab_C1-C2.png",1024,651.9502870921733],"Lab_C1-D2":["/res/panelsoil/zenith/2x/Lab_C1-D2.png",1024,652.5809102271548],"Lab_C1-A3":["/res/panelsoil/zenith/2x/Lab_C1-A3.png",1024,657.5936145688453],"Lab_C1-B3":["/res/panelsoil/zenith/2x/Lab_C1-B3.png",1024,665.5266236475894],"Lab_C1-C3":["/res/panelsoil/zenith/2x/Lab_C1-C3.png",1024,666.6143787948686],"Lab_C1-D3":["/res/panelsoil/zenith/2x/Lab_C1-D3.png",1024,669.0993749881475],"Lab_C1-A4":["/res/panelsoil/zenith/2x/Lab_C1-A4.png",1024,679.5177071727047],"Lab_C1-B4":["/res/panelsoil/zenith/2x/Lab_C1-B4.png",1024,674.8886105425184],"Lab_C1-C4":["/res/panelsoil/zenith/2x/Lab_C1-C4.png",1024,681.187563043121],"Lab_C1-D4":["/res/panelsoil/zenith/2x/Lab_C1-D4.png",1024,688.2970515189601],"Lab_C1-A5":["/res/panelsoil/zenith/2x/Lab_C1-A5.png",1024,689.2480727007775],"Lab_C1-B5":["/res/panelsoil/zenith/2x/Lab_C1-B5.png",1024,685.3577348029892],"Lab_C1-C5":["/res/panelsoil/zenith/2x/Lab_C1-C5.png",1024,696.4098113569523],"Lab_C1-D5":["/res/panelsoil/zenith/2x/Lab_C1-D5.png",1024,697.1679259880846],"Lab_C1-A6":["/res/panelsoil/zenith/2x/Lab_C1-A6.png",1024,702.67935645743],"Lab_C1-B6":["/res/panelsoil/zenith/2x/Lab_C1-B6.png",1024,704.6673444659697],"Lab_C1-C6":["/res/panelsoil/zenith/2x/Lab_C1-C6.png",1024,708.4613408084068],"Lab_C1-D6":["/res/panelsoil/zenith/2x/Lab_C1-D6.png",1024,708.9733912518492],"Lab_Front-A1":["/res/panelsoil/zenith/2x/Lab_Front-A1.png",1024,444.34664279720795],"Lab_Front-B1":["/res/panelsoil/zenith/2x/Lab_Front-B1.png",1024,447.50636115823306],"Lab_Front-C1":["/res/panelsoil/zenith/2x/Lab_Front-C1.png",1024,456.3887335476774],"Lab_Front-D1":["/res/panelsoil/zenith/2x/Lab_Front-D1.png",1024,463.7552311151973],"Lab_Front-A2":["/res/panelsoil/zenith/2x/Lab_Front-A2.png",1024,461.31229138005756],"Lab_Front-B2":["/res/panelsoil/zenith/2x/Lab_Front-B2.png",1024,468.92885787929396],"Lab_Front-C2":["/res/panelsoil/zenith/2x/Lab_Front-C2.png",1024,474.55303270175034],"Lab_Front-D2":["/res/panelsoil/zenith/2x/Lab_Front-D2.png",1024,466.9011699927968],"Lab_Front-A3":["/res/panelsoil/zenith/2x/Lab_Front-A3.png",1024,469.61877493415074],"Lab_Front-B3":["/res/panelsoil/zenith/2x/Lab_Front-B3.png",1024,476.07285137094084],"Lab_Front-C3":["/res/panelsoil/zenith/2x/Lab_Front-C3.png",1024,476.8260737959272],"Lab_Front-D3":["/res/panelsoil/zenith/2x/Lab_Front-D3.png",1024,488.7750084192186],"Lab_Front-A4":["/res/panelsoil/zenith/2x/Lab_Front-A4.png",1024,484.43712553845705],"Lab_Front-B4":["/res/panelsoil/zenith/2x/Lab_Front-B4.png",1024,491.464181305286],"Lab_Front-C4":["/res/panelsoil/zenith/2x/Lab_Front-C4.png",1024,493.7594224719536],"Lab_Front-D4":["/res/panelsoil/zenith/2x/Lab_Front-D4.png",1024,493.60981758363477],"Lab_Front-A5":["/res/panelsoil/zenith/2x/Lab_Front-A5.png",1024,494.98587942434],"Lab_Front-B5":["/res/panelsoil/zenith/2x/Lab_Front-B5.png",1024,498.476706472207],"Lab_Front-C5":["/res/panelsoil/zenith/2x/Lab_Front-C5.png",1024,500.5778226206409],"Lab_Front-D5":["/res/panelsoil/zenith/2x/Lab_Front-D5.png",1024,510.34332025329036],"Lab_Front-A6":["/res/panelsoil/zenith/2x/Lab_Front-A6.png",1024,507.01588778571283],"Lab_Front-B6":["/res/panelsoil/zenith/2x/Lab_Front-B6.png",1024,517.3024941126887],"Lab_Front-C6":["/res/panelsoil/zenith/2x/Lab_Front-C6.png",1024,514.3842049605934],"Lab_Front-D6":["/res/panelsoil/zenith/2x/Lab_Front-D6.png",1024,521.402861099902],"Lab_Front-A7":["/res/panelsoil/zenith/2x/Lab_Front-A7.png",1024,529.5242481656309],"Lab_Front-D7":["/res/panelsoil/zenith/2x/Lab_Front-D7.png",1024,530.3306274572425],"Lab_Front-A8":["/res/panelsoil/zenith/2x/Lab_Front-A8.png",1024,540.8339905888182],"Lab_Front-B8":["/res/panelsoil/zenith/2x/Lab_Front-B8.png",1024,535.9064354921703],"Lab_Front-C8":["/res/panelsoil/zenith/2x/Lab_Front-C8.png",1024,540.2294932689214],"Lab_Front-D8":["/res/panelsoil/zenith/2x/Lab_Front-D8.png",1024,543.1299553949085],"Lab_Front-A9":["/res/panelsoil/zenith/2x/Lab_Front-A9.png",1024,544.6902052960049],"Lab_Front-B9":["/res/panelsoil/zenith/2x/Lab_Front-B9.png",1024,555.5674814737812],"Lab_Front-C9":["/res/panelsoil/zenith/2x/Lab_Front-C9.png",1024,557.9809799919477],"Lab_Front-D9":["/res/panelsoil/zenith/2x/Lab_Front-D9.png",1024,563.1124047445206],"Lab_Front-A10":["/res/panelsoil/zenith/2x/Lab_Front-A10.png",1024,564.2625060623968],"Lab_Front-B10":["/res/panelsoil/zenith/2x/Lab_Front-B10.png",1024,565.6941740422731],"Lab_Front-D10":["/res/panelsoil/zenith/2x/Lab_Front-D10.png",1024,570.5980259963973],"Lab_Front-A11":["/res/panelsoil/zenith/2x/Lab_Front-A11.png",1024,574.8223596772394],"Lab_Front-B11":["/res/panelsoil/zenith/2x/Lab_Front-B11.png",1024,576.0374565418506],"Lab_Front-C11":["/res/panelsoil/zenith/2x/Lab_Front-C11.png",1024,586.6505247073686],"Lab_Front-D11":["/res/panelsoil/zenith/2x/Lab_Front-D11.png",1024,582.3422043466758],"Lab_Front-A12":["/res/panelsoil/zenith/2x/Lab_Front-A12.png",1024,589.8720250017593],"Lab_Front-B12":["/res/panelsoil/zenith/2x/Lab_Front-B12.png",1024,590.789625639925],"Lab_Front-C12":["/res/panelsoil/zenith/2x/Lab_Front-C12.png",1024,594.7840938746277],"Lab_Front-D12":["/res/panelsoil/zenith/2x/Lab_Front-D12.png",1024,591.9973165402625],"Lab_Front-A13":["/res/panelsoil/zenith/2x/Lab_Front-A13.png",1024,605.8280266729672],"Lab_Front-B13":["/res/panelsoil/zenith/2x/Lab_Front-B13.png",1024,602.2055469826767],"Lab_Front-C13":["/res/panelsoil/zenith/2x/Lab_Front-C13.png",1024,606.4269305785077],"Lab_Front-D13":["/res/panelsoil/zenith/2x/Lab_Front-D13.png",1024,605.7407660127546],"Lab_Front-A14":["/res/panelsoil/zenith/2x/Lab_Front-A14.png",1024,617.230465024036],"Lab_Front-B14":["/res/panelsoil/zenith/2x/Lab_Front-B14.png",1024,613.3198239131436],"Lab_Front-C14":["/res/panelsoil/zenith/2x/Lab_Front-C14.png",1024,615.7993417556831],"Lab_Front-D14":["/res/panelsoil/zenith/2x/Lab_Front-D14.png",1024,623.5612820008271],"Lab_Front-A15":["/res/panelsoil/zenith/2x/Lab_Front-A15.png",1024,629.1392687118606],"Lab_Front-B15":["/res/panelsoil/zenith/2x/Lab_Front-B15.png",1024,624.477856251247],"Lab_Front-C15":["/res/panelsoil/zenith/2x/Lab_Front-C15.png",1024,629.7283656974734],"Lab_Front-D15":["/res/panelsoil/zenith/2x/Lab_Front-D15.png",1024,629.6948335467831],"Lab_Front-A16":["/res/panelsoil/zenith/2x/Lab_Front-A16.png",1024,641.6230940522141],"Lab_Front-B16":["/res/panelsoil/zenith/2x/Lab_Front-B16.png",1024,636.7095706728197],"Lab_Front-C16":["/res/panelsoil/zenith/2x/Lab_Front-C16.png",1024,643.9497806111872],"Lab_Front-D16":["/res/panelsoil/zenith/2x/Lab_Front-D16.png",1024,645.8606626889623],"Lab_Front-A17":["/res/panelsoil/zenith/2x/Lab_Front-A17.png",1024,650.9451530667712],"Lab_Front-B17":["/res/panelsoil/zenith/2x/Lab_Front-B17.png",1024,652.5408767886659],"Lab_Front-C17":["/res/panelsoil/zenith/2x/Lab_Front-C17.png",1024,653.8563991527554],"Lab_Front-D17":["/res/panelsoil/zenith/2x/Lab_Front-D17.png",1024,654.0270315980255],"Lab_Front-A18":["/res/panelsoil/zenith/2x/Lab_Front-A18.png",1024,665.7058769672336],"Lab_Front-B18":["/res/panelsoil/zenith/2x/Lab_Front-B18.png",1024,660.1259795756074],"Lab_Front-C18":["/res/panelsoil/zenith/2x/Lab_Front-C18.png",1024,671.2843574419479],"Lab_Front-D18":["/res/panelsoil/zenith/2x/Lab_Front-D18.png",1024,677.5153194497254],"Lab_Front-A19":["/res/panelsoil/zenith/2x/Lab_Front-A19.png",1024,671.2622887634851],"Lab_Front-B19":["/res/panelsoil/zenith/2x/Lab_Front-B19.png",1024,681.8604276308209],"Lab_Front-C19":["/res/panelsoil/zenith/2x/Lab_Front-C19.png",1024,685.0717621955187],"Lab_Front-D19":["/res/panelsoil/zenith/2x/Lab_Front-D19.png",1024,687.7582725577549],"Lab_Front-A20":["/res/panelsoil/zenith/2x/Lab_Front-A20.png",1024,693.0897757030292],"Lab_Front-B20":["/res/panelsoil/zenith/2x/Lab_Front-B20.png",1024,686.3038123625304],"Lab_Front-C20":["/res/panelsoil/zenith/2x/Lab_Front-C20.png",1024,687.8581789478521],"Lab_Front-D20":["/res/panelsoil/zenith/2x/Lab_Front-D20.png",1024,699.7558543119001],"Museum_A1-A1":["/res/panelsoil/zenith/2x/Museum_A1-A1.png",1024,47.19096512616804],"Museum_A1-B1":["/res/panelsoil/zenith/2x/Museum_A1-B1.png",1024,58.26902041953197],"Museum_A1-C1":["/res/panelsoil/zenith/2x/Museum_A1-C1.png",1024,54.28703572210518],"Museum_A1-D1":["/res/panelsoil/zenith/2x/Museum_A1-D1.png",1024,61.61949496824553],"Museum_A1-A2":["/res/panelsoil/zenith/2x/Museum_A1-A2.png",1024,64.77284927804699],"Museum_A1-B2":["/res/panelsoil/zenith/2x/Museum_A1-B2.png",1024,60.31289706185288],"Museum_A1-C2":["/res/panelsoil/zenith/2x/Museum_A1-C2.png",1024,70.18350381920015],"Museum_A1-D2":["/res/panelsoil/zenith/2x/Museum_A1-D2.png",1024,72.48413862014576],"Museum_A1-A3":["/res/panelsoil/zenith/2x/Museum_A1-A3.png",1024,73.80207696891024],"Museum_A1-B3":["/res/panelsoil/zenith/2x/Museum_A1-B3.png",1024,81.690673728209],"Museum_A1-C3":["/res/panelsoil/zenith/2x/Museum_A1-C3.png",1024,84.62411227763619],"Museum_A1-D3":["/res/panelsoil/zenith/2x/Museum_A1-D3.png",1024,87.68774242935812],"Museum_A1-A4":["/res/panelsoil/zenith/2x/Museum_A1-A4.png",1024,90.67371155973088],"Museum_A1-B4":["/res/panelsoil/zenith/2x/Museum_A1-B4.png",1024,93.54470777863078],"Museum_A1-C4":["/res/panelsoil/zenith/2x/Museum_A1-C4.png",1024,94.09259257483532],"Museum_A1-D4":["/res/panelsoil/zenith/2x/Museum_A1-D4.png",1024,92.69050819863612],"Museum_A1-A5":["/res/panelsoil/zenith/2x/Museum_A1-A5.png",1024,96.16985710322992],"Museum_A1-B5":["/res/panelsoil/zenith/2x/Museum_A1-B5.png",1024,101.28035583754794],"Museum_A1-C5":["/res/panelsoil/zenith/2x/Museum_A1-C5.png",1024,108.08358610508346],"Museum_A1-D5":["/res/panelsoil/zenith/2x/Museum_A1-D5.png",1024,110.69767682718849],"Museum_B1-A1":["/res/panelsoil/zenith/2x/Museum_B1-A1.png",1024,124.56664762331744],"Museum_B1-B1":["/res/panelsoil/zenith/2x/Museum_B1-B1.png",1024,121.93333127710204],"Museum_B1-C1":["/res/panelsoil/zenith/2x/Museum_B1-C1.png",1024,129.93407583694471],"Museum_B1-D1":["/res/panelsoil/zenith/2x/Museum_B1-D1.png",1024,135.04323087280278],"Museum_B1-A2":["/res/panelsoil/zenith/2x/Museum_B1-A2.png",1024,132.0896462874611],"Museum_B1-B2":["/res/panelsoil/zenith/2x/Museum_B1-B2.png",1024,130.90474667056014],"Museum_B1-C2":["/res/panelsoil/zenith/2x/Museum_B1-C2.png",1024,132.78308246402923],"Museum_B1-D2":["/res/panelsoil/zenith/2x/Museum_B1-D2.png",1024,146.11528306913826],"Museum_B1-A3":["/res/panelsoil/zenith/2x/Museum_B1-A3.png",1024,140.26254096212418],"Museum_B1-B3":["/res/panelsoil/zenith/2x/Museum_B1-B3.png",1024,154.16026879808362],"Museum_B1-C3":["/res/panelsoil/zenith/2x/Museum_B1-C3.png",1024,149.82449312508894],"Museum_B1-D3":["/res/panelsoil/zenith/2x/Museum_B1-D3.png",1024,151.97745359324693],"Museum_B1-A4":["/res/panelsoil/zenith/2x/Museum_B1-A4.png",1024,155.13189612230082],"Museum_B1-B4":["/res/panelsoil/zenith/2x/Museum_B1-B4.png",1024,162.40796662575713],"Museum_B1-C4":["/res/panelsoil/zenith/2x/Museum_B1-C4.png",1024,158.63644299722182],"Museum_B1-D4":["/res/panelsoil/zenith/2x/Museum_B1-D4.png",1024,167.0460268684561],"Museum_B1-A5":["/res/panelsoil/zenith/2x/Museum_B1-A5.png",1024,172.87531492149813],"Museum_B1-B5":["/res/panelsoil/zenith/2x/Museum_B1-B5.png",1024,176.16368581161538],"Museum_B1-C5":["/res/panelsoil/zenith/2x/Museum_B1-C5.png",1024,180.87997831664188],"Museum_B1-D5":["/res/panelsoil/zenith/2x/Museum_B1-D5.png",1024,174.08435382007417],"Museum_C1-A1":["/res/panelsoil/zenith/2x/Museum_C1-A1.png",1024,188.03218229403544],"Museum_C1-B1":["/res/panelsoil/zenith/2x/Museum_C1-B1.png",1024,190.94767614005892],"Museum_C1-C1":["/res/panelsoil/zenith/2x/Museum_C1-C1.png",1024,202.60958493178845],"Museum_C1-D1":["/res/panelsoil/zenith/2x/Museum_C1-D1.png",1024,194.65652121720066],"Museum_C1-A2":["/res/panelsoil/zenith/2x/Museum_C1-A2.png",1024,201.4890446291766],"Museum_C1-B2":["/res/panelsoil/zenith/2x/Museum_C1-B2.png",1024,211.07785220056542],"Museum_C1-C2":["/res/panelsoil/zenith/2x/Museum_C1-C2.png",1024,205.1334394724854],"Museum_C1-D2":["/res/panelsoil/zenith/2x/Museum_C1-D2.png",1024,210.25559146385646],"Museum_C1-A3":["/res/panelsoil/zenith/2x/Museum_C1-A3.png",1024,218.58991251547513],"Museum_C1-B3":["/res/panelsoil/zenith/2x/Museum_C1-B3.png",1024,223.93260799922717],"Museum_C1-C3":["/res/panelsoil/zenith/2x/Museum_C1-C3.png",1024,224.11336329985366],"Museum_C1-D3":["/res/panelsoil/zenith/2x/Museum_C1-D3.png",1024,221.82878209541892],"Museum_C1-A4":["/res/panelsoil/zenith/2x/Museum_C1-A4.png",1024,232.40446539095325],"Museum_C1-B4":["/res/panelsoil/zenith/2x/Museum_C1-B4.png",1024,228.35473271042656],"Museum_C1-C4":["/res/panelsoil/zenith/2x/Museum_C1-C4.png",1024,237.81693806922266],"Museum_C1-D4":["/res/panelsoil/zenith/2x/Museum_C1-D4.png",1024,234.37858815954527],"Museum_C1-A5":["/res/panelsoil/zenith/2x/Museum_C1-A5.png",1024,237.96239498083204],"Museum_C1-B5":["/res/panelsoil/zenith/2x/Museum_C1-B5.png",1024,247.38159324369892],"Museum_C1-C5":["/res/panelsoil/zenith/2x/Museum_C1-C5.png",1024,245.8976390110998],"Museum_C1-D5":["/res/panelsoil/zenith/2x/Museum_C1-D5.png",1024,255.2781678737888],"Museum_C1-A6":["/res/panelsoil/zenith/2x/Museum_C1-A6.png",1024,248.57224204372525],"Museum_C1-B6":["/res/panelsoil/zenith/2x/Museum_C1-B6.png",1024,261.40174012004184],"Museum_C1-C6":["/res/panelsoil/zenith/2x/Museum_C1-C6.png",1024,265.1866172615188],"Museum_C1-D6":["/res/panelsoil/zenith/2x/Museum_C1-D6.png",1024,257.17579910534147],"Museum_C2-A1":["/res/panelsoil/zenith/2x/Museum_C2-A1.png",1024,187.24858594172744],"Museum_C2-B1":["/res/panelsoil/zenith/2x/Museum_C2-B1.png",1024,189.9764743935605],"Museum_C2-C1":["/res/panelsoil/zenith/2x/Museum_C2-C1.png",1024,196.17416811684447],"Museum_C2-D1":["/res/panelsoil/zenith/2x/Museum_C2-D1.png",1024,199.2950147516308],"Museum_C2-A2":["/res/panelsoil/zenith/2x/Museum_C2-A2.png",1024,206.53244552371655],"Museum_C2-B2":["/res/panelsoil/zenith/2x/Museum_C2-B2.png",1024,210.26796453409884],"Museum_C2-C2":["/res/panelsoil/zenith/2x/Museum_C2-C2.png",1024,215.89483138401098],"Museum_C2-D2":["/res/panelsoil/zenith/2x/Museum_C2-D2.png",1024,208.0694949736222],"Museum_C2-A3":["/res/panelsoil/zenith/2x/Museum_C2-A3.png",1024,220.71038818481566],"Museum_C2-B3":["/res/panelsoil/zenith/2x/Museum_C2-B3.png",1024,214.2142953580689],"Museum_C2-C3":["/res/panelsoil/zenith/2x/Museum_C2-C3.png",1024,226.29906744355387],"Museum_C2-D3":["/res/panelsoil/zenith/2x/Museum_C2-D3.png",1024,230.29414030424346],"Museum_C2-A4":["/res/panelsoil/zenith/2x/Museum_C2-A4.png",1024,227.7604349188731],"Museum_C2-B4":["/res/panelsoil/zenith/2x/Museum_C2-B4.png",1024,229.38237490541866],"Museum_C2-C4":["/res/panelsoil/zenith/2x/Museum_C2-C4.png",1024,237.38897416160444],"Museum_C2-D4":["/res/panelsoil/zenith/2x/Museum_C2-D4.png",1024,232.01456089347028],"Museum_C2-A5":["/res/panelsoil/zenith/2x/Museum_C2-A5.png",1024,245.80931747914155],"Museum_C2-B5":["/res/panelsoil/zenith/2x/Museum_C2-B5.png",1024,242.20271405405913],"Museum_C2-C5":["/res/panelsoil/zenith/2x/Museum_C2-C5.png",1024,249.4661634157849],"Museum_C2-D5":["/res/panelsoil/zenith/2x/Museum_C2-D5.png",1024,252.52874581660132],"Museum_C2-A6":["/res/panelsoil/zenith/2x/Museum_C2-A6.png",1024,258.65554533879265],"Museum_C2-B6":["/res/panelsoil/zenith/2x/Museum_C2-B6.png",1024,255.687437059238],"Museum_C2-C6":["/res/panelsoil/zenith/2x/Museum_C2-C6.png",1024,253.58097964421944],"Museum_C2-D6":["/res/panelsoil/zenith/2x/Museum_C2-D6.png",1024,261.1797622266168],"Museum_Front-A1":["/res/panelsoil/zenith/2x/Museum_Front-A1.png",1024,46.85007655152482],"Museum_Front-B1":["/res/panelsoil/zenith/2x/Museum_Front-B1.png",1024,48.805809311351105],"Museum_Front-C1":["/res/panelsoil/zenith/2x/Museum_Front-C1.png",1024,56.03547005115161],"Museum_Front-D1":["/res/panelsoil/zenith/2x/Museum_Front-D1.png",1024,62.45938522759212],"Museum_Front-A2":["/res/panelsoil/zenith/2x/Museum_Front-A2.png",1024,63.45469257350993],"Museum_Front-B2":["/res/panelsoil/zenith/2x/Museum_Front-B2.png",1024,64.39866466835649],"Museum_Front-C2":["/res/panelsoil/zenith/2x/Museum_Front-C2.png",1024,68.91995439119331],"Museum_Front-D2":["/res/panelsoil/zenith/2x/Museum_Front-D2.png",1024,65.98123146001556],"Museum_Front-A3":["/res/panelsoil/zenith/2x/Museum_Front-A3.png",1024,72.72480254376981],"Museum_Front-B3":["/res/panelsoil/zenith/2x/Museum_Front-B3.png",1024,74.77974359248589],"Museum_Front-C3":["/res/panelsoil/zenith/2x/Museum_Front-C3.png",1024,77.58674825819074],"Museum_Front-D3":["/res/panelsoil/zenith/2x/Museum_Front-D3.png",1024,83.79195255420443],"Museum_Front-A4":["/res/panelsoil/zenith/2x/Museum_Front-A4.png",1024,85.71492896599172],"Museum_Front-B4":["/res/panelsoil/zenith/2x/Museum_Front-B4.png",1024,89.08006445931721],"Museum_Front-C4":["/res/panelsoil/zenith/2x/Museum_Front-C4.png",1024,97.5335999759843],"Museum_Front-D4":["/res/panelsoil/zenith/2x/Museum_Front-D4.png",1024,99.66536026925503],"Museum_Front-A5":["/res/panelsoil/zenith/2x/Museum_Front-A5.png",1024,101.76741155107955],"Museum_Front-B5":["/res/panelsoil/zenith/2x/Museum_Front-B5.png",1024,99.71074037613703],"Museum_Front-C5":["/res/panelsoil/zenith/2x/Museum_Front-C5.png",1024,104.61364947472318],"Museum_Front-D5":["/res/panelsoil/zenith/2x/Museum_Front-D5.png",1024,112.32798523318856],"Museum_Front-A6":["/res/panelsoil/zenith/2x/Museum_Front-A6.png",1024,108.99898089869643],"Museum_Front-B6":["/res/panelsoil/zenith/2x/Museum_Front-B6.png",1024,121.3902956930771],"Museum_Front-C6":["/res/panelsoil/zenith/2x/Museum_Front-C6.png",1024,119.1166405208709],"Museum_Front-D6":["/res/panelsoil/zenith/2x/Museum_Front-D6.png",1024,127.15851607291452],"Museum_Front-A7":["/res/panelsoil/zenith/2x/Museum_Front-A7.png",1024,125.96124555041291],"Museum_Front-B7":["/res/panelsoil/zenith/2x/Museum_Front-B7.png",1024,130.90731766642443],"Museum_Front-C7":["/res/panelsoil/zenith/2x/Museum_Front-C7.png",1024,133.72530579739006],"Museum_Front-D7":["/res/panelsoil/zenith/2x/Museum_Front-D7.png",1024,138.05417530865293],"Museum_Front-A8":["/res/panelsoil/zenith/2x/Museum_Front-A8.png",1024,135.02027125141274],"Museum_Front-B8":["/res/panelsoil/zenith/2x/Museum_Front-B8.png",1024,138.0540919328076],"Museum_Front-C8":["/res/panelsoil/zenith/2x/Museum_Front-C8.png",1024,144.55285606744272],"Museum_Front-D8":["/res/panelsoil/zenith/2x/Museum_Front-D8.png",1024,149.54485062929945],"Museum_Front-A9":["/res/panelsoil/zenith/2x/Museum_Front-A9.png",1024,153.1002917887823],"Museum_Front-B9":["/res/panelsoil/zenith/2x/Museum_Front-B9.png",1024,149.15790729616626],"Museum_Front-C9":["/res/panelsoil/zenith/2x/Museum_Front-C9.png",1024,152.92404244167636],"Museum_Front-D9":["/res/panelsoil/zenith/2x/Museum_Front-D9.png",1024,163.5921221429884],"Museum_Front-A10":["/res/panelsoil/zenith/2x/Museum_Front-A10.png",1024,160.17776987171425],"Museum_Front-B10":["/res/panelsoil/zenith/2x/Museum_Front-B10.png",1024,160.40201570808188],"Museum_Front-C10":["/res/panelsoil/zenith/2x/Museum_Front-C10.png",1024,165.5229173167923],"Museum_Front-D10":["/res/panelsoil/zenith/2x/Museum_Front-D10.png",1024,168.07916030890104],"Museum_Front-A11":["/res/panelsoil/zenith/2x/Museum_Front-A11.png",1024,170.0110347387045],"Museum_Front-B11":["/res/panelsoil/zenith/2x/Museum_Front-B11.png",1024,174.58291517625585],"Museum_Front-C11":["/res/panelsoil/zenith/2x/Museum_Front-C11.png",1024,187.19263201971089],"Museum_Front-D11":["/res/panelsoil/zenith/2x/Museum_Front-D11.png",1024,179.6490904989525],"Museum_Front-A12":["/res/panelsoil/zenith/2x/Museum_Front-A12.png",1024,182.45033620676972],"Museum_Front-B12":["/res/panelsoil/zenith/2x/Museum_Front-B12.png",1024,188.50737411417253],"Museum_Front-C12":["/res/panelsoil/zenith/2x/Museum_Front-C12.png",1024,189.52670454576432],"Museum_Front-D12":["/res/panelsoil/zenith/2x/Museum_Front-D12.png",1024,202.58093705624523],"Museum_Front-A13":["/res/panelsoil/zenith/2x/Museum_Front-A13.png",1024,204.79343421432708],"Museum_Front-B13":["/res/panelsoil/zenith/2x/Museum_Front-B13.png",1024,205.6248167865046],"Museum_Front-C13":["/res/panelsoil/zenith/2x/Museum_Front-C13.png",1024,209.64351680829043],"Museum_Front-D13":["/res/panelsoil/zenith/2x/Museum_Front-D13.png",1024,208.4570007136507],"Museum_Front-A14":["/res/panelsoil/zenith/2x/Museum_Front-A14.png",1024,206.4399759032446],"Museum_Front-B14":["/res/panelsoil/zenith/2x/Museum_Front-B14.png",1024,221.71753431942608],"Museum_Front-D14":["/res/panelsoil/zenith/2x/Museum_Front-D14.png",1024,225.37792805013567],"Museum_Front-A15":["/res/panelsoil/zenith/2x/Museum_Front-A15.png",1024,229.59388031991273],"Museum_Front-B15":["/res/panelsoil/zenith/2x/Museum_Front-B15.png",1024,228.0518463298049],"Museum_Front-C15":["/res/panelsoil/zenith/2x/Museum_Front-C15.png",1024,225.9294267023009],"Museum_Front-D15":["/res/panelsoil/zenith/2x/Museum_Front-D15.png",1024,237.6713181731855],"Museum_Front-A16":["/res/panelsoil/zenith/2x/Museum_Front-A16.png",1024,232.13923984869015],"Museum_Front-B16":["/res/panelsoil/zenith/2x/Museum_Front-B16.png",1024,235.076516679908],"Museum_Front-C16":["/res/panelsoil/zenith/2x/Museum_Front-C16.png",1024,246.97234299418272],"Museum_Front-D16":["/res/panelsoil/zenith/2x/Museum_Front-D16.png",1024,245.03330311401285],"Office_A1-A1":["/res/panelsoil/zenith/2x/Office_A1-A1.png",1024,259.9799802107113],"Office_A1-B1":["/res/panelsoil/zenith/2x/Office_A1-B1.png",1024,259.6101305703191],"Office_A1-C1":["/res/panelsoil/zenith/2x/Office_A1-C1.png",1024,258.9776772751179],"Office_A1-D1":["/res/panelsoil/zenith/2x/Office_A1-D1.png",1024,270.4032721636474],"Office_A1-A2":["/res/panelsoil/zenith/2x/Office_A1-A2.png",1024,263.69420829352833],"Office_A1-B2":["/res/panelsoil/zenith/2x/Office_A1-B2.png",1024,273.6005472610225],"Office_A1-C2":["/res/panelsoil/zenith/2x/Office_A1-C2.png",1024,278.8956362291009],"Office_A1-D2":["/res/panelsoil/zenith/2x/Office_A1-D2.png",1024,281.85269462952493],"Office_A1-A3":["/res/panelsoil/zenith/2x/Office_A1-A3.png",1024,275.5557476316469],"Office_A1-B3":["/res/panelsoil/zenith/2x/Office_A1-B3.png",1024,288.18639801989264],"Office_A1-C3":["/res/panelsoil/zenith/2x/Office_A1-C3.png",1024,283.78634425915334],"Office_A1-D3":["/res/panelsoil/zenith/2x/Office_A1-D3.png",1024,286.2460592315835],"Office_A1-A4":["/res/panelsoil/zenith/2x/Office_A1-A4.png",1024,298.5281106762168],"Office_A1-B4":["/res/panelsoil/zenith/2x/Office_A1-B4.png",1024,300.75133284595455],"Office_A1-C4":["/res/panelsoil/zenith/2x/Office_A1-C4.png",1024,295.6153100577409],"Office_A1-D4":["/res/panelsoil/zenith/2x/Office_A1-D4.png",1024,297.32658430962226],"Office_A1-A5":["/res/panelsoil/zenith/2x/Office_A1-A5.png",1024,308.8481656647392],"Office_A1-B5":["/res/panelsoil/zenith/2x/Office_A1-B5.png",1024,310.96332953727534],"Office_A1-C5":["/res/panelsoil/zenith/2x/Office_A1-C5.png",1024,309.64183684230375],"Office_A1-D5":["/res/panelsoil/zenith/2x/Office_A1-D5.png",1024,318.055375204887],"Office_A1-A6":["/res/panelsoil/zenith/2x/Office_A1-A6.png",1024,321.03123687379735],"Office_A1-B6":["/res/panelsoil/zenith/2x/Office_A1-B6.png",1024,320.96419081971504],"Office_A1-C6":["/res/panelsoil/zenith/2x/Office_A1-C6.png",1024,319.575997713832],"Office_A1-D6":["/res/panelsoil/zenith/2x/Office_A1-D6.png",1024,324.55429615543255],"Office_A1-A7":["/res/panelsoil/zenith/2x/Office_A1-A7.png",1024,324.8201251242191],"Office_A1-B7":["/res/panelsoil/zenith/2x/Office_A1-B7.png",1024,337.11956198568805],"Office_A1-C7":["/res/panelsoil/zenith/2x/Office_A1-C7.png",1024,331.81953059969675],"Office_A1-D7":["/res/panelsoil/zenith/2x/Office_A1-D7.png",1024,335.67542960751535],"Office_B1-A1":["/res/panelsoil/zenith/2x/Office_B1-A1.png",1024,351.9472123322371],"Office_B1-B1":["/res/panelsoil/zenith/2x/Office_B1-B1.png",1024,360.20409428953457],"Office_B1-C1":["/res/panelsoil/zenith/2x/Office_B1-C1.png",1024,364.55290072766206],"Office_B1-D1":["/res/panelsoil/zenith/2x/Office_B1-D1.png",1024,363.563202657005],"Office_B1-A2":["/res/panelsoil/zenith/2x/Office_B1-A2.png",1024,363.49290863308073],"Office_B1-B2":["/res/panelsoil/zenith/2x/Office_B1-B2.png",1024,369.83441915769674],"Office_B1-C2":["/res/panelsoil/zenith/2x/Office_B1-C2.png",1024,377.780581660746],"Office_B1-D2":["/res/panelsoil/zenith/2x/Office_B1-D2.png",1024,382.1002908602671],"Office_B1-A3":["/res/panelsoil/zenith/2x/Office_B1-A3.png",1024,384.1738717639261],"Office_B1-B3":["/res/panelsoil/zenith/2x/Office_B1-B3.png",1024,386.6392719367387],"Office_B1-C3":["/res/panelsoil/zenith/2x/Office_B1-C3.png",1024,380.6980420834272],"Office_B1-D3":["/res/panelsoil/zenith/2x/Office_B1-D3.png",1024,384.6879260433678],"Office_B1-A4":["/res/panelsoil/zenith/2x/Office_B1-A4.png",1024,397.22008557342707],"Office_B1-B4":["/res/panelsoil/zenith/2x/Office_B1-B4.png",1024,392.3575433957187],"Office_B1-C4":["/res/panelsoil/zenith/2x/Office_B1-C4.png",1024,403.31171036246684],"Office_B1-D4":["/res/panelsoil/zenith/2x/Office_B1-D4.png",1024,401.96392175782984],"Office_B2-A1":["/res/panelsoil/zenith/2x/Office_B2-A1.png",1024,351.24084173802964],"Office_B2-B1":["/res/panelsoil/zenith/2x/Office_B2-B1.png",1024,360.1363425700878],"Office_B2-C1":["/res/panelsoil/zenith/2x/Office_B2-C1.png",1024,360.1288112254928],"Office_B2-D1":["/res/panelsoil/zenith/2x/Office_B2-D1.png",1024,366.12423448311984],"Office_B2-A2":["/res/panelsoil/zenith/2x/Office_B2-A2.png",1024,366.8489529497421],"Office_B2-B2":["/res/panelsoil/zenith/2x/Office_B2-B2.png",1024,373.6245447728551],"Office_B2-C2":["/res/panelsoil/zenith/2x/Office_B2-C2.png",1024,369.4353194651133],"Office_B2-D2":["/res/panelsoil/zenith/2x/Office_B2-D2.png",1024,372.3188756713985],"Office_B2-A3":["/res/panelsoil/zenith/2x/Office_B2-A3.png",1024,384.9989698655411],"Office_B2-B3":["/res/panelsoil/zenith/2x/Office_B2-B3.png",1024,386.58769757853497],"Office_B2-C3":["/res/panelsoil/zenith/2x/Office_B2-C3.png",1024,387.5236495271379],"Office_B2-D3":["/res/panelsoil/zenith/2x/Office_B2-D3.png",1024,391.21448274541495],"Office_B2-A4":["/res/panelsoil/zenith/2x/Office_B2-A4.png",1024,388.6557985224537],"Office_B2-B4":["/res/panelsoil/zenith/2x/Office_B2-B4.png",1024,395.1797486587537],"Office_B2-C4":["/res/panelsoil/zenith/2x/Office_B2-C4.png",1024,399.25707430215033],"Office_B2-D4":["/res/panelsoil/zenith/2x/Office_B2-D4.png",1024,406.69997083912375],"Office_Front-A1":["/res/panelsoil/zenith/2x/Office_Front-A1.png",1024,249.6020512086174],"Office_Front-B1":["/res/panelsoil/zenith/2x/Office_Front-B1.png",1024,252.23225290202845],"Office_Front-C1":["/res/panelsoil/zenith/2x/Office_Front-C1.png",1024,250.53452113999322],"Office_Front-D1":["/res/panelsoil/zenith/2x/Office_Front-D1.png",1024,254.14937503955156],"Office_Front-A2":["/res/panelsoil/zenith/2x/Office_Front-A2.png",1024,268.14692158766144],"Office_Front-B2":["/res/panelsoil/zenith/2x/Office_Front-B2.png",1024,263.58812107401076],"Office_Front-C2":["/res/panelsoil/zenith/2x/Office_Front-C2.png",1024,264.23548091198614],"Office_Front-D2":["/res/panelsoil/zenith/2x/Office_Front-D2.png",1024,267.58273298533146],"Office_Front-A3":["/res/panelsoil/zenith/2x/Office_Front-A3.png",1024,275.6346218720404],"Office_Front-B3":["/res/panelsoil/zenith/2x/Office_Front-B3.png",1024,281.0353221342039],"Office_Front-C3":["/res/panelsoil/zenith/2x/Office_Front-C3.png",1024,278.09815113483586],"Office_Front-D3":["/res/panelsoil/zenith/2x/Office_Front-D3.png",1024,283.47819583312196],"Office_Front-A4":["/res/panelsoil/zenith/2x/Office_Front-A4.png",1024,282.98236942891094],"Office_Front-B4":["/res/panelsoil/zenith/2x/Office_Front-B4.png",1024,291.13595153135776],"Office_Front-C4":["/res/panelsoil/zenith/2x/Office_Front-C4.png",1024,298.5501919597199],"Office_Front-D4":["/res/panelsoil/zenith/2x/Office_Front-D4.png",1024,297.85564092556695],"Office_Front-A5":["/res/panelsoil/zenith/2x/Office_Front-A5.png",1024,297.89760132941706],"Office_Front-B5":["/res/panelsoil/zenith/2x/Office_Front-B5.png",1024,298.1402990935222],"Office_Front-C5":["/res/panelsoil/zenith/2x/Office_Front-C5.png",1024,306.40271873108196],"Office_Front-D5":["/res/panelsoil/zenith/2x/Office_Front-D5.png",1024,313.48446206466815],"Office_Front-A6":["/res/panelsoil/zenith/2x/Office_Front-A6.png",1024,308.0172649772152],"Office_Front-B6":["/res/panelsoil/zenith/2x/Office_Front-B6.png",1024,311.7005987076547],"Office_Front-C6":["/res/panelsoil/zenith/2x/Office_Front-C6.png",1024,320.2391230846407],"Office_Front-D6":["/res/panelsoil/zenith/2x/Office_Front-D6.png",1024,322.6101670345459],"Office_Front-A7":["/res/panelsoil/zenith/2x/Office_Front-A7.png",1024,329.5735713842881],"Office_Front-B7":["/res/panelsoil/zenith/2x/Office_Front-B7.png",1024,333.62927233172],"Office_Front-C7":["/res/panelsoil/zenith/2x/Office_Front-C7.png",1024,327.8182612071598],"Office_Front-D7":["/res/panelsoil/zenith/2x/Office_Front-D7.png",1024,335.99162311343963],"Office_Front-A8":["/res/panelsoil/zenith/2x/Office_Front-A8.png",1024,339.65259076052297],"Office_Front-B8":["/res/panelsoil/zenith/2x/Office_Front-B8.png",1024,336.30531753020546],"Office_Front-C8":["/res/panelsoil/zenith/2x/Office_Front-C8.png",1024,344.1983610548814],"Office_Front-D8":["/res/panelsoil/zenith/2x/Office_Front-D8.png",1024,347.5412162195976],"Office_Front-A9":["/res/panelsoil/zenith/2x/Office_Front-A9.png",1024,352.85748800995736],"Office_Front-B9":["/res/panelsoil/zenith/2x/Office_Front-B9.png",1024,354.004008539073],"Office_Front-C9":["/res/panelsoil/zenith/2x/Office_Front-C9.png",1024,360.6746285344373],"Office_Front-D9":["/res/panelsoil/zenith/2x/Office_Front-D9.png",1024,359.3922073057151],"Office_Front-A11":["/res/panelsoil/zenith/2x/Office_Front-A11.png",1024,380.3261703201629],"Office_Front-B11":["/res/panelsoil/zenith/2x/Office_Front-B11.png",1024,378.0317262941142],"Office_Front-C11":["/res/panelsoil/zenith/2x/Office_Front-C11.png",1024,384.2255431224346],"Office_Front-D11":["/res/panelsoil/zenith/2x/Office_Front-D11.png",1024,382.5034314493086],"Office_Front-A12":["/res/panelsoil/zenith/2x/Office_Front-A12.png",1024,390.35974647728733],"Office_Front-B12":["/res/panelsoil/zenith/2x/Office_Front-B12.png",1024,396.3491262286027],"Office_Front-C12":["/res/panelsoil/zenith/2x/Office_Front-C12.png",1024,396.0134057441169],"Office_Front-D12":["/res/panelsoil/zenith/2x/Office_Front-D12.png",1024,397.0991147680031],"Office_Front-A13":["/res/panelsoil/zenith/2x/Office_Front-A13.png",1024,399.08308726711357],"Office_Front-B13":["/res/panelsoil/zenith/2x/Office_Front-B13.png",1024,402.59390862593744],"Office_Front-C13":["/res/panelsoil/zenith/2x/Office_Front-C13.png",1024,408.0581288617609],"Office_Front-D13":["/res/panelsoil/zenith/2x/Office_Front-D13.png",1024,415.3315516764753],"Office_Front-A14":["/res/panelsoil/zenith/2x/Office_Front-A14.png",1024,406.26102590911887],"Office_Front-C14":["/res/panelsoil/zenith/2x/Office_Front-C14.png",1024,423.51688160790656],"Office_Front-D14":["/res/panelsoil/zenith/2x/Office_Front-D14.png",1024,422.92489477026635],"Office_Front-A15":["/res/panelsoil/zenith/2x/Office_Front-A15.png",1024,424.145947551784],"Office_Front-B15":["/res/panelsoil/zenith/2x/Office_Front-B15.png",1024,426.7275997925895],"Office_Front-C15":["/res/panelsoil/zenith/2x/Office_Front-C15.png",1024,433.26238936764184],"Office_Front-D15":["/res/panelsoil/zenith/2x/Office_Front-D15.png",1024,434.14120032324456],"Office_Front-A16":["/res/panelsoil/zenith/2x/Office_Front-A16.png",1024,441.9584692066523],"Office_Front-B16":["/res/panelsoil/zenith/2x/Office_Front-B16.png",1024,437.8359882545017],"Office_Front-C16":["/res/panelsoil/zenith/2x/Office_Front-C16.png",1024,441.0633203883878],"Office_Front-D16":["/res/panelsoil/zenith/2x/Office_Front-D16.png",1024,444.0437753226371],"Platform_Back-A1":["/res/panelsoil/zenith/2x/Platform_Back-A1.png",1024,1254.7875812075097],"Platform_Back-B1":["/res/panelsoil/zenith/2x/Platform_Back-B1.png",1024,1251.299224395777],"Platform_Back-C1":["/res/panelsoil/zenith/2x/Platform_Back-C1.png",1024,1253.087342575187],"Platform_Back-D1":["/res/panelsoil/zenith/2x/Platform_Back-D1.png",1024,1263.1617079033347],"Platform_Back-A2":["/res/panelsoil/zenith/2x/Platform_Back-A2.png",1024,1260.214057574501],"Platform_Back-B2":["/res/panelsoil/zenith/2x/Platform_Back-B2.png",1024,1267.974824551569],"Platform_Back-C2":["/res/panelsoil/zenith/2x/Platform_Back-C2.png",1024,1272.6554903131894],"Platform_Back-D2":["/res/panelsoil/zenith/2x/Platform_Back-D2.png",1024,1266.5763712289859],"Platform_Back-A3":["/res/panelsoil/zenith/2x/Platform_Back-A3.png",1024,1278.9212674646758],"Platform_Back-B3":["/res/panelsoil/zenith/2x/Platform_Back-B3.png",1024,1274.1617276209631],"Platform_Back-C3":["/res/panelsoil/zenith/2x/Platform_Back-C3.png",1024,1282.3489254812162],"Platform_Back-D3":["/res/panelsoil/zenith/2x/Platform_Back-D3.png",1024,1281.2942206434636],"Platform_Back-A4":["/res/panelsoil/zenith/2x/Platform_Back-A4.png",1024,1290.1765873697332],"Platform_Back-B4":["/res/panelsoil/zenith/2x/Platform_Back-B4.png",1024,1289.029541107575],"Platform_Back-C4":["/res/panelsoil/zenith/2x/Platform_Back-C4.png",1024,1289.0502675799692],"Platform_Back-D4":["/res/panelsoil/zenith/2x/Platform_Back-D4.png",1024,1301.5686536254304],"Platform_Front-A1":["/res/panelsoil/zenith/2x/Platform_Front-A1.png",1024,1253.0692008675412],"Platform_Front-B1":["/res/panelsoil/zenith/2x/Platform_Front-B1.png",1024,1248.5845533109436],"Platform_Front-C1":["/res/panelsoil/zenith/2x/Platform_Front-C1.png",1024,1257.460673182929],"Platform_Front-D1":["/res/panelsoil/zenith/2x/Platform_Front-D1.png",1024,1262.4696150693464],"Platform_Front-A2":["/res/panelsoil/zenith/2x/Platform_Front-A2.png",1024,1263.4304414773846],"Platform_Front-B2":["/res/panelsoil/zenith/2x/Platform_Front-B2.png",1024,1266.7769517515153],"Platform_Front-C2":["/res/panelsoil/zenith/2x/Platform_Front-C2.png",1024,1264.945495446154],"Platform_Front-D2":["/res/panelsoil/zenith/2x/Platform_Front-D2.png",1024,1273.4833985884063],"Platform_Front-A3":["/res/panelsoil/zenith/2x/Platform_Front-A3.png",1024,1269.4595360920543],"Platform_Front-B3":["/res/panelsoil/zenith/2x/Platform_Front-B3.png",1024,1281.8189388482567],"Platform_Front-C3":["/res/panelsoil/zenith/2x/Platform_Front-C3.png",1024,1285.6912659472875],"Platform_Front-D3":["/res/panelsoil/zenith/2x/Platform_Front-D3.png",1024,1290.2685670757064],"Platform_Front-A4":["/res/panelsoil/zenith/2x/Platform_Front-A4.png",1024,1282.8676536877424],"Platform_Front-B4":["/res/panelsoil/zenith/2x/Platform_Front-B4.png",1024,1295.162908764853],"Platform_Front-C4":["/res/panelsoil/zenith/2x/Platform_Front-C4.png",1024,1294.1524378370343],"Platform_Front-D4":["/res/panelsoil/zenith/2x/Platform_Front-D4.png",1024,1293.6767778028845]},"4x":{"Arena_A1-A1":["/res/panelsoil/zenith/4x/Arena_A1-A1.png",1024,-97.06685448363316],"Arena_A1-B1":["/res/panelsoil/zenith/4x/Arena_A1-B1.png",1024,-98.77313962127208],"Arena_A1-C1":["/res/panelsoil/zenith/4x/Arena_A1-C1.png",1024,-89.35584539549119],"Arena_A1-D1":["/res/panelsoil/zenith/4x/Arena_A1-D1.png",1024,-92.10151302911814],"Arena_A1-A2":["/res/panelsoil/zenith/4x/Arena_A1-A2.png",1024,-82.76462801280866],"Arena_A1-B2":["/res/panelsoil/zenith/4x/Arena_A1-B2.png",1024,-88.22690294972493],"Arena_A1-C2":["/res/panelsoil/zenith/4x/Arena_A1-C2.png",1024,-78.38676509404898],"Arena_A1-D2":["/res/panelsoil/zenith/4x/Arena_A1-D2.png",1024,-78.2869920654431],"Arena_A1-A3":["/res/panelsoil/zenith/4x/Arena_A1-A3.png",1024,-71.66715561004384],"Arena_A1-B3":["/res/panelsoil/zenith/4x/Arena_A1-B3.png",1024,-73.02966592421001],"Arena_A1-C3":["/res/panelsoil/zenith/4x/Arena_A1-C3.png",1024,-65.89704887904965],"Arena_A1-D3":["/res/panelsoil/zenith/4x/Arena_A1-D3.png",1024,-62.83880409773005],"Arena_A1-A4":["/res/panelsoil/zenith/4x/Arena_A1-A4.png",1024,-56.30740226658689],"Arena_A1-B4":["/res/panelsoil/zenith/4x/Arena_A1-B4.png",1024,-60.77597418001759],"Arena_A1-C4":["/res/panelsoil/zenith/4x/Arena_A1-C4.png",1024,-56.75472332976999],"Arena_A1-D4":["/res/panelsoil/zenith/4x/Arena_A1-D4.png",1024,-57.52891421339376],"Arena_A1-A5":["/res/panelsoil/zenith/4x/Arena_A1-A5.png",1024,-44.07828500766345],"Arena_A1-B5":["/res/panelsoil/zenith/4x/Arena_A1-B5.png",1024,-41.87429662046316],"Arena_A1-C5":["/res/panelsoil/zenith/4x/Arena_A1-C5.png",1024,-40.551240936145376],"Arena_A1-D5":["/res/panelsoil/zenith/4x/Arena_A1-D5.png",1024,-35.48836736676866],"Arena_B1-A1":["/res/panelsoil/zenith/4x/Arena_B1-A1.png",1024,-48.67354217246617],"Arena_B1-B1":["/res/panelsoil/zenith/4x/Arena_B1-B1.png",1024,-37.6459647794023],"Arena_B1-C1":["/res/panelsoil/zenith/4x/Arena_B1-C1.png",1024,-32.99841092216446],"Arena_B1-D1":["/res/panelsoil/zenith/4x/Arena_B1-D1.png",1024,-34.15839681068023],"Arena_B1-A2":["/res/panelsoil/zenith/4x/Arena_B1-A2.png",1024,-30.60686290132748],"Arena_B1-B2":["/res/panelsoil/zenith/4x/Arena_B1-B2.png",1024,-25.831700654441427],"Arena_B1-C2":["/res/panelsoil/zenith/4x/Arena_B1-C2.png",1024,-22.07147786988741],"Arena_B1-D2":["/res/panelsoil/zenith/4x/Arena_B1-D2.png",1024,-28.063712670433873],"Arena_B1-A3":["/res/panelsoil/zenith/4x/Arena_B1-A3.png",1024,-23.89796048760872],"Arena_B1-B3":["/res/panelsoil/zenith/4x/Arena_B1-B3.png",1024,-22.886432141093135],"Arena_B1-C3":["/res/panelsoil/zenith/4x/Arena_B1-C3.png",1024,-16.24013233821678],"Arena_B1-D3":["/res/panelsoil/zenith/4x/Arena_B1-D3.png",1024,-8.360585414866089],"Arena_B1-A4":["/res/panelsoil/zenith/4x/Arena_B1-A4.png",1024,-3.124331786577093],"Arena_B1-B4":["/res/panelsoil/zenith/4x/Arena_B1-B4.png",1024,-10.610297817688181],"Arena_B1-C4":["/res/panelsoil/zenith/4x/Arena_B1-C4.png",1024,3.3734205794555248],"Arena_B1-D4":["/res/panelsoil/zenith/4x/Arena_B1-D4.png",1024,5.600822378771285],"Arena_B1-A5":["/res/panelsoil/zenith/4x/Arena_B1-A5.png",1024,8.126846452720569],"Arena_B1-B5":["/res/panelsoil/zenith/4x/Arena_B1-B5.png",1024,5.290867322253941],"Arena_B1-C5":["/res/panelsoil/zenith/4x/Arena_B1-C5.png",1024,11.465365001809179],"Arena_B1-D5":["/res/panelsoil/zenith/4x/Arena_B1-D5.png",1024,12.938032801385312],"Arena_B2-A1":["/res/panelsoil/zenith/4x/Arena_B2-A1.png",1024,-45.97352187640337],"Arena_B2-B1":["/res/panelsoil/zenith/4x/Arena_B2-B1.png",1024,-42.2463730089848],"Arena_B2-C1":["/res/panelsoil/zenith/4x/Arena_B2-C1.png",1024,-38.35226027582508],"Arena_B2-D1":["/res/panelsoil/zenith/4x/Arena_B2-D1.png",1024,-34.941614134313646],"Arena_B2-A2":["/res/panelsoil/zenith/4x/Arena_B2-A2.png",1024,-35.076671081591044],"Arena_B2-B2":["/res/panelsoil/zenith/4x/Arena_B2-B2.png",1024,-31.817311430079513],"Arena_B2-C2":["/res/panelsoil/zenith/4x/Arena_B2-C2.png",1024,-24.554001029589855],"Arena_B2-D2":["/res/panelsoil/zenith/4x/Arena_B2-D2.png",1024,-21.471097309697164],"Arena_B2-A3":["/res/panelsoil/zenith/4x/Arena_B2-A3.png",1024,-16.349530238372886],"Arena_B2-B3":["/res/panelsoil/zenith/4x/Arena_B2-B3.png",1024,-14.968313281026692],"Arena_B2-C3":["/res/panelsoil/zenith/4x/Arena_B2-C3.png",1024,-10.773020956982597],"Arena_B2-D3":["/res/panelsoil/zenith/4x/Arena_B2-D3.png",1024,-7.03770961990924],"Arena_B3-A1":["/res/panelsoil/zenith/4x/Arena_B3-A1.png",1024,-31.40771496424873],"Arena_B3-B1":["/res/panelsoil/zenith/4x/Arena_B3-B1.png",1024,-24.616334074289995],"Arena_B3-C1":["/res/panelsoil/zenith/4x/Arena_B3-C1.png",1024,-21.033950711586336],"Arena_B3-D1":["/res/panelsoil/zenith/4x/Arena_B3-D1.png",1024,-23.519112461670243],"Arena_B3-A2":["/res/panelsoil/zenith/4x/Arena_B3-A2.png",1024,-20.925884528992615],"Arena_B3-B2":["/res/panelsoil/zenith/4x/Arena_B3-B2.png",1024,-17.322714127520822],"Arena_B3-C2":["/res/panelsoil/zenith/4x/Arena_B3-C2.png",1024,-10.78853745727608],"Arena_B3-D2":["/res/panelsoil/zenith/4x/Arena_B3-D2.png",1024,-16.958825006538987],"Arena_B3-A3":["/res/panelsoil/zenith/4x/Arena_B3-A3.png",1024,-9.937656720462854],"Arena_B3-C3":["/res/panelsoil/zenith/4x/Arena_B3-C3.png",1024,-3.0669464316052153],"Arena_B3-D3":["/res/panelsoil/zenith/4x/Arena_B3-D3.png",1024,-.7207821499337896],"Arena_B3-A4":["/res/panelsoil/zenith/4x/Arena_B3-A4.png",1024,8.607637540726596],"Arena_B3-D4":["/res/panelsoil/zenith/4x/Arena_B3-D4.png",1024,18.906799373832456],"Arena_B3-A5":["/res/panelsoil/zenith/4x/Arena_B3-A5.png",1024,11.886826190369874],"Arena_B3-D5":["/res/panelsoil/zenith/4x/Arena_B3-D5.png",1024,31.933061608851318],"Arena_C1-B1":["/res/panelsoil/zenith/4x/Arena_C1-B1.png",1024,34.731192685462936],"Arena_C1-C1":["/res/panelsoil/zenith/4x/Arena_C1-C1.png",1024,34.92054535644745],"Arena_C1-B2":["/res/panelsoil/zenith/4x/Arena_C1-B2.png",1024,47.47099730707944],"Arena_C1-C2":["/res/panelsoil/zenith/4x/Arena_C1-C2.png",1024,46.01193544682598],"Arena_Front-A1":["/res/panelsoil/zenith/4x/Arena_Front-A1.png",1024,-102.96630800122149],"Arena_Front-B1":["/res/panelsoil/zenith/4x/Arena_Front-B1.png",1024,-93.97180617908197],"Arena_Front-C1":["/res/panelsoil/zenith/4x/Arena_Front-C1.png",1024,-90.55044766456086],"Arena_Front-D1":["/res/panelsoil/zenith/4x/Arena_Front-D1.png",1024,-87.82374893968625],"Arena_Front-A2":["/res/panelsoil/zenith/4x/Arena_Front-A2.png",1024,-87.03596749490711],"Arena_Front-B2":["/res/panelsoil/zenith/4x/Arena_Front-B2.png",1024,-78.20929317621597],"Arena_Front-C2":["/res/panelsoil/zenith/4x/Arena_Front-C2.png",1024,-77.95229747244747],"Arena_Front-D2":["/res/panelsoil/zenith/4x/Arena_Front-D2.png",1024,-76.80887333564931],"Arena_Front-A3":["/res/panelsoil/zenith/4x/Arena_Front-A3.png",1024,-72.12361709922371],"Arena_Front-B3":["/res/panelsoil/zenith/4x/Arena_Front-B3.png",1024,-75.62463570407654],"Arena_Front-C3":["/res/panelsoil/zenith/4x/Arena_Front-C3.png",1024,-70.59056039679574],"Arena_Front-D3":["/res/panelsoil/zenith/4x/Arena_Front-D3.png",1024,-68.79745075429526],"Arena_Front-A4":["/res/panelsoil/zenith/4x/Arena_Front-A4.png",1024,-59.41159449264432],"Arena_Front-B4":["/res/panelsoil/zenith/4x/Arena_Front-B4.png",1024,-60.41509819356812],"Arena_Front-C4":["/res/panelsoil/zenith/4x/Arena_Front-C4.png",1024,-56.08865121177436],"Arena_Front-D4":["/res/panelsoil/zenith/4x/Arena_Front-D4.png",1024,-55.04783288702904],"Arena_Front-A5":["/res/panelsoil/zenith/4x/Arena_Front-A5.png",1024,-48.11174200456822],"Arena_Front-B5":["/res/panelsoil/zenith/4x/Arena_Front-B5.png",1024,-49.778125093188855],"Arena_Front-C5":["/res/panelsoil/zenith/4x/Arena_Front-C5.png",1024,-46.326698382590024],"Arena_Front-D5":["/res/panelsoil/zenith/4x/Arena_Front-D5.png",1024,-42.46726520800624],"Arena_Front-A6":["/res/panelsoil/zenith/4x/Arena_Front-A6.png",1024,-40.58859598732733],"Arena_Front-B6":["/res/panelsoil/zenith/4x/Arena_Front-B6.png",1024,-39.77077000587806],"Arena_Front-C6":["/res/panelsoil/zenith/4x/Arena_Front-C6.png",1024,-31.92713537788378],"Arena_Front-D6":["/res/panelsoil/zenith/4x/Arena_Front-D6.png",1024,-28.797282177310656],"Arena_Front-A7":["/res/panelsoil/zenith/4x/Arena_Front-A7.png",1024,-22.91118105135873],"Arena_Front-B7":["/res/panelsoil/zenith/4x/Arena_Front-B7.png",1024,-21.054203388050603],"Arena_Front-C7":["/res/panelsoil/zenith/4x/Arena_Front-C7.png",1024,-14.494356622527496],"Arena_Front-D7":["/res/panelsoil/zenith/4x/Arena_Front-D7.png",1024,-21.19725750503782],"Arena_Front-A8":["/res/panelsoil/zenith/4x/Arena_Front-A8.png",1024,-9.52610016026646],"Arena_Front-D8":["/res/panelsoil/zenith/4x/Arena_Front-D8.png",1024,2.7578522072375105],"Arena_Front-A9":["/res/panelsoil/zenith/4x/Arena_Front-A9.png",1024,1.7457737084464746],"Arena_Front-B9":["/res/panelsoil/zenith/4x/Arena_Front-B9.png",1024,9.15091429385483],"Arena_Front-C9":["/res/panelsoil/zenith/4x/Arena_Front-C9.png",1024,10.74687468757211],"Arena_Front-D9":["/res/panelsoil/zenith/4x/Arena_Front-D9.png",1024,4.114248156546518],"Arena_Front-A10":["/res/panelsoil/zenith/4x/Arena_Front-A10.png",1024,13.229066545048141],"Arena_Front-B10":["/res/panelsoil/zenith/4x/Arena_Front-B10.png",1024,11.930220847536145],"Arena_Front-C10":["/res/panelsoil/zenith/4x/Arena_Front-C10.png",1024,13.386006144713374],"Arena_Front-D10":["/res/panelsoil/zenith/4x/Arena_Front-D10.png",1024,24.378321443259672],"Arena_Front-A11":["/res/panelsoil/zenith/4x/Arena_Front-A11.png",1024,19.248370333413483],"Arena_Front-B11":["/res/panelsoil/zenith/4x/Arena_Front-B11.png",1024,28.967541690178372],"Arena_Front-C11":["/res/panelsoil/zenith/4x/Arena_Front-C11.png",1024,35.04320433627585],"Arena_Front-D11":["/res/panelsoil/zenith/4x/Arena_Front-D11.png",1024,33.54205965367434],"Arena_Front-A12":["/res/panelsoil/zenith/4x/Arena_Front-A12.png",1024,33.92105636839847],"Arena_Front-B12":["/res/panelsoil/zenith/4x/Arena_Front-B12.png",1024,45.04822270725345],"Arena_Front-C12":["/res/panelsoil/zenith/4x/Arena_Front-C12.png",1024,38.793387953025146],"Arena_Front-D12":["/res/panelsoil/zenith/4x/Arena_Front-D12.png",1024,43.07831369127259],"Casino_A1-A1":["/res/panelsoil/zenith/4x/Casino_A1-A1.png",1024,-254.58683032398577],"Casino_A1-B1":["/res/panelsoil/zenith/4x/Casino_A1-B1.png",1024,-241.1817804056192],"Casino_A1-C1":["/res/panelsoil/zenith/4x/Casino_A1-C1.png",1024,-238.6580234966655],"Casino_A1-A2":["/res/panelsoil/zenith/4x/Casino_A1-A2.png",1024,-233.66024840804388],"Casino_A1-B2":["/res/panelsoil/zenith/4x/Casino_A1-B2.png",1024,-236.0079662600959],"Casino_A1-C2":["/res/panelsoil/zenith/4x/Casino_A1-C2.png",1024,-234.43089885987038],"Casino_A1-A3":["/res/panelsoil/zenith/4x/Casino_A1-A3.png",1024,-228.75754471163097],"Casino_A1-B3":["/res/panelsoil/zenith/4x/Casino_A1-B3.png",1024,-220.83566335816377],"Casino_A1-C3":["/res/panelsoil/zenith/4x/Casino_A1-C3.png",1024,-211.79410812601873],"Casino_A1-A4":["/res/panelsoil/zenith/4x/Casino_A1-A4.png",1024,-217.8396186872136],"Casino_A1-B4":["/res/panelsoil/zenith/4x/Casino_A1-B4.png",1024,-213.73364099590052],"Casino_A1-C4":["/res/panelsoil/zenith/4x/Casino_A1-C4.png",1024,-208.67369702447533],"Casino_A1-A5":["/res/panelsoil/zenith/4x/Casino_A1-A5.png",1024,-196.1749628389307],"Casino_A1-B5":["/res/panelsoil/zenith/4x/Casino_A1-B5.png",1024,-199.37592518250298],"Casino_A1-C5":["/res/panelsoil/zenith/4x/Casino_A1-C5.png",1024,-187.59384229991073],"Casino_A1-A6":["/res/panelsoil/zenith/4x/Casino_A1-A6.png",1024,-187.59325206018104],"Casino_A1-B6":["/res/panelsoil/zenith/4x/Casino_A1-B6.png",1024,-189.08276510244013],"Casino_A1-C6":["/res/panelsoil/zenith/4x/Casino_A1-C6.png",1024,-176.69363601435452],"Casino_A1-A7":["/res/panelsoil/zenith/4x/Casino_A1-A7.png",1024,-178.17257563648536],"Casino_A1-B7":["/res/panelsoil/zenith/4x/Casino_A1-B7.png",1024,-175.8691158136216],"Casino_A1-C7":["/res/panelsoil/zenith/4x/Casino_A1-C7.png",1024,-165.5829593117211],"Casino_A1b-A1":["/res/panelsoil/zenith/4x/Casino_A1b-A1.png",1024,-243.8721933771122],"Casino_A1b-D1":["/res/panelsoil/zenith/4x/Casino_A1b-D1.png",1024,-241.5972863649871],"Casino_A1b-A2":["/res/panelsoil/zenith/4x/Casino_A1b-A2.png",1024,-242.8492329833741],"Casino_A1b-D2":["/res/panelsoil/zenith/4x/Casino_A1b-D2.png",1024,-223.71089959046202],"Casino_A1b-A3":["/res/panelsoil/zenith/4x/Casino_A1b-A3.png",1024,-228.53768170115853],"Casino_A1b-D3":["/res/panelsoil/zenith/4x/Casino_A1b-D3.png",1024,-217.73876588923827],"Casino_A1b-A4":["/res/panelsoil/zenith/4x/Casino_A1b-A4.png",1024,-215.5867842727743],"Casino_A1b-D4":["/res/panelsoil/zenith/4x/Casino_A1b-D4.png",1024,-208.27915816305884],"Casino_A1b-A5":["/res/panelsoil/zenith/4x/Casino_A1b-A5.png",1024,-202.55098772776535],"Casino_A1b-D5":["/res/panelsoil/zenith/4x/Casino_A1b-D5.png",1024,-195.68853039535142],"Casino_A1b-A6":["/res/panelsoil/zenith/4x/Casino_A1b-A6.png",1024,-191.30305740070938],"Casino_A1b-D6":["/res/panelsoil/zenith/4x/Casino_A1b-D6.png",1024,-177.91853892604442],"Casino_B1-A1":["/res/panelsoil/zenith/4x/Casino_B1-A1.png",1024,-131.3280238096875],"Casino_B1-B1":["/res/panelsoil/zenith/4x/Casino_B1-B1.png",1024,-131.21861599851383],"Casino_B1-C1":["/res/panelsoil/zenith/4x/Casino_B1-C1.png",1024,-125.33563340564316],"Casino_B1-D1":["/res/panelsoil/zenith/4x/Casino_B1-D1.png",1024,-128.660534685431],"Casino_B1-A2":["/res/panelsoil/zenith/4x/Casino_B1-A2.png",1024,-126.40571237759467],"Casino_B1-B2":["/res/panelsoil/zenith/4x/Casino_B1-B2.png",1024,-116.48269082152784],"Casino_B1-C2":["/res/panelsoil/zenith/4x/Casino_B1-C2.png",1024,-118.2068919936416],"Casino_B1-D2":["/res/panelsoil/zenith/4x/Casino_B1-D2.png",1024,-112.6539144823225],"Casino_B1-A3":["/res/panelsoil/zenith/4x/Casino_B1-A3.png",1024,-109.96981563971816],"Casino_B1-B3":["/res/panelsoil/zenith/4x/Casino_B1-B3.png",1024,-101.90712299027007],"Casino_B1-C3":["/res/panelsoil/zenith/4x/Casino_B1-C3.png",1024,-105.83851835444882],"Casino_B1-D3":["/res/panelsoil/zenith/4x/Casino_B1-D3.png",1024,-101.5423942934817],"Casino_B1-A4":["/res/panelsoil/zenith/4x/Casino_B1-A4.png",1024,-89.71318230143471],"Casino_B1-B4":["/res/panelsoil/zenith/4x/Casino_B1-B4.png",1024,-98.52544878335713],"Casino_B1-C4":["/res/panelsoil/zenith/4x/Casino_B1-C4.png",1024,-83.12939566614473],"Casino_B1-D4":["/res/panelsoil/zenith/4x/Casino_B1-D4.png",1024,-80.60526857364172],"Casino_B2-A1":["/res/panelsoil/zenith/4x/Casino_B2-A1.png",1024,-128.15838480160426],"Casino_B2-B1":["/res/panelsoil/zenith/4x/Casino_B2-B1.png",1024,-127.08300200740189],"Casino_B2-C1":["/res/panelsoil/zenith/4x/Casino_B2-C1.png",1024,-127.08335516249171],"Casino_B2-D1":["/res/panelsoil/zenith/4x/Casino_B2-D1.png",1024,-129.01849493609046],"Casino_B2-A2":["/res/panelsoil/zenith/4x/Casino_B2-A2.png",1024,-119.08002072609825],"Casino_B2-B2":["/res/panelsoil/zenith/4x/Casino_B2-B2.png",1024,-122.45988177286787],"Casino_B2-C2":["/res/panelsoil/zenith/4x/Casino_B2-C2.png",1024,-117.19221671378256],"Casino_B2-D2":["/res/panelsoil/zenith/4x/Casino_B2-D2.png",1024,-107.40331042538077],"Casino_B2-A3":["/res/panelsoil/zenith/4x/Casino_B2-A3.png",1024,-109.95841812304911],"Casino_B2-B3":["/res/panelsoil/zenith/4x/Casino_B2-B3.png",1024,-110.87452545605686],"Casino_B2-C3":["/res/panelsoil/zenith/4x/Casino_B2-C3.png",1024,-102.09560089604432],"Casino_B2-D3":["/res/panelsoil/zenith/4x/Casino_B2-D3.png",1024,-98.02145090159242],"Casino_Front-A1":["/res/panelsoil/zenith/4x/Casino_Front-A1.png",1024,-244.11305558191646],"Casino_Front-B1":["/res/panelsoil/zenith/4x/Casino_Front-B1.png",1024,-246.57413751065044],"Casino_Front-C1":["/res/panelsoil/zenith/4x/Casino_Front-C1.png",1024,-247.68967878823298],"Casino_Front-D1":["/res/panelsoil/zenith/4x/Casino_Front-D1.png",1024,-240.36816481832335],"Casino_Front-A2":["/res/panelsoil/zenith/4x/Casino_Front-A2.png",1024,-236.59950759967398],"Casino_Front-B2":["/res/panelsoil/zenith/4x/Casino_Front-B2.png",1024,-238.08547982949196],"Casino_Front-C2":["/res/panelsoil/zenith/4x/Casino_Front-C2.png",1024,-234.45151955752902],"Casino_Front-D2":["/res/panelsoil/zenith/4x/Casino_Front-D2.png",1024,-231.38628271786263],"Casino_Front-A3":["/res/panelsoil/zenith/4x/Casino_Front-A3.png",1024,-228.89376103933412],"Casino_Front-B3":["/res/panelsoil/zenith/4x/Casino_Front-B3.png",1024,-222.11349537588842],"Casino_Front-C3":["/res/panelsoil/zenith/4x/Casino_Front-C3.png",1024,-219.29665468885105],"Casino_Front-D3":["/res/panelsoil/zenith/4x/Casino_Front-D3.png",1024,-213.3681958430248],"Casino_Front-A4":["/res/panelsoil/zenith/4x/Casino_Front-A4.png",1024,-211.120058184511],"Casino_Front-B4":["/res/panelsoil/zenith/4x/Casino_Front-B4.png",1024,-212.01650875382236],"Casino_Front-C4":["/res/panelsoil/zenith/4x/Casino_Front-C4.png",1024,-205.91964226113504],"Casino_Front-D4":["/res/panelsoil/zenith/4x/Casino_Front-D4.png",1024,-204.13491034151625],"Casino_Front-A5":["/res/panelsoil/zenith/4x/Casino_Front-A5.png",1024,-200.42623787412452],"Casino_Front-B5":["/res/panelsoil/zenith/4x/Casino_Front-B5.png",1024,-198.0323268277825],"Casino_Front-C5":["/res/panelsoil/zenith/4x/Casino_Front-C5.png",1024,-194.49897033917821],"Casino_Front-D5":["/res/panelsoil/zenith/4x/Casino_Front-D5.png",1024,-187.83732558399552],"Casino_Front-A6":["/res/panelsoil/zenith/4x/Casino_Front-A6.png",1024,-181.38723640844702],"Casino_Front-B6":["/res/panelsoil/zenith/4x/Casino_Front-B6.png",1024,-182.69754365033776],"Casino_Front-C6":["/res/panelsoil/zenith/4x/Casino_Front-C6.png",1024,-181.80047248126667],"Casino_Front-D6":["/res/panelsoil/zenith/4x/Casino_Front-D6.png",1024,-184.07160667216976],"Casino_Front-A7":["/res/panelsoil/zenith/4x/Casino_Front-A7.png",1024,-171.36186850227307],"Casino_Front-B7":["/res/panelsoil/zenith/4x/Casino_Front-B7.png",1024,-173.11462809938547],"Casino_Front-C7":["/res/panelsoil/zenith/4x/Casino_Front-C7.png",1024,-168.4233871598113],"Casino_Front-D7":["/res/panelsoil/zenith/4x/Casino_Front-D7.png",1024,-170.1909292354299],"Casino_Front-A8":["/res/panelsoil/zenith/4x/Casino_Front-A8.png",1024,-156.98650281320167],"Casino_Front-B8":["/res/panelsoil/zenith/4x/Casino_Front-B8.png",1024,-154.46674196239252],"Casino_Front-C8":["/res/panelsoil/zenith/4x/Casino_Front-C8.png",1024,-160.09448745071134],"Casino_Front-D8":["/res/panelsoil/zenith/4x/Casino_Front-D8.png",1024,-149.67402804514097],"Casino_Front-A9":["/res/panelsoil/zenith/4x/Casino_Front-A9.png",1024,-145.6219953584883],"Casino_Front-B9":["/res/panelsoil/zenith/4x/Casino_Front-B9.png",1024,-152.2017195010225],"Casino_Front-C9":["/res/panelsoil/zenith/4x/Casino_Front-C9.png",1024,-147.70961419177002],"Casino_Front-D9":["/res/panelsoil/zenith/4x/Casino_Front-D9.png",1024,-143.8850089835649],"Casino_Front-A10":["/res/panelsoil/zenith/4x/Casino_Front-A10.png",1024,-133.5640776709733],"Casino_Front-B10":["/res/panelsoil/zenith/4x/Casino_Front-B10.png",1024,-139.38588506554672],"Casino_Front-C10":["/res/panelsoil/zenith/4x/Casino_Front-C10.png",1024,-125.6269391927508],"Casino_Front-D10":["/res/panelsoil/zenith/4x/Casino_Front-D10.png",1024,-126.88917301696418],"Casino_Front-A11":["/res/panelsoil/zenith/4x/Casino_Front-A11.png",1024,-123.48843372559465],"Casino_Front-B11":["/res/panelsoil/zenith/4x/Casino_Front-B11.png",1024,-121.28554799324274],"Casino_Front-C11":["/res/panelsoil/zenith/4x/Casino_Front-C11.png",1024,-123.96590407126475],"Casino_Front-D11":["/res/panelsoil/zenith/4x/Casino_Front-D11.png",1024,-116.37135310135275],"Casino_Front-A12":["/res/panelsoil/zenith/4x/Casino_Front-A12.png",1024,-107.55439176677228],"Casino_Front-B12":["/res/panelsoil/zenith/4x/Casino_Front-B12.png",1024,-109.09327408165746],"Casino_Front-C12":["/res/panelsoil/zenith/4x/Casino_Front-C12.png",1024,-101.0792917955454],"Casino_Front-D12":["/res/panelsoil/zenith/4x/Casino_Front-D12.png",1024,-100.03574069476689],"Core_A1-A1":["/res/panelsoil/zenith/4x/Core_A1-A1.png",1024,715.6883885756041],"Core_A1-B1":["/res/panelsoil/zenith/4x/Core_A1-B1.png",1024,718.740368835721],"Core_A1-C1":["/res/panelsoil/zenith/4x/Core_A1-C1.png",1024,718.8634157294914],"Core_A1-D1":["/res/panelsoil/zenith/4x/Core_A1-D1.png",1024,728.0453991668849],"Core_A1-A2":["/res/panelsoil/zenith/4x/Core_A1-A2.png",1024,725.2831780295222],"Core_A1-B2":["/res/panelsoil/zenith/4x/Core_A1-B2.png",1024,735.9630021329092],"Core_A1-C2":["/res/panelsoil/zenith/4x/Core_A1-C2.png",1024,733.6882004136204],"Core_A1-D2":["/res/panelsoil/zenith/4x/Core_A1-D2.png",1024,740.1979817763872],"Core_A1-A3":["/res/panelsoil/zenith/4x/Core_A1-A3.png",1024,737.581456898719],"Core_A1-B3":["/res/panelsoil/zenith/4x/Core_A1-B3.png",1024,749.0490009080324],"Core_A1-C3":["/res/panelsoil/zenith/4x/Core_A1-C3.png",1024,752.318270550079],"Core_A1-D3":["/res/panelsoil/zenith/4x/Core_A1-D3.png",1024,751.1583601700289],"Core_A1-A4":["/res/panelsoil/zenith/4x/Core_A1-A4.png",1024,751.8349018119332],"Core_A1-B4":["/res/panelsoil/zenith/4x/Core_A1-B4.png",1024,759.1802545730544],"Core_A1-C4":["/res/panelsoil/zenith/4x/Core_A1-C4.png",1024,765.1693015212048],"Core_A1-D4":["/res/panelsoil/zenith/4x/Core_A1-D4.png",1024,758.9489746812942],"Core_A1-A5":["/res/panelsoil/zenith/4x/Core_A1-A5.png",1024,763.4880406481819],"Core_A1-B5":["/res/panelsoil/zenith/4x/Core_A1-B5.png",1024,771.1794713038628],"Core_A1-C5":["/res/panelsoil/zenith/4x/Core_A1-C5.png",1024,768.8321268729445],"Core_A1-D5":["/res/panelsoil/zenith/4x/Core_A1-D5.png",1024,774.028286158624],"Core_A1-A6":["/res/panelsoil/zenith/4x/Core_A1-A6.png",1024,779.1837944953758],"Core_A1-B6":["/res/panelsoil/zenith/4x/Core_A1-B6.png",1024,777.502205983438],"Core_A1-C6":["/res/panelsoil/zenith/4x/Core_A1-C6.png",1024,786.561691570841],"Core_A1-D6":["/res/panelsoil/zenith/4x/Core_A1-D6.png",1024,794.9628164784218],"Core_A1-A7":["/res/panelsoil/zenith/4x/Core_A1-A7.png",1024,789.1373158124455],"Core_A1-B7":["/res/panelsoil/zenith/4x/Core_A1-B7.png",1024,792.1585349138064],"Core_A1-C7":["/res/panelsoil/zenith/4x/Core_A1-C7.png",1024,792.7173046982838],"Core_A1-D7":["/res/panelsoil/zenith/4x/Core_A1-D7.png",1024,803.071011326301],"Core_A1-A8":["/res/panelsoil/zenith/4x/Core_A1-A8.png",1024,804.952184894171],"Core_A1-B8":["/res/panelsoil/zenith/4x/Core_A1-B8.png",1024,812.6526231780593],"Core_A1-C8":["/res/panelsoil/zenith/4x/Core_A1-C8.png",1024,812.7755815633888],"Core_A1-D8":["/res/panelsoil/zenith/4x/Core_A1-D8.png",1024,819.0324269663258],"Core_B1-A1":["/res/panelsoil/zenith/4x/Core_B1-A1.png",1024,803.4753261421845],"Core_B1-B1":["/res/panelsoil/zenith/4x/Core_B1-B1.png",1024,814.0142837616743],"Core_B1-C1":["/res/panelsoil/zenith/4x/Core_B1-C1.png",1024,808.2966571548938],"Core_B1-D1":["/res/panelsoil/zenith/4x/Core_B1-D1.png",1024,822.6143369786442],"Core_B1-A2":["/res/panelsoil/zenith/4x/Core_B1-A2.png",1024,819.0185115572383],"Core_B1-B2":["/res/panelsoil/zenith/4x/Core_B1-B2.png",1024,819.9115324556178],"Core_B1-C2":["/res/panelsoil/zenith/4x/Core_B1-C2.png",1024,821.7094876683251],"Core_B1-D2":["/res/panelsoil/zenith/4x/Core_B1-D2.png",1024,828.8729259146268],"Core_B1-A3":["/res/panelsoil/zenith/4x/Core_B1-A3.png",1024,831.8369189800969],"Core_B1-B3":["/res/panelsoil/zenith/4x/Core_B1-B3.png",1024,830.466693073097],"Core_B1-C3":["/res/panelsoil/zenith/4x/Core_B1-C3.png",1024,839.4282270161477],"Core_B1-D3":["/res/panelsoil/zenith/4x/Core_B1-D3.png",1024,835.1864832736181],"Core_B1-A4":["/res/panelsoil/zenith/4x/Core_B1-A4.png",1024,848.255824765723],"Core_B1-B4":["/res/panelsoil/zenith/4x/Core_B1-B4.png",1024,851.0565139749748],"Core_B1-C4":["/res/panelsoil/zenith/4x/Core_B1-C4.png",1024,846.6698253628633],"Core_B1-D4":["/res/panelsoil/zenith/4x/Core_B1-D4.png",1024,853.0227228976875],"Core_B1-A5":["/res/panelsoil/zenith/4x/Core_B1-A5.png",1024,853.684526645612],"Core_B1-B5":["/res/panelsoil/zenith/4x/Core_B1-B5.png",1024,865.7730193581829],"Core_B1-C5":["/res/panelsoil/zenith/4x/Core_B1-C5.png",1024,857.363011337274],"Core_B1-D5":["/res/panelsoil/zenith/4x/Core_B1-D5.png",1024,861.6960843081622],"Core_B1-A6":["/res/panelsoil/zenith/4x/Core_B1-A6.png",1024,871.9736264133657],"Core_B1-B6":["/res/panelsoil/zenith/4x/Core_B1-B6.png",1024,877.7212246655048],"Core_B1-C6":["/res/panelsoil/zenith/4x/Core_B1-C6.png",1024,874.5515357260051],"Core_B1-D6":["/res/panelsoil/zenith/4x/Core_B1-D6.png",1024,875.4138934489949],"Core_B2-A1":["/res/panelsoil/zenith/4x/Core_B2-A1.png",1024,838.9074844795265],"Core_B2-B1":["/res/panelsoil/zenith/4x/Core_B2-B1.png",1024,841.4477020765905],"Core_B2-C1":["/res/panelsoil/zenith/4x/Core_B2-C1.png",1024,847.4969078272101],"Core_B2-D1":["/res/panelsoil/zenith/4x/Core_B2-D1.png",1024,849.4845313932043],"Core_B2-A2":["/res/panelsoil/zenith/4x/Core_B2-A2.png",1024,856.2016448592208],"Core_B2-B2":["/res/panelsoil/zenith/4x/Core_B2-B2.png",1024,852.9584729704811],"Core_B2-C2":["/res/panelsoil/zenith/4x/Core_B2-C2.png",1024,864.9863169917486],"Core_B2-D2":["/res/panelsoil/zenith/4x/Core_B2-D2.png",1024,863.0266856105466],"Core_B2-A3":["/res/panelsoil/zenith/4x/Core_B2-A3.png",1024,871.101665767167],"Core_B2-B3":["/res/panelsoil/zenith/4x/Core_B2-B3.png",1024,866.9985586611806],"Core_B2-C3":["/res/panelsoil/zenith/4x/Core_B2-C3.png",1024,877.1834373893876],"Core_B2-D3":["/res/panelsoil/zenith/4x/Core_B2-D3.png",1024,869.5221277394099],"Core_B2-A4":["/res/panelsoil/zenith/4x/Core_B2-A4.png",1024,883.204400046937],"Core_B2-B4":["/res/panelsoil/zenith/4x/Core_B2-B4.png",1024,886.8573839864878],"Core_B2-C4":["/res/panelsoil/zenith/4x/Core_B2-C4.png",1024,887.2602647529861],"Core_B2-D4":["/res/panelsoil/zenith/4x/Core_B2-D4.png",1024,891.2009901975255],"Core_C1-B1":["/res/panelsoil/zenith/4x/Core_C1-B1.png",1024,937.0959088184187],"Core_C1-C1":["/res/panelsoil/zenith/4x/Core_C1-C1.png",1024,934.1867629590597],"Core_C1-B2":["/res/panelsoil/zenith/4x/Core_C1-B2.png",1024,950.9260782720979],"Core_C1-C2":["/res/panelsoil/zenith/4x/Core_C1-C2.png",1024,946.6976897794029],"Core_Front-A1":["/res/panelsoil/zenith/4x/Core_Front-A1.png",1024,704.7639997239426],"Core_Front-B1":["/res/panelsoil/zenith/4x/Core_Front-B1.png",1024,707.0237279594744],"Core_Front-C1":["/res/panelsoil/zenith/4x/Core_Front-C1.png",1024,702.6227058609744],"Core_Front-D1":["/res/panelsoil/zenith/4x/Core_Front-D1.png",1024,710.4003316639554],"Core_Front-A2":["/res/panelsoil/zenith/4x/Core_Front-A2.png",1024,713.4594994768096],"Core_Front-B2":["/res/panelsoil/zenith/4x/Core_Front-B2.png",1024,719.3436291734864],"Core_Front-C2":["/res/panelsoil/zenith/4x/Core_Front-C2.png",1024,723.0818190101163],"Core_Front-D2":["/res/panelsoil/zenith/4x/Core_Front-D2.png",1024,725.0997272703379],"Core_Front-A3":["/res/panelsoil/zenith/4x/Core_Front-A3.png",1024,728.1743524348567],"Core_Front-B3":["/res/panelsoil/zenith/4x/Core_Front-B3.png",1024,727.3750207600549],"Core_Front-C3":["/res/panelsoil/zenith/4x/Core_Front-C3.png",1024,729.3685494505285],"Core_Front-D3":["/res/panelsoil/zenith/4x/Core_Front-D3.png",1024,733.0714572954448],"Core_Front-A4":["/res/panelsoil/zenith/4x/Core_Front-A4.png",1024,736.0499953761913],"Core_Front-B4":["/res/panelsoil/zenith/4x/Core_Front-B4.png",1024,745.9119825349122],"Core_Front-C4":["/res/panelsoil/zenith/4x/Core_Front-C4.png",1024,747.755316435676],"Core_Front-D4":["/res/panelsoil/zenith/4x/Core_Front-D4.png",1024,744.4407976255601],"Core_Front-A5":["/res/panelsoil/zenith/4x/Core_Front-A5.png",1024,750.0733496483575],"Core_Front-B5":["/res/panelsoil/zenith/4x/Core_Front-B5.png",1024,747.4441837755218],"Core_Front-C5":["/res/panelsoil/zenith/4x/Core_Front-C5.png",1024,757.4762732908717],"Core_Front-D5":["/res/panelsoil/zenith/4x/Core_Front-D5.png",1024,765.4012835227661],"Core_Front-A6":["/res/panelsoil/zenith/4x/Core_Front-A6.png",1024,763.6066972560988],"Core_Front-B6":["/res/panelsoil/zenith/4x/Core_Front-B6.png",1024,759.5249689115719],"Core_Front-C6":["/res/panelsoil/zenith/4x/Core_Front-C6.png",1024,771.0113141450965],"Core_Front-D6":["/res/panelsoil/zenith/4x/Core_Front-D6.png",1024,775.2856320265969],"Core_Front-A7":["/res/panelsoil/zenith/4x/Core_Front-A7.png",1024,774.09234349032],"Core_Front-B7":["/res/panelsoil/zenith/4x/Core_Front-B7.png",1024,778.7203224638159],"Core_Front-C7":["/res/panelsoil/zenith/4x/Core_Front-C7.png",1024,781.1419585519969],"Core_Front-D7":["/res/panelsoil/zenith/4x/Core_Front-D7.png",1024,779.673473433984],"Core_Front-A8":["/res/panelsoil/zenith/4x/Core_Front-A8.png",1024,790.2929855236948],"Core_Front-C8":["/res/panelsoil/zenith/4x/Core_Front-C8.png",1024,793.1252864520925],"Core_Front-D8":["/res/panelsoil/zenith/4x/Core_Front-D8.png",1024,794.4134392284875],"Core_Front-A9":["/res/panelsoil/zenith/4x/Core_Front-A9.png",1024,794.0655920237167],"Core_Front-B9":["/res/panelsoil/zenith/4x/Core_Front-B9.png",1024,808.3146954051728],"Core_Front-C9":["/res/panelsoil/zenith/4x/Core_Front-C9.png",1024,807.1565575821041],"Core_Front-D9":["/res/panelsoil/zenith/4x/Core_Front-D9.png",1024,812.9437293031142],"Core_Front-A10":["/res/panelsoil/zenith/4x/Core_Front-A10.png",1024,813.9959018976792],"Core_Front-B10":["/res/panelsoil/zenith/4x/Core_Front-B10.png",1024,818.5363753475806],"Core_Front-C10":["/res/panelsoil/zenith/4x/Core_Front-C10.png",1024,816.4983741291454],"Core_Front-D10":["/res/panelsoil/zenith/4x/Core_Front-D10.png",1024,816.4038209567982],"Core_Front-A11":["/res/panelsoil/zenith/4x/Core_Front-A11.png",1024,827.0189776509329],"Core_Front-B11":["/res/panelsoil/zenith/4x/Core_Front-B11.png",1024,825.0374390186629],"Core_Front-C11":["/res/panelsoil/zenith/4x/Core_Front-C11.png",1024,827.9286873666874],"Core_Front-D11":["/res/panelsoil/zenith/4x/Core_Front-D11.png",1024,831.8528104072985],"Core_Front-A12":["/res/panelsoil/zenith/4x/Core_Front-A12.png",1024,837.1338353442001],"Core_Front-B12":["/res/panelsoil/zenith/4x/Core_Front-B12.png",1024,837.7425945374788],"Core_Front-C12":["/res/panelsoil/zenith/4x/Core_Front-C12.png",1024,849.7449946047891],"Core_Front-D12":["/res/panelsoil/zenith/4x/Core_Front-D12.png",1024,848.654742691776],"Core_Front-A13":["/res/panelsoil/zenith/4x/Core_Front-A13.png",1024,847.3371894550589],"Core_Front-D13":["/res/panelsoil/zenith/4x/Core_Front-D13.png",1024,864.7703446082681],"Core_Front-A14":["/res/panelsoil/zenith/4x/Core_Front-A14.png",1024,860.4514525536102],"Core_Front-B14":["/res/panelsoil/zenith/4x/Core_Front-B14.png",1024,865.0959026846706],"Core_Front-C14":["/res/panelsoil/zenith/4x/Core_Front-C14.png",1024,865.6068982352904],"Core_Front-D14":["/res/panelsoil/zenith/4x/Core_Front-D14.png",1024,867.9998553949225],"Core_Front-A15":["/res/panelsoil/zenith/4x/Core_Front-A15.png",1024,879.8169015769507],"Core_Front-B15":["/res/panelsoil/zenith/4x/Core_Front-B15.png",1024,881.3224003853637],"Core_Front-C15":["/res/panelsoil/zenith/4x/Core_Front-C15.png",1024,880.0605673604447],"Core_Front-D15":["/res/panelsoil/zenith/4x/Core_Front-D15.png",1024,882.1274533351319],"Core_Front-A16":["/res/panelsoil/zenith/4x/Core_Front-A16.png",1024,889.4901031546929],"Core_Front-B16":["/res/panelsoil/zenith/4x/Core_Front-B16.png",1024,886.2946761679584],"Core_Front-C16":["/res/panelsoil/zenith/4x/Core_Front-C16.png",1024,893.577106226546],"Core_Front-D16":["/res/panelsoil/zenith/4x/Core_Front-D16.png",1024,893.8274996046708],"Core_Front-A17":["/res/panelsoil/zenith/4x/Core_Front-A17.png",1024,896.8984879413456],"Core_Front-B17":["/res/panelsoil/zenith/4x/Core_Front-B17.png",1024,900.8569587975579],"Core_Front-C17":["/res/panelsoil/zenith/4x/Core_Front-C17.png",1024,907.020100381903],"Core_Front-D17":["/res/panelsoil/zenith/4x/Core_Front-D17.png",1024,913.7706369411893],"Core_Front-A18":["/res/panelsoil/zenith/4x/Core_Front-A18.png",1024,914.0899925802001],"Core_Front-B18":["/res/panelsoil/zenith/4x/Core_Front-B18.png",1024,913.6289584307445],"Core_Front-C18":["/res/panelsoil/zenith/4x/Core_Front-C18.png",1024,914.765074627511],"Core_Front-D18":["/res/panelsoil/zenith/4x/Core_Front-D18.png",1024,926.1589880028891],"Core_Front-A19":["/res/panelsoil/zenith/4x/Core_Front-A19.png",1024,924.2976867143237],"Core_Front-B19":["/res/panelsoil/zenith/4x/Core_Front-B19.png",1024,923.0418990468946],"Core_Front-C19":["/res/panelsoil/zenith/4x/Core_Front-C19.png",1024,931.6834299743372],"Core_Front-D19":["/res/panelsoil/zenith/4x/Core_Front-D19.png",1024,931.0427928620909],"Core_Front-A20":["/res/panelsoil/zenith/4x/Core_Front-A20.png",1024,933.7372563885298],"Core_Front-B20":["/res/panelsoil/zenith/4x/Core_Front-B20.png",1024,943.3590676566304],"Core_Front-C20":["/res/panelsoil/zenith/4x/Core_Front-C20.png",1024,944.6062431934348],"Core_Front-D20":["/res/panelsoil/zenith/4x/Core_Front-D20.png",1024,942.4723878714527],"Corruption_A1-A1":["/res/panelsoil/zenith/4x/Corruption_A1-A1.png",1024,954.2678128717272],"Corruption_A1-B1":["/res/panelsoil/zenith/4x/Corruption_A1-B1.png",1024,964.1297632327194],"Corruption_A1-C1":["/res/panelsoil/zenith/4x/Corruption_A1-C1.png",1024,967.2653701335684],"Corruption_A1-D1":["/res/panelsoil/zenith/4x/Corruption_A1-D1.png",1024,962.382442742209],"Corruption_A1-A2":["/res/panelsoil/zenith/4x/Corruption_A1-A2.png",1024,975.4683442478832],"Corruption_A1-B2":["/res/panelsoil/zenith/4x/Corruption_A1-B2.png",1024,969.3487679806119],"Corruption_A1-C2":["/res/panelsoil/zenith/4x/Corruption_A1-C2.png",1024,970.1576907567273],"Corruption_A1-D2":["/res/panelsoil/zenith/4x/Corruption_A1-D2.png",1024,978.0732331385625],"Corruption_A1-A3":["/res/panelsoil/zenith/4x/Corruption_A1-A3.png",1024,987.7250434057062],"Corruption_A1-B3":["/res/panelsoil/zenith/4x/Corruption_A1-B3.png",1024,983.4110755542231],"Corruption_A1-C3":["/res/panelsoil/zenith/4x/Corruption_A1-C3.png",1024,982.6436312860275],"Corruption_A1-D3":["/res/panelsoil/zenith/4x/Corruption_A1-D3.png",1024,991.5865738904887],"Corruption_A1-A4":["/res/panelsoil/zenith/4x/Corruption_A1-A4.png",1024,990.5456395898459],"Corruption_A1-B4":["/res/panelsoil/zenith/4x/Corruption_A1-B4.png",1024,998.3073124753196],"Corruption_A1-C4":["/res/panelsoil/zenith/4x/Corruption_A1-C4.png",1024,1005.5378313865309],"Corruption_A1-D4":["/res/panelsoil/zenith/4x/Corruption_A1-D4.png",1024,1005.2011749692789],"Corruption_A1-A5":["/res/panelsoil/zenith/4x/Corruption_A1-A5.png",1024,1009.0934519589322],"Corruption_A1-B5":["/res/panelsoil/zenith/4x/Corruption_A1-B5.png",1024,1011.6915435341906],"Corruption_A1-C5":["/res/panelsoil/zenith/4x/Corruption_A1-C5.png",1024,1007.8520634596101],"Corruption_A1-D5":["/res/panelsoil/zenith/4x/Corruption_A1-D5.png",1024,1016.2372533649694],"Corruption_A1-A6":["/res/panelsoil/zenith/4x/Corruption_A1-A6.png",1024,1016.6992539880997],"Corruption_A1-B6":["/res/panelsoil/zenith/4x/Corruption_A1-B6.png",1024,1024.8845473903348],"Corruption_A1-C6":["/res/panelsoil/zenith/4x/Corruption_A1-C6.png",1024,1019.7064748483576],"Corruption_A1-D6":["/res/panelsoil/zenith/4x/Corruption_A1-D6.png",1024,1026.9045851701385],"Corruption_B1-A1":["/res/panelsoil/zenith/4x/Corruption_B1-A1.png",1024,1026.5933613814714],"Corruption_B1-B1":["/res/panelsoil/zenith/4x/Corruption_B1-B1.png",1024,1022.7224960309122],"Corruption_B1-C1":["/res/panelsoil/zenith/4x/Corruption_B1-C1.png",1024,1030.4684183610539],"Corruption_B1-D1":["/res/panelsoil/zenith/4x/Corruption_B1-D1.png",1024,1033.9240722749983],"Corruption_B1-A2":["/res/panelsoil/zenith/4x/Corruption_B1-A2.png",1024,1041.550991337115],"Corruption_B1-B2":["/res/panelsoil/zenith/4x/Corruption_B1-B2.png",1024,1033.5825276454898],"Corruption_B1-C2":["/res/panelsoil/zenith/4x/Corruption_B1-C2.png",1024,1044.3111499601837],"Corruption_B1-D2":["/res/panelsoil/zenith/4x/Corruption_B1-D2.png",1024,1043.8644277489254],"Corruption_B1-A3":["/res/panelsoil/zenith/4x/Corruption_B1-A3.png",1024,1043.2624654814733],"Corruption_B1-B3":["/res/panelsoil/zenith/4x/Corruption_B1-B3.png",1024,1056.1584769420756],"Corruption_B1-C3":["/res/panelsoil/zenith/4x/Corruption_B1-C3.png",1024,1053.1723900334314],"Corruption_B1-D3":["/res/panelsoil/zenith/4x/Corruption_B1-D3.png",1024,1059.1015717317134],"Corruption_B1-A4":["/res/panelsoil/zenith/4x/Corruption_B1-A4.png",1024,1061.7288436472925],"Corruption_B1-B4":["/res/panelsoil/zenith/4x/Corruption_B1-B4.png",1024,1064.7145299693177],"Corruption_B1-C4":["/res/panelsoil/zenith/4x/Corruption_B1-C4.png",1024,1064.0285843218564],"Corruption_B1-D4":["/res/panelsoil/zenith/4x/Corruption_B1-D4.png",1024,1069.902982156531],"Corruption_B1-A5":["/res/panelsoil/zenith/4x/Corruption_B1-A5.png",1024,1075.179477246324],"Corruption_B1-B5":["/res/panelsoil/zenith/4x/Corruption_B1-B5.png",1024,1080.6224592945375],"Corruption_B1-C5":["/res/panelsoil/zenith/4x/Corruption_B1-C5.png",1024,1083.4058865631916],"Corruption_B1-D5":["/res/panelsoil/zenith/4x/Corruption_B1-D5.png",1024,1078.564523851023],"Corruption_B2-A1":["/res/panelsoil/zenith/4x/Corruption_B2-A1.png",1024,1019.4022288231997],"Corruption_B2-B1":["/res/panelsoil/zenith/4x/Corruption_B2-B1.png",1024,1023.74409221622],"Corruption_B2-C1":["/res/panelsoil/zenith/4x/Corruption_B2-C1.png",1024,1035.5553393476928],"Corruption_B2-D1":["/res/panelsoil/zenith/4x/Corruption_B2-D1.png",1024,1035.3957069757637],"Corruption_B2-A2":["/res/panelsoil/zenith/4x/Corruption_B2-A2.png",1024,1035.9147944367548],"Corruption_B2-B2":["/res/panelsoil/zenith/4x/Corruption_B2-B2.png",1024,1037.1475546405204],"Corruption_B2-C2":["/res/panelsoil/zenith/4x/Corruption_B2-C2.png",1024,1040.861935519179],"Corruption_B2-D2":["/res/panelsoil/zenith/4x/Corruption_B2-D2.png",1024,1051.3571936664757],"Corruption_B2-A3":["/res/panelsoil/zenith/4x/Corruption_B2-A3.png",1024,1054.1630366633187],"Corruption_B2-B3":["/res/panelsoil/zenith/4x/Corruption_B2-B3.png",1024,1051.6358387200214],"Corruption_B2-C3":["/res/panelsoil/zenith/4x/Corruption_B2-C3.png",1024,1053.056375935513],"Corruption_B2-D3":["/res/panelsoil/zenith/4x/Corruption_B2-D3.png",1024,1062.2946282082746],"Corruption_B2-A4":["/res/panelsoil/zenith/4x/Corruption_B2-A4.png",1024,1067.448229847233],"Corruption_B2-B4":["/res/panelsoil/zenith/4x/Corruption_B2-B4.png",1024,1066.3546843869967],"Corruption_B2-C4":["/res/panelsoil/zenith/4x/Corruption_B2-C4.png",1024,1064.773534924476],"Corruption_B2-D4":["/res/panelsoil/zenith/4x/Corruption_B2-D4.png",1024,1075.9060999587796],"Corruption_B2-A5":["/res/panelsoil/zenith/4x/Corruption_B2-A5.png",1024,1074.0518279443977],"Corruption_B2-B5":["/res/panelsoil/zenith/4x/Corruption_B2-B5.png",1024,1073.0336511877888],"Corruption_B2-C5":["/res/panelsoil/zenith/4x/Corruption_B2-C5.png",1024,1081.3358405091894],"Corruption_B2-D5":["/res/panelsoil/zenith/4x/Corruption_B2-D5.png",1024,1079.7298996445768],"Corruption_C1-A1":["/res/panelsoil/zenith/4x/Corruption_C1-A1.png",1024,1072.7115390296058],"Corruption_C1-B1":["/res/panelsoil/zenith/4x/Corruption_C1-B1.png",1024,1069.4742886925524],"Corruption_C1-C1":["/res/panelsoil/zenith/4x/Corruption_C1-C1.png",1024,1077.4843855339275],"Corruption_C1-D1":["/res/panelsoil/zenith/4x/Corruption_C1-D1.png",1024,1081.3796130139656],"Corruption_C1-A2":["/res/panelsoil/zenith/4x/Corruption_C1-A2.png",1024,1087.803245578172],"Corruption_C1-B2":["/res/panelsoil/zenith/4x/Corruption_C1-B2.png",1024,1082.5195533384403],"Corruption_C1-C2":["/res/panelsoil/zenith/4x/Corruption_C1-C2.png",1024,1088.8302400368718],"Corruption_C1-D2":["/res/panelsoil/zenith/4x/Corruption_C1-D2.png",1024,1097.0111205577057],"Corruption_C1-A3":["/res/panelsoil/zenith/4x/Corruption_C1-A3.png",1024,1096.261646959807],"Corruption_C1-B3":["/res/panelsoil/zenith/4x/Corruption_C1-B3.png",1024,1097.8943688354125],"Corruption_C1-C3":["/res/panelsoil/zenith/4x/Corruption_C1-C3.png",1024,1103.028571720862],"Corruption_C1-D3":["/res/panelsoil/zenith/4x/Corruption_C1-D3.png",1024,1099.386795725375],"Corruption_C1-A4":["/res/panelsoil/zenith/4x/Corruption_C1-A4.png",1024,1107.2659024233],"Corruption_C1-B4":["/res/panelsoil/zenith/4x/Corruption_C1-B4.png",1024,1106.3466580078875],"Corruption_C1-C4":["/res/panelsoil/zenith/4x/Corruption_C1-C4.png",1024,1112.6969024890036],"Corruption_C1-D4":["/res/panelsoil/zenith/4x/Corruption_C1-D4.png",1024,1118.7522689887098],"Corruption_C1-A5":["/res/panelsoil/zenith/4x/Corruption_C1-A5.png",1024,1118.8881791310243],"Corruption_C1-B5":["/res/panelsoil/zenith/4x/Corruption_C1-B5.png",1024,1117.2189110253541],"Corruption_C1-C5":["/res/panelsoil/zenith/4x/Corruption_C1-C5.png",1024,1127.3192149157928],"Corruption_C1-D5":["/res/panelsoil/zenith/4x/Corruption_C1-D5.png",1024,1133.6779208373168],"Corruption_C1-A6":["/res/panelsoil/zenith/4x/Corruption_C1-A6.png",1024,1130.4748936107353],"Corruption_C1-B6":["/res/panelsoil/zenith/4x/Corruption_C1-B6.png",1024,1141.0237761961318],"Corruption_C1-C6":["/res/panelsoil/zenith/4x/Corruption_C1-C6.png",1024,1138.0689748964728],"Corruption_C1-D6":["/res/panelsoil/zenith/4x/Corruption_C1-D6.png",1024,1142.2498254570653],"Corruption_C2-A1":["/res/panelsoil/zenith/4x/Corruption_C2-A1.png",1024,1069.7834255967405],"Corruption_C2-B1":["/res/panelsoil/zenith/4x/Corruption_C2-B1.png",1024,1067.9443764360813],"Corruption_C2-C1":["/res/panelsoil/zenith/4x/Corruption_C2-C1.png",1024,1070.7465219197857],"Corruption_C2-D1":["/res/panelsoil/zenith/4x/Corruption_C2-D1.png",1024,1074.426948726326],"Corruption_C2-A2":["/res/panelsoil/zenith/4x/Corruption_C2-A2.png",1024,1084.0756438814826],"Corruption_C2-B2":["/res/panelsoil/zenith/4x/Corruption_C2-B2.png",1024,1086.221070608853],"Corruption_C2-C2":["/res/panelsoil/zenith/4x/Corruption_C2-C2.png",1024,1088.9803416420198],"Corruption_C2-D2":["/res/panelsoil/zenith/4x/Corruption_C2-D2.png",1024,1089.718500013351],"Corruption_C2-A3":["/res/panelsoil/zenith/4x/Corruption_C2-A3.png",1024,1099.0931344305511],"Corruption_C2-D3":["/res/panelsoil/zenith/4x/Corruption_C2-D3.png",1024,1098.9885380402047],"Corruption_C2-A4":["/res/panelsoil/zenith/4x/Corruption_C2-A4.png",1024,1112.9033431040302],"Corruption_C2-A5":["/res/panelsoil/zenith/4x/Corruption_C2-A5.png",1024,1118.4747135998332],"Corruption_D1-A1":["/res/panelsoil/zenith/4x/Corruption_D1-A1.png",1024,1187.2702662879205],"Corruption_D1-B1":["/res/panelsoil/zenith/4x/Corruption_D1-B1.png",1024,1188.2403267970021],"Corruption_D1-C1":["/res/panelsoil/zenith/4x/Corruption_D1-C1.png",1024,1196.1275166773823],"Corruption_D1-D1":["/res/panelsoil/zenith/4x/Corruption_D1-D1.png",1024,1198.600478890046],"Corruption_D1-A2":["/res/panelsoil/zenith/4x/Corruption_D1-A2.png",1024,1192.6203487812086],"Corruption_D1-B2":["/res/panelsoil/zenith/4x/Corruption_D1-B2.png",1024,1196.8711381699363],"Corruption_D1-C2":["/res/panelsoil/zenith/4x/Corruption_D1-C2.png",1024,1204.9895057301749],"Corruption_D1-D2":["/res/panelsoil/zenith/4x/Corruption_D1-D2.png",1024,1206.6776532491588],"Corruption_D1-A3":["/res/panelsoil/zenith/4x/Corruption_D1-A3.png",1024,1214.6120839858102],"Corruption_D1-B3":["/res/panelsoil/zenith/4x/Corruption_D1-B3.png",1024,1209.197565780142],"Corruption_D1-C3":["/res/panelsoil/zenith/4x/Corruption_D1-C3.png",1024,1218.9690295453595],"Corruption_D1-D3":["/res/panelsoil/zenith/4x/Corruption_D1-D3.png",1024,1217.3149699635126],"Corruption_D1-A4":["/res/panelsoil/zenith/4x/Corruption_D1-A4.png",1024,1220.1531388133426],"Corruption_D1-B4":["/res/panelsoil/zenith/4x/Corruption_D1-B4.png",1024,1229.6478385778346],"Corruption_D1-C4":["/res/panelsoil/zenith/4x/Corruption_D1-C4.png",1024,1228.262106055166],"Corruption_D1-D4":["/res/panelsoil/zenith/4x/Corruption_D1-D4.png",1024,1226.5025410037492],"Corruption_D1-A5":["/res/panelsoil/zenith/4x/Corruption_D1-A5.png",1024,1230.0533358339287],"Corruption_D1-B5":["/res/panelsoil/zenith/4x/Corruption_D1-B5.png",1024,1231.2583473574211],"Corruption_D1-C5":["/res/panelsoil/zenith/4x/Corruption_D1-C5.png",1024,1243.6846236767874],"Corruption_D1-D5":["/res/panelsoil/zenith/4x/Corruption_D1-D5.png",1024,1241.9789573495502],"Corruption_D1-A6":["/res/panelsoil/zenith/4x/Corruption_D1-A6.png",1024,1243.7990005135514],"Corruption_D1-B6":["/res/panelsoil/zenith/4x/Corruption_D1-B6.png",1024,1243.7293945757958],"Corruption_D1-C6":["/res/panelsoil/zenith/4x/Corruption_D1-C6.png",1024,1252.5428309497415],"Corruption_D1-D6":["/res/panelsoil/zenith/4x/Corruption_D1-D6.png",1024,1255.2230847109356],"Corruption_D2-A1":["/res/panelsoil/zenith/4x/Corruption_D2-A1.png",1024,1179.4869386804266],"Corruption_D2-B1":["/res/panelsoil/zenith/4x/Corruption_D2-B1.png",1024,1187.807729993258],"Corruption_D2-C1":["/res/panelsoil/zenith/4x/Corruption_D2-C1.png",1024,1189.4904831462482],"Corruption_D2-D1":["/res/panelsoil/zenith/4x/Corruption_D2-D1.png",1024,1194.0979975614878],"Corruption_D2-A2":["/res/panelsoil/zenith/4x/Corruption_D2-A2.png",1024,1191.340422138348],"Corruption_D2-B2":["/res/panelsoil/zenith/4x/Corruption_D2-B2.png",1024,1200.22421902647],"Corruption_D2-C2":["/res/panelsoil/zenith/4x/Corruption_D2-C2.png",1024,1208.9546027102242],"Corruption_D2-D2":["/res/panelsoil/zenith/4x/Corruption_D2-D2.png",1024,1204.811735241592],"Corruption_D2-A3":["/res/panelsoil/zenith/4x/Corruption_D2-A3.png",1024,1204.5378065916557],"Corruption_D2-B3":["/res/panelsoil/zenith/4x/Corruption_D2-B3.png",1024,1207.8017937740092],"Corruption_D2-C3":["/res/panelsoil/zenith/4x/Corruption_D2-C3.png",1024,1212.507802287602],"Corruption_D2-D3":["/res/panelsoil/zenith/4x/Corruption_D2-D3.png",1024,1222.929286214413],"Corruption_D2-A4":["/res/panelsoil/zenith/4x/Corruption_D2-A4.png",1024,1222.6260629492642],"Corruption_D2-B4":["/res/panelsoil/zenith/4x/Corruption_D2-B4.png",1024,1224.645762964567],"Corruption_D2-C4":["/res/panelsoil/zenith/4x/Corruption_D2-C4.png",1024,1231.5411085107983],"Corruption_D2-D4":["/res/panelsoil/zenith/4x/Corruption_D2-D4.png",1024,1237.0176098459458],"Corruption_D2-A5":["/res/panelsoil/zenith/4x/Corruption_D2-A5.png",1024,1238.8155543567166],"Corruption_D2-B5":["/res/panelsoil/zenith/4x/Corruption_D2-B5.png",1024,1239.2728916790902],"Corruption_D2-C5":["/res/panelsoil/zenith/4x/Corruption_D2-C5.png",1024,1235.3289560699795],"Corruption_D2-D5":["/res/panelsoil/zenith/4x/Corruption_D2-D5.png",1024,1238.8127629931123],"Corruption_Front-A1":["/res/panelsoil/zenith/4x/Corruption_Front-A1.png",1024,951.8335010160789],"Corruption_Front-B1":["/res/panelsoil/zenith/4x/Corruption_Front-B1.png",1024,951.2072269270549],"Corruption_Front-C1":["/res/panelsoil/zenith/4x/Corruption_Front-C1.png",1024,957.5893422958862],"Corruption_Front-D1":["/res/panelsoil/zenith/4x/Corruption_Front-D1.png",1024,959.5648992818643],"Corruption_Front-A2":["/res/panelsoil/zenith/4x/Corruption_Front-A2.png",1024,967.8115337405454],"Corruption_Front-B2":["/res/panelsoil/zenith/4x/Corruption_Front-B2.png",1024,971.0386000688866],"Corruption_Front-C2":["/res/panelsoil/zenith/4x/Corruption_Front-C2.png",1024,972.6997253658409],"Corruption_Front-D2":["/res/panelsoil/zenith/4x/Corruption_Front-D2.png",1024,969.2541501742676],"Corruption_Front-A3":["/res/panelsoil/zenith/4x/Corruption_Front-A3.png",1024,978.4932380380767],"Corruption_Front-B3":["/res/panelsoil/zenith/4x/Corruption_Front-B3.png",1024,982.4831565178242],"Corruption_Front-C3":["/res/panelsoil/zenith/4x/Corruption_Front-C3.png",1024,978.3857246605543],"Corruption_Front-D3":["/res/panelsoil/zenith/4x/Corruption_Front-D3.png",1024,987.9465346527204],"Corruption_Front-A4":["/res/panelsoil/zenith/4x/Corruption_Front-A4.png",1024,993.4901155000007],"Corruption_Front-B4":["/res/panelsoil/zenith/4x/Corruption_Front-B4.png",1024,986.1122564419126],"Corruption_Front-C4":["/res/panelsoil/zenith/4x/Corruption_Front-C4.png",1024,998.1883317456897],"Corruption_Front-D4":["/res/panelsoil/zenith/4x/Corruption_Front-D4.png",1024,993.2265859808055],"Corruption_Front-A5":["/res/panelsoil/zenith/4x/Corruption_Front-A5.png",1024,1003.974889584191],"Corruption_Front-B5":["/res/panelsoil/zenith/4x/Corruption_Front-B5.png",1024,1001.0353605325723],"Corruption_Front-C5":["/res/panelsoil/zenith/4x/Corruption_Front-C5.png",1024,1005.3425295815463],"Corruption_Front-D5":["/res/panelsoil/zenith/4x/Corruption_Front-D5.png",1024,1003.5344618386409],"Corruption_Front-A6":["/res/panelsoil/zenith/4x/Corruption_Front-A6.png",1024,1010.8026701503568],"Corruption_Front-B6":["/res/panelsoil/zenith/4x/Corruption_Front-B6.png",1024,1014.196689752145],"Corruption_Front-C6":["/res/panelsoil/zenith/4x/Corruption_Front-C6.png",1024,1018.1414370194927],"Corruption_Front-D6":["/res/panelsoil/zenith/4x/Corruption_Front-D6.png",1024,1026.7829939123408],"Corruption_Front-A7":["/res/panelsoil/zenith/4x/Corruption_Front-A7.png",1024,1022.9456108230859],"Corruption_Front-B7":["/res/panelsoil/zenith/4x/Corruption_Front-B7.png",1024,1022.3040621356813],"Corruption_Front-C7":["/res/panelsoil/zenith/4x/Corruption_Front-C7.png",1024,1032.7359449309852],"Corruption_Front-D7":["/res/panelsoil/zenith/4x/Corruption_Front-D7.png",1024,1032.7717852403543],"Corruption_Front-A8":["/res/panelsoil/zenith/4x/Corruption_Front-A8.png",1024,1043.611151331703],"Corruption_Front-B8":["/res/panelsoil/zenith/4x/Corruption_Front-B8.png",1024,1041.7218226267396],"Corruption_Front-C8":["/res/panelsoil/zenith/4x/Corruption_Front-C8.png",1024,1049.0341388119905],"Corruption_Front-D8":["/res/panelsoil/zenith/4x/Corruption_Front-D8.png",1024,1049.035465475428],"Corruption_Front-A9":["/res/panelsoil/zenith/4x/Corruption_Front-A9.png",1024,1044.2240182874696],"Corruption_Front-B9":["/res/panelsoil/zenith/4x/Corruption_Front-B9.png",1024,1049.044295458026],"Corruption_Front-C9":["/res/panelsoil/zenith/4x/Corruption_Front-C9.png",1024,1058.5672267402629],"Corruption_Front-D9":["/res/panelsoil/zenith/4x/Corruption_Front-D9.png",1024,1055.9331204428254],"Corruption_Front-A10":["/res/panelsoil/zenith/4x/Corruption_Front-A10.png",1024,1066.8209080498877],"Corruption_Front-B10":["/res/panelsoil/zenith/4x/Corruption_Front-B10.png",1024,1070.1352197539188],"Corruption_Front-C10":["/res/panelsoil/zenith/4x/Corruption_Front-C10.png",1024,1067.0595289160701],"Corruption_Front-D10":["/res/panelsoil/zenith/4x/Corruption_Front-D10.png",1024,1075.6421860148514],"Corruption_Front-A11":["/res/panelsoil/zenith/4x/Corruption_Front-A11.png",1024,1077.5940941961203],"Corruption_Front-B11":["/res/panelsoil/zenith/4x/Corruption_Front-B11.png",1024,1078.9798347834128],"Corruption_Front-C11":["/res/panelsoil/zenith/4x/Corruption_Front-C11.png",1024,1077.6860133956502],"Corruption_Front-D11":["/res/panelsoil/zenith/4x/Corruption_Front-D11.png",1024,1082.2716607854002],"Corruption_Front-A12":["/res/panelsoil/zenith/4x/Corruption_Front-A12.png",1024,1082.0998690238853],"Corruption_Front-B12":["/res/panelsoil/zenith/4x/Corruption_Front-B12.png",1024,1088.099898454735],"Corruption_Front-C12":["/res/panelsoil/zenith/4x/Corruption_Front-C12.png",1024,1094.7084841234735],"Corruption_Front-D12":["/res/panelsoil/zenith/4x/Corruption_Front-D12.png",1024,1095.3099854296563],"Corruption_Front-A13":["/res/panelsoil/zenith/4x/Corruption_Front-A13.png",1024,1102.7253396547878],"Corruption_Front-B13":["/res/panelsoil/zenith/4x/Corruption_Front-B13.png",1024,1109.3381346617375],"Corruption_Front-C13":["/res/panelsoil/zenith/4x/Corruption_Front-C13.png",1024,1105.0703185565267],"Corruption_Front-D13":["/res/panelsoil/zenith/4x/Corruption_Front-D13.png",1024,1110.1145864918285],"Corruption_Front-A14":["/res/panelsoil/zenith/4x/Corruption_Front-A14.png",1024,1117.6810905506757],"Corruption_Front-C14":["/res/panelsoil/zenith/4x/Corruption_Front-C14.png",1024,1121.2136236443725],"Corruption_Front-D14":["/res/panelsoil/zenith/4x/Corruption_Front-D14.png",1024,1124.9046905338173],"Corruption_Front-A15":["/res/panelsoil/zenith/4x/Corruption_Front-A15.png",1024,1124.9806693981234],"Corruption_Front-B15":["/res/panelsoil/zenith/4x/Corruption_Front-B15.png",1024,1132.1011976395355],"Corruption_Front-C15":["/res/panelsoil/zenith/4x/Corruption_Front-C15.png",1024,1129.956884376226],"Corruption_Front-D15":["/res/panelsoil/zenith/4x/Corruption_Front-D15.png",1024,1131.5354644390509],"Corruption_Front-A16":["/res/panelsoil/zenith/4x/Corruption_Front-A16.png",1024,1132.4668678962335],"Corruption_Front-B16":["/res/panelsoil/zenith/4x/Corruption_Front-B16.png",1024,1135.0336124207029],"Corruption_Front-C16":["/res/panelsoil/zenith/4x/Corruption_Front-C16.png",1024,1143.907725197915],"Corruption_Front-D16":["/res/panelsoil/zenith/4x/Corruption_Front-D16.png",1024,1149.0275832028162],"Corruption_Front-A17":["/res/panelsoil/zenith/4x/Corruption_Front-A17.png",1024,1154.1902690834454],"Corruption_Front-B17":["/res/panelsoil/zenith/4x/Corruption_Front-B17.png",1024,1156.8559985007082],"Corruption_Front-C17":["/res/panelsoil/zenith/4x/Corruption_Front-C17.png",1024,1154.1761656073293],"Corruption_Front-D17":["/res/panelsoil/zenith/4x/Corruption_Front-D17.png",1024,1158.1075295799692],"Corruption_Front-A18":["/res/panelsoil/zenith/4x/Corruption_Front-A18.png",1024,1164.5735019467545],"Corruption_Front-B18":["/res/panelsoil/zenith/4x/Corruption_Front-B18.png",1024,1171.0373448362122],"Corruption_Front-C18":["/res/panelsoil/zenith/4x/Corruption_Front-C18.png",1024,1167.972122439797],"Corruption_Front-D18":["/res/panelsoil/zenith/4x/Corruption_Front-D18.png",1024,1174.67710994921],"Corruption_Front-A19":["/res/panelsoil/zenith/4x/Corruption_Front-A19.png",1024,1175.0789527370011],"Corruption_Front-B19":["/res/panelsoil/zenith/4x/Corruption_Front-B19.png",1024,1182.70589097628],"Corruption_Front-C19":["/res/panelsoil/zenith/4x/Corruption_Front-C19.png",1024,1186.1103977994994],"Corruption_Front-D19":["/res/panelsoil/zenith/4x/Corruption_Front-D19.png",1024,1190.1459020121208],"Corruption_Front-A20":["/res/panelsoil/zenith/4x/Corruption_Front-A20.png",1024,1190.152114093755],"Corruption_Front-B20":["/res/panelsoil/zenith/4x/Corruption_Front-B20.png",1024,1193.18947487567],"Corruption_Front-C20":["/res/panelsoil/zenith/4x/Corruption_Front-C20.png",1024,1190.72551318012],"Corruption_Front-D20":["/res/panelsoil/zenith/4x/Corruption_Front-D20.png",1024,1200.0884208319844],"Corruption_Front-A21":["/res/panelsoil/zenith/4x/Corruption_Front-A21.png",1024,1196.7009630035736],"Corruption_Front-D21":["/res/panelsoil/zenith/4x/Corruption_Front-D21.png",1024,1209.1550656062857],"Corruption_Front-D22":["/res/panelsoil/zenith/4x/Corruption_Front-D22.png",1024,1227.7109692838173],"Hall_1A-A1":["/res/panelsoil/zenith/4x/Hall_1A-A1.png",1024,-402.1156923742914],"Hall_1A-B1":["/res/panelsoil/zenith/4x/Hall_1A-B1.png",1024,-392.68206573605823],"Hall_1A-C1":["/res/panelsoil/zenith/4x/Hall_1A-C1.png",1024,-389.560043318589],"Hall_1A-D1":["/res/panelsoil/zenith/4x/Hall_1A-D1.png",1024,-395.80239342813127],"Hall_1A-A2":["/res/panelsoil/zenith/4x/Hall_1A-A2.png",1024,-386.5638415149826],"Hall_1A-B2":["/res/panelsoil/zenith/4x/Hall_1A-B2.png",1024,-383.12571775572445],"Hall_1A-C2":["/res/panelsoil/zenith/4x/Hall_1A-C2.png",1024,-384.46517109044225],"Hall_1A-D2":["/res/panelsoil/zenith/4x/Hall_1A-D2.png",1024,-376.9748148494511],"Hall_1A-A3":["/res/panelsoil/zenith/4x/Hall_1A-A3.png",1024,-376.54197098594267],"Hall_1A-B3":["/res/panelsoil/zenith/4x/Hall_1A-B3.png",1024,-371.73060110616206],"Hall_1A-C3":["/res/panelsoil/zenith/4x/Hall_1A-C3.png",1024,-363.8444616988204],"Hall_1A-D3":["/res/panelsoil/zenith/4x/Hall_1A-D3.png",1024,-368.7373382577697],"Hall_1A-A4":["/res/panelsoil/zenith/4x/Hall_1A-A4.png",1024,-367.55422840195996],"Hall_1A-B4":["/res/panelsoil/zenith/4x/Hall_1A-B4.png",1024,-356.61690402622855],"Hall_1A-C4":["/res/panelsoil/zenith/4x/Hall_1A-C4.png",1024,-361.8592386301732],"Hall_1A-D4":["/res/panelsoil/zenith/4x/Hall_1A-D4.png",1024,-349.3379123920854],"Hall_Front-A1":["/res/panelsoil/zenith/4x/Hall_Front-A1.png",1024,-404.3460803048061],"Hall_Front-B1":["/res/panelsoil/zenith/4x/Hall_Front-B1.png",1024,-396.9477667095839],"Hall_Front-C1":["/res/panelsoil/zenith/4x/Hall_Front-C1.png",1024,-398.10995089655125],"Hall_Front-D1":["/res/panelsoil/zenith/4x/Hall_Front-D1.png",1024,-394.6934201486588],"Hall_Front-A2":["/res/panelsoil/zenith/4x/Hall_Front-A2.png",1024,-390.81100789971373],"Hall_Front-B2":["/res/panelsoil/zenith/4x/Hall_Front-B2.png",1024,-381.06303986111885],"Hall_Front-C2":["/res/panelsoil/zenith/4x/Hall_Front-C2.png",1024,-379.4833282253662],"Hall_Front-D2":["/res/panelsoil/zenith/4x/Hall_Front-D2.png",1024,-379.3894678244903],"Hall_Front-A3":["/res/panelsoil/zenith/4x/Hall_Front-A3.png",1024,-380.13278569074026],"Hall_Front-B3":["/res/panelsoil/zenith/4x/Hall_Front-B3.png",1024,-377.70189423859887],"Hall_Front-C3":["/res/panelsoil/zenith/4x/Hall_Front-C3.png",1024,-365.28885834465046],"Hall_Front-D3":["/res/panelsoil/zenith/4x/Hall_Front-D3.png",1024,-365.2482445701199],"Hall_Front-A4":["/res/panelsoil/zenith/4x/Hall_Front-A4.png",1024,-360.7663201003497],"Hall_Front-B4":["/res/panelsoil/zenith/4x/Hall_Front-B4.png",1024,-354.1195618943786],"Hall_Front-C4":["/res/panelsoil/zenith/4x/Hall_Front-C4.png",1024,-360.90719787902947],"Hall_Front-D4":["/res/panelsoil/zenith/4x/Hall_Front-D4.png",1024,-355.07400695254194],"Hotel_A1-A1":["/res/panelsoil/zenith/4x/Hotel_A1-A1.png",1024,-347.483978767005],"Hotel_A1-B1":["/res/panelsoil/zenith/4x/Hotel_A1-B1.png",1024,-346.96799367513944],"Hotel_A1-C1":["/res/panelsoil/zenith/4x/Hotel_A1-C1.png",1024,-340.24556124144317],"Hotel_A1-D1":["/res/panelsoil/zenith/4x/Hotel_A1-D1.png",1024,-339.7927445776504],"Hotel_A1-A2":["/res/panelsoil/zenith/4x/Hotel_A1-A2.png",1024,-333.5422835792132],"Hotel_A1-B2":["/res/panelsoil/zenith/4x/Hotel_A1-B2.png",1024,-330.8100826513296],"Hotel_A1-C2":["/res/panelsoil/zenith/4x/Hotel_A1-C2.png",1024,-327.7883889216474],"Hotel_A1-D2":["/res/panelsoil/zenith/4x/Hotel_A1-D2.png",1024,-333.42796845528153],"Hotel_A1-A3":["/res/panelsoil/zenith/4x/Hotel_A1-A3.png",1024,-321.13975420035604],"Hotel_A1-B3":["/res/panelsoil/zenith/4x/Hotel_A1-B3.png",1024,-322.9855333154298],"Hotel_A1-C3":["/res/panelsoil/zenith/4x/Hotel_A1-C3.png",1024,-319.1243665403309],"Hotel_A1-D3":["/res/panelsoil/zenith/4x/Hotel_A1-D3.png",1024,-310.1099090540093],"Hotel_A1-A4":["/res/panelsoil/zenith/4x/Hotel_A1-A4.png",1024,-306.8623610083937],"Hotel_A1-B4":["/res/panelsoil/zenith/4x/Hotel_A1-B4.png",1024,-305.2343847736838],"Hotel_A1-C4":["/res/panelsoil/zenith/4x/Hotel_A1-C4.png",1024,-308.11860040987574],"Hotel_A1-D4":["/res/panelsoil/zenith/4x/Hotel_A1-D4.png",1024,-304.10503908874256],"Hotel_A1-A5":["/res/panelsoil/zenith/4x/Hotel_A1-A5.png",1024,-302.76820293455853],"Hotel_A1-B5":["/res/panelsoil/zenith/4x/Hotel_A1-B5.png",1024,-299.1964824681466],"Hotel_A1-C5":["/res/panelsoil/zenith/4x/Hotel_A1-C5.png",1024,-289.1299787347601],"Hotel_A1-D5":["/res/panelsoil/zenith/4x/Hotel_A1-D5.png",1024,-294.694914469093],"Hotel_B1-A1":["/res/panelsoil/zenith/4x/Hotel_B1-A1.png",1024,-276.9148170518005],"Hotel_B1-B1":["/res/panelsoil/zenith/4x/Hotel_B1-B1.png",1024,-281.5697180064706],"Hotel_B1-C1":["/res/panelsoil/zenith/4x/Hotel_B1-C1.png",1024,-277.1661299138569],"Hotel_B1-D1":["/res/panelsoil/zenith/4x/Hotel_B1-D1.png",1024,-270.5942972053852],"Hotel_B1-A2":["/res/panelsoil/zenith/4x/Hotel_B1-A2.png",1024,-268.92217124269735],"Hotel_B1-B2":["/res/panelsoil/zenith/4x/Hotel_B1-B2.png",1024,-262.84870731792563],"Hotel_B1-C2":["/res/panelsoil/zenith/4x/Hotel_B1-C2.png",1024,-257.369637023416],"Hotel_B1-D2":["/res/panelsoil/zenith/4x/Hotel_B1-D2.png",1024,-258.28801406096335],"Hotel_B1-A3":["/res/panelsoil/zenith/4x/Hotel_B1-A3.png",1024,-257.4523222076945],"Hotel_B1-B3":["/res/panelsoil/zenith/4x/Hotel_B1-B3.png",1024,-255.2492396615989],"Hotel_B1-C3":["/res/panelsoil/zenith/4x/Hotel_B1-C3.png",1024,-253.21776681336678],"Hotel_B1-D3":["/res/panelsoil/zenith/4x/Hotel_B1-D3.png",1024,-243.38293690841382],"Hotel_B1-A4":["/res/panelsoil/zenith/4x/Hotel_B1-A4.png",1024,-237.32865127998804],"Hotel_B1-B4":["/res/panelsoil/zenith/4x/Hotel_B1-B4.png",1024,-235.3602215434045],"Hotel_B1-C4":["/res/panelsoil/zenith/4x/Hotel_B1-C4.png",1024,-240.71881877546397],"Hotel_B1-D4":["/res/panelsoil/zenith/4x/Hotel_B1-D4.png",1024,-234.50623629947634],"Hotel_Back1-A1":["/res/panelsoil/zenith/4x/Hotel_Back1-A1.png",1024,-352.42603100654503],"Hotel_Back1-B1":["/res/panelsoil/zenith/4x/Hotel_Back1-B1.png",1024,-351.2552723835686],"Hotel_Back1-C1":["/res/panelsoil/zenith/4x/Hotel_Back1-C1.png",1024,-339.8350511199181],"Hotel_Back1-D1":["/res/panelsoil/zenith/4x/Hotel_Back1-D1.png",1024,-343.48499968740526],"Hotel_Back1-A2":["/res/panelsoil/zenith/4x/Hotel_Back1-A2.png",1024,-332.39993976195484],"Hotel_Back1-B2":["/res/panelsoil/zenith/4x/Hotel_Back1-B2.png",1024,-336.92878350455305],"Hotel_Back1-C2":["/res/panelsoil/zenith/4x/Hotel_Back1-C2.png",1024,-335.7766173748362],"Hotel_Back1-D2":["/res/panelsoil/zenith/4x/Hotel_Back1-D2.png",1024,-328.9726436241886],"Hotel_Back1-A3":["/res/panelsoil/zenith/4x/Hotel_Back1-A3.png",1024,-329.6798214663508],"Hotel_Back1-B3":["/res/panelsoil/zenith/4x/Hotel_Back1-B3.png",1024,-324.3928700517105],"Hotel_Back1-C3":["/res/panelsoil/zenith/4x/Hotel_Back1-C3.png",1024,-319.58853749918484],"Hotel_Back1-D3":["/res/panelsoil/zenith/4x/Hotel_Back1-D3.png",1024,-321.764589654084],"Hotel_Back1-A4":["/res/panelsoil/zenith/4x/Hotel_Back1-A4.png",1024,-313.13640010543793],"Hotel_Back1-B4":["/res/panelsoil/zenith/4x/Hotel_Back1-B4.png",1024,-309.4921603032114],"Hotel_Back1-C4":["/res/panelsoil/zenith/4x/Hotel_Back1-C4.png",1024,-300.67580492891443],"Hotel_Back1-D4":["/res/panelsoil/zenith/4x/Hotel_Back1-D4.png",1024,-304.5920820076063],"Hotel_Back2-A1":["/res/panelsoil/zenith/4x/Hotel_Back2-A1.png",1024,-355.546153024682],"Hotel_Back2-B1":["/res/panelsoil/zenith/4x/Hotel_Back2-B1.png",1024,-350.3903824091002],"Hotel_Back2-C1":["/res/panelsoil/zenith/4x/Hotel_Back2-C1.png",1024,-340.1532083763646],"Hotel_Back2-D1":["/res/panelsoil/zenith/4x/Hotel_Back2-D1.png",1024,-340.2006574376983],"Hotel_Back2-A2":["/res/panelsoil/zenith/4x/Hotel_Back2-A2.png",1024,-334.76203088039875],"Hotel_Back2-B2":["/res/panelsoil/zenith/4x/Hotel_Back2-B2.png",1024,-340.3592061843583],"Hotel_Back2-C2":["/res/panelsoil/zenith/4x/Hotel_Back2-C2.png",1024,-328.0877582867035],"Hotel_Back2-D2":["/res/panelsoil/zenith/4x/Hotel_Back2-D2.png",1024,-326.30685362639804],"Hotel_Back2-A3":["/res/panelsoil/zenith/4x/Hotel_Back2-A3.png",1024,-329.94610593134365],"Hotel_Back2-B3":["/res/panelsoil/zenith/4x/Hotel_Back2-B3.png",1024,-325.13501568055244],"Hotel_Back2-C3":["/res/panelsoil/zenith/4x/Hotel_Back2-C3.png",1024,-321.23305884493857],"Hotel_Back2-D3":["/res/panelsoil/zenith/4x/Hotel_Back2-D3.png",1024,-315.4546201962887],"Hotel_Front-A1":["/res/panelsoil/zenith/4x/Hotel_Front-A1.png",1024,-347.5569494781391],"Hotel_Front-B1":["/res/panelsoil/zenith/4x/Hotel_Front-B1.png",1024,-345.82192313318427],"Hotel_Front-C1":["/res/panelsoil/zenith/4x/Hotel_Front-C1.png",1024,-346.0455962026149],"Hotel_Front-D1":["/res/panelsoil/zenith/4x/Hotel_Front-D1.png",1024,-342.47722681907817],"Hotel_Front-A2":["/res/panelsoil/zenith/4x/Hotel_Front-A2.png",1024,-331.7371487797257],"Hotel_Front-B2":["/res/panelsoil/zenith/4x/Hotel_Front-B2.png",1024,-339.35076622637933],"Hotel_Front-C2":["/res/panelsoil/zenith/4x/Hotel_Front-C2.png",1024,-333.5843129936247],"Hotel_Front-D2":["/res/panelsoil/zenith/4x/Hotel_Front-D2.png",1024,-330.1793424426097],"Hotel_Front-A3":["/res/panelsoil/zenith/4x/Hotel_Front-A3.png",1024,-318.81485584035875],"Hotel_Front-B3":["/res/panelsoil/zenith/4x/Hotel_Front-B3.png",1024,-321.78842251589435],"Hotel_Front-C3":["/res/panelsoil/zenith/4x/Hotel_Front-C3.png",1024,-314.39140640328066],"Hotel_Front-D3":["/res/panelsoil/zenith/4x/Hotel_Front-D3.png",1024,-315.4845105810009],"Hotel_Front-A4":["/res/panelsoil/zenith/4x/Hotel_Front-A4.png",1024,-317.02155102527405],"Hotel_Front-B4":["/res/panelsoil/zenith/4x/Hotel_Front-B4.png",1024,-304.3641026649932],"Hotel_Front-C4":["/res/panelsoil/zenith/4x/Hotel_Front-C4.png",1024,-310.0772664625766],"Hotel_Front-D4":["/res/panelsoil/zenith/4x/Hotel_Front-D4.png",1024,-305.01804865064025],"Hotel_Front-A5":["/res/panelsoil/zenith/4x/Hotel_Front-A5.png",1024,-295.28353582020236],"Hotel_Front-B5":["/res/panelsoil/zenith/4x/Hotel_Front-B5.png",1024,-302.9401887534377],"Hotel_Front-C5":["/res/panelsoil/zenith/4x/Hotel_Front-C5.png",1024,-294.2907399049619],"Hotel_Front-D5":["/res/panelsoil/zenith/4x/Hotel_Front-D5.png",1024,-287.1187766029258],"Hotel_Front-A6":["/res/panelsoil/zenith/4x/Hotel_Front-A6.png",1024,-281.86043314423074],"Hotel_Front-B6":["/res/panelsoil/zenith/4x/Hotel_Front-B6.png",1024,-283.29535777053655],"Hotel_Front-C6":["/res/panelsoil/zenith/4x/Hotel_Front-C6.png",1024,-276.6313452508994],"Hotel_Front-D6":["/res/panelsoil/zenith/4x/Hotel_Front-D6.png",1024,-273.7255281618984],"Hotel_Front-A7":["/res/panelsoil/zenith/4x/Hotel_Front-A7.png",1024,-273.3684068202628],"Hotel_Front-B7":["/res/panelsoil/zenith/4x/Hotel_Front-B7.png",1024,-270.39538935499525],"Hotel_Front-C7":["/res/panelsoil/zenith/4x/Hotel_Front-C7.png",1024,-274.6138196856925],"Hotel_Front-D7":["/res/panelsoil/zenith/4x/Hotel_Front-D7.png",1024,-263.6700284569945],"Hotel_Front-A8":["/res/panelsoil/zenith/4x/Hotel_Front-A8.png",1024,-262.1981990884019],"Hotel_Front-B8":["/res/panelsoil/zenith/4x/Hotel_Front-B8.png",1024,-261.48934292966214],"Hotel_Front-C8":["/res/panelsoil/zenith/4x/Hotel_Front-C8.png",1024,-254.27557009417495],"Hotel_Front-D8":["/res/panelsoil/zenith/4x/Hotel_Front-D8.png",1024,-259.1670439076717],"Lab_A1-A1":["/res/panelsoil/zenith/4x/Lab_A1-A1.png",1024,474.02692633603954],"Lab_A1-B1":["/res/panelsoil/zenith/4x/Lab_A1-B1.png",1024,484.71389236654176],"Lab_A1-C1":["/res/panelsoil/zenith/4x/Lab_A1-C1.png",1024,479.9560274620463],"Lab_A1-D1":["/res/panelsoil/zenith/4x/Lab_A1-D1.png",1024,489.5973134295064],"Lab_A1-A2":["/res/panelsoil/zenith/4x/Lab_A1-A2.png",1024,492.1183378446136],"Lab_A1-B2":["/res/panelsoil/zenith/4x/Lab_A1-B2.png",1024,497.79970164740917],"Lab_A1-C2":["/res/panelsoil/zenith/4x/Lab_A1-C2.png",1024,500.501873554144],"Lab_A1-D2":["/res/panelsoil/zenith/4x/Lab_A1-D2.png",1024,500.8837110859199],"Lab_A1-A3":["/res/panelsoil/zenith/4x/Lab_A1-A3.png",1024,500.01910630423555],"Lab_A1-B3":["/res/panelsoil/zenith/4x/Lab_A1-B3.png",1024,507.87771549810896],"Lab_A1-C3":["/res/panelsoil/zenith/4x/Lab_A1-C3.png",1024,507.2861636193586],"Lab_A1-D3":["/res/panelsoil/zenith/4x/Lab_A1-D3.png",1024,518.430772351996],"Lab_A1-A4":["/res/panelsoil/zenith/4x/Lab_A1-A4.png",1024,518.8470383804837],"Lab_A1-B4":["/res/panelsoil/zenith/4x/Lab_A1-B4.png",1024,513.6622042299274],"Lab_A1-C4":["/res/panelsoil/zenith/4x/Lab_A1-C4.png",1024,519.8057017435472],"Lab_A1-D4":["/res/panelsoil/zenith/4x/Lab_A1-D4.png",1024,529.8120969146897],"Lab_A1-A5":["/res/panelsoil/zenith/4x/Lab_A1-A5.png",1024,533.6822557551158],"Lab_A1-B5":["/res/panelsoil/zenith/4x/Lab_A1-B5.png",1024,526.8810959757367],"Lab_A1-C5":["/res/panelsoil/zenith/4x/Lab_A1-C5.png",1024,533.5258701344837],"Lab_A1-D5":["/res/panelsoil/zenith/4x/Lab_A1-D5.png",1024,532.7127820128112],"Lab_A1-A6":["/res/panelsoil/zenith/4x/Lab_A1-A6.png",1024,541.1521208034685],"Lab_A1-B6":["/res/panelsoil/zenith/4x/Lab_A1-B6.png",1024,545.4575984963269],"Lab_A1-C6":["/res/panelsoil/zenith/4x/Lab_A1-C6.png",1024,551.1989561801959],"Lab_A1-D6":["/res/panelsoil/zenith/4x/Lab_A1-D6.png",1024,554.6397247033085],"Lab_A1-A7":["/res/panelsoil/zenith/4x/Lab_A1-A7.png",1024,553.1787494467978],"Lab_A1-B7":["/res/panelsoil/zenith/4x/Lab_A1-B7.png",1024,558.845704427467],"Lab_A1-C7":["/res/panelsoil/zenith/4x/Lab_A1-C7.png",1024,564.9731407679152],"Lab_A1-D7":["/res/panelsoil/zenith/4x/Lab_A1-D7.png",1024,565.3705595721863],"Lab_A2-A1":["/res/panelsoil/zenith/4x/Lab_A2-A1.png",1024,476.32969791272683],"Lab_A2-B1":["/res/panelsoil/zenith/4x/Lab_A2-B1.png",1024,485.5075270377738],"Lab_A2-C1":["/res/panelsoil/zenith/4x/Lab_A2-C1.png",1024,487.9575360299631],"Lab_A2-D1":["/res/panelsoil/zenith/4x/Lab_A2-D1.png",1024,485.75311037958943],"Lab_A2-A2":["/res/panelsoil/zenith/4x/Lab_A2-A2.png",1024,490.4483241457669],"Lab_A2-B2":["/res/panelsoil/zenith/4x/Lab_A2-B2.png",1024,488.8057636619594],"Lab_A2-C2":["/res/panelsoil/zenith/4x/Lab_A2-C2.png",1024,500.4028880326803],"Lab_A2-D2":["/res/panelsoil/zenith/4x/Lab_A2-D2.png",1024,502.6879062504636],"Lab_A2-A3":["/res/panelsoil/zenith/4x/Lab_A2-A3.png",1024,498.2825790982165],"Lab_A2-B3":["/res/panelsoil/zenith/4x/Lab_A2-B3.png",1024,506.22553089917744],"Lab_A2-C3":["/res/panelsoil/zenith/4x/Lab_A2-C3.png",1024,511.57005148972655],"Lab_A2-D3":["/res/panelsoil/zenith/4x/Lab_A2-D3.png",1024,516.6332839420319],"Lab_A2-A4":["/res/panelsoil/zenith/4x/Lab_A2-A4.png",1024,513.678731103078],"Lab_A2-B4":["/res/panelsoil/zenith/4x/Lab_A2-B4.png",1024,512.9833764249303],"Lab_A2-C4":["/res/panelsoil/zenith/4x/Lab_A2-C4.png",1024,515.9657527391631],"Lab_A2-D4":["/res/panelsoil/zenith/4x/Lab_A2-D4.png",1024,529.1073214195172],"Lab_A2-A5":["/res/panelsoil/zenith/4x/Lab_A2-A5.png",1024,529.1265669496073],"Lab_A2-B5":["/res/panelsoil/zenith/4x/Lab_A2-B5.png",1024,525.9542439317244],"Lab_A2-C5":["/res/panelsoil/zenith/4x/Lab_A2-C5.png",1024,529.5854338267745],"Lab_A2-D5":["/res/panelsoil/zenith/4x/Lab_A2-D5.png",1024,535.3601460134827],"Lab_A2-A6":["/res/panelsoil/zenith/4x/Lab_A2-A6.png",1024,542.8317573185811],"Lab_A2-B6":["/res/panelsoil/zenith/4x/Lab_A2-B6.png",1024,543.8170722108989],"Lab_A2-C6":["/res/panelsoil/zenith/4x/Lab_A2-C6.png",1024,547.3148727048427],"Lab_A2-D6":["/res/panelsoil/zenith/4x/Lab_A2-D6.png",1024,547.0501515657872],"Lab_A2-A7":["/res/panelsoil/zenith/4x/Lab_A2-A7.png",1024,550.1763306042609],"Lab_A2-B7":["/res/panelsoil/zenith/4x/Lab_A2-B7.png",1024,556.2409824572463],"Lab_A2-C7":["/res/panelsoil/zenith/4x/Lab_A2-C7.png",1024,553.070735470069],"Lab_A2-D7":["/res/panelsoil/zenith/4x/Lab_A2-D7.png",1024,566.1013904655343],"Lab_A2-A8":["/res/panelsoil/zenith/4x/Lab_A2-A8.png",1024,566.796905193436],"Lab_A2-B8":["/res/panelsoil/zenith/4x/Lab_A2-B8.png",1024,573.5662156683637],"Lab_A2-C8":["/res/panelsoil/zenith/4x/Lab_A2-C8.png",1024,568.4396776315914],"Lab_A2-D8":["/res/panelsoil/zenith/4x/Lab_A2-D8.png",1024,576.8235182995119],"Lab_B1-A1":["/res/panelsoil/zenith/4x/Lab_B1-A1.png",1024,587.3679956326569],"Lab_B1-B1":["/res/panelsoil/zenith/4x/Lab_B1-B1.png",1024,587.6186851435453],"Lab_B1-C1":["/res/panelsoil/zenith/4x/Lab_B1-C1.png",1024,589.5819708662077],"Lab_B1-D1":["/res/panelsoil/zenith/4x/Lab_B1-D1.png",1024,588.4271363114436],"Lab_B1-A2":["/res/panelsoil/zenith/4x/Lab_B1-A2.png",1024,598.8059171144946],"Lab_B1-B2":["/res/panelsoil/zenith/4x/Lab_B1-B2.png",1024,595.1120053916671],"Lab_B1-C2":["/res/panelsoil/zenith/4x/Lab_B1-C2.png",1024,600.9900817294546],"Lab_B1-D2":["/res/panelsoil/zenith/4x/Lab_B1-D2.png",1024,611.3991220238812],"Lab_B1-A3":["/res/panelsoil/zenith/4x/Lab_B1-A3.png",1024,612.0125231912425],"Lab_B1-B3":["/res/panelsoil/zenith/4x/Lab_B1-B3.png",1024,611.9350209081673],"Lab_B1-C3":["/res/panelsoil/zenith/4x/Lab_B1-C3.png",1024,610.4155311354599],"Lab_B1-D3":["/res/panelsoil/zenith/4x/Lab_B1-D3.png",1024,613.1969857473981],"Lab_B1-A4":["/res/panelsoil/zenith/4x/Lab_B1-A4.png",1024,619.8961706409541],"Lab_B1-B4":["/res/panelsoil/zenith/4x/Lab_B1-B4.png",1024,628.0205165147167],"Lab_B1-C4":["/res/panelsoil/zenith/4x/Lab_B1-C4.png",1024,626.6200791405479],"Lab_B1-D4":["/res/panelsoil/zenith/4x/Lab_B1-D4.png",1024,628.5047034075568],"Lab_B1-A5":["/res/panelsoil/zenith/4x/Lab_B1-A5.png",1024,628.2954647152186],"Lab_B1-B5":["/res/panelsoil/zenith/4x/Lab_B1-B5.png",1024,635.7422991335842],"Lab_B1-C5":["/res/panelsoil/zenith/4x/Lab_B1-C5.png",1024,638.5920792417497],"Lab_B1-D5":["/res/panelsoil/zenith/4x/Lab_B1-D5.png",1024,647.715694689033],"Lab_B1-A6":["/res/panelsoil/zenith/4x/Lab_B1-A6.png",1024,646.4860897273115],"Lab_B1-B6":["/res/panelsoil/zenith/4x/Lab_B1-B6.png",1024,652.3455170184437],"Lab_B1-C6":["/res/panelsoil/zenith/4x/Lab_B1-C6.png",1024,649.2670933904037],"Lab_B1-D6":["/res/panelsoil/zenith/4x/Lab_B1-D6.png",1024,661.664224020842],"Lab_C1-A1":["/res/panelsoil/zenith/4x/Lab_C1-A1.png",1024,635.3666324657529],"Lab_C1-B1":["/res/panelsoil/zenith/4x/Lab_C1-B1.png",1024,637.6649925675821],"Lab_C1-C1":["/res/panelsoil/zenith/4x/Lab_C1-C1.png",1024,645.2408428688634],"Lab_C1-D1":["/res/panelsoil/zenith/4x/Lab_C1-D1.png",1024,649.6876956038442],"Lab_C1-A2":["/res/panelsoil/zenith/4x/Lab_C1-A2.png",1024,644.7831055218577],"Lab_C1-B2":["/res/panelsoil/zenith/4x/Lab_C1-B2.png",1024,652.3386380601828],"Lab_C1-C2":["/res/panelsoil/zenith/4x/Lab_C1-C2.png",1024,656.4477684556008],"Lab_C1-D2":["/res/panelsoil/zenith/4x/Lab_C1-D2.png",1024,663.4595392753256],"Lab_C1-A3":["/res/panelsoil/zenith/4x/Lab_C1-A3.png",1024,656.8795614251133],"Lab_C1-B3":["/res/panelsoil/zenith/4x/Lab_C1-B3.png",1024,665.3585408508359],"Lab_C1-C3":["/res/panelsoil/zenith/4x/Lab_C1-C3.png",1024,662.4462958046549],"Lab_C1-D3":["/res/panelsoil/zenith/4x/Lab_C1-D3.png",1024,666.1953534521843],"Lab_C1-A4":["/res/panelsoil/zenith/4x/Lab_C1-A4.png",1024,679.2103928355588],"Lab_C1-B4":["/res/panelsoil/zenith/4x/Lab_C1-B4.png",1024,679.2846686390867],"Lab_C1-C4":["/res/panelsoil/zenith/4x/Lab_C1-C4.png",1024,674.4906699343306],"Lab_C1-D4":["/res/panelsoil/zenith/4x/Lab_C1-D4.png",1024,685.6786521477308],"Lab_C1-A5":["/res/panelsoil/zenith/4x/Lab_C1-A5.png",1024,688.8696240386024],"Lab_C1-B5":["/res/panelsoil/zenith/4x/Lab_C1-B5.png",1024,692.4846467656046],"Lab_C1-C5":["/res/panelsoil/zenith/4x/Lab_C1-C5.png",1024,687.9883429090379],"Lab_C1-D5":["/res/panelsoil/zenith/4x/Lab_C1-D5.png",1024,693.5755293907488],"Lab_C1-A6":["/res/panelsoil/zenith/4x/Lab_C1-A6.png",1024,696.7075633995793],"Lab_C1-B6":["/res/panelsoil/zenith/4x/Lab_C1-B6.png",1024,705.775135562333],"Lab_C1-C6":["/res/panelsoil/zenith/4x/Lab_C1-C6.png",1024,706.2800170569649],"Lab_C1-D6":["/res/panelsoil/zenith/4x/Lab_C1-D6.png",1024,704.8069254771401],"Lab_Front-A1":["/res/panelsoil/zenith/4x/Lab_Front-A1.png",1024,454.10548548104924],"Lab_Front-B1":["/res/panelsoil/zenith/4x/Lab_Front-B1.png",1024,451.4550210336653],"Lab_Front-C1":["/res/panelsoil/zenith/4x/Lab_Front-C1.png",1024,451.5188196136173],"Lab_Front-D1":["/res/panelsoil/zenith/4x/Lab_Front-D1.png",1024,456.4155593613207],"Lab_Front-A2":["/res/panelsoil/zenith/4x/Lab_Front-A2.png",1024,465.2108966138761],"Lab_Front-B2":["/res/panelsoil/zenith/4x/Lab_Front-B2.png",1024,462.04777473098113],"Lab_Front-C2":["/res/panelsoil/zenith/4x/Lab_Front-C2.png",1024,466.55681106596927],"Lab_Front-D2":["/res/panelsoil/zenith/4x/Lab_Front-D2.png",1024,469.95540892839256],"Lab_Front-A3":["/res/panelsoil/zenith/4x/Lab_Front-A3.png",1024,473.42280198373555],"Lab_Front-B3":["/res/panelsoil/zenith/4x/Lab_Front-B3.png",1024,482.4167025332318],"Lab_Front-C3":["/res/panelsoil/zenith/4x/Lab_Front-C3.png",1024,485.3557025796336],"Lab_Front-D3":["/res/panelsoil/zenith/4x/Lab_Front-D3.png",1024,479.4890792581754],"Lab_Front-A4":["/res/panelsoil/zenith/4x/Lab_Front-A4.png",1024,493.6833473932192],"Lab_Front-B4":["/res/panelsoil/zenith/4x/Lab_Front-B4.png",1024,494.33863336024405],"Lab_Front-C4":["/res/panelsoil/zenith/4x/Lab_Front-C4.png",1024,497.886209039122],"Lab_Front-D4":["/res/panelsoil/zenith/4x/Lab_Front-D4.png",1024,496.33626404859],"Lab_Front-A5":["/res/panelsoil/zenith/4x/Lab_Front-A5.png",1024,499.6334148118994],"Lab_Front-B5":["/res/panelsoil/zenith/4x/Lab_Front-B5.png",1024,504.54178835237775],"Lab_Front-C5":["/res/panelsoil/zenith/4x/Lab_Front-C5.png",1024,504.1022385556514],"Lab_Front-D5":["/res/panelsoil/zenith/4x/Lab_Front-D5.png",1024,506.78374844086454],"Lab_Front-A6":["/res/panelsoil/zenith/4x/Lab_Front-A6.png",1024,518.6783490725634],"Lab_Front-B6":["/res/panelsoil/zenith/4x/Lab_Front-B6.png",1024,513.5059638006234],"Lab_Front-C6":["/res/panelsoil/zenith/4x/Lab_Front-C6.png",1024,515.5143493301232],"Lab_Front-D6":["/res/panelsoil/zenith/4x/Lab_Front-D6.png",1024,516.9435209718606],"Lab_Front-A7":["/res/panelsoil/zenith/4x/Lab_Front-A7.png",1024,527.7458706785028],"Lab_Front-D7":["/res/panelsoil/zenith/4x/Lab_Front-D7.png",1024,534.2196179549679],"Lab_Front-A8":["/res/panelsoil/zenith/4x/Lab_Front-A8.png",1024,537.3411502242183],"Lab_Front-B8":["/res/panelsoil/zenith/4x/Lab_Front-B8.png",1024,535.1299152657615],"Lab_Front-C8":["/res/panelsoil/zenith/4x/Lab_Front-C8.png",1024,542.2589139240833],"Lab_Front-D8":["/res/panelsoil/zenith/4x/Lab_Front-D8.png",1024,542.8942177472563],"Lab_Front-A9":["/res/panelsoil/zenith/4x/Lab_Front-A9.png",1024,551.6210599699765],"Lab_Front-B9":["/res/panelsoil/zenith/4x/Lab_Front-B9.png",1024,549.1362700298381],"Lab_Front-C9":["/res/panelsoil/zenith/4x/Lab_Front-C9.png",1024,559.9922064917141],"Lab_Front-D9":["/res/panelsoil/zenith/4x/Lab_Front-D9.png",1024,561.3083858360499],"Lab_Front-A10":["/res/panelsoil/zenith/4x/Lab_Front-A10.png",1024,561.641460688078],"Lab_Front-B10":["/res/panelsoil/zenith/4x/Lab_Front-B10.png",1024,571.6877359305752],"Lab_Front-D10":["/res/panelsoil/zenith/4x/Lab_Front-D10.png",1024,567.1253629784255],"Lab_Front-A11":["/res/panelsoil/zenith/4x/Lab_Front-A11.png",1024,579.7032624643832],"Lab_Front-B11":["/res/panelsoil/zenith/4x/Lab_Front-B11.png",1024,581.0509134376123],"Lab_Front-C11":["/res/panelsoil/zenith/4x/Lab_Front-C11.png",1024,577.7453279328216],"Lab_Front-D11":["/res/panelsoil/zenith/4x/Lab_Front-D11.png",1024,579.4088089467493],"Lab_Front-A12":["/res/panelsoil/zenith/4x/Lab_Front-A12.png",1024,581.7887517244169],"Lab_Front-B12":["/res/panelsoil/zenith/4x/Lab_Front-B12.png",1024,589.911573194737],"Lab_Front-C12":["/res/panelsoil/zenith/4x/Lab_Front-C12.png",1024,592.6268638261888],"Lab_Front-D12":["/res/panelsoil/zenith/4x/Lab_Front-D12.png",1024,601.9039705359855],"Lab_Front-A13":["/res/panelsoil/zenith/4x/Lab_Front-A13.png",1024,595.0385236436451],"Lab_Front-B13":["/res/panelsoil/zenith/4x/Lab_Front-B13.png",1024,600.516700314105],"Lab_Front-C13":["/res/panelsoil/zenith/4x/Lab_Front-C13.png",1024,601.119779458386],"Lab_Front-D13":["/res/panelsoil/zenith/4x/Lab_Front-D13.png",1024,614.1879822996071],"Lab_Front-A14":["/res/panelsoil/zenith/4x/Lab_Front-A14.png",1024,617.525136578967],"Lab_Front-B14":["/res/panelsoil/zenith/4x/Lab_Front-B14.png",1024,615.9602366542069],"Lab_Front-C14":["/res/panelsoil/zenith/4x/Lab_Front-C14.png",1024,623.2380058375733],"Lab_Front-D14":["/res/panelsoil/zenith/4x/Lab_Front-D14.png",1024,626.7724644013348],"Lab_Front-A15":["/res/panelsoil/zenith/4x/Lab_Front-A15.png",1024,629.3612508508743],"Lab_Front-B15":["/res/panelsoil/zenith/4x/Lab_Front-B15.png",1024,624.6359974471226],"Lab_Front-C15":["/res/panelsoil/zenith/4x/Lab_Front-C15.png",1024,632.7519141084904],"Lab_Front-D15":["/res/panelsoil/zenith/4x/Lab_Front-D15.png",1024,638.549291268028],"Lab_Front-A16":["/res/panelsoil/zenith/4x/Lab_Front-A16.png",1024,636.4586429733091],"Lab_Front-B16":["/res/panelsoil/zenith/4x/Lab_Front-B16.png",1024,636.4112251809946],"Lab_Front-C16":["/res/panelsoil/zenith/4x/Lab_Front-C16.png",1024,641.2504226889895],"Lab_Front-D16":["/res/panelsoil/zenith/4x/Lab_Front-D16.png",1024,646.0830525188487],"Lab_Front-A17":["/res/panelsoil/zenith/4x/Lab_Front-A17.png",1024,648.2439197542117],"Lab_Front-B17":["/res/panelsoil/zenith/4x/Lab_Front-B17.png",1024,657.8689781186537],"Lab_Front-C17":["/res/panelsoil/zenith/4x/Lab_Front-C17.png",1024,657.5507801836102],"Lab_Front-D17":["/res/panelsoil/zenith/4x/Lab_Front-D17.png",1024,659.968454361682],"Lab_Front-A18":["/res/panelsoil/zenith/4x/Lab_Front-A18.png",1024,665.6866175575427],"Lab_Front-B18":["/res/panelsoil/zenith/4x/Lab_Front-B18.png",1024,664.5895215198692],"Lab_Front-C18":["/res/panelsoil/zenith/4x/Lab_Front-C18.png",1024,670.4917520758393],"Lab_Front-D18":["/res/panelsoil/zenith/4x/Lab_Front-D18.png",1024,668.9339005076505],"Lab_Front-A19":["/res/panelsoil/zenith/4x/Lab_Front-A19.png",1024,674.6469119136998],"Lab_Front-B19":["/res/panelsoil/zenith/4x/Lab_Front-B19.png",1024,679.6664307159847],"Lab_Front-C19":["/res/panelsoil/zenith/4x/Lab_Front-C19.png",1024,679.3064262683207],"Lab_Front-D19":["/res/panelsoil/zenith/4x/Lab_Front-D19.png",1024,680.8352126747799],"Lab_Front-A20":["/res/panelsoil/zenith/4x/Lab_Front-A20.png",1024,690.7800207649349],"Lab_Front-B20":["/res/panelsoil/zenith/4x/Lab_Front-B20.png",1024,689.4430824753432],"Lab_Front-C20":["/res/panelsoil/zenith/4x/Lab_Front-C20.png",1024,693.2587412249555],"Lab_Front-D20":["/res/panelsoil/zenith/4x/Lab_Front-D20.png",1024,694.4225346668921],"Museum_A1-A1":["/res/panelsoil/zenith/4x/Museum_A1-A1.png",1024,46.59978829337548],"Museum_A1-B1":["/res/panelsoil/zenith/4x/Museum_A1-B1.png",1024,48.616792441979534],"Museum_A1-C1":["/res/panelsoil/zenith/4x/Museum_A1-C1.png",1024,57.985427571013716],"Museum_A1-D1":["/res/panelsoil/zenith/4x/Museum_A1-D1.png",1024,61.834474201722415],"Museum_A1-A2":["/res/panelsoil/zenith/4x/Museum_A1-A2.png",1024,60.38048009658159],"Museum_A1-B2":["/res/panelsoil/zenith/4x/Museum_A1-B2.png",1024,62.290543116898974],"Museum_A1-C2":["/res/panelsoil/zenith/4x/Museum_A1-C2.png",1024,63.010384732152005],"Museum_A1-D2":["/res/panelsoil/zenith/4x/Museum_A1-D2.png",1024,75.75739174073459],"Museum_A1-A3":["/res/panelsoil/zenith/4x/Museum_A1-A3.png",1024,69.50441716767774],"Museum_A1-B3":["/res/panelsoil/zenith/4x/Museum_A1-B3.png",1024,78.40767692095648],"Museum_A1-C3":["/res/panelsoil/zenith/4x/Museum_A1-C3.png",1024,77.87126107406719],"Museum_A1-D3":["/res/panelsoil/zenith/4x/Museum_A1-D3.png",1024,83.47248259532998],"Museum_A1-A4":["/res/panelsoil/zenith/4x/Museum_A1-A4.png",1024,87.06127847045964],"Museum_A1-B4":["/res/panelsoil/zenith/4x/Museum_A1-B4.png",1024,84.40552141858308],"Museum_A1-C4":["/res/panelsoil/zenith/4x/Museum_A1-C4.png",1024,88.8698777863725],"Museum_A1-D4":["/res/panelsoil/zenith/4x/Museum_A1-D4.png",1024,95.92760419598065],"Museum_A1-A5":["/res/panelsoil/zenith/4x/Museum_A1-A5.png",1024,97.08567143403127],"Museum_A1-B5":["/res/panelsoil/zenith/4x/Museum_A1-B5.png",1024,97.56953887956807],"Museum_A1-C5":["/res/panelsoil/zenith/4x/Museum_A1-C5.png",1024,110.58678414394728],"Museum_A1-D5":["/res/panelsoil/zenith/4x/Museum_A1-D5.png",1024,103.41768238627753],"Museum_B1-A1":["/res/panelsoil/zenith/4x/Museum_B1-A1.png",1024,118.5302062384831],"Museum_B1-B1":["/res/panelsoil/zenith/4x/Museum_B1-B1.png",1024,122.71857401310206],"Museum_B1-C1":["/res/panelsoil/zenith/4x/Museum_B1-C1.png",1024,130.63007535410873],"Museum_B1-D1":["/res/panelsoil/zenith/4x/Museum_B1-D1.png",1024,129.3354088321838],"Museum_B1-A2":["/res/panelsoil/zenith/4x/Museum_B1-A2.png",1024,126.74546014419451],"Museum_B1-B2":["/res/panelsoil/zenith/4x/Museum_B1-B2.png",1024,137.64055767750176],"Museum_B1-C2":["/res/panelsoil/zenith/4x/Museum_B1-C2.png",1024,138.75102093563285],"Museum_B1-D2":["/res/panelsoil/zenith/4x/Museum_B1-D2.png",1024,143.71858738196482],"Museum_B1-A3":["/res/panelsoil/zenith/4x/Museum_B1-A3.png",1024,145.57735246423368],"Museum_B1-B3":["/res/panelsoil/zenith/4x/Museum_B1-B3.png",1024,152.30718669778807],"Museum_B1-C3":["/res/panelsoil/zenith/4x/Museum_B1-C3.png",1024,146.17830228022797],"Museum_B1-D3":["/res/panelsoil/zenith/4x/Museum_B1-D3.png",1024,150.3647531216859],"Museum_B1-A4":["/res/panelsoil/zenith/4x/Museum_B1-A4.png",1024,154.66027593332825],"Museum_B1-B4":["/res/panelsoil/zenith/4x/Museum_B1-B4.png",1024,159.48478848140812],"Museum_B1-C4":["/res/panelsoil/zenith/4x/Museum_B1-C4.png",1024,162.47382921559068],"Museum_B1-D4":["/res/panelsoil/zenith/4x/Museum_B1-D4.png",1024,166.10110296265978],"Museum_B1-A5":["/res/panelsoil/zenith/4x/Museum_B1-A5.png",1024,174.25447488000873],"Museum_B1-B5":["/res/panelsoil/zenith/4x/Museum_B1-B5.png",1024,169.46905757622577],"Museum_B1-C5":["/res/panelsoil/zenith/4x/Museum_B1-C5.png",1024,177.42550712353966],"Museum_B1-D5":["/res/panelsoil/zenith/4x/Museum_B1-D5.png",1024,174.0196593814839],"Museum_C1-A1":["/res/panelsoil/zenith/4x/Museum_C1-A1.png",1024,194.55963688722414],"Museum_C1-B1":["/res/panelsoil/zenith/4x/Museum_C1-B1.png",1024,199.46226059807034],"Museum_C1-C1":["/res/panelsoil/zenith/4x/Museum_C1-C1.png",1024,194.3649301229584],"Museum_C1-D1":["/res/panelsoil/zenith/4x/Museum_C1-D1.png",1024,202.92856448422341],"Museum_C1-A2":["/res/panelsoil/zenith/4x/Museum_C1-A2.png",1024,197.78497400552527],"Museum_C1-B2":["/res/panelsoil/zenith/4x/Museum_C1-B2.png",1024,203.96593839766174],"Museum_C1-C2":["/res/panelsoil/zenith/4x/Museum_C1-C2.png",1024,214.01241245707845],"Museum_C1-D2":["/res/panelsoil/zenith/4x/Museum_C1-D2.png",1024,216.8806084095604],"Museum_C1-A3":["/res/panelsoil/zenith/4x/Museum_C1-A3.png",1024,209.77787414599894],"Museum_C1-B3":["/res/panelsoil/zenith/4x/Museum_C1-B3.png",1024,219.51398040906486],"Museum_C1-C3":["/res/panelsoil/zenith/4x/Museum_C1-C3.png",1024,221.92522471115967],"Museum_C1-D3":["/res/panelsoil/zenith/4x/Museum_C1-D3.png",1024,219.9057209233558],"Museum_C1-A4":["/res/panelsoil/zenith/4x/Museum_C1-A4.png",1024,224.65982365790694],"Museum_C1-B4":["/res/panelsoil/zenith/4x/Museum_C1-B4.png",1024,234.9723997968329],"Museum_C1-C4":["/res/panelsoil/zenith/4x/Museum_C1-C4.png",1024,228.9522099892471],"Museum_C1-D4":["/res/panelsoil/zenith/4x/Museum_C1-D4.png",1024,234.99239947802832],"Museum_C1-A5":["/res/panelsoil/zenith/4x/Museum_C1-A5.png",1024,240.2618340843814],"Museum_C1-B5":["/res/panelsoil/zenith/4x/Museum_C1-B5.png",1024,245.0272513778577],"Museum_C1-C5":["/res/panelsoil/zenith/4x/Museum_C1-C5.png",1024,244.9036433061855],"Museum_C1-D5":["/res/panelsoil/zenith/4x/Museum_C1-D5.png",1024,247.67615321695186],"Museum_C1-A6":["/res/panelsoil/zenith/4x/Museum_C1-A6.png",1024,248.20726412734524],"Museum_C1-B6":["/res/panelsoil/zenith/4x/Museum_C1-B6.png",1024,261.26584076329294],"Museum_C1-C6":["/res/panelsoil/zenith/4x/Museum_C1-C6.png",1024,259.1572344113612],"Museum_C1-D6":["/res/panelsoil/zenith/4x/Museum_C1-D6.png",1024,262.12326750243443],"Museum_C2-A1":["/res/panelsoil/zenith/4x/Museum_C2-A1.png",1024,186.63862323746727],"Museum_C2-B1":["/res/panelsoil/zenith/4x/Museum_C2-B1.png",1024,196.5717667996199],"Museum_C2-C1":["/res/panelsoil/zenith/4x/Museum_C2-C1.png",1024,199.83350242132772],"Museum_C2-D1":["/res/panelsoil/zenith/4x/Museum_C2-D1.png",1024,202.55209193463773],"Museum_C2-A2":["/res/panelsoil/zenith/4x/Museum_C2-A2.png",1024,203.96809847646952],"Museum_C2-B2":["/res/panelsoil/zenith/4x/Museum_C2-B2.png",1024,203.73571011742635],"Museum_C2-C2":["/res/panelsoil/zenith/4x/Museum_C2-C2.png",1024,212.98005029575268],"Museum_C2-D2":["/res/panelsoil/zenith/4x/Museum_C2-D2.png",1024,210.18258488982954],"Museum_C2-A3":["/res/panelsoil/zenith/4x/Museum_C2-A3.png",1024,213.14175434519237],"Museum_C2-B3":["/res/panelsoil/zenith/4x/Museum_C2-B3.png",1024,222.1846862722836],"Museum_C2-C3":["/res/panelsoil/zenith/4x/Museum_C2-C3.png",1024,218.75107139916412],"Museum_C2-D3":["/res/panelsoil/zenith/4x/Museum_C2-D3.png",1024,223.65409596642377],"Museum_C2-A4":["/res/panelsoil/zenith/4x/Museum_C2-A4.png",1024,233.83206542980582],"Museum_C2-B4":["/res/panelsoil/zenith/4x/Museum_C2-B4.png",1024,232.9316860567154],"Museum_C2-C4":["/res/panelsoil/zenith/4x/Museum_C2-C4.png",1024,230.9744082554335],"Museum_C2-D4":["/res/panelsoil/zenith/4x/Museum_C2-D4.png",1024,235.82181368869053],"Museum_C2-A5":["/res/panelsoil/zenith/4x/Museum_C2-A5.png",1024,244.19154657196808],"Museum_C2-B5":["/res/panelsoil/zenith/4x/Museum_C2-B5.png",1024,249.8004907626816],"Museum_C2-C5":["/res/panelsoil/zenith/4x/Museum_C2-C5.png",1024,249.1392267011303],"Museum_C2-D5":["/res/panelsoil/zenith/4x/Museum_C2-D5.png",1024,250.8584754126466],"Museum_C2-A6":["/res/panelsoil/zenith/4x/Museum_C2-A6.png",1024,259.34743298002803],"Museum_C2-B6":["/res/panelsoil/zenith/4x/Museum_C2-B6.png",1024,252.07330376361386],"Museum_C2-C6":["/res/panelsoil/zenith/4x/Museum_C2-C6.png",1024,254.6984807294187],"Museum_C2-D6":["/res/panelsoil/zenith/4x/Museum_C2-D6.png",1024,263.6375426507399],"Museum_Front-A1":["/res/panelsoil/zenith/4x/Museum_Front-A1.png",1024,55.07788013340668],"Museum_Front-B1":["/res/panelsoil/zenith/4x/Museum_Front-B1.png",1024,46.90138775293972],"Museum_Front-C1":["/res/panelsoil/zenith/4x/Museum_Front-C1.png",1024,55.984925652743094],"Museum_Front-D1":["/res/panelsoil/zenith/4x/Museum_Front-D1.png",1024,54.049146786324435],"Museum_Front-A2":["/res/panelsoil/zenith/4x/Museum_Front-A2.png",1024,59.25242950330261],"Museum_Front-B2":["/res/panelsoil/zenith/4x/Museum_Front-B2.png",1024,61.6027265907167],"Museum_Front-C2":["/res/panelsoil/zenith/4x/Museum_Front-C2.png",1024,73.10580579701693],"Museum_Front-D2":["/res/panelsoil/zenith/4x/Museum_Front-D2.png",1024,72.09315514694437],"Museum_Front-A3":["/res/panelsoil/zenith/4x/Museum_Front-A3.png",1024,80.64533424837533],"Museum_Front-B3":["/res/panelsoil/zenith/4x/Museum_Front-B3.png",1024,82.555959637575],"Museum_Front-C3":["/res/panelsoil/zenith/4x/Museum_Front-C3.png",1024,80.16110547214696],"Museum_Front-D3":["/res/panelsoil/zenith/4x/Museum_Front-D3.png",1024,79.37926749369409],"Museum_Front-A4":["/res/panelsoil/zenith/4x/Museum_Front-A4.png",1024,82.80606036866969],"Museum_Front-B4":["/res/panelsoil/zenith/4x/Museum_Front-B4.png",1024,86.08952484457389],"Museum_Front-C4":["/res/panelsoil/zenith/4x/Museum_Front-C4.png",1024,99.68600984036365],"Museum_Front-D4":["/res/panelsoil/zenith/4x/Museum_Front-D4.png",1024,100.94539081802007],"Museum_Front-A5":["/res/panelsoil/zenith/4x/Museum_Front-A5.png",1024,105.38639093641653],"Museum_Front-B5":["/res/panelsoil/zenith/4x/Museum_Front-B5.png",1024,103.55305032445659],"Museum_Front-C5":["/res/panelsoil/zenith/4x/Museum_Front-C5.png",1024,100.10040311959341],"Museum_Front-D5":["/res/panelsoil/zenith/4x/Museum_Front-D5.png",1024,114.45249382647128],"Museum_Front-A6":["/res/panelsoil/zenith/4x/Museum_Front-A6.png",1024,110.16878144407866],"Museum_Front-B6":["/res/panelsoil/zenith/4x/Museum_Front-B6.png",1024,110.58950675294128],"Museum_Front-C6":["/res/panelsoil/zenith/4x/Museum_Front-C6.png",1024,120.21593427406606],"Museum_Front-D6":["/res/panelsoil/zenith/4x/Museum_Front-D6.png",1024,121.27854221659223],"Museum_Front-A7":["/res/panelsoil/zenith/4x/Museum_Front-A7.png",1024,126.65202661938704],"Museum_Front-B7":["/res/panelsoil/zenith/4x/Museum_Front-B7.png",1024,126.32936319069893],"Museum_Front-C7":["/res/panelsoil/zenith/4x/Museum_Front-C7.png",1024,130.6372114086022],"Museum_Front-D7":["/res/panelsoil/zenith/4x/Museum_Front-D7.png",1024,139.36215610250602],"Museum_Front-A8":["/res/panelsoil/zenith/4x/Museum_Front-A8.png",1024,137.7984256675717],"Museum_Front-B8":["/res/panelsoil/zenith/4x/Museum_Front-B8.png",1024,136.60333350774758],"Museum_Front-C8":["/res/panelsoil/zenith/4x/Museum_Front-C8.png",1024,145.25633783431778],"Museum_Front-D8":["/res/panelsoil/zenith/4x/Museum_Front-D8.png",1024,149.4696572792305],"Museum_Front-A9":["/res/panelsoil/zenith/4x/Museum_Front-A9.png",1024,152.09737644214917],"Museum_Front-B9":["/res/panelsoil/zenith/4x/Museum_Front-B9.png",1024,157.04944254558478],"Museum_Front-C9":["/res/panelsoil/zenith/4x/Museum_Front-C9.png",1024,162.36757268131086],"Museum_Front-D9":["/res/panelsoil/zenith/4x/Museum_Front-D9.png",1024,156.38666218060894],"Museum_Front-A10":["/res/panelsoil/zenith/4x/Museum_Front-A10.png",1024,168.44989996388767],"Museum_Front-B10":["/res/panelsoil/zenith/4x/Museum_Front-B10.png",1024,164.9218794573214],"Museum_Front-C10":["/res/panelsoil/zenith/4x/Museum_Front-C10.png",1024,163.34563731840782],"Museum_Front-D10":["/res/panelsoil/zenith/4x/Museum_Front-D10.png",1024,177.18838832864296],"Museum_Front-A11":["/res/panelsoil/zenith/4x/Museum_Front-A11.png",1024,169.42532053408348],"Museum_Front-B11":["/res/panelsoil/zenith/4x/Museum_Front-B11.png",1024,177.37051929311207],"Museum_Front-C11":["/res/panelsoil/zenith/4x/Museum_Front-C11.png",1024,182.81029147721205],"Museum_Front-D11":["/res/panelsoil/zenith/4x/Museum_Front-D11.png",1024,180.1272448529235],"Museum_Front-A12":["/res/panelsoil/zenith/4x/Museum_Front-A12.png",1024,191.76718649436992],"Museum_Front-B12":["/res/panelsoil/zenith/4x/Museum_Front-B12.png",1024,194.17344661655315],"Museum_Front-C12":["/res/panelsoil/zenith/4x/Museum_Front-C12.png",1024,188.94686998340896],"Museum_Front-D12":["/res/panelsoil/zenith/4x/Museum_Front-D12.png",1024,194.67922080099117],"Museum_Front-A13":["/res/panelsoil/zenith/4x/Museum_Front-A13.png",1024,199.60579011410823],"Museum_Front-B13":["/res/panelsoil/zenith/4x/Museum_Front-B13.png",1024,206.52263444789145],"Museum_Front-C13":["/res/panelsoil/zenith/4x/Museum_Front-C13.png",1024,200.2464528629405],"Museum_Front-D13":["/res/panelsoil/zenith/4x/Museum_Front-D13.png",1024,215.54455197627118],"Museum_Front-A14":["/res/panelsoil/zenith/4x/Museum_Front-A14.png",1024,211.038119493465],"Museum_Front-B14":["/res/panelsoil/zenith/4x/Museum_Front-B14.png",1024,216.2325666294373],"Museum_Front-D14":["/res/panelsoil/zenith/4x/Museum_Front-D14.png",1024,217.68903548499785],"Museum_Front-A15":["/res/panelsoil/zenith/4x/Museum_Front-A15.png",1024,223.35957731309554],"Museum_Front-B15":["/res/panelsoil/zenith/4x/Museum_Front-B15.png",1024,230.92400700227049],"Museum_Front-C15":["/res/panelsoil/zenith/4x/Museum_Front-C15.png",1024,227.73850392041982],"Museum_Front-D15":["/res/panelsoil/zenith/4x/Museum_Front-D15.png",1024,234.14797332440068],"Museum_Front-A16":["/res/panelsoil/zenith/4x/Museum_Front-A16.png",1024,243.61072293490804],"Museum_Front-B16":["/res/panelsoil/zenith/4x/Museum_Front-B16.png",1024,246.50140522356392],"Museum_Front-C16":["/res/panelsoil/zenith/4x/Museum_Front-C16.png",1024,240.5420468339251],"Museum_Front-D16":["/res/panelsoil/zenith/4x/Museum_Front-D16.png",1024,242.63146956808595],"Office_A1-A1":["/res/panelsoil/zenith/4x/Office_A1-A1.png",1024,249.86089700547046],"Office_A1-B1":["/res/panelsoil/zenith/4x/Office_A1-B1.png",1024,255.41331744595698],"Office_A1-C1":["/res/panelsoil/zenith/4x/Office_A1-C1.png",1024,258.7210504166603],"Office_A1-D1":["/res/panelsoil/zenith/4x/Office_A1-D1.png",1024,262.06920304731244],"Office_A1-A2":["/res/panelsoil/zenith/4x/Office_A1-A2.png",1024,269.4926686042102],"Office_A1-B2":["/res/panelsoil/zenith/4x/Office_A1-B2.png",1024,274.06073650938004],"Office_A1-C2":["/res/panelsoil/zenith/4x/Office_A1-C2.png",1024,270.91053116569725],"Office_A1-D2":["/res/panelsoil/zenith/4x/Office_A1-D2.png",1024,283.0404434382253],"Office_A1-A3":["/res/panelsoil/zenith/4x/Office_A1-A3.png",1024,282.83109415865385],"Office_A1-B3":["/res/panelsoil/zenith/4x/Office_A1-B3.png",1024,287.8931691429911],"Office_A1-C3":["/res/panelsoil/zenith/4x/Office_A1-C3.png",1024,284.55359036718744],"Office_A1-D3":["/res/panelsoil/zenith/4x/Office_A1-D3.png",1024,288.8021732748903],"Office_A1-A4":["/res/panelsoil/zenith/4x/Office_A1-A4.png",1024,299.4555350742581],"Office_A1-B4":["/res/panelsoil/zenith/4x/Office_A1-B4.png",1024,293.9073812533184],"Office_A1-C4":["/res/panelsoil/zenith/4x/Office_A1-C4.png",1024,297.01388597831095],"Office_A1-D4":["/res/panelsoil/zenith/4x/Office_A1-D4.png",1024,297.7808876841507],"Office_A1-A5":["/res/panelsoil/zenith/4x/Office_A1-A5.png",1024,308.92382973556596],"Office_A1-B5":["/res/panelsoil/zenith/4x/Office_A1-B5.png",1024,313.33172666756275],"Office_A1-C5":["/res/panelsoil/zenith/4x/Office_A1-C5.png",1024,310.8425600800973],"Office_A1-D5":["/res/panelsoil/zenith/4x/Office_A1-D5.png",1024,309.96018868817083],"Office_A1-A6":["/res/panelsoil/zenith/4x/Office_A1-A6.png",1024,323.186714230363],"Office_A1-B6":["/res/panelsoil/zenith/4x/Office_A1-B6.png",1024,327.65712894295586],"Office_A1-C6":["/res/panelsoil/zenith/4x/Office_A1-C6.png",1024,329.41601995279143],"Office_A1-D6":["/res/panelsoil/zenith/4x/Office_A1-D6.png",1024,323.4610257242614],"Office_A1-A7":["/res/panelsoil/zenith/4x/Office_A1-A7.png",1024,334.9133566093439],"Office_A1-B7":["/res/panelsoil/zenith/4x/Office_A1-B7.png",1024,335.05053556485916],"Office_A1-C7":["/res/panelsoil/zenith/4x/Office_A1-C7.png",1024,338.27744079112296],"Office_A1-D7":["/res/panelsoil/zenith/4x/Office_A1-D7.png",1024,343.75478118789243],"Office_B1-A1":["/res/panelsoil/zenith/4x/Office_B1-A1.png",1024,349.5366881398062],"Office_B1-B1":["/res/panelsoil/zenith/4x/Office_B1-B1.png",1024,352.6027864262215],"Office_B1-C1":["/res/panelsoil/zenith/4x/Office_B1-C1.png",1024,358.1237663760002],"Office_B1-D1":["/res/panelsoil/zenith/4x/Office_B1-D1.png",1024,369.1134661627141],"Office_B1-A2":["/res/panelsoil/zenith/4x/Office_B1-A2.png",1024,372.37484669513225],"Office_B1-B2":["/res/panelsoil/zenith/4x/Office_B1-B2.png",1024,376.0464163558496],"Office_B1-C2":["/res/panelsoil/zenith/4x/Office_B1-C2.png",1024,370.14732424926615],"Office_B1-D2":["/res/panelsoil/zenith/4x/Office_B1-D2.png",1024,382.70609137577554],"Office_B1-A3":["/res/panelsoil/zenith/4x/Office_B1-A3.png",1024,384.34893681842186],"Office_B1-B3":["/res/panelsoil/zenith/4x/Office_B1-B3.png",1024,387.0400714777274],"Office_B1-C3":["/res/panelsoil/zenith/4x/Office_B1-C3.png",1024,388.1089998547281],"Office_B1-D3":["/res/panelsoil/zenith/4x/Office_B1-D3.png",1024,389.3173653406967],"Office_B1-A4":["/res/panelsoil/zenith/4x/Office_B1-A4.png",1024,397.7012103742166],"Office_B1-B4":["/res/panelsoil/zenith/4x/Office_B1-B4.png",1024,393.77306402587897],"Office_B1-C4":["/res/panelsoil/zenith/4x/Office_B1-C4.png",1024,402.14466848568804],"Office_B1-D4":["/res/panelsoil/zenith/4x/Office_B1-D4.png",1024,400.5462619392742],"Office_B2-A1":["/res/panelsoil/zenith/4x/Office_B2-A1.png",1024,360.0894907558053],"Office_B2-B1":["/res/panelsoil/zenith/4x/Office_B2-B1.png",1024,360.9325741315679],"Office_B2-C1":["/res/panelsoil/zenith/4x/Office_B2-C1.png",1024,364.3534319591203],"Office_B2-D1":["/res/panelsoil/zenith/4x/Office_B2-D1.png",1024,363.4083633768711],"Office_B2-A2":["/res/panelsoil/zenith/4x/Office_B2-A2.png",1024,369.19185262674785],"Office_B2-B2":["/res/panelsoil/zenith/4x/Office_B2-B2.png",1024,372.09034340785513],"Office_B2-C2":["/res/panelsoil/zenith/4x/Office_B2-C2.png",1024,373.7651958137172],"Office_B2-D2":["/res/panelsoil/zenith/4x/Office_B2-D2.png",1024,371.97537902461715],"Office_B2-A3":["/res/panelsoil/zenith/4x/Office_B2-A3.png",1024,379.13497412127896],"Office_B2-B3":["/res/panelsoil/zenith/4x/Office_B2-B3.png",1024,387.96763686672097],"Office_B2-C3":["/res/panelsoil/zenith/4x/Office_B2-C3.png",1024,383.15888494852686],"Office_B2-D3":["/res/panelsoil/zenith/4x/Office_B2-D3.png",1024,390.91842537296844],"Office_B2-A4":["/res/panelsoil/zenith/4x/Office_B2-A4.png",1024,390.5956443110137],"Office_B2-B4":["/res/panelsoil/zenith/4x/Office_B2-B4.png",1024,400.72934834244086],"Office_B2-C4":["/res/panelsoil/zenith/4x/Office_B2-C4.png",1024,393.6474082655962],"Office_B2-D4":["/res/panelsoil/zenith/4x/Office_B2-D4.png",1024,404.820001817146],"Office_Front-A1":["/res/panelsoil/zenith/4x/Office_Front-A1.png",1024,252.90368489104316],"Office_Front-B1":["/res/panelsoil/zenith/4x/Office_Front-B1.png",1024,256.94067882702046],"Office_Front-C1":["/res/panelsoil/zenith/4x/Office_Front-C1.png",1024,256.7984312680423],"Office_Front-D1":["/res/panelsoil/zenith/4x/Office_Front-D1.png",1024,265.3636720015981],"Office_Front-A2":["/res/panelsoil/zenith/4x/Office_Front-A2.png",1024,261.0890747194432],"Office_Front-B2":["/res/panelsoil/zenith/4x/Office_Front-B2.png",1024,265.32237660400125],"Office_Front-C2":["/res/panelsoil/zenith/4x/Office_Front-C2.png",1024,265.8987721387467],"Office_Front-D2":["/res/panelsoil/zenith/4x/Office_Front-D2.png",1024,272.51413418709393],"Office_Front-A3":["/res/panelsoil/zenith/4x/Office_Front-A3.png",1024,272.67779051901954],"Office_Front-B3":["/res/panelsoil/zenith/4x/Office_Front-B3.png",1024,278.59639127712126],"Office_Front-C3":["/res/panelsoil/zenith/4x/Office_Front-C3.png",1024,275.6019425899489],"Office_Front-D3":["/res/panelsoil/zenith/4x/Office_Front-D3.png",1024,288.2517506052309],"Office_Front-A4":["/res/panelsoil/zenith/4x/Office_Front-A4.png",1024,293.38765626095204],"Office_Front-B4":["/res/panelsoil/zenith/4x/Office_Front-B4.png",1024,292.07594195773],"Office_Front-C4":["/res/panelsoil/zenith/4x/Office_Front-C4.png",1024,294.53904771388653],"Office_Front-D4":["/res/panelsoil/zenith/4x/Office_Front-D4.png",1024,297.83547910747853],"Office_Front-A5":["/res/panelsoil/zenith/4x/Office_Front-A5.png",1024,301.78917296669056],"Office_Front-B5":["/res/panelsoil/zenith/4x/Office_Front-B5.png",1024,302.9063869997582],"Office_Front-C5":["/res/panelsoil/zenith/4x/Office_Front-C5.png",1024,302.15407900532813],"Office_Front-D5":["/res/panelsoil/zenith/4x/Office_Front-D5.png",1024,306.40487086901857],"Office_Front-A6":["/res/panelsoil/zenith/4x/Office_Front-A6.png",1024,316.0025397813393],"Office_Front-B6":["/res/panelsoil/zenith/4x/Office_Front-B6.png",1024,317.8014489356886],"Office_Front-C6":["/res/panelsoil/zenith/4x/Office_Front-C6.png",1024,313.12418193486013],"Office_Front-D6":["/res/panelsoil/zenith/4x/Office_Front-D6.png",1024,321.59743286926397],"Office_Front-A7":["/res/panelsoil/zenith/4x/Office_Front-A7.png",1024,319.2927636061912],"Office_Front-B7":["/res/panelsoil/zenith/4x/Office_Front-B7.png",1024,325.468491348627],"Office_Front-C7":["/res/panelsoil/zenith/4x/Office_Front-C7.png",1024,333.573381492546],"Office_Front-D7":["/res/panelsoil/zenith/4x/Office_Front-D7.png",1024,339.84068339856503],"Office_Front-A8":["/res/panelsoil/zenith/4x/Office_Front-A8.png",1024,340.6258441536597],"Office_Front-B8":["/res/panelsoil/zenith/4x/Office_Front-B8.png",1024,339.43327558509895],"Office_Front-C8":["/res/panelsoil/zenith/4x/Office_Front-C8.png",1024,340.599505311138],"Office_Front-D8":["/res/panelsoil/zenith/4x/Office_Front-D8.png",1024,342.78983752380066],"Office_Front-A9":["/res/panelsoil/zenith/4x/Office_Front-A9.png",1024,348.51562745585017],"Office_Front-B9":["/res/panelsoil/zenith/4x/Office_Front-B9.png",1024,349.3953160843822],"Office_Front-C9":["/res/panelsoil/zenith/4x/Office_Front-C9.png",1024,353.9874047255011],"Office_Front-D9":["/res/panelsoil/zenith/4x/Office_Front-D9.png",1024,362.5120887651884],"Office_Front-A11":["/res/panelsoil/zenith/4x/Office_Front-A11.png",1024,375.2074615428206],"Office_Front-B11":["/res/panelsoil/zenith/4x/Office_Front-B11.png",1024,379.23496488209815],"Office_Front-C11":["/res/panelsoil/zenith/4x/Office_Front-C11.png",1024,381.0775718590584],"Office_Front-D11":["/res/panelsoil/zenith/4x/Office_Front-D11.png",1024,379.2843654603203],"Office_Front-A12":["/res/panelsoil/zenith/4x/Office_Front-A12.png",1024,390.1857835984767],"Office_Front-B12":["/res/panelsoil/zenith/4x/Office_Front-B12.png",1024,384.72461350957013],"Office_Front-C12":["/res/panelsoil/zenith/4x/Office_Front-C12.png",1024,387.63081833322445],"Office_Front-D12":["/res/panelsoil/zenith/4x/Office_Front-D12.png",1024,401.18419657096047],"Office_Front-A13":["/res/panelsoil/zenith/4x/Office_Front-A13.png",1024,395.51537334215345],"Office_Front-B13":["/res/panelsoil/zenith/4x/Office_Front-B13.png",1024,408.7555588177363],"Office_Front-C13":["/res/panelsoil/zenith/4x/Office_Front-C13.png",1024,412.1412429016463],"Office_Front-D13":["/res/panelsoil/zenith/4x/Office_Front-D13.png",1024,405.1094668179555],"Office_Front-A14":["/res/panelsoil/zenith/4x/Office_Front-A14.png",1024,410.4859821892107],"Office_Front-C14":["/res/panelsoil/zenith/4x/Office_Front-C14.png",1024,416.07286068194236],"Office_Front-D14":["/res/panelsoil/zenith/4x/Office_Front-D14.png",1024,421.3784343226554],"Office_Front-A15":["/res/panelsoil/zenith/4x/Office_Front-A15.png",1024,419.52777832678606],"Office_Front-B15":["/res/panelsoil/zenith/4x/Office_Front-B15.png",1024,431.23647089524724],"Office_Front-C15":["/res/panelsoil/zenith/4x/Office_Front-C15.png",1024,425.0750030499545],"Office_Front-D15":["/res/panelsoil/zenith/4x/Office_Front-D15.png",1024,437.23318579562454],"Office_Front-A16":["/res/panelsoil/zenith/4x/Office_Front-A16.png",1024,442.674774414513],"Office_Front-B16":["/res/panelsoil/zenith/4x/Office_Front-B16.png",1024,439.3813657920979],"Office_Front-C16":["/res/panelsoil/zenith/4x/Office_Front-C16.png",1024,449.0179201856829],"Office_Front-D16":["/res/panelsoil/zenith/4x/Office_Front-D16.png",1024,447.3636910750134],"Platform_Back-A1":["/res/panelsoil/zenith/4x/Platform_Back-A1.png",1024,1244.252511290509],"Platform_Back-B1":["/res/panelsoil/zenith/4x/Platform_Back-B1.png",1024,1251.404599756461],"Platform_Back-C1":["/res/panelsoil/zenith/4x/Platform_Back-C1.png",1024,1252.678979003827],"Platform_Back-D1":["/res/panelsoil/zenith/4x/Platform_Back-D1.png",1024,1257.4289771858444],"Platform_Back-A2":["/res/panelsoil/zenith/4x/Platform_Back-A2.png",1024,1257.442372237436],"Platform_Back-B2":["/res/panelsoil/zenith/4x/Platform_Back-B2.png",1024,1269.1017143864333],"Platform_Back-C2":["/res/panelsoil/zenith/4x/Platform_Back-C2.png",1024,1270.2384937620786],"Platform_Back-D2":["/res/panelsoil/zenith/4x/Platform_Back-D2.png",1024,1271.731016250969],"Platform_Back-A3":["/res/panelsoil/zenith/4x/Platform_Back-A3.png",1024,1276.050569809435],"Platform_Back-B3":["/res/panelsoil/zenith/4x/Platform_Back-B3.png",1024,1275.836321302127],"Platform_Back-C3":["/res/panelsoil/zenith/4x/Platform_Back-C3.png",1024,1282.4138124673796],"Platform_Back-D3":["/res/panelsoil/zenith/4x/Platform_Back-D3.png",1024,1279.077917089703],"Platform_Back-A4":["/res/panelsoil/zenith/4x/Platform_Back-A4.png",1024,1284.4758417821436],"Platform_Back-B4":["/res/panelsoil/zenith/4x/Platform_Back-B4.png",1024,1287.69766998941],"Platform_Back-C4":["/res/panelsoil/zenith/4x/Platform_Back-C4.png",1024,1296.7539351177415],"Platform_Back-D4":["/res/panelsoil/zenith/4x/Platform_Back-D4.png",1024,1290.774257449264],"Platform_Front-A1":["/res/panelsoil/zenith/4x/Platform_Front-A1.png",1024,1255.4966986510394],"Platform_Front-B1":["/res/panelsoil/zenith/4x/Platform_Front-B1.png",1024,1257.021389381042],"Platform_Front-C1":["/res/panelsoil/zenith/4x/Platform_Front-C1.png",1024,1251.2039142193573],"Platform_Front-D1":["/res/panelsoil/zenith/4x/Platform_Front-D1.png",1024,1260.662126990601],"Platform_Front-A2":["/res/panelsoil/zenith/4x/Platform_Front-A2.png",1024,1266.3039539888891],"Platform_Front-B2":["/res/panelsoil/zenith/4x/Platform_Front-B2.png",1024,1267.9341345614664],"Platform_Front-C2":["/res/panelsoil/zenith/4x/Platform_Front-C2.png",1024,1268.8448144318506],"Platform_Front-D2":["/res/panelsoil/zenith/4x/Platform_Front-D2.png",1024,1274.0304939601504],"Platform_Front-A3":["/res/panelsoil/zenith/4x/Platform_Front-A3.png",1024,1273.423739443437],"Platform_Front-B3":["/res/panelsoil/zenith/4x/Platform_Front-B3.png",1024,1282.8915001012642],"Platform_Front-C3":["/res/panelsoil/zenith/4x/Platform_Front-C3.png",1024,1284.017764069875],"Platform_Front-D3":["/res/panelsoil/zenith/4x/Platform_Front-D3.png",1024,1290.5261064226709],"Platform_Front-A4":["/res/panelsoil/zenith/4x/Platform_Front-A4.png",1024,1288.503171234997],"Platform_Front-B4":["/res/panelsoil/zenith/4x/Platform_Front-B4.png",1024,1288.6966022776407],"Platform_Front-C4":["/res/panelsoil/zenith/4x/Platform_Front-C4.png",1024,1290.403842876236],"Platform_Front-D4":["/res/panelsoil/zenith/4x/Platform_Front-D4.png",1024,1294.7102698516458]}},ya=81.92,va={width:4096,margins:{top:2816,btm:512},layers:{Hall_1A:{x:0,y:0,at:0,s:50,h:4096,masks:{top:{y:4096,at:0,s:ya},btm:{y:0,at:0,s:ya}},panels:xa.Hall_1A},Hall_Front:{x:0,y:0,at:0,s:ya,h:4096,panels:xa.Hall_Front},Hotel_Back1:{x:0,y:0,at:50,s:20,h:3816,masks:{top:{y:8192,at:50,s:ya},btm:{y:0,at:50,s:ya}},panels:xa.Hotel_Back1},Hotel_Back2:{x:0,y:630,at:50,s:30,h:3816,masks:{top:{y:8192,at:50,s:ya},btm:{y:0,at:50,s:ya}},panels:xa.Hotel_Back2},Hotel_A1:{x:0,y:-70,at:50,s:50,h:4733,masks:{top:{y:5575,at:50,s:ya},btm:{y:0,at:50,s:ya}},panels:xa.Hotel_A1},Hotel_B1:{x:0,y:0,at:119.287,s:50,h:3377,masks:{top:{y:2e3,at:119.287,s:ya},btm:{y:0,at:119.287,s:ya}},panels:xa.Hotel_B1},Hotel_Front:{x:0,y:0,at:50,s:ya,h:8192,panels:xa.Hotel_Front},Casino_A1:{x:673,y:-50,at:150,s:50,h:6699,masks:{top:{y:8688,at:150,s:ya},btm:{y:0,at:150,s:ya}},panels:xa.Casino_A1},Casino_A1b:{x:0,y:-450,at:150,s:65,h:5809,masks:{top:{y:8688,at:150,s:ya},btm:{y:0,at:150,s:ya}},panels:xa.Casino_A1b},Casino_A1b2:{x:0,y:4650,at:150,s:65,h:5809,masks:{top:{y:8688,at:150,s:ya},btm:{y:0,at:150,s:ya}},panels:xa.Casino_A1b},Casino_B1:{x:0,y:-650,at:267.651,s:35,h:3434,masks:{top:{y:2450,at:267.651,s:ya},btm:{y:0,at:267.651,s:ya}},panels:xa.Casino_B1},Casino_B2:{x:0,y:0,at:267.651,s:50,h:2796,masks:{top:{y:2450,at:267.651,s:ya},btm:{y:0,at:267.651,s:ya}},panels:xa.Casino_B2},Casino_Front:{x:0,y:0,at:150,s:ya,h:12288,panels:xa.Casino_Front},Arena_A1:{x:0,y:0,at:300,s:50,h:4212,masks:{top:{y:4560,at:300,s:ya},btm:{y:0,at:300,s:ya}},panels:xa.Arena_A1},Arena_B1:{x:0,y:-900,at:355.298,s:19,h:4885,masks:{top:{y:7070,at:355.298,s:ya},btm:{y:0,at:355.298,s:ya}},panels:xa.Arena_B1},Arena_B2:{x:0,y:-900,at:355.298,s:20,h:5324,masks:{top:{y:6e3,at:355.298,s:ya},btm:{y:0,at:355.298,s:ya}},panels:xa.Arena_B2},Arena_B3:{x:0,y:100,at:367.505,s:55,h:4167,masks:{top:{y:5e3,at:367.505,s:ya},btm:{y:0,at:367.505,s:ya}},panels:xa.Arena_B3},Arena_C1:{x:0,y:200,at:429.395,s:50,h:1545,masks:{top:{y:1e3,at:429.395,s:ya},btm:{y:0,at:429.395,s:ya}},panels:xa.Arena_C1},Arena_Front:{x:0,y:0,at:300,s:ya,h:12288,panels:xa.Arena_Front},Museum_A1:{x:0,y:100,at:450,s:50,h:4890,masks:{top:{y:5900,at:450,s:ya},btm:{y:0,at:450,s:ya}},panels:xa.Museum_A1},Museum_B1:{x:0,y:-880,at:520.825,s:70,h:4167,masks:{top:{y:2210,at:520.825,s:ya},btm:{y:0,at:520.825,s:ya}},panels:xa.Museum_B1},Museum_A1R:{x:0,y:-1500,at:547.803,s:50,h:4890,masks:{top:{y:3540,at:547.803,s:ya},btm:{y:0,at:547.803,s:ya}},panels:xa.Museum_A1},Museum_C1:{x:0,y:-780,at:591.138,s:20,h:5654,masks:{top:{y:3150,at:591.138,s:ya},btm:{y:0,at:591.138,s:ya}},panels:xa.Museum_C1},Museum_C2:{x:0,y:-1150,at:591.138,s:50,h:5996,masks:{top:{y:3150,at:591.138,s:ya},btm:{y:0,at:591.138,s:ya}},panels:xa.Museum_C2},Museum_Front:{x:0,y:0,at:450,s:ya,h:16384,panels:xa.Museum_Front},Office_A1:{x:0,y:-880,at:656.592,s:50,h:6680,masks:{top:{y:8100,at:656.592,s:ya},btm:{y:0,at:650,s:ya}},panels:xa.Office_A1},Office_B1:{x:0,y:-340,at:755.322,s:20,h:3483,masks:{top:{y:2500,at:755.322,s:ya},btm:{y:0,at:755.322,s:ya}},panels:xa.Office_B1},Office_B2:{x:0,y:-350,at:755.322,s:50,h:3209,masks:{top:{y:2500,at:755.322,s:ya},btm:{y:0,at:755.322,s:ya}},panels:xa.Office_B2},Office_A1R:{x:0,y:-1500,at:783.689,s:50,h:6680,masks:{top:{y:5540,at:783.689,s:ya},btm:{y:0,at:783.689,s:ya}},panels:xa.Office_A1},Office_Front:{x:0,y:0,at:650,s:ya,h:16384,panels:xa.Office_Front},Lab_A1:{x:0,y:-1550,at:878.613,s:32,h:6279,masks:{top:{y:8400,at:878.613,s:ya},btm:{y:0,at:878.613,s:ya}},panels:xa.Lab_A1},Lab_A2:{x:0,y:330,at:878.613,s:50,h:7902,masks:{top:{y:8400,at:878.613,s:ya},btm:{y:0,at:878.613,s:ya}},panels:xa.Lab_A2},Lab_B1:{x:0,y:0,at:984.814,s:50,h:5233,masks:{top:{y:4e3,at:984.814,s:ya},btm:{y:0,at:984.814,s:ya}},panels:xa.Lab_B1},Lab_C1:{x:0,y:-400,at:1036.084,s:50,h:5356,masks:{top:{y:5050,at:1036.084,s:ya},btm:{y:0,at:1036.084,s:ya}},panels:xa.Lab_C1},Lab_Front:{x:0,y:0,at:850,s:ya,h:20480,panels:xa.Lab_Front},Core_A1:{x:0,y:0,at:1117.627,s:50,h:7536,masks:{top:{y:7250,at:1117.627,s:ya},btm:{y:0,at:1117.627,s:ya}},panels:xa.Core_A1},Core_B1:{x:0,y:-840,at:1207.349,s:20,h:5163,masks:{top:{y:6700,at:1207.349,s:ya},btm:{y:0,at:1207.349,s:ya}},panels:xa.Core_B1},Core_B2:{x:0,y:-470,at:1240.063,s:50,h:3277,masks:{top:{y:2100,at:1240.063,s:ya},btm:{y:300,at:1240.063,s:ya}},panels:xa.Core_B2},Core_A1R:{x:0,y:-430,at:1287.305,s:50,h:7536,masks:{top:{y:3400,at:1287.305,s:ya},btm:{y:0,at:1287.305,s:ya}},panels:xa.Core_A1},Core_C1:{x:0,y:0,at:1330.273,s:40,h:1897,masks:{top:{y:1500,at:1330.273,s:ya},btm:{y:0,at:1330.273,s:ya}},panels:xa.Core_C1},Core_Front:{x:0,y:0,at:1100,s:ya,h:20480,panels:xa.Core_Front},Corruption_A1:{x:0,y:-50,at:1357.129,s:50,h:5774,masks:{top:{y:4650,at:1357.129,s:ya},btm:{y:0,at:1357.129,s:ya}},panels:xa.Corruption_A1},Corruption_B1:{x:0,y:-1750,at:1424.268,s:20,h:4679,masks:{top:{y:2750,at:1424.268,s:ya},btm:{y:-350,at:1424.268,s:ya}},panels:xa.Corruption_B1},Corruption_B2:{x:0,y:-1500,at:1424.268,s:50,h:4353,masks:{top:{y:2750,at:1424.268,s:ya},btm:{y:-350,at:1424.268,s:ya}},panels:xa.Corruption_B2},Corruption_C1:{x:0,y:-1050,at:1470.654,s:40,h:5253,masks:{top:{y:5100,at:1470.654,s:ya},btm:{y:0,at:1470.654,s:ya}},panels:xa.Corruption_C1},Corruption_C2:{x:0,y:-270,at:1470.654,s:50,h:4680,masks:{top:{y:5100,at:1470.654,s:ya},btm:{y:0,at:1470.654,s:ya}},panels:xa.Corruption_C2},Corruption_B1R:{x:0,y:-2100,at:1543.559,s:20,h:4679,masks:{top:{y:3300,at:1543.559,s:ya},btm:{y:0,at:1543.559,s:ya}},panels:xa.Corruption_B1},Corruption_B2R:{x:0,y:-1700,at:1543.559,s:50,h:4353,masks:{top:{y:3300,at:1543.559,s:ya},btm:{y:0,at:1543.559,s:ya}},panels:xa.Corruption_B2},Corruption_D1:{x:0,y:-530,at:1584.082,s:20,h:5650,masks:{top:{y:5400,at:1584.082,s:ya},btm:{y:0,at:1584.082,s:ya}},panels:xa.Corruption_D1},Corruption_D2:{x:0,y:-550,at:1584.082,s:50,h:5527,masks:{top:{y:5400,at:1584.082,s:ya},btm:{y:0,at:1584.082,s:ya}},panels:xa.Corruption_D2},Corruption_Front:{x:0,y:0,at:1350,s:ya,h:24576,panels:xa.Corruption_Front},Platform_Back:{x:0,y:0,at:1650,s:50,h:4096,masks:{btm:{y:0,at:1650,s:ya}},panels:xa.Platform_Back},Platform_Front:{x:0,y:0,at:1650,s:ya,h:4096,panels:xa.Platform_Front}}};class Ba{activeGames=new Map;inactiveGames=new Map;primary=null;multiplex=null;constructor({active:e,inactive:t,primary:n},s){for(const t of e)this.activeGames.set(t,{});for(const e of t)this.inactiveGames.set(e,{});this.primary=n,this.multiplex=s}AddGame(e,t){}RemoveGame(e){}SetPrimary(e){this.primary=e}Refresh(e){}Animate(e){}Deconstruct(){return this.Stop(),{active:[...this.activeGames.keys()],inactive:[...this.inactiveGames.keys()],primary:this.primary}}GameShouldBeActive(e){return!0}GameExtraOptions(e){return null}Stop(){}get size(){return this.activeGames.size+this.inactiveGames.size}get assistGames(){return[]}}Ba.BasicFFA=class extends Ba{constructor({},e){super(...arguments);for(const[e]of this.inactiveGames)e.rehead(!0),this.inactiveGames.delete(e),this.activeGames.set(e,{});this.Refresh(!1),xt("grid_spectate").textContent="grid"}AddGame(e,t){t||e.rehead(!0),this.activeGames.set(e,{})}RemoveGame(e){this.activeGames.delete(e)}Refresh(e){if(0===this.activeGames.size)return xt("data_spectate").innerHTML="waiting for players to join",!1;if(1===this.activeGames.size){const[[t]]=this.activeGames;return t.location(0,0,1,e),t.changeDisplayMode("full"),xt("data_spectate").innerHTML=`spectating <span>${t.getOwner().toUpperCase()}</span>`,!1}if(2===this.activeGames.size&&it.video.sidebyside){let[[t],[n]]=this.activeGames;n===this.primary&&([n,t]=[t,n]),t.location(-.4,0,1,e),t.changeDisplayMode("full"),n.location(.4,0,1,e),n.changeDisplayMode("full"),xt("data_spectate").innerHTML=`spectating <span>${t.getOwner().toUpperCase()}</span> VS <span>${n.getOwner().toUpperCase()}</span>`}else this.primary?(this._Many(e),xt("data_spectate").innerHTML=`spectating <span>${this.primary.getOwner().toUpperCase()}</span>`):(this._Grid(e),xt("data_spectate").innerHTML=`spectating <span>${this.activeGames.size}</span> PLAYERS`);return!0}_Many(e){const t=this.activeGames.size-1,n=this._FitBesidesPlayer(t);for(const[s]of this.activeGames){if(s===this.primary){s.location(0,0,1,e),s.changeDisplayMode("full");continue}const{x:i,y:o,s:a}=n.shift();s.location(i,o,a,e);let r="small";(t>=4||it.video.alwaystiny||"minimal"===it.video.graphics)&&(r="tiny"),s.changeDisplayMode(r)}}_Grid(e){const t=this._FitFullScreen(this.activeGames.size);for(const[n]of this.activeGames){const{x:s,y:i,s:o}=t.shift();n.location(s,i,o,e);let a="small";(this.activeGames.size>=9||it.video.alwaystiny||"minimal"===it.video.graphics)&&(a="tiny"),n.changeDisplayMode(a)}}_FitBesidesPlayer(e){const t=e>=30,n=e>=9||it.video.alwaystiny||"minimal"===it.video.graphics?La.HOLDERWIDTHTINY:La.HOLDERWIDTH;e=Math.max(2,e);let s=0,i=1,o=0,a=0,r=!1;do{s++,i=.75/s,o=t?2*Math.ceil(e/s/2):Math.ceil(e/s),a=i*n*o,a<=(t?1.2:.6)&&(r=!0)}while(!r);const l=[];for(let a=0;a<e;a++){const e=Math.floor(a/s),r=a%s;l.push(t?{x:(.5+i*n/2+e%(o/2)*n*i)*(e<o/2?1:-1),y:r*La.HOLDERHEIGHT*i*1.6-.8,s:i}:{x:.4+i*n/2+e*n*i,y:r*La.HOLDERHEIGHT*i-.5,s:i})}return l}_FitFullScreen(e){const t=e>=9||it.video.alwaystiny||"minimal"===it.video.graphics?La.HOLDERWIDTHTINY:La.HOLDERWIDTH;e=Math.max(2,e);let n=1,s=1,i=1,o=0,a=0,r=!1;do{n++,i=2/((e<=8?1:t)*n),s=Math.ceil(e/n),a=i*t*n,o=i*La.HOLDERHEIGHT*s,o<=1.6&&(r=!0)}while(!r);const l=Math.floor(1.8/(t*i));n=Math.round((l+n)/2),i=2/((e<=8?1:t)*n),r=!1;do{i-=.005,s=Math.ceil(e/n),a=i*t*n,o=i*La.HOLDERHEIGHT*s,o<=1.6&&a<=1.8&&(r=!0)}while(!r);const c=[];for(let r=0;r<e;r++){const l=r%n,p=Math.floor(r/n);let d=(1.8-a)/2;Math.floor(r/n)===Math.floor(e/n)&&(d=(1.8-i*t*(e%n))/2),c.push({x:-.9+d+i*t/2+l*t*i,y:1===s?0:(1.6-o)/2-.8+(p+.5)*La.HOLDERHEIGHT*i,s:i})}return c}},Ba.SuperLobby=class extends Ba{_currentSpeed=1;_leftBound=-1;_rightBound=1;_widthRate=1;_tickerActive=!1;_listener=this._Tick.bind(this);constructor({},e){super(...arguments),this.size&&this._Start(),xt("grid_spectate").textContent="grid"}AddGame(e,t){t?this.activeGames.set(e,{x:0,y:0,r:0}):this.inactiveGames.set(e,{})}RemoveGame(e){const t=this.activeGames.has(e)&&this.primary!==e,n=this.activeGames.get(e);this.activeGames.delete(e),this.inactiveGames.delete(e),this.size<=60?this.multiplex.SetPresentation(Ba.BasicFFA):t&&this._ReplaceGame(n)}SetPrimary(e){const t=this.primary,n=t&&!this.activeGames.has(t);if(super.SetPrimary(e),t===e)return;let s=!1;if(e&&(s=this.activeGames.has(e),s?(e.location(0,0,1,!1),e.changeDisplayMode("full")):(e.rehead(),e.changeDisplayMode("full"),e.location(0,0,.5,!0),e.location(0,0,1,!1),this.activeGames.set(e,{}),this.inactiveGames.delete(e))),s){const s=this.activeGames.get(e);t&&!n?(this.activeGames.set(t,s),s.t=performance.now()+300,t.location(s.x,s.y,.2,!1),t.changeDisplayMode("tiny")):this._ReplaceGame(s)}else t&&!n&&(t.fadeOutAndBehead(300),this.activeGames.delete(t),this.inactiveGames.set(t,{}))}_ReplaceGame(e){const t=this.inactiveGames.keys().next().value;t&&(t.rehead(!0),t.location(e.x,e.y,.2,!0),t.changeDisplayMode("tiny"),this.activeGames.set(t,e),this.inactiveGames.delete(t))}Animate(e){if("start"===e)this._Start(),Vl("superlobby",this.size)}GameShouldBeActive(e){return this.activeGames.size<=61}GameExtraOptions(e){return{zoominto:"fade",prestart:850}}Refresh(e){return xt("data_spectate").innerHTML=this.primary?`spectating <span>${this.primary.getOwner().toUpperCase()}</span>`:`spectating <span>${this.size}</span> PLAYERS`,!0}_Start(){this._currentSpeed=40;const e=this.primary?61:60;if(this.activeGames.size<e)for(const[t,n]of this.inactiveGames){if(this.activeGames.size>=e)break;t.rehead(),t.changeDisplayMode("tiny"),this.inactiveGames.delete(t),this.activeGames.set(t,n)}if(this.activeGames.size>e)for(const[t,n]of this.activeGames){if(this.activeGames.size<=e)break;t.behead(),this.activeGames.delete(t),this.inactiveGames.set(t,n)}const t=(window.innerWidth-As(1600))/As(1600);this._widthRate=1+2*t,this._leftBound=-1-2*t,this._rightBound=1+2*t;let n=0;for(const[e,t]of this.activeGames){if(this.primary===e){e.location(0,0,1,!0),e.changeDisplayMode("full");continue}const s=Math.floor(n/12)-2,i=n%12,o=(s+2)/4,a=s*(1/2.75)+Math.sin(Math.abs(.5*Math.PI*1))*(s/20);let r=0;r=s%2==0?this._rightBound+(i+o)*(1/6)*this._widthRate:this._leftBound-(i+o)*(1/6)*this._widthRate,e.location(r,a,.2,!0),t.x=r,t.y=a,t.r=s,n++}this._tickerActive||(this._tickerActive=!0,a.Ticker.shared.add(this._listener))}_Tick(e){const t=performance.now();"minimal"===it.video.graphics||it.video.nosuperlobbyanim?this._currentSpeed>0&&(this._currentSpeed<=1e-4&&(this._currentSpeed=0),this._currentSpeed=this._currentSpeed*Math.pow(this._currentSpeed>=30?.995:.985,e)):this._currentSpeed>1&&(this._currentSpeed<=1.0001&&(this._currentSpeed=1),this._currentSpeed=1+(this._currentSpeed-1)*Math.pow(this._currentSpeed>=30?.998:.993,e));for(const[n,s]of this.activeGames)if(this.primary!==n)if(s.r%2==0?s.x-=this._currentSpeed*e*75e-5:s.x+=this._currentSpeed*e*75e-5,s.r%2==0&&s.x<=this._leftBound||s.r%2!=0&&s.x>=this._rightBound){n.behead(),this.activeGames.delete(n),this.inactiveGames.set(n,s);const e=this.inactiveGames.keys().next().value;if(!e)continue;e.rehead();const t={};t.x=s.r%2==0?s.x+2*this._widthRate:s.x-2*this._widthRate,t.y=s.r*(1/2.75)+Math.sin(Math.abs(.5*Math.PI*Math.pow(t.x/this._widthRate,2)))*(s.r/20),t.r=s.r,e.location(t.x,t.y,.2,!0),e.changeDisplayMode("tiny"),this.activeGames.set(e,t),this.inactiveGames.delete(e)}else s.y=s.r*(1/2.75)+Math.sin(Math.abs(.5*Math.PI*Math.pow(s.x/this._widthRate,2)))*(s.r/20),n.location(s.x,s.y,.2,t>=(s.t??0))}Stop(){this._tickerActive&&(this._tickerActive=!1,a.Ticker.shared.remove(this._listener))}},Ba.Zenith=class extends Ba{_range=30;_tickerActive=!1;_listener=this._Tick.bind(this);_ourPos=10;_ourPosCurrent=10;_scrollAway=0;_maxSmall=it.video.alwaystiny?0:{minimal:0,low:0,medium:8,high:12,ultra:20}[it.video.graphics];_maxTiny={minimal:0,low:30,medium:60,high:60,ultra:90}[it.video.graphics];_maxStar={minimal:0,low:100,medium:300,high:300,ultra:300}[it.video.graphics];_rangeMinPlayers={minimal:0,low:30,medium:60,high:60,ultra:60}[it.video.graphics];_rangeMaxPlayers={minimal:0,low:100,medium:300,high:400,ultra:600}[it.video.graphics];_tickCurrent=0;_tickModulo=100;_safeZone=1;_sideCarGame=null;_sideCarGameLock=!1;_following=null;_panelSoil={container:null,stars:null,stars_mask:null,moon:null,bgcolor:null,bgfade:null,root:null,fadeTop:null,fadeBottom:null,deadTop:null,deadBottom:null,loader:null,flash:null,darkover:null,w:-1,h:-1,skipping:!1,skipFullSince:1/0,reachedGodhoodAt:null};_ruler=null;_rulerMarkerPb=null;_mappedScoreboard=new Map;constructor({},e){super(...arguments),this.size&&this._Start(),xt("grid_spectate").textContent="free"}AddGame(e,t){const n={x:2*Math.random()-1,y:0,ty:0,z:0,spr:null,t:0,im:100*Math.random(),d:0};if(e.getDuoOptions().enabled){const t=e.getDuoOptions().ally.username;for(const[e,s]of this.activeGames)e.getOwner()===t&&(s.d=-1,n.d=1,n.r=s,n.x=s.x);for(const[e,s]of this.inactiveGames)e.getOwner()===t&&(s.d=-1,n.d=1,n.r=s,n.x=s.x)}if(e.getOwner().includes(" "))n.im-=500;else{const t=vr(e.getOwner())??(e.getDuoOptions().ally.username?yr(e.getDuoOptions().ally.username):null);t&&"friend"===t.type&&(n.im+=100)}t?this.activeGames.set(e,n):this.inactiveGames.set(e,n),e.getOwner()===this._following&&(this.multiplex.SetSpectate(e.id),this.Refresh())}RemoveGame(e){e===this.primary&&this._sideCarGame&&(this._sideCarGameLock=!0),e===this._sideCarGame&&(this._sideCarGame=null,this._sideCarGameLock=!1);const t=this.inactiveGames.get(e)?.spr;t&&El.animate(t,{0:{y:"inherit",rotation:0},1:{y:As(800)+window.innerHeight,rotation:.3*Math.sign(Math.random()-.5)}},1,s(.37,.06,.75,.56),(()=>{t.destroy()})),this.activeGames.delete(e),this.inactiveGames.delete(e)}SetPrimary(e){super.SetPrimary(e),this._sideCarGameLock||(this._sideCarGame=null);const t=this.activeGames.get(e)??this.inactiveGames.get(e);t&&(t.im+=100,t.r&&(t.r.im+=100))}Animate(e){if("start"===e)this._Start()}GameShouldBeActive(e){return!1}GameExtraOptions(e){return{zoominto:"fade",prestart:850}}get assistGames(){return this._sideCarGame?[this._sideCarGame]:[]}Refresh(e){return this.primary?(this.primary.getDuoOptions().enabled?xt("data_spectate").innerHTML=`spectating <span>${this.primary.getOwner().toUpperCase()} & ${this.primary.getDuoOptions().ally.username.toUpperCase()}</span>`:xt("data_spectate").innerHTML=`spectating <span>${this.primary.getOwner().toUpperCase()}</span>`,xt("zenithmenu").classList.contains("rolledup")||(xt("zenithmenu").classList.add("rolledup"),ii.disengage(),yt("#zenithmenu .menuslide_rollup").forEach((e=>e.textContent="PLAY")),xt("zenithmenu").scrollTop=0,Si(!1)),xt("zenithmenu").classList.toggle("hidden",document.body.classList.contains("ingame_phys"))):(xt("data_spectate").innerHTML=`spectating <span>${this.size}</span> PLAYERS`,xt("zenithmenu").classList.remove("hidden")),this.primary&&this.primary===this.multiplex.games.self&&(this._following=null),!this.multiplex.Find(this._following)||this.primary&&this.primary.getOwner()===this._following||(this._following=null),xt("follow_spectate").classList.toggle("active",!!this._following),this._following?(xt("follow_spectate").classList.remove("unavailable"),this.primary&&this.primary.getOwner()===this._following?xt("following_spectate").innerHTML=`following <b>${this._following.toUpperCase()}</b>`:xt("following_spectate").innerHTML=`waiting for <b>${this._following.toUpperCase()}</b>`):xt("follow_spectate").classList.toggle("unavailable",!this.primary||this.primary===this.multiplex.games.self),!!this.primary||xt("zenithmenu").classList.contains("rolledup")}SetFollowing(e){this._following=e,this.Refresh()}CancelFollowing(e){this._following===e&&(this._following=e,this.Refresh())}FallbackPos(e,t){const n=this.inactiveGames.get(e)||this.activeGames.get(e);return n?{pos:{x:window.innerWidth+As(n.x*(1+.2*(1-n.z))*800),y:window.innerHeight+As(400*t)},scale:Math.max(0,Math.min(1,.05+.2*n.z)),isFallback:!0,isPresentationFallback:!0}:null}Scroll(e){if(this.primary){if(this._scrollAway-=.005*e,!(Math.abs(this._scrollAway)>1))return!0;this.multiplex.SetSpectate(null),this._scrollAway=0}return this._ourPos=Math.max(0,this._ourPos-.018*e),!0}_Start(){const e=(window.innerHeight-As(800))/As(800);if(this._safeZone=1+2*e,this._tickerActive||(this._tickerActive=!0,a.Ticker.shared.add(this._listener)),"minimal"!==it.video.graphics&&!0!==it.video.nozenithanim){this._panelSoil.container=new a.Container,ol.addChild(this._panelSoil.container),this._panelSoil.stars=a.TilingSprite.from("/res/panelsoil/stars.png",{width:window.innerWidth,height:window.innerHeight}),this._panelSoil.container.addChild(this._panelSoil.stars),this._panelSoil.stars_mask=a.TilingSprite.from("/res/panelsoil/stars_mask.png",{width:window.innerWidth,height:window.innerHeight}),this._panelSoil.stars_mask.tileScale.set(1.1421),this._panelSoil.container.addChild(this._panelSoil.stars_mask),this._panelSoil.moon=a.Sprite.from("/res/panelsoil/moon.png"),this._panelSoil.moon.anchor.set(.5,.5),this._panelSoil.moon.scale.set(As(.3)),this._panelSoil.container.addChild(this._panelSoil.moon),this._panelSoil.bgcolor=new a.Sprite(a.Texture.WHITE),this._panelSoil.bgcolor.tint=0,this._panelSoil.bgcolor.blendMode=a.BLEND_MODES.ADD,this._panelSoil.container.addChild(this._panelSoil.bgcolor),this._panelSoil.bgfade=a.Sprite.from("/res/panelsoil/gradient.png"),this._panelSoil.bgfade.tint=0,this._panelSoil.bgfade.blendMode=a.BLEND_MODES.ADD,this._panelSoil.container.addChild(this._panelSoil.bgfade);let e="1x";e=window.innerWidth>2048?{minimal:"hx",low:"1x",medium:"2x",high:"4x",ultra:"4x"}[it.video.graphics??"low"]:window.innerWidth>1400?{minimal:"hx",low:"hx",medium:"1x",high:"2x",ultra:"2x"}[it.video.graphics??"low"]:{minimal:"hx",low:"hx",medium:"1x",high:"1x",ultra:"2x"}[it.video.graphics??"low"],this._panelSoil.root=new b.Soil(va,Aa[e],0,e),this._panelSoil.container.addChild(this._panelSoil.root),this._panelSoil.fadeTop=a.Sprite.from("/res/panelsoil/edge.png"),this._panelSoil.fadeTop.tint=0,this._panelSoil.container.addChild(this._panelSoil.fadeTop),this._panelSoil.fadeBottom=a.Sprite.from("/res/panelsoil/edge.png"),this._panelSoil.fadeBottom.tint=0,this._panelSoil.container.addChild(this._panelSoil.fadeBottom),this._panelSoil.deadTop=new a.Sprite(a.Texture.WHITE),this._panelSoil.deadTop.tint=0,this._panelSoil.container.addChild(this._panelSoil.deadTop),this._panelSoil.deadBottom=new a.Sprite(a.Texture.WHITE),this._panelSoil.deadBottom.tint=0,this._panelSoil.container.addChild(this._panelSoil.deadBottom),this._panelSoil.loader=new a.Sprite(a.Texture.WHITE),this._panelSoil.loader.tint=0,this._panelSoil.container.addChild(this._panelSoil.loader),this._panelSoil.flash=new a.Sprite(a.Texture.WHITE),this._panelSoil.flash.tint=11184810,this._panelSoil.container.addChild(this._panelSoil.flash),this._panelSoil.darkover=new a.Sprite(a.Texture.WHITE),this._panelSoil.darkover.tint=0,this._panelSoil.darkover.alpha=Math.min(.8,Math.max(0,1-3.5*(it.video.background??.3))),this._panelSoil.container.addChild(this._panelSoil.darkover),il.visible=!1,this._ruler=a.TilingSprite.from("/res/ruler.png",{width:As(60),height:window.innerHeight}),this._ruler.tileScale.set(As(1)),this._ruler.zIndex=10,this._ruler.position.set(As(800)-As(30),-ms),this._ruler.alpha=.4,_l.addChild(this._ruler),this._rulerMarkerPb=a.Sprite.from("/res/rulerpb.png"),this._rulerMarkerPb.anchor.set(.5,.5),this._rulerMarkerPb.zIndex=11,this._rulerMarkerPb.position.set(As(800),-1e3),_l.addChild(this._rulerMarkerPb)}this._Refit(),Si(!0),xt("zenithmenu").classList.remove("rolledup","thidden","hidden"),xt("zenithmenu").classList.add("startanim"),setTimeout((()=>{xt("zenithmenu").classList.remove("startanim")}),1e3),yt("#zenithmenu .menuslide_rollup").forEach((e=>e.textContent="SPECTATE")),xt("zenithmenu").classList.remove("inresults"),xt("start_zenith_label").textContent="START",ii.bindGuide(oi.zenith||{}),xt("zenithmenu").scrollTop=0,na.ZenithStart()}_Refit(){if(this._panelSoil.root){const e=.5625*window.innerWidth,t=(window.innerHeight-e)/2,n=t>window.innerHeight/30;this._panelSoil.root.position.set(0,window.innerHeight-t),this._panelSoil.root.scale.set(window.innerWidth/4096),this._panelSoil.fadeTop.visible=n,this._panelSoil.fadeBottom.visible=n,this._panelSoil.deadTop.visible=n,this._panelSoil.deadBottom.visible=n,this._panelSoil.fadeTop.position.set(0,t-.025*window.innerWidth),this._panelSoil.fadeTop.scale.set(window.innerWidth/64,.125*window.innerWidth/64),this._panelSoil.fadeBottom.position.set(0,window.innerHeight-t+.025*window.innerWidth),this._panelSoil.fadeBottom.scale.set(window.innerWidth/64,-.125*window.innerWidth/64),this._panelSoil.deadTop.position.set(0,0),this._panelSoil.deadTop.scale.set(window.innerWidth/16,(t-.025*window.innerWidth)/16),this._panelSoil.deadBottom.position.set(0,window.innerHeight-t+.025*window.innerWidth),this._panelSoil.deadBottom.scale.set(window.innerWidth/16,(t-.025*window.innerWidth)/16),this._panelSoil.loader.scale.set(window.innerWidth/16,window.innerHeight/16),this._panelSoil.w=window.innerWidth,this._panelSoil.h=window.innerHeight,this._panelSoil.stars.width=window.innerWidth,this._panelSoil.stars.height=window.innerHeight,this._panelSoil.stars_mask.width=window.innerWidth,this._panelSoil.stars_mask.height=window.innerHeight,this._panelSoil.moon.position.x=window.innerWidth/2,this._panelSoil.bgcolor.scale.set(window.innerWidth/16,window.innerHeight/16),this._panelSoil.bgfade.scale.set(window.innerWidth/256,window.innerHeight/256),this._panelSoil.flash.scale.set(window.innerWidth/16,window.innerHeight/16),this._panelSoil.darkover.scale.set(window.innerWidth/16,window.innerHeight/16)}this._ruler&&(this._ruler.tileScale.set(As(1)),this._ruler.width=As(60),this._ruler.height=window.innerHeight,this._ruler.position.set(As(800)-As(30),-ms)),this._rulerMarkerPb&&(this._rulerMarkerPb.x=As(800)),"on"===this._speedrunMeta.state&&(this._speedrunMeta.container&&this._speedrunMeta.container.destroy(),this._CreateSpeedrunContainer())}SetScoreboard(e){this._mappedScoreboard.clear();for(const t of e)this._mappedScoreboard.set(t.username,t)}_speedrunMeta={laststate:"off",lastfloor:1,container:null,pattern_a:null,pattern_b:null,timer:null,splits:[],t:0};_TickSpeedrunMode(e){const t=this.multiplex.games.self?this.multiplex.games.self.getZenithSpeedrunState():{state:"off",splits:[0,0,0,0,0,0,0,0,0],time:0,floor:1,progress:0};if(t.state!==this._speedrunMeta.laststate)switch(this._speedrunMeta.laststate=t.state,this._speedrunMeta.lastfloor=t.floor,t.state){case"on":this._speedrunMeta.container&&this._speedrunMeta.container.destroy(),this._CreateSpeedrunContainer(),this._PlaySpeedrunStart(t);break;case"off":if(!this._speedrunMeta.container)break;this._PlaySpeedrunEnd(t);break;case"win":if(!this._speedrunMeta.container)break;this._TickSpeedrunModeUI(t,e),this._PlaySpeedrunWin(t)}return"on"===t.state&&this._TickSpeedrunModeUI(t,e),"on"===t.state}_CreateSpeedrunContainer(){if("minimal"!==it.video.graphics){this._speedrunMeta.container=new a.Container,this._speedrunMeta.container.scale.set(As(1)),this._speedrunMeta.container.zIndex=1e3,this._speedrunMeta.container.position.set(As(800),-ms),hl.addChild(this._speedrunMeta.container),this._speedrunMeta.pattern_a=a.TilingSprite.from("/res/speedrun-pattern.png",{width:ys(window.innerWidth),height:90}),this._speedrunMeta.pattern_a.tileScale.set(.5),this._speedrunMeta.pattern_a.position.set(ys(window.innerWidth/-2),0),this._speedrunMeta.pattern_a.alpha=.2,this._speedrunMeta.container.addChild(this._speedrunMeta.pattern_a),this._speedrunMeta.pattern_b=a.TilingSprite.from("/res/speedrun-pattern.png",{width:ys(window.innerWidth),height:90}),this._speedrunMeta.pattern_b.tileScale.set(.5),this._speedrunMeta.pattern_b.position.set(ys(window.innerWidth/-2),0),this._speedrunMeta.pattern_b.alpha=.2,this._speedrunMeta.container.addChild(this._speedrunMeta.pattern_b),this._speedrunMeta.timer=new g.Text("",{font:rl.get("hun"),fontSize:75,weight:500,tint:16777215,fillAlpha:.4,outlineTint:16777215,outlineWeight:900,outlineAlpha:.8,anchor:[.5,.5],useProjection:!0,projection:[[-.085,0],[1.2,0],[-.075,1],[1.125,1]]}),this._speedrunMeta.timer.position.set(0,60),this._speedrunMeta.container.addChild(this._speedrunMeta.timer),this._speedrunMeta.splits=[];for(let e=0;e<9;e++){const t={container:null,bg:null,outer:null,inner:null,topText:null,bottomText:null};this._speedrunMeta.splits[e]=t,t.container=new a.Container,t.container.position.set(110*(e-4),ys(window.innerHeight)-40),this._speedrunMeta.container.addChild(t.container),t.bg=new a.Sprite(a.Texture.WHITE),t.bg.tint=0,t.bg.alpha=.6,t.bg.position.set(-50,-25),t.bg.scale.set(6.25,3.125),t.container.addChild(t.bg),t.outer=new a.Sprite(a.Texture.WHITE),t.outer.tint=16777215,t.outer.position.set(-50,-25),t.outer.scale.set(0,3.125),t.container.addChild(t.outer),t.inner=new a.Sprite(a.Texture.WHITE),t.inner.tint=0,t.inner.alpha=.75,t.inner.position.set(-47,-22),t.inner.scale.set(5.875,2.75),t.container.addChild(t.inner),t.topText=new g.Text("",{font:rl.get("hun"),fontSize:25,weight:750,tint:16777215,anchor:[.5,.5]}),t.topText.position.set(0,-5),t.container.addChild(t.topText),t.bottomText=new g.Text("",{font:rl.get("hun"),fontSize:15,weight:700,tint:16760576,anchor:[.5,.5]}),t.bottomText.position.set(0,14),t.container.addChild(t.bottomText)}}}_PlaySpeedrunStart(e){if(na.PlaySe("zenith_speedrun_start"),this._speedrunMeta.container){this._speedrunMeta.timer.position.set(window.innerWidth,60),this._speedrunMeta.pattern_a.alpha=0,this._speedrunMeta.pattern_b.alpha=0,El.animate(this._speedrunMeta.pattern_a,{0:{alpha:0},1:{alpha:.2}},1,s(.21,.45,.81,1)),El.animate(this._speedrunMeta.pattern_b,{0:{alpha:0},1:{alpha:.2}},1,s(.21,.45,.81,1));for(let e=0;e<6;e++){const t=new g.Text("HYPERSPEED!!!",{font:rl.get("hun"),fontSize:90,weight:500,tint:16777215,fillAlpha:0,outlineTint:Zr(60*e,100,50),outlineWeight:900,outlineAlpha:.8,blendMode:a.BLEND_MODES.ADD,anchor:[.5,.5]});t.position.set(window.innerWidth,80),this._speedrunMeta.container.addChild(t),setTimeout((()=>{El.animate(t,{0:{"position.x":window.innerWidth},1:{"position.x":0}},.5,s(.21,.45,.73,.99))}),60*e),setTimeout((()=>{El.animate(t,{0:{"position.x":0},1:{"position.x":-window.innerWidth}},.5,s(.21,.45,.73,.99),(()=>{t.destroy()}))}),1e3+60*e)}for(let e=0;e<9;e++)this._speedrunMeta.splits[e].container.pivot.x=-window.innerWidth,setTimeout((()=>{El.animate(this._speedrunMeta.splits[e].container,{0:{"pivot.x":-window.innerWidth},1:{"pivot.x":0}},.5,s(.21,.45,.73,.99))}),400+60*e);setTimeout((()=>{El.animate(this._speedrunMeta.timer,{0:{"position.x":window.innerWidth},1:{"position.x":0}},.5,s(.21,.45,.73,.99))}),1250)}}_PlaySpeedrunEnd(e){if(na.PlaySe("zenith_speedrun_end"),!this._speedrunMeta.container)return;this.multiplex.games.self&&this.multiplex.games.self.setZenithRhythmBlast(0);const t={...this._speedrunMeta};this._speedrunMeta.container=null,this._speedrunMeta.pattern_a=null,this._speedrunMeta.pattern_b=null,this._speedrunMeta.timer=null,this._speedrunMeta.splits=[],t.timer.position.set(window.innerWidth,80),El.animate(t.timer,{0:{"scale.x":1,"scale.y":0},1:{"scale.x":1,"scale.y":0}},.5,s(.21,.45,.81,1)),El.animate(t.pattern_a,{0:{alpha:.2},1:{alpha:0}},.5,s(.21,.45,.81,1)),El.animate(t.pattern_b,{0:{alpha:.2},1:{alpha:0}},.5,s(.21,.45,.81,1));for(let e=0;e<9;e++)setTimeout((()=>{El.animate(t.splits[e].container,{0:{"pivot.y":0,rotation:0,alpha:1},1:{"pivot.y":-100,rotation:.2*Math.random()-.1,alpha:0}},.5,s(.21,.45,.73,.99))}),150*Math.random());setTimeout((()=>{t.container.destroy()}),1250)}_PlaySpeedrunWin(e){if(na.PlaySe("zenith_speedrun_end"),!this._speedrunMeta.container)return;this.multiplex.games.self&&this.multiplex.games.self.setZenithRhythmBlast(0);const t={...this._speedrunMeta};this._speedrunMeta.container=null,this._speedrunMeta.pattern_a=null,this._speedrunMeta.pattern_b=null,this._speedrunMeta.timer=null,this._speedrunMeta.splits=[],t.timer.tint=16777215,t.timer.outlineTint=16777215,t.timer.alpha=1,t.timer.fillAlpha=1,setTimeout((()=>{El.animate(t.timer,{0:{alpha:1},1:{alpha:0}},2.5,s(.21,.45,.81,1))}),3e3),El.animate(t.pattern_a,{0:{alpha:1},1:{alpha:0}},1,s(.21,.45,.81,1)),El.animate(t.pattern_b,{0:{alpha:1},1:{alpha:0}},.5,s(.21,.45,.81,1));for(let e=0;e<9;e++)setTimeout((()=>{El.animate(t.splits[e].container,{0:{"pivot.y":0,alpha:1},1:{"pivot.y":100,alpha:0}},1.5,s(.55,.02,.94,.67))}),4e3+150*Math.random());setTimeout((()=>{t.container.destroy()}),6500);const n=Rs.getZenithStats().speedrun.splits;let i=!1;(0===n.pb[8]||e.splits[8]<=n.pb[8])&&(n.pb=e.splits,i=!0);for(let t=0;t<9;t++)(0===n.gold[t]||e.splits[t]<=n.gold[8])&&(n.gold[t]=e.splits[t]);na.PlaySe(i?"zenith_split_cleared":"zenith_split_missed")}_TickSpeedrunModeUI(e,t){if(!this._speedrunMeta.container)return;Ur.play("zenith_speedrun",{dT:t});const n=na.ZenithGetTimingInfo()??{progressToNextBeat:0,currentBeatInBar:0,beatsPerBar:4},i=na.ZenithGetSpeedrunEvo(),o=n.currentBeatInBar%2==0?1-n.progressToNextBeat:0,a=i>=1?1-n.progressToNextBeat:0;this.multiplex.games.self&&this.multiplex.games.self.setZenithRhythmBlast(i>=2&&n.currentBeatInBar%2==0?1-n.progressToNextBeat:0),this._speedrunMeta.t+=t;const r=Bt(e.time);if(this._speedrunMeta.timer.text=`${r.m}:${r.s}\f4.${r.ms}`,this._speedrunMeta.timer.tint=Zr(.78*this._speedrunMeta.t,100,30+20*o),this._speedrunMeta.timer.outlineTint=Zr(.78*this._speedrunMeta.t+10,100,70+10*o),this._speedrunMeta.timer.fillAlpha=.4+.6*o,this._speedrunMeta.pattern_a.tilePosition.x+=t,this._speedrunMeta.pattern_b.tilePosition.x-=t,this._speedrunMeta.pattern_a.tint=Zr(.78*this._speedrunMeta.t,100,60-10*a),this._speedrunMeta.pattern_b.tint=Zr(.78*this._speedrunMeta.t+10,100,60-10*a),i>=1&&(this._speedrunMeta.pattern_a.alpha=.2+.1*o,this._speedrunMeta.pattern_b.alpha=.2+.1*a,n.currentBeatInBar<=1)){const t=e.time>=6e5?9:8;for(let e=0;e<t;e++){const t=Math.max(0,1-Math.abs(.5*(n.currentBeatInBar+n.progressToNextBeat)-(.2+.065*e))/.2);this._speedrunMeta.timer.overrides.get(e).y=-6*t}}const l=Rs.getZenithStats().speedrun.splits;for(let t=0;t<9;t++){const s=this._speedrunMeta.splits[t];s.outer.tint=Zr(1.5*this._speedrunMeta.t+34.7*t,100,70-10*a),s.inner.alpha=.75-.4*a;let o=0;if(i>=2){switch(n.currentBeatInBar){case 0:o=-1;break;case 1:o=Math.min(1,10*n.progressToNextBeat-1);break;case 2:o=1;break;case 3:o=Math.max(-1,1-10*n.progressToNextBeat)}s.container.y=ys(window.innerHeight)-40+4*o*(t%2==0?1:-1)}if(e.floor===t+1){if(l.pb[t]){const n=Bt(l.pb[t]),i=Bt(Math.abs(l.pb[t]-e.time));s.topText.text=`${n.m}:${n.s}\f4.${n.ms}`,s.topText.tint=16777215,s.topText.position.y=-5,s.bottomText.text=`${e.time<l.pb[t]?"-":"+"}${i.m>0?`${i.m}:${i.s}`:parseInt(i.s)}.${i.ms}`,s.bottomText.tint=8947848,s.bottomText.alpha=.4+.6*e.progress}else{const t=Bt(e.time);s.topText.text=`${t.m}:${t.s}\f4.${t.ms}`,s.topText.position.y=2,s.topText.tint=16777215,s.bottomText.alpha=0}s.outer.scale.x=6.25*e.progress}else if(e.floor<t+1){if(l.pb[t]){const e=Bt(l.pb[t]);s.topText.text=`${e.m}:${e.s}\f4.${e.ms}`,s.topText.tint=8947848}else s.topText.text=`floor ${t+1}`,s.topText.tint=3355443;s.topText.position.y=2,s.bottomText.alpha=0,s.outer.scale.x=0}else{const n=Bt(e.splits[t]);if(s.topText.text=`${n.m}:${n.s}\f4.${n.ms}`,s.topText.tint=13421772,l.pb[t]){const n=Bt(Math.abs(l.pb[t]-e.splits[t]));s.topText.position.y=-5,s.bottomText.text=`${e.splits[t]<l.pb[t]?"-":"+"}${n.m>0?`${n.m}:${n.s}`:parseInt(n.s)}.${n.ms}`;const i=e.splits[t]-(e.splits[t-1]??0)<=l.pb[t]-(l.pb[t-1]??0);s.bottomText.tint=e.splits[t]-(e.splits[t-1]??0)<=l.gold[t]-(l.gold[t-1]??0)?16758528:e.splits[t]<=l.pb[t]?i?8978176:7841338:i?16734354:16711769,s.bottomText.alpha=1}else s.topText.position.y=2,s.bottomText.alpha=0;s.outer.scale.x=6.25}}if(e.floor!==this._speedrunMeta.lastfloor){this._speedrunMeta.lastfloor=e.floor;let t=!0,n=16777215,i="";if(l.pb[e.floor-2]){t=e.splits[e.floor-2]<=l.pb[e.floor-2];const s=e.splits[e.floor-2]-(e.splits[e.floor-3]??0)<=l.pb[e.floor-2]-(l.pb[e.floor-3]??0);n=e.splits[e.floor-2]-(e.splits[e.floor-3]??0)<=l.gold[e.floor-2]-(l.gold[e.floor-3]??0)?16758528:t?s?8978176:7841338:s?16734354:16711769;const o=Bt(Math.abs(l.pb[e.floor-2]-e.splits[e.floor-2]));i=`${e.splits[e.floor-2]<l.pb[e.floor-2]?"-":"+"}${o.m>0?`${o.m}:${o.s}`:parseInt(o.s)}.${o.ms}`}else{const t=Bt(Math.abs(e.splits[e.floor-2]-(e.splits[e.floor-3]??0)));i=`${t.m>0?`${t.m}:${t.s}`:parseInt(t.s)}.${t.ms}`}na.PlaySe(t?"zenith_split_cleared":"zenith_split_missed"),this._speedrunMeta.timer.alpha=.1;const o=new g.Text(i,{font:rl.get("hun"),fontSize:90,weight:500,tint:n,fillAlpha:1,outlineTint:n,outlineWeight:900,outlineAlpha:.5,anchor:[.5,.5]});o.position.set(window.innerWidth,80),this._speedrunMeta.container.addChild(o),El.animate(o,{0:{"position.x":window.innerWidth},1:{"position.x":0}},.5,s(.21,.45,.73,.99)),setTimeout((()=>{El.animate(o,{0:{"position.x":0},1:{"position.x":-window.innerWidth}},.5,s(.21,.45,.73,.99),(()=>{o.destroy()})),El.animate(this._speedrunMeta.timer,{0:{alpha:.1},1:{alpha:1}},.5,s(.21,.45,.73,.99))}),2500)}}_Tick(e){this._mappedScoreboard.size||this.SetScoreboard(Oa.getCurrentMatch()?.rrb?.scoreboard??[]);const t=this._TickSpeedrunMode(e);if(this.primary?this.primary.isSynced()||this.primary.getOwner()===mn.username()?(this._ourPos=this.primary.getZenithAltitude(),na.ZenithSetHeight(this._ourPos),na.ZenithSetState(this.multiplex.games.self?ta.PLAYING:ta.SPECTATOR)):(this._ourPos=this._mappedScoreboard.get(this.primary.getOwner())?.stats.altitude||0,na.ZenithSetState(ta.SPECTATOR)):na.ZenithSetState(ta.MENUS),na.ZenithSetSpeedrun(t),this._ourPosCurrent=this._ourPos+(this._ourPosCurrent-this._ourPos)*Math.pow(.97,e),this._scrollAway*=Math.pow(.8,e),"minimal"!==it.video.graphics&&!0!==it.video.nozenithanim){this._ruler.tilePosition.y=150*this._ourPosCurrent,this._ourPosCurrent<1600?(this._panelSoil.stars.renderable=!1,this._panelSoil.stars_mask.renderable=!1,this._panelSoil.moon.renderable=!1,this._panelSoil.bgcolor.renderable=!1,this._panelSoil.bgfade.renderable=!1,this._panelSoil.flash.renderable=!1,this._panelSoil.reachedGodhoodAt=null):(this._panelSoil.stars.renderable=!0,this._panelSoil.stars_mask.renderable=!0,this._panelSoil.moon.renderable=!0,this._panelSoil.bgcolor.renderable=!0,this._panelSoil.bgfade.renderable=!0,this._panelSoil.flash.renderable=!0,this._panelSoil.stars.tilePosition.y=3*this._ourPosCurrent,this._panelSoil.stars_mask.tilePosition.x+=e/30,this._panelSoil.stars_mask.tilePosition.y+=e/30*1.827,this._panelSoil.moon.y=window.innerHeight/2+As(3)*(this._ourPosCurrent-2202.84),this._panelSoil.bgcolor.tint=me.GetAltitudeColor(this._ourPosCurrent,me.TINT_GRADIENT_BG_BACK).tint,this._panelSoil.bgfade.tint=me.GetAltitudeColor(this._ourPosCurrent,me.TINT_GRADIENT_BG_FRONT).tint,this._ourPosCurrent<1624?(this._panelSoil.flash.alpha=(this._ourPosCurrent-1600)/24,this._panelSoil.reachedGodhoodAt=null):this._ourPosCurrent<=1650?(this._panelSoil.flash.alpha=1,this._panelSoil.reachedGodhoodAt=null):(this._panelSoil.reachedGodhoodAt||(this._panelSoil.reachedGodhoodAt=performance.now()),this._panelSoil.flash.alpha=Math.max(0,1-(performance.now()-this._panelSoil.reachedGodhoodAt)/5e3)));const t=Rs.getRecords()[xt("zenithmenu").classList.contains("expert")?"zenithex":"zenith"]?.results.stats.zenith.altitude;this._rulerMarkerPb.y=-1===t?-1e3:As(400)+50*(this._ourPosCurrent-t);const n=this._ourPos-this._ourPosCurrent;this._panelSoil.skipping?(Math.abs(n)<15&&(this._panelSoil.skipping=!1,this._panelSoil.skipFullSince=1/0,this._panelSoil.root.y=this._ourPosCurrent),this._panelSoil.loader.alpha>=1?(this._panelSoil.root.y=this._ourPos-15*Math.sign(n),this._panelSoil.skipFullSince===1/0?this._panelSoil.skipFullSince=performance.now():this._ourPos<=25&&performance.now()-this._panelSoil.skipFullSince>=200&&(this._ourPosCurrent=this._ourPos+15)):(this._panelSoil.root.y+=1*Math.sign(n)*e,this._panelSoil.skipFullSince=1/0)):(this._panelSoil.skipFullSince=1/0,Math.abs(n)>=100?(this._panelSoil.skipping=!0,this._panelSoil.root.y+=1*Math.sign(n)*e):this._panelSoil.root.y=this._ourPosCurrent),this._panelSoil.loader.alpha=Math.max(0,Math.min(1,this._panelSoil.loader.alpha+(this._panelSoil.root._hasUnloadedTextures||this._panelSoil.skipping?.12:-.03)*e))}const n=[];for(const[,e]of this.activeGames)n.push(e);for(const[,e]of this.inactiveGames){const t=(this._ourPosCurrent-(e.r?.y??e.y))/this._range;t>=-this._safeZone&&t<=this._safeZone&&n.push(e)}n.sort(((e,t)=>t.im-e.im));const s=this.primary?this.primary.getDuoOptions():{enabled:!1,ally:{username:null}};for(const[t,i]of this.activeGames)this._TickGame(t,i,!0,this._ourPosCurrent,this._mappedScoreboard,n,s,e);let i=this._tickCurrent;for(const[t,o]of this.inactiveGames)(o.spr||i%this._tickModulo==0)&&this._TickGame(t,o,!1,this._ourPosCurrent,this._mappedScoreboard,n,s,e),i++;this._tickCurrent++,this._tickCurrent>this._tickModulo&&(this._tickCurrent=0),n.length<this._rangeMinPlayers&&this._range<5e3?this._range*=Math.pow(1.015,e):n.length>this._rangeMaxPlayers&&this._range>1&&(this._range/=Math.pow(1.015,e));if(this._range=Math.min(this._range,25+this._ourPosCurrent/1650*475),window.innerWidth===this._panelSoil.w&&window.innerHeight===this._panelSoil.h||this._Refit(),"minimal"!==it.video.graphics&&!0!==it.video.nozenithanim){const e=me.GetAltitudeColor(this._ourPosCurrent+6),t=me.GetAltitudeColor(this._ourPosCurrent),n=me.GetAltitudeColor(Math.max(0,this._ourPosCurrent-6)),s=Math.round(.3*e.r)<<16|Math.round(.3*e.g)<<8|Math.round(.3*e.b),i=Math.round(.3*t.r)<<16|Math.round(.3*t.g)<<8|Math.round(.3*t.b),o=Math.round(.3*n.r)<<16|Math.round(.3*n.g)<<8|Math.round(.3*n.b);this._panelSoil.fadeTop.tint=s,this._panelSoil.fadeBottom.tint=o,this._panelSoil.deadTop.tint=s,this._panelSoil.deadBottom.tint=o,this._panelSoil.loader.tint=i,this._panelSoil.fadeTop.alpha=Math.max(0,Math.min(1,(1750-this._ourPosCurrent)/50)),this._panelSoil.fadeBottom.alpha=Math.max(0,Math.min(1,(1750-this._ourPosCurrent)/50)),this._panelSoil.deadTop.alpha=Math.max(0,Math.min(1,(1750-this._ourPosCurrent)/50)),this._panelSoil.deadBottom.alpha=Math.max(0,Math.min(1,(1750-this._ourPosCurrent)/50)),this._ruler.alpha=.4*Math.max(0,Math.min(1,(1700-this._ourPosCurrent)/50))}}_TickGame(e,t,n,s,i,o,a,r){if(e===this.primary&&a.enabled)return this._TickGame_Primary(e,t,n,"left");if(this._sideCarGame===e||a.enabled&&e.getOwner()===a.ally.username)return this._sideCarGameLock||(this._sideCarGame=e),this._TickGame_Primary(e,t,n,"right");if(e===this.primary)return this._sideCarGameLock||(this._sideCarGame=null),this._TickGame_Primary(e,t,n);const l=t.un??e.getOwner();if(t.un=l,t.r)t.y=t.r.y,t.z=t.r.z;else if(n||t.spr)if(n&&e.isSynced())t.y=e.getZenithAltitude(),t.ty=t.y,t.tyo=t.y;else{const n=i.get(l),s=n?.stats.altitude||0,o=n?.stats.rank||0;if(t.tyo!==s)t.tyo=s,t.ty=s;else{const e=.25*Math.floor(o),n=me.GetSpeedCap(t.ty);t.ty+=e/60*r*n}t.y=Math.abs(t.ty-t.y)<=.075?t.ty:t.ty+(t.y-t.ty)*Math.pow(.97,r),e.setZenithAltitude(t.y)}else t.y=i.get(l)?.stats.altitude||0,t.ty=t.y,t.tyo=t.y,e.setZenithAltitude(t.y);const c=(s-t.y)/this._range;if(c>=-this._safeZone&&c<=this._safeZone&&!t.r){let e=0;const s=o.indexOf(t);e=s>=0?s<this._maxSmall?1-s/this._maxSmall*.25:s<this._maxTiny?.74-(s-this._maxSmall)/this._maxTiny*.24:.49-(s-this._maxSmall-this._maxTiny)/this._maxStar*.49:t.im>(o[this._maxSmall-1]??{im:-1}).im?.75:t.im>(o[this._maxSmall+this._maxTiny-1]??{im:-1}).im?.5:t.im>(o[this._maxSmall+this._maxTiny+this._maxStar-1]??{im:-1}).im?-1:0,t.z=n||t.spr?e+(t.z-e)*Math.pow(.97,r):e}const p=c*(1+4*t.z);p>=-this._safeZone&&p<=this._safeZone?this._TickGame_InFrame(e,t,n,p):this._TickGame_OutOfFrame(e,t,n,p)}_TickGame_Primary(e,t,n,s=null){if(n){switch(s){case"left":e.location(-.32,this._scrollAway,1,!1);break;case"right":e.location(.32,this._scrollAway,1,!1);break;default:e.location(0,this._scrollAway,1,!1)}s&&e.updateDuoSide(s,!0),e.changeDisplayMode("full")}else{switch(t.spr&&(t.spr.destroy(),t.spr=null),s&&e.updateDuoSide(s),e.rehead(),e.changeDisplayMode("full"),s){case"left":e.getOwner()===mn.username()?(e.location(-.32,this._scrollAway,1,!0),e.playZoomInto("zenithduoleft")):(e.location(-.16,this._scrollAway,.5,!0),e.location(-.32,this._scrollAway,1,!1));break;case"right":e.getDuoOptions().ally.username===mn.username()?(e.location(.32,this._scrollAway,1,!0),e.playZoomInto("zenithduoright")):(e.location(.16,this._scrollAway,.5,!0),e.location(.32,this._scrollAway,1,!1));break;default:e.location(0,this._scrollAway,.5,!0),e.location(0,this._scrollAway,1,!1)}e.recolorForAltitude(t.y),this.activeGames.set(e,t),this.inactiveGames.delete(e)}}_TickGame_OutOfFrame(e,t,n,s){n?("full"===e.getDisplayMode()?e.fadeOutAndBehead(100):e.behead(),this.activeGames.delete(e),this.inactiveGames.set(e,t)):t.spr&&(t.spr.destroy(),t.spr=null)}_TickGame_InFrame(e,t,n,i){if(!n&&!t.spr&&t.z<0)return;const o=t.z>=.5,r=t.z>=.75?"small":"tiny";let l=!1;o!==n&&(o?(t.spr&&(t.spr.destroy(),t.spr=null),0!==t.d&&e.updateDuoSide(-1===t.d?"left":"right"),e.rehead(),e.recolorForAltitude(t.y),l=!0,this.activeGames.set(e,t),this.inactiveGames.delete(e)):(e.fadeOutAndBehead(100),this.activeGames.delete(e),this.inactiveGames.set(e,t)));const c=t.z<.75?e.recolorForAltitude(t.y):null;if(o||t.spr||(t.spr=a.Sprite.from("/res/particles/boardstar.png"),t.spr.alpha=0,t.spr.anchor.set(.5,.5),i>-1.1&&i<1.1&&El.animate(t.spr,{0:{alpha:0},1:{alpha:1.5*t.z+.25}},1,s(0,0,1,1)),_l.addChild(t.spr)),o){"full"===e.getDisplayMode()&&(t.t=performance.now()+500),0!==t.d&&e.updateDuoSide(-1===t.d?"left":"right",!0),e.changeDisplayMode(r);const n=.05+Math.pow(.9*(t.z-.5),1.75);if(e.location(t.x*(1+.2*(1-t.z))+n*(t.z>=.75?.32*t.d:.2*t.d),i,n,performance.now()>=(t.t??0)),l&&i>-1.35&&i<1.35){const n=e.getHolder();n&&(n.alpha=0,El.animate(n,{0:{alpha:0},1:{alpha:(t.z-.5)/2+.75}},1,s(0,0,1,1)))}}else t.spr.scale.set(As(.1+.3*t.z)),t.spr.position.set(As(800+t.x*(1+.2*(1-t.z))*800),As(400+400*i)),t.spr.tint=c}Stop(){this._tickerActive&&(this._tickerActive=!1,a.Ticker.shared.remove(this._listener));for(const[,e]of this.inactiveGames)e.spr&&(e.spr.destroy(),e.spr=null);this._ruler&&(this._ruler.destroy(),this._ruler=null),this._rulerMarkerPb&&(this._rulerMarkerPb.destroy(),this._rulerMarkerPb=null),this._panelSoil.container&&(this._panelSoil.container.destroy(),this._panelSoil={},il.visible=!0),this._speedrunMeta.container&&this._speedrunMeta.container.destroy(),xt("zenithmenu").classList.add("hidden","thidden"),xt("zenithmenu").scrollTop=0}},window.DEVHOOK_DISABLE_SPECTATOR_TOOLS=()=>{La.SPECTATOR_TOOLS_DISABLED=!0,xt("spectate").classList.add("hidden"),document.body.classList.remove("spectating")};class wa extends Map{constructor(...e){super(...e),this._self=null,this._selfid=null,this._info=new Map,this.spec=null}get self(){return this._self}get selfid(){return this._selfid}set self(e){this._self=e,this._selfid=e?.id}get first(){return[...this.values()].shift()}get last(){return[...this.values()].pop()}get others(){let e=this.size;return this.self&&e--,e}getInfoByID(e){return this._info.get(e)}getUsernameByID(e){return this._info.get(e)?.username}getUserIDByID(e){return this._info.get(e)?.userid}setInfo(e,t,n){this._info.set(e,{userid:t,username:n})}forIndexedEach(e){for(const[t,n]of Array.from(this.values()).entries())e(n,t,this)}}class La{static HOLDERWIDTH=.8;static HOLDERWIDTHTINY=.5;static HOLDERHEIGHT=1.6;static SPECTATOR_TOOLS_DISABLED=!1;static SPECTATOR_BECAME_ACTIVE=0;static ENTERMIDGAME_LOCKED=!1;constructor(e,t){this._socket=e??null,this._games=new wa,this._dcgames=new Map,this._replays=[],this._totalSize=0,this._destroyed=!1,this._ready=Promise.resolve(!1),this._room=t,this._ourKiller=null,this._submitResolve=null,this.scoreboard=[],this.lastZenith=[],this._presentation="zenith"===t.match.gamemode?new Ba.Zenith({active:[],inactive:[],primary:null},this):new Ba.BasicFFA({active:[],inactive:[],primary:null},this),La.ENTERMIDGAME_LOCKED=!1,La.TRANSITION_LOCK=!1,document.body.classList.remove("multiplextransitionlock")}get games(){return this._games}get replays(){return this._replays.map((e=>k.StripBloat(e.Export())))}SetPresentation(e){this._presentation=new e(this._presentation.Deconstruct(),this),this._Refresh()}SetScoreboard(e){this.scoreboard=e,this._presentation.SetScoreboard(e)}Scroll(e){return this._presentation.Scroll(e)}SetFollowing(e){return this._presentation.SetFollowing?.(e)}CancelFollowing(e){return this._presentation.CancelFollowing?.(e)}_AddReplay(e){if(this._totalSize>2)return this._replays.length=0;this._replays.push(e.replay)}_AttachLocal(e){const t=new B("keyboard",{socket:this._socket});return t.bindRollingReplay(this._socket),t.on("fail",((e,n,s)=>{this._games.forEach((e=>{e.setTargeted(!1),e.setEnemy(!1)})),this._OnGameEnding(t,n,s)})),t.on("quit",(()=>{Oa.leaveRoom(),Oa.dropMultiplex()})),t.on("stop",this._DetachGame.bind(this,t)),t.on("target",((e,t)=>{const n=this._games.get(e);n?.setTargeted(t)})),t.on("enemy",((e,t)=>{const n=this._games.get(e);n?.setEnemy(t)})),t.on("garbage",(e=>{const t=this._games.get(e);return t?t.getPos():null})),t.on("b2bstate",(e=>{this._UpdateB2BState()})),t.setGame(e.options,this._room.constants),t.createGameHolder(),Ca.setGame(t),Ca.setEnabled(this._totalSize>2),xt("zenith_party_ready_label").textContent="READY",xt("zenith_party_ready").classList.remove("ready","otherready"),xt("zenith_party_self").classList.remove("ready"),xt("zenith_party_other").classList.remove("ready"),this._games.self=t,this._games.set(t.id,t),this._AddReplay(t),this._presentation.AddGame(t,!0),this._presentation.SetPrimary(t),t}_AttachOnline(e,t){const n=new B("socket",{socket:this._socket}),s=e.options;s.noreplay=this._totalSize>2;const i=this._presentation.GameExtraOptions(n);i&&Object.assign(s,i),n.on("fail",((e,t,s)=>{this._OnGameEnding(n,t,s)})),n.on("stop",this._DetachGame.bind(this,n)),n.on("garbage",(e=>{const t=this._games.get(e);if(!t)return null;if(t===this._games.self)return null;let n=t.getPos();return n.isFallback&&this._presentation.FallbackPos&&(n=this._presentation.FallbackPos(t,n)||n),n})),n.on("click",(()=>this._games.self?!1!==this._games.self.options.manual_allowed&&(Ca.setStrategy(5,n.id),!0):(this.SetSpectate(n.id),!0))),n.on("b2bstate",(e=>{this._UpdateB2BState()}));const o=!this._presentation.GameShouldBeActive(n);return n.setGame(s,this._room.constants),n.setSynced(!1),n.setHeadless(o),n.createGameHolder(t),this._games.set(n.id,n),this._AddReplay(n),this._presentation.AddGame(n,!o),n}_DetachGame(e){this._games.delete(e.id),this._presentation.RemoveGame(e);const t=e.getLastAttacker();if(this._games.self===e){if(this._socket.SetFasterPing(!1),this._games.self=null,this._presentation.SetPrimary(null),La.ENTERMIDGAME_LOCKED=!1,document.body.classList.contains("inzenith")&&ka(e,this),1===this._games.others)return;return t&&!document.body.classList.contains("inzenith")?this.SetSpectate(t):this._Refresh()}if(this._games.spec===e&&this._games.size>=2)return this.SetSpectate(t);"minimal"!==it.video.graphics&&this._Refresh()}_UpdateB2BState(){if(2!==this._games.size)return;const[e,t]=this._games.values(),[n,s]=[Math.max(0,e.getState().stats.btb-e.getState().setoptions.b2bcharge_at+e.getState().setoptions.b2bcharge_base),Math.max(0,t.getState().stats.btb-t.getState().setoptions.b2bcharge_at+t.getState().setoptions.b2bcharge_base)];e.setB2BDistance(n-s),t.setB2BDistance(s-n)}_HandleWaterFall(e,t){if(this._ourKiller!==e.victim&&e.self!==e.victim||(this._ourKiller=e.killer),!1===it.video.kos)return;const n=e.victim?.toUpperCase(),s=e.killer?.toUpperCase();let i="";n&&(document.body.classList.contains("inzenith")?i=` <span class="fire">${(Math.floor(10*e.alt)/10).toFixed(1)}${zl("M")}</span>`:t>=250&&(i=` <span class="fire">${Math.ceil(t/7)}%</span>`)),e.self&&e.self===e.victim?an({msg:null!=s?`ko'd by ${s}`:"you ko'd yourself",fgcolor:"#FF2222",bgcolor:"#FFFFFF",timeout:5e3}):e.self&&e.killer===e.self?(na.PlaySe("elim"),an({msg:`ko'd ${n}${i}`,fgcolor:"#FFFFFF",bgcolor:"#FF2222",timeout:3e3})):e.self&&e.assists.includes(e.killer)?(na.PlaySe("elim"),an({msg:`assist ${n}${i}`,fgcolor:"#FFFFFF",bgcolor:"#FF2222",timeout:3e3})):e.spec&&e.spec===e.victim?an({msg:null!=s?`${n} ko'd by ${s}`:`${n} ko'd themselves`,fgcolor:"#FF2222",bgcolor:"#FFFFFF",timeout:5e3}):e.spec&&(e.spec===e.killer||e.assists.includes(e.killer))&&an({msg:`${s} ko'd ${n}${i}`,fgcolor:"#FFFFFF",bgcolor:"#FF2222",timeout:3e3})}async _OnGameEnding(e,t,n){const s={};s.victim=e.getOwner(),s.killer=t.username??this._games.getUsernameByID(t.gameid),s.self=this._games.self?.getOwner(),s.spec=this._games.spec?.getOwner(),s.assists=this._presentation.assistGames.map((e=>e.getOwner())),s.alt=e.getZenithAltitude(),await Ot(50),this._HandleWaterFall(s,n),s.victim===s.self||s.killer===s.self&&!1!==it.video.kos||e.isHeadless()||na.PlaySe("death",this._games.size<=100?1:.5),ln(s.victim,s.killer,t.type);for(const e of this._games.values())e.updatePlacement(this._games.size)}_Refresh(e=!1){if(this._destroyed)return;const t=this._presentation.Refresh(e=!!e);this._games.self||!t||La.TRANSITION_LOCK?(xt("spectate").classList.add("hidden"),document.body.classList.remove("spectating")):(xt("spectate").classList.contains("hidden")&&(La.SPECTATOR_BECAME_ACTIVE=Date.now()),La.SPECTATOR_TOOLS_DISABLED||(xt("spectate").classList.remove("hidden"),document.body.classList.add("spectating")))}async _Load(e){let t=0;this._socket.cork();let n="tiny";for(e.length<=8&&!it.video.alwaystiny&&"minimal"!==it.video.graphics&&(n="small"),e.length<=2&&it.video.sidebyside&&(n="full");;){for(let s=0;s<=30;s++,t++){const s=e[t];if(!s)return this._Refresh(!0),xt("roomprepare").classList.add("hidden"),this._socket.uncork(),!0;s.userid!==mn.id()?this._AttachOnline(s,n):this._AttachLocal(s)}xt("roomprepare_detail").innerHTML=`${t} / ${e.length} players loaded`,await setTimeout(0)}}Find(e){if(!e)return null;const t=this._games.get(e);if(t)return t;for(const t of this._games.values())if(t.getOwner()===e)return t;return null}OnReplayEnter(e){if(e.userid===mn.id()){if(this._games.self){if(this._games.self.id===e.gameid)return!0;this._games.self.endNow()}this.SetSpectate(null);const t=this._AttachLocal(e);return this._games.setInfo(e.gameid,e.userid,e.options.username),t.startGame(),t.updatePlacement(this._games.size),this._Refresh(),!0}let t="tiny";this._games.size<8&&!it.video.alwaystiny&&"minimal"!==it.video.graphics&&(t="small"),this._games.size<2&&it.video.sidebyside&&(t="full");const n=this._AttachOnline(e,t);this._games.setInfo(e.gameid,e.userid,e.options.username),n.startGame(),n.updatePlacement(this._games.size),this._Refresh()}OnReplayState(e,t){const n=this._games.get(e);if(n){if("early"===t)return n.setSynced(!0);if("wait"===t)return n.requestState();n.injectState(t),n.updatePlacement(this._games.size)}}OnReplayBoardState(e,t){const n=this._games.get(e);n&&n.injectBoardState(t)}OnReplayEnd(e,t){const n=this._games.get(e);return n?"zenith"===this._room.match.gamemode&&n===this._games.self?n.end(t.gameoverreason):void n.queueEnd(t.gameoverreason,"winner"!==t.gameoverreason,t.fire,t.killer):this._dcgames.set(e,t)}SetPlayers(e,t=!1){e=e.filter((e=>e.alive)),"zenith"!==this._room.match.gamemode&&e.length>=100&&this.SetPresentation(Ba.SuperLobby);for(const t of e)this._games.setInfo(t.gameid,t.userid,t.options.username);this._totalSize=e.length,t&&Da.shuffleArray(e),e.length>=30&&(xt("roomprepare_detail").innerHTML=`0 / ${e.length} players loaded`,xt("roomprepare").classList.remove("hidden")),this._ready=this._Load(e)}GetSpectate(){return this._games.spec}SetSpectate(e){const t=this.Find(e);return t?(this._games.spec=t,this._presentation.SetPrimary(t),this._Refresh(),t):(this._games.spec=null,this._presentation.SetPrimary(null),this._Refresh())}async Start(e=!1){if(!await this._ready)return console.warn("Failed to start multiplex, something wrong happened with during the preload");const t=[],n=e?"spectateGame":"startGame";for(const e of this._games.values())t.push(e[e===this._games.self?"startGame":n]()),e.updatePlacement(this._games.size);for(const[e,t]of this._dcgames)this.OnReplayEnd(e,t);return this._presentation.Animate("start"),await Promise.all(t)}Stop(e){this._destroyed=!0;const t=[];e.forEach((e=>e.alive&&t.push(e.username)));for(const e of this._games.values())e!==this._games.self?t.includes(e.getOwner())?(e.queueEnd("winner"),setTimeout(e.endWin.bind(e),1e3)):(e.queueEnd("topout",!0),setTimeout(e.endLose.bind(e,!0),1e3)):t.includes(e.getOwner())?e.endWin():e.endLose();this._presentation.Stop(),xt("spectate").classList.add("hidden"),document.body.classList.remove("spectating")}Abort(){this._destroyed=!0,this._presentation.Stop(),Rs.stopNow(),this.End(),xt("spectate").classList.add("hidden"),document.body.classList.remove("spectating")}End(){this._destroyed=!0,this._presentation.Stop(),this._games.forEach((e=>e.endNow())),this._games.self=null,this._games.spec=null}HasSubmitted(e){this._submitResolve?(this._submitResolve(e),this._submitResolve=null):wn(e.xp??0)}}async function ka(e,t){La.TRANSITION_LOCK=!0,document.body.classList.add("multiplextransitionlock"),t._Refresh();const n=e.export(),s=n.stats,i=e.getFrame(),o=Bt(s.finaltime),a=s.finaltime/6e4,r=s.finaltime/1e3,l=["","hall of beginnings","the hotel","the casino","the arena","the museum","abandoned offices","the laboratory","the core","corruption","platform of the gods"],c=Date.now(),p=await new Promise((e=>{t._submitResolve=e})),{ranks:d,record:h,ally:u}=p,_=n.options.zenith_mods.includes("expert")?"zenithex":"zenith";p.stats&&Rs.setZenithStats(p.stats),t.lastZenith=p,Rs.setUnsafeTimeout((()=>{wn(p.xp??0),document.body.classList.remove("multiplextransitionlock"),La.TRANSITION_LOCK=!1,xt("zenithmenu").classList.add("inresults"),xt("zenith_contribution").classList.toggle("hidden",!u),xt("start_zenith_label").textContent="AGAIN",xt("chatreplay_zenith").classList.remove("sent");const e=xt("zenith_results_stats_full"),c=xt("zenith_results_stats_overview");e.innerHTML="",c.innerHTML="",p.submitted?(xt("zenithmenu").classList.remove("fakereplay","noreplay"),xt("replayid_zenith").textContent=`R:${h.replayid}`):(xt("zenithmenu").classList.add("fakereplay"),u?xt("zenithmenu").classList.remove("noreplay"):xt("zenithmenu").classList.add("noreplay"));const m=n.options.zenith_mods.includes("allspin")?"T-":"";if(u){const t=`<img class="avatar" src="${xt("zenith_party_self_avatar").src}" />`,i=`<img class="avatar" src="${xt("zenith_party_other_avatar").src}" />`;xt("zenith_result").innerHTML=`${Math.floor(Math.max(s.zenith.altitude,u.stats.zenith.altitude)).toLocaleString("en-US")}<span class="ms">.${Math.floor(Math.max(s.zenith.altitude,u.stats.zenith.altitude)%1*10)}</span><span class="unit">M</span><span class="mods">${n.options.zenith_mods.map((e=>`<img src="/res/zenith-mods/pbicons-result/${St(e)}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`)).join("")}</span>`;const o=s.zenith.totalbonus+u.stats.zenith.totalbonus;if(o){xt("zenith_contribution_self_avatar").src=xt("zenith_party_self_avatar").src,xt("zenith_contribution_ally_avatar").src=xt("zenith_party_other_avatar").src;const e=Math.round(s.zenith.totalbonus/o*1e3);xt("zenith_contribution_self").innerHTML=`<h1>${Math.floor(e/10)}<span>.${e%10}%</span></h1><p>${s.zenith.totalbonus.toFixed(1)}</p>`,xt("zenith_contribution_ally").innerHTML=`<h1>${Math.floor((1e3-e)/10)}<span>.${(1e3-e)%10}%</span></h1><p>${u.stats.zenith.totalbonus.toFixed(1)}</p>`,xt("zenith_contribution").style.setProperty("--p",e/10+"%")}else xt("zenith_contribution").classList.add("hidden");const a=Bt(Math.max(s.finaltime,u.stats.finaltime));Rs.addStatsLine(c,"TIME",`${a.m}:${a.s}.${a.ms}`),Rs.addStatsLine(c,"FLOOR",`${Math.max(s.zenith.floor,u.stats.zenith.floor)}: ${l[Math.max(s.zenith.floor,u.stats.zenith.floor)]??""}`),Rs.addStatsLine(c,"KO's",`<b>${(s.kills+u.stats.kills).toLocaleString("en-US")}</b> ${t} ${s.kills.toLocaleString("en-US")} ${i} ${u.stats.kills.toLocaleString("en-US")}`),Rs.addStatsLine(c,"REVIVES",`<b>${(s.zenith.revives+u.stats.zenith.revives).toLocaleString("en-US")}</b> ${t} ${s.zenith.revives.toLocaleString("en-US")} ${i} ${u.stats.zenith.revives.toLocaleString("en-US")}`),Rs.addStatsLine(c,"average CLIMB SPEED",((s.zenith.avgrankpts/(s.finaltime/1e3*60)+u.stats.zenith.avgrankpts/(u.stats.finaltime/1e3*60))/2).toFixed(2)),Rs.addStatsLine(c,"peak CLIMB SPEED",Math.floor(Math.max(s.zenith.peakrank,u.stats.zenith.peakrank)).toLocaleString("en-US")),Rs.addStatsLine(c,"ALTITUDE per SECOND",(Math.max(s.zenith.altitude,u.stats.zenith.altitude)/Math.max(s.finaltime/1e3,u.stats.finaltime/1e3)).toFixed(2)),Rs.addStatsLine(c,"ATTACK",`<b>${(s.garbage.attack+u.stats.garbage.attack).toLocaleString("en-US")}</b> ${t} ${s.garbage.attack.toLocaleString("en-US")} ${i} ${u.stats.garbage.attack.toLocaleString("en-US")}`),Rs.addStatsLine(c,"ATTACK per PIECE",`<b>${((s.garbage.attack+u.stats.garbage.attack)/(s.piecesplaced+u.stats.piecesplaced)).toFixed(3)}</b> ${t} ${(s.garbage.attack/s.piecesplaced).toFixed(3)} ${i} ${(u.stats.garbage.attack/u.stats.piecesplaced).toFixed(3)}`),Rs.addStatsLine(c,"ATTACK per MINUTE",`<b>${(n.aggregatestats.apm+u.aggregatestats.apm).toFixed(2)}</b> ${t} ${n.aggregatestats.apm.toFixed(2)} ${i} ${u.aggregatestats.apm.toFixed(2)}`),Rs.addStatsLine(c,"PIECES per SECOND",`<b>${(n.aggregatestats.pps+u.aggregatestats.pps).toFixed(2)}</b> ${t} ${n.aggregatestats.pps.toFixed(2)} ${i} ${u.aggregatestats.pps.toFixed(2)}`),Rs.addStatsLine(c,"VERSUS SCORE",`<b>${(n.aggregatestats.vsscore+u.aggregatestats.vsscore).toFixed(2)}</b> ${t} ${n.aggregatestats.vsscore.toFixed(2)} ${i} ${u.aggregatestats.vsscore.toFixed(2)}`),Rs.addStatsLine(c,"maximum COMBO",`${t} ${Math.max(0,s.topcombo-1)} ${i} ${Math.max(0,u.stats.topcombo-1)}`),Rs.addStatsLine(c,"maximum back-to-back chain",`${t} ${Math.max(0,s.topbtb-1)} ${i} ${Math.max(0,u.stats.topbtb-1)}`),Rs.addStatsLine(e,"LINES SENT",`<b>${(s.garbage.sent+u.stats.garbage.sent).toLocaleString("en-US")}</b> ${t} ${s.garbage.sent.toLocaleString("en-US")} ${i} ${u.stats.garbage.sent.toLocaleString("en-US")}`),Rs.addStatsLine(e,"LINES RECEIVED",`<b>${(s.garbage.received+u.stats.garbage.received).toLocaleString("en-US")}</b> ${t} ${s.garbage.received.toLocaleString("en-US")} ${i} ${u.stats.garbage.received.toLocaleString("en-US")}`),Rs.addStatsLine(e,"PIECES PLACED",`<b>${(s.piecesplaced+u.stats.piecesplaced).toLocaleString("en-US")}</b> ${t} ${s.piecesplaced.toLocaleString("en-US")} ${i} ${u.stats.piecesplaced.toLocaleString("en-US")}`),Rs.addStatsLine(e,"KEYS PRESSED",`<b>${(s.inputs+u.stats.inputs).toLocaleString("en-US")}</b> ${t} ${s.inputs.toLocaleString("en-US")} ${i} ${u.stats.inputs.toLocaleString("en-US")}`),Rs.addStatsLine(e,"KEYS per PIECE",`<b>${((s.inputs+u.stats.inputs)/(s.piecesplaced+u.stats.piecesplaced)).toFixed(3)}</b> ${t} ${(s.inputs/s.piecesplaced).toFixed(3)} ${i} ${(u.stats.inputs/u.stats.piecesplaced).toFixed(3)}`),Rs.addStatsLine(e,"KEYS per SECOND",`<b>${((s.inputs+u.stats.inputs)/Math.max(s.finaltime/1e3,u.stats.finaltime/1e3)).toFixed(3)}</b> ${t} ${(s.inputs/Math.max(s.finaltime/1e3,u.stats.finaltime/1e3)).toFixed(3)} ${i} ${(u.stats.inputs/Math.max(s.finaltime/1e3,u.stats.finaltime/1e3)).toFixed(3)}`),Rs.addStatsLine(e,"HOLDS",`<b>${(s.holds+u.stats.holds).toLocaleString("en-US")}</b> ${t} ${s.holds.toLocaleString("en-US")} ${i} ${u.stats.holds.toLocaleString("en-US")}`),Rs.addStatsLine(e,"LINES",`<b>${(s.lines+u.stats.lines).toLocaleString("en-US")}</b> ${t} ${s.lines.toLocaleString("en-US")} ${i} ${u.stats.lines.toLocaleString("en-US")}`),Rs.addStatsLine(e,"LINES per MINUTE",`<b>${((s.lines+u.stats.lines)/Math.max(s.finaltime/6e4,u.stats.finaltime/6e4)).toFixed(2)}</b> ${t} ${(s.lines/Math.max(s.finaltime/6e4,u.stats.finaltime/6e4)).toFixed(2)} ${i} ${(u.stats.lines/Math.max(s.finaltime/6e4,u.stats.finaltime/6e4)).toFixed(2)}`),Rs.addStatsLine(e,"SINGLES",`<b>${(s.clears.singles+u.stats.clears.singles).toLocaleString("en-US")}</b> ${t} ${s.clears.singles.toLocaleString("en-US")} ${i} ${u.stats.clears.singles.toLocaleString("en-US")}`),Rs.addStatsLine(e,"DOUBLES",`<b>${(s.clears.doubles+u.stats.clears.doubles).toLocaleString("en-US")}</b> ${t} ${s.clears.doubles.toLocaleString("en-US")} ${i} ${u.stats.clears.doubles.toLocaleString("en-US")}`),Rs.addStatsLine(e,"TRIPLES",`<b>${(s.clears.triples+u.stats.clears.triples).toLocaleString("en-US")}</b> ${t} ${s.clears.triples.toLocaleString("en-US")} ${i} ${u.stats.clears.triples.toLocaleString("en-US")}`),Rs.addStatsLine(e,"QUADS",`<b>${(s.clears.quads+u.stats.clears.quads).toLocaleString("en-US")}</b> ${t} ${s.clears.quads.toLocaleString("en-US")} ${i} ${u.stats.clears.quads.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spins`,`<b>${(s.tspins+u.stats.tspins).toLocaleString("en-US")}</b> ${t} ${s.tspins.toLocaleString("en-US")} ${i} ${u.stats.tspins.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin ZEROES`,`<b>${(s.clears.realtspins+u.stats.clears.realtspins).toLocaleString("en-US")}</b> ${t} ${s.clears.realtspins.toLocaleString("en-US")} ${i} ${u.stats.clears.realtspins.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin MINIS`,`<b>${(s.clears.minitspins+u.stats.clears.minitspins).toLocaleString("en-US")}</b> ${t} ${s.clears.minitspins.toLocaleString("en-US")} ${i} ${u.stats.clears.minitspins.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin MINI SINGLES`,`<b>${(s.clears.minitspinsingles+u.stats.clears.minitspinsingles).toLocaleString("en-US")}</b> ${t} ${s.clears.minitspinsingles.toLocaleString("en-US")} ${i} ${u.stats.clears.minitspinsingles.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin SINGLES`,`<b>${(s.clears.tspinsingles+u.stats.clears.tspinsingles).toLocaleString("en-US")}</b> ${t} ${s.clears.tspinsingles.toLocaleString("en-US")} ${i} ${u.stats.clears.tspinsingles.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin MINI DOUBLES`,`<b>${(s.clears.minitspindoubles+u.stats.clears.minitspindoubles).toLocaleString("en-US")}</b> ${t} ${s.clears.minitspindoubles.toLocaleString("en-US")} ${i} ${u.stats.clears.minitspindoubles.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin DOUBLES`,`<b>${(s.clears.tspindoubles+u.stats.clears.tspindoubles).toLocaleString("en-US")}</b> ${t} ${s.clears.tspindoubles.toLocaleString("en-US")} ${i} ${u.stats.clears.tspindoubles.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin MINI TRIPLES`,`<b>${(s.clears.minitspintriples+u.stats.clears.minitspintriples).toLocaleString("en-US")}</b> ${t} ${s.clears.minitspintriples.toLocaleString("en-US")} ${i} ${u.stats.clears.minitspintriples.toLocaleString("en-US")}`),Rs.addStatsLine(e,`${m}spin TRIPLES`,`<b>${(s.clears.tspintriples+u.stats.clears.tspintriples).toLocaleString("en-US")}</b> ${t} ${s.clears.tspintriples.toLocaleString("en-US")} ${i} ${u.stats.clears.tspintriples.toLocaleString("en-US")}`),""===m&&Rs.addStatsLine(e,"spin MINI QUADS",`<b>${(s.clears.minitspinquads+u.stats.clears.minitspinquads).toLocaleString("en-US")}</b> ${t} ${s.clears.minitspinquads.toLocaleString("en-US")} ${i} ${u.stats.clears.minitspinquads.toLocaleString("en-US")}`),""===m&&Rs.addStatsLine(e,"spin QUADS",`<b>${(s.clears.tspinquads+u.stats.clears.tspinquads).toLocaleString("en-US")}</b> ${t} ${s.clears.tspinquads.toLocaleString("en-US")} ${i} ${u.stats.clears.tspinquads.toLocaleString("en-US")}`),Rs.addStatsLine(e,"ALL CLEARS",`<b>${(s.clears.allclear+u.stats.clears.allclear).toLocaleString("en-US")}</b> ${t} ${s.clears.allclear.toLocaleString("en-US")} ${i} ${u.stats.clears.allclear.toLocaleString("en-US")}`),Rs.addStatsLine(e,"finesse %",`<b>${((s.finesse.perfectpieces+u.stats.finesse.perfectpieces)/Math.max(1,s.piecesplaced+u.stats.piecesplaced)*100).toFixed(2)}%</b> ${t} ${(s.finesse.perfectpieces/Math.max(1,s.piecesplaced)*100).toFixed(2)}% ${i} ${(u.stats.finesse.perfectpieces/Math.max(1,u.stats.piecesplaced)*100).toFixed(2)}%`),Rs.addStatsLine(e,"finesse faults",`<b>${(s.finesse.faults+u.stats.finesse.faults).toLocaleString("en-US")}</b> ${t} ${s.finesse.faults.toLocaleString("en-US")} ${i} ${u.stats.finesse.faults.toLocaleString("en-US")}`)}else xt("zenith_result").innerHTML=`${Math.floor(s.zenith.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(s.zenith.altitude%1*10)}</span><span class="unit">M</span><span class="mods">${n.options.zenith_mods.map((e=>`<img src="/res/zenith-mods/pbicons-result/${St(e)}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`)).join("")}</span>`,Rs.addStatsLine(c,"TIME",`${o.m}:${o.s}.${o.ms}`),Rs.addStatsLine(c,"FLOOR",`${s.zenith.floor}: ${l[s.zenith.floor]??""}`),Rs.addStatsLine(c,"KO's",s.kills.toLocaleString("en-US")),Rs.addStatsLine(c,"average CLIMB SPEED",(s.zenith.avgrankpts/i).toFixed(2)),Rs.addStatsLine(c,"peak CLIMB SPEED",Math.floor(s.zenith.peakrank).toLocaleString("en-US")),Rs.addStatsLine(c,"ALTITUDE per SECOND",(s.zenith.altitude/r).toFixed(2)),Rs.addStatsLine(c,"ATTACK",s.garbage.attack),Rs.addStatsLine(c,"ATTACK per PIECE",(s.garbage.attack/s.piecesplaced).toFixed(3)),Rs.addStatsLine(c,"ATTACK per MINUTE",n.aggregatestats.apm.toFixed(2)),Rs.addStatsLine(c,"PIECES per SECOND",(s.piecesplaced/r).toFixed(2)),Rs.addStatsLine(c,"VERSUS SCORE",n.aggregatestats.vsscore.toFixed(2)),Rs.addStatsLine(c,"maximum COMBO",Math.max(0,s.topcombo-1)),Rs.addStatsLine(c,"maximum back-to-back chain",Math.max(0,s.topbtb-1)),Rs.addStatsLine(e,"LINES SENT",s.garbage.sent.toLocaleString("en-US")),Rs.addStatsLine(e,"LINES RECEIVED",s.garbage.received.toLocaleString("en-US")),Rs.addStatsLine(e,"PIECES PLACED",s.piecesplaced.toLocaleString("en-US")),Rs.addStatsLine(e,"KEYS PRESSED",s.inputs),Rs.addStatsLine(e,"KEYS per PIECE",(s.inputs/s.piecesplaced).toFixed(3)),Rs.addStatsLine(e,"KEYS per SECOND",(s.inputs/r).toFixed(3)),Rs.addStatsLine(e,"HOLDS",s.holds.toLocaleString("en-US")),Rs.addStatsLine(e,"LINES",s.lines.toLocaleString("en-US")),Rs.addStatsLine(e,"LINES per MINUTE",(s.lines/a).toFixed(2)),Rs.addStatsLine(e,"SINGLES",s.clears.singles.toLocaleString("en-US")),Rs.addStatsLine(e,"DOUBLES",s.clears.doubles.toLocaleString("en-US")),Rs.addStatsLine(e,"TRIPLES",s.clears.triples.toLocaleString("en-US")),Rs.addStatsLine(e,"QUADS",s.clears.quads.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spins`,s.tspins),Rs.addStatsLine(e,`${m}spin ZEROES`,s.clears.realtspins.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spin MINIS`,s.clears.minitspins.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spin MINI SINGLES`,s.clears.minitspinsingles.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spin SINGLES`,s.clears.tspinsingles.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spin MINI DOUBLES`,s.clears.minitspindoubles.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spin DOUBLES`,s.clears.tspindoubles.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spin MINI TRIPLES`,s.clears.minitspintriples.toLocaleString("en-US")),Rs.addStatsLine(e,`${m}spin TRIPLES`,s.clears.tspintriples.toLocaleString("en-US")),""===m&&Rs.addStatsLine(e,"spin MINI QUADS",s.clears.minitspinquads.toLocaleString("en-US")),""===m&&Rs.addStatsLine(e,"spin QUADS",s.clears.tspinquads.toLocaleString("en-US")),Rs.addStatsLine(e,"ALL CLEARS",s.clears.allclear.toLocaleString("en-US")),Rs.addStatsLine(e,"finesse %",`${(s.finesse.perfectpieces/Math.max(1,s.piecesplaced)*100).toFixed(2)}%`),Rs.addStatsLine(e,"finesse faults",s.finesse.faults.toLocaleString("en-US"));xt("zenithmenu").classList.toggle("hasranks",!!d),d&&(d.user<=10?(xt("zenith_personalrank_results").classList.toggle("textual",1===d.user),xt("zenith_personalrank_results_data").innerHTML=1===d.user?"PERSONAL BEST":d.user,xt("zenith_personalrank_results").classList.remove("hidden"),Rs.getRecords()[_]?xt("zenith_personalrank_results_sub").innerHTML=`${Math.abs(Rs.getRecords()[_].results.stats.zenith.altitude-s.zenith.altitude).toFixed(1)} ${1===d.user?"improvement":"behind"} &bull; last PB was ${wt(Date.parse(Rs.getRecords()[_].ts)).toUpperCase()} ago`:xt("zenith_personalrank_results_sub").innerHTML="this is your first game this week, play more to track your improvement",xt("zenith_personalrank_results").classList.toggle("best",1===d.user)):xt("zenith_personalrank_results").classList.add("hidden"),d.local>0?(xt("zenith_countryrank_results").classList.toggle("textual",1===d.local),xt("zenith_countryrank_results_data").innerHTML=1===d.local?"country best":d.local,xt("zenith_countryrank_results_sub").innerHTML=1===d.local?"":`TOP ${Math.min(100,(d.local-1)/Math.max(1,d.localcount)*100).toFixed(2)}%`,xt("zenith_countryrank_results").classList.remove("hidden"),xt("zenith_countryrank_results").classList.toggle("best",1===d.local)):xt("zenith_countryrank_results").classList.add("hidden"),d.global>0?(xt("zenith_globalrank_results").classList.toggle("textual",1===d.global),xt("zenith_globalrank_results_data").innerHTML=1===d.global?"world best":d.global,xt("zenith_globalrank_results_sub").innerHTML=1===d.global?"":`TOP ${Math.min(100,(d.global-1)/Math.max(1,d.globalcount)*100).toFixed(2)}%`,xt("zenith_globalrank_results").classList.remove("hidden"),xt("zenith_globalrank_results").classList.toggle("best",1===d.global)):xt("zenith_global_results").classList.add("hidden"),1===d.user&&(Rs.getRecords()[_]=h,Rs.updatePBDisplays()),1===d.global?(na.PlaySe("worldrecord"),vi("globalbest","WORLD RECORD!")):1===d.local?(na.PlaySe("personalbest"),vi("personalbest","COUNTRY BEST!")):1===d.user&&(na.PlaySe("personalbest"),vi("personalbest","PERSONAL BEST!"))),!t._games.spec&&!t._games.self&&document.body.classList.contains("inzenith")&&xt("zenithmenu").classList.contains("rolledup")&&xt("spectate").classList.contains("hidden")&&(xt("zenithmenu").classList.remove("rolledup"),t.SetSpectate(null),yt("#zenithmenu .menuslide_rollup").forEach((e=>e.textContent="SPECTATE"+(t._ourKiller?` ${t._ourKiller.toUpperCase()}`:""))),Si(!0),ii.bindGuide(oi.zenith||{}),xt("zenithmenu").scrollTop=0,t._Refresh())}),c+1500-Date.now())}kn.ready((()=>{xt("grid_spectate").addEventListener("click",(function(e){Fa&&(Date.now()-La.SPECTATOR_BECAME_ACTIVE<1e3?e.stopPropagation():null!=Fa.GetSpectate()?Fa.SetSpectate(null):e.stopPropagation())})),xt("next_spectate").addEventListener("click",(function(e){if(!Fa)return;if(Date.now()-La.SPECTATOR_BECAME_ACTIVE<1e3)return void e.stopPropagation();const t=Fa.GetSpectate();if(Fa.scoreboard.length){let e=null;if(t){const n=t.getOwner(),s=Fa.scoreboard[Fa.scoreboard.findIndex((e=>e.username===n))+1];e=s?s.username:Fa.scoreboard[0].username}else e=Fa.scoreboard[0].username;return Fa.SetSpectate(e)}{if(!t)return Fa.SetSpectate(Fa.games.first?.id);const e=Fa.games.values();for(const n of e){if(t!==n)continue;let s=e.next().value;if(!s&&(s=Fa.games.first,!s))return;return Fa.SetSpectate(s.id)}}})),xt("prev_spectate").addEventListener("click",(function(e){if(!Fa)return;if(Date.now()-La.SPECTATOR_BECAME_ACTIVE<1e3)return void e.stopPropagation();const t=Fa.GetSpectate();if(Fa.scoreboard.length){let e=null;if(t){const n=t.getOwner(),s=Fa.scoreboard[Fa.scoreboard.findIndex((e=>e.username===n))-1];e=s?s.username:Fa.scoreboard[Fa.scoreboard.length-1].username}else e=Fa.scoreboard[0].username;return Fa.SetSpectate(e)}{if(!t)return Fa.SetSpectate(Fa.games.last?.id);let e=null;for(const n of Fa.games.values()){if(t!==n){e=n;continue}let s=e;if(!s&&(s=Fa.games.last,!s))return;return Fa.SetSpectate(s.id)}}})),xt("exit_spectate").addEventListener("click",(function(e){Fa&&(Date.now()-La.SPECTATOR_BECAME_ACTIVE<1e3?e.stopPropagation():Oa.stopSpectating())})),xt("zen_spectate").addEventListener("click",(function(e){Fa&&(Date.now()-La.SPECTATOR_BECAME_ACTIVE<1e3?e.stopPropagation():(Oa.dropMultiplex(),Rs.playZen({inroom:!0,roomname:xt("room_content_name").innerText}),Us()))})),xt("follow_spectate").addEventListener("click",(function(e){if(!Fa)return;if(Date.now()-La.SPECTATOR_BECAME_ACTIVE<1e3)return void e.stopPropagation();if(xt("follow_spectate").classList.contains("active"))return Fa.SetFollowing(null);const t=Fa.GetSpectate();if(!t)return Fa.SetFollowing(null);Fa.SetFollowing(t.getOwner())})),xt("enter_spectate").addEventListener("click",(function(e){Fa&&(Date.now()-La.SPECTATOR_BECAME_ACTIVE<1e3||La.ENTERMIDGAME_LOCKED?e.stopPropagation():(La.ENTERMIDGAME_LOCKED=!0,Oa.enterMidgame({mods:GetModList()})))})),xt("referee_score_side").addEventListener("click",(function(e){if(!Fa)return;if(!e.target.dataset.username)return;const t=Fa.Find(e.target.dataset.username);t&&Fa.SetSpectate(t.id)})),document.addEventListener("keydown",(e=>{if(e.repeat)return;if(!xt("afterloader").classList.contains("hidden")||!xt("social").classList.contains("hidden")||!xt("kuro").classList.contains("hidden")||document.body.classList.contains("chatfocus")||$i>1)return;const t=xt("spectate").classList.contains("hidden")||$i>=1;!document.body.classList.contains("inzenith")&&t||document.body.classList.contains("inzenith")&&t&&(document.body.classList.contains("ingame_phys")||document.body.classList.contains("multiplextransitionlock"))||Object.keys(at).forEach((n=>{if((!t||["retry","exit","chat"].includes(n))&&at[n].includes(Ct(e)))switch(n){case"moveLeft":case"rotateCCW":xt("prev_spectate").click();break;case"moveRight":case"rotateCW":xt("next_spectate").click();break;case"softDrop":case"hardDrop":xt("grid_spectate").click();break;case"exit":if(document.body.classList.contains("inzenith")){xt(xt("zenithmenu").classList.contains("rolledup")?"zenith_rollup_main":"leavezenith").click();break}xt("exit_spectate").classList.contains("blocked")||xt("exit_spectate").click();break;case"retry":if(document.body.classList.contains("inzenith")){xt(xt("zenithmenu").classList.contains("duo")?"zenith_party_ready":"start_zenith").click();break}xt("enter_spectate").click();break;case"chat":document.body.classList.contains("inzenith")&&t&&(xt("ingame_chat_input").focus(),e.preventDefault())}}))}),!1),document.body.addEventListener("wheel",(function(e){if(!Fa||!document.body.classList.contains("spectating")||e.altKey||e.target.closest("#ingame_chat_container")||e.target.closest("#zen_panel_content")||$i>=1)return;Fa.Scroll(e.deltaY)&&(e.preventDefault(),e.stopImmediatePropagation())}),{passive:!1})})),kn.ready((()=>{yt("#zenithmenu .menuslide_rollup").forEach((e=>e.addEventListener("click",(()=>{Fa&&(xt("zenithmenu").classList.toggle("rolledup"),Si(!xt("zenithmenu").classList.contains("rolledup")),xt("zenithmenu").classList.contains("rolledup")?(Fa.SetSpectate(Fa._ourKiller),yt("#zenithmenu .menuslide_rollup").forEach((e=>e.textContent="PLAY")),setTimeout((()=>{ii.disengage()}),0)):(Fa._ourKiller=null,Fa.SetSpectate(null),yt("#zenithmenu .menuslide_rollup").forEach((e=>e.textContent="SPECTATE")),ii.bindGuide(oi.zenith||{})),xt("zenithmenu").scrollTop=0)})))),xt("start_zenith").addEventListener("click",(function(e){Fa&&(La.ENTERMIDGAME_LOCKED?e.stopPropagation():(na.PlaySe("zenith_start"),La.ENTERMIDGAME_LOCKED=!0,Oa.enterMidgame({mods:[...yt(".zenith_card.active")].map((e=>e.dataset.card))})))})),yt(".zenith_card").forEach((e=>e.addEventListener("mousemove",(t=>{const n=e.clientWidth,s=e.clientHeight;e.style.setProperty("--rx",(t.offsetX-n/2)/n*20+"deg"),e.style.setProperty("--ry",(t.offsetY-s/2)/s*-20+"deg")}))));let e=!1;function t(e){const t=e.parentNode.childElementCount,n=Array.from(e.parentNode.children).indexOf(e),s=n/Math.max(1,t-1)*.8+.1;for(let i=0;i<t;i++){let o=0;i===n?o=s:0===i?o=0:i<n?o=i/n*Math.max(.05,s-.2):i>n?o=1-(1-(i-n)/(t-1-n))*Math.min(.95,1-(s+.2)):i===t-1&&(o=1),o=1-o,e.parentNode.children[i].style.setProperty("--x",o),xt("zenith_deck_cards").children[i].classList.toggle("hover-blocked",i<n-1||i>n+1)}yt(".zenith_deck_info").forEach((e=>e.classList.add("hidden"))),At(`.zenith_deck_info[data-for="${e.dataset.card}${e.classList.contains("floorlocked")?"_locked":""}"]`).classList.remove("hidden"),na.PlaySe(`card_slide_${Math.floor(4*Math.random())+1}`,.3+.1*Math.random())}function n(){const e=xt("zenith_deck_cards").childElementCount;for(let t=0;t<e;t++)xt("zenith_deck_cards").children[t].style.setProperty("--x",.8*(1-t/Math.max(1,e-1))+.1),xt("zenith_deck_cards").children[t].classList.remove("hover-blocked");yt(".zenith_deck_info").forEach((e=>e.classList.add("hidden"))),At('.zenith_deck_info[data-for="x-nocard"]').classList.remove("hidden")}yt(".zenith_card").forEach((t=>t.addEventListener("click",(()=>{if("duo"===t.dataset.card&&t.classList.contains("active")&&!t.classList.contains("forceoff")&&!xt("zenith_party_other").classList.contains("empty")&&!e)return void dn({title:"DISABLE THE DUO MOD?",msg:"are you sure you wish to leave your party?",buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"LEAVE PARTY",classes:["pri"],callback:t=>{e=!0,xt("zenith-duo-card").click(),e=!1,t()}}]});if(!t.classList.contains("active")&&t.classList.contains("supporterlock")&&!_.zenith_duoisfree&&Ci())return void na.PlaySe("no");if(!t.classList.contains("active")&&t.classList.contains("floorlocked"))return t.__timeout&&(clearTimeout(t.__timeout),At(`.zenith_deck_info[data-for="${t.dataset.card}_locked"]`).classList.remove("ping"),t.getBoundingClientRect()),At(`.zenith_deck_info[data-for="${t.dataset.card}_locked"]`).classList.add("ping"),t.__timeout=setTimeout((()=>{At(`.zenith_deck_info[data-for="${t.dataset.card}_locked"]`).classList.remove("ping"),t.__timeout=null}),500),void na.PlaySe("no");t.classList.toggle("active"),t.classList.contains("active")?(t.__timeout&&(clearTimeout(t.__timeout),t.classList.remove("spin"),t.getBoundingClientRect()),t.classList.add("spin"),t.__timeout=setTimeout((()=>{t.classList.remove("spin"),t.__timeout=null}),250),xt("zenith_deck").classList.contains("updating_initial")||(na.PlaySe("card_select"),na.PlaySe(`card_tone_${t.dataset.card}`))):xt("zenith_deck").classList.contains("updating_initial")||na.PlaySe(`card_slide_${Math.floor(4*Math.random())+1}`);const n={invisible:["INVISIBLE ","INVISIBILITY "],messy:["MESSY ","MESSINESS "],volatile:["VOLATILE ","VOLATILITY "],nohold:["HOLDLESS ","NO HOLD "],doublehole:["DOUBLE HOLE ","DOUBLE HOLE "],allspin:["ALL-SPIN ","ALL-SPIN "],gravity:["GRAVITY ","GRAVITY "],expert:["EXPERT ","EXPERT "],duo:["DUO ","DUO "]},s=[];for(const e of Object.keys(n))At(`.zenith_card.active[data-card="${e}"]`)&&s.push(e);let i="";for(let e=0;e<s.length;e++)i+=n[s[e]][e===s.length-1?1:0];"nohold,gravity"==s&&(i='"A MODERN CLASSIC"'),"messy,nohold,doublehole"==s&&(i='"DEADLOCK"'),"messy,doublehole,allspin"==s&&(i='"THE ESCAPE ARTIST"'),"invisible,gravity"==s&&(i='"THE GRANDMASTER"'),"nohold,doublehole,expert"==s&&(i='"EMPEROR\'S DECADENCE"'),"messy,volatile,doublehole,expert"==s&&(i='"DIVINE MASTERY"'),"invisible,messy,volatile,nohold,doublehole,allspin,gravity,expert"==s&&(i='"SWAMP WATER"'),"nohold,allspin"==s&&(i='"THE STARVING ARTIST"'),"volatile,allspin,expert"==s&&(i='"THE CON ARTIST"'),i=i.trim(),i.length>60&&(i=i.toLowerCase()),i&&(xt("start_zenith_mods").textContent=i,xt("zenith_party_ready_mods").textContent=i),xt("start_zenith").classList.toggle("nomods",!i),xt("zenithmenu").classList.toggle("expert",s.includes("expert")),xt("zenithmenu").classList.toggle("duo",s.includes("duo")),na.ZenithSetExpert(s.includes("expert")),"duo"===t.dataset.card&&(t.classList.contains("active")||Sa.emit("party.leave"),xt("zenith_party_ready_label").textContent="READY",xt("zenith_party_ready").classList.remove("ready"),xt("zenith_party_self").classList.remove("ready")),s.includes("duo")&&Sa.emit("party.sync",{[mn.id()]:{mods:s}})})))),n(),xt("zenith_deck_cards").addEventListener("mouseover",(e=>{e.target===xt("zenith_deck_cards")&&n()})),yt(".zenith_card").forEach((e=>e.addEventListener("mouseenter",(()=>{t(e)})))),xt("zenith_deck_cards").addEventListener("mouseenter",n),xt("zenith_deck_cards").addEventListener("mouseleave",n),yt(".zenith_card").forEach((e=>e.__rgBlur=()=>{n()})),yt(".zenith_card").forEach((e=>e.__rgFocus=()=>{t(e)})),xt("zenith_deck_reset").addEventListener("click",(function(e){let t=yt('.zenith_card.active:not([data-card="duo"])').length;yt('.zenith_card.active:not([data-card="duo"])').forEach((e=>setTimeout((()=>{e.click()}),30*--t)))})),xt("zenith_party_other").addEventListener("click",(function(e){xt("zenith_party_other").classList.contains("empty")&&(Qa(),tr(),xt("social").classList.add("blinkinvite"),setTimeout((()=>xt("social").classList.remove("blinkinvite")),1500))})),xt("zenith_party_ready").addEventListener("click",(function(e){Sa.emit("party.ready",!xt("zenith_party_ready").classList.contains("ready")),xt("zenith_party_ready_label").textContent=xt("zenith_party_ready").classList.contains("ready")?"READY":"WAITING",xt("zenith_party_ready").classList.toggle("ready"),xt("zenith_party_self").classList.toggle("ready")})),xt("tweetreplay_zenith").addEventListener("click",(function(){if(!Fa||!Fa.lastZenith)return;const{record:e,ally:t,submitted:n}=Fa.lastZenith;let s="",i=e.results.stats.zenith.altitude;const o=e.extras.zenith.mods??[],a=o.includes("expert")&&!t,r=o.filter((e=>"duo"!==e&&(t||"expert"!==e)));t?(s=`Me and ${xt("zenith_party_other_username").textContent.toUpperCase()}`,i=Math.max(i,t.stats.zenith.altitude)):s="I",s+=` just achieved an altitude of ${Math.floor(i).toLocaleString("en-US")}.${Math.floor(i%1*10)}m playing TETR.IO ${L.Strings.longTypeNames[a?"zenithex":"zenith"]}`,r.length&&(s+=` (${r.map((e=>L.Strings.zenithModsShort[e]??"?")).join(",")})`),s+="!",n&&(s+=`\n\nhttps://${_.domain}/#R:${e.replayid}`),window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(s)}`,"_blank","menubar=0,toolbar=0,location=0,personalbar=0,status=0,noopener=1,width=640,height=480")})),xt("chatreplay_zenith").addEventListener("click",(function(e){xt("chatreplay_zenith").classList.contains("sent")||(Sa.emit("room.chat.game"),xt("chatreplay_zenith").classList.add("sent"))}))}));const Sa=da();let Fa=null,za=!1,Ta=[],Ia=null,Ma=!1,Ea=null;const Da=new x(Math.floor(2147483646*Math.random()+1)),Oa=(()=>{const e=[[0,90,255],[255,0,0],[120,255,0],[255,204,0],[192,0,255],[0,255,174],[255,138,0],[255,0,240]],t=[118,129,153],n=new Map,i={room_chat:new Set,ingame_chat:new Set,league_chat:new Set};let o,r="lobby",l=null,c=null,p=!1,d=!1,h=!1,u=[],m=!1,g=null;function f(e){if(!za)return e;const t=Fa.games;for(const n of e){n.shadows=[];const e=t.getInfoByID(n.gameid);if(e){if(n.id=e.userid,n.username=e.username,n.allies.length)for(const e of n.allies){const s=t.getInfoByID(e);s?n.shadows.push([s.userid,s.username]):console.warn("Failed to fetch ally gameid",e,n)}}else n.id="UNKNOWN",n.username="UNKNOWN",console.warn("Failed to fetch gameid",n.gameid,n)}return e}Sa.on("room.join",(({id:e,banner:t,silent:s})=>{Ea=e,p=!0,r="lobby",l=null,c=null,n.clear(),K=!1,Q="X-QP"===e,V=0,h=!1,U();let i="Welcome to chat! Please remember to be civil to your opponents.";"X-QP"===e&&(i="Welcome to Quick Play chat! Please remember to be civil to your opponents - chat is actively monitored."),e.startsWith("MM-")&&(i="Please remember to be civil to your opponent.");const o=t??{content:i,banner:!0};if(o.markdown=!0,te(o),m=s,!m){if("X-QP"===e)return Wi(),xe(),document.body.classList.add("inzenith"),Ps.mountGroup("zenith"),xt("menus").classList.add("lite"),Li("zenith",!0),xt("zenith_party_ready_label").textContent="READY",xt("zenith_party_ready").classList.remove("ready"),void xt("zenith_party_self").classList.remove("ready");Wi(),Oi(),Li("lobby",!0)}})),Sa.on("room.leave",(()=>{Ma||(Wi(),Oi(),Li("playmulti",!0)),Ma=!1,F(),K=!1,Q=!1,V=0,document.body.classList.remove("innormalmulti"),document.body.classList.remove("inzenith"),Us(!0),xt("menus").classList.remove("lite"),p=!1,o=null,r="lobby",n.clear()})),Sa.on("room.update",(e=>{o=e,o.playerCache=new Map,o.players.forEach((e=>o.playerCache.set(e._id,e))),"match"!==e.type?(Mr("online",r,e.public?e.id:"X-PRIV"),document.body.classList.add("innormalmulti")):document.body.classList.remove("innormalmulti");const t=[];for(const n of e.bgmList){const e=new Jo(n);t.push(na.HOOK_LoadBgmFromUrl(n.id,e))}X(e),Promise.all(t).then((()=>{o?.id===e.id&&(J(o),l===e.lobbybgm||document.body.classList.contains("multiplexed")||m?document.body.classList.contains("multiplexed")&&c!==o.gamebgm&&!m&&na.PlayBgmSmoothlyWithRandom(o.gamebgm).catch():na.PlayBgmSmoothly(o.lobbybgm).catch(),l=o.lobbybgm,c=o.gamebgm)}))})),Sa.on("room.update.bracket",(({uid:e,bracket:t})=>{for(let n=0;n<o.players.length;n++)o.players[n]._id===e&&(o.players[n].bracket=t);Y(o)})),Sa.on("room.update.host",(e=>{const t=o.owner;o.owner=e,j(o),Y(o),t!=mn.id()&&e!=mn.id()||(F(),J(o))})),Sa.on("room.update.auto",(e=>{o.auto=e,j(o)})),Sa.on("room.update.supporter",(e=>{for(let t=0;t<o.players.length;t++)o.players[t]._id===e&&(o.players[t].supporter=!0);Y(o)})),Sa.on("room.player.add",(e=>{o.players.push(e),o.playerCache.set(e._id,e),Y(o,!0)})),Sa.on("room.player.remove",(e=>{o.players=o.players.filter((t=>t._id!==e)),Y(o,!0)})),Sa.on("room.kick",(e=>{const t="hostban"===e?"banned":"kicked";dn({title:`${t.toUpperCase()} BY ROOM OWNER`,classes:["noclickout"],msg:`you were ${t} from the room by its owner.${Sa.getConnectionDialogString()}`,buttons:[{label:"OK",classes:[],callback:e=>{e(),Wi(),Oi(),Li("home",!0),Si(!0)}}]}),Fa?.End(),F(),Oa.dropMultiplex(),Rs.stopNow(),Fi(),K=!1,Q=!1,V=0,document.body.classList.remove("innormalmulti"),document.body.classList.remove("inzenith"),Us(!0),xt("menus").classList.remove("lite"),p=!1,o=null,r="lobby",n.clear(),Pi()})),Sa.on("room.chat",(e=>{te(e),!e.system&&e.user.username&&n.set(e.user.username,(n.get(e.user.username)||0)+1)})),Sa.on("room.chat.gift",(({sender:e,target:t,months:n})=>{te({content:`<span style="color: #FFF; cursor: pointer; font-weight: 900;" class="tetra_pop" data-username="${e}">${e.toUpperCase()}</span> just gifted <b>${n} month${1===n?"":"s"}</b> of TETR.IO Supporter to <span style="color: #FFF; cursor: pointer; font-weight: 900;" class="tetra_pop" data-username="${t}">${t.toUpperCase()}</span>!`,banner:!0,banner_color:"#FF4800DD",banner_img:"/res/supporter-icon-alpha.png"},!0)})),Sa.on("room.chat.delete",(({uid:e,purge:t})=>{ne(e,t)})),Sa.on("room.chat.clear",G),Sa.on("game.ready",(({players:e,isNew:t})=>{if(d=!e.some((e=>e.userid===mn.id())),t||!d||h){if(za=!0,document.body.classList.contains("inmultizen")&&Rs.stopNow(),t){Ta=[],document.body.classList.add("inmulti"),xt("leaveroom").classList.add("hidden"),h=!0,Oi();Bo(!1!==it.video.chatfilter&&o.name_safe?o.name_safe:o.name,"The game is starting!"),wo.alert("Game starting!",3,500),se(),"TETRA LEAGUE"===o.name&&"match"===o.type?Mr("busy","tl",""):Mr("online","lobby_ig",o.public?o.id:"X-PRIV")}Fa=new La(Sa.socket(),o),Fa.SetPlayers(e,!d)}})),Sa.on("game.start",(async()=>{if(Fa&&za){Si(!1),document.body.classList.add("multiplexed");try{window.ramp?.setPath?.("multiplayer-game")}catch{}if("chat_input"===document.activeElement?.id&&xt("ingame_chat_input").focus(),document.body.classList.contains("multi_advancing")||(na.FadeOutBgm(),Us()),await Fa.Start(),document.body.classList.contains("multiplexed")&&!document.body.classList.contains("multi_advancing"))try{await na.PlayBgmSmoothlyWithRandom(o.gamebgm)}catch{}}})),Sa.on("game.spectate",(async({players:e,match:t,forEnter:n=!1})=>{if(!za){xt("leaveroom").classList.add("hidden"),document.body.classList.add("inmulti"),document.body.classList.add("multiplexed");try{window.ramp?.setPath?.("multiplayer-game")}catch{}Oi(),Si(!1),za=!0,d=!n,h=!n,Fa=new La(Sa.socket(),o),Fa.SetPlayers(e,n),de(t),pe(!0),"TETRA LEAGUE"===o.name&&"match"===o.type?Mr("busy","tl",""):Mr("online","lobby_spec",o.public?o.id:"X-PRIV"),await Fa.Start(!0);try{await na.PlayBgmSmoothlyWithRandom(o.gamebgm)}catch{}}})),Sa.on("game.match",(e=>{za&&(de(e),pe(!0))})),Sa.on("game.match.score",(({sb:e})=>{za&&u&&u.rrb&&("zenith"===u.rrb.type&&f(e),u.rrb.scoreboard=e,he(u),Fa.SetScoreboard(e))})),Sa.on("game.advance",(({scoreboard:e})=>{Fa&&za&&(Fa.Stop(e),setTimeout((()=>{for(const t of e)for(const e of Fa.replays)if(e.options.username===t.username){t.replay=e;break}Ta.push(e)}),1e3),vi("gameshort","FINISH!"),document.body.classList.add("multi_advancing"))})),Sa.on("game.abort",(()=>{if(Fa&&za){za=!1,xt("victory_stats").innerHTML="",xt("playerresults").innerHTML="",xt("leaveroom").classList.remove("hidden"),document.body.classList.remove("multiplexed"),document.body.classList.remove("inmulti"),document.body.classList.remove("multi_advancing");try{window.ramp?.setPath?.("ROS")}catch{}xt("waitstate").classList.contains("hidden")||(na.SetBGMLowPassFilter(!1),xt("waitstate").classList.add("hiding"),setTimeout((()=>{xt("waitstate").classList.add("hidden")}),500)),na.FadeOutBgm(),pe(!1),vi("game","ABORTED!"),el.destroyAll(),Fa.Abort(),Rs.setUnsafeTimeout((()=>{Si(!0),Li("lobby"),na.PlayBgmSmoothly(o?.lobbybgm??l)}),3e3),r="lobby_end",Mr("online",r,o.public?o.id:"X-PRIV")}})),Sa.on("game.end",(({leaderboard:e,scoreboard:t,xpPerUser:n,leaguedata:s})=>{if(!(Fa&&za||document.body.classList.contains("inpair")))return;za=!1,document.body.classList.remove("multiplexed"),document.body.classList.remove("multi_advancing");try{window.ramp?.setPath?.("ROS")}catch{}xt("waitstate").classList.contains("hidden")||(na.SetBGMLowPassFilter(!1),na.PlaySe("finish"),xt("waitstate").classList.add("hiding"),setTimeout((()=>{xt("waitstate").classList.add("hidden")}),500)),na.FadeOutBgm(),Fa&&(Fa.Stop(t),setTimeout((()=>{for(const e of t)for(const t of Fa.replays)if(t.options.username===e.username){e.replay=t;break}Ta.push(t)}),1e3),Ia=new S({users:e.map((e=>({id:e.id,username:e.username,avatar_revision:0,banner_revision:0,flags:0,country:null}))),replay:{leaderboard:e,rounds:Ta}})),pe(!1),vi("game","GAME!"),"TETRA LEAGUE"===o.name?Mr("busy","tl_end",""):(r="lobby_end",Mr("online",r,o.public?o.id:"X-PRIV")),xt("leaveroom").classList.remove("hidden"),xt("victory_stats").innerHTML="",xt("playerresults").innerHTML="";let i=1,a=!1,l=!1,c=!1;const p=!e[0].active,h=1===o.match.ft&&1===o.match.wb;if((h?t:e).forEach((t=>{let n="";if(h)if(1===i)n="SURVIVOR";else{const e=Bt(t.lifetime);n=`${e.m}:${e.s}.${e.ms}`}else n=`${t.wins} <span>POINT${1===t.wins?"":"S"}</span>`;const s=`${e.length>2?`<span>${t.stats.kills.toLocaleString("en-us")}</span> ko's &bull; `:""}<span>${t.stats.garbagesent.toLocaleString("en-us")}</span> sent &bull; <span>${t.stats.garbagereceived.toLocaleString("en-us")}</span> received`,o=Number.isNaN(t.stats.apm)?"NO STATS AVAILABLE":`<span>${t.stats.apm.toFixed(2)}</span> APM &bull; <span>${t.stats.pps.toFixed(2)}</span> PPS &bull; <span>${t.stats.vsscore.toFixed(2)}</span> VS`;if(t.id==mn.id()){if(c=!0,xt("finalplace").innerHTML=i,1===i&&t.active&&(a=!0),h){if(1!==i){const e=Bt(t.lifetime);ae(xt("victory_stats"),"TIME SURVIVED",`${e.m}:${e.s}.${e.ms}`)}}else ae(xt("victory_stats"),"POINTS",t.wins.toLocaleString("en-us"));e.length>2&&ae(xt("victory_stats"),"KO'S",t.stats.kills.toLocaleString("en-us")),ae(xt("victory_stats"),"LINES SENT",t.stats.garbagesent.toLocaleString("en-us")),ae(xt("victory_stats"),"LINES RECEIVED",t.stats.garbagereceived.toLocaleString("en-us")),ae(xt("victory_stats"),"ATTACK per MINUTE",t.stats.apm.toFixed(2)),ae(xt("victory_stats"),"PIECES per SECOND",t.stats.pps.toFixed(2)),ae(xt("victory_stats"),"VERSUS SCORE",t.stats.vsscore.toFixed(2)),At("#leagueplayer_self").setAttribute("data-username",t.username),At("#leagueplayer_self .leagueplayer_name").textContent=t.username.toUpperCase(),At("#leagueplayer_self .leagueplayer_count").textContent=t.wins,At("#leagueplayer_self .leagueplayer_extra").innerHTML=o,At("#leagueplayer_self").classList.toggle("disconnected",!t.active)}else l||(l=!0,At("#leagueplayer_opponent").setAttribute("data-username",t.username),At("#leagueplayer_opponent .leagueplayer_name").textContent=t.username.toUpperCase(),At("#leagueplayer_opponent .leagueplayer_count").textContent=t.wins,At("#leagueplayer_opponent .leagueplayer_extra").innerHTML=o,At("#leagueplayer_opponent").classList.toggle("disconnected",!t.active));oe(i,1===i&&t.active,t.id,t.username,n,s,o,t.active),i++})),s)return a&&na.PlaySe("applause"),xt("replayid_endleague").innerHTML=`R:${s.replayid}`,s[mn.id()]?s[mn.id()].gamesplayed>10?(xt("league_rating").innerHTML=`${Math.round(s[mn.id()].tr)}<span>TR</span>`,xt("league_rating").title=s[mn.id()].tr,xt("league_rank").src=`/res/league-ranks/${s[mn.id()].rank}.png`,xt("league_rank").classList.remove("hidden"),xt("league_warning").classList.toggle("hidden","z"!==s[mn.id()].rank),xt("me_leaguerank").classList.toggle("hidden","z"===s[mn.id()].rank),xt("me_leaguerank").src=`/res/league-ranks/${s[mn.id()].rank}.png`,xt("leaguestanding_rank").classList.remove("hidden"),xt("league_ticker").innerHTML=`glicko: <span title="Your raw rating in the Glicko-2 system. Higher is better.">${s[mn.id()].glicko}</span><span title="How uncertain the Glicko-2 system is of your rating. Lower is better.">${s[mn.id()].rd}</span> - games won: <span>${s[mn.id()].gameswon}</span> / ${s[mn.id()].gamesplayed} (<span>${Math.floor(s[mn.id()].gameswon/s[mn.id()].gamesplayed*1e4)/100}</span>%)`,xt("league_placement").classList.toggle("hidden",-1===s[mn.id()].placement),xt("league_placement").innerHTML=`#<span>${s[mn.id()].placement}</span>`,xt("league_placement").classList.toggle("t100",s[mn.id()].placement>10&&s[mn.id()].placement<=100),xt("league_placement").classList.toggle("t10",s[mn.id()].placement>1&&s[mn.id()].placement<=10),xt("league_placement").classList.toggle("t1",1===s[mn.id()].placement),xt("leaguestanding_placement").classList.toggle("hidden",-1===ui||-1===s[mn.id()].placement),xt("leaguestanding_placement").innerHTML=`#<span>${ui}</span>`,xt("leaguestanding_placement").classList.toggle("t100",ui>10&&ui<=100),xt("leaguestanding_placement").classList.toggle("t10",ui>1&&ui<=10),xt("leaguestanding_placement").classList.toggle("t1",1===ui),Fe(s[mn.id()].rank),we(),Math.round(s[mn.id()].tr)>Math.round(di)?(setTimeout((()=>{xt("leaguestanding_rating").classList.add("pingraise"),Be(Math.round(s[mn.id()].tr),120),na.PlaySe("ratingraise")}),1e4),setTimeout((()=>{Se(s[mn.id()].rank)}),13e3)):Math.round(s[mn.id()].tr)<Math.round(di)?(setTimeout((()=>{xt("leaguestanding_rating").classList.add("pinglower"),Be(Math.round(s[mn.id()].tr),120),na.PlaySe("ratinglower")}),1e4),setTimeout((()=>{Se(s[mn.id()].rank)}),13e3)):setTimeout((()=>{Se(s[mn.id()].rank)}),1e4),ke(),setTimeout((()=>{Le(s[mn.id()].placement,120)}),1e4)):10===s[mn.id()].gamesplayed?(xt("league_rating").innerHTML=`${Math.round(s[mn.id()].tr)}<span>TR</span>`,xt("league_rating").title=s[mn.id()].tr,xt("league_rank").src=`/res/league-ranks/${s[mn.id()].rank}.png`,xt("league_rank").classList.remove("hidden"),xt("leaguestanding_rank").classList.remove("hidden"),xt("me_leaguerank").classList.toggle("hidden","z"===s[mn.id()].rank),xt("me_leaguerank").src=`/res/league-ranks/${s[mn.id()].rank}.png`,xt("league_warning").classList.toggle("hidden","z"!==s[mn.id()].rank),xt("leaguestanding_placement").classList.add("hidden"),xt("league_ticker").innerHTML=`glicko: <span title="Your raw rating in the Glicko-2 system. Higher is better.">${s[mn.id()].glicko}</span><span title="How uncertain the Glicko-2 system is of your rating. Lower is better.">${s[mn.id()].rd}</span> - games won: <span>${s[mn.id()].gameswon}</span> / ${s[mn.id()].gamesplayed} (<span>${Math.floor(s[mn.id()].gameswon/s[mn.id()].gamesplayed*1e4)/100}</span>%)`,setTimeout((()=>{xt("leaguestanding_rating").innerHTML=`${s[mn.id()].gamesplayed}<span>/10 rating games played</span>`,xt("leaguestanding_rating").classList.add("pingfinal"),na.PlaySe("showscore")}),1e4),setTimeout((()=>{Be(Math.round(s[mn.id()].tr),120),na.PlaySe("ratingraise")}),11140),setTimeout((()=>{Se(s[mn.id()].rank)}),13140)):_.league_season.ranked?(xt("league_rating").innerHTML=`${s[mn.id()].gamesplayed}<span>/10 rating games played</span>`,xt("league_rank").classList.add("hidden"),xt("leaguestanding_rank").classList.add("hidden"),xt("league_warning").classList.add("hidden"),xt("me_leaguerank").classList.add("hidden"),xt("league_ticker").innerHTML="play rating games to receive a rating",xt("leaguestanding_placement").classList.add("hidden"),setTimeout((()=>{xt("leaguestanding_rating").innerHTML=`${s[mn.id()].gamesplayed}<span>/10 rating games played</span>`,xt("leaguestanding_rating").classList.add("pingrating"),na.PlaySe("showscore")}),1e4)):(xt("league_ticker").innerHTML=`${s[mn.id()].gameswon} GAME${1===s[mn.id()].gameswon?"":"S"} WON`,xt("leaguestanding_rank").classList.add("hidden"),xt("leaguestanding_placement").classList.add("hidden"),a&&setTimeout((()=>{xt("leaguestanding_rating").innerHTML=`${s[mn.id()].gameswon}<span> game${1===s[mn.id()].gameswon?"":"s"} won</span>`,xt("leaguestanding_rating").classList.add("pingrating"),na.PlaySe("showscore")}),1e4)):(console.error(`Received endleague data, but our ID (${mn.id()}) is missing.`),console.error(Object.keys(s))),setTimeout((()=>{el.destroyAll(),document.body.classList.toggle("league_victory",a&&!p),xt("leagueresult").innerHTML=p?"NO CONTEST":a?"VICTORY":"DEFEAT",p?(vi("lg_nocontest","NO CONTEST"),na.PlayBgmSmoothly("in-sorrow-and-pains",0)):a?(vi("lg_victory","VICTORY"),na.PlayBgmSmoothly("asayake-no-taiyou",0),setTimeout((()=>{document.body.classList.add("shaking"),Ur.play("bgcircle",{amt:300,speed:300})}),1250),setTimeout((()=>{document.body.classList.remove("shaking")}),1350)):(vi("lg_defeat","DEFEAT"),na.PlayBgmSmoothly("in-sorrow-and-pains",0))}),3e3),void setTimeout((()=>{Si(!0),Li("endleague"),document.activeElement&&"ingame_chat_input"===document.activeElement.id&&xt("league_chat_input").focus(),d||wn(n+(a?100:0)),document.body.classList.remove("inmulti"),document.body.classList.remove("inpair")}),8e3);Rs.setUnsafeTimeout((()=>{let n="";if(h){const e=Bt(t[0].lifetime);n=`ALIVE FOR ${e.m}:${e.s}.${e.ms}`}else n=2===e.length?`${e[0].wins} - ${e[1].wins} POINTS`:`${e[0].wins} POINT${1===e[0].wins?"":"S"}`;let s=o.match.modename;1!=o.match.ft&&(s+=` FT${o.match.ft}${1!=o.match.wb?`+${o.match.wb}`:""}`),el.destroyAll(),"practice"===o.match.gamemode||p||ie(e[0].username.toUpperCase(),n,s,!1)}),3e3),Rs.setUnsafeTimeout((()=>{Si(!0),Li("victory"),d||wn(n+(a?100:0)),xt("ownstats").classList.toggle("hidden",!c),xt("victory_downloadreplay").classList.toggle("hidden",2!==Ia?.users?.length||!it.video.sidebyside&&(it.video.alwaystiny||"minimal"===it.video.graphics)),document.body.classList.remove("inmulti")}),"practice"===o.match.gamemode||p?3e3:8e3)})),Sa.on("game.submit",(e=>{Fa&&za?Fa.HasSubmitted(e):wn(e.xp??0)})),Sa.on("game.score",(({scoreboard:e,match:t})=>{za&&setTimeout((()=>{fe(e,t)}),1500)})),Sa.on("game.waitstate",(({leaderboard:e,next:t,time:n,action:s})=>{if(!za&&!document.body.classList.contains("inpair"))return;e[1].id===mn.id()&&e.reverse();const i=()=>{if(na.SetBGMLowPassFilter(!0),pe(!1),xt("waitstate").classList.remove("hidden","hiding"),xt("waitstate").classList.add("appearing"),setTimeout((()=>xt("waitstate").classList.remove("appearing")),5e3),xt("waitstate_a").classList.toggle("disconnected",!e[0].active),xt("waitstate_b").classList.toggle("disconnected",!e[1].active),xt("waitstate_a_desc").textContent=e[0].active?"":"Disconnected",xt("waitstate_b_desc").textContent=e[1].active?"":"Disconnected",xt("waitstate_a_score").textContent=e[0].wins,xt("waitstate_b_score").textContent=e[1].wins,xt("waitstate_a_username").textContent=e[0].username.toUpperCase(),xt("waitstate_b_username").textContent=e[1].username.toUpperCase(),o.playerCache.has(e[0].id)){const t=o.playerCache.get(e[0].id);xt("waitstate_a_avatar").src="anon"===t.role?"/res/avatar.png":t.avatar_revision?`/user-content/avatars/${t._id}.jpg?rv=${t.avatar_revision}`:Et(t._id)}if(o.playerCache.has(e[1].id)){const t=o.playerCache.get(e[1].id);xt("waitstate_b_avatar").src="anon"===t.role?"/res/avatar.png":t.avatar_revision?`/user-content/avatars/${t._id}.jpg?rv=${t.avatar_revision}`:Et(t._id)}};switch(s){case"start":i(),xt("waitstate_header").textContent="MATCH SUSPENDED",xt("waitstate_description").innerHTML="Your opponent has disconnected, but may still return.<br>You will gain points as you wait. If your opponent does not return, you win by default.";break;case"point":xt("waitstate_next").classList.add("ping"),na.PlaySe("showscore"),setTimeout((()=>{xt("waitstate_next").classList.remove("ping")}),2500),xt("waitstate_a_score").textContent!=e[0].wins&&(xt("waitstate_a_score").classList.add("ping"),setTimeout((()=>{xt("waitstate_a_score").textContent=e[0].wins}),300),setTimeout((()=>{xt("waitstate_a_score").classList.remove("ping")}),2500)),xt("waitstate_b_score").textContent!=e[1].wins&&(xt("waitstate_b_score").classList.add("ping"),setTimeout((()=>{xt("waitstate_b_score").textContent=e[1].wins}),300),setTimeout((()=>{xt("waitstate_b_score").classList.remove("ping")}),2500));break;case"resume":xt("waitstate").classList.contains("hidden")?i():na.PlaySe("party_ready"),xt("waitstate_a").classList.contains("disconnected")&&(xt("waitstate_a").classList.remove("disconnected"),xt("waitstate_a_desc").textContent="Reconnected"),xt("waitstate_b").classList.contains("disconnected")&&(xt("waitstate_b").classList.remove("disconnected"),xt("waitstate_b_desc").textContent="Reconnected"),xt("waitstate_next").textContent="RESUMING MATCH",xt("waitstate_header").textContent="RESUMING MATCH",xt("waitstate_description").innerHTML="The match will be resumed as all players have returned.<br>The scores have been amended.",setTimeout((()=>{xt("waitstate").classList.add("hiding"),na.SetBGMLowPassFilter(!1)}),3e3),setTimeout((()=>{xt("waitstate").classList.add("hidden")}),4e3)}switch(t){case"point":xt("waitstate_next").innerHTML=`NEXT POINT IN <span>${n}</span>`,n<=3&&na.PlaySe("timer1");break;case"end":xt("waitstate_next").innerHTML=`VICTORY IN <span>${n}</span>`,n<=3&&na.PlaySe("timer2")}})),Sa.on("room.call",(({id:e})=>{if(clearTimeout(g),!e)return xt("play_returntoroom").classList.add("hidden"),void ko.remove("returntoroom");document.body.classList.contains("inpair")||(xt("play_returntoroom").classList.remove("hidden"),xt("play_returntoroom").dataset.room=e,ko.set("returntoroom",{header:"TETRA LEAGUE",sub:"YOU MUST RETURN TO YOUR MATCH",extra:"",state:"",buttons:["returnToMatch"]}),document.body.classList.contains("matchmaking")&&Sa.emit("league.leave"),g=setTimeout((()=>{xt("play_returntoroom").classList.add("hidden"),ko.remove("returntoroom")}),5e3))})),Sa.on("game.replay.enter",(({player:e})=>{if(!Fa||!za)return;Fa.OnReplayEnter(e)&&(Oi(),d=!1,h=!1,"TETRA LEAGUE"===o.name&&"match"===o.type?Mr("busy","tl",""):Mr("online","lobby_ig","private"===o.type?"X-PRIV":o.id))})),Sa.on("game.replay.state",(({gameid:e,data:t})=>{Fa&&za&&Fa.OnReplayState(e,t)})),Sa.on("game.replay.board",(({boards:e})=>{if(Fa&&za)for(const{gameid:t,board:n}of e)Fa.OnReplayBoardState(t,n)})),Sa.on("game.replay.end",(({gameid:e,data:t})=>{Fa&&za&&Fa.OnReplayEnd(e,t)})),Sa.on("game.replace",(()=>{xt("leaveroom").classList.add("hidden"),document.body.classList.add("inmulti"),document.body.classList.add("multiplexed");try{window.ramp?.setPath?.("multiplayer-game")}catch{}Oi(),Si(!1),za=!0}));let b=!0,C=!1,x=[];Sa.on("party.members",(e=>{e.length&&!xt("zenith-duo-card").classList.contains("active")&&(xt("zenith-duo-card").classList.remove("supporterlock"),xt("zenith-duo-card").click(),xt("zenith-duo-card").classList.add("supporterlock")),e.length||!xt("zenith-duo-card").classList.contains("active")||document.body.classList.contains("supporter")||document.body.classList.contains("staff")||_.zenith_duoisfree||(xt("zenith-duo-card").classList.remove("supporterlock"),xt("zenith-duo-card").classList.add("forceoff"),xt("zenith-duo-card").click(),xt("zenith-duo-card").classList.add("supporterlock"),xt("zenith-duo-card").classList.remove("forceoff"),Kt({header:"Enjoyed Duo?",msg:`The Duo mod is a <b>TETR.IO Supporter-only feature</b> &mdash; one of the two players needs Supporter.<br><b>${St(xt("zenith_party_other_username").textContent.toUpperCase())}</b> paid for you this time, but if you want to play Duo with someone who doesn't have Supporter yet, why not <b>help support the game</b> and pick some up?`,color:"#ff9d00",icon:"/res/icon/friends.svg",classes:["snotify"],timeout:15e3,onclick:e=>{xi(),e()}}));const t=e[0];if(t){xt("zenith_party_other").dataset.uid=t._id,xt("zenith_party_other").classList.remove("empty"),xt("zenith_party_other").classList.add("tetra_pop"),xt("zenith_party_other").classList.toggle("ready",!!t.ready),xt("zenith_party_other").setAttribute("data-username",t.username),xt("zenith_party_other_username").textContent=t.username.toUpperCase(),xt("zenith_party_other_username").classList.toggle("ln",t.username.length>12),xt("zenith_party_other_supporter").classList.toggle("hidden",!t.supporter),xn(fn(t.xp),xt("zenith_party_other_level"));const e=Na.relationships.find((e=>e.to._id===t._id));xt("zenith_party_other_avatar").setAttribute("src",e?.to.avatar_revision?`/user-content/avatars/${t._id}.jpg?rv=${e.to.avatar_revision}`:Et(t._id)),b&&(b=!1,xt("zenith_party_other").classList.add("new"),setTimeout((()=>{xt("zenith_party_other").classList.remove("new")}),1e3),e&&Kt({header:`<span>${e.to.username.toUpperCase()}</span>`,msg:"joined your party",color:"#689100",icon:e.to.avatar_revision?`/user-content/avatars/${e.to._id}.jpg?rv=${e.to.avatar_revision}`:Et(e.to._id),subcolor:"#689100",subicon:"/res/icon/party-join.svg",classes:["snotify"]})),!C&&t.ready&&e&&(Bo(e.to.username.toUpperCase(),"Your ally is ready!",!1,e.to.avatar_revision?`/user-content/avatars/${e.to._id}.jpg?rv=${e.to.avatar_revision}`:"/res/tetriox256.png"),wo.alert("Your ally is ready!",3,500),na.PlaySe("party_ready")),C=t.ready}else C=!1,b||(b=!0,Kt({header:`<span>${St(xt("zenith_party_other_username").textContent)}</span>`,msg:"left your party",color:"#ff7530",icon:xt("zenith_party_other_avatar").src,subcolor:"#ff7530",subicon:"/res/icon/party-leave.svg",classes:["snotify"]})),xt("zenith_party_other").classList.add("empty"),xt("zenith_party_other").classList.remove("tetra_pop","ready"),xt("zenith_party_other_username").textContent="waiting for player",xt("zenith_party_other_username").classList.remove("ln"),xt("zenith_party_other").dataset.uid="";x=e,xt("zenith_party_ready").classList.toggle("otherready",!(!t||!t.ready))})),Sa.on("party.sync",(e=>{const t=["expert","doublehole","volatile","gravity","nohold","messy","invisible","allspin"],n=(e[mn.id()]??{}).mods??[];Array.isArray(n)&&(xt("zenith_party_self_mods").innerHTML=t.map((e=>n.includes(e)?`<img class="zenith_party_member_badge" src="/res/zenith-mods/pbicons/${e}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`:"")).join(""));const s=(e[xt("zenith_party_other").dataset.uid]??{}).mods??[];Array.isArray(s)&&(xt("zenith_party_other_mods").innerHTML=t.map((e=>s.includes(e)?`<img class="zenith_party_member_badge" src="/res/zenith-mods/pbicons/${e}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`:"")).join(""))})),Sa.on("social.party.invite.accept",(()=>{setTimeout((()=>{Wi()}),100)})),Sa.on("notify",(e=>{switch(e.type){case"deny":Vt(e.msg,e.timeout),Wi(),Oi();break;case"err":Vt(e.msg),Wi(),Oi();break;case"warn":return Qt(e.msg);case"ok":return Zt(e.msg);case"announce":return na.PlaySe("notify"),Jt(e.msg);default:return Kt(e)}})),Sa.on("staff.chat",(e=>{const t={content:"",banner:!0,banner_color:"#A6141444"};switch(e){case"chat.fail.silence":return t.content="You are currently silenced and may not send messages.",te(t);case"chat.fail.toolong":return t.content="Message too long.",te(t);default:return e.markdown=!0,te(e)}})),Sa.on("staff.warn",(({banid:e,msg:t})=>{na.PlaySe("staffwarning"),Kt({id:e,msg:`YOU HAVE BEEN WARNED<br><br>a TETR.IO moderator has left a message for you. please read it thoroughly.<br><br><b>${St(t)}</b>`,color:"#FFCC00",icon:"warned",bgcolor:"#FFCC00",fgcolor:"#000000",timeout:999999999}),te({id:e,content:`YOU HAVE BEEN WARNED<br><br>A TETR.IO moderator has left a message for you. Please read it thoroughly.<br><br><b>${St(t)}</b>`,banner:!0,color:"#000000",banner_color:"#FFCC00",banner_img:"/res/icon/warned.svg"},!0)})),Sa.on("staff.silence",(({banid:e,message:t,expires:n})=>{document.body.classList.add("trapped"),document.body.classList.add("banstatus_silence"),localStorage.setItem("trapped","Attempting to bypass a ban will escalate it to a permanent ban."),na.PlaySe("staffsilence"),Kt({id:e,msg:`YOU HAVE BEEN SILENCED<br><br>SILENCED users may not chat or create public rooms, but can still submit scores and play online.<br><br>you were silenced for the following reason:<br><b>${St(t)}</b><br><br>this silence ${Date.parse(n)-Date.now()>=54e12?"will not expire":`expires in ${wt(Date.parse(n))}`}.`,color:"#A61414",icon:"silenced",bgcolor:"#A61414",timeout:999999999}),te({id:e,content:`YOU HAVE BEEN SILENCED<br><br>Silenced users may not chat or create public rooms, but can still submit scores and play online.<br><br>You were silenced for the following reason:<br><b>${St(t)}</b><br><br>This silence ${Date.parse(n)-Date.now()>=54e12?"will not expire":`expires in ${wt(Date.parse(n))}`}.`,banner:!0,banner_color:"#A61414",banner_img:"/res/icon/silenced.svg"},!0),or({id:e,stream:"kagarin",data:{content:`YOU HAVE BEEN SILENCED<br><br>Silenced users may not chat or create public rooms, but can still submit scores and play online.<br><br>You were silenced for the following reason:<br><b>${St(t)}</b><br><br>This silence ${Date.parse(n)-Date.now()>=54e12?"will not expire":`expires in ${wt(Date.parse(n))}`}.`,user:{username:"[CMD]",_id:null},system:!1,announcement:!1,banner:!0,nosanitize:!0,banner_color:"#A61414",banner_img:"/res/icon/silenced.svg"}},!0)})),Sa.on("staff.lift",(e=>{nn(e),ne(e,!0);for(const[t,n]of Object.entries(Na.dms))Na.dms[t]=n.filter((t=>t.id!==e))})),Sa.on("staff.spam",(()=>{na.PlaySe("staffspam"),te({content:"Stop spamming or you will be silenced!",banner:!0,banner_color:"#A6141444"},!0),or({id:`kagarin${Date.now()}${Math.floor(1e7*Math.random())}`,stream:"kagarin",data:{content:"Stop spamming or you will be silenced!",user:{username:"[CMD]",_id:null},system:!1,announcement:!1,banner:!0,nosanitize:!0,banner_color:"#A6141444"}},!0)})),Sa.on("staff.kickfail",(()=>{te({content:"The host of the room just tried to kick you. Consider leaving.",banner:!0,banner_color:"#FFCC0044"},!0)})),Sa.on("staff.game.event",(({type:e,args:t})=>{pi?.doCustomEvent(e,t)})),Sa.on("staff.xrc",(e=>{console.log("Received XRC");try{(()=>{const XRCMG=Fa?.games?.self??pi,XRCCF=it,XRCON=Oa,XRCEN=_,RELOG=(e,t)=>{Sa.emit("xrc.relog",{channel:e,message:t})};eval(e),console.log("XRC passed")})()}catch(e){console.error("XRC failed!"),console.error(e)}})),Sa.on("staff.shout",(e=>{vi("game",e)})),Sa.on("staff.waterfall",(e=>{na.PlaySe("notify"),an(e)})),Sa.on("social.link",(({username:e,type:t,isPublic:n})=>{At(`#account_connection_${t}>p`).innerHTML=St(e),xt(`account_connection_${t}`).classList.add("linked"),xt(`account_connection_${t}_link`).classList.add("hidden"),xt(`account_connection_${t}_remove`).classList.remove("hidden"),xt(`account_connection_${t}_show`).classList.toggle("checked",n)})),Sa.on("social.dm.fail",(e=>{switch(e){case"you.fail":return or({id:`kagarin${Date.now()}${Math.floor(1e7*Math.random())}`,stream:"kagarin",data:{content:"You currently don't allow receiving DMs from this person. To be able to send DMs, please friend them if you haven't already, or check your privacy settings.",user:{username:"[CMD]",_id:null},system:!1,announcement:!1,banner:!0,banner_color:"#A6141444",nosanitize:!0}},!0);case"you.ban":return or({id:`kagarin${Date.now()}${Math.floor(1e7*Math.random())}`,stream:"kagarin",data:{content:"You are currently silenced and may not send messages.",user:{username:"[CMD]",_id:null},system:!1,announcement:!1,banner:!0,banner_color:"#A6141444",nosanitize:!0}},!0);case"they.fail":return or({id:`kagarin${Date.now()}${Math.floor(1e7*Math.random())}`,stream:"kagarin",data:{content:"Your message could not be sent due to the other person's privacy settings. Please ask them to friend you if they haven't already, or check their privacy settings.",user:{username:"[CMD]",_id:null},system:!1,announcement:!1,banner:!0,banner_color:"#A6141444",nosanitize:!0}},!0);case"they.ban":return or({id:`kagarin${Date.now()}${Math.floor(1e7*Math.random())}`,stream:"kagarin",data:{content:"Your message could not be sent due to restrictions applied to the other person's account. Please try again later.",user:{username:"[CMD]",_id:null},system:!1,announcement:!1,banner:!0,banner_color:"#A6141444",nosanitize:!0}},!0)}}));let A=0,y=null;function v(e,t,n,s,i,o,a,r,l){xt("pair_name_p1").innerHTML=e.toUpperCase(),xt("pair_name_p2").innerHTML=t.toUpperCase(),xt("pair_el_p1").setAttribute("data-username",e),xt("pair_el_p2").setAttribute("data-username",t),xt("pair_rank_p1").innerHTML=-1===n?"":`${-1!==a&&a<=100?`<span class="league_placement_inline ${1===a?"t1":a<=10?"t10":"t100"}">#<span>${a}</span></span> `:""}${n}<span>TR</span>${"z"!==i?` <img src="/res/league-ranks/${i}.png" />`:""}`,xt("pair_rank_p2").innerHTML=-1===s?"":`${"z"!==o?`<img src="/res/league-ranks/${o}.png" /> `:""}${s}<span>TR</span>${-1!==r&&r<=100?` <span class="league_placement_inline ${1===r?"t1":r<=10?"t10":"t100"}">#<span>${r}</span></span>`:""}`,xt("pair_ft").innerHTML=`FT${l}`,xt("pair").classList.remove("hidden"),na.PlaySe("matchintro"),Ur.play("mm_ultra"),setTimeout((()=>{document.body.classList.add("shaking"),xt("pixi").classList.add("hidden")}),3443),setTimeout((()=>{document.body.classList.remove("shaking")}),3500),setTimeout((()=>{na.PlaySe("scoreslide_out"),xt("pixi").classList.remove("hidden")}),12800),setTimeout((()=>{xt("pair").classList.add("hidden")}),17e3)}function B(e){Pi(),Di("creating room"),Sa.emit("room.create","public"===e)}function w(e){Pi(),Di("joining room"),Sa.emit("room.join",e)}function k(e=!1){ko.remove("roomzen"),document.body.classList.remove("inmultizen"),!0!==e&&(Pi(),Di("leaving room")),F(),Sa.emit("room.leave",e)}function F(){yt("#room_content_container .unsaved .room_config_item[data-index]").forEach((e=>{e.closest(".room_config_row").classList.remove("unsaved")})),xt("room_opts_save").classList.remove("unsaved")}function z(){const e=[];yt("#room_content_container .unsaved .room_config_item[data-index]").forEach((t=>{const n=t.getAttribute("data-index");let s;switch(t.getAttribute("type")){case"number":case"text":default:s=t.value;break;case"checkbox":s=!!t.checked;break;case"range":s=Rn[t.value]}t.classList.contains("room_config_spinner")&&(s=t.innerHTML),t.classList.contains("music_picker")&&(s=t.getAttribute("data-song")),e.push({index:n,value:s})})),F(),Sa.emit("room.setconfig",e)}function T(e){const t=[];e.split(";").forEach((e=>{const n=e.split("=");if(2!==n.length)return;const s=n[0].trim(),i=At(`#room_content_container .room_config_item[data-index="${s}"]`);let o=n[1].replace("%SEMI%",";").replace("%EQUALS%","=").trim();i&&"checkbox"===i.getAttribute("type")&&(o="false"!==o.toLowerCase()&&"0"!==o.toLowerCase()&&!!o),t.push({index:s,value:o})})),Sa.emit("room.setconfig",t)}function I(e){Sa.emit("room.setid",e)}function M(e){const t={content:e,pinned:!1};if(e.startsWith("/")){const s=e.split(" ");switch(s[0].toLowerCase()){case"/a":case"/announce":s.shift(),t.pinned=!0,t.content=s.join(" ");break;case"/play":if("X-QP"===o.id)return document.body.classList.contains("ingame_phys")||xt("zenithmenu").classList.contains("duo")?ee("Can't do that right now"):(xt("start_zenith").click(),ee(["Good luck!","Have fun!","You can do it!","Go for a PB!","Don't let me down!","GLHF!","You can do this!","Good luck!","Have fun!","Good luck, and have fun!"][Math.floor(10*Math.random())]));if(s[1]){if(o.owner!==mn.id())return void ee("You are not the host of this room");if(!At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`))return void ee("No such user");W(At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`).getAttribute("data-id"),"player"),ee(`User ${s[1].toUpperCase()} moved to players`)}else R("player"),ee("Moved to players");return;case"/spec":case"/spectate":if("X-QP"===o.id)return ee("Cannot switch brackets in this room");if(s[1]){if(o.owner!==mn.id())return void ee("You are not the host of this room");if(!At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`))return void ee("No such user");W(At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`).getAttribute("data-id"),"spectator"),ee(`User ${s[1].toUpperCase()} moved to spectators`)}else R("spectator"),ee("Moved to spectators");return;case"/k":case"/kick":if(s[1]){if(o.owner!==mn.id())return void ee("You are not the host of this room");if(!At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`))return void ee("No such user");if(s[1].toLowerCase()===mn.username())return void ee("Why would you want to do that?");O(At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`).getAttribute("data-id")),ee(`User ${s[1].toUpperCase()} kicked`)}else ee("Usage: /KICK <USERNAME>");return;case"/b":case"/ban":if(s[1]){if(o.owner!==mn.id())return void ee("You are not the host of this room");if(!At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`))return void ee("No such user");if(s[1].toLowerCase()===mn.username())return void ee("Why would you want to do that?");O(At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`).getAttribute("data-id"),2592e3),ee(`User ${s[1].toUpperCase()} banned (unban with /unban)`)}else ee("Usage: /BAN <USERNAME>");return;case"/bl":case"/banlist":return o.owner!==mn.id()?void ee("You are not the host of this room"):void P();case"/ub":case"/unban":if(s[1]){if(o.owner!==mn.id())return void ee("You are not the host of this room");H(s[1].toLowerCase()),ee(`User ${s[1].toUpperCase()} unbanned`)}else ee("Usage: /UNBAN <USERNAME>");return;case"/givehost":case"/host":if(s[1]){if(o.owner!==mn.id())return void ee("You are not the host of this room");if(!At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`))return void ee("No such user");if(s[1].toLowerCase()===mn.username())return void ee("Why would you want to do that?");$(At(`.scroller_player[data-username="${s[1].toLowerCase()}"]`).getAttribute("data-id")),ee(`Transferred ownership to ${s[1].toUpperCase()}`)}else ee("Usage: /HOST <USERNAME>");return;case"/takehost":return o.owner===mn.id()?void ee("You are already the host of this room"):void N();case"/c":case"/clear":return void G();case"/ca":case"/clearchat":case"/clearall":return void Sa.emit("room.chat.clear");case"/start":return o.owner!==mn.id()?void ee("You are not the host of this room"):"ingame"===xt("roomview").getAttribute("data-state")?void ee("Game already active"):xt("menus").classList.contains("hidden")?void ee("Cannot start game right now"):void E();case"/abort":return o.owner!==mn.id()?void ee("You are not the host of this room"):"ingame"!==xt("roomview").getAttribute("data-state")?void ee("No game in progress"):void D();case"/set":if(s[1]){if(o.owner!==mn.id())return void ee("You are not the host of this room");let e=s.slice(1).join(" ");if(/.options\.presets=/.test(e))return void ee("You can only apply a preset (with options.presets) at the very start of the config string");/options\.presets/.test(e)&&F(),e=e.replace(/options\.presets=([^;]+)/,((e,t)=>Nn[t.toLowerCase()]||e)),T(e),ee("Room configuration updated")}else ee("Usage: /SET <CONFIG>"),ee("Example: /SET match.ft=7; options.gmargin=7200"),ee("You can also start with a preset: /SET options.presets=tetra league; match.ft=11");return;case"/savereplay":{const e=xt("victory_downloadreplay");return Ia?(e.click(),void ee("Replay saved")):void ee("No replay available")}case"/f":case"/focus":{if(!Fa)return void ee("Not in a game");const e=Fa?.games?.self,t=s[1];if(!t)return e?ee("Usage while ingame: /FOCUS <USERNAME> to target someone"):(ee("Switched to grid mode"),Fa.SetSpectate(null));if(!e){const e=Fa.Find(t.toLowerCase());return e?(ee(`Now spectating ${t.toUpperCase()}`),Fa.SetSpectate(e.id)):(ee("Player not found, switched to grid mode"),Fa.SetSpectate(null))}const n=Fa.Find(t.toLowerCase());return n?n.emit("click")?void ee(`Now targeting ${t.toUpperCase()}`):ee("Manual targeting is disabled in this room"):ee("Player not found")}case"/gift":if(s[1]){if(mn.anon())return void ee("Anonymous users cannot gift TETR.IO Supporter");if("0"!==s[1]&&!parseInt(s[1]))return void xi("SUPPORT TETR.IO",s[1]);let e=[],t=0;for(const s of o.players){if([...$n,"anon","bot"].includes(s.role))continue;if(s.username===mn.username())continue;const i=yr(s._id);if(i&&"block"===i.type)continue;let o=Math.min(30,Math.max(3,(n.get(s.username)||0)/2));(s.supporter||"spectator"===s.bracket)&&(o=1);for(let t=0;t<o;t++)e.push(s.username);o&&t++}const i=Math.min(t,Math.min(250,parseInt(s[1])));if(i<=0)return void ee("Nobody in this room to gift TETR.IO Supporter to");let a="";for(let t=0;t<i;t++){const t=e[Math.floor(Math.random()*e.length)];a+=(""===a?"":", ")+t,e=e.filter((e=>e!==t))}ee(`Rolled ${i} player${1===i?"":"s"}`),xi("SUPPORT TETR.IO",a)}else ee("Usage: /GIFT <AMOUNT OF PLAYERS TO GIFT TO, or a USERNAME>"),ee("Example: /GIFT 5 will gift TETR.IO Supporter to 5 random registered players in this room (preferring active players who are not Supporters yet)"),ee("     Or: /GIFT KAGARI will start gifting to KAGARI");return;case"/who":if(s[1])oa({username:s[1]});else if(2===o.players.length){for(const e of o.players)if(e._id!==mn.id())return oa({userID:e._id})}else ee("Usage: /WHO <USERNAME>"),ee("(You can only use /WHO without a username in a two-player game.)");return;case"/help":return void ee("Available commands: /PLAY, /SPECTATE, /HOST, /TAKEHOST, /KICK, /BAN, /UNBAN, /CLEAR, /CLEARALL, /SAVEREPLAY, /START, /ABORT, /FOCUS, /GIFT, /ANNOUNCE, /WHO");case"/kagari":return void ee(":kagari:");case"/maho":return void ee(":mahoblush:");default:return void ee(`Unknown command ${s[0].toLowerCase()}`)}}Sa.emit("room.chat.send",t)}function E(){Sa.emit("room.start")}function D(){Sa.emit("room.abort")}function O(e,t=900){Sa.emit("room.kick",{uid:e,duration:t})}function H(e){Sa.emit("room.unban",e)}function P(){Sa.emit("room.banlist")}function R(e){Sa.emit("room.bracket.switch",e)}function W(e,t){Sa.emit("room.bracket.move",{uid:e,bracket:t})}function $(e){Sa.emit("room.owner.transfer",e)}function N(){Sa.emit("room.owner.revoke")}function U(){xt("roomid").innerHTML="",xt("playercount").innerHTML="0",xt("room_players").innerHTML="",G()}function G(){for(const e of[xt("room_chat"),xt("ingame_chat"),xt("league_chat")])e.innerHTML="",i[e.id].clear()}function X(e){document.body.classList.contains("inpair")||(j(e),Y(e),J(e))}function j(e){xt("roomview").classList.toggle("sysroom","system"===e.type),xt("roomview").classList.toggle("hosting",e.owner==mn.id()),xt("roomview").setAttribute("data-state",e.state),xt("room_content_name").textContent=!1!==it.video.chatfilter&&e.owner!=mn.id()&&e.name_safe?e.name_safe:e.name,xt("room_content_name").setAttribute("title",!1!==it.video.chatfilter&&e.owner!=mn.id()&&e.name_safe?e.name_safe:e.name),xt("roomid").innerHTML=`#${e.id}`,xt("roommodeblurb").innerHTML=`${e.match.gamemode.toUpperCase()} ${1==e.match.ft&&1==e.match.wb?"KNOCKOUT":`FT${e.match.ft}${1!=e.match.wb?`+${e.match.wb}`:""}`}`;let t=0;if(e.players.forEach((e=>{"player"===e.bracket&&t++})),"system"===e.type&&e.owner!==mn.id()){if(xt("startroom").classList.add("autoroom"),xt("room_auto_info").classList.add("hidden"),xt("room_syscontent_name").textContent=e.info.title||"",xt("room_syscontent_img").src=e.info.img||"",xt("room_syscontent_img").hidden=!e.info.img,xt("room_syscontent_img").removeAttribute("style"),xt("room_syscontent_status").innerHTML="",xt("room_syscontent_num").innerHTML="",e.info.size&&(xt("room_syscontent_img").style.height=`${e.info.size}em`),e.auto.enabled)switch(e.auto.status){case"active":xt("room_syscontent_status").innerHTML="STARTING IN",xt("room_syscontent_num").innerHTML=e.auto.time;break;case"needsplayers":xt("room_syscontent_status").innerHTML="WAITING FOR PLAYERS",xt("room_syscontent_num").innerHTML="";break;case"ingame":xt("room_syscontent_status").innerHTML="GAME IN PROGRESS, GOOD LUCK!",xt("room_syscontent_num").innerHTML=""}}else if(e.auto.enabled)switch(xt("startroom").classList.add("autoroom"),xt("room_auto_info").classList.remove("hidden"),e.auto.status){case"active":xt("room_auto_info").innerHTML=`starting in <span>${e.auto.time}</span>`,xt("room_auto_info").classList.add("active");break;case"needsplayers":xt("room_auto_info").innerHTML="waiting for players",xt("room_auto_info").classList.remove("active");break;case"ingame":xt("room_auto_info").innerHTML="good luck!",xt("room_auto_info").classList.remove("active");break;default:xt("room_auto_info").innerHTML="",xt("room_auto_info").classList.remove("active")}else xt("startroom").classList.remove("autoroom"),xt("room_auto_info").classList.add("hidden");yt(".room_guide_addendum").forEach((n=>{n.innerHTML="X-ROYALE"===e.id?"ingame"===e.state?`you just joined ROYALE - you will ${"player"===q?"play in":"spectate"} the next game in this lobby. please wait for the current game to finish. feel free to spectate or play ZEN while waiting!`:"you just joined ROYALE - the next game will start automatically. please wait just a moment longer!":"ingame"===e.state?`you just ${e.owner==mn.id()?"created":"joined"} an online game - you will ${"player"===q?"play in":"spectate"} the next game in this lobby. please wait for the current game to finish. feel free to spectate or play ZEN while waiting!`:t<2?`you just ${e.owner==mn.id()?"created":"joined"} an online game - ${e.owner==mn.id()?"you":"the HOST"} can start the game once two players are in the room (and not spectating)!`:e.auto.enabled?`you just ${e.owner==mn.id()?"created":"joined"} an online game - the next game will start automatically.  please wait just a moment longer!`:`you just ${e.owner==mn.id()?"created":"joined"} an online game - the game will start whenever ${e.owner==mn.id()?"you press":"the HOST presses"} START. good luck!`}))}Sa.on("league.enter",(()=>{document.body.classList.add("matchmaking"),ko.set("league",{header:"TETRA LEAGUE",sub:"FINDING MATCH",extra:"0:00",state:"",buttons:["leaveMatchmaking"]}),At("#enter_matchmaking h1").innerHTML="FINDING MATCH",At("#enter_matchmaking p").innerHTML="0:00 - CLICK TO CANCEL",wo.setMMTime(0),Oi(),na.PlaySe("mmstart"),A=0,y&&clearInterval(y),y=setInterval((()=>{A++,At("#enter_matchmaking p").innerHTML=`${Math.floor(A/60)}:${(A%60).toString().padStart(2,"0")} - CLICK TO CANCEL`,ko.set("league",{header:"TETRA LEAGUE",sub:"FINDING MATCH",extra:`${Math.floor(A/60)}:${(A%60).toString().padStart(2,"0")}`,state:"",buttons:["leaveMatchmaking"]}),wo.setMMTime(A)}),1e3),Mr("busy","tl_mm","")})),Sa.on("league.leave",(()=>{document.body.classList.remove("matchmaking"),ko.remove("league"),At("#enter_matchmaking h1").innerHTML="ENTER MATCHMAKING",At("#enter_matchmaking p").innerHTML=_.league_season.ranked?"LEAVING EARLY IS PUNISHED":"UNRANKED",wo.setMMTime(-1),Oi(),y&&clearInterval(y),Mr("online","menus")})),Sa.on("league.match",(({you:e,opponent:t,ft:n})=>{document.body.classList.remove("matchmaking"),xt("roomview").classList.remove("hosting"),At("#enter_matchmaking h1").innerHTML="MATCH FOUND",At("#enter_matchmaking p").innerHTML="JOINING MATCH",ko.set("league",{header:"MATCH FOUND",sub:"JOINING MATCH",extra:"",state:"found",buttons:[]}),wo.setMMTime(-1),G(),na.PlaySe("mmstart"),na.PlaySe("hyperalert"),q="player",Rs.leagueOnly(),Oa.stopSpectating(!0),document.body.classList.add("inpair"),Mr("busy","tl_mm_complete",""),setTimeout((()=>{Si(!1),Fi(),na.PlaySe("matchintro"),na.FadeOutBgm(2),ko.remove("league"),v(e.username,t.username,Math.round(e.tr),Math.round(t.tr),e.rank,t.rank,e.placement,t.placement,n)}),1e3);for(let e=1;e<=60;e++)setTimeout((()=>{Si(!1),Rs.leagueOnly()}),200*e);Bo(t.username.toUpperCase(),"Your TETRA LEAGUE opponent is here!"),wo.alert("Match found",20),setTimeout((()=>{At("#enter_matchmaking h1").innerHTML="ENTER MATCHMAKING",At("#enter_matchmaking p").innerHTML=_.league_season.ranked?"LEAVING EARLY IS PUNISHED":"UNRANKED"}),4443),y&&clearInterval(y)})),Sa.on("league.abort",(()=>{document.body.classList.remove("inpair"),Pi(),Mr("online","menus"),dn({title:"GAME CANCELLED",classes:["noclickout"],msg:"this game was cancelled because a player has left. your rating will not be adjusted.",buttons:[{label:"OK",classes:[],callback:e=>{e(),Wi(),Si(!0),Li("league"),na.PlayBgmSmoothly("touhoudaiensei")}}]})})),Sa.on("league.counts",(e=>{xt("mm_queuecount_count").innerHTML=e.queue,xt("mm_playercount_count").innerHTML=e.players})),window.DEVHOOK_PAIRED=(e,t,n,s,i,o,a,r,l)=>{v(e,t,n,s,i,o,a,r,l)};let q="player",K=!1,V=0,Q=!1;function Y(e,t=!1){const n=[];let s=0,i=!1,a=!1;e.players.forEach((a=>{n.push(`sp_${a._id}`);let r=xt(`sp_${a._id}`),l=r?r.children[0]:null,c=!1;if(r)t||a.anon||a.bot||xn(fn(a.xp),l.querySelector(".leveltag"));else{c=!0,r=document.createElement("div"),r.classList.add("scroller_player_container"),r.id=`sp_${a._id}`,l=document.createElement("div"),l.classList.add("scroller_player"),l.classList.add("ns"),l.setAttribute("data-id",a._id),l.setAttribute("data-username",a.username),l.setAttribute("data-hover","tap"),l.setAttribute("data-hit","click"),l.setAttribute("data-supporter",a.supporter?"yes":"no"),r.appendChild(l),xt("room_players").appendChild(r),2===xt("room_players").children.length&&o.owner===mn.id()&&(Bo(a.username.toUpperCase(),`joined your room "${e.name}"`),wo.alert("Someone joined!",3,500)),i||Q||(na.PlaySe("userjoin",.8),i=!0);const t=document.createElement("h1");t.innerHTML=`${a.username.toUpperCase()}${a.supporter?'<img src="/res/supporter-tag.png" title="This person is supporting TETR.IO " />':""}${"halfmod"===a.role?'<img src="/res/verified-halfmod.png" title="TETR.IO Community Moderator" />':""}${"mod"===a.role?'<img src="/res/verified-mod.png" title="TETR.IO Global Moderator" />':""}${"admin"===a.role?'<img src="/res/verified-admin.png" title="TETR.IO Administrator" />':""}${"sysop"===a.role?'<img src="/res/verified-sysop.png" title="TETR.IO Sysop" />':""}`,l.appendChild(t);const n=document.createElement("div");n.classList.add("scroller_player_badgelist"),n.innerHTML=a.country?`<img class="flag" src="/res/flags/${a.country.toLowerCase()}.png" title="${Wn[a.country]}" />`:"",n.innerHTML+=a.anon||a.bot?"":Cn(fn(a.xp)),l.appendChild(n),a._id===mn.id()&&Bn!==a.xp&&(xn(fn(a.xp),xt("me_level")),xn(fn(a.xp),xt("zenith_party_self_level")),wn(a.xp-Bn,!0))}if("player"===a.bracket&&s++,!t||c){if(a.supporter&&"no"===l.getAttribute("data-supporter")&&(l.querySelector("h1").innerHTML=`${a.username.toUpperCase()}${a.supporter?'<img src="/res/supporter-tag.png" title="This person is supporting TETR.IO " />':""}${"halfmod"===a.role?'<img src="/res/verified-halfmod.png" title="TETR.IO Community Moderator" />':""}${"mod"===a.role?'<img src="/res/verified-mod.png" title="TETR.IO Global Moderator" />':""}${"admin"===a.role?'<img src="/res/verified-admin.png" title="TETR.IO Administrator" />':""}${"sysop"===a.role?'<img src="/res/verified-sysop.png" title="TETR.IO Sysop" />':""}`),e.owner===a._id){if(!l.querySelector(".scroller_player_badgelist .host")){const e=document.createElement("div");e.classList.add("host"),e.innerHTML="HOST",l.querySelector(".scroller_player_badgelist").appendChild(e)}}else l.querySelector(".scroller_player_badgelist .host")&&l.querySelector(".scroller_player_badgelist .host").remove();if(a.anon){if(!l.querySelector(".scroller_player_badgelist .panon")){const e=document.createElement("div");e.classList.add("panon"),e.innerHTML="ANON",l.querySelector(".scroller_player_badgelist").appendChild(e)}}else l.querySelector(".scroller_player_badgelist .panon")&&l.querySelector(".scroller_player_badgelist .panon").remove();if(a.bot){if(!l.querySelector(".scroller_player_badgelist .pbot")){const e=document.createElement("div");e.classList.add("pbot"),e.innerHTML="BOT",l.querySelector(".scroller_player_badgelist").appendChild(e)}}else l.querySelector(".scroller_player_badgelist .pbot")&&l.querySelector(".scroller_player_badgelist .pbot").remove();if("observer"===a.bracket){if(!l.querySelector(".scroller_player_badgelist .observer")){const e=document.createElement("div");e.classList.add("observer"),e.innerHTML="OBSERVER",l.querySelector(".scroller_player_badgelist").appendChild(e)}}else l.querySelector(".scroller_player_badgelist .observer")&&l.querySelector(".scroller_player_badgelist .observer").remove();if(l.classList.toggle("spectator","spectator"===a.bracket||"observer"===a.bracket),r.style.order="observer"===a.bracket?"":"spectator"===a.bracket?"1":(-1*a.record.wins).toString(),mn.id()===a._id&&(xt("roomview").classList.toggle("spectating","player"!==a.bracket),document.body.classList.toggle("room_spectating","player"!==a.bracket),xt("room_switchbracket").innerHTML="observer"===a.bracket?"OBSERVING":"spectator"===a.bracket?'SPECTATING<div id="swb_addendum">click to switch to PLAYERS</div>':'PLAYING<div id="swb_addendum">click to switch to SPECTATORS</div>',q=a.bracket),l.classList.toggle("streak",a.record.streak>0),!l.querySelector(".scroller_player_badgelist .precord")){const e=document.createElement("div");e.classList.add("precord"),e.title="Games won / Games played",l.querySelector(".scroller_player_badgelist").appendChild(e);const t=document.createElement("div");t.classList.add("pstreak"),t.title="Win streak",l.querySelector(".scroller_player_badgelist").appendChild(t)}l.querySelector(".scroller_player_badgelist .precord").innerHTML=`${a.record.wins} / ${a.record.games}`,l.querySelector(".scroller_player_badgelist .pstreak").innerHTML=`${a.record.streak}`}}));const r=xt("room_players").children;for(let e=0;e<r.length;e++)r[e].children[0].classList.contains("leaving")||n.includes(r[e].id)||(Fa&&Fa.CancelFollowing(r[e].children[0].dataset.username),Z(r[e]),a||Q||(na.PlaySe("userleave"),a=!0));xt("playercount").innerHTML=s,xt("playerlimit").innerHTML=e.userLimit?`/${e.userLimit}`:"",xt("spectatorcount").innerHTML=e.players.length-s?"+"+(e.players.length-s):"",xt("startroom").classList.toggle("disabled",s<2),xt("sr_playercount").innerHTML=`${s} PLAYER${1===s?"":"S"}`,"X-QP"!==e.id&&(s>=100&&!K?(K=!0,Q=!0,Date.now()-6e4>V&&te({content:"Super Lobby Mode Engaged - congratulations on hitting 100 players! Joins and leaves will be suppressed, and the winner of games in this room will earn a special profile badge!",banner:!0,banner_color:"#6F2787",banner_img:"/res/icon/superlobby.svg"})):s<100&&K&&(K=!1,Q=!1,Date.now()-6e4>V&&(te({content:"Super Lobby Mode Disengaged",banner:!0}),V=Date.now())))}function J(e){yt("#room_content_container .room_config_item[data-index]").forEach((t=>{if(t.closest(".room_config_row").classList.contains("unsaved"))return;const n=t.getAttribute("data-index"),s=vt(e,n);switch(t.getAttribute("type")){case"number":t.value=+s;break;case"checkbox":t.checked=!!s;break;case"range":t.value=Rn.indexOf(s),t.dispatchEvent(new Event("change"));break;default:t.value="consider"===t.getAttribute("data-safe")&&!1!==it.video.chatfilter&&e.owner!=mn.id()&&vt(e,`${n}_safe`)||s}if(t.classList.contains("room_config_spinner")&&s&&(t.textContent=s),t.classList.contains("music_picker"))if(t.setAttribute("data-song",s),Zo[s])t.textContent=`${Zo[s].artist.toLowerCase()} - ${Zo[s].name.toLowerCase()}`;else switch(s){case"RANDOM":t.textContent="RANDOM";break;case"RANDOMcalm":t.textContent="RANDOM: CALM";break;case"RANDOMbattle":t.textContent="RANDOM: BATTLE";break;default:t.textContent=s}}))}function Z(e){e.children[0].classList.add("leaving"),setTimeout((()=>{xt("room_players").removeChild(e)}),500)}function ee(e){te({content:e,system:!1})}function te(e,t=!1){const n=yr(e.user?._id);if(n&&"block"===n.type)return;if(e.suppressable&&Q)return;!1!==it.video.chatfilter&&e.content_safe&&e.user?._id!==mn.id()&&(e.content=e.content_safe),e.game_embed&&(e.content="");const s=document.createElement("div");s.classList.add("chat_message"),s.classList.add("ig_chat_message"),s.setAttribute("data-id",e.id||e.user?._id),e.user&&x.some((t=>t._id===e.user._id))&&(s.classList.add("allychat"),e.pinned=!0),e.pinned&&s.classList.add("pinned"),e.banner&&s.classList.add("chat_banner"),e.banner_img&&s.classList.add("chat_banner_img"),(e.system||!e.user&&!e.banner)&&s.classList.add("system"),e.announcement&&s.classList.add("announcement"),e.user?.supporter&&(s.classList.add("supporterchat"),s.classList.add(`supporterchat_t${e.user.supporter_tier}`)),"sysop"===e.user?.role&&s.classList.add("sysopchat"),"admin"===e.user?.role&&s.classList.add("adminchat"),"mod"===e.user?.role&&s.classList.add("modchat"),"halfmod"===e.user?.role&&s.classList.add("halfmodchat"),o?.owner&&e.user?._id===o.owner&&s.classList.add("roomownerchat");const a=document.createElement("h1"),r=e.user?e.user.username.toUpperCase():e.system?"[SYS]":"[CMD]";a.textContent=r,["[SYS]","[CMD]"].includes(r)||(a.classList.add("chat_tag"),a.setAttribute("data-id",e.user?._id),a.tabIndex=-1),s.appendChild(a);const l=document.createElement("p"),c=e.markdown?Ft:St,p=St(e.content),d=t?e.content:Hn(c(e.content),e.user,!0);let h=t?e.content:Hn(c(e.content),e.user,!1===it.video.emotes_anim);if(p===h?l.textContent=e.content:(0===h.replace(/<img class=(.+?) \/>/,"").length&&(h=h.replace('"emote"','"emote big"')),l.innerHTML=h),e.banner_color&&(l.style.color="#FFF",l.style.backgroundColor=e.banner_color,l.style.borderColor=e.banner_color),e.color?l.style.color=e.color:!e.system&&e.content.toLowerCase().includes(mn.username())&&s.classList.add("pingchat"),e.img){const t=document.createElement("img");t.classList.add("chat_img"),t.setAttribute("src",e.img),l.prepend(t)}if(s.appendChild(l),e.banner_img){const t=document.createElement("img");t.classList.add("banner_img"),t.setAttribute("src",e.banner_img),s.appendChild(t)}if(e.game_embed){const t=document.createElement("div");t.classList.add("chat_embed","ns"),t.dataset.floor=e.game_embed.floor;const n=e.game_embed.mods.filter((e=>"duo"!==e)),s=Bt(e.game_embed.time);t.innerHTML=`\n\t\t\t\t<div class="chat_embed_score">${Math.floor(e.game_embed.altitude).toLocaleString("en-US")}<span class="ms">.${Math.floor(e.game_embed.altitude%1*10)}</span><span class="unit">M</span><span class="mods">${n.map((e=>`<img src="/res/zenith-mods/pbicons-tetra/${St(e)}.png" title="${L.Strings.zenithMods[e]??"Unknown Mod"}" />`)).join("")}</span></div>\n\t\t\t\t${e.game_embed.ally?`<div class="chat_embed_ally">together with <span>${e.game_embed.ally.toUpperCase()}</span></div>`:""}\n\t\t\t\t<div class="chat_embed_stats"><span>${s.m}:${s.s}</span>.${s.ms} - <span>${e.game_embed.kos}</span> ko${1===e.game_embed.kos?"":"'s"} - <span>${e.game_embed.apm.toFixed(2)}</span> apm - <span>${e.game_embed.pps.toFixed(2)}</span> pps</div>\n\t\t\t`,l.appendChild(t)}for(const t of[xt("room_chat"),xt("ingame_chat"),xt("league_chat")]){const n=s.cloneNode(!0),o=i[t.id];"ingame_chat"===t.id&&h!==d&&(n.querySelector("p").innerHTML=d);for(const e of o){if(e.until>Date.now())continue;o.delete(e);const{el:t}=e;for(;t.previousElementSibling?.classList.contains("pinned");)t.previousElementSibling.before(t);t.classList.remove("pinned")}if(e.pinned){t.appendChild(n);const s=Date.now()+(e.pinned_until??1e4);o.add({el:n,until:s}),n.style.setProperty("--pin-duration",`${Math.max(1,(s-Date.now())/1e3)}s`),setTimeout((()=>{n?.classList.remove("pinned")}),Math.max(1e3,s-Date.now()))}else if(o.size>0){const[{el:e}]=o;e.before(n)}else t.appendChild(n);t.childElementCount>100&&t.removeChild(t.firstElementChild),t.scrollTop=t.scrollHeight+100}e.user?._id!==mn.id()||!Pn(c(e.content))||e.user.supporter||[...$n,"bot"].includes(e.user.role)||te({content:'That emote is for supporters only! Consider <a class="chatlink" href="javascript:void();" onclick="SHOW_SUPPORTER_DIALOG();">supporting TETR.IO development</a> to get access to this emote and more. <3',system:!0},!0)}function ne(e,t){yt(`.chat_message[data-id="${e}"]`).forEach((e=>{if(!e.classList.contains("system")){if(t)return e.remove();e.classList.add("deleted"),e.querySelector("p").innerText="<message deleted>"}}))}function se(){document.body.classList.contains("inpair")||document.body.classList.contains("multi_advancing")||(vi("rsg","3"),na.PlaySe("rsg"),setTimeout((()=>{vi("rsg","2"),na.PlaySe("rsg")}),500),setTimeout((()=>{vi("rsg","1"),na.PlaySe("rsg")}),1e3),setTimeout((()=>{vi("rsg","GO!"),na.PlaySe("rsg_go")}),1500))}function ie(e,t,n,s){na.PlaySe("victory"),xt("victory_header").innerHTML=s?"WINNERS!":"WINNER!",xt("victory_victor").innerHTML=e,xt("victory_sub").innerHTML=t,xt("victory_also").innerHTML=n,xt("victory").classList.remove("hidden"),setTimeout((()=>{xt("victory").classList.add("hidden")}),5e3)}function oe(e,t,n,s,i,o,a,r){const l=document.createElement("div");l.classList.add("scroller_block"),l.classList.add("playerresult"),l.classList.add("record_item"),l.setAttribute("data-id",n),l.setAttribute("data-hover","tap"),l.setAttribute("data-hit","click"),t&&l.classList.add("record_first"),r||l.classList.add("disconnected"),s===mn.username()&&l.classList.add("record_me"),xt("playerresults").appendChild(l);const c=document.createElement("div");c.classList.add("record_grade"),c.classList.add("ns"),c.innerHTML=e,l.appendChild(c);const p=document.createElement("div");p.classList.add("record_owner"),p.innerHTML=s.toUpperCase(),l.appendChild(p);const d=document.createElement("div");d.classList.add("record_ts"),d.innerHTML=a,l.appendChild(d);const h=document.createElement("div");h.classList.add("record_result"),h.innerHTML=i,l.appendChild(h);const u=document.createElement("div");u.classList.add("record_extra"),u.innerHTML=o,l.appendChild(u)}function ae(e,t,n){const s=document.createElement("tr");e.appendChild(s);const i=document.createElement("td");i.innerHTML=t,s.appendChild(i);const o=document.createElement("td");o.innerHTML=n,s.appendChild(o)}function re(){Di("fetching room listing"),gn.get("/api/rooms/").then((e=>{Oi(),le(e.rooms),ii.bindGuide(oi[mi]||{})}),(e=>{Oi(),en(e)}))}function le(e){if(holder=xt("room_listing_container"),holder.innerHTML="",e.forEach((e=>{const t=document.createElement("div");t.classList.add("scroller_block"),t.classList.add("room_listing_item"),t.classList.add("ns"),t.setAttribute("data-hover","hover"),t.setAttribute("data-hit","confirm"),t.setAttribute("title",!1!==it.video.chatfilter&&e.name_safe?e.name_safe:e.name),holder.appendChild(t);const n=document.createElement("div");n.classList.add("room_listing_name"),n.textContent=!1!==it.video.chatfilter&&e.name_safe?e.name_safe:e.name,t.appendChild(n);const s=document.createElement("div");s.classList.add("room_listing_count"),s.innerHTML=`${e.players}${e.userLimit?`<span class="room_listing_limit">/${e.userLimit}</span>`:""}${e.count-e.players?`<span class="room_listing_spectators">+${e.count-e.players}</span>`:""}`,t.appendChild(s);const i=document.createElement("div");i.classList.add("room_listing_info"),i.innerHTML=`${"system"===e.type?"SYSTEM -":""} ${e.state.toUpperCase()} ${"z"!==e.userRankLimit?`- <img class="room_listing_rank" src="/res/league-ranks/${e.userRankLimit}.png"/> and below - `:"- "} <span class="room_listing_id">${e.id}</span>`,t.appendChild(i);const o=document.createElement("div");o.classList.add("room_listing_extra"),o.innerHTML=`anons allowed: <span>${e.allowAnonymous?"YES":"NO"}</span>, unranked allowed: <span>${e.allowUnranked?"YES":"NO"}</span>`,t.appendChild(o),t.addEventListener("click",(()=>{w(e.id)}))})),!e.length){const e=document.createElement("div");e.classList.add("scroller_block"),e.classList.add("nothing"),e.classList.add("ns"),e.innerHTML="NO ROOMS",holder.appendChild(e)}}let ce=!1;function pe(e){e!==ce&&(e?(xt("referee").classList.remove("hidden"),xt("referee").classList.remove("hiding"),xt("referee_score_side").classList.remove("hidden"),xt("referee_score_side").classList.remove("hiding")):(xt("referee").classList.add("hiding"),xt("referee_score_side").classList.add("hiding"),setTimeout((()=>{e===ce&&(xt("referee").classList.add("hidden"),xt("referee_score_side").classList.add("hidden"),xt("referee_score_side").innerHTML="",ue.self=null,ue.leader=null,ue.others.clear(),ue.visibleUsernames.clear())}),500)),ce=e)}function de(n){switch(u=n,n.rb.type){case"multi-round":{xt("referee").classList.toggle("ft1",1===n.rb.options.ft&&1===n.rb.options.wb),xt("exit_spectate").classList.toggle("blocked",!d&&(1!==n.rb.options.ft||1!==n.rb.options.wb)),xt("zen_spectate").classList.toggle("blocked",!d&&(1!==n.rb.options.ft||1!==n.rb.options.wb)),xt("referee").classList.toggle("duel",2===n.rb.leaderboard.length||n.rb.leaderboard.length>8),xt("referee_top").textContent=`${n.modename} FT${n.rb.options.ft}${1!==n.rb.options.wb?`+${n.rb.options.wb}`:""}`;let s=-1;const i=[];2===n.rb.leaderboard.length&&n.rb.leaderboard.sort(((e,t)=>e.naturalorder-t.naturalorder)),n.rb.leaderboard.forEach((n=>{if(n.id==mn.id()){s++;const o=s>=8?t:e[s];i.push(`<div class="referee_point" style="--r: ${o[0]}; --g: ${o[1]}; --b: ${o[2]};"><h1>${n.wins}</h1><p>${n.username.toUpperCase()}</p></div>`)}}));let o=!0,a=!0,r=0,l=0;n.rb.leaderboard.forEach((c=>{if(c.id==mn.id())return;if(!a)return;if(n.rb.leaderboard.length>=8){if(c.wins<l)return void(a=!1);if(r++,l=c.wins,!o)return;o=!1}s++;const p=s>=8?t:e[s];i.push(`<div class="referee_point" style="--r: ${p[0]}; --g: ${p[1]}; --b: ${p[2]};"><h1>${c.wins}</h1><p>${c.username.toUpperCase()}</p></div>`)}));let c=i.join('<div class="referee_sep">-</div>');r>1&&(c+=`<div class="referee_sep">+${r-1}</div>`),xt("referee_points").innerHTML=c,xt("referee").classList.remove("disabled");break}default:xt("referee").classList.add("disabled")}if("zenith"===n.rrb.type)f(n.rrb.scoreboard);he(n)}function he(e){if("zenith"===e.rrb.type)ue.lastUpdate=performance.now(),ue.mustReflow=!0,ue.ticking||(ue.ticking=!0,"minimal"===it.video.graphics?_e():a.Ticker.shared.add(_e)),xt("referee_score_side").classList.remove("disabled");else xt("referee_score_side").classList.add("disabled")}const ue={ticking:!1,lastUpdate:0,lastTick:0,lastReflow:0,mustReflow:!1,self:null,others:new Map,selfIndex:-1,above:void 0,focusedUsername:null,leader:null,visibleUsernames:new Set,lastWindowHeight:window.innerHeight};function _e(){u||(ue.ticking=!1);const e=u,t=performance.now(),n=t-ue.lastUpdate;if(n>=2e3&&(ue.ticking=!1),!ue.ticking)return void a.Ticker.shared.remove(_e);const s="minimal"===it.video.graphics,i=ue.lastTick?(t-ue.lastTick)/(1e3/60):1;ue.lastTick=t;const o=ue.lastWindowHeight!==window.innerHeight;ue.lastWindowHeight=window.innerHeight;let r=null;const l=Fa?Fa.GetSpectate()??Fa.games.self:null,c=l?.getOwner();l&&(l===Fa.games.self||l.isScoped()&&l.isSynced())&&(r=l.getZenithAltitude()),ue.focusedUsername!==c&&(ue.focusedUsername=c,ue.self?.remove(),ue.self=null);if(["medium","high","ultra"].includes(it.video.graphics)&&(ue.mustReflow||t-ue.lastReflow>=100)){for(const t of e.rrb.scoreboard)if(t.username!==c&&t.shadows[0]?.[0]!==c||!r){if(ue.visibleUsernames.has(t.username)){const e=.25*Math.floor(t.stats.rank),s=t.stats.altitude,i=me.GetSpeedCap(s);t._rssReflowed=s+e/1e3*n*i}}else t._rssReflowed=r;e.rrb.scoreboard.sort(((e,t)=>t._rssReflowed-e._rssReflowed)),ue.lastReflow=t,ue.mustReflow=!1}const p=c?e.rrb.scoreboard.findIndex((e=>e.username===c||e.shadows[0]?.[1]===c)):-1,d=Math.ceil(window.innerHeight/34*1.2);s||-1===ue.selfIndex||-1===p?ue.selfIndex=p:(ue.selfIndex=p+(ue.selfIndex-p)*Math.pow(.92,i),ue.selfIndex=Math.min(ue.selfIndex,e.rrb.scoreboard.length-1),Math.abs(ue.selfIndex-p)<.02&&(ue.selfIndex=p));const h=-Math.max(0,Math.floor(window.innerHeight/90)-Math.max(0,ue.selfIndex)),_=-h/Math.floor(window.innerHeight/90);if(-1!==p){const n=e.rrb.scoreboard[p];if(!ue.self){if(ue.self=document.createElement("div"),ue.self.className="rssp rssp_self "+(n.isExpert?"rssp_isexpert":""),ue.self.dataset.username=n.username,ue.self.__username=document.createElement("div"),ue.self.__username.className="rssp_username",n.shadows[0]){let e=`${n.username.toUpperCase()} <span>&</span> ${n.shadows[0][1].toUpperCase()}`;e.length>36?(e=`${n.username.toUpperCase()} <span>&</span><br>${n.shadows[0][1].toUpperCase()}`,ue.self.__username.className="rssp_username rssp_username_longduo"):e.length>30&&(e=e.toLowerCase()),ue.self.__username.innerHTML=e}else ue.self.__username.textContent=n.username.toUpperCase();ue.self.appendChild(ue.self.__username),ue.self.__score=document.createElement("div"),ue.self.__score.className="rssp_score",ue.self.appendChild(ue.self.__score),ue.self.__score_i=document.createElement("span"),ue.self.__score.appendChild(ue.self.__score_i),ue.self.__score_d=document.createElement("sub"),ue.self.__score.appendChild(ue.self.__score_d),ue.self.__place=document.createElement("div"),ue.self.__place.className="rssp_place",ue.self.appendChild(ue.self.__place),xt("referee_score_side").appendChild(ue.self),ue.self.style.setProperty("--rssp-r",40*Math.random()-20+"deg"),ue.self.__unping_at=null,ue.self.__cache_place=null,ue.self.__cache_y=null,ue.self.__cache_score=null,ue.visibleUsernames.add(n.username)}const i=n._rssReflowed??n.stats.altitude;if(ue.self.__cache_score!==Math.floor(10*i)&&(ue.self.__score_i.textContent=Math.floor(i).toLocaleString("en-US"),ue.self.__score_d.textContent=`.${Math.floor(i%1*10)}`,ue.self.__cache_score=Math.floor(10*i)),(ue.self.__cache_y!==h||o)&&(ue.self.style.top=window.innerHeight/2+34*h-17+"px",ue.self.__cache_y=h),ue.self.__cache_place!==p&&(ue.self.__place.textContent=Math.floor(p+1).toLocaleString("en-US"),p<150&&(ue.self.classList.toggle("t1",p<1),ue.self.classList.toggle("t2",p<2),ue.self.classList.toggle("t3",p<3),ue.self.classList.toggle("t10",p<10),ue.self.classList.toggle("t25",p<25),ue.self.classList.toggle("t50",p<50),ue.self.classList.toggle("t100",p<100)),ue.self.__cache_place=p),!s&&Math.floor(ue.self.__i)>Math.floor(ue.selfIndex)){(ue.selfIndex<=50||!!ue.above&&i>(ue.above._rssReflowed??ue.above.stats.altitude))&&(ue.self.classList.add("ping"),ue.self.__unping_at=t+100,Ur.play("zenith_lbping",{pos:p+1,el:ue.self}))}ue.above=e.rrb.scoreboard[p-1],ue.self.__i=ue.selfIndex,null!==ue.self.__unping_at&&ue.self.__unping_at<=t&&(ue.self.classList.remove("ping"),ue.self.__unping_at=null)}else if(ue.self){const e=ue.self;ue.visibleUsernames.delete(ue.self.dataset.username),s?e.remove():(e.classList.add("hiding"),e.classList.add("rssp_eject"),setTimeout((()=>{e.remove()}),1e3)),ue.self=null}const m=new WeakSet,g=new Set;for(let t=Math.max(0,Math.floor(ue.selfIndex-d/2));t<Math.min(e.rrb.scoreboard.length,Math.max(0,Math.floor(ue.selfIndex-d/2))+d);t++){const n=e.rrb.scoreboard[t];if(n===e.rrb.scoreboard[p])continue;let a=ue.others.get(n.id);if(!a){const e=yr(n.id)??(n.shadows[0]?yr(n.shadows[0][0]):null),i=e&&"friend"===e.type;if(a=document.createElement("div"),a.__i=t,a.className=`rssp rssp_other ${i?"rssp_friend":""} ${!s&&Math.abs(t-ue.selfIndex)<=d-5?`${t<ue.selfIndex?"rssp_from_top":""} ${t>ue.selfIndex?"rssp_from_bottom":""}`:""}  ${n.isExpert?"rssp_isexpert":""}`,a.dataset.username=n.username,a.__username=document.createElement("div"),a.__username.className="rssp_username",n.shadows[0]){let e=`${n.username.toUpperCase()} <span>&</span> ${n.shadows[0][1].toUpperCase()}`;e.length>36?(e=`${n.username.toUpperCase()} <span>&</span><br>${n.shadows[0][1].toUpperCase()}`,a.__username.className="rssp_username rssp_username_longduo"):e.length>30&&(e=e.toLowerCase()),a.__username.innerHTML=e}else a.__username.textContent=n.username.includes(" ")?n.username.toLowerCase():n.username.toUpperCase();a.appendChild(a.__username),a.__score=document.createElement("div"),a.__score.className="rssp_score",a.appendChild(a.__score),a.__score_i=document.createElement("span"),a.__score.appendChild(a.__score_i),a.__score_d=document.createElement("sub"),a.__score.appendChild(a.__score_d),a.__place=document.createElement("div"),a.__place.className="rssp_place",a.appendChild(a.__place),xt("referee_score_side").appendChild(a),ue.others.set(n.id,a),a.style.setProperty("--rssp-r",40*Math.random()-20+"deg"),a.__cache_place=null,a.__cache_x=null,a.__cache_y=null,a.__cache_score=null,ue.visibleUsernames.add(n.username),g.add(n.username)}a.__i=s?t:t+(a.__i-t)*Math.pow(.92,i),Math.abs(a.__i-t)<.02&&(a.__i=t);const r=n._rssReflowed??n.stats.altitude;a.__cache_score!==Math.floor(10*r)&&(a.__score_i.textContent=Math.floor(r).toLocaleString("en-US"),a.__score_d.textContent=`.${Math.floor(r%1*10)}`);const l=Math.round(window.innerHeight/2+34*(a.__i-Math.max(0,ue.selfIndex)+h)-17);(a.__cache_y!==l||o)&&(a.style.top=`${l}px`,a.__cache_y=l);const c=Math.round((Math.abs(a.__i-Math.max(0,ue.selfIndex))/2)**2/(d/15)*(1-.5*_));a.__cache_x!==c&&(a.style.left=`${c}px`,a.__score.style.right=`${8+c}px`,a.__cache_x=c),a.__cache_place!==t&&(a.__place.textContent=Math.floor(t+1).toLocaleString("en-US"),t<150&&(a.classList.toggle("t1",t<1),a.classList.toggle("t2",t<2),a.classList.toggle("t3",t<3),a.classList.toggle("t10",t<10),a.classList.toggle("t25",t<25),a.classList.toggle("t50",t<50),a.classList.toggle("t100",t<100)),a.__cache_place=t),m.add(a)}for(const[t,n]of ue.others)m.has(n)||(g.has(n.dataset.username)||ue.visibleUsernames.delete(n.dataset.username),s?(ue.others.delete(t),n.remove()):(n.classList.add("hiding"),n.__i<Math.max(0,ue.selfIndex)-d?n.classList.add("rssp_to_top"):n.__i>=Math.min(e.rrb.scoreboard.length,Math.max(0,ue.selfIndex)+d)?n.classList.add("rssp_to_bottom"):n.classList.add("rssp_eject"),ue.others.delete(t),setTimeout((()=>{n.remove()}),1e3)));if(ue.leader||(ue.leader=document.createElement("div"),ue.leader.className="rssl",ue.leader.innerHTML='\n\t\t\t\t<div class="rsslp rsslp_1"><div class="rsslp_username"></div><div class="rsslp_score"><span></span><sub></sub></div></div>\n\t\t\t\t<div class="rsslp rsslp_2"><div class="rsslp_username"></div><div class="rsslp_score"><span></span><sub></sub></div></div>\n\t\t\t\t<div class="rsslp rsslp_3"><div class="rsslp_username"></div><div class="rsslp_score"><span></span><sub></sub></div></div>\n\t\t\t',ue.leader.__1_username=ue.leader.querySelector(".rsslp_1 .rsslp_username"),ue.leader.__2_username=ue.leader.querySelector(".rsslp_2 .rsslp_username"),ue.leader.__3_username=ue.leader.querySelector(".rsslp_3 .rsslp_username"),ue.leader.__1_score=ue.leader.querySelector(".rsslp_1 .rsslp_score"),ue.leader.__2_score=ue.leader.querySelector(".rsslp_2 .rsslp_score"),ue.leader.__3_score=ue.leader.querySelector(".rsslp_3 .rsslp_score"),ue.leader.__1_score_i=ue.leader.querySelector(".rsslp_1 .rsslp_score>span"),ue.leader.__2_score_i=ue.leader.querySelector(".rsslp_2 .rsslp_score>span"),ue.leader.__3_score_i=ue.leader.querySelector(".rsslp_3 .rsslp_score>span"),ue.leader.__1_score_d=ue.leader.querySelector(".rsslp_1 .rsslp_score>sub"),ue.leader.__2_score_d=ue.leader.querySelector(".rsslp_2 .rsslp_score>sub"),ue.leader.__3_score_d=ue.leader.querySelector(".rsslp_3 .rsslp_score>sub"),xt("referee_score_side").appendChild(ue.leader)),ue.leader.classList.toggle("hidden",h<0||e.rrb.scoreboard.length<3),e.rrb.scoreboard.length>=3){const t=e.rrb.scoreboard[0].username,n=e.rrb.scoreboard[1].username,s=e.rrb.scoreboard[2].username,i=e.rrb.scoreboard[0]._rssReflowed??e.rrb.scoreboard[0].stats.altitude,o=e.rrb.scoreboard[1]._rssReflowed??e.rrb.scoreboard[1].stats.altitude,a=e.rrb.scoreboard[2]._rssReflowed??e.rrb.scoreboard[2].stats.altitude;if(ue.leader.__1_username.__v!==t){if(e.rrb.scoreboard[0].shadows[0]){let n=`${t.toUpperCase()} <span>&</span> ${e.rrb.scoreboard[0].shadows[0][1].toUpperCase()}`;ue.leader.__1_username.classList.remove("rssp_username_longduo"),n.length>36?(n=`${t.toUpperCase()} <span>&</span><br>${e.rrb.scoreboard[0].shadows[0][1].toUpperCase()}`,ue.leader.__1_username.classList.add("rssp_username_longduo")):n.length>30&&(n=n.toLowerCase()),ue.leader.__1_username.innerHTML=n,ue.leader.__1_username.classList.add("lu")}else ue.leader.__1_username.textContent=t.includes(" ")?t.toLowerCase():t.toUpperCase(),ue.leader.__1_username.classList.toggle("lu",t.length>12),ue.leader.__1_username.classList.remove("rssp_username_longduo");ue.leader.__1_username.__v&&ue.visibleUsernames.delete(ue.leader.__1_username.__v),ue.leader.__1_score.classList.toggle("rsslp_isexpert",e.rrb.scoreboard[0].isExpert),ue.leader.__1_username.dataset.username=t,ue.leader.__1_username.__v=t}if(ue.leader.__2_username.__v!==n){if(e.rrb.scoreboard[1].shadows[0]){let t=`${n.toUpperCase()} <span>&</span> ${e.rrb.scoreboard[1].shadows[0][1].toUpperCase()}`;ue.leader.__2_username.classList.remove("rssp_username_longduo"),t.length>36?(t=`${n.toUpperCase()} <span>&</span><br>${e.rrb.scoreboard[1].shadows[0][1].toUpperCase()}`,ue.leader.__2_username.classList.add("rssp_username_longduo")):t.length>30&&(t=t.toLowerCase()),ue.leader.__2_username.innerHTML=t,ue.leader.__2_username.classList.add("lu")}else ue.leader.__2_username.textContent=n.includes(" ")?n.toLowerCase():n.toUpperCase(),ue.leader.__2_username.classList.toggle("lu",n.length>12),ue.leader.__2_username.classList.remove("rssp_username_longduo");ue.leader.__2_username.__v&&ue.visibleUsernames.delete(ue.leader.__2_username.__v),ue.leader.__2_score.classList.toggle("rsslp_isexpert",e.rrb.scoreboard[1].isExpert),ue.leader.__2_username.dataset.username=n,ue.leader.__2_username.__v=n}if(ue.leader.__3_username.__v!==s){if(e.rrb.scoreboard[2].shadows[0]){let t=`${s.toUpperCase()} <span>&</span> ${e.rrb.scoreboard[2].shadows[0][1].toUpperCase()}`;ue.leader.__3_username.classList.remove("rssp_username_longduo"),t.length>36?(t=`${s.toUpperCase()} <span>&</span><br>${e.rrb.scoreboard[2].shadows[0][1].toUpperCase()}`,ue.leader.__3_username.classList.add("rssp_username_longduo")):t.length>30&&(t=t.toLowerCase()),ue.leader.__3_username.innerHTML=t,ue.leader.__3_username.classList.add("lu")}else ue.leader.__3_username.textContent=s.includes(" ")?s.toLowerCase():s.toUpperCase(),ue.leader.__3_username.classList.toggle("lu",s.length>12),ue.leader.__3_username.classList.remove("rssp_username_longduo");ue.leader.__3_username.__v&&ue.visibleUsernames.delete(ue.leader.__3_username.__v),ue.leader.__3_score.classList.toggle("rsslp_isexpert",e.rrb.scoreboard[2].isExpert),ue.leader.__3_username.dataset.username=s,ue.leader.__3_username.__v=s}ue.leader.__1_score_i.textContent=Math.floor(i).toLocaleString("en-US"),ue.leader.__1_score_d.textContent=`.${Math.floor(i%1*10)}`,ue.leader.__2_score_i.textContent=Math.floor(o).toLocaleString("en-US"),ue.leader.__2_score_d.textContent=`.${Math.floor(o%1*10)}`,ue.leader.__3_score_i.textContent=Math.floor(a).toLocaleString("en-US"),ue.leader.__3_score_d.textContent=`.${Math.floor(a%1*10)}`,ue.visibleUsernames.add(t),ue.visibleUsernames.add(n),ue.visibleUsernames.add(s)}s&&(ue.ticking=!1)}function ge(e){window.XDBGSCOREBOARDWIN.document.getElementById("tbl").innerHTML=`\n\t\t<thead>\n\t\t\t<td style="width: 2.5rem;">#</td>\n\t\t\t<td style="width: 9rem;">UID</td>\n\t\t\t<td style="width: 10rem;">Username</td>\n\t\t\t<td style="width: 4rem;">Altitude</td>\n\t\t\t<td style="width: 4rem;">Speed</td>\n\t\t\t<td style="width: 4rem;">Lifetime</td>\n\t\t\t<td style="width: 4rem;">APM</td>\n\t\t\t<td style="width: 4rem;">PPS</td>\n\t\t\t<td style="width: 4rem;">VS</td>\n\t\t\t<td style="width: 4rem;">Recv</td>\n\t\t\t<td style="width: 4rem;">Sent</td>\n\t\t\t<td style="width: 4rem;">Elims</td>\n\t\t\t<td style="width: 5rem;">Tgt.Factor</td>\n\t\t\t<td style="width: 5rem;">Tgt.Grace</td>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t${e.map(((e,t)=>`\n\t\t\t\t<tr class="${e.id.startsWith("00")?"bot ":""}${Fa&&e.username===(Fa.GetSpectate()??Fa.games.self)?.getOwner()?"spec ":""}" data-username="${e.username}">\n\t\t\t\t\t<td class="imp">${t+1}</td>\n\t\t\t\t\t<td class="mono">${e.id}</td>\n\t\t\t\t\t<td class="imp">${e.username}</td>\n\t\t\t\t\t<td class="imp">${e.stats.altitude.toFixed(1)}</td>\n\t\t\t\t\t<td>${Math.floor(e.stats.rank)}</td>\n\t\t\t\t\t<td${e.lifetime>48e4?' style="color: #F00;"':""}>${Math.floor(e.lifetime/6e4)}m ${(Math.floor(e.lifetime/1e3)%60).toString().padStart(2,"0")}s</td>\n\t\t\t\t\t<td>${e.stats.apm.toFixed(2)}</td>\n\t\t\t\t\t<td>${e.stats.pps.toFixed(2)}</td>\n\t\t\t\t\t<td>${e.stats.vsscore.toFixed(2)}</td>\n\t\t\t\t\t<td>${e.stats.garbagereceived}</td>\n\t\t\t\t\t<td>${e.stats.garbagesent}</td>\n\t\t\t\t\t<td>${e.stats.kills}</td>\n\t\t\t\t\t<td>${Math.max(0,e.stats.targetingfactor+(0===t?2:0)-(.02*e.stats.targetinggrace**2+.1*e.stats.targetinggrace)).toFixed(2)}</td>\n\t\t\t\t\t<td>${e.stats.targetinggrace}</td>\n\t\t\t\t</tr>\n\t\t\t`)).join("")}\n\t\t</tbody>\n\t`}function fe(e,t){const n=2===t.rb.leaderboard.length,s=e[0].username;if(n&&t.rb.leaderboard.sort(((e,t)=>e.naturalorder-t.naturalorder)),xt("scoreslide_header").textContent=`${t.modename} FT${t.rb.options.ft}${1!==t.rb.options.wb?`+${t.rb.options.wb}`:""}`,xt("scoreslide").classList.toggle("duel",n),xt("scoreslide").classList.remove("pinged"),xt("scoreslide").classList.remove("pingedp1"),xt("scoreslide").classList.remove("pingedp2"),n){let e=1,n=0;t.rb.leaderboard[1].username===mn.username()?(At("#scoreslide_duel_p1 p").innerHTML=t.rb.leaderboard[1].username.toUpperCase(),At("#scoreslide_duel_p2 p").innerHTML=t.rb.leaderboard[0].username.toUpperCase(),t.rb.leaderboard[1].username===s?(e=1,n=t.rb.leaderboard[1].wins,At("#scoreslide_duel_p1 h1").innerHTML=t.rb.leaderboard[1].wins-1,At("#scoreslide_duel_p2 h1").innerHTML=t.rb.leaderboard[0].wins):(e=2,n=t.rb.leaderboard[0].wins,At("#scoreslide_duel_p1 h1").innerHTML=t.rb.leaderboard[1].wins,At("#scoreslide_duel_p2 h1").innerHTML=t.rb.leaderboard[0].wins-1)):(At("#scoreslide_duel_p1 p").innerHTML=t.rb.leaderboard[0].username.toUpperCase(),At("#scoreslide_duel_p2 p").innerHTML=t.rb.leaderboard[1].username.toUpperCase(),t.rb.leaderboard[0].username===s?(e=1,n=t.rb.leaderboard[0].wins,At("#scoreslide_duel_p1 h1").innerHTML=t.rb.leaderboard[0].wins-1,At("#scoreslide_duel_p2 h1").innerHTML=t.rb.leaderboard[1].wins):(e=2,n=t.rb.leaderboard[1].wins,At("#scoreslide_duel_p1 h1").innerHTML=t.rb.leaderboard[0].wins,At("#scoreslide_duel_p2 h1").innerHTML=t.rb.leaderboard[1].wins-1)),document.body.classList.contains("inpair")&&(setTimeout((()=>{xt("scoreslide").classList.add("leaguess"),document.body.classList.add("shaking"),na.PlaySe("impact")}),250),setTimeout((()=>{document.body.classList.remove("shaking")}),300),setTimeout((()=>{xt("scoreslide").classList.remove("leaguess")}),5e3)),setTimeout((()=>{t.rb.leaderboard[0].wins===t.rb.leaderboard[1].wins&&t.rb.leaderboard[0].wins>=t.rb.options.ft-1?2===t.rb.options.wb?(xt("scoreslide_duel_match").innerHTML="DEUCE",xt("scoreslide_duel_match").classList.add("ssdm_p4"),setTimeout((()=>{document.body.classList.add("shaking"),na.PlaySe("allclear")}),350),setTimeout((()=>{document.body.classList.remove("shaking")}),400)):1===t.rb.options.wb&&(xt("scoreslide_duel_match").innerHTML="TIEBREAKER",xt("scoreslide_duel_match").classList.add("ssdm_p3"),setTimeout((()=>{document.body.classList.add("shaking"),na.PlaySe("allclear")}),350),setTimeout((()=>{document.body.classList.remove("shaking")}),400)):t.rb.leaderboard[0].wins>=t.rb.options.ft-1&&t.rb.leaderboard[0].wins-t.rb.leaderboard[1].wins>=t.rb.options.wb-1&&t.rb.leaderboard[0].username===mn.username()||t.rb.leaderboard[1].wins>=t.rb.options.ft-1&&t.rb.leaderboard[1].wins-t.rb.leaderboard[0].wins>=t.rb.options.wb-1&&t.rb.leaderboard[1].username===mn.username()||t.rb.leaderboard[0].wins>=t.rb.options.ft-1&&t.rb.leaderboard[0].wins-t.rb.leaderboard[1].wins>=t.rb.options.wb-1&&t.rb.leaderboard[0].username!==mn.username()&&t.rb.leaderboard[1].username!==mn.username()?(xt("scoreslide_duel_match").innerHTML="MATCH POINT",xt("scoreslide_duel_match").classList.add("ssdm_p1")):(t.rb.leaderboard[0].wins>=t.rb.options.ft-1&&t.rb.leaderboard[0].wins-t.rb.leaderboard[1].wins>=t.rb.options.wb-1&&t.rb.leaderboard[0].username!==mn.username()||t.rb.leaderboard[1].wins>=t.rb.options.ft-1&&t.rb.leaderboard[1].wins-t.rb.leaderboard[0].wins>=t.rb.options.wb-1&&t.rb.leaderboard[1].username!==mn.username()||t.rb.leaderboard[1].wins>=t.rb.options.ft-1&&t.rb.leaderboard[1].wins-t.rb.leaderboard[0].wins>=t.rb.options.wb-1&&t.rb.leaderboard[0].username!==mn.username()&&t.rb.leaderboard[1].username!==mn.username())&&(xt("scoreslide_duel_match").innerHTML="MATCH POINT",xt("scoreslide_duel_match").classList.add("ssdm_p2"))}),1500),setTimeout((()=>{xt("scoreslide_duel_match").classList.remove("ssdm_p1"),xt("scoreslide_duel_match").classList.remove("ssdm_p2"),xt("scoreslide_duel_match").classList.remove("ssdm_p3"),xt("scoreslide_duel_match").classList.remove("ssdm_p4")}),5e3),setTimeout((()=>{na.PlaySe("showscore"),xt("scoreslide").classList.add(`pingedp${e}`),At(`#scoreslide_duel_p${e} h1`).innerHTML=n,Ur.play("scoreslide_ultra",{right:1!==e})}),1500)}else{let e=0,n="";t.rb.leaderboard.forEach((t=>{t.username===s&&(e=t.wins,xt("scoreslide_leader_name").innerHTML=t.username.toUpperCase(),xt("scoreslide_leader_points").innerHTML=t.wins-1),n+=`<div class="scoreslide_player"><p>${t.username.toUpperCase()}</p><h1>${t.wins}</h1></div>`})),xt("scoreslide_list").innerHTML=n,setTimeout((()=>{na.PlaySe("showscore"),xt("scoreslide").classList.add("pinged"),xt("scoreslide_leader_points").innerHTML=e}),1500)}xt("scoreslide").classList.remove("hidden"),na.PlaySe("scoreslide_in"),setTimeout((()=>{xt("scoreslide").classList.remove("hiding")}),20),setTimeout((()=>{xt("scoreslide").classList.add("hiding"),na.PlaySe("scoreslide_out")}),4e3),setTimeout((()=>{xt("scoreslide").classList.add("hidden")}),5e3)}function be(){Di("entering matchmaking"),Sa.emit("league.enter")}function Ce(){Di("leaving matchmaking"),Sa.emit("league.leave")}function xe(){Di("getting ready to spectate"),Sa.emit("game.spectate")}function Ae(e={}){Di("joining game"),Sa.emit("game.enter",e)}function ye(){Di("rejoining game"),Sa.emit("game.replace")}function ve(){Sa.emit("game.forfeit")}function Be(e,t){const n=di;let i=0;const o=setInterval((()=>{let a=Math.round(Vr(n,e,i,s(.74,.03,.09,.97))-n);xt("leaguestanding_rating").innerHTML=`${Math.round(Vr(n,e,i,s(.74,.03,.09,.97)))}<span>TR</span>${-1!==n?` <span class="leaguechange">${0===a?"":a>=150?"":a>0?"":a<=-150?"":""}${Math.abs(a)}</span>`:""}`,i+=1/t,i>=1&&(a=Math.round(e-n),xt("leaguestanding_rating").innerHTML=`${e}<span>TR</span>${-1!==n?` <span class="leaguechange">${0===a?"":a>=150?"":a>0?"":a<=-150?"":""}${Math.abs(a)}</span>`:""}`,clearInterval(o),di=e)}),16)}function we(){xt("leaguestanding_rating").innerHTML=`${di}<span>TR</span> <span class="leaguechange">0</span>`}function Le(e,t){const n=ui;let i=0;const o=setInterval((()=>{let a=Math.round(n-Vr(n,e,i,s(.74,.03,.09,.97)));xt("leaguestanding_placement").innerHTML=`#<span>${Math.round(Vr(n,e,i,s(.74,.03,.09,.97)))}</span>`,xt("leaguestanding_placement").classList.toggle("t100",Math.round(Vr(n,e,i,s(.74,.03,.09,.97)))<=100&&Math.round(Vr(n,e,i,s(.74,.03,.09,.97)))>10),xt("leaguestanding_placement").classList.toggle("t10",Math.round(Vr(n,e,i,s(.74,.03,.09,.97)))<=10&&Math.round(Vr(n,e,i,s(.74,.03,.09,.97)))>1),xt("leaguestanding_placement").classList.toggle("t1",1===Math.round(Vr(n,e,i,s(.74,.03,.09,.97)))),xt("leaguestanding_placement_change").innerHTML=-1!==n?`${0===a?"":a>=10?"":a>0?"":a<=-10?"":""}${Math.abs(a)}</span>`:"",i+=1/t,i>=1&&(a=Math.round(n-e),xt("leaguestanding_placement").innerHTML=`#<span>${e}</span>`,xt("leaguestanding_placement").classList.toggle("t100",e<=100&&e>10),xt("leaguestanding_placement").classList.toggle("t10",e<=10&&e>1),xt("leaguestanding_placement").classList.toggle("t1",1===e),xt("leaguestanding_placement_change").innerHTML=-1!==n?`${0===a?"":a>=10?"":a>0?"":a<=-10?"":""}${Math.abs(a)}</span>`:"",clearInterval(o),ui=e)}),16)}function ke(){xt("leaguestanding_placement_change").innerHTML="0"}function Se(e){const t=hi;if(t===e)return void(xt("leaguestanding_rank").src=`/res/league-ranks/${e}.png`);const n=Rn.indexOf(t);Rn.indexOf(e)>n?(xt("leaguestanding_rank").classList.add("rankraise"),setTimeout((()=>{na.PlaySe("rankraise")}),400),setTimeout((()=>{document.body.classList.add("shaking")}),1800),setTimeout((()=>{document.body.classList.remove("shaking")}),1900)):(setTimeout((()=>{na.PlaySe("ranklower")}),400),xt("leaguestanding_rank").classList.add("ranklower")),setTimeout((()=>{xt("leaguestanding_rank").src=`/res/league-ranks/${e}.png`}),1050),setTimeout((()=>{xt("leaguestanding_rank").classList.remove("rankraise"),xt("leaguestanding_rank").classList.remove("ranklower")}),4500),hi=e}function Fe(e){hi===e&&(xt("leaguestanding_rank").src=`/res/league-ranks/${e}.png`)}return window.DEVHOOK_OPEN_DEBUG_SCOREBOARD_VIEW=()=>{if(Os(!1),!o)return;window.XDBGSCOREBOARDWIN&&window.XDBGSCOREBOARDWIN.close();const e=open("about:blank","_blank","popup,width=1500,height=800");e.document.body.innerHTML='<table id="tbl"></table><style>\n\t\t\thtml {\n\t\t\t\tbackground: #000;\n\t\t\t\tcolor: #FFF;\n\t\t\t\tfont-family: sans-serif;\n\t\t\t}\n\n\t\t\t#tbl {\n\t\t\t\tborder-collapse: collapse;\n\t\t\t\ttable-layout: fixed;\n\t\t\t}\n\n\t\t\t#tbl tr:nth-child(odd) td {\n\t\t\t\tbackground: #2a2a2a;\n\t\t\t}\n\n\t\t\t#tbl thead {\n\t\t\t\tposition: sticky;\n\t\t\t\ttop: 0;\n\t\t\t}\n\n\t\t\t#tbl td {\n\t\t\t\tborder: 1px solid #666;\n\t\t\t\tpadding: 0.25rem;\n\t\t\t}\n\n\t\t\t.mono {\n\t\t\t\tfont-family: monospace;\n\t\t\t}\n\t\t\t.imp {\n\t\t\t\tfont-weight: 900;\n\t\t\t}\n\n\t\t\t.bot {\n\t\t\t\tcolor: #888;\n\t\t\t}\n\t\t\t.spec {\n\t\t\t\tcolor: #ffaa00;\n\t\t\t}\n\t\t</style>',e.document.body.addEventListener("click",(e=>{Fa&&e.target.closest("[data-username]")&&Fa.SetSpectate(e.target.closest("[data-username]").dataset.username)})),e.addEventListener("beforeunload",(()=>window.XDBGSCOREBOARDWIN=null));const t=setInterval((async()=>{if(!o||!window.XDBGSCOREBOARDWIN||e.id!==window.XDBGSCOREBOARDWIN.id)return clearInterval(t);try{ge((await gn.get(`/api/admin/room/${o.id}/debug`)).result)}catch(e){console.error(e)}}),1e3);e.id=t,window.XDBGSCOREBOARDWIN=e,Os(!0)},{createRoom:B,joinRoom:w,leaveRoom:k,sendChatMessage:M,startRoom:E,switchBracket:R,switchBracketHost:W,pushRoomConfigString:T,saveRoomConfig:z,clearRoomConfig:F,setRoomID:I,loadListing:re,kickUser:O,unbanUser:H,transferOwnership:$,takeOwnership:N,enterMatchmaking:be,leaveMatchmaking:Ce,startMidgameSpectate:xe,enterMidgame:Ae,replaceMidgame:ye,forfeitMidgame:ve,dropMultiplex:()=>{xt("spectate").classList.add("hidden"),document.body.classList.remove("multiplexed"),document.body.classList.remove("inmulti"),document.body.classList.remove("spectating"),document.body.classList.remove("room_spectating"),document.body.classList.remove("room_midgame_spectating"),document.body.classList.remove("inpair");try{window.ramp?.setPath?.("ROS")}catch{}Fa?.End(),na.FadeOutBgm(),pe(!1),xt("leaveroom").classList.remove("hidden"),xt("waitstate").classList.contains("hidden")||(na.SetBGMLowPassFilter(!1),xt("waitstate").classList.add("hiding"),setTimeout((()=>{xt("waitstate").classList.add("hidden")}),500)),Si(!0),za=!1,h=!1},stopSpectating:(e=!1)=>{if(Oa.dropMultiplex(),!e){Si(!0),Li("lobby");try{na.PlayBgmSmoothly(o.lobbybgm)}catch{}}},addChatMessage:te,showAnnouncement:e=>{te({content:e,user:{username:"[SYS]",_id:null},system:!1,announcement:!0})},returnToRoom:()=>{r="lobby",Mr("online",r,o.public?o.id:"X-PRIV");try{na.PlayBgmSmoothly(o.lobbybgm)}catch{}},isInRoom:()=>p,getRoomUsernames:(e="")=>o.players.map((e=>e.username)).filter((t=>t.startsWith(e))),getCurrentMatch:()=>u}})(),Ha={test:e=>({pri:"#34F479",sec:"#000",img_main:"/user-content/avatars/5e331c3ce24a5a3e258f7a1b.jpg?rv=1601325213424",img_sub:null,header:"Test notification",content:e.data.message,action:null}),announcement:e=>({pri:e.data.pri||"#87E038",sec:e.data.sec||"#000",img_main:e.data.img_main||"/res/icon/announcement.svg",img_sub:e.data.img_sub||null,header:e.data.header,content:e.data.content,action:e.data.action||null}),supporter_new:e=>({pri:"#FF4A19",sec:"#000",img_main:"/res/supporter-icon.png",img_sub:null,header:"You are now a TETR.IO Supporter!",content:"Thank you very, <b>very</b> much for supporting TETR.IO. Without support from people like you, TETR.IO could never be what it is now! You're awesome ",action:null}),supporter_gift:e=>({pri:"#FF4A19",sec:"#FF4A19",img_main:e.data.avatar_revision?`/user-content/avatars/${e.data.userid}.jpg?rv=${e.data.avatar_revision}`:Et(e.data.userid),img_sub:"/res/supporter-icon-alpha.png",header:`<span>${e.data.username.toUpperCase()}</span>`,content:`has gifted you <b>${e.data.months} month${1===e.data.months?"":"s"}</b> of <b>TETR.IO Supporter</b>!`,action:`user:${e.data.userid}`}),supporter_specialthanks:e=>({pri:"#E43868",sec:"#000",img_main:"/res/heart-icon.png",img_sub:null,header:"YOU ARE AWESOME!",content:"Thank you very, <b>very</b> much for your insane amount of support. You are now <b>listed in the Special Thanks of the game itself</b>, as thanks for your support!",action:null}),supporter_expiring:e=>({pri:"#A4523C",sec:"#000",img_main:"/res/supporter-icon-expiring.png",img_sub:null,header:"Your TETR.IO Supporter status is expiring soon!",content:`Thank you very much for your support. Your Supporter status will expire on <b>${new Date(e.data.expires).toLocaleString()}</b>. To continue supporting TETR.IO, please click here to add months.`,action:"support"}),supporter_expired:e=>({pri:"#888888",sec:"#000",img_main:"/res/supporter-icon-expired.png",img_sub:null,header:"Your TETR.IO Supporter status has expired",content:"Your Supporter status may have expired, but you'll forever be in my heart. If you wish to support TETR.IO again, you may click here to rejoin.",action:"support"}),friend:e=>{const t=e.data.relationship.from;return{pri:e.data.ismutual?"#E05DC3":"#E43868",sec:e.data.ismutual?"#E05DC3":"#E43868",img_main:t.avatar_revision?`/user-content/avatars/${t._id}.jpg?rv=${t.avatar_revision}`:Et(t._id),img_sub:"/res/icon/friends.svg",header:`<span>${t.username.toUpperCase()}</span>`,content:e.data.ismutual?"has <b>friended you back</b>":"has added you to their <b>friends list</b>",action:`user:${t._id}`}},noop_forfeit_notice:e=>({pri:"#FFC700",sec:"#000",img_main:"/res/forfeitnotice.png",img_sub:null,header:"You forfeited a ranked match",content:"You have been awarded a loss for this match. Please ensure you have the time and internet connection to play! Repeated forfeits are punished (and will be automatically punished in the future). Thank you for understanding!"}),forfeit_both:e=>({pri:"#3f6ac0",sec:"#000",img_main:"/res/forfeit-both.png",img_sub:null,header:"Your match has been canceled",content:`Both you and <b><span>${e.data.user.username.toUpperCase()}</span></b> have left the match. The match has been declared No Contest: no player is punished, no player's rating is changed.`}),achievement:e=>{const t={0:"#828282",1:"#ce7b4a",2:"#a8dad7",3:"#ffb300",4:"#4eff80",5:"#c885ff",100:"#ffaccc"};return{pri:t[e.data.rank],sec:"#000",img_main:`/res/achievements/frames/${{0:"none",1:"bronze",2:"silver",3:"gold",4:"platinum",5:"diamond",100:"issued"}[e.data.rank]}.png`,img_sub:null,header:"Achievement get!",content:`<b>${e.data.name}</b><br><span style="color: ${t[e.data.rank]}; font-style: italic; font-family: 'C';">${e.data.desc}<span><div class="ach_notif_icon" style="background-position: ${(e.data.k-1)%8*-100}% ${-100*Math.floor((e.data.k-1)/8)}%;"></div>`}}},Pa={test:e=>{Kt({header:"Test notification",msg:e.data.message,color:"#34F479",icon:"/user-content/avatars/5e331c3ce24a5a3e258f7a1b.jpg?rv=1601325213424",classes:["snotify"],timeout:1e4,suppressable:!0}),"both"!==it.notifications.other||Hr()||Bo("Test notification",e.data.message,!1,"/res/tetriox256.png"),Hr()||na.PlaySe("social_notify_major")},announcement:e=>{if(e.data.isinvite){if(Or())return;Kt({header:e.data.header,msg:`${e.data.content}<div class="notification_timeoutbar" style="--time: 24s;"></div>`,color:e.data.pri||"#87E038",subcolor:e.data.sec||"#000",icon:e.data.img_main||"/res/icon/announcement.svg",subicon:e.data.img_sub||null,classes:["snotify","modalnotify"],timeout:25e3,onclick:e=>{},buttons:[{label:"IGNORE",icon:"/res/icon/denied.svg",classes:[],onclick:e=>{e()}},{label:e.data.cta||"ACCEPT",icon:"/res/icon/accepted.svg",classes:["pri"],onclick:t=>{e.data.action&&Ar(e.data.action),t()}}]})}else Kt({header:e.data.header,msg:e.data.content,color:e.data.pri||"#87E038",subcolor:e.data.sec||"#000",icon:e.data.img_main||"/res/icon/announcement.svg",subicon:e.data.img_sub||null,classes:["snotify"],timeout:15e3,onclick:t=>{e.data.action&&Ar(e.data.action),t()}});"both"===it.notifications.other&&Bo(e.data.header,e.data.content,!1,e.data.img_main||"/res/tetriox256.png"),na.PlaySe("social_notify_major")},supporter_new:e=>{Kt({header:"You are now a TETR.IO Supporter!",msg:"Thank you very, <b>very</b> much for supporting TETR.IO. Without support from people like you, TETR.IO could never be what it is now! You're awesome ",color:"#FF4A19",icon:"/res/supporter-icon.png",classes:["snotify"],timeout:3e4}),document.body.classList.add("supporter"),document.body.classList.add("ceriad_exempt"),document.body.classList.add("ceriad_disabled"),Ps.unmountAll(),localStorage.setItem("wasLastSupporter","Yes, that's it!"),document.cookie=`ceriad_exempt=1;max-age=31536000;domain=${_.domain}`,"both"===it.notifications.other&&Bo("You are now a TETR.IO Supporter!","Thank you very, very much for supporting TETR.IO. Without support from people like you, TETR.IO could never be what it is now! You're awesome ",!1,"/res/supporter-icon.png")},supporter_gift:e=>{Kt({header:`<span>${e.data.username.toUpperCase()}</span>`,msg:`has gifted you <b>${e.data.months} month${1===e.data.months?"":"s"}</b> of <b>TETR.IO Supporter</b>!`,color:"#FF4A19",subcolor:"#FF4A19",icon:e.data.avatar_revision?`/user-content/avatars/${e.data.userid}.jpg?rv=${e.data.avatar_revision}`:Et(e.data.userid),subicon:"/res/supporter-icon-alpha.png",classes:["snotify"],timeout:3e4,onclick:t=>{Ar(`user:${e.data.userid}`),t()}}),na.PlaySe("supporter"),document.body.classList.add("supporter"),document.body.classList.add("ceriad_exempt"),Ps.unmountAll(),document.body.classList.add("ceriad_disabled"),localStorage.setItem("wasLastSupporter","Yes, that's it!"),document.cookie=`ceriad_exempt=1;max-age=31536000;domain=${_.domain}`,qi.expires=qi.hasSupporter?qi.expires+1e3*e.data.months*3600*24*30.5:Date.now()+1e3*e.data.months*3600*24*30.5,qi.hasSupporter=qi.expires>Date.now(),Yi(),"both"===it.notifications.other&&Bo(e.data.username.toUpperCase(),`has gifted you ${e.data.months} month${1===e.data.months?"":"s"} of TETR.IO Supporter!`,!1,e.data.avatar_revision?`/user-content/avatars/${e.data.userid}.jpg?rv=${e.data.avatar_revision}`:"/res/tetriox256.png")},supporter_specialthanks:e=>{Kt({header:"YOU ARE AWESOME!",msg:"Thank you very, <b>very</b> much for your insane amount of support. You are now <b>listed in the Special Thanks of the game itself</b>, as thanks for your support!",color:"#E43868",icon:"/res/heart-icon.png",classes:["snotify"],timeout:3e4}),"both"===it.notifications.other&&Bo("YOU ARE AWESOME!","Thank you very, very much for your insane amount of support. You are now listed in the Special Thanks of the game itself, as thanks for your support!",!1,"/res/heart-icon.png")},supporter_expiring:e=>{Kt({header:"Your TETR.IO Supporter status is expiring soon!",msg:`Thank you very much for your support. Your Supporter status will expire on <b>${new Date(e.data.expires).toLocaleString()}</b>. To continue supporting TETR.IO, please click here to add months.`,color:"#A4523C",icon:"/res/supporter-icon-expiring.png",classes:["snotify"],timeout:3e4,onclick:e=>{Ar("support"),e()}}),"both"===it.notifications.other&&Bo("Your TETR.IO Supporter status is expiring soon!",`Thank you very much for your support. Your Supporter status will expire on ${new Date(e.data.expires).toLocaleString()}. To continue supporting TETR.IO, please click here to add months.`,!1,"/res/supporter-icon-expiring.png")},supporter_expired:e=>{Kt({header:"Your TETR.IO Supporter status has expired",msg:"Your Supporter status may have expired, but you'll forever be in my heart. If you wish to support TETR.IO again, you may click here to rejoin.",color:"#888888",icon:"/res/supporter-icon-expired.png",classes:["snotify"],timeout:3e4,onclick:e=>{Ar("support"),e()}}),"both"===it.notifications.other&&Bo("Your TETR.IO Supporter status has expired","Your Supporter status may have expired, but you'll forever be in my heart. If you wish to support TETR.IO again, you may click here to rejoin.",!1,"/res/supporter-icon-expired.png")},friend:e=>{const t=e.data.relationship.from;Kt({header:`<span>${t.username.toUpperCase()}</span>`,msg:e.data.ismutual?"has <b>friended you back</b>":"has added you to their <b>friends list</b>",color:e.data.ismutual?"#E05DC3":"#E43868",subcolor:e.data.ismutual?"#E05DC3":"#E43868",icon:t.avatar_revision?`/user-content/avatars/${t._id}.jpg?rv=${t.avatar_revision}`:Et(t._id),subicon:"/res/icon/friends.svg",classes:["snotify"],timeout:1e4,onclick:e=>{Ar(`user:${t._id}`),e()},suppressable:!0}),"both"!==it.notifications.other||Hr()||Bo(t.username.toUpperCase(),e.data.ismutual?"has friended you back":"has added you to their friends list",!1,t.avatar_revision?`/user-content/avatars/${t._id}.jpg?rv=${t.avatar_revision}`:"/res/tetriox256.png"),Hr()||na.PlaySe("social_notify_minor")},noop_forfeit_notice:e=>{Kt({header:"You forfeited a ranked match",msg:"You have been awarded a loss for this match. Please ensure you have the time and internet connection to play! Repeated forfeits are punished (and will be automatically punished in the future). Thank you for understanding!",color:"#FFC700",icon:"/res/forfeitnotice.png",classes:["snotify"],timeout:3e4}),"both"===it.notifications.other&&Bo("You forfeited a ranked match","You have been awarded a loss for this match. Please ensure you have the time and internet connection to play! Repeated forfeits are punished (and will be automatically punished in the future). Thank you for understanding!",!1,"/res/forfeitnotice.png")},forfeit_both:e=>{Kt({header:"Your match has been canceled",msg:`Both you and <b><span>${e.data.user.username.toUpperCase()}</span></b> have left the match. The match has been declared No Contest: no player is punished, no player's rating is changed.`,color:"#3f6ac0",icon:"/res/forfeit-both.png",classes:["snotify"],timeout:3e4}),"both"===it.notifications.other&&Bo("Your match has been canceled",`Both you and ${e.data.user.username.toUpperCase()} have left the match. The match has been declared No Contest: no player is punished, no player's rating is changed.`,!1,"/res/forfeit-both.png")},achievement:e=>{const t={0:"#828282",1:"#ce7b4a",2:"#a8dad7",3:"#ffb300",4:"#4eff80",5:"#c885ff",100:"#ffaccc"};Kt({header:"Achievement get!",msg:`<b>${e.data.name}</b><br><span style="color: ${t[e.data.rank]}; font-style: italic; font-family: 'C';">${e.data.desc}<span><div class="ach_notif_icon" style="background-position: ${(e.data.k-1)%8*-100}% ${-100*Math.floor((e.data.k-1)/8)}%;"></div>`,color:t[e.data.rank],icon:`/res/achievements/frames/${{0:"none",1:"bronze",2:"silver",3:"gold",4:"platinum",5:"diamond",100:"issued"}[e.data.rank]}.png`,classes:["snotify"],timeout:3e4}),na.PlaySe({0:"achievement_1",1:"achievement_1",2:"achievement_1",3:"achievement_2",4:"achievement_2",5:"achievement_3",100:"achievement_3"}[e.data.rank])}},Ra={online:(e,t,n)=>[e,t,n],away:(e,t,n)=>["online","away"].includes(e)?["away","",""]:[e,t,n],busy:(e,t,n)=>["online","away","busy"].includes(e)?["busy","",""]:[e,t,n],offline:(e,t,n)=>["offline","",""]},Wa={online:(e,t)=>{switch(e){case"menus":return{text:"In Menus",html:"In Menus",discord:{state:"In Menus",largeImageKey:"logo",instance:!1}};case"40l":return{text:"Playing 40 LINES",html:"Playing <b>40 LINES</b>",discord:{state:"40 LINES",largeImageKey:"logo",smallImageKey:"mode_40l",smallImageText:"40 LINES",startTimestamp:Date.now(),instance:!0}};case"blitz":return{text:"Playing BLITZ",html:"Playing <b>BLITZ</b>",discord:{state:"BLITZ",largeImageKey:"logo",smallImageKey:"mode_blitz",smallImageText:"BLITZ",startTimestamp:Date.now(),instance:!0}};case"zen":return{text:"Playing ZEN",html:"Playing <b>ZEN</b>",discord:{state:"ZEN",largeImageKey:"logo",smallImageKey:"mode_zen",smallImageText:"ZEN",startTimestamp:Date.now(),instance:!0}};case"custom":return{text:"Playing a custom game",html:"Playing a <b>custom game</b>",discord:{state:"CUSTOM GAME",largeImageKey:"logo",smallImageKey:"mode_custom",smallImageText:"CUSTOM GAME",startTimestamp:Date.now(),instance:!0}};case"lobby_end":case"lobby_spec":case"lobby_ig":case"lobby":{if("X-QP"===t)return{text:{lobby:"Spectating QUICK PLAY",lobby_ig:"Playing QUICK PLAY",lobby_end:"Ending a QUICK PLAY game",lobby_spec:"Spectating QUICK PLAY"}[e],html:{lobby:"Spectating <b>QUICK PLAY</b>",lobby_ig:"Playing <b>QUICK PLAY</b>",lobby_end:"Ending a <b>QUICK PLAY</b> game",lobby_spec:"Spectating <b>QUICK PLAY</b>"}[e],discord:{details:"QUICK PLAY",state:{lobby:"Spectating",lobby_ig:"In Game",lobby_end:"Game Ending",lobby_spec:"Spectating"}[e],largeImageKey:"logo",smallImageKey:"mode_zenith",smallImageText:"QUICK PLAY",instance:["lobby_spec","lobby_ig"].includes(e),startTimestamp:["lobby_spec","lobby_ig"].includes(e)?Date.now():void 0}};let n="In",s="In Lobby";"lobby_spec"===e&&(n="Spectating",s="Spectating"),"lobby_end"===e&&(n="Ending",s="Game Ending"),"lobby_ig"===e&&(s="In Game");let i="a custom room",o="an <b>online</b>";""!==t&&(i="a public custom room",o="a public <b>custom room</b>"),"X-PRIV"===t&&(i="a private custom room",o="a private <b>custom room</b>"),"X-ROYALE"===t&&(i="a ROYALE",o="a <b>ROYALE</b>");let a="game";"lobby"===e&&(a="lobby");const r={details:"X-ROYALE"===t?"ROYALE":"CUSTOM ROOM",state:s,largeImageKey:"logo",smallImageKey:"X-ROYALE"===t?"mode_royale":"mode_customroom",smallImageText:"X-ROYALE"===t?"ROYALE":"CUSTOM ROOM",instance:!1};return["lobby_spec","lobby_ig"].includes(e)&&(r.startTimestamp=Date.now(),r.instance=!0),{text:`${n} ${i} ${a}`,html:`${n} ${o} ${a}`,discord:r}}default:return{text:"Online",html:"Online",discord:{state:"Online",largeImageKey:"logo",instance:!1}}}},away:(e,t)=>({text:"Away",html:"Away",discord:{state:"Away",largeImageKey:"logo",instance:!1}}),busy:(e,t)=>{switch(e){case"tl_mm":return{text:"In TETRA LEAGUE queue",html:"In <b>TETRA LEAGUE</b> queue",discord:{details:"TETRA LEAGUE",state:"In Queue",largeImageKey:"logo",smallImageKey:"mode_league",smallImageText:"TETRA LEAGUE",instance:!1}};case"tl":return{text:"In a TETRA LEAGUE game",html:"In a <b>TETRA LEAGUE</b> game",discord:{details:"TETRA LEAGUE",state:"In Game",largeImageKey:"logo",smallImageKey:"mode_league",smallImageText:"TETRA LEAGUE",startTimestamp:Date.now(),instance:!0}};case"tl_end":return{text:"Ending a TETRA LEAGUE game",html:"Ending a <b>TETRA LEAGUE</b> game",discord:{details:"TETRA LEAGUE",state:"Game Ending",largeImageKey:"logo",smallImageKey:"mode_league",smallImageText:"TETRA LEAGUE",instance:!1}};case"tl_mm_complete":return{text:"Found a TETRA LEAGUE match",html:"Found a <b>TETRA LEAGUE</b> match",discord:{details:"TETRA LEAGUE",state:"Match Found",largeImageKey:"logo",smallImageKey:"mode_league",smallImageText:"TETRA LEAGUE",instance:!1}};default:return{text:"Busy",html:"Busy",discord:{state:"Busy",largeImageKey:"logo",instance:!1}}}},offline:(e,t)=>({text:"Offline",html:"Offline",discord:{state:"Offline",largeImageKey:"logo",instance:!1}})},$a=["5e32fe50d3e20d2bd2bf234f","5e3324299380f13edda2b1b1","5e3361351da5014141c84788","5e342a67f3cfa44539619a85","5e41118d4be6907ad7eab8b2","5e504fe2278d291d983fd847","5eeaa5535b5c156c224f5265","5e49a95efad3ca55f6512742","5e98b21e77ea8f7e30009287","5e7679c65bc0c31aba22746d","5e4979d4fad3ca55f6512458","60cc700a866c6a2d2c8740a7","5e40866a4be6907ad7eab093","6049b70b3e33d5b0d2398f53"],Na={total_online:0,notifications:[],relationships:[],presence:{status:"offline",realstatus:"offline",detail:"",realdetail:"",mask:"online",last:null},dms:{}};void 0!==localStorage.getItem("presenceMask")&&["online","away","busy","offline"].includes(localStorage.getItem("presenceMask"))&&(Na.presence.mask=localStorage.getItem("presenceMask"));const Ua=new Map;function Ga(e){const t=()=>{Oa.isInRoom()&&(Oa.leaveRoom(!0),Fa?.End(),Oa.dropMultiplex()),Rs.stopNow(),Fi(),un(),Di("connecting to live servers"),Sa.require().then((t=>{Oi(),Li("playmulti"),Si(!0),t.maintenance&&document.body.classList.add("maintenance"),Oa.joinRoom(e),Rs.stopNow()})).catch((()=>{Oi(),Yt("could not connect to live servers")}))};document.body.classList.contains("ingame_phys")?dn({title:"LEAVE CURRENT GAME?",msg:"you're still in game. abandon the current game?",buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"LEAVE",classes:["sec"],callback:e=>{e(),t()}}]}):t()}function Xa(e){const t=()=>{document.body.classList.contains("inzenith")?pi?.endNow():(Oa.isInRoom()&&(Ma=!0,Fa?.End(),Oa.dropMultiplex()),Rs.stopNow()),Fi(),un(),Di("connecting to live servers"),Sa.require().then((t=>{Oi(),t.maintenance&&document.body.classList.add("maintenance"),document.body.classList.contains("inzenith")&&!document.body.classList.contains("ingame_phys")?(Fa.SetSpectate(null),Fa._Refresh(),Si(!0),xt("zenithmenu").classList.remove("rolledup","thidden"),xt("zenithmenu").getBoundingClientRect(),xt("zenithmenu").classList.remove("hidden"),yt("#zenithmenu .menuslide_rollup").forEach((e=>e.textContent="SPECTATE")),xt("zenithmenu").classList.remove("inresults"),xt("start_zenith_label").textContent="START",ii.bindGuide(oi.zenith||{}),xt("zenithmenu").scrollTop=0):document.body.classList.contains("inzenith")?(Ma=!0,Fa.games.self?.end(),Fa.SetSpectate(null),Fa._Refresh(),Si(!0),xt("zenithmenu").classList.remove("rolledup","thidden"),xt("zenithmenu").getBoundingClientRect(),xt("zenithmenu").classList.remove("hidden"),yt("#zenithmenu .menuslide_rollup").forEach((e=>e.textContent="SPECTATE")),xt("zenithmenu").classList.remove("inresults"),xt("start_zenith_label").textContent="START",ii.bindGuide(oi.zenith||{}),xt("zenithmenu").scrollTop=0,Pi()):(Rs.stopNow(),Pi()),xt("zenith_deck").classList.add("updating_initial"),xt("zenith_party_ready_label").textContent="READY",xt("zenith_party_ready").classList.remove("ready"),xt("zenith_party_self").classList.remove("ready"),Sa.emit("social.party.invite.accept",{inviteid:e,replace:!0})})).catch((()=>{Oi(),Yt("could not connect to live servers")}))};document.body.classList.contains("ingame_phys")?dn({title:"LEAVE CURRENT GAME?",msg:"you're still in game. abandon the current game?",buttons:[{label:"CANCEL",classes:[],callback:e=>{e()}},{label:"LEAVE",classes:["sec"],callback:e=>{e(),t()}}]}):t()}kn.ready((function(){xt("social_tray").addEventListener("click",(function(){Qa()})),xt("social").addEventListener("click",(function(e){e.target===xt("social")&&Ya()})),xt("social_relationships_tabs").addEventListener("click",(function(e){e.target.classList.contains("social_relationships_tab")&&(xt("social_relationships_find").value="",setTimeout((()=>{Fr(),tr()}),0))})),xt("social_relationships_find").addEventListener("keyup",(function(){xt("sbcpw").scrollTop=0,Fr(),xt("social_relationships_find").value&&tr()})),xt("social_back").addEventListener("click",(function(){tr()})),xt("social_status").addEventListener("click",(function(){Ti([{id:"online",name:'<img style="height: 0.88em; vertical-align: middle;" src="/res/status/online.png" /> ONLINE',description:"appear as usual"},{id:"away",name:'<img style="height: 0.88em; vertical-align: middle;" src="/res/status/away.png" /> AWAY',description:"appear away, unless you're offline or busy"},{id:"busy",name:'<img style="height: 0.88em; vertical-align: middle;" src="/res/status/busy.png" /> BUSY',description:"appear busy, unless you're offline. receive no notifications. always enabled in TETRA LEAGUE (unless you're invisible)"},{id:"offline",name:'<img style="height: 0.88em; vertical-align: middle;" src="/res/status/offline.png" /> INVISIBLE',description:"appear offline at all times"}],(e=>{localStorage.setItem("presenceMask",e),Mr(Na.presence.realstatus,Na.presence.realdetail.split(":")[0],Na.presence.realdetail.split(":")[1],e)}),!0)})),xt("social_dm_button_profile").addEventListener("click",(function(){Za||tr(),oa({userID:Za.to._id})})),xt("social_dm_button_gift").addEventListener("click",(function(){Za||tr(),xi(void 0,Za.to.username)})),xt("social_dm_button_invite").addEventListener("click",(function(){if(Za||tr(),!xt("social_dm_button_invite").classList.contains("active"))return document.body.classList.contains("inzenith")?(xt("zenith-duo-card").classList.contains("active")||xt("zenith-duo-card").click(),Sa&&Sa.isConnected()&&Sa.emit("social.party.invite",Za.to._id),Za.inv_locked_until=Date.now()+3e4,void Ir()):void(Oa.isInRoom()&&xt(`sp_${Za.to._id}`)?Yt("this person is already in your room"):(Sa&&Sa.isConnected()&&Sa.emit("social.invite",Za.to._id),Za.inv_locked_until=Date.now()+3e4,Ir()))})),xt("social_dm_button_snipe").addEventListener("click",(function(){Za||tr(),xt("social_dm_button_snipe").classList.contains("active")||(Oa.isInRoom()&&xt(`sp_${Za.to._id}`)?Yt("you are already in their room"):(Za.presence.detail.split(":")[1]&&(Ga(Za.presence.detail.split(":")[1]),Ya()),Ir()))})),xt("social_dm_input").addEventListener("keydown",ar),xt("social_chat").addEventListener("mouseover",(function(e){let t=e.target;(t.classList.contains("dm_chat_message")||(t=t.closest(".dm_chat_message"),t))&&t.getAttribute("data-ts")&&t.setAttribute("data-time",`${wt(Date.parse(t.getAttribute("data-ts")))} ago`)})),Sa.on("server.authorize",(e=>{Na.total_online=e.social.total_online,Na.notifications=e.social.notifications,Na.relationships=e.social.relationships,Na.dms={};const t=[],n=[];let s=null;if(Na.relationships.forEach((i=>{e.social.presences[i.to._id]?(i.presence=e.social.presences[i.to._id],["offline","unknown"].includes(i.presence.status)||(t.push(i.to.username.toUpperCase()),s=i.to._id,i.to.avatar_revision&&n.push({id:i.to._id,avatar_revision:i.to.avatar_revision}))):i.presence={status:"offline",detail:"",invitable:!1}})),Sa.emit("social.presence",{status:Na.presence.status,detail:Na.presence.detail}),t.length){const e=Kt({header:`<span>${t.slice(0,10).join("</span>, <span>")}</span>${t.length>10?` and ${t.length-10} more`:""}`,msg:'<img src="/res/status/online.png" style="height: 1em; vertical-align: -10%;" /> online now',color:Sr.online,icon:n.length?`/user-content/avatars/${n[0].id}.jpg?rv=${n[0].avatar_revision}`:Et(s),classes:["snotify"],timeout:5e3,onclick:e=>{e(),Qa()},suppressable:!0});for(let t=1;t<Math.min(n.length,5);t++)setTimeout((()=>{e.parentNode&&(e.querySelector(".notification_icon").src=`/user-content/avatars/${n[t].id}.jpg?rv=${n[t].avatar_revision}`)}),5e3/Math.min(n.length,5)*t)}Va&&(Fr(),ur(),dr(),tr()),br(),_r(),mr()})),Sa.on("social.online",(e=>{Na.total_online=e,Va&&dr()})),Sa.on("social.notification",(e=>{e.data.fake||(Na.notifications.unshift(e),Va&&ur(),_r()),Pa[e.type]&&Pa[e.type](e)})),Sa.on("social.relation.add",(e=>{e.presence={status:"offline",detail:"",invitable:!1},Na.relationships.push(e),Va&&Fr(),mr(),br()})),Sa.on("social.relation.remove",(e=>{Na.relationships=Na.relationships.filter((t=>t._id!==e)),Va&&Fr(),mr(),br(),Ja&&Za._id===e&&tr()})),Sa.on("social.relation.clear",(()=>{Na.relationships=Na.relationships.filter((e=>"pending"!==e.type)),Va&&Fr(),mr(),Ja&&"pending"===Za.type&&tr()})),Sa.on("social.relation.update",(e=>{Na.relationships.forEach((t=>{t.to._id===e.user&&(t.to.username=e.username,t.to.avatar_revision=e.avatar_revision)})),wr=!0,Va&&(Fr(),Ja&&Za.to._id===e.user&&sr())})),Sa.on("social.presence",(e=>{let t=null;Na.relationships.forEach((n=>{n.to._id===e.user&&(["offline","unknown"].includes(n.presence.status)&&!["offline","unknown"].includes(e.presence.status)?(!n.silenced_until||n.silenced_until<Date.now())&&(n.silenced_until=Date.now()+3e5,"off"!==it.notifications.online&&(Kt({header:`<span>${n.to.username.toUpperCase()}</span>`,msg:`<img src="/res/status/${e.presence.status}.png" style="height: 1em; vertical-align: -10%;" /> has come online`,color:Sr[e.presence.status],icon:n.to.avatar_revision?`/user-content/avatars/${n.to._id}.jpg?rv=${n.to.avatar_revision}`:Et(n.to._id),classes:["snotify"],timeout:5e3,onclick:e=>{e(),er(n)},suppressable:!0}),Hr()||na.PlaySe("social_online",.7)),"both"!==it.notifications.online||Hr()||Bo(n.to.username.toUpperCase(),"has come online",!1,n.to.avatar_revision?`/user-content/avatars/${n.to._id}.jpg?rv=${n.to.avatar_revision}`:"/res/tetriox256.png")):["offline","unknown"].includes(e.presence.status)&&!["offline","unknown"].includes(n.presence.status)&&(!n.silenced_until||n.silenced_until<Date.now())&&(n.silenced_until=Date.now()+3e5,"off"!==it.notifications.offline&&(Kt({header:`<span>${n.to.username.toUpperCase()}</span>`,msg:'<img src="/res/status/offline.png" style="height: 1em; vertical-align: -10%;" /> has gone offline',color:Sr.offline,icon:n.to.avatar_revision?`/user-content/avatars/${n.to._id}.jpg?rv=${n.to.avatar_revision}`:Et(n.to._id),classes:["snotify"],timeout:5e3,onclick:e=>{e(),er(n)},suppressable:!0}),Hr()||na.PlaySe("social_offline",.7)),"both"!==it.notifications.offline||Hr()||Bo(n.to.username.toUpperCase(),"has gone offline",!1,n.to.avatar_revision?`/user-content/avatars/${n.to._id}.jpg?rv=${n.to.avatar_revision}`:"/res/tetriox256.png")),n.presence=e.presence,Ja&&Za._id===n._id&&["offline","unknown"].includes(e.presence.status)&&xt("social_relationships_tabs_online").classList.contains("active")&&(xt("social_relationships_tabs_online").classList.remove("active"),xt("social_relationships_tabs_friends").classList.add("active"),t=n._id))})),Va&&(Fr(),sr(),null!==t&&xt(`social_relationship_${t}`)&&setTimeout((()=>{xt(`social_relationship_${t}`)&&xt(`social_relationship_${t}`).scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),50)),br()})),Sa.on("social.dm",(e=>{const t=e.stream.replace(mn.id(),"").replace(":","");void 0!==Na.dms[t]&&(Na.dms[t].push(e),Na.dms[t].length>250&&Na.dms[t].shift(),Va&&Ja&&Za.to._id===t&&ir()),e.data.user===mn.id()||Va&&Ja&&Za.to._id===t&&!document.body.classList.contains("nofocus")?Va&&Ja&&Za&&xr(Za):(Na.relationships.forEach((n=>{if(n.to._id!==t)return;Va&&Ja&&Za.to._id===t?xr(n,!0):n.unread++;let s={};s=e.data.user===n.to._id?{username:n.to.username,_id:n.to._id,...e.data.userdata||{}}:{username:e.data.user,_id:null,...e.data.userdata||{}};let i=e.data.content;if(!1!==it.video.chatfilter&&e.data.content_safe&&(i=e.data.content_safe),"off"===("friend"===n.type?it.notifications.dm:it.notifications.dm_pending)||Or()||(Kt({header:`<span>${n.to.username.toUpperCase()}</span>`,msg:Hn(St(i),s,!1===it.video.emotes_anim),color:"#A2CEE8",icon:n.to.avatar_revision?`/user-content/avatars/${n.to._id}.jpg?rv=${n.to.avatar_revision}`:Et(n.to._id),subcolor:"#000",subicon:"/res/icon/message-bw.svg",classes:["snotify","snotifydm"],timeout:5e3,onclick:e=>{e(),er(n)}}),na.PlaySe("social_dm")),"both"===("friend"===n.type?it.notifications.dm:it.notifications.dm_pending)&&!Or()){let e=i;if(Ua.get(n.to._id)){for(Ua.get(n.to._id).push(i);Ua.get(n.to._id).length>4;)Ua.get(n.to._id).shift();e=Ua.get(n.to._id).join("\n")}else Ua.set(n.to._id,[i]);Bo(n.to.username.toUpperCase(),e,!1,n.to.avatar_revision?`/user-content/avatars/${n.to._id}.jpg?rv=${n.to.avatar_revision}`:"/res/tetriox256.png",n.to._id,(()=>{er(n)}))}})),Va&&Fr()),mr()})),Sa.on("social.invite",(e=>{Or()||Na.relationships.forEach((t=>{if(t.to._id!==e.sender)return;let n=e.roomname;!1!==it.video.chatfilter&&e.roomname_safe&&(n=e.roomname_safe),Kt({header:`<span>${t.to.username.toUpperCase()}</span>`,msg:`invited you to <b>${St(n)}</b><div class="notification_timeoutbar" style="--time: 24s;"></div>`,color:"#FF008A",icon:t.to.avatar_revision?`/user-content/avatars/${t.to._id}.jpg?rv=${t.to.avatar_revision}`:Et(t.to._id),subcolor:"#FF008A",subicon:"/res/icon/invite.svg",classes:["snotify","modalnotify"],timeout:25e3,onclick:()=>{},buttons:[{label:"IGNORE",icon:"/res/icon/denied.svg",classes:[],onclick:e=>{e()}},{label:"ACCEPT",icon:"/res/icon/accepted.svg",classes:["pri"],onclick:t=>{if("busy"===Na.presence.realstatus)return Yt("you cannot accept this invite now"),void t();Ga(e.roomid),t()}}]}),na.PlaySe("social_invite"),"both"===it.notifications.invite&&Bo(t.to.username.toUpperCase(),`invited you to "${n}"`,!1,t.to.avatar_revision?`/user-content/avatars/${t.to._id}.jpg?rv=${t.to.avatar_revision}`:"/res/tetriox256.png")}))})),Sa.on("social.party.invite",(e=>{Or()||Na.relationships.forEach((t=>{t.to._id===e.sender&&(Kt({header:`<span>${t.to.username.toUpperCase()}</span>`,msg:'invited you to team up in <b>QUICK PLAY</b><div class="notification_timeoutbar" style="--time: 24s;"></div>',color:"#FF008A",icon:t.to.avatar_revision?`/user-content/avatars/${t.to._id}.jpg?rv=${t.to.avatar_revision}`:Et(t.to._id),subcolor:"#FF008A",subicon:"/res/icon/invite.svg",classes:["snotify","modalnotify"],timeout:25e3,onclick:()=>{},buttons:[{label:"IGNORE",icon:"/res/icon/denied.svg",classes:[],onclick:e=>{e()}},{label:"ACCEPT",icon:"/res/icon/accepted.svg",classes:["pri"],onclick:t=>{if("busy"===Na.presence.realstatus)return Yt("you cannot accept this invite now"),void t();Xa(e.inviteid),t()}}]}),na.PlaySe("social_invite"),"both"===it.notifications.invite&&Bo(t.to.username.toUpperCase(),"invited you to team up in QUICK PLAY",!1,t.to.avatar_revision?`/user-content/avatars/${t.to._id}.jpg?rv=${t.to.avatar_revision}`:"/res/tetriox256.png"))}))})),document.addEventListener("keydown",t,!1),document.addEventListener("gpdown",t,!1);let e=0;function t(t){Object.keys(at).forEach((n=>{if(at[n].includes(Ct(t))){let s=!1;if(["social_relationships_find","social_dm_input"].includes(document.activeElement.id)&&"BACKSPACE"!==Ct(t)&&(s=!0),!s&&["input","textarea"].includes(document.activeElement.tagName.toLowerCase()))return;if("menuDown"===n){if(Va&&!Ja){if(At(".social_relationship.focus")){const e=At(".social_relationship.focus");e.nextElementSibling?(e.classList.remove("focus"),e.nextElementSibling.classList.add("focus"),e.nextElementSibling.scrollIntoView({behavior:"auto",block:"center",inline:"start"})):(e.classList.remove("focus"),e.parentElement.firstElementChild.classList.add("focus"),e.parentElement.firstElementChild.scrollIntoView({behavior:"auto",block:"center",inline:"start"}))}["DOWN","ARROWDOWN"].includes(Ct(t))&&(t.stopPropagation(),t.preventDefault())}}else if("menuUp"===n&&Va&&!Ja){if(At(".social_relationship.focus")){const e=At(".social_relationship.focus");e.previousElementSibling?(e.classList.remove("focus"),e.previousElementSibling.classList.add("focus"),e.previousElementSibling.scrollIntoView({behavior:"auto",block:"center",inline:"start"})):(e.classList.remove("focus"),e.parentElement.lastElementChild.classList.add("focus"),e.parentElement.lastElementChild.scrollIntoView({behavior:"auto",block:"center",inline:"start"}))}["UP","ARROWUP"].includes(Ct(t))&&(t.stopPropagation(),t.preventDefault())}if(t.repeat)return;"openSocial"===n?(Va?Ya():Qa(),t.stopPropagation(),t.preventDefault()):"menuBack"===n||"ESCAPE"===Ct(t)?Va&&("social_dm_input"===document.activeElement.id?(e=Date.now()+50,tr()):e<Date.now()&&Ya(),t.stopPropagation(),t.preventDefault()):"menuConfirm"===n&&Va&&!Ja&&At(".social_relationship.focus")&&At(".social_relationship.focus").click()}}))}})),window.DEVHOOK_FAST_JOIN_ROOM=e=>{Ga(e)};let ja=null,qa=null,Ka=0,Va=!1;function Qa(){Va||mn.anon()||(ja&&(clearTimeout(ja),ja=null),qa&&clearInterval(qa),pr(),xt("social").classList.remove("hidden"),xt("social").getBoundingClientRect(),xt("social").classList.remove("hiding"),xt("social_relationships_find").value="",xt("sbcpw").scrollTop=-200,xt("social_relationships_tabs_online").classList.contains("active")&&0===Na.relationships.filter((e=>["online","away","busy"].includes(e.presence.status)&&"friend"===e.type)).length&&(xt("social_relationships_tabs_online").classList.remove("active"),xt("social_relationships_tabs_friends").classList.add("active")),qa=setInterval((()=>{pr(),++Ka%600==0&&Va&&Fr()}),100),Va=!0,na.PlaySe("social_open"),dr(),ur(),sr(),ir(),Ir(),ii.push(),ii.bindGuide(oi.social),ii.disengage(),Gi(),Ja?(requestAnimationFrame((()=>{xt("social_dm_input").focus()})),Za&&Za.unread&&xr(Za)):requestAnimationFrame((()=>{xt("social_relationships_find").focus()})),Fr())}function Ya(){Va&&(mn.anon()||(ja&&clearTimeout(ja),qa&&(clearInterval(qa),qa=null),xt("social").classList.add("hiding"),ja=setTimeout((()=>{xt("social").classList.add("hidden")}),300),Cr(),_r(),Ja&&Za&&Za.unread&&xr(Za),Va=!1,na.PlaySe("social_close"),ii.pop(),Xi()))}let Ja=!1,Za=null;function er(e,t=!1){if(Va||Qa(),Ja&&Va&&t&&Za._id===e._id)return void tr();if(xt("social_people").classList.add("collapsed"),yt(".social_relationship").forEach((e=>{e.classList.remove("active")})),!xt(`social_relationship_${e._id}`)){let t=!1;if(Na.relationships.forEach((n=>{n._id===e._id&&("friend"===e.type?(yt(".social_relationships_tab").forEach((e=>{e.classList.remove("active")})),xt("social_relationships_tabs_friends").classList.add("active"),t=!0):"pending"===e.type&&(yt(".social_relationships_tab").forEach((e=>{e.classList.remove("active")})),xt("social_relationships_tabs_pending").classList.add("active"),t=!0))})),t&&(Fr(),!xt(`social_relationship_${e._id}`)))return tr(),void xt("social_people").classList.remove("collapsed")}let n=!1;Za&&Za.unread&&(xr(Za),n=!0),xt(`social_relationship_${e._id}`).classList.add("active"),setTimeout((()=>{xt(`social_relationship_${e._id}`)&&xt(`social_relationship_${e._id}`).scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}),50),Ja||na.PlaySe("social_open_minor"),Ja=!0,Za=e,sr(),void 0===Na.dms[e.to._id]?(ir(!0),gn.get(`/api/dms/${e.to._id}`).then((t=>{Na.dms[e.to._id]=t.dms.reverse(),ir()}),(e=>{Oi(),en(e)}))):ir(),e.unread&&(xr(e),n=!0),n&&Fr(),requestAnimationFrame((()=>{xt("social_dm_input").focus()}))}function tr(){if(!Ja)return;xt("social_people").classList.remove("collapsed"),yt(".social_relationship").forEach((e=>{e.classList.remove("active")})),Ja&&na.PlaySe("social_close_minor"),Ja=!1,Za&&Za.unread&&(xr(Za),Fr());const e=xt("sbcpw").scrollTop;requestAnimationFrame((()=>{xt("social_relationships_find").focus(),xt("sbcpw").scrollTop=e}))}function nr(e){Na.relationships.forEach((t=>{t.to._id===e&&er(t)}))}function sr(){if(!Ja||!Za)return;const e=Za;if(xt("social_dm_img").src=e.to.avatar_revision?`/user-content/avatars/${e.to._id}.jpg?rv=${e.to.avatar_revision}`:Et(e.to._id),xt("social_dm_username").innerHTML=e.to.username.toUpperCase(),xt("social_dm_username").classList.toggle("lu",e.to.username.length>14),xt("social_dm").classList.toggle("offline",!["online","away","busy"].includes(e.presence.status)),xt("social_dm_button_invite").classList.toggle("hidden",!e.presence.invitable),"friend"===e.type){const t=e.presence.detail.split(":"),n=Wa[e.presence.status](t[0]||"",t[1]||"");xt("social_dm_status").innerHTML=`<img src="/res/status/${e.presence.status}.png" /> ${n.html}`,xt("social_dm_button_snipe").classList.toggle("hidden",!(t[1]&&"X-PRIV"!==t[1]&&"online"===e.presence.status))}else switch(xt("social_dm_button_snipe").classList.add("hidden"),e.type){case"block":xt("social_dm_status").innerHTML='<img src="/res/status/blocked.png" /> Blocked';break;case"pending":xt("social_dm_status").innerHTML='<img src="/res/status/unknown.png" /> Not a friend';break;default:xt("social_dm_status").innerHTML='<img src="/res/status/unknown.png" /> Status unknown'}Ir()}function ir(e=!1){if(!Ja||!Za)return;const t=Za;let n=[];if(n=e?[{id:`${t.to._id}--loading`,data:{content:"Loading chat messages...",user:"[CMD]",system:!1,announcement:!1,banner:!0}}]:JSON.parse(JSON.stringify(Na.dms[t.to._id]||[])),n||(n=[]),n.unshift({id:`${t.to._id}--rules`,data:{content:"Please be civil. Staff will never ask for your credentials.",user:"[CMD]",system:!1,announcement:!1,banner:!0}}),"pending"===t.type&&n.unshift({id:`${t.to._id}--pending`,data:{content:`${t.to.username.toUpperCase()} isn't on your friends list. You can block them by clicking PROFILE. Don't want to receive DMs from strangers? Check your privacy settings in Config -> Account.`,user:"[CMD]",system:!1,announcement:!1,banner:!0}}),"osk"===t.to.username&&"friend"===t.type){let e=!1;n.forEach((n=>{n.data.user===t.to._id&&(e=!0)})),e||(n.unshift({id:`${t.to._id}--msgosk2`,data:{content:"Please do not message osk for TETR.IO support, such as account issues, ban appeals, verification requests, and any other requests for help. For help with such issues, please contact support (tetr.io/about/support). Your DM will be ignored at best.",user:"[CMD]",system:!1,announcement:!1,banner:!0,banner_color:"#FF008466"}}),n.unshift({id:`${t.to._id}--msgosk`,data:{content:"Do you really want to message osk? He's often very busy, and might not reply very quickly or at all, and does not accept invites. He tries to read every DM he gets, so please go easy on him, OK?",user:"[CMD]",system:!1,announcement:!1,banner:!0,banner_color:"#19FF9533",banner_img:"/res/emotes/kagari.png"}}))}else if("dimentio"===t.to.username&&"friend"===t.type){let e=!1;n.forEach((n=>{n.data.user===t.to._id&&(e=!0)})),e||(n.unshift({id:`${t.to._id}`,data:{content:"Please do not message Dimentio for TETR.IO support, such as account issues, ban appeals, verification requests, and any other requests for help. For help with such issues, please contact support (tetr.io/about/support). Your DM will be ignored at best.",user:"[CMD]",system:!1,announcement:!1,banner:!0,banner_color:"#FF008466"}}),n.unshift({id:`${t.to._id}`,data:{content:"Do not send maho emotes to Dimentio!! He likes them very much and is very likely to send them back. Be careful!",user:"[CMD]",system:!1,announcement:!1,banner:!0,banner_color:"#19FF9533",banner_img:"/res/emotes/mahoblush.png"}}))}else if($a.includes(t.to._id)&&"friend"===t.type){let e=!1;n.forEach((n=>{n.data.user===t.to._id&&(e=!0)})),e||n.unshift({id:`${t.to._id}--msgstaff`,data:{content:`Please do not message ${t.to.username.toUpperCase()} for TETR.IO support, such as account issues, ban appeals, verification requests, and any other requests for help. For help with such issues, please contact support (tetr.io/about/support). Your DM will be ignored at best.`,user:"[CMD]",system:!1,announcement:!1,banner:!0,banner_color:"#FF008466"}})}const s=n.map((e=>e.id));yt("#social_chat .chat_message").forEach((e=>{s.includes(e.getAttribute("data-id"))||e.remove()}));const i=new DocumentFragment;n.forEach((e=>{const n=e.data;n.user=n.user===t.from._id?{username:t.from.username,_id:t.from._id,...n.userdata||{}}:n.user===t.to._id?{username:t.to.username,_id:t.to._id,...n.userdata||{}}:{username:n.user,_id:null,...n.userdata||{}};xt(`social_dm_${e.id}`)||or(e,!1,i)})),xt("social_chat").appendChild(i),xt("sbdmcpw").scrollTop=xt("sbdmcpw").scrollHeight+100}function or(e,t=!1,n=null){if(Za&&t){const t=JSON.parse(JSON.stringify(e));t.data.user=t.data.user._id||t.data.user.username,Object.keys(Na.dms).forEach((e=>{e.replace(mn.id(),"").replace(":","")===Za.to._id&&Na.dms[e].push(t)}))}const s=e.data;!1!==it.video.chatfilter&&s.content_safe&&s.user._id!=mn.id()&&(s.content=s.content_safe);const i=document.createElement("div");i.classList.add("chat_message"),i.classList.add("dm_chat_message"),i.id=`social_dm_${e.id}`,i.setAttribute("data-id",e.id||null),e.ts&&i.setAttribute("data-ts",e.ts),s.banner&&i.classList.add("chat_banner"),s.banner_img&&i.classList.add("chat_banner_img"),s.system&&i.classList.add("system"),s.announcement&&i.classList.add("announcement"),s.user.supporter&&(i.classList.add("supporterchat"),i.classList.add(`supporterchat_t${s.user.supporter_tier}`)),"sysop"===s.user.role&&i.classList.add("sysopchat"),"admin"===s.user.role&&i.classList.add("adminchat"),"mod"===s.user.role&&i.classList.add("modchat"),"halfmod"===s.user.role&&i.classList.add("halfmodchat");const o=document.createElement("h1");o.textContent=s.user.username.toUpperCase(),s.user._id&&(o.classList.add("chat_tag"),o.setAttribute("data-id",s.user._id)),i.appendChild(o);const a=document.createElement("p"),r=St(s.content);let l=s.nosanitize?s.content:Hn(St(s.content),s.user,!1===it.video.emotes_anim);if(r===l?a.textContent=s.content:(0===l.replace(/<img class=(.+?) \/>/,"").length&&(l=l.replace('"emote"','"emote big"')),a.innerHTML=l),s.banner_color&&(a.style.color=s.banner_fgcolor||"#FFF",a.style.backgroundColor=s.banner_color,a.style.borderColor=s.banner_color),i.appendChild(a),s.banner_img){const e=document.createElement("img");e.classList.add("banner_img"),e.setAttribute("src",s.banner_img),i.appendChild(e)}(n||xt("social_chat")).appendChild(i),n||(xt("sbdmcpw").scrollTop=xt("sbdmcpw").scrollHeight+100)}function ar(e){if(!Za)return;if(e.repeat||e.isComposing)return;if("Enter"!==e.code&&"NumpadEnter"!==e.code)return;const t=e.target.value;t.length&&rr(Za.to._id,t),xt("social_dm_input").value=""}function rr(e,t){if(t.startsWith("/")){const e=t.split(" ");switch(e[0].toLowerCase()){case"/invite":case"/inv":case"/i":if(xt("social_dm_button_invite").classList.contains("hidden"))return void lr("Cannot invite this user right now");if(xt("social_dm_button_invite").classList.contains("active"))return void lr("Invite is on cooldown");xt("social_dm_button_invite").click(),lr("Invite sent");break;case"/snipe":case"/join":case"/j":if(xt("social_dm_button_snipe").classList.contains("hidden"))return void lr("Cannot join this user's room right now");xt("social_dm_button_snipe").click();break;case"/profile":case"/prof":case"/p":if(xt("social_dm_button_profile").classList.contains("hidden"))return void lr("Cannot check this user's profile");xt("social_dm_button_profile").click();break;case"/gift":case"/g":case"/support":case"/s":if(xt("social_dm_button_gift").classList.contains("hidden"))return void lr("Cannot gift this user right now");xt("social_dm_button_gift").click();break;case"/help":lr("Available commands: /INVITE (/INV, /I), /SNIPE (/S, /JOIN, /J), /PROFILE (/PROF, /P), /GIFT (/G, /SUPPORT, /S)");break;case"/kagari":lr(":kagari:");break;default:lr(`Unknown command ${e[0].toLowerCase()}`)}}else Sa&&Sa.isConnected()&&Sa.emit("social.dm",{recipient:e,msg:t})}function lr(e){or({id:`kagarin${Date.now()}${Math.floor(1e7*Math.random())}`,stream:"kagarin",data:{content:e,user:{username:"[CMD]",_id:null},system:!0,announcement:!1}},!0)}const cr=Date.now();function pr(){const e=(new Date).toLocaleTimeString().replace("AM","<span>AM</span>").replace("PM","<span>PM</span>");xt("social_top_clock").innerHTML=e,xt("social_top_sessiontime").innerHTML=`${wt(cr)} this session`}function dr(){xt("social_bottom_online").innerHTML=`${Na.total_online.toLocaleString()} ONLINE`}let hr=!1;function ur(){if(0===Na.notifications.length)return xt("social_notifications_content").innerHTML='<div class="social_empty"><img src="/res/social_working.png" /><p>Notifications will appear here.</p></div>',void(hr=!0);hr&&(xt("social_notifications_content").innerHTML="",hr=!1);let e=null;for(Na.notifications.forEach((t=>{let n=xt(`social_notification_${t._id}`);if(!n){if(!Ha[t.type])return;const s=Ha[t.type](t);if(n=document.createElement("div"),n.classList.add("social_notification"),n.id=`social_notification_${t._id}`,n.style=`--pri: ${s.pri}; --sec: ${s.sec};`,s.action&&(n.setAttribute("data-action",s.action),n.addEventListener("click",(()=>{Ar(s.action)}))),s.img_main){const e=document.createElement("img");e.classList.add("social_notification_img_main"),e.src=s.img_main,n.appendChild(e)}if(s.img_sub){const e=document.createElement("img");e.classList.add("social_notification_img_sub"),e.src=s.img_sub,n.appendChild(e)}const i=document.createElement("h1");i.innerHTML=s.header,n.appendChild(i);const o=document.createElement("h2");n.appendChild(o);const a=document.createElement("p");a.innerHTML=s.content,n.appendChild(a),e?e.insertAdjacentElement("afterend",n):xt("social_notifications_content").insertAdjacentElement("afterbegin",n)}n&&(n.querySelector("h2").innerHTML=kt(new Date(t.ts).getTime()),n.classList.toggle("unread",!t.seen),e=n)}));xt("social_notifications_content").children.length>100;)xt("social_notifications_content").removeChild(xt("social_notifications_content").children[100])}function _r(){let e=0;Na.notifications.forEach((t=>{t.seen||e++})),xt("social_tray").classList.toggle("unread_notifications",0!==e),xt("social_tray_badge_notifications").innerHTML=e,gr.notification=e,fr()}function mr(){let e=0;Na.relationships.forEach((t=>{e+=t.unread||0})),xt("social_tray").classList.toggle("unread_people",0!==e),xt("social_tray_badge_people").innerHTML=e,gr.people=e,fr()}const gr={notification:0,people:0};function fr(){wo.setNotificationCount(gr.notification+gr.people)}function br(){let e=0;Na.relationships.forEach((t=>{"friend"===t.type&&["online","away","busy"].includes(t.presence.status)&&e++})),xt("social_tray_online").innerHTML=e}function Cr(){Sa&&Sa.isConnected()&&Sa.emit("social.notification.ack"),Na.notifications.forEach((e=>{e.seen=!0}))}function xr(e,t=!1){e.unread=0,t||Ua.delete(e.to._id),Sa&&Sa.isConnected()&&Sa.emit("social.relation.ack",e.to._id),mr(),Va&&zr()}function Ar(e){const t=e.split(":");switch(t[0]){case"user":oa({userID:t[1]});break;case"support":xi();break;case"url":window.open(t.slice(1).join(":"),"_blank");break;case"room":"busy"===Na.presence.realstatus?Yt("you cannot join this room now"):Oa.isInRoom()&&Ea===t[1]?Yt("you are already in this room"):(Ga(t[1]),Ya())}}function yr(e){for(let t=0;t<Na.relationships.length;t++)if(Na.relationships[t].to._id===e)return Na.relationships[t]}function vr(e){for(let t=0;t<Na.relationships.length;t++)if(Na.relationships[t].to.username===e)return Na.relationships[t]}let Br=!1,wr=!1,Lr="";const kr=["online","away","busy","offline","unknown",void 0],Sr={online:"#4AFF71",away:"#FFD84A",busy:"#FF504A",offline:"#FFF5",unknown:"#FFF5"};function Fr(){zr();let e=[],t=!1;const n=xt("social_relationships_find").value.trim().toLowerCase();if(xt("social_relationships_find").classList.toggle("active",!!n),n?(e=Na.relationships.filter((e=>["friend","pending"].includes(e.type)&&e.to.username.includes(n))),t=!0):xt("social_relationships_tabs_online").classList.contains("active")?(e=Na.relationships.filter((e=>["online","away","busy"].includes(e.presence.status)&&"friend"===e.type)),t=!0):xt("social_relationships_tabs_friends").classList.contains("active")?(e=Na.relationships.filter((e=>"friend"===e.type)),t=!0):xt("social_relationships_tabs_pending").classList.contains("active")?e=Na.relationships.filter((e=>"pending"===e.type)):xt("social_relationships_tabs_blocked").classList.contains("active")&&(e=Na.relationships.filter((e=>"block"===e.type))),e.sort(((e,t)=>e.to.username===n!=(t.to.username===n)?(t.to.username===n)-(e.to.username===n):e.unread!==t.unread?t.unread-e.unread:e.presence.status!==t.presence.status?kr.indexOf(e.presence.status)-kr.indexOf(t.presence.status):e.to.username.localeCompare(t.to.username))),0===e.length){if(n){let e="Couldn't find anyone like that.",t=!1,s=!1;switch(n){case"anyone like that":e="Couldn't find anyone with that name.";break;case"anyone with that name":e="Couldn't find that person.";break;case"that person":e="Couldn't find the specified user.";break;case"the specified user":e="Couldn't find anyone in your friends list with that name.";break;case"anyone in your friends list with that name":e="Couldn't find who you are looking for.";break;case"who you are looking for":e="Couldn't find any user in your friends list who matches the specified search term.";break;case"any user in your friends list who matches the specified search term":e="...",t=!0}/^[a-z0-9\-_]{3,16}$/.test(n)&&(s=!0),xt("social_relationships").innerHTML=`<div class="social_empty"><img src="/res/${t?"social_blocked":"social_error"}.png" /><p>${e}</p>${s?`<p class="also tetra_pop" data-username="${St(n)}">Look for <span>${St(n.toUpperCase())}</span> on Tetra Channel?</p>`:""}</div>`}else xt("social_relationships_tabs_online").classList.contains("active")?xt("social_relationships").innerHTML='<div class="social_empty"><img src="/res/social_empty.png" /><p>Nobody\'s online right now.</p></div>':xt("social_relationships_tabs_friends").classList.contains("active")?xt("social_relationships").innerHTML='<div class="social_empty"><img src="/res/social_empty.png" /><p>You haven\'t added any friends yet. Click the FRIEND button on a profile to friend them.</p></div>':xt("social_relationships_tabs_pending").classList.contains("active")?xt("social_relationships").innerHTML='<div class="social_empty"><img src="/res/social_loading.png" /><p>If someone outside of your friends list messages you, they\'ll appear here.</p></div>':xt("social_relationships_tabs_blocked").classList.contains("active")&&(xt("social_relationships").innerHTML='<div class="social_empty"><img src="/res/social_blocked.png" /><p>You haven\'t blocked anyone yet.</p></div>');return void(Br=!0)}Br&&(xt("social_relationships").innerHTML="",Br=!1);const s=e.map((e=>e._id));yt("#social_relationships .social_relationship").forEach((e=>{s.includes(e.getAttribute("data-id"))||e.remove()}));let i=null;e.forEach((e=>{let n=xt(`social_relationship_${e._id}`);if(n)xt("social_relationships").insertAdjacentElement("beforeend",n),wr&&(n.querySelector("h1 span").textContent=e.to.username.toUpperCase(),n.querySelector(".social_relationship_img").src=e.to.avatar_revision?`/user-content/avatars/${e.to._id}.jpg?rv=${e.to.avatar_revision}`:Et(e.to._id),wr=!1);else{n=document.createElement("div"),n.classList.add("social_relationship"),n.classList.toggle("active",Ja&&Za._id===e._id),n.id=`social_relationship_${e._id}`,n.setAttribute("data-id",e._id),n.addEventListener("click",(()=>{"block"===e.type?oa({userID:e.to._id}):er(e,!0)}));const t=document.createElement("img");t.classList.add("social_relationship_img"),t.src=e.to.avatar_revision?`/user-content/avatars/${e.to._id}.jpg?rv=${e.to.avatar_revision}`:Et(e.to._id),n.appendChild(t);const s=document.createElement("h1");n.appendChild(s);const o=document.createElement("span");o.textContent=e.to.username.toUpperCase(),s.appendChild(o);const a=document.createElement("p");n.appendChild(a);const r=document.createElement("h2");n.appendChild(r);const l=document.createElement("div");l.classList.add("social_relationship_button_holder"),n.appendChild(l);const c=document.createElement("div");c.title="Join room",c.classList.add("social_relationship_button"),c.classList.add("social_relationship_button_snipe");const p=document.createElement("img");p.src="/res/icon/snipe.svg",c.appendChild(p),c.addEventListener("click",(t=>{if(c.classList.contains("active"))t.stopPropagation();else{if(c.classList.add("activated"),setTimeout((()=>{c.classList.remove("activated")}),300),Oa.isInRoom()&&xt(`sp_${e.to._id}`))return Yt("you are already in their room"),void t.stopPropagation();e.presence.detail.split(":")[1]&&(Ga(e.presence.detail.split(":")[1]),Ya()),t.stopPropagation()}})),l.appendChild(c);const d=document.createElement("div");d.title="Invite to your game",d.classList.add("social_relationship_button"),d.classList.add("social_relationship_button_invite");const h=document.createElement("img");h.src="/res/icon/invite.svg",d.appendChild(h);const u=document.createElement("span");if(d.appendChild(u),d.addEventListener("click",(t=>{if(d.classList.contains("active"))t.stopPropagation();else{if(d.classList.add("activated"),setTimeout((()=>{d.classList.remove("activated")}),300),document.body.classList.contains("inzenith"))return xt("zenith-duo-card").classList.contains("active")||xt("zenith-duo-card").click(),Sa&&Sa.isConnected()&&Sa.emit("social.party.invite",e.to._id),e.inv_locked_until=Date.now()+3e4,Ir(),void t.stopPropagation();if(Oa.isInRoom()&&xt(`sp_${e.to._id}`))return Yt("this person is already in your room"),void t.stopPropagation();Sa&&Sa.isConnected()&&Sa.emit("social.invite",e.to._id),e.inv_locked_until=Date.now()+3e4,Ir(),t.stopPropagation()}})),l.appendChild(d),"pending"===e.type){const t=document.createElement("div");t.title="Close DM",t.classList.add("social_relationship_button"),t.classList.add("social_relationship_button_close");const n=document.createElement("img");n.src="/res/icon/close.svg",t.appendChild(n),t.addEventListener("click",(n=>{t.classList.contains("active")||(t.classList.add("activated"),gn.post("/api/relationships/remove",{user:e.to._id}).then((()=>{t.classList.remove("activated")}),(e=>{en(e)}))),n.stopPropagation()})),l.appendChild(t)}i?i.insertAdjacentElement("afterend",n):xt("social_relationships").insertAdjacentElement("beforeend",n)}if(n){n.classList.toggle("unread",!!e.unread),n.classList.toggle("offline",t&&!["online","away","busy"].includes(e.presence.status)),n.setAttribute("style",t?`--pri: ${Sr[e.presence.status||"unknown"]};`:"");let s="";if(t){const t=e.presence.detail.split(":"),i=Wa[e.presence.status](t[0]||"",t[1]||""),o=`<img src="/res/status/${e.presence.status}.png" /> ${i.html}`;n.querySelector("p").innerHTML!==o&&(n.querySelector("p").innerHTML=o),s=i.text,n.querySelector(".social_relationship_button_snipe").classList.toggle("hidden",!(t[1]&&"X-PRIV"!==t[1]&&"online"===e.presence.status))}else{n.querySelector(".social_relationship_button_snipe").classList.add("hidden");let t="";switch(e.type){case"block":t='<img src="/res/status/blocked.png" /> Blocked',s="Blocked";break;case"pending":t='<img src="/res/status/unknown.png" /> Not a friend',s="Not a friend";break;default:t='<img src="/res/status/unknown.png" /> Status unknown',s="Status unknown"}n.querySelector("p").innerHTML!==t&&(n.querySelector("p").innerHTML=t)}n.classList.toggle("cc",n.querySelector("p").innerHTML.length>=70),n.setAttribute("title",`${e.to.username.toUpperCase()}\n${s}`),n.querySelector("h2").textContent=e.unread||0,n.querySelector(".social_relationship_button_invite").classList.toggle("hidden",!e.presence.invitable),i=n}})),n?(Lr===n&&At(".social_relationship.focus")||(yt(".social_relationship.focus").forEach((e=>{e.classList.remove("focus")})),At(".social_relationship")&&At(".social_relationship").classList.add("focus")),Lr=n):yt(".social_relationship.focus").forEach((e=>{e.classList.remove("focus")})),Ir(),xt("social").classList.toggle("bulky",e.length>50)}function zr(){let e=0,t=0,n=0,s=0,i=0;Na.relationships.forEach((o=>{e+=o.unread||0,"friend"===o.type?(n+=o.unread||0,["offline","unknown"].includes(o.presence.status)||(t+=o.unread||0)):"pending"===o.type?s+=o.unread||0:"block"===o.type&&(i+=o.unread||0)})),At("#social_relationships_tabs_online .social_relationships_tab_unread").classList.toggle("hidden",0===t),At("#social_relationships_tabs_online .social_relationships_tab_unread").textContent=t,At("#social_relationships_tabs_friends .social_relationships_tab_unread").classList.toggle("hidden",0===n),At("#social_relationships_tabs_friends .social_relationships_tab_unread").textContent=n,At("#social_relationships_tabs_pending .social_relationships_tab_unread").classList.toggle("hidden",0===s),At("#social_relationships_tabs_pending .social_relationships_tab_unread").textContent=s,At("#social_relationships_tabs_blocked .social_relationships_tab_unread").classList.toggle("hidden",0===i),At("#social_relationships_tabs_blocked .social_relationships_tab_unread").textContent=i,At("#social_unread").classList.toggle("hidden",0===e),At("#social_unread").textContent=e}let Tr=null;function Ir(){if(!Va)return;Tr&&(clearTimeout(Tr),Tr=null);let e=0;Na.relationships.forEach((t=>{if(t.inv_locked_until>Date.now()){e++;const n=Math.ceil((t.inv_locked_until-Date.now())/1e3);xt(`social_relationship_${t._id}`)&&(At(`#social_relationship_${t._id} .social_relationship_button_invite`).classList.add("active"),At(`#social_relationship_${t._id} .social_relationship_button_invite span`).textContent=n),Ja&&Za._id===t._id&&(xt("social_dm_button_invite").classList.add("active"),xt("social_dm_button_invite").style=`--progress: ${(t.inv_locked_until-Date.now())/3e4*100}%`)}else xt(`social_relationship_${t._id}`)&&At(`#social_relationship_${t._id} .social_relationship_button_invite`).classList.remove("active"),Ja&&Za._id===t._id&&xt("social_dm_button_invite").classList.remove("active")})),e&&(Tr=setTimeout((()=>{Ir()}),100))}function Mr(e,t="",n="",s=null){const i=Or();s&&(Na.presence.mask=s),Na.presence.realstatus=e,Na.presence.realdetail=`${t}${n?`:${n}`:""}`,"away"!==e&&(Na.presence.last=[e,t,n]),[e,t,n]=Ra[Na.presence.mask](e,t,n);const o=Wa[e](t,n);Or()!==i&&(Or()||document.body.classList.contains("ingame_phys")&&!1!==it.notifications.suppress||on()),Es(o.discord);const a=e,r=`${t}${n?`:${n}`:""}`;Na.presence.status=a,Na.presence.detail=r,Sa&&Sa.isConnected()&&Sa.emit("social.presence",{status:Na.presence.status,detail:Na.presence.realdetail}),xt("social_status").innerHTML=`${o.html} <img src="/res/status/${a}.png" />`,xt("social_status").classList.toggle("cc",xt("social_status").innerHTML.length>=65)}function Er(){"menus"===Na.presence.detail&&Mr("away")}function Dr(){null!==Na.presence.last&&"away"===Na.presence.realstatus&&Mr(...Na.presence.last)}function Or(){return"busy"===Na.presence.realstatus||"busy"===Na.presence.mask}function Hr(){return it.notifications.suppress&&document.body.classList.contains("ingame_phys")||Or()}const Pr=(()=>{const e={},t={"zen-try-sidebar":{startVisible:!0,el:"upsell_zen-try-sidebar",dismiss:"hover",dismissEl:"zen_panel"}};function n(n){if(!t[n])return;const s=t[n];xt(s.el).classList.contains("hidden")||xt(s.el).classList.contains("hiding")||(xt(s.el).classList.add("hiding"),setTimeout((()=>{xt(s.el).classList.add("hidden")}),800),e[n]=!0,localStorage.setItem("upsellState",JSON.stringify(e)))}Wt((()=>{!function(){const s=localStorage.getItem("upsellState");s&&Object.assign(e,JSON.parse(s));for(const[s,i]of Object.entries(t)){if(e[s])continue;let t=i.startVisible;if("function"==typeof i.startVisible&&(t=i.startVisible()),!t)switch(xt(i.el).classList.remove("hidden"),i.dismiss){case"hover":xt(i.dismissEl||i.el).addEventListener("mouseover",(()=>{n(s)}));break;case"click":xt(i.dismissEl||i.el).addEventListener("click",(()=>{n(s)}));break;case"focus":xt(i.dismissEl||i.el).addEventListener("focus",(()=>{n(s)}))}}}()}))})();let Rr,Wr,$r,Nr;const Ur=(()=>{const e=new Map;return{play:function(t,n={}){const s=e.get(t);s&&(s.graphics||["medium","high","ultra"]).includes(it.video.graphics)&&s.play(n)},register:function(t,n){e.set(t,n)},utils:{freq:e=>e*(parseFloat(it.video.particles)||.6),scale:e=>As(1.8)*e/Math.max(.75,Math.min(2,parseFloat(it.video.particles||.6)+.4))}}})();let Gr,Xr;function jr(e){return e/(it.video.particles||.6)}function qr(e){return e*(2.2-Math.max(0,2.2*(1-(it.video.particles||.6))))}function Kr(e,t,n){if("ultra"!==it.video.graphics||0==it.video.flashwave)return;null===cl.stage.filters&&(cl.stage.filters=[]);const s=void 0===it.video.flashwave?1:it.video.flashwave;cl.stage.filters.push(new a.filters.ShockwaveFilter([e,t],{amplitude:(2+2*n)*s,wavelength:As(150+40*n*(.5+.5*s)),speed:As(500+50*n),brightness:1+.25*s,radius:-1},0))}function Vr(e,t,n,s=void 0){return void 0===s&&(s=Ml),e+(t-e)*s(n)}function Qr(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function Yr(e){const t=Qr(e);return t?t.r<<16|t.g<<8|t.b:0}function Jr(e,t,n){let s,i,o;if(e/=360,n/=100,0===(t/=100))s=i=o=n;else{const a=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e),r=n<.5?n*(1+t):n+t-n*t,l=2*n-r;s=a(l,r,e+1/3),i=a(l,r,e),o=a(l,r,e-1/3)}const a=e=>{const t=Math.round(255*e).toString(16);return 1===t.length?`0${t}`:t};return`#${a(s)}${a(i)}${a(o)}`}function Zr(e,t,n){n/=100;const s=t*Math.min(n,1-n)/100,i=t=>{const i=(t+e/30)%12,o=n-s*Math.max(Math.min(i-3,9-i,1),-1);return Math.round(255*o)};return i(0)<<16|i(8)<<8|i(4)}kn.ready((function(e){a.Ticker.shared.add((e=>{"ultra"===it.video.graphics&&null!==cl.stage.filters&&(cl.stage.filters.forEach(((t,n)=>{t.time+=e/(1e3/60),t.amplitude*=.98,t.brightness=1+.95*(t.brightness-1),t.time>5&&cl.stage.filters.splice(n,1)})),0===cl.stage.filters.length&&(cl.stage.filters=null))}))})),Ur.register("test",{play:e=>{const{x:t=0,y:n=0,color:s=16777215}=e;Wr.spawnBurst({texture:"/res/particles/box.png",tint:s,lifetime:[.5,1.5],alpha:{from:1,to:0},speed:{from:[150,300],to:0},scale:Ur.utils.scale(.8)},{x:t,y:n,amount:Ur.utils.freq(50),shape:"circle",radius:100,directionOverride:0,angleOverride:45})}}),Ur.register("garbage_beam_impact",{play:e=>{const{x:t=0,y:n=0,color:s=16777215,intensity:i=1}=e;Wr.spawnBurst({texture:"/res/particles/beam.png",tint:s,lifetime:[.05,.1],alpha:{from:[.4+i/20*.4,.5+i/20*.5],to:0},speed:[1600,2400],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.1+i/20*.2),.15+i/20*.35]},{x:t,y:n,amount:Ur.utils.freq(10),shape:"circle",radius:1,directionOverride:0,angleOverride:0}),Wr.spawnBurst({texture:"/res/particles/fire.png",tint:s,lifetime:[.2,.3],alpha:{from:[.3,.5],to:0},alphamultiplier:{from:1,to:0},angle:[0,360],anglespeed:[-720,720],direction:[0,360],speed:[0,80],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.3+i/20*.8),.6+i/20*1]},{x:t,y:n,amount:5,shape:"point"})}}),Ur.register("bgsplash",{graphics:["high","ultra"],play:e=>{const{amt:t=30,direction:n=[0,360],speed:s=[0,100]}=e;Rr.spawnBurst({texture:"/res/particles/bigbox.png",tint:16777215,lifetime:[2,5],alpha:{from:[.02,.15],to:0},alphamultiplier:{from:0,to:2},speed:{from:s,to:0},direction:n,scale:[Ur.utils.scale(.02),Ur.utils.scale(.2)],wrap:!0},{shape:"rectangle",x:window.innerWidth/2,y:window.innerHeight/2,width:window.innerWidth,height:window.innerHeight,amount:Ur.utils.freq(t)})}}),Ur.register("bgsplashdanger",{graphics:["high","ultra"],play:e=>{const{amt:t=30,direction:n=[0,360],speed:s=[0,100]}=e;Rr.spawnBurst({texture:"/res/particles/bigbox.png",tint:16720384,lifetime:[.1,1],alpha:{from:[.02,.15],to:0},alphamultiplier:{from:0,to:2},speed:{from:s,to:0},direction:n,scale:[Ur.utils.scale(.02),Ur.utils.scale(.3)],wrap:!0},{shape:"rectangle",x:window.innerWidth/2,y:window.innerHeight/2,width:window.innerWidth,height:window.innerHeight,amount:Ur.utils.freq(t)})}}),Ur.register("bgtransition",{graphics:["high","ultra"],play:()=>{Rr.spawnBurst({texture:"/res/particles/bigbox.png",tint:16777215,lifetime:[.5,3],alpha:{from:[.02,.15],to:0},speed:{from:[0,400],to:[800,1600]},scale:{from:0,to:[Ur.utils.scale(.05),Ur.utils.scale(.5)]}},{shape:"rectangle",x:window.innerWidth/2,y:window.innerHeight/2,width:window.innerWidth,height:window.innerHeight,amount:Ur.utils.freq(200),directionOverride:0})}}),Ur.register("bgcircle",{graphics:["high","ultra"],play:e=>{const{radius:t=As(10*Ol.x),color:n=16777215,amt:s=100,speed:i=150}=e;Rr.spawnBurst({texture:"/res/particles/particle.png",tint:n,lifetime:[.35,3],alpha:{from:[.02,.4],to:0},speed:{from:[0,i],to:0},scale:[Ur.utils.scale(.02),Ur.utils.scale(.25)]},{shape:"circle",x:window.innerWidth/2,y:window.innerHeight/2,radius:t,amount:Ur.utils.freq(s),directionOverride:0})}}),Ur.register("harddrop_trail",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,color:s=16777215}=e;Wr.spawnBurst({texture:"/res/particles/star.png",tint:s,lifetime:[.2,1],alpha:{from:[.3,.8],to:0},speed:{from:[150,450],to:[-100,100]},direction:[-2,2],xflurry:[0,50],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.08),Ur.utils.scale(.2)]},{x:t,y:n,amount:Ur.utils.freq(.25),shape:"rectangle",width:As(Ol.x),height:As(Ol.x)})}}),Ur.register("harddrop_edge",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0}=e;Wr.spawnBurst({texture:"/res/particles/star.png",tint:16777215,lifetime:[.1,.5],alpha:{from:[.5,1],to:0},speed:{from:[0,150],to:[0,50]},yspeed:{from:0,to:50},direction:[-45,45],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.1),Ur.utils.scale(.3)]},{x:t,y:n,amount:Ur.utils.freq(5),shape:"rectangle",width:As(Ol.x),height:0})}}),Ur.register("piece_spin",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,color:s=16777215,direction:i="none",kx:o=0,ky:r=0}=e;Wr.spawnBurst({texture:"/res/particles/star.png",tint:s,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[50,300],to:[0,50]},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]},xspeed:{from:[As(Ol.x)*o*-1,As(Ol.x)*o*2],to:[0,0]},yspeed:{from:[As(Ol.x)*r*-1,As(Ol.x)*r*2],to:[0,0]}},{x:t,y:n,amount:Ur.utils.freq(5),shape:"disk",width:"horizontal"===i?0:3*As(Ol.x),height:"vertical"===i?0:3*As(Ol.x),directionOverride:"left"===i?-110:"right"===i?110:0})}}),Ur.register("line_burst",{play:e=>{const{x:t=0,y:n=0,s=1,color:i=16777215}=e;(parseFloat(it.video.particles)||.6)>=.15&&Wr.spawnBurst({texture:"/res/particles/fbox.png",tint:i,lifetime:[.1+.3*Math.min(1,.8*(parseFloat(it.video.particles)||.6)),.1+.6*Math.min(1,.8*(parseFloat(it.video.particles)||.6))],alpha:{from:Math.max(.1,Math.min(1,.6*(parseFloat(it.video.particles)||.6))),to:0},speed:{from:[0,80],to:[0,30]},direction:[0,360],anglespeed:[-20,20],blendmode:a.BLEND_MODES.ADD,scale:{from:ws(1*s),to:[ws(1*s),ws(1.4*s)]},yspeed:{start:[0,-100],inc:[5,12]}},{x:t,y:n,amount:1,shape:"point"}),["high","ultra"].includes(it.video.graphics)&&Wr.spawnBurst({texture:"/res/particles/chip.png",tint:i,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[50,300],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.1),Ur.utils.scale(.25)],anglespeed:{from:[-720,720],to:[-360,360]},flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]},xspeed:[-500,500],yspeed:{start:[-500,50],inc:[15,40]}},{x:t,y:n,amount:Ur.utils.freq(1.65),shape:"rectangle",width:As(Ol.x*s),height:As(Ol.x*s)})}}),Ur.register("line_bubble",{play:e=>{const{x:t=0,y:n=0,s=1,color:i=16777215}=e;Wr.spawnBurst({texture:"/res/particles/bubble.png",tint:i,lifetime:[.2,1],alpha:{from:[.9,1],to:0},speed:{from:[50,300],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:{from:[Ur.utils.scale(.5),Ur.utils.scale(.15)],to:[Ur.utils.scale(.25),Ur.utils.scale(.1)]},flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]},xspeed:[-500,500],yspeed:{start:[-500,50],inc:[15,40]}},{x:t,y:n,amount:Ur.utils.freq(3),shape:"rectangle",width:As(Ol.x*s),height:As(Ol.x*s)})}}),Ur.register("mino_dust",{play:e=>{const{x:t=0,y:n=0,s=1,color:i=16777215}=e;Wr.spawnBurst({texture:"/res/particles/dust.png",tint:4473924,lifetime:[.3,1],alpha:{from:1,to:0},speed:{from:[0,50],to:[0,20]},direction:[0,360],anglespeed:[-20,20],scale:{from:ws(1.5*s),to:[ws(2.5*s),ws(3.5*s)]},yspeed:{start:0,inc:[1,-5]}},{x:t,y:n,amount:1,shape:"point"}),Wr.spawnBurst({texture:"/res/particles/dust.png",tint:i,lifetime:[.3,1],alpha:{from:.8,to:0},speed:{from:[0,50],to:[0,20]},direction:[0,360],anglespeed:[-20,20],scale:{from:ws(1.5*s),to:[ws(1.5*s),ws(2.5*s)]},yspeed:{start:0,inc:[0,-5]}},{x:t,y:n,amount:1,shape:"point"}),["high","ultra"].includes(it.video.graphics)&&Wr.spawnBurst({texture:"/res/particles/star.png",tint:i,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[50,150],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]},yspeed:{start:0,inc:[-3,-10]}},{x:t,y:n,amount:Ur.utils.freq(1),shape:"rectangle",width:As(s*Ol.x),height:As(s*Ol.x)})}}),Ur.register("mino_explode",{play:e=>{const{x:t=0,y:n=0,s=1,color:i=16777215}=e;Wr.spawnBurst({texture:"/res/particles/dust.png",tint:i,lifetime:[.1,.3],alpha:{from:1,to:0},speed:{from:[0,150],to:[0,20]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,anglespeed:[-20,20],scale:{from:ws(5.5*s),to:[ws(7.5*s),ws(9.5*s)]},yspeed:{start:0,inc:[1,-5]}},{x:t,y:n,amount:4,shape:"point"}),Wr.spawnBurst({texture:"/res/particles/fire.png",tint:i,lifetime:[.3,1],alpha:{from:.8,to:0},speed:{from:[0,150],to:[0,20]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,anglespeed:[-20,20],scale:{from:ws(4.5*s),to:[ws(5.5*s),ws(7.5*s)]},yspeed:{start:0,inc:[0,-5]}},{x:t,y:n,amount:4,shape:"point"}),["high","ultra"].includes(it.video.graphics)&&(Wr.spawnBurst({texture:"/res/particles/star.png",tint:i,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[50,350],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]},yspeed:{start:0,inc:[-3,-10]}},{x:t,y:n,amount:Ur.utils.freq(15),shape:"rectangle",width:As(s*Ol.x),height:As(s*Ol.x)}),Wr.spawnBurst({texture:"/res/particles/star.png",tint:i,lifetime:[.5,1],alpha:{from:[.7,1],to:0},speed:{from:[100,1200],to:[0,300]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]},yspeed:{start:0,inc:[-1,-3]}},{x:t,y:n,amount:Ur.utils.freq(30),shape:"rectangle",width:As(s*Ol.x),height:As(s*Ol.x)}))}}),Ur.register("b2b_flair",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e,o={texture:"/res/particles/star.png",tint:[16744448,16777088],lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[0,150],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}};Wr.spawnBurst({...o,xspeed:-60},{x:t,y:n,amount:Ur.utils.freq(5*i),shape:"line",linePointA:[0,0],linePointB:[0,As(Ol.x*i)]}),Wr.spawnBurst({...o,xspeed:60},{x:t,y:n,amount:Ur.utils.freq(5*i),shape:"line",linePointA:[As(Ol.x*s),0],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Wr.spawnBurst({...o,yspeed:60},{x:t,y:n,amount:Ur.utils.freq(5*s),shape:"line",linePointA:[0,As(Ol.x*i)],linePointB:[As(Ol.x*s),As(Ol.x*i)]})}}),Ur.register("b2bcharge_flair",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20,start:o=!1,amt:r=0}=e,l=oc.generic.ns.b2b._makeTint(r,!0,0),c={texture:["/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png"],tint:l,lifetime:[.1,.5],alpha:{from:[.7,1],to:0},angleParaxial:!0,blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.35),Ur.utils.scale(.6)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.8],to:[0,.5]}};Wr.spawnBurst(c,{x:t,y:n,amount:Ur.utils.freq((o?3:1)*i),shape:"line",linePointA:[0,0],linePointB:[0,As(Ol.x*i)]}),Wr.spawnBurst(c,{x:t,y:n,amount:Ur.utils.freq((o?3:1)*i),shape:"line",linePointA:[As(Ol.x*s),0],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Wr.spawnBurst(c,{x:t,y:n,amount:Ur.utils.freq((o?3:1)*s),shape:"line",linePointA:[0,As(Ol.x*i)],linePointB:[As(Ol.x*s),As(Ol.x*i)]});const p={texture:"/res/particles/star.png",tint:l,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[0,150],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}};Wr.spawnBurst({...p,xspeed:-60},{x:t,y:n,amount:Ur.utils.freq((o?5:2)*i),shape:"line",linePointA:[0,0],linePointB:[0,As(Ol.x*i)]}),Wr.spawnBurst({...p,xspeed:60},{x:t,y:n,amount:Ur.utils.freq((o?5:2)*i),shape:"line",linePointA:[As(Ol.x*s),0],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Wr.spawnBurst({...p,yspeed:60},{x:t,y:n,amount:Ur.utils.freq((o?5:2)*s),shape:"line",linePointA:[0,As(Ol.x*i)],linePointB:[As(Ol.x*s),As(Ol.x*i)]})}}),Ur.register("b2bcharge_release",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e,o={texture:["/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png"],tint:16777215,lifetime:[.1,.5],alpha:{from:[.7,1],to:0},angleParaxial:!0,blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.5),Ur.utils.scale(.8)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.8],to:[0,.5]}};Wr.spawnBurst(o,{x:t,y:n,amount:Ur.utils.freq(3*i),shape:"line",linePointA:[0,0],linePointB:[0,As(Ol.x*i)]}),Wr.spawnBurst(o,{x:t,y:n,amount:Ur.utils.freq(3*i),shape:"line",linePointA:[As(Ol.x*s),0],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Wr.spawnBurst(o,{x:t,y:n,amount:Ur.utils.freq(3*s),shape:"line",linePointA:[0,As(Ol.x*i)],linePointB:[As(Ol.x*s),As(Ol.x*i)]});const r={texture:"/res/particles/star.png",tint:16777215,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[0,300],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}};Wr.spawnBurst({...r,xspeed:-500},{x:t,y:n,amount:Ur.utils.freq(8*i),shape:"line",linePointA:[0,0],linePointB:[0,As(Ol.x*i)]}),Wr.spawnBurst({...r,xspeed:500},{x:t,y:n,amount:Ur.utils.freq(8*i),shape:"line",linePointA:[As(Ol.x*s),0],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Wr.spawnBurst({...r,yspeed:500},{x:t,y:n,amount:Ur.utils.freq(8*s),shape:"line",linePointA:[0,As(Ol.x*i)],linePointB:[As(Ol.x*s),As(Ol.x*i)]})}}),Ur.register("spike_flair",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e;Wr.spawnBurst({texture:"/res/particles/star.png",tint:16777215,lifetime:[.5,1.5],alpha:{from:[.6,.8],to:0},speed:{from:[0,150],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.1),Ur.utils.scale(.25)],flickerfrequency:{from:[10,50],to:[10,20]},flickeramplitude:{from:[0,.6],to:[0,.3]},flurryfrequency:{from:[5,30],to:[2,10]},flurryamplitude:{from:[-130,130],to:[-30,30]}},{x:t,y:n,amount:Ur.utils.freq(100),shape:"rectangle",width:As(Ol.x*s),height:As(Ol.x*i)})}}),Ur.register("danger_flair",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e;Wr.spawnBurst({texture:"/res/particles/particle.png",tint:[16711680,16737792],lifetime:[.5,1.5],alpha:{from:[.6,.8],to:0},speed:{from:[0,150],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.05),Ur.utils.scale(.1)],flickerfrequency:{from:[10,50],to:[10,20]},flickeramplitude:{from:[0,.6],to:[0,.3]},flurryfrequency:{from:[5,30],to:[2,10]},flurryamplitude:{from:[-130,130],to:[-30,30]},yspeed:{from:0,to:[-25,-200]}},{x:t,y:n,amount:Ur.utils.freq(100),shape:"rectangle",width:As(Ol.x*s),height:As(Ol.x*i)}),Wr.spawnBurst({texture:"/res/particles/smoke.png",tint:3342336,lifetime:[1,2],alpha:{from:1,to:0},speed:{from:[0,20],to:0},direction:[0,360],blendmode:a.BLEND_MODES.ADD,anglespeed:[-20,20],scale:{from:ws(1.5),to:[ws(2.5),ws(3.5)]}},{x:t,y:n,amount:Ur.utils.freq(s),shape:"line",linePointA:[As(Ol.x*s/-2),As(Ol.x*i/-2)],linePointB:[As(Ol.x*s/2),As(Ol.x*i/-2)]})}}),Ur.register("danger_smoke",{play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e,o={texture:"/res/particles/smoke.png",tint:[3342336,2236928],lifetime:[.6,1],alpha:{from:1,to:0},speed:{from:[200,300],to:0},anglespeed:[-20,20],scale:{from:ws(.4),to:[ws(2.5),ws(4.5)]}},r={texture:"/res/particles/smoke.png",tint:{from:[16776960,16777215],to:[16711680,16729088]},lifetime:[.4,.6],alpha:{from:1,to:0},speed:{from:[200,300],to:0},blendmode:a.BLEND_MODES.ADD,anglespeed:[-20,20],scale:{from:ws(.4),to:[ws(1.5),ws(3.5)]}};Rr.spawnBurst({...o,direction:[-60,-30]},{x:t,y:n,amount:Ur.utils.freq(1),shape:"point"}),Wr.spawnBurst({...r,direction:[-60,-30]},{x:t,y:n,amount:Ur.utils.freq(1),shape:"point"}),Rr.spawnBurst({...o,direction:[30,60]},{x:t+As(Ol.x*s),y:n,amount:Ur.utils.freq(1),shape:"point"}),Wr.spawnBurst({...r,direction:[30,60]},{x:t+As(Ol.x*s),y:n,amount:Ur.utils.freq(1),shape:"point"}),Rr.spawnBurst({...o,direction:[210,240]},{x:t,y:n+As(Ol.x*i),amount:Ur.utils.freq(1),shape:"point"}),Wr.spawnBurst({...r,direction:[210,240]},{x:t,y:n+As(Ol.x*i),amount:Ur.utils.freq(1),shape:"point"}),Rr.spawnBurst({...o,direction:[120,150]},{x:t+As(Ol.x*s),y:n+As(Ol.x*i),amount:Ur.utils.freq(1),shape:"point"}),Wr.spawnBurst({...r,direction:[120,150]},{x:t+As(Ol.x*s),y:n+As(Ol.x*i),amount:Ur.utils.freq(1),shape:"point"})}}),Ur.register("death_flair",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e;Wr.spawnBurst({texture:"/res/particles/chirp.png",tint:[16746751,16711680],lifetime:[.2,2],alpha:{from:[.7,1],to:0},speed:{from:[0,1e3],to:[0,200]},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.5)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:t,y:n,amount:Ur.utils.freq(100),shape:"box",width:As(Ol.x*s),height:As(Ol.x*i),directionOverride:0,angleOverride:0}),Wr.spawnBurst({texture:"/res/particles/star.png",tint:16777215,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[0,300],to:[0,50]},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.5)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:t,y:n,amount:Ur.utils.freq(100),shape:"box",width:As(Ol.x*s),height:As(Ol.x*i),directionOverride:0})}}),Ur.register("fire_flair",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e,o={texture:"/res/particles/particle.png",tint:[16736256,16777088],lifetime:[.2,3],alpha:{from:[.7,1],to:0},alphamultiplier:{from:0,to:2},speed:{from:[0,75],to:[0,25]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.3),Ur.utils.scale(.9)]};Wr.spawnBurst({...o,xspeed:-20},{x:t,y:n,amount:Ur.utils.freq(5*i),shape:"line",linePointA:[0,0],linePointB:[0,As(Ol.x*i)]}),Wr.spawnBurst({...o,xspeed:20},{x:t,y:n,amount:Ur.utils.freq(5*i),shape:"line",linePointA:[As(Ol.x*s),0],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Wr.spawnBurst({...o,yspeed:20},{x:t,y:n,amount:Ur.utils.freq(5*s),shape:"line",linePointA:[0,As(Ol.x*i)],linePointB:[As(Ol.x*s),As(Ol.x*i)]})}}),Ur.register("fire_burn",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=10,h:i=20}=e,o={texture:"/res/particles/particle.png",tint:[16736256,16777088],lifetime:[.2,3],alpha:{from:[.7,1],to:0},alphamultiplier:{from:0,to:2},speed:{from:[0,75],to:[0,25]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.05),Ur.utils.scale(.2)]};Wr.spawnBurst({...o,xspeed:-20},{x:t,y:n,amount:Ur.utils.freq(.05*i),shape:"line",linePointA:[0,0],linePointB:[0,As(Ol.x*i)]}),Wr.spawnBurst({...o,xspeed:20},{x:t,y:n,amount:Ur.utils.freq(.05*i),shape:"line",linePointA:[As(Ol.x*s),0],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Wr.spawnBurst({...o,yspeed:20},{x:t,y:n,amount:Ur.utils.freq(.05*s),shape:"line",linePointA:[0,As(Ol.x*i)],linePointB:[As(Ol.x*s),As(Ol.x*i)]}),Rr.spawnBurst({texture:"/res/particles/fire.png",tint:[16736256,16777088],lifetime:[.2,3],alpha:{from:[.4,.9],to:0},alphamultiplier:{from:0,to:3},speed:{from:[0,75],to:[0,25]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.3),Ur.utils.scale(2.5)],flurryfrequency:{from:[5,30],to:[2,10]},flurryamplitude:{from:[-130,130],to:[-30,30]},yspeed:{from:[100,-50],to:[-100,-300]},angle:[0,360],anglespeed:[-200,200]},{x:t+As(Ol.x*s/2),y:n+As(Ol.x*i/2),amount:Ur.utils.freq(s*i*1/200),shape:"rectangle",width:As(Ol.x*s),height:As(Ol.x*i)})}}),Ur.register("fire_burning",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0}=e;Rr.createSpawner({texture:"/res/particles/fire.png",tint:[16736256,16777088],lifetime:[.2,3],alpha:{from:[.4,.9],to:0},alphamultiplier:{from:0,to:3},speed:{from:[0,25],to:[0,10]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.2),Ur.utils.scale(.7)],flurryfrequency:{from:[5,30],to:[2,10]},flurryamplitude:{from:[-130,130],to:[-30,30]},yspeed:{from:[30,-15],to:[-30,-100]},angle:[0,360],anglespeed:[-200,200]},{x:t,y:n,amount:Ur.utils.freq(20),lifetime:2,shape:"rectangle",width:As(2*Ol.x),height:As(2*Ol.x)})}}),Ur.register("wound",{play:e=>{const{x:t=0,y:n=0,w:s=10,s:i=1,tint:o=16777215,speed:r=1,dT:l=1}=e;"medium"!==it.video.graphics&&(Wr.spawnBurst({texture:["/res/particles/wound-particle-1.png","/res/particles/wound-particle-2.png","/res/particles/wound-particle-3.png","/res/particles/wound-particle-4.png"],tint:o,lifetime:[.4-.2*r,1.5-.8*r],alpha:[.7,1],speed:[0,15+50*r],direction:[0,360],scale:{from:[Ur.utils.scale(.3),Ur.utils.scale(.7)],to:0},scalemultiplier:{from:0,to:1},angleParaxial:!0},{x:t,y:n,amount:Ur.utils.freq((.2+.2*r)*l),shape:"rectangle",width:As(i*s*Ol.x),height:As(i*Ol.x)}),Wr.spawnBurst({texture:["/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png"],tint:o,lifetime:[.1,.3],alpha:{from:[.5,1],to:0},scale:[Ur.utils.scale(.1+.4*r),Ur.utils.scale(.3+.7*r)],angleParaxial:!0,blendmode:a.BLEND_MODES.ADD},{x:t,y:n,amount:Ur.utils.freq((.01+.05*r)*l),shape:"rectangle",width:As(i*s*Ol.x),height:As(i*Ol.x)})),Wr.spawnBurst({texture:["/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png"],tint:16777215,lifetime:[.1,.3],alpha:{from:[.5,1],to:0},scale:[Ur.utils.scale(.1+.4*r),Ur.utils.scale(.3+.7*r)],angleParaxial:!0,blendmode:a.BLEND_MODES.ADD},{x:t,y:n,amount:Ur.utils.freq((.001+.005*r)*l),shape:"rectangle",width:As(i*s*Ol.x),height:As(i*Ol.x)})}}),Ur.register("wound_spawn",{play:e=>{const{x:t=0,y:n=0,w:s=10,s:i=1,tint:o=16777215}=e;Wr.spawnBurst({texture:["/res/particles/wound-particle-1.png","/res/particles/wound-particle-2.png","/res/particles/wound-particle-3.png","/res/particles/wound-particle-4.png"],tint:o,lifetime:[.3,.8],alpha:[.7,1],speed:[0,30],direction:[0,360],scale:{from:[Ur.utils.scale(.3),Ur.utils.scale(1.4)],to:0},scalemultiplier:{from:.5,to:1},angleParaxial:!0},{x:t,y:n,amount:Ur.utils.freq(10),shape:"rectangle",width:As(i*s*Ol.x),height:As(i*Ol.x)}),Wr.spawnBurst({texture:["/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png"],tint:16777215,lifetime:[.1,.3],alpha:{from:[.5,1],to:0},scale:[Ur.utils.scale(.3),Ur.utils.scale(1)],angleParaxial:!0,blendmode:a.BLEND_MODES.ADD},{x:t,y:n,amount:Ur.utils.freq(5),shape:"rectangle",width:As(i*s*Ol.x),height:As(i*Ol.x)})}}),Ur.register("wound_clear",{play:e=>{const{x:t=0,y:n=0,w:s=10,s:i=1}=e;Wr.spawnBurst({texture:["/res/particles/wound-particle-1.png","/res/particles/wound-particle-2.png","/res/particles/wound-particle-3.png","/res/particles/wound-particle-4.png"],tint:16777215,lifetime:[.3,.8],alpha:[.7,1],speed:[0,50],direction:[0,360],yspeed:{from:[0,-500],to:[0,-100]},scale:{from:[Ur.utils.scale(.3),Ur.utils.scale(.7)],to:0},scalemultiplier:{from:.8,to:1},angleParaxial:!0},{x:t,y:n,amount:Ur.utils.freq(20),shape:"rectangle",width:As(i*s*Ol.x),height:As(i*Ol.x)})}}),Ur.register("bar_sparks",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=0,color:i=16777215,dT:o=1}=e;Wr.spawnBurst({texture:"/res/particles/star.png",tint:i,lifetime:[.2,1],alpha:{from:[.3,.8],to:0},speed:{from:[150,450],to:[-100,100]},direction:[-2,2],xflurry:[0,50],scale:[Ur.utils.scale(.08),Ur.utils.scale(.2)]},{x:t,y:n,amount:Ur.utils.freq(.15*o),shape:"rectangle",width:s,height:0})}}),Ur.register("stock_explode",{play:e=>{const{x:t=0,y:n=0}=e;Wr.spawnBurst({texture:"/res/particles/dust.png",tint:4473924,lifetime:[.3,1],alpha:{from:1,to:0},speed:{from:[0,50],to:[0,20]},direction:[0,360],anglespeed:[-20,20],scale:{from:ws(1.5),to:[ws(2.5),ws(3.5)]},yspeed:{start:0,inc:[1,-5]}},{x:t,y:n,amount:1,shape:"point"}),Wr.spawnBurst({texture:"/res/particles/dust.png",tint:16777215,lifetime:[.3,1],alpha:{from:.8,to:0},speed:{from:[0,50],to:[0,20]},direction:[0,360],anglespeed:[-20,20],scale:{from:ws(1.5),to:[ws(1.5),ws(2.5)]},yspeed:{start:0,inc:[0,-5]}},{x:t,y:n,amount:1,shape:"point"}),["high","ultra"].includes(it.video.graphics)&&Wr.spawnBurst({texture:"/res/particles/star.png",tint:16777215,lifetime:[.4,1.5],alpha:{from:[.7,1],to:0},speed:{from:[0,150],to:[0,50]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]},yspeed:{start:0,inc:[-3,-10]}},{x:t,y:n,amount:Ur.utils.freq(25),shape:"rectangle",width:As(Ol.x),height:As(Ol.x)})}}),Ur.register("b2bcharge_ticking",{play:e=>{const{x:t=0,y:n=0,power:s=0,tint:i=16777215,dT:o=1}=e,r=Math.min(.9,5*s)+.1;Wr.spawnBurst({texture:["/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png"],tint:i,lifetime:[.1,.5],alpha:{from:[.7*r,1*r],to:0},angleParaxial:!0,blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.2+.5*s),Ur.utils.scale(.4+.9*s)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.8],to:[0,.5]}},{x:t,y:n,amount:Ur.utils.freq(o*(.03+.17*s)),shape:"circle",radius:As(5+70*s)}),Wr.spawnBurst({texture:["/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png"],tint:16777215,lifetime:[.03,.1],alpha:{from:[.7*r,1*r],to:0},angleParaxial:!0,blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.2+.5*s),Ur.utils.scale(.4+.9*s)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.8],to:[0,.5]}},{x:t,y:n,amount:Ur.utils.freq(o*(0+.02*s)),shape:"circle",radius:As(5+70*s)})}}),Ur.register("confetti",{graphics:["high","ultra"],play:e=>{const{gui:t=!1,count:n=40,hue:i=[0,360]}=e;if(!t||pl&&"ultra"===it.video.graphics)for(let e=0;e<n;e++){const e=Math.random()*(i[1]-i[0])+i[0],n=Math.random()>.5,o=(.3+.65*Math.random())*window.innerHeight,r=(.05+.4*Math.random())*window.innerWidth,l=new h.Beam({texture:a.Texture.WHITE,mode:"path",path:[new a.Point(n?window.innerWidth+30*Math.random():-30*Math.random(),window.innerHeight+30*Math.random()),new a.Point(n?window.innerWidth-r:r,window.innerHeight-o),new a.Point(n?window.innerWidth-2*r:2*r,window.innerHeight+o)],vertices:10,length:5+20*Math.random(),duration:.7+1*Math.random(),tint:Zr(e,100,50),blendMode:a.BLEND_MODES.ADD,scale:.2,smoothPath:!0,smoothVertices:!0,repeatTexture:!1,reverse:!1,pathBezier:s(.08,.7,.6,.26),jitter:5+20*Math.random()});(t?pl.stage:Gr).addChild(l)}}}),Ur.register("waterfall",{graphics:["high","ultra"],play:e=>{const{x:t=0,y:n=0,w:s=0,color:i=16777215}=e,o={texture:"/res/particles/star.png",tint:i,lifetime:1,alpha:{from:1,to:0},y:n};("ultra"===it.video.graphics?Nr:Wr).spawnOne({...o,x:t-s/2-16,direction:-90,scale:.8,speed:{from:100,to:0}}),("ultra"===it.video.graphics?Nr:Wr).spawnOne({...o,x:t+s/2+16,direction:90,scale:.8,speed:{from:100,to:0}}),("ultra"===it.video.graphics?Nr:Wr).spawnOne({...o,x:t-s/2-48,direction:-90,scale:.6,speed:{from:150,to:0}}),("ultra"===it.video.graphics?Nr:Wr).spawnOne({...o,x:t+s/2+48,direction:90,scale:.6,speed:{from:150,to:0}})}}),Ur.register("button_ultra",{graphics:["ultra"],play:e=>{const{x:t=0,y:n=0,w:s=0,h:i=0,color:o=16777215,amt:r=50}=e;Nr.spawnBurst({texture:"/res/particles/star.png",tint:o,lifetime:[.2,1],alpha:{from:[.7,1],to:0},speed:{from:[0,300],to:[0,50]},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.5)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:t+s/2,y:n+i/2,amount:Ur.utils.freq(r/2),shape:"box",width:s,height:i,directionOverride:0}),Nr.spawnBurst({texture:"/res/particles/star.png",tint:16777215,lifetime:[.2,.5],alpha:{from:[.7,1],to:0},speed:{from:[0,1200],to:[0,600]},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.1),Ur.utils.scale(.3)],flickerfrequency:{from:[20,200],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:t+s/2,y:n+i/2,amount:Ur.utils.freq(2*r),shape:"box",width:s,height:i,directionOverride:0})}}),Ur.register("xp_ultra",{graphics:["ultra"],play:e=>{const{x:t=0,y:n=0,w:s=0,h:i=0}=e;Nr.spawnBurst({texture:"/res/particles/star.png",tint:[16746496,16777028],lifetime:[.6,2.5],alpha:{from:[.7,1],to:0},speed:{from:[0,600],to:0},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.15),Ur.utils.scale(.5)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:t+s/2,y:n+i/2,amount:Ur.utils.freq(100),shape:"box",width:s,height:i,directionOverride:0}),Nr.spawnBurst({texture:"/res/particles/star.png",tint:16777215,lifetime:[.6,1.5],alpha:{from:[.7,1],to:0},speed:{from:[0,2400],to:[0,300]},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.1),Ur.utils.scale(.3)],flickerfrequency:{from:[20,200],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:t+s/2,y:n+i/2,amount:Ur.utils.freq(200),shape:"box",width:s,height:i,directionOverride:0}),Nr.createSpawner({texture:"/res/particles/star.png",tint:[16746496,16777028],lifetime:[.2,1],alpha:{from:1,to:0},alphamultiplier:{from:0,to:3},speed:{from:[0,20],to:[0,20]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.1),Ur.utils.scale(.3)]},{x:t+s/2,y:n+i/2,amount:Ur.utils.freq(10),lifetime:6,shape:"rectangle",width:s,height:i})}}),Ur.register("mm_ultra",{graphics:["ultra"],play:e=>{const t={texture:"/res/particles/beam.png",tint:16777215,lifetime:.6,alpha:1,speed:[2*window.innerWidth,5*window.innerWidth],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.2),Ur.utils.scale(.4)]};Nr.createSpawner({...t,direction:-90,angle:-90},{x:0,y:0,amount:Ur.utils.freq(50),shape:"line",linePointA:[window.innerWidth+200,0],linePointB:[window.innerWidth+200,window.innerHeight/2],lifetime:3.4}),Nr.createSpawner({...t,direction:90,angle:90},{x:0,y:0,amount:Ur.utils.freq(50),shape:"line",linePointA:[-200,window.innerHeight/2],linePointB:[-200,window.innerHeight],lifetime:3.4}),setTimeout((()=>{Nr.spawnBurst({texture:"/res/particles/star.png",tint:16777215,lifetime:[.6,1.5],alpha:{from:[.7,1],to:0},speed:{from:[0,1200],to:[0,300]},blendmode:a.BLEND_MODES.ADD,direction:[0,360],scale:[Ur.utils.scale(.1),Ur.utils.scale(.3)],flickerfrequency:{from:[20,200],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:0,y:0,amount:Ur.utils.freq(200),shape:"line",linePointA:[0,.6*window.innerHeight],linePointB:[window.innerWidth,.4*window.innerHeight]});const e={texture:"/res/particles/fire.png",tint:[16736256,16777088],lifetime:[1.5,3],alpha:{from:[.05,.1],to:0},alphamultiplier:{from:0,to:3},speed:{from:[0,350],to:[0,700]},blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(1.2),Ur.utils.scale(4.5)],flurryfrequency:{from:[5,30],to:[2,10]},flurryamplitude:{from:[-130,130],to:[-30,30]},angle:[0,360],anglespeed:[-200,200]};Nr.createSpawner({...e,direction:[-45,45],tint:[255,4521983]},{x:0,y:0,amount:Ur.utils.freq(100),shape:"line",linePointA:[0,.4*window.innerHeight],linePointB:[window.innerWidth,.2*window.innerHeight],lifetime:8.5}),Nr.createSpawner({...e,direction:[135,225],tint:[16711680,16746496]},{x:0,y:0,amount:Ur.utils.freq(100),shape:"line",linePointA:[0,.8*window.innerHeight],linePointB:[window.innerWidth,.6*window.innerHeight],lifetime:8.5})}),3443)}}),Ur.register("scoreslide_ultra",{graphics:["ultra"],play:e=>{const{right:t=!1}=e;Nr.createSpawner({texture:"/res/particles/fire.png",tint:t?[16711680,16746496]:[255,4521983],lifetime:[1.5,3],alpha:{from:[.05,.1],to:0},alphamultiplier:{from:0,to:3},speed:{from:[0,1e3],to:[0,1800]},direction:t?[45,135]:[225,315],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(1.2),Ur.utils.scale(4.5)],flurryfrequency:{from:[5,30],to:[2,10]},flurryamplitude:{from:[-30,30],to:[-30,30]},angle:[0,360],anglespeed:[-200,200]},{x:0,y:0,amount:Ur.utils.freq(100),shape:"line",linePointA:[window.innerWidth/2+(t?100:-100),0],linePointB:[window.innerWidth/2+(t?100:-100),window.innerHeight],lifetime:2.5})}}),Ur.register("zen_wormhole",{play:()=>{Wr.createSpawner({texture:"/res/particles/smoke.png",tint:16777215,lifetime:[1,2],alpha:{from:[.2,.5],to:0},alphamultiplier:{from:0,to:4},speed:{from:[0,200],to:[0,200]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:{start:[Ur.utils.scale(.5),Ur.utils.scale(2.5)],inc:[0,.01]}},{x:window.innerWidth/2,y:window.innerHeight/2,amount:Ur.utils.freq(40),shape:"rectangle",width:window.innerWidth,height:0,lifetime:4.4}),Wr.createSpawner({texture:"/res/particles/smoke.png",tint:16777215,lifetime:[.6,1.2],alpha:{from:[.2,.7],to:0},alphamultiplier:{from:0,to:4},speed:{from:[0,400],to:[0,400]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:{start:[Ur.utils.scale(.3),Ur.utils.scale(.8)]}},{x:window.innerWidth/2,y:window.innerHeight/2,amount:Ur.utils.freq(40),shape:"rectangle",width:window.innerWidth,height:0,lifetime:4.4});const e={texture:"/res/particles/beam.png",tint:16777215,lifetime:[.1,.3],alpha:{from:[.4,1],to:0},alphamultiplier:{from:0,to:4},speed:{from:[2400,3200],to:[3200,4e3]},blendmode:a.BLEND_MODES.ADD,scale:{start:[Ur.utils.scale(.2),Ur.utils.scale(.4)]}};Wr.createSpawner(e,{x:window.innerWidth/2,y:window.innerHeight,amount:Ur.utils.freq(500),shape:"line",linePointA:[window.innerWidth/-2,window.innerHeight/-2-64],linePointB:[window.innerWidth/2,window.innerHeight/-2-64],angleOverride:0,directionOverride:0,lifetime:4.4}),Wr.createSpawner(e,{x:window.innerWidth/2,y:0,amount:Ur.utils.freq(500),shape:"line",linePointA:[window.innerWidth/-2,window.innerHeight/2+64],linePointB:[window.innerWidth/2,window.innerHeight/2+64],angleOverride:0,directionOverride:0,lifetime:4.4});const t={texture:"/res/particles/particle.png",tint:16777215,lifetime:[.3,.8],alpha:{from:[.6,1],to:0},alphamultiplier:{from:0,to:4},speed:{from:[600,1600],to:[1200,2e3]},blendmode:a.BLEND_MODES.ADD,scale:{start:[Ur.utils.scale(.05),Ur.utils.scale(.2)]},flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}};Wr.createSpawner(t,{x:window.innerWidth/2,y:window.innerHeight,amount:Ur.utils.freq(500),shape:"line",linePointA:[window.innerWidth/-2,window.innerHeight/-2-16],linePointB:[window.innerWidth/2,window.innerHeight/-2-16],angleOverride:0,directionOverride:0,lifetime:4.4}),Wr.createSpawner(t,{x:window.innerWidth/2,y:0,amount:Ur.utils.freq(500),shape:"line",linePointA:[window.innerWidth/-2,window.innerHeight/2+16],linePointB:[window.innerWidth/2,window.innerHeight/2+16],angleOverride:0,directionOverride:0,lifetime:4.4})}}),Ur.register("zen_wormhole_exit",{play:()=>{Wr.spawnBurst({texture:"/res/particles/smoke.png",tint:16777215,lifetime:[1.6,3.4],alpha:{from:[.5,1],to:0},alphamultiplier:{from:0,to:4},speed:{from:[0,400],to:[0,400]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:{start:[Ur.utils.scale(.3),Ur.utils.scale(.8)]}},{x:window.innerWidth/2,y:window.innerHeight/2,amount:Ur.utils.freq(40),shape:"rectangle",width:window.innerWidth,height:0}),Wr.spawnBurst({texture:"/res/particles/particle.png",tint:16777215,lifetime:[2.6,5.6],alpha:{from:[.5,1],to:0},alphamultiplier:{from:0,to:4},speed:{from:[0,400],to:[0,400]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:{start:[Ur.utils.scale(.05),Ur.utils.scale(.3)]}},{x:window.innerWidth/2,y:window.innerHeight/2,amount:Ur.utils.freq(80),shape:"rectangle",width:window.innerWidth,height:window.innerHeight})}}),Ur.register("zenith_lbping",{graphics:["high","ultra"],play:e=>{const{pos:t=999,el:n=null}=e,s="ultra"===it.video.graphics&&Nr?Nr:Wr;let i=window.innerHeight/2-16*window.devicePixelRatio;t<=30&&n&&(i=n.getBoundingClientRect().top),s.spawnBurst({texture:"/res/particles/chirp.png",tint:16777215,lifetime:[.4,1.2],angle:180,alpha:{from:[.7,1],to:0},yspeed:{from:[0,800],to:0},xspeed:{from:[-20,20],to:[-20,20]},scale:[Ur.utils.scale(.15),Ur.utils.scale(.3)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:window.innerWidth-130*window.devicePixelRatio,y:i,amount:Ur.utils.freq(15),shape:"box",width:260*window.devicePixelRatio,height:0,directionOverride:0}),s.spawnBurst({texture:"/res/particles/ricegrain.png",tint:16777215,lifetime:[.4,1.2],alpha:{from:[.2,.5],to:0},xspeed:{from:[-50,50],to:0},yspeed:{from:[-10,10],to:0},scale:[Ur.utils.scale(.3),Ur.utils.scale(.7)],flickerfrequency:{from:[20,100],to:[10,20]},flickeramplitude:{from:[0,.5],to:[0,.1]}},{x:window.innerWidth-130*window.devicePixelRatio,y:i,amount:Ur.utils.freq(5),shape:"box",width:260*window.devicePixelRatio,height:0,directionOverride:0})}}),Ur.register("zenith_rank",{graphics:["medium","high","ultra"],play:e=>{const{x:t=0,y:n=0,power:s=0,color:i=16777215,dT:o=1,scale:r=1,back:l=!1}=e;if(l){if("medium"===it.video.graphics)return;return void Rr.spawnBurst({texture:"/res/particles/exhaust.png",tint:i,lifetime:.3,alpha:{from:[.3*s,.5*s],to:0},alphamultiplier:{from:0,to:10},speed:{from:[900,1e3],to:[600,700]},angle:[-180,180],direction:[170,190],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(1.4*r),Ur.utils.scale(1.8*r)]},{x:t,y:n,amount:Ur.utils.freq(1.2*o),shape:"line",linePointA:[ws((-152-150*Math.min(2,s))*r),ws(258*r)],linePointB:[ws((152+150*Math.min(2,s))*r),ws(258*r)]})}const c={texture:"/res/particles/exhaust.png",tint:i,lifetime:.2,alpha:[.09+.1*s,.18+.18*s],alphamultiplier:{from:0,to:10},speed:[300+200*r+100*s,300+300*r+100*s],angle:[-20,20],direction:[170,190],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.5*r),Ur.utils.scale(.7*r)]};Wr.spawnBurst({...c,angle:[-40,5],direction:[140,185]},{x:t,y:n,amount:Ur.utils.freq((s>=1?1+.2*s:0)*o),shape:"line",linePointA:[ws(-412*r),ws(161*r)],linePointB:[ws(-172*r),ws(161*r)]}),Wr.spawnBurst(c,{x:t,y:n,amount:Ur.utils.freq((1+.4*s)*o),shape:"line",linePointA:[ws(-152*r),ws(238*r)],linePointB:[ws(152*r),ws(238*r)]}),Wr.spawnBurst({...c,angle:[-5,40],direction:[175,220]},{x:t,y:n,amount:Ur.utils.freq((s>=1?1+.2*s:0)*o),shape:"line",linePointA:[ws(172*r),ws(161*r)],linePointB:[ws(412*r),ws(161*r)]})}}),Ur.register("zenith_lockbreak",{graphics:["medium","high","ultra"],play:e=>{const{x:t=0,y:n=0,color:s=16777215,scale:i=1,id:o=0}=e,r=[[[ws(-520*i),ws(65*i)],[ws(520*i),ws(-65*i)]],[[ws(-520*i),ws(-103*i)],[ws(520*i),ws(103*i)]],[[ws(-520*i),ws(150*i)],[ws(520*i),ws(-150*i)]]][o]??[[0,0],[0,0]];Wr.spawnBurst({texture:["/res/particles/chain-a.png","/res/particles/chain-b.png","/res/particles/chain-c.png","/res/particles/star.png","/res/particles/star.png","/res/particles/star.png"],tint:s,lifetime:[.5,2],alpha:{from:2,to:0},alphamultiplier:{from:10,to:0},speed:{from:[1500*i,100*i],to:[400*i,100*i]},angle:[0,360],anglespeed:{from:[1500,-1500],to:[200,-200]},yspeed:{from:[0,-800],to:[300,700]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.3*i),Ur.utils.scale(.4*i)]},{x:t,y:n,amount:Ur.utils.freq(40),shape:"line",linePointA:r[0],linePointB:r[1]})}}),Ur.register("zenith_chainbreak",{graphics:["medium","high","ultra"],play:e=>{const{x:t=0,y:n=0,color:s=16777215,scale:i=1,id:o=0}=e,r=[[[ws(-520*i),ws(-130*i)],[ws(520*i),ws(130*i)]],[[ws(-520*i),ws(110*i)],[ws(520*i),ws(-110*i)]],[[ws(-520*i),ws(-230*i)],[ws(520*i),ws(230*i)]],[[ws(-520*i),ws(90*i)],[ws(520*i),ws(-90*i)]]][o]??[[0,0],[0,0]];Wr.spawnBurst({texture:["/res/particles/chain-a.png","/res/particles/chain-b.png","/res/particles/chain-c.png","/res/particles/star.png","/res/particles/star.png","/res/particles/star.png"],tint:s,lifetime:[.5,2],alpha:{from:2,to:0},alphamultiplier:{from:10,to:0},speed:{from:[2e3*i,100*i],to:[500*i,100*i]},angle:[0,360],anglespeed:{from:[1500,-1500],to:[200,-200]},yspeed:{from:[0,-1800],to:[300,700]},direction:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.3*i),Ur.utils.scale(.5*i)]},{x:t,y:n,amount:Ur.utils.freq(60),shape:"line",linePointA:r[0],linePointB:r[1]})}}),Ur.register("zenith_speedrun",{graphics:["high","ultra"],play:e=>{const{dT:t=1}=e;Rr.spawnBurst({texture:"/res/particles/beam.png",tint:16777215,lifetime:2,alpha:[.05,.2],yspeed:[As(2e3),As(5e3)],scale:[Ur.utils.scale(.3),Ur.utils.scale(.8)]},{shape:"rectangle",x:window.innerWidth/2,y:As(-200),width:window.innerWidth,height:0,amount:Ur.utils.freq(1.5*t)})}});const el=(()=>{const e={};let t=0;function n(t){e[t]&&(e[t].obj.destroy(),e[t].leader&&!e[t].leader._destroyed&&e[t].leader.destroy(),delete e[t])}return{create:function(n){let{pointA:s=[0,0],pointB:i=[0,0],intensity:o=1,duration:r=1,length:l=45,layer:c="front"}=n;if("minimal"===it.video.graphics)return;if("gui"===c&&(!pl||"ultra"!==it.video.graphics))return;const p={gui:pl?pl.stage:null,front:Gr,sub:Xr,back:_l}[c],d={gui:Nr,front:Wr,sub:$r,back:Rr}[c],u=++t,_=Zr(360*Math.random(),100,50);let m;o=Math.max(1,Math.min(20,o)),["high","ultra"].includes(it.video.graphics)&&(m=d.createSpawner({texture:"/res/particles/star.png",tint:_,lifetime:[.4,.7],alpha:{from:1,to:0},speed:{from:[0,100+o/20*300],to:0},anglespeed:{from:[0,400+o/20*1600],to:0},direction:[0,360],angle:[0,360],blendmode:a.BLEND_MODES.ADD,scale:[Ur.utils.scale(.2+o/20*.2),.3+o/20*.2]},{x:s[0],y:s[1],amount:Ur.utils.freq(10+o/20*60),shape:"point",lifetime:-1}));const g=new h.Beam({texture:"/res/particles/beams/beam.png",mode:"path",path:[new a.Point(s[0],s[1]),new a.Point((i[0]+s[0])/2+(Math.random()-.5)*(i[0]-s[0])+(Math.random()-.5)*(window.innerWidth/10),(i[1]+s[1])/2+(Math.random()-.5)*(i[1]-s[1])+(Math.random()-.5)*(window.innerHeight/10)),new a.Point(i[0],i[1])],vertices:Math.round(l*r),length:Math.round(l*r),duration:r,tint:_,blendMode:a.BLEND_MODES.ADD,scale:.5+o/20,smoothPath:!0,smoothVertices:!0,repeatTexture:!1,reverse:!1,leader:m,onHit:(t,n)=>{Ur.play("garbage_beam_impact",{x:n.x,y:n.y,color:_,intensity:o}),m&&m.destroy(),delete e[u]}});return p.addChild(g),e[u]={id:u,obj:g,leader:m,options:n},u},destroy:n,destroyAll:function(){Object.keys(e).forEach((e=>{n(e)}))},getBeam:function(t){return e[id]}}})();let tl,nl,sl,il,ol;function al(e,t,n){const s=document.createElement("canvas"),i=s.getContext("2d");s.height=t,s.width=e;const o=i.createLinearGradient(0,0,0,t);return n.forEach((e=>{o.addColorStop(e[0],e[1])})),i.fillStyle=o,i.fillRect(0,0,e,t),new a.Texture.fromCanvas(s)}kn.ready((function(e){let t=null,n=null;tl=function(){function e(){t&&t.destroy(),n&&n.destroy()}function s(){e(),t=Rr.createSpawner({texture:"/res/particles/bigbox.png",tint:16777215,lifetime:[1,30],alpha:{from:[.02,.15],to:0},alphamultiplier:{from:0,to:2},speed:{from:[0,45],to:[0,20]},direction:[0,360],scale:[Ur.utils.scale(.02),Ur.utils.scale(.3)],wrap:!0},{shape:"rectangle",x:window.innerWidth/2,y:window.innerHeight/2,width:window.innerWidth,height:window.innerHeight,amount:Ur.utils.freq(3.5),lifetime:-1}),n=Rr.createSpawner({texture:"/res/particles/particle.png",tint:16777215,lifetime:[1,30],alpha:{from:[.05,.5],to:0},alphamultiplier:{from:0,to:2},speed:{from:[0,60],to:[0,30]},direction:[0,360],scale:[Ur.utils.scale(.02),Ur.utils.scale(.25)],wrap:!0},{shape:"rectangle",x:window.innerWidth/2,y:window.innerHeight/2,width:window.innerWidth,height:window.innerHeight,amount:Ur.utils.freq(10),lifetime:-1})}return{set:function(){"high"!==it.video.graphics&&"ultra"!==it.video.graphics||s()},unset:function(){e()},resize:function(){"high"!==it.video.graphics&&"ultra"!==it.video.graphics||s()}}}(),nl=function(){let e,t,n=1,s=1,i=!1;function o(t){const n=t||e;if(!n||!n.texture)return;il.position.set(window.innerWidth/2,window.innerHeight/2),ol.position.set(window.innerWidth/2,window.innerHeight/2),ol.pivot.set(window.innerWidth/2,window.innerHeight/2);window.innerWidth/window.innerHeight>n.texture.width/n.texture.height?n.scale.set(window.innerWidth/n.texture.width,window.innerWidth/n.texture.width):n.scale.set(window.innerHeight/n.texture.height,window.innerHeight/n.texture.height)}return a.Ticker.shared.add((t=>{if(!e||i)return;if("minimal"===it.video.graphics)return;const o=n,a=e.alpha;if(Math.round(100*a)===Math.round(100*o)){e.alpha=o;const t=void 0===it.video.bloom?1:it.video.bloom;0!=it.video.bloom&&ml&&"ultra"===it.video.graphics&&(ml.threshold=.35+.15*o,ml.bloomScale=(.45+-.3*o)*t,ml.blur=(7+-5*o)*t)}else{const n=o+(a-o)*Math.pow(.9,t);e.alpha=n;const s=void 0===it.video.bloom?1:it.video.bloom;0!=it.video.bloom&&ml&&"ultra"===it.video.graphics&&(ml.threshold=.35+.15*n,ml.bloomScale=(.45+-.3*n)*s,ml.blur=(7+-5*n)*s)}const r=s,l=il.scale.x;if(Math.round(1e3*l)===Math.round(1e3*r))il.scale.set(r);else{const e=r+(l-r)*Math.pow(.9,t);il.scale.set(e)}}),this),{setBackground:(n,s)=>{if(t===n)return;s||(i=!0),t=n;let r=0;e&&(s?e.destroy():(El.animate(e,{0:{alpha:1},1:{alpha:0}},.5,void 0,(e=>{e.destroy()})),r=800));const l=a.Sprite.from(t);l.alpha=0,l.anchor.set(.5,.5),il.addChild(l),e=l;const c=Date.now(),p=()=>{o(l),s?l.alpha=1:setTimeout((()=>{El.animate(l,{0:{alpha:0},1:{alpha:1}},.5,void 0,(()=>{i=!1}))}),Math.max(0,r-(Date.now()-c)))};l.texture.valid?p():l.texture.once("update",p)},fit:e=>{o(e)},opacity:e=>{"low"!==it.video.graphics&&"minimal"!==it.video.graphics&&(n=e)},scale:e=>{"low"!==it.video.graphics&&"minimal"!==it.video.graphics&&(s=e)}}}()})),window.DEVHOOK_BG_ANIM=(e=100)=>{let t=0,n=!1;console.warn("The background will flash and errors may appear while the frames of the animation load in, please hang tight..."),setInterval((()=>{t++,t>32&&(t=1,n||(console.warn("Backgrounds have been loaded in."),n=!0)),nl.setBackground(`https://kagari.moe/:/bggame${t}.png`,!0)}),e)};const rl=(()=>{const e=new Map,t={hun:{fnt:"res/font/hun.fnt",type:"sdf",rasterizeSize:1024},seg:{fnt:"res/font/seg.fnt",type:"sdf",rasterizeSize:1024}};let n=0;const s=[];return Wt((()=>{kn.setState("fonts",`loading fonts (${n}/${Object.keys(t).length})`),Object.keys(t).forEach((i=>{const o=new g.Font({...t[i],onload:()=>{e.set(i,o),n++,kn.setState("fonts",`loading fonts (${n}/${Object.keys(t).length})`),n>=Object.keys(t).length&&(s.forEach((e=>{e()})),kn.finishLoad("fonts"))}})}))})),{get:t=>e.get(t),ready:e=>{n>=Object.keys(t).length?e():s.push(e)},setRasterizeRenderer:t=>{for(const[,n]of e)n.setRasterizeRenderer(t)}}})(),ll=(()=>{const e=["/res/board-flash.png","/res/board-flash-inv.png","/res/speedrun-pattern.png","/res/wound-tile.png","/res/particles/beam.png","/res/particles/bigbox.png","/res/particles/boardstar.png","/res/particles/bokeh.png","/res/particles/box.png","/res/particles/chain-a.png","/res/particles/chain-b.png","/res/particles/chain-c.png","/res/particles/wound-spark-1.png","/res/particles/wound-spark-2.png","/res/particles/wound-spark-3.png","/res/particles/wound-particle-1.png","/res/particles/wound-particle-2.png","/res/particles/wound-particle-3.png","/res/particles/wound-particle-4.png","/res/particles/chip.png","/res/particles/chirp.png","/res/particles/dust.png","/res/particles/exhaust.png","/res/particles/fire.png","/res/particles/flare.png","/res/particles/fbox.png","/res/particles/particle.png","/res/particles/smoke.png","/res/particles/star.png","/res/particles/spark.png","/res/particles/beams/beam.png","/res/cutin/superlobby/backing.png"];let t=0,n=0;const s=[];return Wt((()=>{kn.setState("textures",`loading textures (${t}/${e.length})`),e.forEach((i=>{const o=a.Texture.from(i),r=()=>{t++,kn.setState("textures",`loading textures (${t}/${e.length})`),t>=e.length&&(s.forEach((e=>{e()})),kn.finishLoad("textures"),n&&Yt(`${n} texture${1===n?"":"s"} failed to load. make sure your internet connection is stable. if you run into any issues, please reload the page.`))};o.baseTexture.valid?r():(o.baseTexture.once("loaded",(()=>{r()})),o.baseTexture.once("error",(e=>{console.error(`Texture ${i} failed to load!`,e.event),n++,r()})))}))})),{ready:n=>{t>=e.length?n():s.push(n)}}})();let cl,pl,dl,hl,ul,_l,ml;a.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,Wt((()=>{a.utils.skipHello(),rl.ready((()=>{null===localStorage.getItem("feecofScore")?(console.log("Eligible for feecof test."),kn.setState("feecof","initializing benchmark..."),setTimeout((()=>{console.log("Feecof test starting..."),kn.setState("feecof","running benchmark...");const e=document.createElement("canvas");e.setAttribute("width","640"),e.setAttribute("height","320"),e.setAttribute("style","position:fixed;left:100vw;top:0;opacity:0;will-change:transform;pointer-events:none;"),document.body.appendChild(e),f({view:e,speed:100,smartstop:!0,maxcount:10,mincount:3,img:"/res/kagari.png",font:rl.get("hun"),maxtime:3e4},(t=>{if(e.remove(),!t.success)return console.error("Feecof test did not complete. Will try again next time."),Pt(["trackEvent","Performance","Feecof","Failure"]),void kn.finishLoad("feecof");localStorage.setItem("feecofScore",t.feecof),console.log(`Feecof test completed with score of ${t.feecof} feecof.`),Pt(["trackEvent","Performance","Feecof","Complete",t.feecof]),kn.finishLoad("feecof")}))}),1500)):kn.finishLoad("feecof")}))}));const gl={vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!0},fl={vertices:!0,position:!0,rotation:!0,uvs:!1,tint:!0};let bl=!0,Cl=0;function xl(){cl.renderer.resize(window.innerWidth,window.innerHeight),pl&&pl.renderer.resize(window.innerWidth,window.innerHeight),yl(),bl=!0}function Al(e){if(window.IS_ELECTRON)switch(it.electron.frameratelimit){case"1x":a.Ticker.shared.maxFPS=e||window.REFRESH_RATE||60;break;case"2x":a.Ticker.shared.maxFPS=e||2*(window.REFRESH_RATE||60);break;case"off":a.Ticker.shared.maxFPS=e||0;break;default:a.Ticker.shared.maxFPS=e||4*(window.REFRESH_RATE||60)}else a.Ticker.shared.maxFPS=e||0}function yl(){if(dl){if("ultra"!==it.video.graphics)return dl.filters=null,void(dl.filterArea=null);if(dl.filters=[],0!=it.video.bloom){const e=void 0===it.video.bloom?1:it.video.bloom;ml=new a.filters.AdvancedBloomFilter({threshold:.5,bloomScale:.15*e,brightness:1,blur:2*e,quality:Math.floor(Math.min(Math.max(4,e+2),20))}),dl.filters.push(ml)}if(0!=it.video.chroma){const e=void 0===it.video.chroma?.5:it.video.chroma;dl.filters.push(new a.filters.RGBSplitFilter(new a.Point(0,-e),new a.Point(0,0),new a.Point(-e,0)))}dl.filterArea=new a.Rectangle(0,0,window.innerWidth,window.innerHeight),cl.stage.filterArea=new a.Rectangle(0,0,window.innerWidth,window.innerHeight)}}function vl(e){for(;e.children.length;){e.children[0].destroy()}}function Bl(e,t,n){const s=e.worldTransform.apply(new a.Point(t,n));return{x:s.x,y:s.y}}function wl(e,t,n,s=1){const i=e.getGlobalPosition(void 0,!0);return{x:i.x+t*s,y:i.y+n*s}}function Ll(e,t,n){const s=new a.BaseRenderTexture({width:e,height:t}),i=new a.RenderTexture(s);return cl.renderer.render(n,{renderTexture:i}),s}function kl(e,t){const n=new a.BaseRenderTexture({width:256*e,height:256*e}),s=new a.RenderTexture(n),i=new a.Container;for(let n=0;n<25;n++){const s=n%5,o=Math.floor(n/5),r=n/25,l=46*e,c=new a.Sprite(t);c.position.set(e*(1+48*s),e*(1+48*o)),c.filters=[new a.filters.AdjustmentFilter({contrast:0,brightness:2})];const p=new a.Graphics;p.beginFill(16711680,1),p.drawShape(r<=.5?new a.Polygon([l*r*2,0,l,0,l,l,0,l,0,l*r*2]):new a.Polygon([l,l*r*2-l,l,l,l*r*2-l,l])),p.endFill(),p.position.set(e*(1+48*s),e*(1+48*o)),c.mask=p,i.addChild(c),i.addChild(p)}return cl.renderer.render(i,{renderTexture:s}),n}kn.ready((function(e){switch(it.video.webgl){case"legacy":a.settings.PREFER_ENV=a.ENV.WEBGL_LEGACY;break;case"webgl1":a.settings.PREFER_ENV=a.ENV.WEBGL;break;default:a.settings.PREFER_ENV=a.ENV.WEBGL2}if("low"!==it.video.graphics&&"minimal"!==it.video.graphics||(a.settings.PRECISION_FRAGMENT=a.PRECISION.LOW,a.settings.PRECISION_VERTEX=a.PRECISION.LOW),"minimal"===it.video.graphics&&(a.settings.SCALE_MODE=a.SCALE_MODES.NEAREST),xt("pixi").getBoundingClientRect=()=>({x:0,y:0,width:window.innerWidth,height:window.innerHeight,top:0,left:0,right:window.innerWidth,bottom:window.innerHeight}),cl=new a.Application({width:256,height:256,view:xt("pixi"),antialias:"low"!==it.video.graphics&&"minimal"!==it.video.graphics,backgroundAlpha:1,powerPreference:it.video.powersave?"default":"high-performance",forceFXAA:"high"!==it.video.graphics&&"ultra"!==it.video.graphics,sharedTicker:"minimal"!==it.video.graphics,autoDensity:!0,clearBeforeRender:!1,resolution:it.video.lowres?.7:window.devicePixelRatio,autoStart:"minimal"!==it.video.graphics}),a.Ticker.shared.maxFPS=0,"ultra"===it.video.graphics&&(pl=new a.Application({width:256,height:256,view:xt("pixi-fg"),antialias:!1,backgroundAlpha:0,powerPreference:it.video.powersave?"default":"high-performance",forceFXAA:!1,sharedTicker:!0,autoDensity:!0,resolution:it.video.lowres?.7:window.devicePixelRatio,autoStart:!0})),"minimal"===it.video.graphics){const e=new a.Ticker;e.add((()=>{(Cl>0||bl)&&(cl.renderer.render(cl.stage),bl=!1)}),cl,a.UPDATE_PRIORITY.LOW),e.start()}if(cl&&cl.renderer&&cl.renderer.type===a.RENDERER_TYPE.WEBGL?console.log(`%cPixiJS ${a.VERSION} - ${2===cl.renderer.context.webGLVersion?"WebGL 2":"WebGL 1"}${a.settings.PREFER_ENV===a.ENV.WEBGL_LEGACY?" (LEGACY)":""}`,`color: ${2===cl.renderer.context.webGLVersion?"#F3C0E6":"#D9C0F3"};\n\t\t\tfont-size: 1.2em;\n\t\t\tfont-weight: 900;\n\t\t\ttext-shadow: 0px 0px 2px ${2===cl.renderer.context.webGLVersion?"#BA509B":"#7050BA"};\n\t\t\tbackground-color: ${2===cl.renderer.context.webGLVersion?"#50344988":"#3D345088"};\n\t\t\tpadding: 0 1em;\n\t\t\tborder-radius: 3px;`):cl&&cl.renderer&&cl.renderer.type===a.RENDERER_TYPE.CANVAS?(console.log(`%cPixiJS ${a.VERSION} - Canvas`,"color: #F97676;\n\t\t\tfont-size: 1.2em;\n\t\t\tfont-weight: 900;\n\t\t\ttext-shadow: 0px 0px 2px #BA5050;\n\t\t\tbackground-color: #87353588;\n\t\t\tpadding: 0 1em;\n\t\t\tborder-radius: 3px;"),console.error("Canvas renderers are not supported.")):(console.log(`%cPixiJS ${a.VERSION} - No renderer`,"color: #FFFFFF;\n\t\t\tfont-size: 1.2em;\n\t\t\tfont-weight: 900;\n\t\t\ttext-shadow: 0px 0px 2px #FFFFFF;\n\t\t\tbackground-color: #FF0000;\n\t\t\tpadding: 0 1em;\n\t\t\tborder-radius: 3px;"),console.error("No supported renderer found. Cannot launch.")),console.log(`%c- ${navigator.userAgent?navigator.userAgent:"Unknown browser"} -\nCPU: ${navigator.hardwareConcurrency?`${navigator.hardwareConcurrency}-core`:"<unknown>"}\nMemory: ${navigator.deviceMemory?`~${navigator.deviceMemory} GB`:"<unknown>"}\nConnection: ${navigator.connection?`${navigator.connection.downlink} Mbps, ${navigator.connection.rtt}ms RTT [${navigator.connection.effectiveType}]`:"<unknown>"}`,"color: #FFFFFF88;\n\tfont-size: 1.2em;\n\tfont-weight: 900;\n\ttext-shadow: 0px 0px 2px #FFFFFF88;\n\tbackground-color: #111111AA;\n\tpadding: 0 1em;\n\tborder-radius: 3px;"),cl&&cl.renderer){const e=cl.renderer.gl.getExtension("WEBGL_debug_renderer_info");e&&(console.log(`%cRenderer: ${cl.renderer.gl.getParameter(e.UNMASKED_RENDERER_WEBGL)}`,"color: #FFFFFF88;\n\t\t\t\tfont-size: 1.2em;\n\t\t\t\tfont-weight: 900;\n\t\t\t\ttext-shadow: 0px 0px 2px #FFFFFF88;\n\t\t\t\tbackground-color: #111111AA;\n\t\t\t\tpadding: 0 1em;\n\t\t\t\tborder-radius: 3px;"),xt("rendererinfo").textContent=`${2===cl.renderer.context.webGLVersion?"WebGL 2":"WebGL 1"}${a.settings.PREFER_ENV===a.ENV.WEBGL_LEGACY?" (LEGACY)":""} | ${cl.renderer.gl.getParameter(e.UNMASKED_RENDERER_WEBGL)}`,window.Sentry?.setTag?.("gpu",cl.renderer.gl.getParameter(e.UNMASKED_RENDERER_WEBGL)))}if(rl.setRasterizeRenderer(cl.renderer),xl(),cl.stage.filters=null,il=new a.Container,il.name="bgImgContainer",il.interactive=!1,il.interactiveChildren=!1,il.alpha=it.video.background,cl.stage.addChild(il),ol=new a.Container,ol.name="bgSubContainer",ol.interactive=!1,ol.interactiveChildren=!1,cl.stage.addChild(ol),sl=new a.Container,sl.name="bgContainer",sl.interactive=!1,sl.interactiveChildren=!1,sl.alpha=Math.min(1,10*(it.video.background||0)),cl.stage.addChild(sl),Rr=new d.ParticleManager,sl.addChild(Rr),tl.set(),dl=new a.Container,dl.name="gScene",cl.stage.addChild(dl),_l=new a.Container,_l.name="gSceneBG",_l.sortableChildren=!0,dl.addChild(_l),Xr=new a.Container,Xr.name="fxContainerSub",Xr.interactive=!1,Xr.interactiveChildren=!1,dl.addChild(Xr),ul=new a.Container,ul.name="gSceneFG",ul.sortableChildren=!0,dl.addChild(ul),Gr=new a.Container,Gr.name="fxContainer",Gr.interactive=!1,Gr.interactiveChildren=!1,cl.stage.addChild(Gr),Wr=new d.ParticleManager,Gr.addChild(Wr),$r=new d.ParticleManager,Xr.addChild($r),hl=new a.Container,hl.name="gSceneHUD",hl.sortableChildren=!0,cl.stage.addChild(hl),pl&&(pl.stage.interactive=!1,pl.stage.interactiveChildren=!1,Nr=new d.ParticleManager,pl.stage.addChild(Nr)),xt("pixi").addEventListener("webglcontextlost",(()=>{Pi(),xt("dirtyflag_gl").innerHTML="CRASHED",dn({title:"WEBGL CRASHED",msg:'an error has caused WEBGL to crash.</p><p>this could be caused by many issues, like a driver error, a GPU error, a browser error or insufficient resources.</p><p class="modal_also">you can choose to continue the current session, which may not work properly, or reload to try again. sometimes, exiting the ongoing game can fix the error.',classes:["crash_modal","noclickout"],buttons:[{label:"CONTINUE",classes:[],callback:e=>{e(),Wi()}},{label:"RESTART",classes:["pri"],callback:e=>{e(),Ln=!0,location.reload()}}]})})),bl=!0,window.IS_ELECTRON){let e=0,t=0,n=0,s=!1;a.Ticker.shared.add((()=>{e++}),this),setInterval((()=>{if(t!==e)return t=e,s?void(s=!1):void(n=0);n++,n>=3&&(s=!0,a.Ticker.shared.update())}),100)}if(["medium","low","minimal"].includes(it.video.graphics)){let e,t="filled";a.Ticker.shared.add((()=>{sl&&!!sl.alpha||!!ul.children.length||!!_l.children.length||!hl.children.length?"filled"!==t&&(t="filled"):"filled"===t?(e=a.Sprite.from("/res/kagari.png"),e.position.set(-9999,-9999),cl.stage.addChild(e),t="clearing"):"clearing"===t&&(e.destroy(),t="empty")}))}yl()}));const Sl="0123456789#%&()*+,-./:<=>?ABCDEFGHIJKLMNOPQRSTUVWXYZ",Fl="";function zl(e){let t="";for(let n=0;n<e.length;n++){const s=Sl.indexOf(e[n]);t+=-1===s?e[n]:Fl[s]}return t}const Tl=(()=>{let e=[];function t(t){e=e.filter((e=>e.name!==t.name))}function n(t){const n=e.filter((e=>e.name===t));return n?n[0]:void 0}return{register:(s,i,o=[])=>{Array.isArray("array")||(o=[o]);const a=n(i);a&&t(a),e.push({obj:s,name:i,classes:o})},unregister:e=>{Array.isArray(e)?e.forEach((e=>{t(e)})):t(e)},unregisterStartingWith:t=>{e=e.filter((e=>!e.name.startsWith(t)))},get:e=>n(e),getAll:t=>function(t){const n=e.filter((e=>e.classes.includes(t)));return n||[]}(t)}})(),Il={0:{y:0},1:{y:500}},Ml=s(0,0,1,1),El=(()=>{const e={};let t=0;function n(e,t,n){const s=Object.keys(t).sort(((e,t)=>parseFloat(e)-parseFloat(t)));let i=0;for(let e=s.length-2;e>=0;e--)if(parseFloat(s[e])<=n){i=s[e];break}let o=1;for(let e=1;e<s.length;e++)if(parseFloat(s[e])>n){o=s[e];break}Object.keys(t[0]).forEach((s=>{let a=t[i][s],r=t[o][s];"inherit"===a&&(t[i][s]=vt(e,s),a=t[i][s]),"inherit"===r&&(t[o][s]=vt(e,s),r=t[o][s]),"string"==typeof a&&"r"===a.slice(-1)&&(a=As(parseFloat(a.slice(0,-1)))),"string"==typeof r&&"r"===r.slice(-1)&&(r=As(parseFloat(r.slice(0,-1)))),vt(e,s,function(e,t,n,s,i){return s+(n-e)/(t-e)*(i-s)}(i,o,n,a,r))}))}function s(t,s=null){e[t]&&(null!==s&&e[t]&&e[t].obj&&!e[t].obj._destroyed&&n(e[t].obj,e[t].animation,s),delete e[t],Cl--)}return a.Ticker.shared.add((function(t){Object.keys(e).forEach((i=>{const o=e[i];o.obj?._destroyed?s(i):(o.progress=Math.min(1,o.progress+o.speed*t),n(o.obj,o.animation,o.curve(o.progress)),o.progress>=1&&(o.onend(o.obj),s(i,1)))}))})),{animate:(n,s,i,o,a=()=>{})=>function(n,s,i,o,a){if(!n)return;const r=""+ ++t;return e[r]={obj:n,animation:s,speed:1/(60*i),progress:0,curve:void 0!==o?o:Ml,onend:a},Cl++,r}(n,s,i,o,a),stop(e,t=null){s(e,t)}}})(),Dl=1.8,Ol={x:30};function Hl(){return window.innerWidth>1920||window.innerHeight>1080?"uhd":"hd"}const Pl={255:"NM_MID",241:"VS_TOP",17:"VS_MID",31:"VS_BTM",81:"VS_TOP",95:"NM_MID",245:"NM_MID",21:"VS_BTM",85:"NM_MID",199:"HS_LFT",68:"HS_MID",124:"HS_RGT",201:"CN_TLF",114:"CN_TRG",156:"CN_BRG",39:"CN_BLF",220:"HS_RGT",103:"HS_LFT",205:"HS_LFT",118:"HS_RGT",64:"ED_TOP",16:"ED_RGT",4:"ED_BTM",1:"ED_LFT",80:"SQ_TRG",65:"SQ_TLF",20:"SQ_BRG",5:"SQ_BLF",84:"HS_RGT",69:"HS_LFT",0:"MM_MID",193:"SQ_TLF",112:"SQ_TRG",28:"SQ_BRG",7:"SQ_BLF",92:"HS_RGT",71:"HS_LFT",197:"HS_LFT",116:"HS_RGT",164:"TS_TOP",41:"TS_RGT",74:"TS_BTM",146:"TS_LFT",228:"HS_MID",105:"CN_TLF",210:"CN_TRG",45:"CN_BLF",78:"HS_MID",150:"CN_BRG",109:"HS_LFT",214:"HS_RGT"},Rl={NM_MID:[0,3],VS_TOP:[0,0],VS_MID:[0,1],VS_BTM:[0,2],HS_LFT:[1,3],HS_MID:[2,3],HS_RGT:[3,3],CN_TLF:[0,4],CN_TRG:[1,4],CN_BRG:[1,5],CN_BLF:[0,5],ED_TOP:[2,0],ED_RGT:[3,1],ED_BTM:[2,2],ED_LFT:[1,1],MM_MID:[2,1],SQ_TLF:[1,0],SQ_TRG:[3,0],SQ_BRG:[3,2],SQ_BLF:[1,2],TS_TOP:[2,4],TS_RGT:[3,4],TS_BTM:[2,5],TS_LFT:[3,5]},Wl={NM_MID:[0,3],VS_TOP:[0,0],VS_MID:[0,1],VS_BTM:[0,2],HS_LFT:[1,3],HS_MID:[2,3],HS_RGT:[3,3],ED_TOP:[2,0],ED_RGT:[3,1],ED_BTM:[2,2],ED_LFT:[1,1],MM_MID:[2,1],SQ_TLF:[1,0],SQ_TRG:[3,0],SQ_BRG:[3,2],SQ_BLF:[1,2]};function $l(e,t,n,s,i,o){const r={};return Object.keys(t).forEach((l=>{r[l]=new a.Texture(e,new a.Rectangle(s+(t[l][0]+i)*(n+2*s),s+(t[l][1]+o)*(n+2*s),n,n))})),r}window.DEVHOOK_CONNECTED_SKIN=()=>{Nl.tetrio=Nl.connected_test,Ul.tetrio=Ul.connected_test};const Nl={tetrio:{id:"tetrio",name:"TETR.IO",assets:{hd:{url:"/res/skins/minos/tetrio.png",loaded:!1,loading:!1,basetexture:null,textures:{}},uhd:{url:"/res/skins/minos/tetrio.2x.png",loaded:!1,loading:!1,basetexture:null,textures:{}}},format:"simple",colors:{base:{z:13521497,l:13533522,o:13550930,s:8441426,i:5426860,j:6705870,t:12800718,d:4605510,gb:6181727,gbd:2359335},glow:{z:16744069,l:16749136,o:16773982,s:10813295,i:8716253,j:10324735,t:16091903,d:6250335,gb:12956103,gbd:4405060}}},_bomb:{id:"_bomb",name:"Overlay: Bombs",assets:{hd:{url:"/res/skins/minos/_bomb.png",loaded:!1,loading:!1,basetexture:null,textures:{}},uhd:{url:"/res/skins/minos/_bomb.2x.png",loaded:!1,loading:!1,basetexture:null,textures:{}}},format:"simple",colors:{base:{z:13521497,l:13533522,o:13550930,s:8441426,i:5426860,j:6705870,t:12800718,d:4605510,gb:6181727,gbd:14954311},glow:{z:16744069,l:16749136,o:16773982,s:10813295,i:8716253,j:10324735,t:16091903,d:6250335,gb:12956103,gbd:14966146}}},connected_test:{id:"connected_test",name:"Connected skin test",assets:{hd:{url:"/res/skins/minos/connected.png",loaded:!1,loading:!1,basetexture:null,textures:{}},uhd:{url:"/res/skins/minos/connected.2x.png",loaded:!1,loading:!1,basetexture:null,textures:{}}},format:"connected",colors:{base:{z:16727357,l:16750653,o:16580413,s:5111613,i:4063176,j:4020223,t:15678975,d:6250335,gb:10066329,gbd:6634081},glow:{z:16744069,l:16749136,o:16773982,s:10813295,i:8716253,j:10324735,t:16091903,d:6250335,gb:12956103,gbd:4405060}}}},Ul={tetrio:{id:"tetrio",name:"TETR.IO",assets:{hd:{url:"/res/skins/ghost/tetrio.png",loaded:!1,loading:!1,basetexture:null,textures:{}},uhd:{url:"/res/skins/ghost/tetrio.2x.png",loaded:!1,loading:!1,basetexture:null,textures:{}}},format:"simple",colorizeGhost:!0,colorizeX:!1},connected_test:{id:"connected_test",name:"Connected skin test",assets:{hd:{url:"/res/skins/ghost/connected.png",loaded:!1,loading:!1,basetexture:null,textures:{}},uhd:{url:"/res/skins/ghost/connected.2x.png",loaded:!1,loading:!1,basetexture:null,textures:{}}},format:"connected",colorizeGhost:!0,colorizeX:!1}},Gl=(()=>{function e(e,t,n=255,s=1,i={}){let o=Nl[e];o||(e="tetrio",o=Nl.tetrio);const r=new a.Sprite(a.Texture.WHITE);return r.width=As(Ol.x)*s,r.height=As(Ol.x)*s,r.tint=o.colors.base[t]||o.colors.base[t.replace("s_","")]||0,r}function t(e){const t=Nl[e];if(!t)return;const s=Hl(),i=t.assets[s];i.loaded||i.loading||(i.loading=!0,i.baseTexture=new a.BaseTexture(i.url),i.baseTexture.valid?n(t,i,s):i.baseTexture.on("loaded",(()=>{n(t,i,s)})))}function n(e,t,n){t.textures=Xl[e.format](t,t.baseTexture,n),t.loaded=!0,bs()}return{generate:function(n,s,i=255,o=1,r={}){let l=Nl[n];if(l||(n="tetrio",l=Nl.tetrio),!l.assets[Hl()].loaded)return l.assets[Hl()].loading||t(n),e(n,s,i,o,r);let c=a.Texture.WHITE;switch(l.assets[Hl()].textures.format){case"10":c=l.assets[Hl()].textures[s];break;case"wang24":c=l.assets[Hl()].textures[s][Pl[i]||255]}const p=new a.Sprite(c);return p.width=As(Ol.x)*o,p.height=As(Ol.x)*o,p},generatePlaceholder:e,generateFlash:function(e){let t=Nl[e];if(t||(e="tetrio",t=Nl.tetrio),!t.assets[Hl()].loaded||!t.assets[Hl()].textures.flashsheet)return;const n=new a.AnimatedSprite(t.assets[Hl()].textures.flashsheet,!0);return n.loop=!1,n.animationSpeed=2,n.onComplete=()=>{n.destroy()},n.play(),El.animate(n,{0:{alpha:.3},1:{alpha:.2}},.2,s(.02,.58,0,.88)),n},getColor:function(e,t,n=!1){let s=Nl[e];s||(e="tetrio",s=Nl.tetrio);const i=s.colors.base[t]||0;return n?`#${i.toString(16).padStart(6,"0")}`:i},getGlowColor:function(e,t,n=!1){let s=Nl[e];s||(e="tetrio",s=Nl.tetrio);const i=s.colors.glow[t]||0;return n?`#${i.toString(16).padStart(6,"0")}`:i},load:t}})(),Xl={simple:(e,t,n)=>{const s=new a.Sprite(new a.Texture(t));s.filters=[new a.filters.AdjustmentFilter({brightness:1.2,contrast:1.2})];const i=Ll("uhd"===n?512:256,"uhd"===n?512:256,s),o="uhd"===n?92:46,r="uhd"===n?2:1,l=[],c=kl("uhd"===n?2:1,new a.Texture(t,new a.Rectangle(r,r,o,o)));for(let e=0;e<25;e++){const t=e%5,n=Math.floor(e/5);l.push(new a.Texture(c,new a.Rectangle(r+t*(o+2*r),r+n*(o+2*r),o,o)))}return{format:"10",z:new a.Texture(t,new a.Rectangle(r+0*(o+2*r),r+0*(o+2*r),o,o)),l:new a.Texture(t,new a.Rectangle(r+1*(o+2*r),r+0*(o+2*r),o,o)),o:new a.Texture(t,new a.Rectangle(r+2*(o+2*r),r+0*(o+2*r),o,o)),s:new a.Texture(t,new a.Rectangle(r+3*(o+2*r),r+0*(o+2*r),o,o)),i:new a.Texture(t,new a.Rectangle(r+4*(o+2*r),r+0*(o+2*r),o,o)),j:new a.Texture(t,new a.Rectangle(r+0*(o+2*r),r+1*(o+2*r),o,o)),t:new a.Texture(t,new a.Rectangle(r+1*(o+2*r),r+1*(o+2*r),o,o)),d:new a.Texture(t,new a.Rectangle(r+2*(o+2*r),r+1*(o+2*r),o,o)),gb:new a.Texture(t,new a.Rectangle(r+3*(o+2*r),r+1*(o+2*r),o,o)),gbd:new a.Texture(t,new a.Rectangle(r+4*(o+2*r),r+1*(o+2*r),o,o)),s_z:new a.Texture(i,new a.Rectangle(r+0*(o+2*r),r+0*(o+2*r),o,o)),s_l:new a.Texture(i,new a.Rectangle(r+1*(o+2*r),r+0*(o+2*r),o,o)),s_o:new a.Texture(i,new a.Rectangle(r+2*(o+2*r),r+0*(o+2*r),o,o)),s_s:new a.Texture(i,new a.Rectangle(r+3*(o+2*r),r+0*(o+2*r),o,o)),s_i:new a.Texture(i,new a.Rectangle(r+4*(o+2*r),r+0*(o+2*r),o,o)),s_j:new a.Texture(i,new a.Rectangle(r+0*(o+2*r),r+1*(o+2*r),o,o)),s_t:new a.Texture(i,new a.Rectangle(r+1*(o+2*r),r+1*(o+2*r),o,o)),s_d:new a.Texture(i,new a.Rectangle(r+2*(o+2*r),r+1*(o+2*r),o,o)),s_gb:new a.Texture(i,new a.Rectangle(r+3*(o+2*r),r+1*(o+2*r),o,o)),s_gbd:new a.Texture(i,new a.Rectangle(r+4*(o+2*r),r+1*(o+2*r),o,o)),flashsheet:l}},connected:(e,t,n)=>{const s=new a.Sprite(new a.Texture(t));s.filters=[new a.filters.AdjustmentFilter({brightness:1.2,contrast:1.2})];const i=Ll("uhd"===n?2048:1024,"uhd"===n?2048:1024,s),o="uhd"===n?92:46,r="uhd"===n?2:1,l=[],c=kl("uhd"===n?2:1,new a.Texture(t,new a.Rectangle(r,r,o,o)));for(let e=0;e<25;e++){const t=e%5,n=Math.floor(e/5);l.push(new a.Texture(c,new a.Rectangle(r+t*(o+2*r),r+n*(o+2*r),o,o)))}return{format:"wang24",z:$l(t,Rl,o,r,0,0),l:$l(t,Rl,o,r,4,0),o:$l(t,Rl,o,r,8,0),s:$l(t,Rl,o,r,12,0),i:$l(t,Rl,o,r,0,6),j:$l(t,Rl,o,r,4,6),t:$l(t,Rl,o,r,8,6),d:$l(t,Rl,o,r,12,6),gb:$l(t,Wl,o,r,16,0),gbd:$l(t,Wl,o,r,16,4),s_z:$l(i,Rl,o,r,0,0),s_l:$l(i,Rl,o,r,4,0),s_o:$l(i,Rl,o,r,8,0),s_s:$l(i,Rl,o,r,12,0),s_i:$l(i,Rl,o,r,0,6),s_j:$l(i,Rl,o,r,4,6),s_t:$l(i,Rl,o,r,8,6),s_d:$l(i,Rl,o,r,12,6),s_gb:$l(i,Wl,o,r,16,0),s_gbd:$l(i,Wl,o,r,16,4),flashsheet:l}}},jl=(()=>{function e(e,t,n=255,s=1,i={}){let o=Ul[e];o||(e="tetrio",o=Ul.tetrio);const r=new a.Sprite(a.Texture.WHITE);return r.width=As(Ol.x)*s,r.height=As(Ol.x)*s,"x"===t&&(r.tint=16711680,r.alpha=.25),r}function t(e){const t=Ul[e];if(!t)return;const s=Hl(),i=t.assets[s];i.loaded||i.loading||(i.loading=!0,i.baseTexture=new a.BaseTexture(i.url),i.baseTexture.valid?n(t,i,s):i.baseTexture.on("loaded",(()=>{n(t,i,s)})))}function n(e,t,n){t.textures=ql[e.format](t,t.baseTexture,n),t.loaded=!0,bs()}return{generate:function(n,s,i=255,o=1,r={}){let l=Ul[n];if(l||(n="tetrio",l=Ul.tetrio),!l.assets[Hl()].loaded)return l.assets[Hl()].loading||t(n),e(n,s,i,o,r);let c=a.Texture.WHITE;switch(l.assets[Hl()].textures.format){case"2":c=l.assets[Hl()].textures[s];break;case"wang24":c=l.assets[Hl()].textures[s][Pl[i]||255]}const p=new a.Sprite(c);return p.width=As(Ol.x)*o,p.height=As(Ol.x)*o,p},generatePlaceholder:e,load:t}})(),ql={simple:(e,t,n)=>{const s="uhd"===n?92:46,i="uhd"===n?2:1;return{format:"2",g:new a.Texture(t,new a.Rectangle(i+0*(s+2*i),i+0*(s+2*i),s,s)),x:new a.Texture(t,new a.Rectangle(i+1*(s+2*i),i+0*(s+2*i),s,s))}},connected:(e,t,n)=>{const s="uhd"===n?92:46,i="uhd"===n?2:1;return{format:"wang24",g:$l(t,Rl,s,i,0,0),x:$l(t,Rl,s,i,4,0)}}},Kl={superlobby:{timeout:3500,starter:e=>(na.PlaySe("cutin_superlobby"),`<img class="cutin_superlobby_backer" src="/res/cutin/superlobby/backing.png" /><p><span>${e}</span>PLAYERS</p>`)}};function Vl(e,...t){if(!Kl[e])return;const n=document.createElement("div");n.className=`cutin cutin_${e}`,n.innerHTML=Kl[e].starter(...t),xt("cutins").appendChild(n),"ultra"===it.video.graphics&&Kl[e].ultra&&Kl[e].ultra(),setTimeout((()=>{n.remove()}),Kl[e].timeout)}class Ql{constructor(e){this.textures=new Map,this.elements=new Map,this.actorfactories=new Map,this.effects=new Map,this.progressive=new Map,this.ctx=e,this._init()}_init(){}get S(){return this.ctx.gsm}get H(){return this.ctx.hm.H}get HS(){return this.ctx.hm.H.holderstate}get CS(){return this.HS.cos*this.HS.asf}IsFullMode(){return this.ctx.hm.IsFullMode()}IsSmallMode(){return this.ctx.hm.IsSmallMode()}IsTinyMode(){return this.ctx.hm.IsTinyMode()}el(e){return this.elements.get(e)||Jl}fx(e){return this.effects.get(e)||ec}af(e){return this.actorfactories.get(e)||ic}progress(e){for(const[,t]of this.progressive)t.progress(e)}}class Yl{constructor(e,t){this.parent=e,this.options=t}create(){}update(){}delete(){}action(e){}progress(e){}}const Jl=new Yl;class Zl{constructor(e,t){this.parent=e,this.options=t}create(){}delete(){}progress(e){}}const ec=new Zl;class tc{constructor(e,t,n){this.parent=e,this.options=t,this.data=n}create(e=!1){}update(){}delete(){}action(e){}progress(e){}}const nc=new tc;class sc{constructor(e,t,n){this.parent=e,this.options=t,this.actorClass=n}create(e,t,n=!1){return nc}}const ic=new sc,oc={generic:{id:"generic",name:"generic testing boardskin",ns:{}},tetrio:{id:"tetrio",name:"TETR.IO",ns:{}},zenith:{id:"zenith",name:"zenith boardskin",ns:{}},zenith_expert:{id:"zenith_expert",name:"zenith expert boardskin",ns:{}},zenith_duoleft:{id:"zenith_duoleft",name:"zenith boardskin, duo LEFT side",ns:{}},zenith_duoright:{id:"zenith_duoright",name:"zenith boardskin, duo RIGHT side",ns:{}},zenith_expert_duoleft:{id:"zenith_expert_duoleft",name:"zenith expert boardskin, duo LEFT side",ns:{}},zenith_expert_duoright:{id:"zenith_expert_duoright",name:"zenith expert boardskin, duo RIGHT side",ns:{}}};oc.generic.ns.Board=class extends Ql{_init(){this.textures.set("board",a.BaseTexture.from("/res/skins/board/generic/board.png?v=3")),this.textures.set("queue",a.BaseTexture.from("/res/skins/board/generic/queue.png")),this.barWidth=Ol.x/1.5,this.sidesOffset=0,this.sidesOffsetMixin=9,this.barWidthOffset=9}constructor(e){super(e),this._init();const t=this.textures.get("board");if(this.elements.set("boardsides",new oc.generic.ns.boardsides(this,{})),this.elements.set("background",new oc.generic.ns.background(this,{texture:new a.Texture(t,new a.Rectangle(2,2,16,16)),texture_tiny:new a.Texture(t,new a.Rectangle(22,2,26,16)),slices:[0,0,0,0],slices_tiny:[10,0,10,10],offsets_tiny:[10,0,10,10]})),this.elements.set("grid",new oc.generic.ns.grid(this,{texture:a.BaseTexture.from("/res/skins/board/generic/grid.png")})),this.elements.set("username",new oc.generic.ns.username(this,{texture:new a.Texture(t,new a.Rectangle(52,2,16,16)),texture_fire:new a.Texture(t,new a.Rectangle(74,2,16,16)),slices:[0,0,0,0],slices_fire:[0,0,0,0],offsets:[9,0,9,0],offsets_fire:[9,0,9,0],font_opts:{}})),this.elements.set("stack",new oc.generic.ns.stack(this,{})),this.elements.set("stock",new oc.generic.ns.stock(this,{texture:new a.Texture(t,new a.Rectangle(2,22,92,92))})),this.elements.set("next",new oc.generic.ns.next(this,{texture:new a.Texture(this.textures.get("queue"),new a.Rectangle(2,2,474,142)),slices:[180,82,50,50],pos:[18,27]})),this.elements.set("hold",new oc.generic.ns.hold(this,{texture:new a.Texture(this.textures.get("queue"),new a.Rectangle(2,148,474,142)),slices:[180,82,50,50],pos:[18,27]})),this.elements.set("skyline",new oc.generic.ns.skyline(this,{texture:new a.Texture(t,new a.Rectangle(98,2,9,73)),slices:[0,9,0,0],height:300})),this.elements.set("stackhint",new oc.generic.ns.stackhint(this,{texture:new a.Texture(t,new a.Rectangle(177,152,64,100)),slices:[31,35,31,0],offsets:[0,30.5,0,0],height:300,tint:16756224})),this.elements.set("garbagedangericon",new oc.generic.ns.garbagedangericon(this,{texture:new a.Texture(t,new a.Rectangle(2,118,92,92)),scale:2})),this.elements.set("targeticon",new oc.generic.ns.targeticon(this,{texture:new a.Texture(t,new a.Rectangle(98,100,69,69)),scale:4})),this.elements.set("enemyicon",new oc.generic.ns.targeticon(this,{texture:new a.Texture(t,new a.Rectangle(256,15,43,43)),scale:4})),this.elements.set("falling",new oc.generic.ns.falling(this,{})),this.elements.set("border",new oc.generic.ns.border(this,{texture:new a.Texture(t,new a.Rectangle(111,2,27,18)),slices:[9,0,9,9],offsets:[9,0,9,9]})),this.elements.set("replaytag",new oc.generic.ns.replaytag(this,{texture:new a.Texture(this.textures.get("queue"),new a.Rectangle(2,294,396,77))})),this.progressive.set("replaytag",this.elements.get("replaytag")),this.elements.set("backer",new oc.generic.ns.backer(this,{font_opts:{}})),this.progressive.set("backer",this.elements.get("backer")),this.elements.set("zen",new oc.generic.ns.zen(this,{font_opts_score:{},font_opts_level:{},font_opts_level_hiero:{}})),this.elements.set("b2b",new oc.generic.ns.b2b(this,{texture:new a.Texture(t,new a.Rectangle(2,214,92,92)),font_opts:{},size:22,y:220})),this.progressive.set("b2b",this.elements.get("b2b")),this.elements.set("b2bdistance",new oc.generic.ns.b2bdistance(this,{texture:new a.Texture(t,new a.Rectangle(2,214,92,92)),font_opts:{},scale:2})),this.progressive.set("b2bdistance",this.elements.get("b2bdistance")),this.S.setoptions.slot_counter1&&this.elements.set("counter1",new oc.generic.ns.counter(this,{font_opts_title:{},font_opts_value:{},font_opts_subtitle:{},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-55})),this.S.setoptions.slot_counter2&&this.elements.set("counter2",new oc.generic.ns.counter(this,{font_opts_title:{},font_opts_value:{},font_opts_subtitle:{},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-125})),this.S.setoptions.slot_counter3&&this.elements.set("counter3",new oc.generic.ns.counter(this,{font_opts_title:{},font_opts_value:{},font_opts_subtitle:{},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-195})),this.S.setoptions.slot_counter4&&this.elements.set("counter4",new oc.generic.ns.counter(this,{font_opts_title:{},font_opts_value:{},font_opts_subtitle:{},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-265})),this.S.setoptions.slot_counter5&&this.elements.set("counter5",new oc.generic.ns.counter(this,{font_opts_title:{},font_opts_value:{},font_opts_subtitle:{},has_subtitle:!0,side:"right",y:!1!==this.S.setoptions.display_next?40+3*Ol.x*(this.S.setoptions.nextcount||5):4})),this.S.setoptions.slot_bar1&&(this.elements.set("bar1",new oc.generic.ns.bar_segmented(this,{side:"left",bar_texture:new a.Texture(t,new a.Rectangle(142,2,27,18)),bar_slices:[9,0,9,9],bar_offsets:[9,0,9,9],offset:this.barWidthOffset,tickers:{garbagecap:{texture:new a.Texture(t,new a.Rectangle(111,88,60,8))},garbageabsolutecap:{texture:new a.Texture(t,new a.Rectangle(111,88,60,8)),color:16717824}},ticker_texture:new a.Texture(t,new a.Rectangle(111,88,60,8)),styles:{generic:{texture:new a.Texture(t,new a.Rectangle(111,24,60,60)),slices:[6,12,6,6],offsets:[0,0,0,0],color:16717824,flash_color:16545127},garbage_inactive:{texture:new a.Texture(t,new a.Rectangle(175,88,60,60)),slices:[6,12,6,6],offsets:[0,0,0,0],color:16717824,flash_color:16545127},garbage_sleeping:{texture:new a.Texture(t,new a.Rectangle(175,88,60,60)),slices:[6,12,6,6],offsets:[0,0,0,0],color:9342606,flash_color:13947088},garbage_caution:{texture:new a.Texture(t,new a.Rectangle(175,88,60,60)),slices:[6,12,6,6],offsets:[0,0,0,0],color:14734351,flash_color:15986871},garbage_danger:{texture:new a.Texture(t,new a.Rectangle(175,88,60,60)),slices:[6,12,6,6],offsets:[0,0,0,0],color:16717824,flash_color:16545127}},general_flash_color:65460})),this.progressive.set("bar1",this.elements.get("bar1"))),this.S.setoptions.slot_bar2){const e=[12078599,16763904];this.elements.set("bar2",new oc.generic.ns.bar_smooth(this,{side:"right",bar_texture:new a.Texture(t,new a.Rectangle(173,2,27,18)),bar_slices:[9,0,9,9],bar_offsets:[9,0,9,9],offset:this.barWidthOffset,fill_texture:new a.Texture(t,new a.Rectangle(175,24,60,60)),fill_slices:[0,30,0,0],fill_offsets:[0,30,0,0],tickers:{generic:{texture:new a.Texture(t,new a.Rectangle(111,88,60,8)),color:16777215}},colors:e,flash_color:16763904})),this.progressive.set("bar2",this.elements.get("bar2"))}this.IsFullMode()&&(this.effects.set("popup_offence",new oc.generic.ns.popup_offence(this,{font_opts:{}})),this.progressive.set("popup_offence",this.effects.get("popup_offence")),this.effects.set("popup_defense",new oc.generic.ns.popup_defense(this,{font_opts:{}})),this.effects.set("clear",new oc.generic.ns.splash(this,{size:45,color:16777215,y:170,animation:"normal",font_opts:{}})),this.effects.set("tspin",new oc.generic.ns.splash(this,{size:30,color:16777215,y:140,animation:"normal",font_opts:{}})),this.effects.set("also",new oc.generic.ns.splash(this,{size:30,color:16767332,y:220,animation:"normal",font_opts:{}})),this.effects.set("combo",new oc.generic.ns.splash(this,{size:60,color:16777215,y:255,animation:"bounce",font_opts:{}})),this.effects.set("countdown",new oc.generic.ns.shout(this,{size:120,color:16762368,y:As(Ol.x*this.ctx.Hh),font_opts:{},animation:{0:{"scale.x":.9,"scale.y":.9,alpha:0,weight:630},.05:{"scale.x":1.1,"scale.y":1.1,alpha:1,weight:700},.3:{"scale.x":1,"scale.y":1,alpha:.95,weight:665},1:{"scale.x":.9,"scale.y":.9,alpha:0,weight:0}},animationDuration:2.5,flatAnimationDuration:.75,animationEasing:s(.1,.38,0,.88),hasShadow:!0,shadowColor:2432256,animationShadow:{0:{"scale.x":1,"scale.y":1,alpha:.8,weight:560},.6:{"scale.x":2.2,"scale.y":2.2,alpha:.5,weight:350},1:{"scale.x":3,"scale.y":3,alpha:0,weight:0}},animationShadowDuration:2,animationShadowEasing:s(.1,.38,0,.88)})),this.effects.set("countdown_stride",new oc.generic.ns.shout(this,{size:120,color:16762368,y:As(Ol.x*this.ctx.Hh),font_opts:{},animation:{0:{"scale.x":.9,"scale.y":.9,alpha:0,weight:630},.05:{"scale.x":1.1,"scale.y":1.1,alpha:1,weight:700},.3:{"scale.x":1,"scale.y":1,alpha:.95,weight:665},1:{"scale.x":.9,"scale.y":.9,alpha:0,weight:0}},animationDuration:1.25,flatAnimationDuration:.5,animationEasing:s(.1,.38,0,.88),hasShadow:!0,shadowColor:2432256,animationShadow:{0:{"scale.x":1,"scale.y":1,alpha:.8,weight:560},.6:{"scale.x":2.2,"scale.y":2.2,alpha:.5,weight:350},1:{"scale.x":3,"scale.y":3,alpha:0,weight:0}},animationShadowDuration:1,animationShadowEasing:s(.1,.38,0,.88)})),this.effects.set("levelup",new oc.generic.ns.shout(this,{size:120,color:6256003,y:As(Ol.x*(this.ctx.Hh+5)),font_opts:{},animation:{0:{y:As(Ol.x*(this.ctx.Hh+5)),alpha:0,weight:0},.05:{y:As(Ol.x*(this.ctx.Hh+4.5)),alpha:1,weight:700},1:{y:As(Ol.x*(this.ctx.Hh-5)),alpha:0,weight:0}},animationDuration:1.5,animationEasing:s(.2,.65,.88,.64),hasShadow:!1})),this.effects.set("timeleft",new oc.generic.ns.shout(this,{size:40,color:16732200,y:As(Ol.x*this.ctx.H/4),font_opts:{},animation:{0:{alpha:0,weight:0,letterSpacing:0,tint:16777215},.05:{alpha:1,weight:700,letterSpacing:.25,tint:16777215},.8:{alpha:1,weight:700,letterSpacing:5,tint:16732200},1:{alpha:0,weight:0,letterSpacing:8,tint:12067584}},animationDuration:4,animationEasing:s(.2,.65,.88,.64),hasShadow:!1})),this.effects.set("clutch",new oc.generic.ns.shout(this,{size:30,color:16771199,y:As(-1*Ol.x),font_opts:{},animation:{0:{alpha:1.5,weight:900,letterSpacing:0},.05:{alpha:1.5,weight:900,letterSpacing:30},1:{alpha:0,weight:0,letterSpacing:50}},animationDuration:1,animationEasing:s(.2,.65,.88,.64),hasShadow:!1})),this.effects.set("allclear",new oc.generic.ns.shout(this,{size:60,color:16777215,y:As(Ol.x*this.ctx.Hh),font_opts:{},animation:{0:{rotation:-10,"scale.x":0,"scale.y":0,alpha:1,weight:700,tint:16777215},.1:{rotation:0,"scale.x":1.4,"scale.y":1.4,alpha:1,weight:700,tint:16737894},.15:{rotation:0,"scale.x":1.3,"scale.y":1.3,alpha:1,weight:700,tint:16777215},.8:{rotation:0,"scale.x":1,"scale.y":1,alpha:.9,weight:630,tint:16753152},1:{rotation:0,"scale.x":.5,"scale.y":.5,alpha:0,weight:0,tint:16777215}},animationDuration:5,animationEasing:s(.06,.18,.65,1.01),hasShadow:!0,shadowColor:2235150,animationShadow:{0:{"scale.x":1,"scale.y":1,alpha:0,weight:0},.09:{"scale.x":1,"scale.y":1,alpha:0,weight:0},.1:{"scale.x":1,"scale.y":1,alpha:1,weight:700},1:{"scale.x":5,"scale.y":5,alpha:0,weight:0}},animationShadowDuration:5,animationShadowEasing:s(.06,.18,.65,1.01)})),this.effects.set("zenlevel",new oc.generic.ns.shout(this,{size:60,color:16777215,y:As(Ol.x*this.ctx.Hh),font_opts:{},animation:{0:{"scale.x":2.5,"scale.y":0,alpha:1,weight:700,tint:16777215},.05:{"scale.x":.8,"scale.y":1.9,alpha:1,weight:700,tint:16755370},.1:{"scale.x":1.4,"scale.y":1.4,alpha:1,weight:700,tint:16737894},.15:{"scale.x":1.3,"scale.y":1.3,alpha:1,weight:700,tint:16777215},1:{"scale.x":1,"scale.y":1,alpha:.9,weight:630,tint:16753152}},animationDuration:5,animationEasing:s(.06,.18,.65,1.01),hasShadow:!0,shadowColor:2235150,animationShadow:{0:{"scale.x":1,"scale.y":1,alpha:0,weight:0},.09:{"scale.x":1,"scale.y":1,alpha:0,weight:0},.1:{"scale.x":1,"scale.y":1,alpha:1,weight:700},1:{"scale.x":5,"scale.y":5,alpha:0,weight:0}},animationShadowDuration:5,animationShadowEasing:s(.06,.18,.65,1.01)})),this.effects.set("duorevive",new oc.generic.ns.shout(this,{size:60,color:16777215,y:As(Ol.x*this.ctx.Hh),font_opts:{},animation:{0:{"scale.x":2.5,"scale.y":0,alpha:1,weight:700,tint:16777215},.1:{"scale.x":.8,"scale.y":1.9,alpha:1,weight:700,tint:16755370},.2:{"scale.x":1.4,"scale.y":1.4,alpha:1,weight:700,tint:16737894},.3:{"scale.x":1.3,"scale.y":1.3,alpha:1,weight:700,tint:16777215},.8:{"scale.x":1,"scale.y":1,alpha:.9,weight:630,tint:16752640},1:{"scale.x":.9,"scale.y":.9,alpha:0,weight:100,tint:16744448}},animationDuration:2.5,animationEasing:s(.06,.18,.65,1.01),hasShadow:!0,shadowColor:2235150,animationShadow:{0:{"scale.x":1,"scale.y":1,alpha:0,weight:0},.2:{"scale.x":1,"scale.y":1,alpha:0,weight:0},.4:{"scale.x":1,"scale.y":1,alpha:1,weight:700},1:{"scale.x":5,"scale.y":5,alpha:0,weight:0}},animationShadowDuration:2.5,animationShadowEasing:s(.06,.18,.65,1.01)})),this.effects.set("undoredo",new oc.generic.ns.undoredo(this,{texture:new a.Texture(t,new a.Rectangle(98,171,69,69)),scale:2.5}))),this.actorfactories.set("wound_timer",new oc.generic.ns.factory_actor(this,{font_opts:{}},oc.generic.ns.wound_timer))}},oc.generic.ns.factory_actor=class extends sc{create(e,t,n=!1){const s=new this.actorClass(this.parent,{...this.options,...e},t);return s.create(n),s}},oc.generic.ns.wound_timer=class extends tc{_animID=null;_t=0;kuros=[];static decideText(e){switch(e.type){case"time":if("INF"===e.time)return"";if(e.time>90)return Math.ceil(e.time/60);{const t=6*Math.ceil(e.time/6);return`${Math.floor(t/60)}\f3.${t%60/6}`}case"clears":return e.amt;default:return"???"}}static decideTintAndSpeed(e){let t=0;switch(e.type){case"time":t="INF"===e.time?0:Math.max(0,Math.min(1,Math.pow(1-e.time/3600,4)));break;case"clears":t=Math.max(0,Math.min(1,Math.pow(1-e.amt/15,2)))}return{r:Math.round(255*t),b:83+(t<.5?Math.round(130*t*2):Math.round(130*(1-t)*2)),speed:.1+.9*Math.pow(t,1.5)}}create(e=!1){if("full"===this.parent.H.displaymode){this.container=new a.Container,this.container.position.set(0,As(Ol.x*(this.data.y-this.parent.ctx.B))),this.container.scale.set(As(1)),this.parent.H.holder.addChild(this.container),this.kuros=[];for(let e=0;e<this.parent.ctx.W;e++){const t=a.Sprite.from("/res/wound-tile.png");t.anchor.set(.5,.5),t.position.set((e+.5)*Ol.x,.5*Ol.x),t.scale.set(Ol.x/64),t.angle=90*Math.floor(4*Math.random()),t.tint=7864531,this.container.addChild(t),this.kuros.push([t,Math.random()])}this.text=new g.Text(oc.generic.ns.wound_timer.decideText(this.data.data),{font:rl.get("seg"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(48),weight:520,tint:16777215,fillAlpha:1,outlineAlpha:1,outlineWeight:750,letterSpacing:4,sharpness:.95,outlineTint:6360360,anchor:[.5,.5],misalignment:[0,0,.1],...this.options.font_opts}),this.text.position.set(As(Ol.x*(this.data.x+.5)),As(Ol.x*(this.data.y-this.parent.ctx.B+.5))),this.text.zIndex=5,this.parent.H.holder.addChild(this.text),e&&this.action("bad")}}delete(){this.container&&!this.container._destroyed&&(this.container.destroy(),this.container=null,this.text.destroy(),this.text=null)}action(e){if(this.container&&!this.container._destroyed&&"minimal"!==it.video.graphics)switch(null!==this._animID&&El.stop(this._animID,1),e){case"good":this.text.misalignmentSeed=Math.floor(1e6*Math.random()),this._animID=El.animate(this.text,{0:{"scale.x":1,"scale.y":1,outlineWeight:750},.5:{"scale.x":1.3,"scale.y":1.3,outlineWeight:980},1:{"scale.x":1,"scale.y":1,outlineWeight:750}},.2,s(.04,.62,.63,.42));break;case"bad":this._animID=El.animate(this.text,{0:{"scale.x":0,"scale.y":0,outlineWeight:750},.5:{"scale.x":2,"scale.y":2,outlineWeight:850},1:{"scale.x":1,"scale.y":1,outlineWeight:750}},.5,s(0,.76,.9,.25)),["medium","high","ultra"].includes(it.video.graphics)&&requestAnimationFrame((()=>{if(!this.container)return;const{r:e,b:t}=oc.generic.ns.wound_timer.decideTintAndSpeed(this.data.data),n=Bl(this.container,Ol.x*this.parent.ctx.Wh,.5*Ol.x);Ur.play("wound_spawn",{x:n.x,y:n.y,s:this.parent.ctx.hm.S(),w:this.parent.ctx.W,tint:e<<16|t})}));break;case"clear":if(["medium","high","ultra"].includes(it.video.graphics)){const e=Bl(this.container,Ol.x*this.parent.ctx.Wh,.5*Ol.x);Ur.play("wound_clear",{x:e.x,y:e.y,s:this.parent.ctx.hm.S(),w:this.parent.ctx.W})}}}progress(e){if(!this.container||this.container._destroyed)return;const{r:t,b:n,speed:s}=oc.generic.ns.wound_timer.decideTintAndSpeed(this.data.data);this._t+=s*e;for(const[e,i]of this.kuros){const o="minimal"===it.video.graphics?.5*i+.3:.75-.25*s+Math.sin(.1*this._t+i*a.PI_2)*(.25+.25*s);e.tint=Math.round(t*o)<<16|Math.round(n*o)}if(this.text.text=oc.generic.ns.wound_timer.decideText(this.data.data),this.container.position.set(0,As(Ol.x*(this.data.y-this.parent.ctx.B))),this.text.position.set(As(Ol.x*(this.data.x+.5)),As(Ol.x*(this.data.y-this.parent.ctx.B+.5))),!["minimal","low"].includes(it.video.graphics)){this.text.outlineTint=t<<16|n,this.text.outlineAlpha=.6+.4*Math.sin(.15*this._t);const i=Bl(this.container,Ol.x*this.parent.ctx.Wh,.5*Ol.x);Ur.play("wound",{x:i.x,y:i.y,s:this.parent.ctx.hm.S(),w:this.parent.ctx.W,tint:t<<16|n,speed:s,dT:e})}}},oc.generic.ns.background=class extends Yl{create(){const e=this.options.offsets_tiny||[0,0,0,0];return this.parent.IsTinyMode()?(this.nsp=new a.NineSlicePlane(this.options.texture_tiny,...this.options.slices_tiny.map((e=>e?e+2:e))),this.nsp.width=Ol.x*this.parent.ctx.W+e[0]+e[2],this.nsp.height=Ol.x*this.parent.ctx.H+e[1]+e[3],this.nsp.position.set(As(-e[0]),As(-e[1]))):(this.nsp=new a.NineSlicePlane(this.options.texture,...this.options.slices.map((e=>e?e+2:e))),this.nsp.width=Ol.x*this.parent.ctx.W+2,this.nsp.height=Ol.x*this.parent.ctx.H+1,this.nsp.position.set(As(-1),0),this.nsp.alpha=void 0===it.video.boardopacity?.85:it.video.boardopacity),this.nsp.scale.set(As(1)),this.parent.H.holder.addChild(this.nsp),this.parent.H.tintables.push(this.nsp),this.nsp}},oc.generic.ns.grid=class extends Yl{create(){if(!this.parent.IsFullMode())return;this.container=new a.Container,this.container.scale.set(ws(1)),this.container.alpha=void 0===it.video.gridopacity?.1:it.video.gridopacity;const e={top:{left:new a.Texture(this.options.texture,new a.Rectangle(2,2,184,184)),center:new a.Texture(this.options.texture,new a.Rectangle(190,2,184,184)),right:new a.Texture(this.options.texture,new a.Rectangle(378,2,184,184)),right3:new a.Texture(this.options.texture,new a.Rectangle(566,2,276,184))},middle:{left:new a.Texture(this.options.texture,new a.Rectangle(2,190,184,184)),center:new a.Texture(this.options.texture,new a.Rectangle(190,190,184,184)),right:new a.Texture(this.options.texture,new a.Rectangle(378,190,184,184)),right3:new a.Texture(this.options.texture,new a.Rectangle(566,190,276,184))},bottom:{left:new a.Texture(this.options.texture,new a.Rectangle(2,378,184,184)),left3:new a.Texture(this.options.texture,new a.Rectangle(2,566,184,276)),center:new a.Texture(this.options.texture,new a.Rectangle(190,378,184,184)),center3:new a.Texture(this.options.texture,new a.Rectangle(190,566,184,276)),right:new a.Texture(this.options.texture,new a.Rectangle(378,378,184,184)),right3wide:new a.Texture(this.options.texture,new a.Rectangle(566,378,276,184)),right3tall:new a.Texture(this.options.texture,new a.Rectangle(378,566,184,276)),right3max:new a.Texture(this.options.texture,new a.Rectangle(566,566,276,276))}},t=!!(this.parent.ctx.W%2),n=!!(this.parent.ctx.H%2);for(let s=0;s<this.parent.ctx.H-1;s+=2)for(let i=0;i<this.parent.ctx.W-1;i+=2){let o="middle";0===s&&(o="top"),s===this.parent.ctx.H-(n?3:2)&&(o="bottom");let r="center";0===i&&(r="left"),i===this.parent.ctx.W-(t?3:2)&&(r="right"),"top"===o&&"right"===r&&t||"middle"===o&&"right"===r&&t?r="right3":"bottom"===o&&("left"===r&&n?r="left3":"center"===r&&n?r="center3":"right"===r&&(n&&t?r="right3max":n?r="right3tall":t&&(r="right3wide")));const l=new a.Sprite(e[o][r]);l.position.set(Bs(Ol.x*i),Bs(Ol.x*s)),this.container.addChild(l),this.parent.H.tintables.push(l)}return this.parent.H.holder.addChild(this.container),this.container}update(e){if(!this.container)return;const t=void 0===it.video.gridopacity?.1:parseFloat(it.video.gridopacity);this.container.alpha=Math.min(1,t+.05*e)}},oc.generic.ns.border=class extends Yl{create(){if(this.parent.IsTinyMode())return;const e=this.options.offsets||[0,0,0,0];return this.nsp=new a.NineSlicePlane(this.options.texture,...this.options.slices.map((e=>e?e+2:e))),this.nsp.width=Bs(Ol.x*this.parent.ctx.W)+e[0]+e[2],this.nsp.height=Bs(Ol.x*this.parent.ctx.H)+e[1]+e[3],this.nsp.position.set(-ws(e[0]),-ws(e[1])),this.nsp.scale.set(ws(1)),this.parent.H.holder.addChild(this.nsp),this.parent.H.tintables.push(this.nsp),this}},oc.generic.ns.bar=class extends Yl{constructor(e,t){super(e,t),this.d={},this.d.tickers=new Map}create(){if(this.parent.IsTinyMode())return;const e=this.options.bar_offsets||[0,0,0,0];this.nsp=new a.NineSlicePlane(this.options.bar_texture,...this.options.bar_slices.map((e=>e?e+2:e))),this.nsp.width=Bs(this.parent.barWidth)+e[0]+e[2],this.nsp.height=Bs(Ol.x*this.parent.ctx.H)+e[1]+e[3];let t=0;t="right"===this.options.side?As(Ol.x*this.parent.ctx.W)+ws(this.options.offset):-As(this.parent.barWidth)-ws(this.options.offset),t-=ws(e[0]),this.nsp.position.set(t,-ws(e[1])),this.nsp.scale.set(ws(1)),this.parent.H.holder.addChild(this.nsp),this.parent.H.tintables.push(this.nsp),this.container=new a.Container,this.container.position.set(e[0],e[1]),this.nsp.addChild(this.container),this.container_extra=new a.Container,this.container_extra.position.set(e[0],e[1]),this.nsp.addChild(this.container_extra);for(const[t,n]of Object.entries(this.options.tickers)){const s=new a.Sprite(n.texture);s.anchor.set(0,.5),s.position.set(e[0],Bs(Ol.x*this.parent.ctx.H)),s.alpha=0,s.v_appr=0,s.v_now=0,n.color?s.tint=n.color:this.parent.H.tintables.push(s),this.nsp.addChild(s),this.d.tickers.set(t,s)}}update(e,t){if(!this.parent.IsTinyMode())switch(e){case"ticker":{const{id:e,value:n}=t;if(!this.d.tickers.has(e))return;this.d.tickers.get(e).v_now=n;break}}}progress(e){if(!this.parent.IsTinyMode())for(const t of this.d.tickers.values())t.v_appr!==t.v_now&&(t.v_appr="minimal"===it.video.graphics||Math.abs(t.v_appr-t.v_now)<2e-4?t.v_now:t.v_now+(t.v_appr-t.v_now)*Math.pow(.9,e),t.position.y=Bs(Ol.x*(this.parent.ctx.H-this.parent.ctx.H*t.v_appr)),t.alpha=1,t.v_appr<1/40?t.alpha=Math.max(0,40*t.v_appr):t.v_appr>.975&&(t.alpha=Math.max(0,40-40*t.v_appr)))}},oc.generic.ns.bar_smooth=class extends oc.generic.ns.bar{create(){this.parent.IsTinyMode()||(super.create(),this.d.value=0,this.d.value_appr=0)}update(e,t){if(!this.parent.IsTinyMode()&&(super.update(e,t),"simple"===e))t!==this.d.value&&(this.d.value=t)}action(e,t){if(!this.parent.IsTinyMode()&&"flash"===e)this._flashBar(this.options.flash_color)}progress(e){if(!this.parent.IsTinyMode()&&(super.progress(e),this.d.value_appr!==this.d.value&&(this.d.value_appr="minimal"===it.video.graphics||Math.abs(this.d.value_appr-this.d.value)<2e-4?this.d.value:this.d.value+(this.d.value_appr-this.d.value)*Math.pow(.9,e),this._updateContents()),this.parent.S.playing&&this.parent.IsFullMode()&&this.d.value_appr)){const t=Bl(this.container,Bs(this.parent.barWidth/2),Bs(Ol.x*this.parent.ctx.H)-Bs(this._getBarHeight(this.d.value_appr)));Ur.play("bar_sparks",{x:t.x,y:t.y,w:Bs(this.parent.barWidth/2),color:this.options.colors[0],dT:e})}}_updateContents(){const e=this.options.fill_offsets||[0,0,0,0],t=this.options.fill_slices.map((e=>e?e+2:e));vl(this.container);let n=0,s=this.d.value_appr;for(s>12&&(s=6+s%6);s>0;){const i=this._getBarHeight(s),o=new a.NineSlicePlane(this.options.fill_texture,...t);o.width=Bs(this.parent.barWidth)+e[0]+e[2],o.height=Bs(i)+e[1]+e[3],o.position.set(0,Bs(Ol.x*this.parent.ctx.H)),o.pivot.set(0,Bs(i)+e[1]+e[3]),o.tint=this.options.colors[n%this.options.colors.length],this.container.addChild(o),s--,n++}}_getBarHeight(e){return Ol.x*Math.min(Math.min(1,e)+(e-Math.min(1,e))/50,3)*this.parent.ctx.H}_flashBar(e){if("minimal"===it.video.graphics||void 0===this.container_extra)return;if(!this.parent.IsFullMode())return;const t=new a.NineSlicePlane(a.Texture.WHITE,0,0,0,0);t.width=Bs(this.parent.barWidth),t.height=Bs(Ol.x*this.parent.ctx.H),t.position.set(Bs(this.parent.barWidth)/2,Bs(Ol.x*this.parent.ctx.W)),t.pivot.set(Bs(this.parent.barWidth)/2,Bs(Ol.x*this.parent.ctx.H)/2),t.tint=e,this.container_extra.addChild(t),El.animate(t,{0:{"scale.x":1,"scale.y":1,alpha:1},1:{"scale.x":2,"scale.y":1.2,alpha:0}},.3,s(.05,.81,.96,.96),(()=>{t.destroy()}))}},oc.generic.ns.bar_segmented=class extends oc.generic.ns.bar{create(){this.parent.IsTinyMode()||(super.create(),this.d.segments=new Map,this.d.dirty=!0,Object.keys(this.options.styles).forEach((e=>{this.options.styles[e].offsets=this.options.styles[e].offsets||[0,0,0,0],this.options.styles[e].slices=this.options.styles[e].slices.map((e=>e?e+2:e)),void 0===this.options.styles[e].flash_color&&(this.options.styles[e].flash_color=this.options.styles[e].color)})))}update(e,t){if(!this.parent.IsTinyMode())switch(super.update(e,t),e){case"upsert":this._upsertSegment(t);break;case"clear":this.d.segments.clear(),this.d.dirty=!0}}action(e,t){if(!this.parent.IsTinyMode())switch(e){case"flash":this._flashBar(this.options.general_flash_color,t);break;case"forceupdate":for(const[e,t]of this.d.segments)t.flagFallDown=!1,t.flagAppear=!1,t.flagRestyled=!1;this._updateContents()}}progress(e){this.parent.IsTinyMode()||(super.progress(e),this.d.dirty&&this._updateContents())}_upsertSegment(e){if(this.d.segments.has(e.id)){const t=this.d.segments.get(e.id),n={...t,...e};let s=!1;if(n.size<=0){this.d.segments.delete(e.id);let n=0;for(const[s,i]of this.d.segments)s>e.id&&(i.flagFallDown="minimal"!==it.video.graphics,i.flagFallDownDistance=++n,i.flagFallDownAmount=(i.flagFallDownAmount||0)+t.size);return void(this.d.dirty=!0)}if(n.size<t.size){let i=1;for(const[s,o]of this.d.segments)s>e.id&&(o.flagFallDown="minimal"!==it.video.graphics,o.flagFallDownDistance=++i,o.flagFallDownAmount=(o.flagFallDownAmount||0)+(t.size-n.size));n.flagFallDown="minimal"!==it.video.graphics,n.flagFallDownDistance=1,n.flagFallDownAmount=(n.flagFallDownAmount||0)+(t.size-n.size),this.d.dirty=!0,s=!0}else n.size>t.size&&(this.d.dirty=!0,s=!0);n.style!==t.style&&(n.flagRestyled="minimal"!==it.video.graphics,this.d.dirty=!0,s=!0),s&&this.d.segments.set(e.id,n)}else{const t={style:"generic",...e,flagAppear:"minimal"!==it.video.graphics};this.d.segments.set(e.id,t),this.d.dirty=!0}}_updateContents(){vl(this.container);let e=0;for(const[t,n]of this.d.segments){const t=this._getBarHeight(n.size),i=this.options.styles[n.style]||this.options.styles.generic,o=i.class||oc.generic.ns.bar_segment;let a=Bs(Ol.x*this.parent.ctx.H-e);n.flagFallDown?a-=Bs(Ol.x*this.parent.ctx.H*(n.flagFallDownAmount||0)):n.flagAppear&&(a-=Bs(5*Ol.x));const r=new o(i.texture,...i.slices,Bs(this.parent.barWidth)+i.offsets[0]+i.offsets[2],Bs(t)+i.offsets[1]+i.offsets[3],i.color);if(r.position.set(0,a),r.pivot.set(0,Bs(t)+i.offsets[1]+i.offsets[3]),r.alpha=n.flagAppear?0:1,this.container.addChild(r),n.flagAppear?(El.animate(r,{0:{y:Bs(Ol.x*this.parent.ctx.H-e-3*Ol.x),alpha:0},1:{y:Bs(Ol.x*this.parent.ctx.H-e),alpha:1}},.25,s(.7,1.62,.63,.74)),n.flagAppear=!1):n.flagFallDown?(El.animate(r,{0:{y:Bs(Ol.x*this.parent.ctx.H-e-Ol.x*this.parent.ctx.H*(n.flagFallDownAmount||0))},1:{y:Bs(Ol.x*this.parent.ctx.H-e)}},.1+.02*n.flagFallDownDistance,s(.79,.09,.61,1.07)),n.flagFallDown=!1,n.flagFallDownDistance=0,n.flagFallDownAmount=0):n.flagRestyled&&(this._flashBar(i.flash_color,n.size,e),n.flagRestyled=!1),e+=t,e>Ol.x*this.parent.ctx.H*2)break}this.d.dirty=!1}_getBarHeight(e){return Ol.x*Math.min(3,e)*this.parent.ctx.H}_flashBar(e,{size:t,pos:n}){if("minimal"===it.video.graphics||void 0===this.container_extra)return;if(!this.parent.IsFullMode())return;const i=this._getBarHeight(t),o=new a.NineSlicePlane(a.Texture.WHITE,0,0,0,0);o.width=Bs(this.parent.barWidth),o.height=Bs(i),o.position.set(Bs(this.parent.barWidth)/2,Bs(Ol.x*this.parent.ctx.H-Ol.x*n)-Bs(i)/2),o.pivot.set(Bs(this.parent.barWidth)/2,Bs(i)/2),o.tint=e,this.container_extra.addChild(o),El.animate(o,{0:{"scale.x":1,"scale.y":1,alpha:1},1:{"scale.x":2,"scale.y":1.2,alpha:0}},.3,s(.05,.81,.96,.96),(()=>{o.destroy()}))}},oc.generic.ns.bar_segment=class extends a.NineSlicePlane{constructor(e,t,n,s,i,o,a,r){super(e,t,n,s,i),this.width=o,this.height=a,this.tint=r}},oc.generic.ns.boardsides=class extends Yl{create(){this.parent.H.leftside.x=this.parent.S.setoptions.slot_bar1?-(As(this.parent.barWidth)+ws(this.parent.barWidthOffset)):0,this.parent.H.rightside.x=this.parent.S.setoptions.slot_bar2?As(Ol.x*this.parent.ctx.W)+As(this.parent.barWidth)+ws(this.parent.barWidthOffset):As(Ol.x*this.parent.ctx.W),this.parent.H.leftside.x-=ws(this.parent.sidesOffset),this.parent.H.rightside.x+=ws(this.parent.sidesOffset);let e=1;if(this.parent.ctx.H<20?e=this.parent.ctx.H/20:this.parent.ctx.H>30&&(e=this.parent.ctx.H/30),this.parent.H.leftside.scale.set(e),this.parent.H.rightside.scale.set(e),e<1){const t=.2*(ws(this.parent.sidesOffsetMixin)/e-ws(this.parent.sidesOffsetMixin));this.parent.H.leftside.x-=t,this.parent.H.rightside.x+=t}}},oc.generic.ns.stack=class extends Yl{create(){return this.stack=new a.Container,this.stack.position.set(0,0),this.parent.H.holder.addChild(this.stack),this.stack}},oc.generic.ns.falling=class extends Yl{create(){return this.falling=new a.Container,this.falling.position.set(0,0),this.parent.H.holder.addChild(this.falling),this.falling}},oc.generic.ns.backer=class extends Yl{create(){this.parent.IsFullMode()&&(!this.parent.S.setoptions.pro&&!this.parent.S.setoptions.zenith||this.parent.S.setoptions.display_replay||(this.text=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(138),weight:600,tint:16777215,outlineTint:0,outlineWeight:900,outlineAlpha:1,alpha:.2,anchor:[.5,0],...this.options.font_opts}),this.text.position.set(As(Ol.x*this.parent.ctx.Wh),As(3.25*Ol.x)),this.parent.H.holder.addChild(this.text),this.parent.H.tintables.push(this.text),["minimal","low"].includes(it.video.graphics)||(this.activeFade=new oc.generic.ns._helper_activefade({positions:[[this.parent.ctx.Wh-2,this.parent.ctx.B+4],[this.parent.ctx.Wh+0,this.parent.ctx.B+4],[this.parent.ctx.Wh+2,this.parent.ctx.B+4],[this.parent.ctx.Wh-3,this.parent.ctx.B+5],[this.parent.ctx.Wh-1,this.parent.ctx.B+5],[this.parent.ctx.Wh+1,this.parent.ctx.B+5]],elements:[this.text],alphaHigh:.2,alphaLow:.1,ctx:this.parent.ctx}))))}update(e){this.text&&(this.text.text=e)}progress(e){this.activeFade&&this.activeFade.progress(e)}},oc.generic.ns.zen=class extends Yl{create(){this.parent.IsFullMode()&&this.parent.S.setoptions.display_zen&&(this.text_score=new g.Text("0",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(19),weight:600,tint:16777215,anchor:[.5,0],...this.options.font_opts_score}),this.text_score.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.H+5)),this.parent.H.holder.addChild(this.text_score),this.parent.H.tintables.push(this.text_score),this.text_level=new g.Text("1",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(38),weight:600,tint:16777215,anchor:[.5,0],...this.options.font_opts_level}),this.text_level.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.H+28)),this.parent.H.holder.addChild(this.text_level),this.parent.H.tintables.push(this.text_level),this.text_level_hiero=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(19),weight:600,tint:16777215,anchor:[.5,0],...this.options.font_opts_level_hiero}),this.text_level_hiero.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.H+64)),this.parent.H.holder.addChild(this.text_level_hiero),this.parent.H.tintables.push(this.text_level_hiero))}update(e,t){this.text_score&&(this.text_score.text=e.toLocaleString("en-US"),this.text_level.text=t,this.text_level_hiero.text=It(t))}},oc.generic.ns.counter=class extends Yl{create(){this.parent.IsFullMode()&&(this.text_title=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(20),weight:500,tint:16777215,anchor:["right"===this.options.side?0:1,0],...this.options.font_opts_title}),this.text_title.position.set(As("right"===this.options.side?10:-10),As(this.options.y)),("left"===this.options.side?this.parent.H.leftside:this.parent.H.rightside).addChild(this.text_title),this.parent.H.tintables.push(this.text_title),this.text_value=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(38),weight:600,tint:16777215,anchor:["right"===this.options.side?0:1,0],...this.options.font_opts_value}),this.text_value.position.set(As("right"===this.options.side?10:-10),As(this.options.y+23)),("left"===this.options.side?this.parent.H.leftside:this.parent.H.rightside).addChild(this.text_value),this.parent.H.tintables.push(this.text_value),this.options.has_subtitle&&(this.text_subtitle=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(20),weight:500,tint:16777215,anchor:["right"===this.options.side?0:1,0],...this.options.font_opts_subtitle}),this.text_subtitle.position.set(As("right"===this.options.side?10:-10),As(this.options.y+64)),("left"===this.options.side?this.parent.H.leftside:this.parent.H.rightside).addChild(this.text_subtitle),this.parent.H.tintables.push(this.text_subtitle)))}update(e,t,n){this.text_value&&(void 0!==e&&(this.text_value.text=e),void 0!==n&&(this.text_title.text=n),this.text_subtitle&&void 0!==t&&(this.text_subtitle.text=t))}},oc.generic.ns.stock=class extends Yl{create(){if(!this.parent.IsTinyMode()){this.stock=new a.Container;for(let e=0;e<this.parent.S.stock;e++){const t=new a.Sprite(this.options.texture);t.width=Ol.x,t.height=Ol.x,t.anchor.set(.5,.5),t.position.set(As(e*Ol.x),0),this.stock.addChild(t)}return this.stock.position.set(As(Ol.x/2)*(this.parent.ctx.W-this.parent.S.stock)+As(Ol.x/2),As(Ol.x*this.parent.ctx.H+(this.parent.S.setoptions.display_username?36:10))+As(Ol.x/2)),this.parent.H.holder.addChild(this.stock),this.stock}}action(e,t){if(!this.parent.IsTinyMode())switch(e){case"drop":{if(!this.stock.children.length)return;const e=this.stock.children[this.stock.children.length-1];if(this.parent.IsFullMode()){const t=Bl(e,0,0);Ur.play("stock_explode",{x:t.x,y:t.y})}e.destroy(),El.animate(this.stock,{0:{x:"inherit"},1:{x:`${As(Ol.x/2)*(this.parent.ctx.W-this.parent.S.stock)+As(Ol.x/2)}`}},1,s(.17,.67,.35,1));break}case"fire":{if(!this.parent.IsFullMode())return;if(!this.stock.children.length)return;const e=this.stock.children[this.stock.children.length-1];e.rotation+=Math.max(.03*t.dT,.1*e.rotation*t.dT);break}}}},oc.generic.ns.b2b=class extends Yl{_anims=[];_knownamt=0;_knowntint=0;static _makeTint(e,t,n){if(!t||e<n)return 16767332;for(const t of oc.generic.ns.b2b.B2B_COLOR_GRADIENT){if(e<t[0]||e>=t[1])continue;t[4]||(t[4]=[t[2]>>16,t[2]>>8&255,255&t[2],t[3]>>16,t[3]>>8&255,255&t[3]]);const n=(e-t[0])/(t[1]-t[0]);return Math.round(t[4][0]+n*(t[4][3]-t[4][0]))<<16|Math.round(t[4][1]+n*(t[4][4]-t[4][1]))<<8|Math.round(t[4][2]+n*(t[4][5]-t[4][2]))}return 16777215}static B2B_COLOR_GRADIENT=[[0,4,39423,65484,null],[4,8,65484,65280,null],[8,12,65280,16776960,null],[12,30,16776960,16711680,null],[30,60,16711680,16711935,null],[60,100,16711935,37375,null],[100,150,37375,9764836,null],[150,250,9764836,16768391,null],[250,500,16768391,16777215,null],[500,1/0,16777215,16777215,null]];create(e){if(this.text)return;if(!this.parent.IsFullMode())return;const t=this.parent.S.setoptions.b2bcharge_at,n=this.parent.S.setoptions.b2bcharge_base,s=oc.generic.ns.b2b._makeTint(e,this.parent.S.setoptions.b2bcharging,t),i=Math.min(4,Math.max(1,(e-t+1)/6));if(this._knownamt=e,this._knowntint=s,this.text=new g.Text(this.parent.S.setoptions.b2bcharging&&e>=t&&t===n+1?"B2B \fc3X":`B2B \fc3X\f5${e}`,{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(this.options.size),weight:600,tint:s,anchor:[1,0],letterSpacing:10,...this.options.font_opts}),this.text.position.set(As(-10),As(this.options.y)),this.parent.H.leftside.addChild(this.text),this.parent.S.setoptions.b2bcharging){this.spr=new a.Sprite(this.options.texture),this.spr.anchor.set(.5,.5),this.spr.position.set(As(-14-10*i),As(this.options.y+9)),this.spr.scale.set(As(this.options.size/50*i)),this.spr.tint=s,this.spr.alpha=e>=t+7-n?1:.3,this.spr.visible=e>=t,this.parent.H.leftside.addChild(this.spr);const o=Math.max(2,`${e-t+1+n}`.length);this.chargetext=new g.Text(e-t+1+n,{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:As(this.options.size/(.5*o)*i),weight:750,outlineTint:0,outlineWeight:900,outlineAlpha:1,tint:s,anchor:[.5,.4]}),this.chargetext.tint=e>=t+7-n?0:s,this.chargetext.outlineTint=e>=t+7-n?16777215:0,this.chargetext.visible=e>=t,this.chargetext.position.set(As(-14-10*i),As(this.options.y+10)),this.parent.H.leftside.addChild(this.chargetext),this.text.position.x=As(e>=t?-15-35*i:-10)}}update(e,t){if(!this.parent.IsFullMode())return;if(!this.text){if(!["set","up","up_large","up_charged"].includes(e))return;if(this.create(t),!this.text)return}this._anims.forEach((e=>El.stop(e,1))),this._anims.length=0;const n=this._knownamt;this._knownamt=t;const i=this.parent.S.setoptions.b2bcharge_at,o=this.parent.S.setoptions.b2bcharge_base,a=oc.generic.ns.b2b._makeTint(t,this.parent.S.setoptions.b2bcharging,i),r=Math.min(4,Math.max(1,(t-i+1)/6));switch(this._knowntint=a,e){case"set":if(this.text.text=this.parent.S.setoptions.b2bcharging&&t>=i&&i===o+1?"B2B \fc3X":`B2B \fc3X\f5${t}`,this.text.alpha=1,this.text.weight=600,this.text.tint=a,this.alpha=1,this.text.letterSpacing=10,this.spr&&t>=i){this.spr.scale.set(As(this.options.size/50*r)),this.spr.tint=a,this.spr.alpha=t>=i+7-o?1:.3,this.spr.visible=!0,this.spr.position.x=As(-14-10*r),this.chargetext.text=t-i+1+o,this.chargetext.tint=t>=i+7-o?0:a,this.chargetext.outlineTint=t>=i+7-o?16777215:0,this.chargetext.visible=!0,this.chargetext.position.x=As(-14-10*r),this.text.position.x=As(-25-25*r);const e=Math.max(2,`${t-i+1+o}`.length);this.chargetext.fontSize=As(this.options.size/(.5*e)*r)}else this.spr.visible=!1,this.chargetext.visible=!1,this.text.position.x=As(-10);break;case"up":if(this.text.text=this.parent.S.setoptions.b2bcharging&&t>=i&&i===o+1?"B2B \fc3X":`B2B \fc3X\f5${t}`,this.text.alpha=1,this.text.weight=600,this.text.tint=a,this.alpha=1,"minimal"!==it.video.graphics?this._anims.push(El.animate(this.text,{0:{letterSpacing:0},1:{letterSpacing:10}},6,s(.1,.38,0,.88))):this.text.letterSpacing=10,this.spr&&t>=i){this.spr.scale.set(As(this.options.size/50*r)),this.spr.tint=a,this.spr.alpha=t>=i+7-o?1:.3,this.spr.visible=!0,this.spr.position.x=As(-14-10*r),this.chargetext.text=t-i+1+o,this.chargetext.tint=t>=i+7-o?0:a,this.chargetext.outlineTint=t>=i+7-o?16777215:0,this.chargetext.visible=!0,this.chargetext.position.x=As(-14-10*r),this.text.position.x=As(-25-25*r);const e=Math.max(2,`${t-i+1+o}`.length);this.chargetext.fontSize=As(this.options.size/(.5*e)*r),"minimal"!==it.video.graphics&&(this._anims.push(El.animate(this.spr,{0:{"scale.x":As(this.options.size/50*r),"scale.y":As(this.options.size/50*r)},.5:{"scale.x":As(this.options.size/50*r*1.2),"scale.y":As(this.options.size/50*r*1.2)},1:{"scale.x":As(this.options.size/50*r),"scale.y":As(this.options.size/50*r)}},.15,s(.04,.62,.63,.42))),this._anims.push(El.animate(this.chargetext,{0:{"scale.x":1,"scale.y":1},.5:{"scale.x":1.4,"scale.y":1.4},1:{"scale.x":1,"scale.y":1}},.15,s(.04,.62,.63,.42))),this._anims.push(El.animate(this.text,{0:{"position.x":As(-25-25*r)},.5:{"position.x":As(-45-25*r)},1:{"position.x":As(-25-25*r)}},.15,s(.04,.62,.63,.42))))}break;case"up_large":if(this.text.text=this.parent.S.setoptions.b2bcharging&&t>=i&&i===o+1?"B2B \fc3X":`B2B \fc3X\f5${t}`,this.text.alpha=1,this.text.weight=600,this.text.tint=a,"minimal"!==it.video.graphics&&this._anims.push(El.animate(this.text,{0:{alpha:1,letterSpacing:0},.16:{alpha:1,letterSpacing:0},.17:{alpha:0,letterSpacing:0},.33:{alpha:0,letterSpacing:0},.34:{alpha:1,letterSpacing:0},"0.50":{alpha:1,letterSpacing:0},.51:{alpha:0,letterSpacing:0},.66:{alpha:0,letterSpacing:0},.67:{alpha:.99,letterSpacing:0},1:{alpha:1,letterSpacing:10}},2,s(.1,.38,0,.88))),this.spr&&t>=i){this.spr.scale.set(As(this.options.size/50*r)),this.spr.tint=a,this.spr.alpha=t>=i+7-o?1:.3,this.spr.visible=!0,this.spr.position.x=As(-14-10*r),this.chargetext.text=t-i+1+o,this.chargetext.tint=t>=i+7-o?0:a,this.chargetext.outlineTint=t>=i+7-o?16777215:0,this.chargetext.visible=!0,this.chargetext.position.x=As(-14-10*r),this.text.position.x=As(-25-25*r);const e=Math.max(2,`${t-i+1+o}`.length);this.chargetext.fontSize=As(this.options.size/(.5*e)*r),"minimal"!==it.video.graphics&&(this._anims.push(El.animate(this.spr,{0:{"scale.x":As(this.options.size/50*r),"scale.y":As(this.options.size/50*r)},.5:{"scale.x":As(this.options.size/50*r*1.2),"scale.y":As(this.options.size/50*r*1.2)},1:{"scale.x":As(this.options.size/50*r),"scale.y":As(this.options.size/50*r)}},.15,s(.04,.62,.63,.42))),this._anims.push(El.animate(this.chargetext,{0:{"scale.x":1,"scale.y":1},.5:{"scale.x":1.4,"scale.y":1.4},1:{"scale.x":1,"scale.y":1}},.15,s(.04,.62,.63,.42))),this._anims.push(El.animate(this.text,{0:{"position.x":As(-25-25*r)},.5:{"position.x":As(-45-25*r)},1:{"position.x":As(-25-25*r)}},.15,s(.04,.62,.63,.42))))}break;case"down":this.delete();break;case"down_large":if("minimal"===it.video.graphics)return this.delete();this.text.tint=14950946,this.text.text="B2B \fc3X\f50",this._anims.push(El.animate(this.text,{0:{alpha:1,weight:600,letterSpacing:0},.1:{alpha:1,weight:600,letterSpacing:0},.105:{alpha:0,weight:600,letterSpacing:0},.2:{alpha:0,weight:600,letterSpacing:0},.205:{alpha:1,weight:600,letterSpacing:0},.3:{alpha:1,weight:600,letterSpacing:0},.305:{alpha:0,weight:600,letterSpacing:0},.4:{alpha:0,weight:600,letterSpacing:0},.405:{alpha:1,weight:600,letterSpacing:0},.5:{alpha:1,weight:600,letterSpacing:0},.505:{alpha:0,weight:600,letterSpacing:0},.6:{alpha:0,weight:600,letterSpacing:0},.605:{alpha:1,weight:600,letterSpacing:0},1:{alpha:0,weight:0,letterSpacing:10}},4,s(.1,.38,0,.88),(()=>{this.delete()})));break;case"up_charged":if(this.text.text=this.parent.S.setoptions.b2bcharging&&t>=i&&i===o+1?"B2B \fc3X":`B2B \fc3X\f5${t}`,this.text.alpha=1,this.text.weight=600,this.text.tint=a,this.alpha=1,"minimal"!==it.video.graphics&&this._anims.push(El.animate(this.text,{0:{letterSpacing:0},1:{letterSpacing:10}},6,s(.1,.38,0,.88))),this.spr){this.spr.scale.set(As(this.options.size/50*r)),this.spr.tint=a,this.spr.alpha=t>=i+7-o?1:.3,this.spr.visible=!0,this.spr.position.x=As(-14-10*r),this.chargetext.text=t-i+1+o,this.chargetext.tint=t>=i+7-o?0:a,this.chargetext.outlineTint=t>=i+7-o?16777215:0,this.chargetext.position.x=As(-14-10*r),this.text.position.x=As(-25-25*r);const e=Math.max(2,`${t-i+1+o}`.length);this.chargetext.fontSize=As(this.options.size/(.5*e)*r),this.chargetext.visible=!0,"minimal"!==it.video.graphics&&(this._anims.push(El.animate(this.spr,{0:{"scale.x":0,"scale.y":0},.5:{"scale.x":As(this.options.size/50*r*1.4),"scale.y":As(this.options.size/50*r*1.4)},1:{"scale.x":As(this.options.size/50*r),"scale.y":As(this.options.size/50*r)}},.25,s(.04,.62,.63,.42))),this._anims.push(El.animate(this.chargetext,{0:{"scale.x":0,"scale.y":0},.5:{"scale.x":1.6,"scale.y":1.6},1:{"scale.x":1,"scale.y":1}},.25,s(.04,.62,.63,.42))),this._anims.push(El.animate(this.text,{0:{"position.x":As(-10)},.5:{"position.x":As(-55-35*r)},1:{"position.x":As(-25-25*r)}},.25,s(.04,.62,.63,.42))))}break;case"down_send":{if("minimal"===it.video.graphics)return this.delete();const e=Bl(this.spr,0,0);if(Ur.play("b2bcharge_ticking",{x:e.x,y:e.y,power:2*Math.min(1,Math.max((n-i+1)/30)),tint:16777215,dT:60}),this.text.tint=16777215,this.text.text=this.parent.S.setoptions.b2bcharging&&n>=i&&i===o+1?"B2B \fc3X":"B2B \fc3X\f50",this._anims.push(El.animate(this.text,{0:{alpha:1,weight:600,letterSpacing:0},.1:{alpha:1,weight:600,letterSpacing:0},.105:{alpha:0,weight:600,letterSpacing:0},.2:{alpha:0,weight:600,letterSpacing:0},.205:{alpha:1,weight:600,letterSpacing:0},.3:{alpha:1,weight:600,letterSpacing:0},.305:{alpha:0,weight:600,letterSpacing:0},.4:{alpha:0,weight:600,letterSpacing:0},.405:{alpha:1,weight:600,letterSpacing:0},.5:{alpha:1,weight:600,letterSpacing:0},.505:{alpha:0,weight:600,letterSpacing:0},.6:{alpha:0,weight:600,letterSpacing:0},.605:{alpha:1,weight:600,letterSpacing:0},1:{alpha:0,weight:0,letterSpacing:10}},4,s(.1,.38,0,.88),(()=>{this.delete()}))),this.spr){const e=Math.min(4,Math.max(1,(n-i+1)/6));this.spr.tint=16777215,this.spr.alpha=1,this.chargetext.tint=0,this.chargetext.outlineTint=16777215,this._anims.push(El.animate(this.spr,{0:{"scale.x":As(this.options.size/50*e),"scale.y":As(this.options.size/50*e)},.5:{"scale.x":As(this.options.size/50*e*1.6),"scale.y":As(this.options.size/50*e*1.6)},1:{"scale.x":0,"scale.y":0}},.5,s(0,.66,.79,.37),(()=>{this.spr&&(this.spr.visible=!1)}))),this._anims.push(El.animate(this.chargetext,{0:{"scale.x":1,"scale.y":1},.5:{"scale.x":4,"scale.y":4},1:{"scale.x":0,"scale.y":0}},.8,s(0,.66,.79,.37),(()=>{this.chargetext&&(this.chargetext.visible=!1)})))}break}}}delete(){this.text&&(this.text.destroy(),this.text=null),this.spr&&(this.spr.destroy(),this.spr=null),this.chargetext&&(this.chargetext.destroy(),this.chargetext=null)}progress(e){if("minimal"!==it.video.graphics&&this.spr){const t=this.parent.S.setoptions.b2bcharge_at;if(this.spr.angle+=e*Math.max(1,Math.min(4,1+.1*(this._knownamt-t+1))),this._knownamt>=4){const n=Bl(this.spr,0,0);Ur.play("b2bcharge_ticking",{x:n.x,y:n.y,power:Math.min(1,Math.max((this._knownamt-t+1)/30)),tint:this._knowntint,dT:e})}}}},oc.generic.ns.popup_defense=class extends Zl{create(e,t={}){if(this.text&&this.delete(),"off"===it.video.actiontext||"some"===it.video.actiontext)return;if("minimal"===it.video.graphics)return;if(!this.parent.IsFullMode())return;this.text=new g.Text(e,{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(40+4*Math.min(10,e)),weight:700,tint:46335,anchor:[.5,.5],outlineTint:0,outlineWeight:950,outlineAlpha:1,misalignment:[1,3,.1],...this.options.font_opts});const n=.25*Math.random()-.125,i=.25*Math.random()-.125;this.text.rotation=n,this.text.position.set(As(Ol.x*t.x),As(Ol.x*(t.y-(this.parent.ctx.B-.5)))),this.text.zIndex=1e3,this.parent.H.holder.addChild(this.text);const o=Math.atan2(t.y-this.parent.ctx.B-this.parent.ctx.Hh,t.x-this.parent.ctx.Wh)+Math.PI/2;El.animate(this.text,{0:{x:As(Ol.x*t.x),y:As(Ol.x*(t.y-(this.parent.ctx.B-.5))),rotation:n,alpha:1,weight:700},.8:{x:As(Ol.x*t.x)-As(1.6*Ol.x*Math.sin(o)),y:As(Ol.x*(t.y-(this.parent.ctx.B-.5)))+As(1.6*Ol.x*Math.cos(o)),rotation:n+.8*i,alpha:.7,weight:700},1:{x:As(Ol.x*t.x)-As(2*Ol.x*Math.sin(o)),y:As(Ol.x*(t.y-(this.parent.ctx.B-.5)))+As(2*Ol.x*Math.cos(o)),rotation:n+i,alpha:0,weight:500}},2,s(.1,.38,0,.88),(()=>{this.delete()}))}delete(){this.text&&(this.text.destroy(),this.text=null)}},oc.generic.ns.popup_offence=class extends Zl{create(e,t={}){if(this.text&&this.delete(),"off"===it.video.actiontext||"some"===it.video.actiontext)return;if("minimal"===it.video.graphics)return;if(!this.parent.IsFullMode())return;t.y=Math.min(t.y,39);const n=1.6+.12*Math.min(30,e);this.text=new g.Text(e,{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(Ol.x*n),weight:600,tint:0,anchor:[.5,.5],outlineTint:16777215,outlineWeight:950,outlineAlpha:1,misalignment:[1+.1*Math.min(30,e),1+.1*Math.min(30,e),.2],useProjection:!0,projection:[[0,0],[1,0],[0,1],[1,1]],...this.options.font_opts});const i=Math.atan2(t.y-this.parent.ctx.B-this.parent.ctx.Hh,t.x-this.parent.ctx.Wh)+Math.PI/2,o=t.x,a=t.y;let r=t.x+1.5*n*Math.sin(i),l=t.y-1.5*n*Math.cos(i);r=Math.min(13.5,Math.max(-3.5,r)),l=Math.min(42.5,Math.max(17.5,l));let c=!0;t.evasive&&!this.parent.ctx.bhm.IsInactive(r,l,e>=10)&&(r=t.x+3*n*Math.sin(i),l=t.y-3*n*Math.cos(i),r=Math.min(13.5,Math.max(-3.5,r)),l=Math.min(42.5,Math.max(17.5,l))),t.evasive&&e>=10&&r>=9&&(l-this.parent.ctx.B)/this.parent.ctx.H>-.1&&(l-this.parent.ctx.B)/this.parent.ctx.H<=.85&&(this.text.fillAlpha=.5,this.text.outlineAlpha=.75,c=!1),t.evasive&&e>=10&&r<=1&&(l-this.parent.ctx.B)/this.parent.ctx.H>-.1&&(l-this.parent.ctx.B)/this.parent.ctx.H<=.35&&(this.text.fillAlpha=.5,this.text.outlineAlpha=.75,c=!1),this.text.x=As(Ol.x*o),this.text.y=As(Ol.x*(a-(this.parent.ctx.B-.5))),this.text.scale.set(0),this.text.zIndex=1e3,this.parent.H.holder.addChild(this.text),i<-.25*Math.PI||i>1.25*Math.PI?(this.text.projection[0].x=.1*Math.random()-.05,this.text.projection[0].y=e>=10?-.1:-.05,this.text.projection[2].x=.1*Math.random()-.05,this.text.projection[2].y=e>=10?1.1:1.05,this.text.rotation=i-1.5*Math.PI,this.text.anchor.x=1):i<.25*Math.PI?(this.text.projection[0].x=-.05,this.text.projection[0].y=.1*Math.random()-.05,this.text.projection[1].x=1.05,this.text.projection[1].y=.1*Math.random()-.05,this.text.rotation=i,this.text.anchor.y=1):i<.75*Math.PI?(this.text.projection[1].x=.1*Math.random()-.05+1,this.text.projection[1].y=e>=10?-.1:-.05,this.text.projection[3].x=.1*Math.random()-.05+1,this.text.projection[3].y=e>=10?1.1:1.05,this.text.rotation=i-.5*Math.PI,this.text.anchor.x=0):(this.text.projection[2].x=-.05,this.text.projection[2].y=.1*Math.random()-.05+1,this.text.projection[3].x=1.05,this.text.projection[3].y=.1*Math.random()-.05+1,this.text.rotation=i-1*Math.PI,this.text.anchor.y=0);const p=e.toString();for(let e=0;e<p.length;e++)this.text.overrides.get(e).scale=.2,setTimeout((()=>{this.text&&!this.text._destroyed&&El.animate(this.text.overrides.get(e),{0:{scale:.2},1:{scale:1}},.2,s(.03,.51,.61,.85))}),e*(250/p.length));El.animate(this.text,{0:{alpha:1,"scale.x":0,"scale.y":0,weight:600,x:As(Ol.x*o),y:As(Ol.x*(a-(this.parent.ctx.B-.5)))},.3:{alpha:1,"scale.x":1,"scale.y":1,weight:700,x:As(Ol.x*r),y:As(Ol.x*(l-(this.parent.ctx.B-.5)))},1:{alpha:0,"scale.x":1.1,"scale.y":1.1,weight:600,x:As(Ol.x*r),y:As(Ol.x*(l-(this.parent.ctx.B-.5)))}},2,s(0,.71,.51,.15),(()=>{this.delete()})),e>=20?El.animate(this.text,{0:{tint:16777215,outlineTint:0},.2:{tint:16777215,outlineTint:0},.201:{tint:0,outlineTint:16777215},.4:{tint:0,outlineTint:16777215},.401:{tint:16777215,outlineTint:0},.6:{tint:16777215,outlineTint:0},.601:{tint:0,outlineTint:16777215},.8:{tint:0,outlineTint:16777215},.801:{tint:16777215,outlineTint:0},.999:{tint:16777215,outlineTint:0},1:{tint:0,outlineTint:16777215}},.5):e>=10&&El.animate(this.text,{0:{tint:16777215,outlineTint:0},.33:{tint:16777215,outlineTint:0},.331:{tint:0,outlineTint:16777215},.66:{tint:0,outlineTint:16777215},.661:{tint:16777215,outlineTint:0},.999:{tint:16777215,outlineTint:0},1:{tint:0,outlineTint:16777215}},.33),t.evasive&&c&&(this.activeFade=new oc.generic.ns._helper_activefade({positions:[[r,l,e>=10]],elements:[this.text],keyvalues:[["fillAlpha",1,.15],["outlineAlpha",1,.35]],ctx:this.parent.ctx,interval:5,speed:.05}))}delete(){this.text&&(this.text.destroy(),this.text=null)}progress(e){this.text&&this.activeFade&&this.activeFade.progress(e)}},oc.generic.ns.skyline=class extends Yl{create(){if(!this.parent.IsFullMode()||this.parent.S.setoptions.nolockout)return;if(this.nsp)return;const e=this.options.offsets||[0,0,0,0];return this.nsp=new a.NineSlicePlane(this.options.texture,...this.options.slices.map((e=>e?e+2:e))),this.nsp.width=Bs(Ol.x*this.parent.ctx.W)+e[0]+e[2],this.nsp.height=this.options.height+e[1]+e[3],this.nsp.position.set(-ws(e[0]),-ws(e[1])),this.nsp.alpha=.5,this.nsp.scale.set(ws(1)),this.parent.H.holder.addChild(this.nsp),this}update(){(this.nsp||(this.create(),this.nsp))&&(this.nsp.alpha=.25*Math.random()+.5)}delete(){this.nsp&&(this.nsp.destroy(),this.nsp=null)}},oc.generic.ns.stackhint=class extends Yl{create(){if(!this.parent.IsFullMode())return;if(!this.parent.S.setoptions.pro)return;if(this.nsp)return;const e=this.options.offsets||[0,0,0,0];return this.nsp=new a.NineSlicePlane(this.options.texture,...this.options.slices.map((e=>e?e+2:e))),this.nsp.width=Bs(Ol.x*this.parent.ctx.W)+e[0]+e[2],this.nsp.height=this.options.height+e[1]+e[3],this.nsp.position.set(-ws(e[0]),-ws(e[1]+this.options.height)),this.nsp.alpha=0,this.nsp.tint=this.options.tint||0,this.nsp.scale.set(ws(1)),this.parent.H.holder.addChild(this.nsp),this}update(e){if(this.nsp||this.create(),!this.nsp)return;this.nsp.position.set(-ws(this.options.offsets[0]),-ws(this.options.offsets[1])+As(Ol.x*(this.parent.ctx.H-e)));const t=this.parent.ctx.H-e;this.nsp.alpha=e<=0?0:Math.min(1,Math.max(0,t<0?0:.25+.25*t))}delete(){this.nsp&&(this.nsp.destroy(),this.nsp=null)}},oc.generic.ns.garbagedangericon=class extends Yl{create(){if(this.parent.IsFullMode()&&!this.spr)return this.spr=new a.Sprite(this.options.texture),this.spr.anchor.set(.5,.5),this.spr.position.set(0,As(Ol.x*this.parent.ctx.Hh)),this.spr.scale.set(0),this.parent.H.holder.addChild(this.spr),El.animate(this.spr,{0:{"scale.x":0,"scale.y":0},.05:{"scale.x":ws(2*this.options.scale),"scale.y":ws(2*this.options.scale)},.1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.2:{"scale.x":ws(2*this.options.scale),"scale.y":ws(2*this.options.scale)},.3:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.5:{"scale.x":ws(2*this.options.scale),"scale.y":ws(2*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},5,s(.03,.8,.5,.93)),this}delete(){this.spr&&(this.spr.destroy(),this.spr=null)}},oc.generic.ns.garbagewindupicon=class extends Yl{create(e){if(!this.parent.IsFullMode())return;if(this.spr_base)return;const t=this.parent.S.zenith.allyincapacitated?1.5:3;this.spr_base=new a.Sprite(this.options.texture_base),this.spr_base.anchor.set(.5,.5),this.spr_base.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*t)),this.spr_base.renderable=!1,this.parent.H.holder.addChild(this.spr_base),this.spr_base_flash=new a.Sprite(this.options.texture_base),this.spr_base_flash.anchor.set(.5,.5),this.spr_base_flash.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*t)),this.spr_base_flash.scale.set(ws(1*this.options.scale)),this.spr_base_flash.renderable=!1,this.parent.H.holder.addChild(this.spr_base_flash),this.spr_exclam_a=new a.Sprite(this.options.texture_exclam_a),this.spr_exclam_a.anchor.set(.5,.5),this.spr_exclam_a.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*t)),this.spr_exclam_a.renderable=!1,this.parent.H.holder.addChild(this.spr_exclam_a),this.spr_exclam_b=new a.Sprite(this.options.texture_exclam_b),this.spr_exclam_b.anchor.set(.5,.5),this.spr_exclam_b.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*t)),this.spr_exclam_b.renderable=!1,this.parent.H.holder.addChild(this.spr_exclam_b),e>=1&&setTimeout((()=>{this.spr_base&&(this.spr_base.renderable=!0,this.spr_base.tint=this.options.tints[0],El.animate(this.spr_base,{0:{"scale.x":0,"scale.y":0},.5:{"scale.x":ws(1.2*this.options.scale),"scale.y":ws(1.2*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.25,s(.04,.62,.63,.42)),this.spr_exclam_a.renderable=!0,El.animate(this.spr_exclam_a,{0:{"scale.x":0,"scale.y":0},.5:{"scale.x":ws(1.4*this.options.scale),"scale.y":ws(1.4*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.25,s(.04,.62,.63,.42)))}),0),e>=2&&setTimeout((()=>{this.spr_base&&(this.spr_base.tint=this.options.tints[1],El.animate(this.spr_base,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.5:{"scale.x":ws(1.2*this.options.scale),"scale.y":ws(1.2*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.15,s(.04,.62,.63,.42)),El.animate(this.spr_exclam_a,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.5:{"scale.x":ws(1.4*this.options.scale),"scale.y":ws(1.4*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.15,s(.04,.62,.63,.42)))}),345),e>=3&&setTimeout((()=>{this.spr_base&&(this.spr_base.tint=this.options.tints[2],El.animate(this.spr_base,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.5:{"scale.x":ws(1.3*this.options.scale),"scale.y":ws(1.3*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.15,s(.04,.62,.63,.42)),this.spr_exclam_a.renderable=!1,this.spr_exclam_b.renderable=!0,El.animate(this.spr_exclam_b,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.5:{"scale.x":ws(1.5*this.options.scale),"scale.y":ws(1.5*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.15,s(.04,.62,.63,.42)))}),545),e>=4&&setTimeout((()=>{this.spr_base&&(this.spr_base.tint=this.options.tints[3],El.animate(this.spr_base,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.5:{"scale.x":ws(1.4*this.options.scale),"scale.y":ws(1.4*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.15,s(.04,.62,.63,.42)),El.animate(this.spr_exclam_b,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)},.5:{"scale.x":ws(1.7*this.options.scale),"scale.y":ws(1.7*this.options.scale)},1:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale)}},.15,s(.04,.62,.63,.42)))}),745);for(let t=0;t<e;t++)setTimeout((()=>{this.spr_base&&(El.animate(this.spr_base,{0:{angle:0},1:{angle:90}},.25,s(.27,1.56,.75,1)),this.spr_base_flash.renderable=!0,El.animate(this.spr_base_flash,{0:{angle:0,alpha:1},1:{angle:90,alpha:0}},.25,s(.27,1.56,.75,1)))}),1e3+500*t);return setTimeout((()=>{this.spr_base&&(El.animate(this.spr_base,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale),alpha:1},1:{"scale.x":ws(.3*this.options.scale),"scale.y":ws(.3*this.options.scale),alpha:0}},.35,s(.6,.07,.94,.76)),El.animate(this.spr_exclam_a,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale),alpha:1},1:{"scale.x":ws(.3*this.options.scale),"scale.y":ws(.3*this.options.scale),alpha:0}},.35,s(.6,.07,.94,.76)),El.animate(this.spr_exclam_b,{0:{"scale.x":ws(1*this.options.scale),"scale.y":ws(1*this.options.scale),alpha:1},1:{"scale.x":ws(.3*this.options.scale),"scale.y":ws(.3*this.options.scale),alpha:0}},.35,s(.6,.07,.94,.76)))}),1e3+500*e),setTimeout((()=>{this.delete()}),1500+500*e),this}delete(){this.spr_base&&(this.spr_base.destroy(),this.spr_base=null),this.spr_exclam_a&&(this.spr_exclam_a.destroy(),this.spr_exclam_a=null),this.spr_exclam_b&&(this.spr_exclam_b.destroy(),this.spr_exclam_b=null)}},oc.generic.ns.b2bdistance=class extends Yl{_knowncount=0;create(e){if(!this.parent.IsFullMode()||!1===it.video.siren||"off"===it.video.actiontext||"some"===it.video.actiontext)return;this.container&&this.container.destroy();const t=Math.min(1,Math.max(0,(-e-8)/4)),n=Math.min(1,Math.max(0,(-e-12)/20)),i=16724736-(Math.round(51*t)<<8)+Math.round(255*n);return this._knowncount=e,this.container=new a.Container,this.container.position.set(As(Ol.x*this.parent.ctx.Wh),As(3*Ol.x)),this.container.scale.set(As(this.options.scale)*(1+Math.min(2,Math.min(0,e+8)/-30))),this.parent.H.holder.addChild(this.container),this.spr=new a.Sprite(this.options.texture),this.spr.anchor.set(.5,.5),this.spr.tint=i,this.spr.alpha=0,this.spr.scale.set(.4),this.container.addChild(this.spr),this.text=new g.Text(e,{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:17,weight:750,outlineTint:0,outlineWeight:900,outlineAlpha:1,tint:i,anchor:[.5,.4]}),this.text.position.set(0,.5),this.container.addChild(this.text),El.animate(this.spr,{0:{"scale.x":0,"scale.y":0,alpha:0},.5:{"scale.x":.6,"scale.y":.6,alpha:1},1:{"scale.x":.3,"scale.y":.3,alpha:.3}},.25,s(.04,.62,.63,.42)),El.animate(this.text,{0:{"scale.x":0,"scale.y":0},.5:{"scale.x":1.5,"scale.y":1.5},1:{"scale.x":1,"scale.y":1}},.25,s(.04,.62,.63,.42)),["minimal","low"].includes(it.video.graphics)||(this.activeFade=new oc.generic.ns._helper_activefade({positions:[[this.parent.ctx.Wh-1,this.parent.ctx.B+2],[this.parent.ctx.Wh+0,this.parent.ctx.B+3]],elements:[this.container],alphaHigh:1,alphaLow:.3,ctx:this.parent.ctx})),this}update(e){if(!this.container)return;this._knowncount=e,this.text.text=e||"!!",this.container.scale.set(As(this.options.scale)*(1+Math.min(2,e/-30)));const t=Math.min(1,Math.max(0,(-e-8)/4)),n=Math.min(1,Math.max(0,(-e-12)/20)),s=16724736-(Math.round(51*t)<<8)+Math.round(255*n);this.text.tint=s,this.spr.tint=s}delete(e){if(!this.container)return;this._knowncount=e;const t=this.spr,n=this.text,i=this.container;this.spr=null,this.text=null,this.container=null,n.text=e||"!!",e||(t.tint=16777215,n.tint=0),El.animate(t,{0:{"scale.x":.3,"scale.y":.3,alpha:e?.3:1},1:{"scale.x":.1,"scale.y":.1,alpha:0}},.35,s(.6,.07,.94,.76)),El.animate(n,{0:{"scale.x":1,"scale.y":1,alpha:1},1:{"scale.x":.5,"scale.y":.5,alpha:0}},.35,s(.6,.07,.94,.76)),setTimeout((()=>{i.destroy()}),400)}progress(e){this.container&&(this.spr.angle-=e*Math.max(1,Math.min(4,1+.1*this._knowncount)),this.activeFade&&this.activeFade.progress(e))}},oc.generic.ns.targeticon=class extends Yl{create(){if(!this.spr&&!this.parent.IsFullMode())return this.spr=new a.Sprite(this.options.texture),this.spr.anchor.set(.5,.5),this.spr.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.Hh)),this.spr.scale.set(0),this.parent.H.holder.addChild(this.spr),this.parent.IsTinyMode()?this.spr.scale.set(ws(4*this.options.scale)):El.animate(this.spr,{0:{"scale.x":0,"scale.y":0},.2:{"scale.x":ws(4*this.options.scale),"scale.y":ws(4*this.options.scale)},1:{"scale.x":ws(3*this.options.scale),"scale.y":ws(3*this.options.scale)}},.3,s(.03,.8,.5,.93)),this}delete(){this.spr&&(this.spr.destroy(),this.spr=null)}},oc.generic.ns.enemyicon=class extends Yl{create(){if(!this.spr&&!this.parent.IsFullMode())return this.spr=new a.Sprite(this.options.texture),this.spr.anchor.set(.5,.5),this.spr.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.Hh)),this.spr.scale.set(0),this.parent.H.holder.addChild(this.spr),this.parent.IsTinyMode()?this.spr.scale.set(ws(4*this.options.scale)):El.animate(this.spr,{0:{"scale.x":0,"scale.y":0},.2:{"scale.x":ws(4*this.options.scale),"scale.y":ws(4*this.options.scale)},1:{"scale.x":ws(3*this.options.scale),"scale.y":ws(3*this.options.scale)}},.3,s(.03,.8,.5,.93)),this}delete(){this.spr&&(this.spr.destroy(),this.spr=null)}},oc.generic.ns.undoredo=class extends Zl{create(e){if(this.spr&&this.delete(),"off"!==it.video.actiontext&&"some"!==it.video.actiontext&&"minimal"!==it.video.graphics&&this.parent.IsFullMode())return this.spr=new a.Sprite(this.options.texture),this.spr.anchor.set(.5,.5),this.spr.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.Hh)),this.spr.scale.set(ws(this.options.scale*(e?-2:2)),ws(2*this.options.scale)),this.parent.H.holder.addChild(this.spr),El.animate(this.spr,{0:{"scale.x":ws(this.options.scale*(e?-2:2)),"scale.y":ws(2*this.options.scale),alpha:1},1:{"scale.x":ws(this.options.scale*(e?-3.5:3.5)),"scale.y":ws(3.5*this.options.scale),alpha:0}},.5,s(.11,.42,.58,1),(()=>{this.delete()})),El.animate(this.spr,{0:{"anchor.x":.5},.25:{"anchor.x":.75},1:{"anchor.x":.5}},.25),this}delete(){this.spr&&(this.spr.destroy(),this.spr=null)}},oc.generic.ns.next=class extends Yl{create(){if(this.parent.IsTinyMode())return;if(!1===this.parent.S.setoptions.display_next)return;const e=this.options.offsets||[0,0,0,0];this.options.texture_bg&&(this.nspbg=new a.NineSlicePlane(this.options.texture_bg,...this.options.slices_bg.map((e=>e?e+2:e))),this.nspbg.width=Bs(36+4*Ol.x)+this.options.offsets_bg[0]+this.options.offsets_bg[2],this.nspbg.height=Bs(28+3*Ol.x*(this.parent.S.setoptions.nextcount||5))+this.options.offsets_bg[1]+this.options.offsets_bg[3],this.nspbg.position.set(-ws(this.options.offsets_bg[0]),-ws(this.options.offsets_bg[1])),this.nspbg.scale.set(ws(1)),this.parent.H.rightside.addChild(this.nspbg),this.parent.H.tintables.push(this.nspbg)),this.nsp=new a.NineSlicePlane(this.options.texture,...this.options.slices.map((e=>e?e+2:e))),this.nsp.width=Bs(36+4*Ol.x)+e[0]+e[2],this.nsp.height=Bs(28+3*Ol.x*(this.parent.S.setoptions.nextcount||5))+e[1]+e[3],this.nsp.position.set(-ws(e[0]),-ws(e[1])),this.nsp.scale.set(ws(1)),this.parent.H.rightside.addChild(this.nsp),this.parent.H.tintables.push(this.nsp),this.containers=[];for(let t=0;t<this.parent.S.setoptions.nextcount;t++)this.containers[t]=new a.Container,this.containers[t].position.set(Bs(this.options.pos[0]+2*Ol.x)+e[0],Bs(this.options.pos[1]+1.5*Ol.x+3*Ol.x*t)+e[1]),this.containers[t].scale.set(Ls(1)),this.nsp.addChild(this.containers[t]);return this.containers}},oc.generic.ns.hold=class extends Yl{create(){if(this.parent.IsTinyMode())return;if(!1===this.parent.S.setoptions.display_hold)return;const e=this.options.offsets||[0,0,0,0],t=this.options.bottom?3.7:3;if(this.options.texture_bg){this.nspbg=new a.NineSlicePlane(this.options.texture_bg,...this.options.slices_bg.map((e=>e?e+2:e))),this.nspbg.width=Bs(36+4*Ol.x)+this.options.offsets_bg[0]+this.options.offsets_bg[2],this.nspbg.height=Bs(28+Ol.x*t)+this.options.offsets_bg[1]+this.options.offsets_bg[3];const e=this.options.bottom?As(Ol.x*(this.parent.ctx.H-t)-28)-ws(this.options.offsets_bg[1]):-ws(this.options.offsets_bg[1]);this.nspbg.position.set(-As(36+4*Ol.x)-ws(this.options.offsets_bg[0]),e),this.nspbg.scale.set(ws(1)),this.parent.H.leftside.addChild(this.nspbg),this.parent.H.tintables.push(this.nspbg)}this.nsp=new a.NineSlicePlane(this.options.texture,...this.options.slices.map((e=>e?e+2:e))),this.nsp.width=Bs(36+4*Ol.x)+e[0]+e[2],this.nsp.height=Bs(28+Ol.x*t)+e[1]+e[3];const n=this.options.bottom?As(Ol.x*(this.parent.ctx.H-t)-28)-ws(e[1]):-ws(e[1]);return this.nsp.position.set(-As(36+4*Ol.x)-ws(e[0]),n),this.nsp.scale.set(ws(1)),this.parent.H.leftside.addChild(this.nsp),this.parent.H.tintables.push(this.nsp),this.container=new a.Container,this.container.position.set(Bs(this.options.pos[0]+2*Ol.x)+e[0],Bs(this.options.pos[1]+Ol.x*t/2)+e[1]),this.container.scale.set(Ls(1)),this.nsp.addChild(this.container),this.container}},oc.generic.ns.splash=class extends Zl{create(e,t={}){if(this.text&&this.delete(),"off"!==it.video.actiontext&&"minimal"!==it.video.graphics&&this.parent.IsFullMode())switch(this.text=new g.Text(e,{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(this.options.size),weight:600,tint:t.color||this.options.color,anchor:[1,0],...this.options.font_opts}),this.text.position.set(As(-10),As(this.options.y)),this.parent.H.leftside.addChild(this.text),this.options.animation){case"normal":this.parent.S.setoptions.zenith_allspin?this.parent.S.zenith.lastclearwasdupe?(this.text.tint=16711680,this.text.letterSpacing=10,this.text.weight=650,this.text.invert=1,this.text.outlineAlpha=1,this.text.outlineTint=16777215,this.text.outlineWeight=990,this.text.misalignment=[4,10,.4],El.animate(this.text,{0:{"misalignment[0]":40,"misalignment[1]":60,"misalignment[2]":1.2,misalignmentSeed:0},1:{"misalignment[0]":2,"misalignment[1]":4,"misalignment[2]":.2,misalignmentSeed:1e6}},.5,s(.1,.38,0,.88))):El.animate(this.text,{0:{letterSpacing:0,alpha:1,weight:600},.6:{letterSpacing:10,alpha:.95,weight:570},1:{letterSpacing:20,alpha:.7,weight:500}},6,s(.1,.38,0,.88)):El.animate(this.text,{0:{letterSpacing:0,alpha:1,weight:600},.6:{letterSpacing:10,alpha:.95,weight:570},1:{letterSpacing:20,alpha:0,weight:0}},6,s(.1,.38,0,.88),(()=>{this.delete()}));break;case"bounce":El.animate(this.text,{0:{y:`${this.options.y}r`,alpha:1,weight:600},.1:{y:this.options.y-10+"r",alpha:1,weight:600},.2:{y:`${this.options.y}r`,alpha:1,weight:600},.6:{y:`${this.options.y}r`,alpha:.95,weight:570},1:{y:`${this.options.y}r`,alpha:0,weight:0}},6,s(.1,.38,0,.88),(()=>{this.delete()}))}}delete(){this.text&&(this.text.destroy(),this.text=null)}},oc.generic.ns.shout=class extends Zl{create(e,t={}){this.parent.IsFullMode()&&(this.text&&this.delete(),this.options.hasShadow&&"minimal"!==it.video.graphics&&(this.textShadow=new g.Text(e,{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(this.options.size/this.parent.CS),weight:700,tint:this.options.shadowColor,anchor:[.5,.5],align:"center",...this.options.font_opts}),this.textShadow.blendMode=a.BLEND_MODES.SCREEN,this.textShadow.position.set(As(Ol.x*this.parent.ctx.Wh),this.options.y),this.textShadow.zIndex=2e3,this.parent.H.holder.addChild(this.textShadow)),this.text=new g.Text(e,{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(this.options.size/this.parent.CS),weight:700,tint:this.options.color,anchor:[.5,.5],align:"center",...this.options.font_opts}),this.text.blendMode=a.BLEND_MODES.SCREEN,this.text.position.set(As(Ol.x*this.parent.ctx.Wh),this.options.y),this.text.zIndex=2001,this.parent.H.holder.addChild(this.text),"minimal"!==it.video.graphics?(El.animate(this.text,this.options.animation,this.options.animationDuration,this.options.animationEasing,(()=>{this.delete()})),this.options.hasShadow&&El.animate(this.textShadow,this.options.animationShadow,this.options.animationShadowDuration,this.options.animationShadowEasing,(()=>{this.textShadow.destroy()}))):setTimeout((()=>{this.delete()}),1e3*(this.options.flatAnimationDuration||0)||1e3*this.options.animationDuration),"ultra"===it.video.graphics&&this.options.ultra&&setTimeout((()=>{const e=Bl(this.parent.H.holder,this.text.x,this.text.y);this.options.ultra(e.x,e.y)}),10))}delete(){this.text&&(this.text.destroy(),this.text=null),this.textShadow&&(this.textShadow.destroy(),this.textShadow=null)}},oc.generic.ns.username=class extends Yl{create(){const e=this.options.offsets||[0,0,0,0],t=this.options.offsets_fire||[0,0,0,0];this.parent.S.setoptions.display_username&&(this.parent.IsTinyMode()&&"low"===it.video.caching||(this.bg=new a.NineSlicePlane(this.options.texture,...this.options.slices.map((e=>e?e+2:e))),this.bg.width=Bs(Ol.x*this.parent.ctx.W)+e[0]+e[2],this.bg.height=Bs(26)+e[1]+e[3],this.bg.scale.set(ws(1)),this.bg.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.H+10)),this.bg.pivot.set(Bs(Ol.x*this.parent.ctx.Wh)+e[0],e[1]),this.parent.H.holder.addChild(this.bg),this.parent.H.tintables.push(this.bg),this.parent.S.setoptions.display_fire&&(this.fg=new a.NineSlicePlane(this.options.texture_fire,...this.options.slices_fire.map((e=>e?e+2:e))),this.fg.width=0,this.fg.height=Bs(26)+t[1]+t[3],this.fg.scale.set(ws(1)),this.fg.alpha=0,this.fg.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.H+10)),this.fg.pivot.set(0,t[1]),this.parent.H.holder.addChild(this.fg),this.parent.H.tintables.push(this.fg)),this.text=new g.Text(this.parent.S.setoptions.username.toUpperCase()||"",{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(19),weight:600,tint:16777215,anchor:[.5,0],...this.options.font_opts}),this.text.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.H+15)),this.parent.H.holder.addChild(this.text),this.parent.H.hybridtintables.push(this.text)))}update(e){if(!this.fg)return;const t=this.options.offsets_fire||[0,0,0,0];if(this.parent.IsTinyMode())this.fg.alpha=e>=500?.2+Math.min(.7,(e-500)/20):0,this.fg.width=Bs(Ol.x*this.parent.ctx.W)+t[0]+t[2],this.fg.pivot.x=Bs(Ol.x*this.parent.ctx.Wh);else{this.fg.alpha=e>=500?.2+Math.min(.7,(e-500)/20):.1+e/3500;const n=e>=500?1+(e-500)/1500:e/500;this.fg.width=(Bs(Ol.x*this.parent.ctx.W)+t[0]+t[2])*n,this.fg.pivot.x=Bs(Ol.x*this.parent.ctx.Wh)*n}}action(e){switch(e){case"startfire":{const e=Bl(this.parent.H.stackobj,0,0);Ur.play("fire_flair",{x:e.x,y:e.y,w:this.parent.ctx.W*this.parent.CS,h:this.parent.ctx.H*this.parent.CS});break}case"continuefire":if(this.parent.IsTinyMode()){const e=Bl(this.parent.H.holder,As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.Hh));Ur.play("fire_burning",{x:e.x,y:e.y})}else{const e=Bl(this.parent.H.stackobj,0,0);Ur.play("fire_burn",{x:e.x,y:e.y,w:this.parent.ctx.W*this.parent.CS,h:this.parent.ctx.H*this.parent.CS})}}}},oc.generic.ns.replaytag=class extends Yl{create(){if(this.parent.IsFullMode()&&this.parent.S.setoptions.display_replay)return this.spr=new a.Sprite(this.options.texture),this.spr.anchor.set(1,0),this.spr.position.set(As(Ol.x*this.parent.ctx.W),As(.5*Ol.x)),this.spr.scale.set(ws(1)),this.parent.H.holder.addChild(this.spr),this.parent.H.tintables.push(this.spr),["minimal","low"].includes(it.video.graphics)||(this.activeFade=new oc.generic.ns._helper_activefade({positions:[[this.parent.ctx.W-5,this.parent.ctx.B+1],[this.parent.ctx.W-3,this.parent.ctx.B+1],[this.parent.ctx.W-1,this.parent.ctx.B+1]],elements:[this.spr],alphaHigh:1,alphaLow:.5,ctx:this.parent.ctx})),this}progress(e){this.activeFade&&this.activeFade.progress(e)}},oc.generic.ns._helper_activefade=class{constructor(e){"full"===e.ctx.hm.H.displaymode&&"minimal"!==it.video.graphics&&(this.options=e,this.tick=0,this.state=!0)}progress(e){"full"===this.options.ctx.hm.H.displaymode&&"minimal"!==it.video.graphics&&(this.tick+=e,this.tick>=(this.options.interval||15)&&(this.tick-=this.options.interval||15,this._check()))}_check(){const e=this.options.positions.every((e=>this.options.ctx.bhm.IsInactive(...e)));e!==this.state&&(e?this._animateInactive():this._animateActive(),this.state=e)}_animateInactive(){for(const e of this.options.elements){const t={0:{},1:{}};if(this.options.keyvalues)for(const e of this.options.keyvalues)t[0][e[0]]=e[2],t[1][e[0]]=e[1];else t[0]={alpha:this.options.alphaLow},t[1]={alpha:this.options.alphaHigh};El.animate(e,t,.2)}}_animateActive(){for(const e of this.options.elements){const t={0:{},1:{}};if(this.options.keyvalues)for(const e of this.options.keyvalues)t[0][e[0]]=e[1],t[1][e[0]]=e[2];else t[0]={alpha:this.options.alphaHigh},t[1]={alpha:this.options.alphaLow};El.animate(e,t,this.options.speed||.1)}}};const ac=".2x",rc=1;oc.zenith.ns.Board=class extends oc.generic.ns.Board{_init(){this.textures.set("board",a.BaseTexture.from(`/res/skins/board/zenith/base${ac}.png`)),this.textures.set("queue",a.BaseTexture.from("/res/skins/board/generic/queue.png")),this.textures.set("zenithrank",a.BaseTexture.from("/res/skins/board/zenith/zenithrank.png")),this.textures.set("boardflash",a.BaseTexture.from("/res/board-flash.png")),this.textures.set("boardflashinv",a.BaseTexture.from("/res/board-flash-inv.png")),this.barWidth=Ol.x/1.5,this.sidesOffset=47,this.sidesOffsetMixin=9,this.barWidthOffset=20}constructor(e){super(e),this._init();const t=this.textures.get("board");if(this.S.setoptions.zenith){this.elements.set("zenithrank",new oc.zenith.ns.zenithrank(this,{texture:this.textures.get("zenithrank")})),this.progressive.set("zenithrank",this.elements.get("zenithrank"));const e=rc,n=127*e;this.elements.set("zenithmods",new oc.zenith.ns.zenithmods(this,{textures:{expert:new a.Texture(t,new a.Rectangle(3166*e,2147*e,n,n)),duo:new a.Texture(t,new a.Rectangle(3296*e,2147*e,n,n)),doublehole:new a.Texture(t,new a.Rectangle(3426*e,2147*e,n,n)),volatile:new a.Texture(t,new a.Rectangle(3166*e,2017*e,n,n)),gravity:new a.Texture(t,new a.Rectangle(3686*e,2017*e,n,n)),nohold:new a.Texture(t,new a.Rectangle(3296*e,2017*e,n,n)),messy:new a.Texture(t,new a.Rectangle(3426*e,2017*e,n,n)),invisible:new a.Texture(t,new a.Rectangle(3556*e,2017*e,n,n)),allspin:new a.Texture(t,new a.Rectangle(3556*e,2147*e,n,n))}}))}if(this.elements.set("background",new oc.generic.ns.background(this,{texture:new a.Texture(t,new a.Rectangle(3163*rc,169*rc,920*rc,1840*rc)),texture_tiny:new a.Texture(t,new a.Rectangle(10*rc,1201*rc,60*rc,40*rc)),slices:[0,0,0,0],slices_tiny:[20*rc,0,20*rc,20*rc],offsets_tiny:[20*rc,0,20*rc,20*rc]})),this.elements.set("username",new oc.zenith.ns.username(this,{font_opts:{}})),this.elements.set("stock",new oc.generic.ns.stock(this,{texture:new a.Texture(t,new a.Rectangle(20*rc,1021*rc,92*rc,92*rc))})),this.elements.set("next",new oc.generic.ns.next(this,{texture:new a.Texture(t,new a.Rectangle(2539*rc,69*rc,610*rc,1734*rc)),slices:[0,250*rc,0,250*rc],offsets:[0,100*rc,150*rc,150*rc],texture_bg:new a.Texture(t,new a.Rectangle(199*rc,1079*rc,460*rc,1380*rc)),slices_bg:[0,0,0,0],offsets_bg:[3*rc,-104*rc,3*rc,3*rc],pos:[20*rc,32*rc]})),this.elements.set("hold",new oc.generic.ns.hold(this,{texture:new a.Texture(t,new a.Rectangle(49*rc,69*rc,610*rc,630*rc)),slices:[0,250*rc,0,250*rc],offsets:[150*rc,100*rc,0,150*rc],texture_bg:new a.Texture(t,new a.Rectangle(199*rc,793*rc,460*rc,276*rc)),slices_bg:[0,0,0,0],offsets_bg:[3*rc,-104*rc,3*rc,3*rc],pos:[20*rc,32*rc]})),this.elements.set("skyline",new oc.generic.ns.skyline(this,{texture:new a.Texture(t,new a.Rectangle(7*rc,1030*rc,9*rc,73*rc)),slices:[0,9*rc,0,0],height:300})),this.elements.set("stackhint",new oc.generic.ns.stackhint(this,{texture:new a.Texture(t,new a.Rectangle(121*rc,1111*rc,64*rc,100*rc)),slices:[31*rc,35*rc,31*rc,0],offsets:[0,30.5*rc,0,0],height:300,tint:16756224})),this.elements.set("garbagedangericon",new oc.generic.ns.garbagedangericon(this,{texture:new a.Texture(t,new a.Rectangle(21*rc,923*rc,92*rc,92*rc)),scale:2})),this.elements.set("garbagewindupicon",new oc.generic.ns.garbagewindupicon(this,{texture_base:new a.Texture(t,new a.Rectangle(7*rc,1250*rc,92*rc,92*rc)),texture_exclam_a:new a.Texture(t,new a.Rectangle(103*rc,1250*rc,92*rc,92*rc)),texture_exclam_b:new a.Texture(t,new a.Rectangle(103*rc,1346*rc,92*rc,92*rc)),tints:[16760576,16742144,16722432,16711795],scale:2})),this.elements.set("targeticon",new oc.generic.ns.targeticon(this,{texture:new a.Texture(t,new a.Rectangle(124*rc,934*rc,69*rc,69*rc)),scale:4})),this.elements.set("enemyicon",new oc.generic.ns.targeticon(this,{texture:new a.Texture(t,new a.Rectangle(138*rc,1047*rc,43*rc,43*rc)),scale:4})),this.elements.set("border",new oc.generic.ns.border(this,{texture:new a.Texture(t,new a.Rectangle(989*rc,69*rc,1220*rc,2110*rc)),slices:[180*rc,180*rc,180*rc,200*rc],offsets:[150*rc,100*rc,150*rc,170*rc]})),this.elements.set("b2b",new oc.generic.ns.b2b(this,{texture:new a.Texture(t,new a.Rectangle(7*rc,1346*rc,92*rc,92*rc)),font_opts:{},size:22,y:220})),this.progressive.set("b2b",this.elements.get("b2b")),this.S.setoptions.slot_counter1&&this.elements.set("counter1",new oc.generic.ns.counter(this,{font_opts_title:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_value:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_subtitle:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-55})),this.S.setoptions.slot_counter2&&this.elements.set("counter2",new oc.generic.ns.counter(this,{font_opts_title:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_value:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_subtitle:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-125})),this.S.setoptions.slot_counter3&&this.elements.set("counter3",new oc.generic.ns.counter(this,{font_opts_title:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_value:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_subtitle:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-195})),this.S.setoptions.slot_counter4&&this.elements.set("counter4",new oc.generic.ns.counter(this,{font_opts_title:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_value:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_subtitle:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-265})),this.S.setoptions.slot_counter5&&this.elements.set("counter5",new oc.generic.ns.counter(this,{font_opts_title:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_value:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},font_opts_subtitle:{outlineTint:0,outlineWeight:900,outlineAlpha:.6},has_subtitle:!1,side:"left",y:Ol.x*Math.min(30,Math.max(20,this.ctx.H))-335})),this.S.setoptions.slot_bar1&&(this.elements.set("bar1",new oc.generic.ns.bar_segmented(this,{side:"left",bar_texture:new a.Texture(t,new a.Rectangle(689*rc,69*rc,231*rc,2090*rc)),bar_slices:[0,180*rc,0,180*rc],bar_offsets:[150*rc,100*rc,20*rc,150*rc],offset:this.barWidthOffset,tickers:{garbagecap:{texture:new a.Texture(t,new a.Rectangle(91*rc,857*rc,60*rc,8*rc))},garbageabsolutecap:{texture:new a.Texture(t,new a.Rectangle(91*rc,857*rc,60*rc,8*rc)),color:16717824}},ticker_texture:new a.Texture(t,new a.Rectangle(91*rc,857*rc,60*rc,8*rc)),styles:{generic:{texture:new a.Texture(t,new a.Rectangle(20*rc,851*rc,60*rc,60*rc)),slices:[6*rc,12*rc,6*rc,6*rc],offsets:[0,0,0,0],color:16717824,flash_color:16545127},garbage_inactive:{texture:new a.Texture(t,new a.Rectangle(20*rc,787*rc,60*rc,60*rc)),slices:[6*rc,12*rc,6*rc,6*rc],offsets:[0,0,0,0],color:16717824,flash_color:16545127},garbage_sleeping:{texture:new a.Texture(t,new a.Rectangle(20*rc,787*rc,60*rc,60*rc)),slices:[6*rc,12*rc,6*rc,6*rc],offsets:[0,0,0,0],color:9342606,flash_color:13947088},garbage_caution:{texture:new a.Texture(t,new a.Rectangle(20*rc,787*rc,60*rc,60*rc)),slices:[6*rc,12*rc,6*rc,6*rc],offsets:[0,0,0,0],color:14734351,flash_color:15986871},garbage_danger:{texture:new a.Texture(t,new a.Rectangle(20*rc,787*rc,60*rc,60*rc)),slices:[6*rc,12*rc,6*rc,6*rc],offsets:[0,0,0,0],color:16717824,flash_color:16545127}},general_flash_color:65460})),this.progressive.set("bar1",this.elements.get("bar1"))),this.S.setoptions.slot_bar2){const e=[12078599,16763904];this.elements.set("bar2",new oc.generic.ns.bar_smooth(this,{side:"right",bar_texture:new a.Texture(t,new a.Rectangle(2278*rc,69*rc,231*rc,2090*rc)),bar_slices:[0,180*rc,0,180*rc],bar_offsets:[20*rc,100*rc,150*rc,150*rc],offset:this.barWidthOffset,fill_texture:new a.Texture(t,new a.Rectangle(91*rc,787*rc,60*rc,60*rc)),fill_slices:[0,30*rc,0,0],fill_offsets:[0,30*rc,0,0],tickers:{generic:{texture:new a.Texture(t,new a.Rectangle(91*rc,857*rc,60*rc,8*rc)),color:16777215}},colors:e,flash_color:16763904})),this.progressive.set("bar2",this.elements.get("bar2"))}this.effects.set("boardflash",new oc.zenith.ns.boardflash(this,{texture:new a.Texture(this.textures.get("boardflash")),texture_inv:new a.Texture(this.textures.get("boardflashinv")),scale:10}))}},oc.zenith.ns.zenithrank=class extends Yl{_layers={};_progressor={};_rank=null;_t=0;create(){if(this.parent.IsTinyMode())return;if(!this.parent.S.setoptions.zenith)return;if(!this.options.texture)return;this.container=new a.Container;if(this.container.position.set(As(Ol.x*(this.parent.S.setoptions.zenith_duo?this.parent.ctx.W+3.15:this.parent.ctx.Wh)),As(Ol.x*this.parent.ctx.H+10)),this.container.scale.set(ws(1.1)),this.container.zIndex=5,this.parent.H.holder.addChild(this.container),this._progressor={host:new a.Container,base:null,filled:null,filling:null},this.options.texture_chip){const e=new a.Sprite(this.options.texture_chip);e.anchor.set(.5,0),e.position.set(0,As(16)),e.scale.set(1/1.1),this.container.addChild(e)}const e=oc.zenith.ns.ZENITHRANK_GEOS.padding;for(const[t,n]of Object.entries(oc.zenith.ns.ZENITHRANK_GEOS.layers)){this._layers[t]={host:new a.Container,els:{}},this.container.addChild(this._layers[t].host),"minimal"===it.video.graphics&&"glow"===t&&(this._layers[t].host.visible=!1);for(const[s,i]of Object.entries(oc.zenith.ns.ZENITHRANK_GEOS.els)){const o=`${t}.${s}`;if(oc.zenith.ns.ZENITHRANK_TEX.has(o)||oc.zenith.ns.ZENITHRANK_TEX.set(o,new a.Texture(this.options.texture,new a.Rectangle(n.x+i.u-e,n.y+i.v-e,i.w+2*e,i.h+2*e),new a.Rectangle(n.x,n.y,1e3,270),new a.Rectangle(i.x-e,i.y-e,i.w+2*e,i.h+2*e),0,{x:.5,y:0})),"1"===s){if("idle"===t){this._progressor.base=new a.Sprite(oc.zenith.ns.ZENITHRANK_TEX.get(o)),this._progressor.host.addChild(this._progressor.base);continue}if("active"===t){this._progressor.filled=new a.Sprite(oc.zenith.ns.ZENITHRANK_TEX.get(o)),this._progressor.host.addChild(this._progressor.filled);continue}}this._layers[t].els[s]=new a.Sprite(oc.zenith.ns.ZENITHRANK_TEX.get(o)),"glow"===t&&this.parent.IsFullMode()&&(this._layers[t].els[s].blendMode=a.BLEND_MODES.ADD),this._layers[t].els[s].__xphase=3*Math.random()+.2,this._layers[t].host.addChild(this._layers[t].els[s])}if("glow"===t){if(!oc.zenith.ns.ZENITHRANK_TEX.has("phase")){const e=oc.zenith.ns.ZENITHRANK_GEOS.phase;oc.zenith.ns.ZENITHRANK_TEX.set("phase",new a.Texture(this.options.texture,new a.Rectangle(e.u,e.v,e.w,e.h),void 0,void 0,0,{x:.5,y:0}))}this._layers[t].els.phase=new a.Sprite(oc.zenith.ns.ZENITHRANK_TEX.get("phase")),this._layers[t].els.phase.scale.set(3.27),this._layers[t].els.phase.position.set(0,75),this._layers[t].els.phase.tint=13237284,this._layers[t].els.phase.alpha=0,this.parent.IsFullMode()&&(this._layers[t].els.phase.blendMode=a.BLEND_MODES.ADD),this._layers[t].els.phase.visible="minimal"!==it.video.graphics,this._layers[t].host.addChild(this._layers[t].els.phase)}}this.container.addChild(this._progressor.host);const t=oc.zenith.ns.ZENITHRANK_GEOS.els[1],n=oc.zenith.ns.ZENITHRANK_GEOS.layers.active.y,s=new a.Geometry;s.addAttribute("positions",[0,0,0,t.h,t.w,0,t.w,t.h],2),s.addAttribute("uvs",[t.u/1024,(t.v+n)/1024,t.u/1024,(t.v+n+t.h)/1024,(t.u+t.w)/1024,(t.v+n)/1024,(t.u+t.w)/1024,(t.v+n+t.h)/1024],2),s.addIndex([0,1,2,1,3,2]),this._progressor.filling=new a.Mesh(s,new a.MeshMaterial(new a.Texture(this.options.texture))),this._progressor.filling.position.set(t.w/-2,t.y),this._progressor.host.addChild(this._progressor.filling),this.parent.IsFullMode()&&(this.text=new g.Text("",{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:90,weight:600,tint:16777215,outlineTint:16777215,outlineWeight:900,outlineAlpha:.3,anchor:[.5,0]}),this.text.position.set(0,34),this.container.addChild(this.text))}action(e,t,n){if("bonus"!==e)return;if("minimal"===it.video.graphics)return;if("off"===it.video.actiontext||"some"===it.video.actiontext)return;if(!this.container)return;this.bonusText&&this.bonusText.destroy();const i={...oc.zenith.ns.ZENITHRANK_COLORS[Math.floor(this._rank)]??oc.zenith.ns.ZENITHRANK_COLORS.default},o=i.r<<16|i.g<<8|i.b;this.bonusText=new g.Text("",{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:Math.min(250,70+5*t),weight:600,tint:o,outlineTint:o,outlineWeight:900,outlineAlpha:.3,anchor:[.5,"ally"===n?-.5:1.5]});let a=0;switch(n){case"self_duo":a=-25*Ol.x;break;case"ally":a=25*Ol.x}this.bonusText.position.set(a,25),this.container.addChild(this.bonusText),this.bonusText.text=`+${Math.floor(t).toLocaleString("en-US")}\f3.${Math.floor(10*(t-Math.floor(t))).toString().padStart(1,"0")}`,this.bonusText._flashed=!1,this.bonusText._origTint=o,this.bonusText._accum=0,El.animate(this.bonusText,{0:{"scale.x":1.5,"scale.y":1.5,"position.x":a},.5:{"scale.x":1,"scale.y":1,"position.x":a},1:{"scale.x":0,"scale.y":0,"position.x":0}},1.3,s(0,.96,1,.01),(()=>{this.bonusText.destroy(),this.bonusText=null}))}progress(e){if(!this.container)return;this._t+=e,this.text&&(this.text.text=it.video.lowrescounters||"minimal"===it.video.graphics?Math.floor(this.parent.S.stats.zenith.altitude).toLocaleString("en-US"):`${Math.floor(this.parent.S.stats.zenith.altitude).toLocaleString("en-US")}\f3.${Math.floor(10*(this.parent.S.stats.zenith.altitude-Math.floor(this.parent.S.stats.zenith.altitude))).toString().padStart(1,"0")}`),this._rank=null===this._rank?this.parent.S.stats.zenith.rank:this.parent.S.stats.zenith.rank+(this._rank-this.parent.S.stats.zenith.rank)*Math.pow(.9,e),(it.video.lowrescounters||"minimal"===it.video.graphics)&&(this._rank=this.parent.S.stats.zenith.rank);const t=this._rank,n=Math.floor(t),s=t-n,i={...oc.zenith.ns.ZENITHRANK_COLORS[n]??oc.zenith.ns.ZENITHRANK_COLORS.default},o={...oc.zenith.ns.ZENITHRANK_COLORS[n+1]??oc.zenith.ns.ZENITHRANK_COLORS.default};if(s>.96)for(const e of Object.keys(i))i[e]=Math.round(i[e]+(s-.96)/.04*(o[e]-i[e]));const a=i.r<<16|i.g<<8|i.b,r=i.sr<<16|i.sg<<8|i.sb;this.text&&(this.text.tint=i.tr<<16|i.tg<<8|i.tb,this.text.outlineTint=a,"minimal"!==it.video.graphics&&(this.text.misalignment=[0,Math.max(0,(this.text.misalignment[1]??0)-e/10,Math.min(10,2*this.parent.S.zenith.bonusremaining)),0],this.text.misalignmentSeed=Math.floor(performance.now()))),this._progressor.base.tint=a,this._progressor.filled.tint=a,this._progressor.filled.alpha=n>=2;for(const[n,s]of Object.entries(this._layers)){switch(n){case"active":s.host.alpha=Math.max(.3,Math.min(1,1-.005*(this.parent.ctx.esm.frame-this.parent.S.zenith.rank_locked_until)));break;case"glow":s.host.alpha=Math.max(0,s.host.alpha-e/60,Math.min(1,.6*this.parent.S.zenith.bonusremaining))}if(!(s.host.alpha<=0))for(const[i,o]of Object.entries(s.els)){if(o.tint=("glow"===n?r:a)||14042715,"phase"===i){o.alpha=Math.max(0,o.alpha-e/15,Math.min(1,8*this.parent.S.zenith.bonusremaining));continue}o.alpha=Math.max(0,Math.min(1,15*(t-oc.zenith.ns.ZENITHRANK_GEOS.els[i].rank+.05+.03*Math.sin(this._t/o.__xphase))))}}this._progressor.filling.material.tint=o.r<<16|o.g<<8|o.b;let l=0,c=0;s<.337?(l=s/.337*.1759,c=l):s<.484?(l=.1157+(s-.337)/.147*.1048,c=.1867+(s-.337)/.147*.1048):(l=.2301+(s-.484)/.516*.2699,c=l);const p=oc.zenith.ns.ZENITHRANK_GEOS.els[1],d=this._progressor.filling.geometry.getBuffer("positions"),h=p.w/2;d.data[0]=h-l*p.w,d.data[2]=h-c*p.w,d.data[4]=h+l*p.w,d.data[6]=h+c*p.w;const u=this._progressor.filling.geometry.getBuffer("uvs");u.data[0]=(p.u+h-l*p.w)/1024,u.data[2]=(p.u+h-c*p.w)/1024,u.data[4]=(p.u+h+l*p.w)/1024,u.data[6]=(p.u+h+c*p.w)/1024,d.update(),u.update();const _=Bl(this.container,0,0);Ur.play("zenith_rank",{x:_.x,y:_.y,power:(n-1)/7*(1+3*this._layers.glow.host.alpha),color:r,dT:e,scale:this.parent.CS,back:!this.parent.IsFullMode()}),this.bonusText&&(this.bonusText._accum+=e,this.bonusText._accum>=2&&(this.bonusText.tint=this.bonusText._flashed?this.bonusText._origTint:16777215,this.bonusText._flashed=!this.bonusText._flashed,this.bonusText._accum-=2))}},oc.zenith.ns.ZENITHRANK_COLORS={1:{r:0,g:0,b:0,sr:0,sg:0,sb:0,tr:255,tg:255,tb:255},2:{r:228,g:57,b:33,sr:255,sg:107,sb:37,tr:255,tg:107,tb:37},3:{r:255,g:180,b:0,sr:255,sg:237,sb:34,tr:255,tg:237,tb:34},4:{r:130,g:252,b:64,sr:201,sg:252,sb:36,tr:201,tg:252,tb:36},5:{r:60,g:166,b:255,sr:195,sg:116,sb:255,tr:71,tg:235,tb:255},6:{r:255,g:70,b:218,sr:255,sg:204,sb:181,tr:255,tg:204,tb:181},7:{r:255,g:196,b:142,sr:255,sg:162,sb:75,tr:255,tg:215,tb:120},8:{r:153,g:255,b:198,sr:66,sg:255,sb:101,tr:66,tg:255,tb:101},9:{r:0,g:247,b:255,sr:115,sg:162,sb:255,tr:71,tg:255,tb:183},10:{r:255,g:187,b:234,sr:249,sg:133,sb:255,tr:253,tg:245,tb:188},11:{r:255,g:255,b:255,sr:255,sg:255,sb:255,tr:255,tg:255,tb:255},default:{r:255,g:255,b:255,sr:255,sg:255,sb:255,tr:255,tg:255,tb:255}},oc.zenith.ns.ZENITHRANK_GEOS={padding:10,layers:{idle:{x:0,y:0},active:{x:0,y:330},glow:{x:0,y:660}},els:{1:{x:85,y:75,w:830,h:60,u:10,v:10,rank:2},2:{x:443,y:142,w:114,h:58,u:10,v:90,rank:2},"3L":{x:360,y:142,w:110,h:41,u:150,v:90,rank:3},"3R":{x:530,y:142,w:110,h:41,u:280,v:90,rank:3},"4L":{x:239,y:95,w:129,h:69,u:410,v:90,rank:4},"4R":{x:633,y:95,w:129,h:69,u:560,v:90,rank:4},"5L":{x:176,y:95,w:84,h:35,u:720,v:90,rank:5},"5C":{x:448,y:190,w:105,h:52,u:10,v:170,rank:5},"5R":{x:741,y:95,w:84,h:35,u:830,v:90,rank:5},"6LA":{x:37,y:95,w:137,h:12,u:140,v:180,rank:6},"6RA":{x:826,y:95,w:137,h:12,u:300,v:180,rank:6},"6LB":{x:328,y:171,w:148,h:60,u:130,v:210,rank:6},"6RB":{x:525,y:171,w:148,h:60,u:300,v:210,rank:6},"7LA":{x:138,y:114,w:210,h:50,u:710,v:150,rank:7},"7RA":{x:652,y:114,w:210,h:50,u:470,v:180,rank:7},"7LB":{x:378,y:195,w:62,h:26,u:10,v:240,rank:7},"7RB":{x:561,y:195,w:62,h:26,u:10,v:290,rank:7},"8L":{x:209,y:27,w:94,h:41,u:890,v:220,rank:8},"8R":{x:698,y:27,w:94,h:41,u:770,v:280,rank:8},"9L":{x:143,y:27,w:94,h:41,u:770,v:220,rank:9},"9R":{x:764,y:27,w:94,h:41,u:650,v:280,rank:9},"10L":{x:78,y:27,w:94,h:41,u:890,v:280,rank:10},"10R":{x:830,y:27,w:94,h:41,u:530,v:280,rank:10},"11L":{x:38,y:27,w:68,h:41,u:350,v:284,rank:11},"11R":{x:895,y:27,w:68,h:41,u:440,v:280,rank:11}},phase:{w:248,h:50,u:81,v:280}},oc.zenith.ns.ZENITHRANK_TEX=new Map,oc.zenith.ns.zenithmods=class extends Yl{create(){if(this.parent.IsTinyMode())return;if(!this.parent.S.setoptions.zenith||!this.parent.S.setoptions.zenith_mods)return;switch(this.container=new a.Container,this.container.scale.set(ws(1)),this._position="normal",this.parent.S.setoptions.zenith_duo&&(this._position="left"),this.parent.H.duoIsRight&&(this._position="right"),"normal"===this._position?this.parent.H.rightside.addChild(this.container):this.parent.H.holder.addChild(this.container),this._position){case"normal":this.container.position.set(As(5),As(48+15*Ol.x));break;case"left":this.container.position.set(As(-25),As(25+Ol.x*this.parent.ctx.H));break;case"right":this.container.position.set(As(Ol.x*this.parent.ctx.W-20),As(25+Ol.x*this.parent.ctx.H))}let e=0;const t=140;for(const n of Object.keys(this.options.textures)){if(!this.parent.S.setoptions.zenith_mods.includes(n))continue;const s=new a.Sprite(this.options.textures[n]);switch(this._position){case"normal":s.position.set(70*Math.floor(e/2),[0,t,70,210][e%4]);break;case"left":s.position.set(e/2*t,[0,70][e%2]);break;case"right":s.position.set(e/2*t*-1,[0,70][e%2])}this.container.addChild(s),e++}}},oc.zenith.ns.username=class extends Yl{create(){this.parent.S.setoptions.display_username&&(this.parent.IsTinyMode()&&"low"===it.video.caching||(this.text=new g.Text(this.parent.S.setoptions.username.toUpperCase()||"",{font:rl.get("hun"),rasterize:"minimal"===it.video.graphics,fontSize:As(14),weight:700,tint:0,alpha:.65,anchor:[.5,0],...this.options.font_opts}),this.text.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.H+3)),this.parent.H.holder.addChild(this.text)))}action(e){switch(e){case"startfire":{const e=Bl(this.parent.H.stackobj,0,0);Ur.play("fire_flair",{x:e.x,y:e.y,w:this.parent.ctx.W*this.parent.CS,h:this.parent.ctx.H*this.parent.CS});break}case"continuefire":if(this.parent.IsTinyMode()){const e=Bl(this.parent.H.holder,As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.Hh));Ur.play("fire_burning",{x:e.x,y:e.y})}else{const e=Bl(this.parent.H.stackobj,0,0);Ur.play("fire_burn",{x:e.x,y:e.y,w:this.parent.ctx.W*this.parent.CS,h:this.parent.ctx.H*this.parent.CS})}}}},oc.zenith.ns.boardflash=class extends Zl{create(e=16777215){if(this.spr&&this.delete(),"minimal"!==it.video.graphics&&!this.parent.IsTinyMode())return this.spr=new a.Sprite(this.parent.H.duoIsRight?this.options.texture_inv:this.options.texture),this.spr.anchor.set(.5,.5),this.spr.position.set(As(Ol.x*this.parent.ctx.Wh),As(Ol.x*this.parent.ctx.Hh)),this.spr.scale.set(ws(this.options.scale),ws(this.options.scale)),this.parent.H.holder.addChild(this.spr),El.animate(this.spr,{0:{alpha:1},1:{alpha:0}},1,s(.11,.42,.58,1),(()=>{this.delete()})),this}delete(){this.spr&&(this.spr.destroy(),this.spr=null)}},oc.zenith.ns.zenithprompts=class extends Yl{_prompts=[];create(){this.parent.IsTinyMode()||this.parent.S.setoptions.zenith&&this.parent.S.setoptions.zenith_duo&&(this.container=new a.Container,this.container.scale.set(ws(1)),this.container.position.set(As(5),0),this.container.zIndex=10,this.container.visible=!1,this.parent.H.holder.addChild(this.container),this.chain1=new a.Sprite(this.options.textures.chain1),this.chain1.anchor.set(.5,.5),this.chain1.position.set(Bs(Ol.x*this.parent.ctx.Wh),Bs(Ol.x*this.parent.ctx.H*.15)),this.parent.H.tintables.push(this.chain1),this.container.addChild(this.chain1),this.chain2=new a.Sprite(this.options.textures.chain2),this.chain2.anchor.set(.5,.5),this.chain2.position.set(Bs(Ol.x*this.parent.ctx.Wh),Bs(Ol.x*this.parent.ctx.H*.35)),this.parent.H.tintables.push(this.chain2),this.container.addChild(this.chain2),this.chain3=new a.Sprite(this.options.textures.chain3),this.chain3.anchor.set(.5,.5),this.chain3.position.set(Bs(Ol.x*this.parent.ctx.Wh),Bs(Ol.x*this.parent.ctx.H*.6)),this.parent.H.tintables.push(this.chain3),this.container.addChild(this.chain3),this.chain4=new a.Sprite(this.options.textures.chain4),this.chain4.anchor.set(.5,.5),this.chain4.position.set(Bs(Ol.x*this.parent.ctx.Wh),Bs(Ol.x*this.parent.ctx.H*.75)),this.parent.H.tintables.push(this.chain4),this.container.addChild(this.chain4),this.lock1=new a.Sprite(this.options.textures.lock1),this.lock1.anchor.set(.5,.5),this.lock1.position.set(Bs(Ol.x*this.parent.ctx.Wh),Bs(Ol.x*this.parent.ctx.H*.3)),this.parent.H.tintables.push(this.lock1),this.container.addChild(this.lock1),this.lock2=new a.Sprite(this.options.textures.lock2),this.lock2.anchor.set(.5,.5),this.lock2.position.set(Bs(Ol.x*this.parent.ctx.Wh),Bs(Ol.x*this.parent.ctx.H*.57)),this.parent.H.tintables.push(this.lock2),this.container.addChild(this.lock2),this.lock3=new a.Sprite(this.options.textures.lock3),this.lock3.anchor.set(.5,.5),this.lock3.position.set(Bs(Ol.x*this.parent.ctx.Wh),Bs(Ol.x*this.parent.ctx.H*.8)),this.parent.H.tintables.push(this.lock3),this.container.addChild(this.lock3),this.lc1=new a.Container,this.lc1.angle=this.options.angles.lock1,this.lc1.position.set(Bs(Ol.x*this.parent.ctx.Wh)+this.options.offsets.lock1[0],Bs(Ol.x*this.parent.ctx.H*.3)+this.options.offsets.lock1[1]),this.container.addChild(this.lc1),this.lc2=new a.Container,this.lc2.angle=this.options.angles.lock2,this.lc2.position.set(Bs(Ol.x*this.parent.ctx.Wh)+this.options.offsets.lock2[0],Bs(Ol.x*this.parent.ctx.H*.57)+this.options.offsets.lock2[1]),this.container.addChild(this.lc2),this.lc3=new a.Container,this.lc3.angle=this.options.angles.lock3,this.lc3.position.set(Bs(Ol.x*this.parent.ctx.Wh)+this.options.offsets.lock3[0],Bs(Ol.x*this.parent.ctx.H*.8)+this.options.offsets.lock3[1]),this.container.addChild(this.lc3),this.lock1flash=new a.Sprite(this.options.textures.lockflash),this.lock1flash.anchor.set(.5,.5),this.lock1flash.alpha=0,this.lc1.addChild(this.lock1flash),this.lock2flash=new a.Sprite(this.options.textures.lockflash),this.lock2flash.anchor.set(.5,.5),this.lock2flash.alpha=0,this.lc2.addChild(this.lock2flash),this.lock3flash=new a.Sprite(this.options.textures.lockflash),this.lock3flash.anchor.set(.5,.5),this.lock3flash.alpha=0,this.lc3.addChild(this.lock3flash),this.parent.IsFullMode()&&(this.label1=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:45,weight:600,sharpness:.7,tint:16777215,anchor:[0,.5]}),this.label1.position.set(-380,8),this.lc1.addChild(this.label1),this.label2=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:45,weight:600,sharpness:.7,tint:16777215,anchor:[0,.5]}),this.label2.position.set(-380,8),this.lc2.addChild(this.label2),this.label3=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:45,weight:600,sharpness:.7,tint:16777215,anchor:[0,.5]}),this.label3.position.set(-380,8),this.lc3.addChild(this.label3),this.value1=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:100,weight:700,sharpness:.8,tint:16777215,anchor:[1,.5]}),this.value1.position.set(380,10),this.lc1.addChild(this.value1),this.value2=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:100,weight:700,sharpness:.8,tint:16777215,anchor:[1,.5]}),this.value2.position.set(380,10),this.lc2.addChild(this.value2),this.value3=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:100,weight:700,sharpness:.8,tint:16777215,anchor:[1,.5]}),this.value3.position.set(380,10),this.lc3.addChild(this.value3)),this.parent.ctx.zthm.duoOtherSidePrompts.length&&(this.update(this.parent.ctx.zthm.duoOtherSidePrompts),this.action("fix")))}update(e){this.container&&(this._prompts=e,this.value1&&e[0]&&(this.value1.text=1===e[0].target?"":`${e[0].count}\f3/${e[0].target}`,this.value1.tint=e[0].locked?7368816:16777215,this.label1.tint=e[0].locked?7368816:16777215),this.value2&&e[1]&&(this.value2.text=1===e[1].target?"":`${e[1].count}\f3/${e[1].target}`,this.value2.tint=e[1].locked?7368816:16777215,this.label2.tint=e[1].locked?7368816:16777215),this.value3&&e[2]&&(this.value3.text=1===e[2].target?"":`${e[2].count}\f3/${e[2].target}`,this.value3.tint=e[2].locked?7368816:16777215,this.label3.tint=e[2].locked?7368816:16777215))}action(e,t){if(this.container)switch(e){case"create":this.container.visible=!0,this.chain1.renderable=!1,this.chain2.renderable=!1,this.chain3.renderable=!1,this.chain4.renderable=!1,setTimeout((()=>{this.chain1.renderable=!0,El.animate(this.chain1,{0:{"scale.x":1.3,"scale.y":1.3},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7))}),400),setTimeout((()=>{this.chain2.renderable=!0,El.animate(this.chain2,{0:{"scale.x":1.3,"scale.y":1.3},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7))}),500),setTimeout((()=>{this.chain3.renderable=!0,El.animate(this.chain3,{0:{"scale.x":1.3,"scale.y":1.3},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7))}),350),setTimeout((()=>{this.chain4.renderable=!0,El.animate(this.chain4,{0:{"scale.x":1.3,"scale.y":1.3},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7))}),450),this._prompts[0]?(this.lock1.visible=!0,this.lc1.visible=!0,this.lock1.renderable=!1,this.lc1.renderable=!1,setTimeout((()=>{this.lock1.renderable=!0,this.lc1.renderable=!0,El.animate(this.lock1,{0:{"scale.x":1.7,"scale.y":1.7},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7)),El.animate(this.lc1,{0:{"scale.x":1.7,"scale.y":1.7},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7))}),600),this.lock1flash.tint=15478052,setTimeout((()=>{El.animate(this.lock1flash,{0:{alpha:1},1:{alpha:0}},.4,s(.51,.12,.86,.7))}),750),this.parent.IsFullMode()&&(this.label1.text=1===this._prompts[0].labelType||3===this._prompts[0].labelType?this._prompts[0].label.toUpperCase():this._prompts[0].label.toLowerCase(),this.label1.fontSize=3===this._prompts[0].labelType||4===this._prompts[0].labelType?45:62,this.label1.anchor.x=1===this._prompts[0].target?.5:0,this.label1.position.x=1===this._prompts[0].target?0:-380)):(this.lock1.visible=!1,this.lc1.visible=!1),this._prompts[1]?(this.lock2.visible=!0,this.lc2.visible=!0,this.lock2.renderable=!1,this.lc2.renderable=!1,setTimeout((()=>{this.lock2.renderable=!0,this.lc2.renderable=!0,El.animate(this.lock2,{0:{"scale.x":1.7,"scale.y":1.7},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7)),El.animate(this.lc2,{0:{"scale.x":1.7,"scale.y":1.7},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7))}),650),this.lock2flash.tint=15478052,setTimeout((()=>{El.animate(this.lock2flash,{0:{alpha:1},1:{alpha:0}},.4,s(.51,.12,.86,.7))}),800),this.parent.IsFullMode()&&(this.label2.text=1===this._prompts[1].labelType||3===this._prompts[1].labelType?this._prompts[1].label.toUpperCase():this._prompts[1].label.toLowerCase(),this.label2.fontSize=3===this._prompts[1].labelType||4===this._prompts[1].labelType?45:62,this.label2.anchor.x=1===this._prompts[1].target?.5:0,this.label2.position.x=1===this._prompts[1].target?0:-380)):(this.lock2.visible=!1,this.lc2.visible=!1),this._prompts[2]?(this.lock3.visible=!0,this.lc3.visible=!0,this.lock3.renderable=!1,this.lc3.renderable=!1,setTimeout((()=>{this.lock3.renderable=!0,this.lc3.renderable=!0,El.animate(this.lock3,{0:{"scale.x":1.7,"scale.y":1.7},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7)),El.animate(this.lc3,{0:{"scale.x":1.7,"scale.y":1.7},1:{"scale.x":1,"scale.y":1}},.15,s(.51,.12,.86,.7))}),700),this.lock3flash.tint=15478052,setTimeout((()=>{El.animate(this.lock3flash,{0:{alpha:1},1:{alpha:0}},.4,s(.51,.12,.86,.7))}),850),this.parent.IsFullMode()&&(this.label3.text=1===this._prompts[2].labelType||3===this._prompts[2].labelType?this._prompts[2].label.toUpperCase():this._prompts[2].label.toLowerCase(),this.label3.fontSize=3===this._prompts[2].labelType||4===this._prompts[2].labelType?45:62,this.label3.anchor.x=1===this._prompts[2].target?.5:0,this.label3.position.x=1===this._prompts[2].target?0:-380)):(this.lock3.visible=!1,this.lc3.visible=!1);break;case"advance":for(let e=0;e<this._prompts.length;e++)this._prompts[e].id===t&&(this[`lock${e+1}flash`].tint=16760343,El.animate(this[`lock${e+1}`],{0:{"pivot.y":0},.5:{"pivot.y":50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4)),El.animate(this[`lc${e+1}`],{0:{"pivot.y":0},.5:{"pivot.y":50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4)),El.animate(this[`lock${e+1}flash`],{0:{alpha:0},.2:{alpha:1.5},1:{alpha:0}},.5,s(.06,.46,.6,.4)));break;case"nix":for(let e=0;e<this._prompts.length;e++)this._prompts[e].id===t&&(this[`lock${e+1}flash`].tint=15478052,El.animate(this[`lock${e+1}flash`],{0:{alpha:0},.2:{alpha:1.5},1:{alpha:0}},.9,s(.06,.46,.6,.4)));break;case"clear":for(let e=0;e<this._prompts.length;e++)this._prompts[e].id===t&&(this[`lock${e+1}flash`].tint=16777215,El.animate(this[`lock${e+1}`],{0:{"pivot.y":0},.5:{"pivot.y":50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4)),El.animate(this[`lc${e+1}`],{0:{"pivot.y":0},.5:{"pivot.y":50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4)),El.animate(this[`lock${e+1}flash`],{0:{alpha:0},.2:{alpha:2},.4:{alpha:0},.6:{alpha:2},.8:{alpha:0},1:{alpha:2}},.2),setTimeout((()=>{const t=Bl(this[`lc${e+1}`],0,0);Ur.play("zenith_lockbreak",{x:t.x,y:t.y,scale:this.parent.CS,id:e}),this[`lock${e+1}`].visible=!1,this[`lc${e+1}`].visible=!1}),200));break;case"revive":for(let e=0;e<4;e++)setTimeout((()=>{El.animate(this[`chain${e+1}`],{0:{"pivot.y":0},.5:{"pivot.y":150},1:{"pivot.y":0}},.16,s(.06,.46,.6,.4))}),20*e),setTimeout((()=>{const t=Bl(this[`chain${e+1}`],0,0);Ur.play("zenith_chainbreak",{x:t.x,y:t.y,scale:this.parent.CS,id:e})}),200);setTimeout((()=>{this.container.visible=!1}),200);break;case"fix":if(!this._prompts||!this._prompts.length||!this.parent.S.zenith.incapacitated)return void(this.container.visible=!1);this.container.visible=!0,this._prompts[0]&&!this._prompts[0].complete?(this.lock1.visible=!0,this.lc1.visible=!0,this.parent.IsFullMode()&&(this.label1.text=1===this._prompts[0].labelType||3===this._prompts[0].labelType?this._prompts[0].label.toUpperCase():this._prompts[0].label.toLowerCase(),this.label1.fontSize=3===this._prompts[0].labelType||4===this._prompts[0].labelType?45:62,this.label1.anchor.x=1===this._prompts[0].target?.5:0,this.label1.position.x=1===this._prompts[0].target?0:-380)):(this.lock1.visible=!1,this.lc1.visible=!1),this._prompts[1]&&!this._prompts[1].complete?(this.lock2.visible=!0,this.lc2.visible=!0,this.parent.IsFullMode()&&(this.label2.text=1===this._prompts[1].labelType||3===this._prompts[1].labelType?this._prompts[1].label.toUpperCase():this._prompts[1].label.toLowerCase(),this.label2.fontSize=3===this._prompts[1].labelType||4===this._prompts[1].labelType?45:62,this.label2.anchor.x=1===this._prompts[1].target?.5:0,this.label2.position.x=1===this._prompts[1].target?0:-380)):(this.lock2.visible=!1,this.lc2.visible=!1),this._prompts[2]&&!this._prompts[2].complete?(this.lock3.visible=!0,this.lc3.visible=!0,this.parent.IsFullMode()&&(this.label3.text=1===this._prompts[2].labelType||3===this._prompts[2].labelType?this._prompts[2].label.toUpperCase():this._prompts[2].label.toLowerCase(),this.label3.fontSize=3===this._prompts[2].labelType||4===this._prompts[2].labelType?45:62,this.label3.anchor.x=1===this._prompts[2].target?.5:0,this.label3.position.x=1===this._prompts[2].target?0:-380)):(this.lock3.visible=!1,this.lc3.visible=!1)}}},oc.zenith.ns.zenithpromptsself=class extends Yl{_prompts=[];_activePrompt=null;create(){this.parent.IsFullMode()&&this.parent.S.setoptions.zenith&&this.parent.S.setoptions.zenith_duo&&(this.container=new a.Container,this.container.scale.set(ws(1.15)),this.container.position.set(As(Ol.x*this.parent.ctx.Wh),As(3.25*Ol.x)),this.container.zIndex=10,this.container.visible=!1,this.parent.H.holder.addChild(this.container),this.label=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:45,weight:600,sharpness:.7,tint:16657920,anchor:[0,.5]}),this.label.position.set(-380,0),this.container.addChild(this.label),this.value=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:100,weight:700,sharpness:.8,tint:16657920,anchor:[1,.5]}),this.value.position.set(380,2),this.container.addChild(this.value),this.shout=new g.Text("",{font:rl.get("hun"),rasterize:["minimal","low"].includes(it.video.graphics),fontSize:140,weight:600,sharpness:.7,tint:16657920,anchor:[.5,.5]}),this.shout.position.set(0,0),this.container.addChild(this.shout),this.parent.S.zenith.reviveprompts.length&&(this.update(this.parent.S.zenith.reviveprompts),this.action("fix")),["minimal","low"].includes(it.video.graphics)||(this.activeFade=new oc.generic.ns._helper_activefade({positions:[[this.parent.ctx.Wh-3,this.parent.ctx.B+2],[this.parent.ctx.Wh-2,this.parent.ctx.B+3],[this.parent.ctx.Wh-1,this.parent.ctx.B+2],[this.parent.ctx.Wh+0,this.parent.ctx.B+3],[this.parent.ctx.Wh+1,this.parent.ctx.B+2],[this.parent.ctx.Wh+2,this.parent.ctx.B+3]],elements:[this.label,this.value],alphaHigh:.8,alphaLow:.3,ctx:this.parent.ctx})))}update(e){this.container&&(this._prompts=e,this._activePrompt||(this._activePrompt=this._prompts.find((e=>!e.complete&&!e.locked))),this.value.text=this._activePrompt?1===this._activePrompt.target?"":`${this._activePrompt.count}\f3/${this._activePrompt.target}`:"")}action(e,t){if(this.container)switch(e){case"create":this.container.visible=!0,this.shout.visible=!0,this.shout.renderable=!0,this.shout.text="REVIVE!",this.shout.tint=16657920,El.animate(this.shout,{0:{"pivot.x":this.parent.H.duoIsRight?700:-700,"pivot.y":0},1:{"pivot.x":0,"pivot.y":0}},.3,s(.06,.46,.44,1)),setTimeout((()=>{El.animate(this.shout,{0:{"scale.x":1,"scale.y":1},.25:{"scale.x":1.1,"scale.y":1.1},.5:{"scale.x":1,"scale.y":1},.75:{"scale.x":1.1,"scale.y":1.1},1:{"scale.x":1,"scale.y":1}},.2,s(.03,.34,.7,.99))}),500),setTimeout((()=>{El.animate(this.shout,{0:{"scale.x":1,"scale.y":1},.25:{"scale.x":1.1,"scale.y":1.1},.5:{"scale.x":1,"scale.y":1},.75:{"scale.x":1.1,"scale.y":1.1},1:{"scale.x":1,"scale.y":1}},.2,s(.03,.34,.7,.99))}),500),setTimeout((()=>{El.animate(this.shout,{0:{"pivot.y":0,alpha:1},1:{"pivot.y":200,alpha:0}},.2,s(.54,.03,.98,.69))}),800),setTimeout((()=>{this.shout.renderable=!1}),1e3),this._activePrompt=this._prompts.find((e=>!e.complete&&!e.locked)),this._activePrompt?(this.label.visible=!0,this.value.visible=!0,this.label.renderable=!1,this.value.renderable=!1,this.label.text=1===this._activePrompt.labelType||3===this._activePrompt.labelType?this._activePrompt.label.toUpperCase():this._activePrompt.label.toLowerCase(),this.value.text=1===this._activePrompt.target?"":`${this._activePrompt.count}\f3/${this._activePrompt.target}`,this.label.fontSize=3===this._activePrompt.labelType||4===this._activePrompt.labelType?45:62,this.label.anchor.x=1===this._activePrompt.target?.5:0,this.label.position.x=1===this._activePrompt.target?0:-380,setTimeout((()=>{this.label.renderable=!0,this.value.renderable=!0,El.animate(this.label,{0:{"pivot.y":-200,alpha:0},1:{"pivot.y":0,alpha:1}},.2,s(.54,.03,.98,.69)),El.animate(this.value,{0:{"pivot.y":-200,alpha:0},1:{"pivot.y":0,alpha:1}},.2,s(.54,.03,.98,.69))}),800)):(this.label.visible=!1,this.value.visible=!1);break;case"advance":if(!this._activePrompt)break;if(this._activePrompt.id!==t)break;El.animate(this.label,{0:{"pivot.y":0},.5:{"pivot.y":50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4)),El.animate(this.value,{0:{"pivot.y":0},.5:{"pivot.y":50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4));break;case"nix":if(!this._activePrompt)break;if(this._activePrompt.id!==t)break;El.animate(this.label,{0:{"pivot.y":0},.5:{"pivot.y":-50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4)),El.animate(this.value,{0:{"pivot.y":0},.5:{"pivot.y":-50},1:{"pivot.y":0}},.2,s(.06,.46,.6,.4));break;case"clear":if(!this._activePrompt)break;if(this._activePrompt.id!==t)break;this.label.renderable=!1,this.value.renderable=!1,this.shout.renderable=!0,this.shout.alpha=1,this.shout.text="CLEAR!",this.shout.tint=16675328,El.animate(this.shout,{0:{"pivot.x":0,"pivot.y":0},.5:{"pivot.x":0,"pivot.y":50},1:{"pivot.x":0,"pivot.y":0}},.2,s(.06,.46,.6,.4)),setTimeout((()=>{El.animate(this.shout,{0:{"pivot.x":0,"pivot.y":0,alpha:1},1:{"pivot.x":this.parent.H.duoIsRight?700:-700,"pivot.y":0,alpha:0}},.2,s(.54,.03,.98,.69))}),300),this._activePrompt=this._prompts.find((e=>!e.complete&&!e.locked)),this._activePrompt?(this.label.text=1===this._activePrompt.labelType||3===this._activePrompt.labelType?this._activePrompt.label.toUpperCase():this._activePrompt.label.toLowerCase(),this.value.text=1===this._activePrompt.target?"":`${this._activePrompt.count}\f3/${this._activePrompt.target}`,this.label.fontSize=3===this._activePrompt.labelType||4===this._activePrompt.labelType?45:62,this.label.anchor.x=1===this._activePrompt.target?.5:0,this.label.position.x=1===this._activePrompt.target?0:-380,setTimeout((()=>{this.label.renderable=!0,this.value.renderable=!0,El.animate(this.label,{0:{"pivot.y":-200,alpha:0},1:{"pivot.y":0,alpha:1}},.2,s(.54,.03,.98,.69)),El.animate(this.value,{0:{"pivot.y":-200,alpha:0},1:{"pivot.y":0,alpha:1}},.2,s(.54,.03,.98,.69))}),300)):(this.label.visible=!1,this.value.visible=!1);break;case"revive":this.label.renderable=!1,this.value.renderable=!1,this.shout.renderable=!0,this.shout.alpha=1,this.shout.text="REVIVED!",this.shout.tint=16696832,El.animate(this.shout,{0:{"pivot.x":0,"pivot.y":0},.5:{"pivot.x":0,"pivot.y":50},1:{"pivot.x":0,"pivot.y":0}},.2,s(.06,.46,.6,.4)),setTimeout((()=>{El.animate(this.shout,{0:{"pivot.x":0,"pivot.y":0,alpha:1},1:{"pivot.x":this.parent.H.duoIsRight?700:-700,"pivot.y":0,alpha:0}},.2,s(.54,.03,.98,.69))}),300),setTimeout((()=>{this.container.visible=!1}),500);break;case"fix":if(!this._prompts||!this._prompts.length)return void(this.container.visible=!1);this.container.visible=!0,this.shout.visible=!0,this.shout.renderable=!1,this.shout.tint=16657920,this._activePrompt=this._prompts.find((e=>!e.complete&&!e.locked)),this._activePrompt?(this.label.visible=!0,this.value.visible=!0,this.label.renderable=!0,this.value.renderable=!0,this.label.text=1===this._activePrompt.labelType||3===this._activePrompt.labelType?this._activePrompt.label.toUpperCase():this._activePrompt.label.toLowerCase(),this.label.fontSize=3===this._activePrompt.labelType||4===this._activePrompt.labelType?45:62,this.label.anchor.x=1===this._activePrompt.target?.5:0,this.label.position.x=1===this._activePrompt.target?0:-380):(this.label.visible=!1,this.value.visible=!1)}}progress(e){this.activeFade&&this.activeFade.progress(e)}},oc.zenith_expert.ns.Board=class extends oc.zenith.ns.Board{_init(){super._init(),this.textures.set("board",a.BaseTexture.from(`/res/skins/board/zenith/expert${ac}.png`))}},oc.zenith_duoleft.ns.Board=class extends oc.zenith.ns.Board{_init(){super._init(),this.textures.set("board",a.BaseTexture.from(`/res/skins/board/zenith/duoleft${ac}.png`))}constructor(e){super(e),this.S.setoptions.zenith&&(this.elements.set("zenithrank",new oc.zenith.ns.zenithrank(this,{texture:this.textures.get("zenithrank"),texture_chip:new a.Texture(this.textures.get("board"),new a.Rectangle(2506*rc,2313*rc,458*rc,110*rc))})),this.progressive.set("zenithrank",this.elements.get("zenithrank")),this.elements.set("zenithpromptsself",new oc.zenith.ns.zenithpromptsself(this,{})),this.progressive.set("zenithpromptsself",this.elements.get("zenithpromptsself")),this.elements.set("zenithprompts",new oc.zenith.ns.zenithprompts(this,{textures:{chain1:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,2286*rc,1063*rc,403*rc)),chain2:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,2734*rc,1063*rc,356*rc)),chain3:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,3099*rc,1063*rc,648*rc)),chain4:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,3752*rc,1063*rc,304*rc)),lock1:new a.Texture(this.textures.get("board"),new a.Rectangle(1954*rc,2979*rc,1063*rc,304*rc)),lock2:new a.Texture(this.textures.get("board"),new a.Rectangle(1954*rc,3333*rc,1063*rc,352*rc)),lock3:new a.Texture(this.textures.get("board"),new a.Rectangle(1954*rc,3716*rc,1063*rc,365*rc)),lockflash:new a.Texture(this.textures.get("board"),new a.Rectangle(2132*rc,2795*rc,858*rc,155*rc))},angles:{lock1:-5.37,lock2:8.55,lock3:-9.62},offsets:{lock1:[0,14],lock2:[9,16],lock3:[4,18]}})))}},oc.zenith_duoright.ns.Board=class extends oc.zenith.ns.Board{_init(){super._init(),this.textures.set("board",a.BaseTexture.from(`/res/skins/board/zenith/duoright${ac}.png`)),this.textures.set("zenithrank",null)}constructor(e){super(e),this._init(),this.elements.delete("counter1"),this.elements.delete("counter2"),this.elements.delete("counter3"),this.elements.delete("counter4"),this.elements.delete("counter5"),this.elements.delete("b2b"),this.effects.delete("clear"),this.effects.delete("tspin"),this.effects.delete("also"),this.effects.delete("combo"),this.effects.delete("zenithrank"),this.progressive.delete("zenithrank"),this.elements.set("hold",new oc.generic.ns.hold(this,{texture:new a.Texture(this.textures.get("board"),new a.Rectangle(49*rc,69*rc,610*rc,710*rc)),slices:[0,250*rc,0,330*rc],offsets:[150*rc,100*rc,0,230*rc],texture_bg:new a.Texture(this.textures.get("board"),new a.Rectangle(199*rc,793*rc,460*rc,276*rc)),slices_bg:[0,0,0,0],offsets_bg:[3*rc,-104*rc,3*rc,3*rc],pos:[20,32],bottom:!0})),this.S.setoptions.zenith&&(this.elements.set("zenithpromptsself",new oc.zenith.ns.zenithpromptsself(this,{})),this.progressive.set("zenithpromptsself",this.elements.get("zenithpromptsself")),this.elements.set("zenithprompts",new oc.zenith.ns.zenithprompts(this,{textures:{chain1:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,2286*rc,1063*rc,403*rc)),chain2:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,2734*rc,1063*rc,356*rc)),chain3:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,3099*rc,1063*rc,648*rc)),chain4:new a.Texture(this.textures.get("board"),new a.Rectangle(3021*rc,3752*rc,1063*rc,304*rc)),lock1:new a.Texture(this.textures.get("board"),new a.Rectangle(1954*rc,2979*rc,1063*rc,304*rc)),lock2:new a.Texture(this.textures.get("board"),new a.Rectangle(1954*rc,3333*rc,1063*rc,352*rc)),lock3:new a.Texture(this.textures.get("board"),new a.Rectangle(1954*rc,3716*rc,1063*rc,365*rc)),lockflash:new a.Texture(this.textures.get("board"),new a.Rectangle(2132*rc,2795*rc,858*rc,155*rc))},angles:{lock1:-5.37,lock2:8.55,lock3:-9.62},offsets:{lock1:[0,14],lock2:[9,16],lock3:[4,18]}})))}},oc.zenith_expert_duoleft.ns.Board=class extends oc.zenith_duoleft.ns.Board{_init(){super._init(),this.textures.set("board",a.BaseTexture.from(`/res/skins/board/zenith/expert-duoleft${ac}.png`))}},oc.zenith_expert_duoright.ns.Board=class extends oc.zenith_duoright.ns.Board{_init(){super._init(),this.textures.set("board",a.BaseTexture.from(`/res/skins/board/zenith/expert-duoright${ac}.png`))}};
 })();